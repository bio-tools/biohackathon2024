<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10976918</article-id>
    <article-id pub-id-type="pmid">38546324</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbae116</article-id>
    <article-id pub-id-type="publisher-id">bbae116</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Problem Solving Protocol</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Generalized reporter score-based enrichment analysis for omics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Peng</surname>
          <given-names>Chen</given-names>
        </name>
        <!--pengchen2001@zju.edu.cn-->
        <aff><institution>MOE Key Laboratory of Biosystems Homeostasis &amp; Protection</institution>, and Zhejiang Provincial Key Laboratory of Cancer Molecular Cell Biology, <institution>Life Sciences Institute, Zhejiang University</institution>, <addr-line>Hangzhou, Zhejiang 310030</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>State Key Laboratory for Diagnosis and Treatment of Infectious Diseases</institution>, First Affiliated Hospital, <institution>Zhejiang University School of Medicine</institution>, <addr-line>Hangzhou, Zhejiang 310009</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Qiong</given-names>
        </name>
        <!--qiong_chen@zju.edu.cn-->
        <aff><institution>MOE Key Laboratory of Biosystems Homeostasis &amp; Protection</institution>, and Zhejiang Provincial Key Laboratory of Cancer Molecular Cell Biology, <institution>Life Sciences Institute, Zhejiang University</institution>, <addr-line>Hangzhou, Zhejiang 310030</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>State Key Laboratory for Diagnosis and Treatment of Infectious Diseases</institution>, First Affiliated Hospital, <institution>Zhejiang University School of Medicine</institution>, <addr-line>Hangzhou, Zhejiang 310009</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tan</surname>
          <given-names>Shangjin</given-names>
        </name>
        <!--tanshangjin@genomics.cn-->
        <aff><institution>BGI Research</institution>, <addr-line>Wuhan, Hubei 430074</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>BGI Research</institution>, <addr-line>Shenzhen, Guangdong 518083</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shen</surname>
          <given-names>Xiaotao</given-names>
        </name>
        <!--xiaotaoshen@gmail.com-->
        <aff><institution>Department of Genetics, Stanford University School of Medicine</institution>, <addr-line>Stanford, CA</addr-line>, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0260-7271</contrib-id>
        <name>
          <surname>Jiang</surname>
          <given-names>Chao</given-names>
        </name>
        <!--jiang_chao@zju.edu.cn-->
        <aff><institution>MOE Key Laboratory of Biosystems Homeostasis &amp; Protection</institution>, and Zhejiang Provincial Key Laboratory of Cancer Molecular Cell Biology, <institution>Life Sciences Institute, Zhejiang University</institution>, <addr-line>Hangzhou, Zhejiang 310030</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>State Key Laboratory for Diagnosis and Treatment of Infectious Diseases</institution>, First Affiliated Hospital, <institution>Zhejiang University School of Medicine</institution>, <addr-line>Hangzhou, Zhejiang 310009</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>Center for Life Sciences, Shaoxing Institute, Zhejiang University</institution>, <addr-line>Shaoxing, Zhejiang 321000</addr-line>, <country country="CN">China</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Corresponding author. Chao Jiang, MOE Key Laboratory of Biosystems Homeostasis &amp; Protection, and Zhejiang Provincial Key Laboratory of Cancer Molecular Cell Biology, Life Sciences Institute, Zhejiang University, Hangzhou, Zhejiang 310030, China. Tel.: +86 0571 88208922; E-mail: <email>jiang_chao@zju.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-03-27">
      <day>27</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <issue>3</issue>
    <elocation-id>bbae116</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>25</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bbae116.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Enrichment analysis contextualizes biological features in pathways to facilitate a systematic understanding of high-dimensional data and is widely used in biomedical research. The emerging reporter score-based analysis (RSA) method shows more promising sensitivity, as it relies on <italic toggle="yes">P</italic>-values instead of raw values of features. However, RSA cannot be directly applied to multi-group and longitudinal experimental designs and is often misused due to the lack of a proper tool. Here, we propose the Generalized Reporter Score-based Analysis (GRSA) method for multi-group and longitudinal omics data. A comparison with other popular enrichment analysis methods demonstrated that GRSA had increased sensitivity across multiple benchmark datasets. We applied GRSA to microbiome, transcriptome and metabolome data and discovered new biological insights in omics studies. Finally, we demonstrated the application of GRSA beyond functional enrichment using a taxonomy database. We implemented GRSA in an R package, ReporterScore, integrating with a powerful visualization module and updatable pathway databases, which is available on the Comprehensive R Archive Network (<ext-link xlink:href="https://cran.r-project.org/web/packages/ReporterScore" ext-link-type="uri">https://cran.r-project.org/web/packages/ReporterScore</ext-link>). We believe that the ReporterScore package will be a valuable asset for broad biomedical research fields.</p>
    </abstract>
    <abstract abstract-type="graphical">
      <title>Graphical Abstract</title>
      <p>
        <fig position="float" id="ga1">
          <label>Graphical Abstract</label>
          <graphic xlink:href="bbae116ga1" position="float"/>
        </fig>
      </p>
    </abstract>
    <kwd-group>
      <kwd>reporter score</kwd>
      <kwd>enrichment analysis</kwd>
      <kwd>multi-group</kwd>
      <kwd>omics data</kwd>
      <kwd>customized database</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Nature Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>82173645</award-id>
        <award-id>82341109</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Fundamental Research Funds for the Central Universities</institution>
            <institution-id institution-id-type="DOI">10.13039/501100012226</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2022FZZX03-03-07</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="14"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec3">
    <title>INTRODUCTION</title>
    <p>Functional enrichment analysis is a popular bioinformatic method that helps understand the biological significance of large omics datasets, such as transcriptomic, metagenomic, and metabolic data. We gain insights into the underlying biological processes and functions by identifying enriched functional categories, such as gene ontology terms or biological pathways, and formulate hypotheses for downstream experimental investigations [<xref rid="ref1" ref-type="bibr">1</xref>].</p>
    <p>Methods for functional enrichment analysis can be roughly divided into three categories based on underlying statistical methods: (i) overrepresentation analysis (ORA), (ii) functional class scoring (FCS) and (iii) pathway topology-based (PT) [<xref rid="ref2" ref-type="bibr">2</xref>]. Common enrichment analysis methods in omics research are shown in <xref rid="TB1" ref-type="table">Table 1</xref>. In addition, Goeman and Bühlmann classified enrichment analysis methods based on the underlying null hypothesis as ‘competitive’ or ‘self-contained’. In ‘competitive’ methods, a gene set is compared against the background of all genes not in the set to assess if the level of statistical differences exceeds the background level, whereas a ‘self-contained’ method analyzes each gene set in isolation [<xref rid="ref11" ref-type="bibr">11</xref>].</p>
    <table-wrap position="float" id="TB1">
      <label>Table 1</label>
      <caption>
        <p>Some commonly used enrichment analysis methods</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th align="left" rowspan="1" colspan="1">Category</th>
            <th align="left" rowspan="1" colspan="1">Method</th>
            <th align="left" rowspan="1" colspan="1">Tools</th>
            <th align="left" rowspan="1" colspan="1">Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" rowspan="1" colspan="1">ORA</td>
            <td align="left" rowspan="1" colspan="1">Hypergeometric test/Fisher’s exact test</td>
            <td align="left" rowspan="1" colspan="1">DAVID (website) [<xref rid="ref3" ref-type="bibr">3</xref>], clusterProfiler (R package) [<xref rid="ref4" ref-type="bibr">4</xref>]</td>
            <td align="left" rowspan="1" colspan="1">The most common methods used in enrichment analysis. Selecting a list of genes is required</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Gene set enrichment analysis (GSEA)</td>
            <td align="left" rowspan="1" colspan="1">GSEA (website) [<xref rid="ref5" ref-type="bibr">5</xref>]</td>
            <td align="left" rowspan="1" colspan="1">GSEA creatively uses gene ranking, rather than selecting a list of genes, to identify statistically significant and concordant differences across gene sets</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Generalized reporter score-based analysis (GRSA/RSA)</td>
            <td align="left" rowspan="1" colspan="1">ReporterScore (R package developed in this study)</td>
            <td align="left" rowspan="1" colspan="1">Find significant metabolites (first report), pathways and taxonomy based on the <italic toggle="yes">P</italic>-values for multi-omics data</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Significance Analysis of Function and Expression (SAFE)</td>
            <td align="left" rowspan="1" colspan="1">SAFE (R package) [<xref rid="ref6" ref-type="bibr">6</xref>]</td>
            <td align="left" rowspan="1" colspan="1">SAFE assesses the significance of gene categories by calculating both local and global statistics from gene expression data</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Gene Set Analysis (GSA)</td>
            <td align="left" rowspan="1" colspan="1">GSA (R Package) [<xref rid="ref7" ref-type="bibr">7</xref>]</td>
            <td align="left" rowspan="1" colspan="1">GSA was proposed as an improvement of GSEA, using the ‘maxmean’ statistic instead of the weighted sign KS statistic</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Pathway Analysis with Down-weighting of Overlapping Genes (PADOG)</td>
            <td align="left" rowspan="1" colspan="1">PADOG (R package) [<xref rid="ref8" ref-type="bibr">8</xref>]</td>
            <td align="left" rowspan="1" colspan="1">PADOG assumes that genes associated with fewer pathways have more significant effects than genes associated with more pathways</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Gene Set Variation Analysis (GSVA)</td>
            <td align="left" rowspan="1" colspan="1">GSVA (R package) [<xref rid="ref9" ref-type="bibr">9</xref>]</td>
            <td align="left" rowspan="1" colspan="1">A non-parametric, unsupervised method that transforms gene expression data into gene set scores for downstream differential pathway activity analysis</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">PT</td>
            <td align="left" rowspan="1" colspan="1">Topology-based pathway enrichment analysis (TPEA)</td>
            <td align="left" rowspan="1" colspan="1">TPEA (R package) [<xref rid="ref10" ref-type="bibr">10</xref>]</td>
            <td align="left" rowspan="1" colspan="1">Integrate topological properties and global upstream/downstream positions of genes in pathways</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>The algorithm of reporter score-based analysis (RSA) was originally developed by Patil and Nielsen in 2005 to identify metabolites associated with the metabolic network’s regulatory hotspots [<xref rid="ref12" ref-type="bibr">12</xref>]. The RSA has recently gained popularity due to its extended application in functional enrichment analysis in microbiome research [<xref rid="ref13" ref-type="bibr">13</xref>]. RSA is a competitive FCS method based on parsing the <italic toggle="yes">P</italic>-values of selected statistical analyses without a priori cut-off (threshold-free). The rationale is that the <italic toggle="yes">P</italic>-value can be considered a standardized statistic reflecting the differences between different genes or features, regardless of the mean expression values. The pathways with significantly lower <italic toggle="yes">P</italic>-values than the background <italic toggle="yes">P</italic>-value distribution are enriched [<xref rid="ref12" ref-type="bibr">12</xref>].</p>
    <p>However, RSA is often misused due to a lack of specific tools and a systematic understanding of the algorithm [<xref rid="ref14" ref-type="bibr">14</xref>]. In addition, the sign (plus or minus) of the reporter score of each pathway in classic RSA does not represent the increasing or decreasing trend of the pathway expression; rather, reporter scores (including negative value) less than a specified threshold indicate that the corresponding pathway is not significantly enriched. This often leads to misinterpretations of the results.</p>
    <p>Inspired by the classic RSA, we developed the improved Generalized Reporter Score-based Analysis (GRSA) method, implemented in the R package ReporterScore, along with comprehensive visualization methods and pathway databases. GRSA is a threshold-free method that works well with all types of biomedical features, such as genes, chemical compounds and microbial species. GRSA works in the mixed (classic RSA) and directed modes (enhanced RSA). The directed mode uses signs of the reporter score to distinguish up-regulated or down-regulated pathways, which is more intuitive. Importantly, the GRSA supports multi-group and longitudinal experimental designs because of the included multi-group-compatible statistical methods (for a full list of supported methods, please see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The ReporterScore package also supports custom hierarchical and relational databases (e.g. tables containing the correspondence between pathways and genes), providing extra flexibility for advanced users. In this study, we described the comprehensive utility of GRSA. We benchmarked GRSA against other popular enrichment methods across multiple datasets and demonstrated the applications of GRSA on diverse omics datasets.</p>
  </sec>
  <sec id="sec4">
    <title>MATERIALS AND METHODS</title>
    <sec id="sec5">
      <title>Algorithm</title>
      <p>The algorithm of GRSA is described as follows, using metagenomic data as an example.</p>
      <sec id="sec5a">
        <title>(1) Calculating the <italic toggle="yes">P</italic>-values</title>
        <p>A statistical method (the full list of supported statistical methods is in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>) was used to obtain the <italic toggle="yes">P</italic>-values of the features (i.e. <inline-formula><tex-math notation="LaTeX" id="ineq01">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${p}_{K{O}_i}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ineq02">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> represents a certain KO; <xref rid="f1" ref-type="fig">Figure 1A</xref>). We used KO to represent different features in the formulas for simplicity.</p>
        <fig position="float" id="f1">
          <label>Figure 1</label>
          <caption>
            <p>The overall workflow of GRSA in the ReporterScore package. (<bold>A</bold>) GRSA workflow consists of four parts: Calculate the <italic toggle="yes">P</italic>-values for KOs between two or multiple groups by various statistical methods; convert the <italic toggle="yes">P</italic>-values of KOs to <italic toggle="yes">Z</italic>-scores by inverse normal distribution and assignment of a plus or minus sign to each <italic toggle="yes">Z</italic>-score in the directed mode; mapping KOs to annotated pathways and calculating the reporter score for each pathway; visualize the results of GRSA. <inline-formula><tex-math notation="LaTeX" id="ineq03">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> represents a certain KO; <inline-formula><tex-math notation="LaTeX" id="ineq04">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${p}_{K{O}_i}$\end{document}</tex-math></inline-formula> is the <italic toggle="yes">P</italic>-value of <inline-formula><tex-math notation="LaTeX" id="ineq05">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ineq06">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_i}$\end{document}</tex-math></inline-formula> is the <italic toggle="yes">Z</italic>-score transformed from <inline-formula><tex-math notation="LaTeX" id="ineq07">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${p}_{K{O}_i}$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ineq08">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varDelta K{O}_i$\end{document}</tex-math></inline-formula> is the abundance difference of between groups. A total of <inline-formula><tex-math notation="LaTeX" id="ineq09">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula> KOs were annotated to the corresponding pathway. <inline-formula><tex-math notation="LaTeX" id="ineq10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\mu}_{k_j}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ineq11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\sigma}_{k_j}$\end{document}</tex-math></inline-formula> are the mean and the standard deviation of the background <italic toggle="yes">Z</italic>-score distribution <inline-formula><tex-math notation="LaTeX" id="ineq12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ null}$\end{document}</tex-math></inline-formula>, respectively. The ReporterScore package provides various visualization methods for the GRSA result. (<bold>B</bold>) The bar chart shows reporter scores of pathways in the mixed mode. The red color indicates significantly enriched pathways, with reporter scores greater than 1.64, corresponding to a <italic toggle="yes">P</italic>-value of 0.05. (<bold>C</bold>) The bar chart shows reporter scores of pathways in the directed mode. The orange and green colors indicate up-regulated and down-regulated pathways with absolute reporter scores &gt;1.64. (<bold>D</bold> and <bold>E</bold>) The line charts show the pattern of a selected pathway in the directed mode with a multi-group (<bold>D</bold>) and a longitudinal design (<bold>E</bold>), each line represents the trend of the average abundance of one KO. Line colors indicate whether the KO is significantly enriched (orange), depleted (green) or neither (gray). (<bold>F</bold>) The network plot shows the KOs present in selected pathways; some KOs can be shared by several pathways. Big dots represent pathways, and small dots represent KOs. The colors of small dots represent the trend of KOs. The colors of the shades encircling pathways denote whether the pathway is overall up-regulated (orange) or down-regulated (green). (<bold>G</bold>) The heatmap displays the abundance of each KO in a pathway for different samples (columns). (<bold>H</bold>) The circular packing plot shows the hierarchical relationship of selected pathways; the size of the circle indicates the absolute value of the reporter score, and the color of the circle indicates that the pathway is overall up-regulated (orange) and down-regulated (green).</p>
          </caption>
          <graphic xlink:href="bbae116f1" position="float"/>
        </fig>
      </sec>
      <sec id="sec5b">
        <title>(2) Converting the <italic toggle="yes">P</italic>-values into <italic toggle="yes">Z</italic>-scores</title>
        <p>For the classic mixed RSA, we used an inverse normal cumulative distribution function (<inline-formula><tex-math notation="LaTeX" id="ineq13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\theta}^{-1}$\end{document}</tex-math></inline-formula>) to convert the <italic toggle="yes">P</italic>-values of KOs into <italic toggle="yes">Z</italic>-scores. Thus, assuming uniformly distributed <italic toggle="yes">P</italic>-values under the random data assumption ranges, the resulting <italic toggle="yes">Z</italic>-scores will follow a standard normal distribution (<xref rid="f1" ref-type="fig">Figure 1A</xref>), and the formula is</p>
        <disp-formula id="deqn01">
          <label>(1)</label>
          <tex-math notation="LaTeX" id="DmEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} {Z}_{K{O}_i}={\theta}^{-1}\left(1-{p}_{K{O}_i}\right) \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>For the new directed RSA, we first divided the <italic toggle="yes">P</italic>-values by 2, transforming the range of <italic toggle="yes">P</italic>-values from <inline-formula><tex-math notation="LaTeX" id="ineq14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\left(0,1\right]$\end{document}</tex-math></inline-formula> to <inline-formula><tex-math notation="LaTeX" id="ineq15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\left(0,0.5\right]$\end{document}</tex-math></inline-formula> :</p>
        <disp-formula id="deqn02">
          <label>(2)</label>
          <tex-math notation="LaTeX" id="DmEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} {p}_{K{O}_i}={p}_{K{O}_i}/2\kern2.00em \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>Secondly, we used an inverse normal cumulative distribution function to convert the <italic toggle="yes">P</italic>-values of KOs into <italic toggle="yes">Z</italic>-scores (equation (<xref rid="deqn01" ref-type="disp-formula">1</xref>)). When the <italic toggle="yes">P</italic>-value is 0.5, the converted <italic toggle="yes">Z</italic>-score equals 0. Since the above <italic toggle="yes">P</italic>-values are no greater than 0.5, all converted <italic toggle="yes">Z</italic>-scores will be &gt;0 (<xref rid="f1" ref-type="fig">Figure 1A</xref>).</p>
        <p>We then determined if a KO is up-regulated or down-regulated and calculated the <inline-formula><tex-math notation="LaTeX" id="ineq16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varDelta K{O}_i$\end{document}</tex-math></inline-formula>.</p>
        <p>In a differential abundance analysis (two-group design):</p>
        <disp-formula id="deqn03">
          <label>(3)</label>
          <tex-math notation="LaTeX" id="DmEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \varDelta K{O}_i=\overline{K{O}_{i_{g1}}}-\overline{K{O}_{i_{g2}}} \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p><inline-formula><tex-math notation="LaTeX" id="ineq17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\overline{K{O}_{i_{g1}}}$\end{document}</tex-math></inline-formula> is the average abundance of <inline-formula><tex-math notation="LaTeX" id="ineq18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> in group 1, and <inline-formula><tex-math notation="LaTeX" id="ineq19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\overline{K{O}_{i_{g2}}}$\end{document}</tex-math></inline-formula> is the average abundance of <inline-formula><tex-math notation="LaTeX" id="ineq20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> in group 2.</p>
        <p>In a correlation analysis (two-group, multi-group and longitudinal design):</p>
        <disp-formula id="deqn04">
          <label>(4)</label>
          <tex-math notation="LaTeX" id="DmEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \varDelta K{O}_i={\rho}_{K{O}_i} \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p><inline-formula><tex-math notation="LaTeX" id="ineq21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\rho}_{K{O}_i}$\end{document}</tex-math></inline-formula> is the correlation coefficient between <inline-formula><tex-math notation="LaTeX" id="ineq22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> and the numeric variable.</p>
        <p>Finally, assign a plus or minus sign to each <italic toggle="yes">Z</italic>-score:</p>
        <disp-formula id="deqn05">
          <label>(5)</label>
          <tex-math notation="LaTeX" id="DmEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} {Z}_{K{O}_i}=\left\{\begin{array}{@{}cc}-{Z}_{K{O}_i},&amp; \left(\varDelta K{O}_i&lt;0\right)\\{}+{Z}_{K{O}_i},&amp; \left(\varDelta K{O}_i\ge 0\right)\end{array}\right. \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>Therefore, a <inline-formula><tex-math notation="LaTeX" id="ineq23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> with a <inline-formula><tex-math notation="LaTeX" id="ineq24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_i}$\end{document}</tex-math></inline-formula> &gt;0 is up-regulated and a <inline-formula><tex-math notation="LaTeX" id="ineq25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> with a <inline-formula><tex-math notation="LaTeX" id="ineq26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_i}$\end{document}</tex-math></inline-formula> &lt;0 is down-regulated.</p>
      </sec>
      <sec id="sec5c">
        <title>(3) Scoring the pathway</title>
        <p>We next used the <italic toggle="yes">Z</italic>-scores of KOs to score the pathway. First, choose a pathway database as the reference. It is of particular interest to note any hierarchy relational table (e.g. KEGG, taxonomy database) can be used as a reference as long as the relationship between the upstream and downstream features (e.g. pathways and KOs) can be represented by a bipartite network (<xref rid="f1" ref-type="fig">Figure 1A</xref>). For each pathway in the selected database, calculate the <italic toggle="yes">Z</italic>-score of pathway <italic toggle="yes">j</italic> (<inline-formula><tex-math notation="LaTeX" id="ineq27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula>) as follows:</p>
        <disp-formula id="deqn06">
          <label>(6)</label>
          <tex-math notation="LaTeX" id="DmEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} {Z}_{pat{h}_j}=\frac{1}{\sqrt{k_j}}\sum_{i=1}^{k_j}{Z}_{K{O}_i} \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ineq28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_i}$\end{document}</tex-math></inline-formula> is the <italic toggle="yes">Z</italic>-score of <inline-formula><tex-math notation="LaTeX" id="ineq29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> within <inline-formula><tex-math notation="LaTeX" id="ineq30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$pat{h}_j$\end{document}</tex-math></inline-formula>, and <inline-formula><tex-math notation="LaTeX" id="ineq31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula> denotes the total number of KOs in <inline-formula><tex-math notation="LaTeX" id="ineq32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$pat{h}_j$\end{document}</tex-math></inline-formula>.</p>
        <p>Next, we corrected <inline-formula><tex-math notation="LaTeX" id="ineq33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula> using the randomly sampled <inline-formula><tex-math notation="LaTeX" id="ineq34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula> from the background distribution of the <italic toggle="yes">Z</italic>-scores of all KOs (<inline-formula><tex-math notation="LaTeX" id="ineq35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_{all}}=\big\{{Z}_{K{O}_1},{Z}_{K{O}_2},\dots, {Z}_{K{O}_j}\big\}$\end{document}</tex-math></inline-formula>) to evaluate the significance of enrichment. Specifically, for a given pathway <inline-formula><tex-math notation="LaTeX" id="ineq36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$pat{h}_j$\end{document}</tex-math></inline-formula> including <inline-formula><tex-math notation="LaTeX" id="ineq37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula> KOs, we randomly sampled the same number (<inline-formula><tex-math notation="LaTeX" id="ineq38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j$\end{document}</tex-math></inline-formula>) of KOs from the background <inline-formula><tex-math notation="LaTeX" id="ineq39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_{all}}$\end{document}</tex-math></inline-formula> without replacement, and calculated the <inline-formula><tex-math notation="LaTeX" id="ineq40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula>, for <italic toggle="yes">N</italic> times (<italic toggle="yes">N</italic> = 10 000 in this study [<xref rid="ref15" ref-type="bibr">15</xref>]). We then standardized <inline-formula><tex-math notation="LaTeX" id="ineq41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula> by subtracting the mean (<inline-formula><tex-math notation="LaTeX" id="ineq42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\mu}_{k_j}$\end{document}</tex-math></inline-formula>) and dividing by the standard deviation (<inline-formula><tex-math notation="LaTeX" id="ineq43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\sigma}_{k_j}$\end{document}</tex-math></inline-formula>) of the <inline-formula><tex-math notation="LaTeX" id="ineq44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula> distribution. The standardized <inline-formula><tex-math notation="LaTeX" id="ineq45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula> is the <inline-formula><tex-math notation="LaTeX" id="ineq46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$ReporterScor{e}_j$\end{document}</tex-math></inline-formula>. The <italic toggle="yes">P</italic>-value of <inline-formula><tex-math notation="LaTeX" id="ineq47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$ReporterScor{e}_j$\end{document}</tex-math></inline-formula> is also estimated by the above permutation. The formulas for the reporter scores and associated <italic toggle="yes">P</italic>-values are</p>
        <disp-formula id="deqn07">
          <label>(7)</label>
          <tex-math notation="LaTeX" id="DmEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} ReporterScor{e}_j=\frac{Z_{pat{h}_j}-{\mu}_{k_j}}{\sigma_{k_j}} \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn08">
          <label>(8)</label>
          <tex-math notation="LaTeX" id="DmEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} p\_ valu{e}_j=\frac{\sum_{n=1}^NI\left({Z}_{pat{h}_j},{Z}_{pat h\_ nul{l}_{jn}}\right)+1}{N+1}\kern1em \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ineq48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula> have the same <inline-formula><tex-math notation="LaTeX" id="ineq49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$k$\end{document}</tex-math></inline-formula> to <inline-formula><tex-math notation="LaTeX" id="ineq50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ineq51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\mu}_{k_j}$\end{document}</tex-math></inline-formula> is the mean of the randomly generated <italic toggle="yes">N</italic><inline-formula><tex-math notation="LaTeX" id="ineq52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ineq53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\sigma}_{k_j}$\end{document}</tex-math></inline-formula> is the standard deviation of the randomly generated <italic toggle="yes">N</italic><inline-formula><tex-math notation="LaTeX" id="ineq54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula>.</p>
        <p>For the classic mixed RSA:</p>
        <disp-formula id="deqn09">
          <label>(9)</label>
          <tex-math notation="LaTeX" id="DmEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} I\left(a,b\right)=\left\{\begin{array}{@{}cc}1&amp; \left(a\ge b\right)\\{}0&amp; \left(a&lt;b\right)\end{array}\right. \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>For the new directed RSA:</p>
        <disp-formula id="deqn10">
          <label>(10)</label>
          <tex-math notation="LaTeX" id="DmEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} I\left(a,b\right)=\left\{\begin{array}{@{}cc}1&amp; \left( ReporterScor{e}_j\ge 0\&amp;a\ge b\right)\\{}1&amp; \left( ReporterScor{e}_j&lt;0\&amp;a\le b\right)\\{}0&amp; \left(\mathrm{Otherwise}\right)\end{array}\right. \end{equation*}\end{document}</tex-math>
        </disp-formula>
      </sec>
    </sec>
    <sec id="sec6">
      <title>Statistical analyses</title>
      <p>All statistical analyses were done on the R 4.2.2 platform. The developed ReporterScore package (<ext-link xlink:href="https://cran.r-project.org/web/packages/ReporterScore/" ext-link-type="uri">https://cran.r-project.org/web/packages/ReporterScore/</ext-link>) was used for GRSA and visualization. The Venn diagram and Venn network diagram were drawn by the pcutils package (<ext-link xlink:href="https://cran.r-project.org/web/packages/pcutils/" ext-link-type="uri">https://cran.r-project.org/web/packages/pcutils/</ext-link>). We collected several datasets for benchmarking and three different type omics datasets as case study [<xref rid="ref16" ref-type="bibr">16–18</xref>]. Details of these datasets can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Notes</xref>.</p>
      <p>To compare the performance of different statistical methods in the two-group experimental design, we defined a Jaccard similarity index:</p>
      <disp-formula id="deqn11">
        <label>(11)</label>
        <tex-math notation="LaTeX" id="DmEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \mathrm{Similarity}=\frac{\left| method(i)\cap method(j)\right|}{\left| method(i)\cup method(j)\right|}\kern2.00em \end{equation*}\end{document}</tex-math>
      </disp-formula>
      <p>where <italic toggle="yes">method</italic>(<italic toggle="yes">i</italic>) (<italic toggle="yes">method</italic>(<italic toggle="yes">j</italic>)) is the number of significant pathways based on benchmark data sets enriched by different methods.</p>
      <p>We used fuzzy c-means (FCM) clustering to explore the performance of different statistical test methods in multi-group experimental design (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2B,C</xref>) and gene expression patterns in transcriptome (<xref rid="f4" ref-type="fig">Figure 4A</xref>). FCM is an unsupervised machine-learning technique that partitions a population into groups or clusters [<xref rid="ref19" ref-type="bibr">19</xref>]. Three methods (Elbow, Silhouette and Gap statistic) were used to determine the optimal number of clusters. In FCM, the membership score is the probability that a feature belongs to a cluster. Each feature is assigned to a cluster based on its highest membership score.</p>
    </sec>
    <sec id="sec7">
      <title>Comparison with other enrichment analysis methods</title>
      <p>We compared GRSA against six commonly used enrichment analysis methods (<xref rid="TB1" ref-type="table">Table 1</xref>) using 50 benchmark datasets (41 human gene expression datasets related to disease and 9 wild-type/knockout mice gene expression datasets).</p>
      <p>We first calculated the <italic toggle="yes">P</italic>-values of features by <italic toggle="yes">t</italic>-test and performed adjustment of the <italic toggle="yes">P</italic>-values using the Benjamini and Hochberg (BH) method to control for false discovery rate. In order to perform the overrepresentation analysis, we selected the genes that have <italic toggle="yes">P</italic>-values &lt;0.05. The top 400 genes with the highest unsigned log-fold changes were considered as differentially expressed genes (DEGs) [<xref rid="ref20" ref-type="bibr">20</xref>]. Improved fisher.test (CP) was performed by enricher function in the clusterProfiler package with the DEGs list. Gene set enrichment analysis (GSEA) was performed by the GSEA function in the clusterProfiler package, and the <italic toggle="yes">t</italic>-test statistic was used as the metric for ranking [<xref rid="ref21" ref-type="bibr">21</xref>]. The R packages safe, GSVA, GSA and PADOG were used to run the respective methods. GRSA and RSA were performed with the BH-adjusted <italic toggle="yes">P</italic>-values of features by the ReporterScore package in the directed and mixed mode, respectively. A number of 1000 permutations were used in all methods relying on sample or gene permutations.</p>
      <p>Each human gene expression dataset in <xref rid="sup1" ref-type="supplementary-material">Supplementary</xref><xref rid="sup1" ref-type="supplementary-material">Table S2</xref> was associated with a disease with the defined mechanism in a KEGG pathway (termed the target pathway). Ideally, a good enrichment analysis method would rank the target pathway at or near the top of the list with a small adjusted <italic toggle="yes">P</italic>-value. Our human gene expression datasets were sourced from a list provided by Nguyen et al. [<xref rid="ref22" ref-type="bibr">22</xref>]. Based on statistical and biological considerations, we selected datasets in which the number of samples was consistent between the control and treatment groups (&lt;2× difference in sample size is allowed). Furthermore, there should be a measurable overall statistical difference between the gene expressions of the two groups (Adonis <italic toggle="yes">P</italic>-value &lt;0.05). The final 24 benchmark datasets are related to 10 human diseases, and each disease is associated with 2–4 datasets. For further benchmarking analysis, we also included 32 datasets provided by the ‘GSEABenchmarkeR’ package [<xref rid="ref23" ref-type="bibr">23</xref>].</p>
      <p>For wild-type/knockout mice gene expression datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>), we searched the GEO database for mouse single-gene knockout experiments. We selected datasets where more than three pathways were impacted, as this provides a robust basic for benchmarking various methods. We considered the pathways containing the knockout gene as true positives and the pathways without the knockout gene as true negatives [<xref rid="ref22" ref-type="bibr">22</xref>]. An adjusted <italic toggle="yes">P</italic>-value threshold of 0.05 was used to determine if a pathway is significantly affected. Based on the definitions of true positives (TP), true negatives (TN), false positives (FP) and false negatives (FN), we can calculate the sensitivity and specificity as follows:</p>
      <disp-formula id="deqn12">
        <label>(12)</label>
        <tex-math notation="LaTeX" id="DmEquation12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \mathrm{Sensitivity}=\frac{TP}{TP+ FN}\kern1em \end{equation*}\end{document}</tex-math>
      </disp-formula>
      <disp-formula id="deqn13">
        <label>(13)</label>
        <tex-math notation="LaTeX" id="DmEquation13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \mathrm{Specificity}=\frac{TN}{TN+ FP}\kern1em \end{equation*}\end{document}</tex-math>
      </disp-formula>
    </sec>
  </sec>
  <sec id="sec8">
    <title>RESULTS</title>
    <sec id="sec9">
      <title>Workflow overview</title>
      <p>The ReporterScore package has built-in KEGG pathway, module, gene, compound and GO databases and also allows customized databases, making it compatible with feature abundance tables from diverse omics data. A complete gene abundance table can be used for transcriptomic, scRNA-seq and related gene-based omics data of a specific species. For metagenomic and metatranscriptomic data, which involve many different species, a KO abundance table can be used, generated using Blast, Diamond or KEGG official mapper software [<xref rid="ref24" ref-type="bibr">24</xref>] to align the reads or contigs to the KEGG [<xref rid="ref25" ref-type="bibr">25</xref>] or the EggNOG database [<xref rid="ref26" ref-type="bibr">26</xref>]. An annotated compound abundance table can be used for metabolomic data, but the standardization of compound IDs (e.g. convert compound IDs to KEGG IDs) is required.</p>
      <p>The workflow of GRSA in the ReporterScore package is shown in <xref rid="f1" ref-type="fig">Figure 1</xref>, using metagenomic data as an example. The KO abundance table (rows are KOs and columns are samples) and metadata table (rows are samples and columns are experimental design groups) were used as the input for GRSA. Importantly, the input data should not be prefiltered to retain the background information. First, the <italic toggle="yes">P</italic>-values for all KOs were calculated by a proper statistical method. Then, in the classic mode, the <italic toggle="yes">P</italic>-values were directly converted to <italic toggle="yes">Z</italic>-scores (<xref rid="f1" ref-type="fig">Figure 1A</xref>, equation [i]). In the directed mode, the <italic toggle="yes">P</italic>-values were divided by 2, converted to <italic toggle="yes">Z</italic>-scores, and assigned plus or minus signs, denoting up- and down-regulated KOs (<xref rid="f1" ref-type="fig">Figure 1A</xref>, equations [ii–iv]). Next, the <italic toggle="yes">Z</italic>-score of pathway <inline-formula><tex-math notation="LaTeX" id="ineq55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j$\end{document}</tex-math></inline-formula> (<inline-formula><tex-math notation="LaTeX" id="ineq56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula>) was calculated by summing the <italic toggle="yes">Z</italic>-scores of KOs within pathway <inline-formula><tex-math notation="LaTeX" id="ineq57">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j$\end{document}</tex-math></inline-formula> and dividing by the square root of the number of KOs (<inline-formula><tex-math notation="LaTeX" id="ineq58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula>) in pathway <inline-formula><tex-math notation="LaTeX" id="ineq59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j$\end{document}</tex-math></inline-formula> (Figure 1A, equation [v]). The <inline-formula><tex-math notation="LaTeX" id="ineq60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula> is further standardized by the background pathway <italic toggle="yes">Z</italic>-score distribution, generated by randomly sampling <inline-formula><tex-math notation="LaTeX" id="ineq61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula> KOs from the total KO pool (<xref rid="f1" ref-type="fig">Figure 1A</xref>, equation [vi]). The standardized pathway <italic toggle="yes">Z</italic>-score is defined as the reporter score of a pathway (<inline-formula><tex-math notation="LaTeX" id="ineq62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$ReporterScor{e}_j$\end{document}</tex-math></inline-formula>).</p>
      <p>We designed the ReporterScore package to be user-friendly. In one step, the function reporter_score calculates the reporter scores for a feature abundance table with associated metadata. The included assorted visualization methods can be used to explore the entire pathways and features within pathways (<xref rid="f1" ref-type="fig">Figure 1B–H</xref>). The demo code is included in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Notes</xref>.</p>
    </sec>
    <sec id="sec10">
      <title>Applying GRSA to multi-group and longitudinal omics data</title>
      <p>An important feature of GRSA is the newly developed directed mode. The key difference between the directed mode and the mixed mode (classic RSA) is that in the directed mode, the reporter score’s plus or minus sign indicates the pathway’s increasing or decreasing trend (<xref rid="f1" ref-type="fig">Figure 1C</xref>). However, in the mixed mode, the signs of the reporter score do not indicate the trends of the pathways. We performed GRSA on the public ex_KO_profile dataset (a metagenomic dataset) in two modes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1A</xref>). For pathways enriched in the directed mode, most KOs within the pathway shared the same trend. The pathway with consistently increasing (decreasing) KOs would acquire a significantly bigger (smaller) aggregated <italic toggle="yes">Z</italic>-score than the background (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref>, blue and red boxes). If KOs within a pathway had opposing trends, the signed <italic toggle="yes">Z</italic>-scores would cancel each other, leading to insignificant results (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref>, orange box). In comparison, in the mixed mode, the increasing and decreasing trend of the enriched pathway cannot be determined (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1C</xref>). Therefore, the directed mode helps find pathways with consistently changing KOs. Several previous studies aimed for the result of the directed mode but mistakenly employed classic RSA (mixed mode) [<xref rid="ref14" ref-type="bibr">14</xref>].</p>
      <p>Another major advantage of GRSA is the full support of multi-group and longitudinal omics data. The ReporterScore package calculates the <italic toggle="yes">P</italic>-value for each feature between groups using differential abundance analysis or correlation analysis. The Kruskal–Wallis test or ANOVA assesses if the feature abundance varies significantly across multiple groups. The default correlation analysis treats group assignments as ordinal (e.g. groups ‘G1’, ‘G2’ and ‘G3’ will be converted to 1, 2 and 3), so the correlation analysis could evaluate if the feature abundance linearly increases or decreases. Moreover, the ReporterScore package also supports any specified patterns. For example, groups ‘G1’, ‘G2’ and ‘G3’ can be set as 1, 10, and 100 if an exponentially increasing trend is expected. To explore potential patterns within the data, clustering methods, such as C-means clustering, can be used.</p>
      <p>As a general rule, the users must ensure the selected statistical methods are applicable to the datasets and experimental designs. We applied GRSA with different statistical methods on multiple benchmark datasets. For the classic two-group design, the Jaccard similarity exceeded 0.84 for parametric methods and 0.78 for non-parametric methods, but the Jaccard similarity between parametric and non-parametric methods was lower than 0.63 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2A</xref>). The differences mainly stemmed from parametric versus non-parametric methods. For the multi-group data, users can choose the differential abundance analyses if they aim to enrich significantly altered pathways across groups. Correlation analysis is the preferred choice if the goal is to enrich pathways that show consistent increasing or decreasing patterns (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2B,C</xref>). Lastly, GRSA also supports other statistical tests, such as ‘DESeq2’, ‘Edger’, ‘Limma’, ‘ALDEX’ and ‘ANCOM’ [<xref rid="ref27" ref-type="bibr">27</xref>], to calculate the reporter scores. The demo code is shown in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Notes</xref>.</p>
      <fig position="float" id="f2">
        <label>Figure 2</label>
        <caption>
          <p>Comparisons of GRSA and other commonly used methods of enrichment analyses. (<bold>A</bold>–<bold>B</bold>) The box charts show the ranks (<bold>A</bold>) and adjusted <italic toggle="yes">P</italic>-values (<bold>B</bold>) of target pathways derived by four methods on 24 gene expression datasets. Numbers represent the median values for each method. (<bold>C</bold>–<bold>D</bold>) The box charts show the sensitivity (<bold>C</bold>) and specificity (<bold>D</bold>) of four methods on nine wild-type/knockout gene expression datasets. Numbers represent the median values for each method. CP: improved Fisher’s exact test used by the clusterProfiler package; GSEA: gene set enrichment analysis; SAFE: significance analysis of function and expression; GSA: gene set analysis in the GSA package; PADOG: pathway analysis with down-weighting of overlapping genes; GSVA: gene set variation analysis; RSA: classic reporter score-based analysis; GRSA: generalized reporter score-based analysis.</p>
        </caption>
        <graphic xlink:href="bbae116f2" position="float"/>
      </fig>
    </sec>
    <sec id="sec11">
      <title>GRSA showed higher sensitivity than other commonly used enrichment analysis methods</title>
      <p>Next, we evaluated the performance of GRSA and compared it with other commonly used enrichment analysis methods (<xref rid="TB1" ref-type="table">Table 1</xref>) on several benchmark datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables 2</xref>, <xref rid="sup1" ref-type="supplementary-material">3</xref> and the GEO list from ‘GSEABenchmarkeR’ package). PT-based methods may better identify biologically meaningful pathways than non-PT-based methods in certain scenarios [<xref rid="ref22" ref-type="bibr">22</xref>]. However, PT-based methods require comprehensive topological structures of pathways, limiting their applications in other non-human organisms [<xref rid="ref28" ref-type="bibr">28</xref>]. Therefore, we focused on the comparison against non-PT enrichment analysis methods. Nguyen et al. proposed several approaches to compare enrichment methods [<xref rid="ref22" ref-type="bibr">22</xref>], and we adapted their methodologies and evaluated the performance of GRSA against the other popular enrichment analysis methods using the identical pathway database (KEGG v109.0).</p>
      <p>We first compared the efficacy of different methods in identifying the target disease pathways using the 24 gene expression datasets associated with known human diseases (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). The rationale is that since each dataset is affiliated with a specific disease-linked KEGG pathway (the target pathway), an optimal enrichment analysis method should rank the target pathway among the top of all 342 pathways and enrich the target pathway with a smaller adjusted <italic toggle="yes">P</italic>-value. The results indicate that in terms of assigning a smaller rank to the target pathway, PADOG, GSA, GRSA, GSEA and SAFE performed similarly, as their median ranks all fall within the top 20% (<xref rid="f2" ref-type="fig">Figure 2A</xref>). In addition, GRSA achieves the lowest median adjusted <italic toggle="yes">P</italic>-values of the target pathways (<xref rid="f2" ref-type="fig">Figure 2B</xref>). We also used datasets from a GEO list provided by ‘GSEABenchmarkeR’ for further benchmarking and found similar results (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3A</xref>, <xref rid="sup1" ref-type="supplementary-material">B</xref>). Overall, GRSA’s performance is quite favorable among the threshold-free FCS methods, outperforming the conventional ORA method.</p>
      <p>We next evaluated the proficiency of different methods in detecting pathways disturbed by gene knockout experiments. In a gene knockout experiment, the knockout gene is a confirmed source of perturbation. Nguyen et al. considered pathways that included the knockout genes as true positives and pathways not including the target genes as true negatives, so the enrichment of such pathways would be considered false positives. Under these assumptions, we could calculate the sensitivity and specificity of a method. GRSA showed the highest median sensitivity among the methods considered, although its specificity is slightly reduced compared to others (<xref rid="f2" ref-type="fig">Figure 2C, D</xref>). We prioritize the sensitivity of a method because for pathways that included the knockout gene, deleting it should have a sizable impact on the pathway (sensitivity); however, for pathways that do not include the knockout gene in the database, given the potential incompleteness of pathway and gene databases, simply attributing these enriched pathways as false positives (specificity) may not always be appropriate.</p>
      <p>Lastly, we evaluated the ability of different methods to enrich biologically meaningful pathways [<xref rid="ref10" ref-type="bibr">10</xref>]. We compared the proportions of pathways identified by the GRSA, the competing tool and both, using the number of all significant pathways as the denominator (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3C</xref>). GRSA consistently identified a larger proportion of pathways than the ORA method and largely overlapped with GSEA. In these datasets, GRSA identified more enriched pathways than GSEA. For example, in the renal cell carcinoma dataset (GSE6344), pathways related to cytokine−cytokine receptor interaction [<xref rid="ref29" ref-type="bibr">29</xref>], IL-17 signaling [<xref rid="ref30" ref-type="bibr">30</xref>] and PI3K–Akt signaling [<xref rid="ref31" ref-type="bibr">31</xref>] were only enriched by GRSA (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4A</xref>). In the endometrial cancer dataset (GSE7305), GRSA identified pathways related to cancer, Toll-like receptor [<xref rid="ref32" ref-type="bibr">32</xref>] and cortisol synthesis [<xref rid="ref33" ref-type="bibr">33</xref>], which have been shown to be involved in the pathological characteristics of endometrial cancer (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4B</xref>). Therefore, GRSA can potentially identify more pathways biologically relevant to the studied diseases.</p>
    </sec>
    <sec id="sec12">
      <title>Case study 1: the functional analysis and age-related dynamics of the skin microbiota</title>
      <p>Next, we showcased the versatile applications of GRSA with different types of omics data. For microbiome data, we collected the KO profile of the IHSMGC (integrated Human Skin Microbial Gene Catalog) dataset published by Wang et al. [<xref rid="ref17" ref-type="bibr">17</xref>] and re-analyzed the data using the GRSA method. The previous study calculated the pathway abundance by aggregating the abundances of features within a pathway and then performed differential abundance analysis. We applied the GRSA to find the functional differences between the two cutotypes. The results were largely consistent. As an example, modules related to the biosynthesis of thiamine, phylloquinone and cobalamin were enriched in the <italic toggle="yes">M-cutotype</italic>, while modules related to tetrahydrofolate, menaquinone, pantothenate and ubiquinone were enriched in the <italic toggle="yes">C-cutotype</italic> (<xref rid="f3" ref-type="fig">Figure 3A</xref>). In addition, the <italic toggle="yes">M-cutotype</italic> was enriched with a large number of modules related to the metabolism of sulfur, phenylacetate (aromatic compound) and amino acids, while the <italic toggle="yes">C-cutotype</italic> was enriched with modules related to carbohydrate metabolism (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>). Importantly, GRSA also identified pathways not found in the previous study. The <italic toggle="yes">M-cutotype</italic> was enriched with modules related to nucleotide metabolism, such as the degradation and <italic toggle="yes">de novo</italic> biosynthesis of purine (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>), indicating that the <italic toggle="yes">M-cutotype</italic> microbiota may have a higher nucleotide turnover rate and stronger proliferation [<xref rid="ref34" ref-type="bibr">34</xref>].</p>
      <fig position="float" id="f3">
        <label>Figure 3</label>
        <caption>
          <p>Application of GRSA to the skin microbiome of the IHSMGC dataset. (<bold>A</bold>) The network of KO-Module enriched in the <italic toggle="yes">M-cutotype</italic> (green) and <italic toggle="yes">C-cutotype</italic> (blue). Only modules related to vitamin biosynthesis were shown. Big dots represent modules; small dots represent KOs. The colors of small dots represent cutotypes. Shades indicate modules involved in the biosynthesis of the same vitamin. The colors of shades denote modules enriched in the <italic toggle="yes">M-cutotype</italic> (green) or enriched in the <italic toggle="yes">C-cutotype</italic> (blue). (<bold>B</bold>–<bold>C</bold>) The box charts of modules ‘M00866’ (<bold>B</bold>) and ‘M00061’ (<bold>C</bold>) across ages. The colors of the lines represent the trend of KO’s relative abundance in the module. ‘M00866’ had the biggest positive reporter score (increasing), while ‘M00061’ had the biggest absolute value of negative score (decreasing). (<bold>D</bold>) The bar charts show significantly enriched modules over aging; the reporter score threshold of 2.5 corresponds to a confidence of about 0.995, and these modules are grouped based on the KEGG level B. Colors denote up-regulated (red) or down-regulated (green) modules with aging.</p>
        </caption>
        <graphic xlink:href="bbae116f3" position="float"/>
      </fig>
      <p>The previous study divided samples into five aging groups and found that the prevalence of the <italic toggle="yes">M-cutotype</italic> significantly increased with age. However, they did not perform age-related functional analysis. We re-analyzed the multi-group data using GRSA to explore the functional dynamics related to aging. The larger positive reporter scores indicate that the module had an overall increasing trend with respect to age, such as ‘M00866’, related to lipid A biosynthesis (<xref rid="f3" ref-type="fig">Figure 3B</xref>), while modules with negative reporter scores show an overall decreasing trend with respect to age, such as ‘M00061’, related to <sc>d</sc>-glucuronate degradation (<xref rid="f3" ref-type="fig">Figure 3C</xref>). We next analyzed the chronological trend of the functional modules at the KEGG level B (<xref rid="f3" ref-type="fig">Figure 3D</xref>), which better reflects the overall metabolic activities of the microbiome. We found that the carbohydrate metabolism activity of the skin microbiota decreased with aging, while the lipid, amino acid and nucleotide metabolism activity increased with aging. These results suggest that the energy sources of the skin microbiota significantly change with aging.</p>
      <p>The vitamin biosynthesis-related functional modules also showed differences with respect to aging (<xref rid="f3" ref-type="fig">Figure 3D</xref>). For the glycan metabolism-related functional modules, biosynthesis of KDO2-lipid A and CMP-KDO increased with aging. KDO2-lipid A is an essential lipopolysaccharide (LPS) component in most gram-negative bacteria, which has endotoxin activity and stimulates host immune responses through Toll-like receptor 4 (TLR4) [<xref rid="ref35" ref-type="bibr">35</xref>]. CMP-KDO is an important intermediate in the synthesis of KDO2-lipid A, and CMP-KDO synthesis is the key rate-limiting step for introducing KDO into LPS [<xref rid="ref36" ref-type="bibr">36</xref>]. These results suggest that the microbiota of aging skins likely accumulated endotoxins, which can stimulate host inflammation. In addition, we found that degradation pathways of several sulfated glycosaminoglycans (chondroitin sulfate, dermatan sulfate and keratan sulfate) decreased in aging skin. Sulfated glycosaminoglycans play a key role in regulating skin physiology, and there is ample evidence that their properties and functions change over time and with extrinsic skin aging [<xref rid="ref37" ref-type="bibr">37</xref>, <xref rid="ref38" ref-type="bibr">38</xref>]. Total sulfated glycosaminoglycan abundance was reduced in aging skin [<xref rid="ref39" ref-type="bibr">39</xref>], which may lead to the decreased degrading ability of the skin microbiota for the sulfated glycosaminoglycans.</p>
    </sec>
    <sec id="sec13">
      <title>Case study 2: the functional transcriptional dynamics during cardiomyocyte differentiation</title>
      <p>We applied GRSA to the transcriptomic dataset published by Liu et al. in 2017 [<xref rid="ref18" ref-type="bibr">18</xref>]. The study used the weighted gene co-expression network analysis (WGCNA) method to analyze the temporal transcriptomic changes during the differentiation of cardiomyocytes from 2 hiPSC lines and 2 hESC lines at 4 timepoints (pluripotent stem cells at day 0, mesoderm at day 2, cardiac mesoderm at day 4 and differentiated cardiomyocytes at day 30). Significant changes were observed in the four stages of differentiation among all cell lines. For example, genes in module 1 were highly expressed only in differentiated cardiomyocytes (stage CM), and their enriched Gene Ontology (GO) terms of Biological Process were related to heart functions, such as regulation of cardiac contraction and muscular system processes. WGCNA did not assume the patterns to be linear so that genes can be only highly expressed at day 2 during mesoderm development, for example.</p>
      <p>In addition to linearly increasing or decreasing patterns, GRSA allows users to specify any expected patterns for enrichment analysis. To start, we used the fuzzy C-means clustering method to identify the main gene expression patterns (<xref rid="f4" ref-type="fig">Figure 4A</xref>) and then used these patterns for GRSA to obtain significantly enriched pathways in each pattern (using the RSA_by_cm function in the ReporterScore package). For example, ‘Heart process (GO:0003015)’ was a significantly enriched GO term for Cluster 6, which was highly expressed only in stage CM (day 30). We identified many genes consistent with the expression pattern of Cluster 6 (<xref rid="f4" ref-type="fig">Figure 4B</xref>).</p>
      <fig position="float" id="f4">
        <label>Figure 4</label>
        <caption>
          <p>Application of GRSA to the transcriptomic dataset on the cardiomyocyte differentiation processes. (<bold>A</bold>) C-means clustering result of gene abundance profiles across four differentiation stages. The genes with membership scores greater than 0.8 are displayed. The alpha (transparency) of each line was related to the value of its membership score, and the <italic toggle="yes">y</italic>-axis represents the standardized abundance. (<bold>B</bold>) The box chart shows the abundance of genes in ‘GO:0003015’ (heart process) across four time points; the colors of the lines represent the correlative significance of each gene with Cluster 6 within the GO term. ‘GO:0003015’ is a representative term of Cluster 6. (<bold>C</bold>) The bar chart shows significantly enriched GO terms for each clustering pattern corresponding to the differentiation stages. The colors of the bars represent the cluster information, and the representative GO terms with high reporter scores in each cluster are shown. The text labels on the left are colored according to the stages with the highest expression. In general, Cluster 2 corresponds to day 0, Clusters 4 and 5 correspond to day 2, Cluster 1 corresponds to day 4, and Clusters 3 and 6 correspond to CM. Note that only pathways with significant positive scores are shown. The negative score of specified patterns would indicate anti-correlative patterns, which should have already been identified by c-means analysis, such as Cluster 3 versus 4.</p>
        </caption>
        <graphic xlink:href="bbae116f4" position="float"/>
      </fig>
      <p>GRSA results for all clusters are shown in <xref rid="f4" ref-type="fig">Figure 4C</xref>. Cluster 2 was highly expressed only at day 0, and its enriched GO terms were mainly related to the mitotic cell cycle, which was expected for stem cell self-renewal processes. Cluster 5 had the highest expression level on day 2 and was mainly enriched in various transcription and translation processes. Cluster 4 was highly expressed at day 0 and day 2 and showed a gradually decreasing trend; its function overlapped with Clusters 2 and 5. Cluster 1, highly expressed at day 4, was related to mesoderm formation, such as morphogenesis and organ development. Clusters 3 and 6 were primarily up-regulated in differentiated cardiomyocytes (CM stage), and they were related to heart functions, such as regulation of heart contraction and muscle system processes, similar to module 1 in the previous study. Interestingly, the biological processes of hiPSCs/hESCs at day 2 (Cluster 5) induced various RNA-related metabolisms, which were not found in the previous study, indicating that complex transcriptional regulations are involved for further mesoderm formation. Therefore, using the identified expression patterns across groups, we successfully identified pathways and modules essential to different stages of the cardiomyocyte differentiation processes.</p>
    </sec>
    <sec id="sec14">
      <title>Case study 3: the systematic maternal metabolomic changes correlated with gestational age</title>
      <p>We next applied GRSA to metabolomic data from a Danish pregnancy cohort in which female participants had blood drawn weekly from pregnancy to the postpartum period for untargeted metabolomics analysis [<xref rid="ref16" ref-type="bibr">16</xref>]. Using gestational age as the study variable, they modeled a metabolic clock and found that several marker metabolites increased linearly with gestational age.</p>
      <p>We found several important pathways up-regulated with gestational age: steroid hormone biosynthesis, cortisol synthesis and secretion, and oocyte meiosis (<xref rid="f5" ref-type="fig">Figure 5A</xref>). Multiple steroid hormones were up-regulated with increasing gestational age (<xref rid="f5" ref-type="fig">Figure 5B</xref>), including progesterone that interacts with the hypothalamic–pituitary–adrenal axis [<xref rid="ref40" ref-type="bibr">40</xref>] and estriol-16-glucuronide produced by the placenta [<xref rid="ref41" ref-type="bibr">41</xref>]. At the same time, two androgen-related steroid hormones were down-regulated: dehydroepiandrosterone sulfate and androsterone 3-glucuronide, as the concentration of androgens plays important physiological functions during pregnancy [<xref rid="ref42" ref-type="bibr">42</xref>]. We also found that pathways related to the metabolism of aromatic amino acids were down-regulated with increasing gestational age (<xref rid="f5" ref-type="fig">Figure 5A</xref>), which has been reported [<xref rid="ref43" ref-type="bibr">43</xref>].</p>
      <fig position="float" id="f5">
        <label>Figure 5</label>
        <caption>
          <p>Application of GRSA in the metabolic data of the Danish pregnancy cohort and the taxonomic enrichment analysis of the IHSMGC dataset. (<bold>A</bold>) The circle packing chart shows the hierarchical relationships of significantly enriched pathways identified by GRSA in the metabolomic study. The size of the circle indicates the absolute value of the reporter score, and the color of the circle indicates the sign of the reporter score. The positive reporter score indicates the pathway was increased (orange), while the negative reporter score indicates the pathway was decreased (purple). (<bold>B</bold>) The heatmap shows the abundance of metabolites in the pathway ‘steroid hormone biosynthesis’. The columns are samples ordered by the increasing gestational age. (<bold>C</bold>) The bar chart shows significantly enriched genera in the <italic toggle="yes">C-cutotype</italic> and <italic toggle="yes">M-cutotype</italic>. (<bold>D</bold>) The network plot shows the species in <italic toggle="yes">g_Moraxella</italic> and <italic toggle="yes">g_Cutibacterium</italic> enriched in the <italic toggle="yes">M-cutotype</italic> (green) or <italic toggle="yes">C-cutotype</italic> (blue).</p>
        </caption>
        <graphic xlink:href="bbae116f5" position="float"/>
      </fig>
      <p>Importantly, we identified several up-regulated pathways related to human diseases not mentioned in the previous study. Cushing syndrome happens when the body has too much of the hormone cortisol for a long time, which could be induced by a healthy pregnancy [<xref rid="ref44" ref-type="bibr">44</xref>]. The up-regulation of pathways related to breast cancer was also noticeable, as pregnancy-associated breast cancer (PABC) accounts for 7% of all breast cancer in young women [<xref rid="ref45" ref-type="bibr">45</xref>]. More potential discoveries can be made if the metabolite-pathway database is improved.</p>
    </sec>
    <sec id="sec15">
      <title>Case study 4: the application of GRSA beyond functional enrichment analysis</title>
      <p>The algorithm of GRSA suggests that any features organized in a hierarchical relationship can be used as an enrichment database. For example, we can perform taxonomic enrichment analysis using the phylogenetic relationships of microbes, such as genus–species relationships. To demonstrate, with the custom_modulelist function, we used the species abundance table from the IHSMGC dataset and looked for genera enriched in the two cutotypes. We found that <italic toggle="yes">Psychrobacter</italic>, <italic toggle="yes">Paracoccus</italic>, <italic toggle="yes">Chryseobacterium</italic>, <italic toggle="yes">Elizabethkingia</italic>, <italic toggle="yes">Deinococcus</italic> and <italic toggle="yes">Microbacterium</italic> were enriched in the <italic toggle="yes">M-cutotype</italic>, while <italic toggle="yes">Acidipropionibacterium</italic>, <italic toggle="yes">Staphylococcus</italic>, <italic toggle="yes">Corynebacterium</italic> and <italic toggle="yes">Cutibacterium</italic> were enriched in the <italic toggle="yes">C-cutotype</italic> (<xref rid="f5" ref-type="fig">Figure 5C</xref>), some of which were highly consistent with the differential species modules found by co-occurrence network in the previous study. However, we additionally found some genera, such as <italic toggle="yes">Brevundimonas</italic> and <italic toggle="yes">Rhodobacter</italic>, enriched in the <italic toggle="yes">M-cutotype</italic>, while <italic toggle="yes">Pahexavirus</italic> (phages of <italic toggle="yes">Propionibacterium</italic> and <italic toggle="yes">Cutibacterium</italic>) was enriched in the <italic toggle="yes">C-cutotype</italic> (<xref rid="f5" ref-type="fig">Figure 5C</xref>), probably due to the higher sensitivity of GRSA.</p>
      <p>Two species, <italic toggle="yes">Moraxella osloensis</italic> and <italic toggle="yes">Cutibacterium acnes</italic>, were used to define the cutotype in the previous study. Interestingly, while the <italic toggle="yes">Cutibacterium</italic> genus was a good biomarker between cutotypes, the <italic toggle="yes">Moraxella</italic> genus was not, as the included species did not share the same trend (<xref rid="f5" ref-type="fig">Figure 5D</xref>). Therefore, in addition to functional enrichment analysis, GRSA can be extended to any hierarchical relational data structure.</p>
    </sec>
  </sec>
  <sec id="sec16">
    <title>DISCUSSION</title>
    <p>We developed the ReporterScore package and demonstrated broad applications of the GRSA enrichment analyses. We improved the classic RSA method for easier interpretation of the plus and minus signs of the reporter scores. More importantly, we expanded the scope of GRSA from two-group designs to multi-group and longitudinal designs. We demonstrated these new features with metagenomic, transcriptomic and metabolomic data (<xref rid="f3" ref-type="fig">Figures 3</xref>–<xref rid="f5" ref-type="fig">5</xref>). Lastly, we showed that the GRSA is not limited to functional enrichment analysis. Notably, all figures were generated using the visualization module in the ReporterScore package.</p>
    <p>GRSA considers all KOs involved in the pathway compared to hypergeometric tests that only consider a pre-defined list (e.g. KO/gene with <italic toggle="yes">P</italic>-value &lt; 0.05). Thus, GRSA is more sensitive and can comprehensively assess the feature abundance differences in the pathway (<xref rid="f2" ref-type="fig">Figure 2</xref>). GRSA still has some limitations: (1) GRSA exhibits a slightly lower specificity, underscoring the necessity for additional experimental validations. (2) GRSA relies on <italic toggle="yes">Z</italic>-scores derived from <italic toggle="yes">P</italic>-values as the statistical measure, which depends on the upstream statistical methods. Users are required to select appropriate statistical methods based on the nature of the data and experimental design. (3) GRSA is a competitive enrichment analysis method that relies on the key assumption of feature independence [<xref rid="ref46" ref-type="bibr">46</xref>].</p>
    <p>We must acknowledge that comparing enrichment analysis methods is fraught with risks, as there is no established gold standard in the field despite continuous efforts [<xref rid="ref2" ref-type="bibr">2</xref>]. Many reviews typically use disease datasets to evaluate methods based on prioritization or phenotype relevance [<xref rid="ref8" ref-type="bibr">8</xref>, <xref rid="ref23" ref-type="bibr">23</xref>, <xref rid="ref28" ref-type="bibr">28</xref>, <xref rid="ref47" ref-type="bibr">47</xref>]. We used the ranks and <italic toggle="yes">P</italic>-values of statistical methods to evaluate the prioritization in our comparison (<xref rid="f2" ref-type="fig">Figure 2A,B</xref>), assuming a single true positive: the target disease-associated pathway. However, diseases like cancer cause significant disruptions to complex biological systems. For some diseases, many different pathways could be impacted to varying degrees, with non-target pathways sometimes affected even more than the target pathway [<xref rid="ref22" ref-type="bibr">22</xref>].</p>
    <p>We used the knockout gene experiment datasets to assess sensitivity and specificity referred to Nguyen et al. [<xref rid="ref22" ref-type="bibr">22</xref>]. We considered sensitivity a crucial metric for enrichment methods because an effective method should maximize the identification of the expected pathways (<xref rid="f2" ref-type="fig">Figure 2C</xref>). The gene–pathway relationships recorded in the database are typically backed by experimental evidence, making the definitions of true positives and false negatives more suitable. Thus, the sensitivity can be effectively evaluated (equation (<xref rid="deqn12" ref-type="disp-formula">12</xref>)). In contrast, it is difficult to define the true negatives due to the complexity of biological systems leading to the incompleteness of databases. For example, a knocked-out gene may impact pathway A through a signaling pathway yet to be discovered, which frequently happens in molecular biology research. Thus, the specificity of a method cannot be accurately evaluated (equation (<xref rid="deqn13" ref-type="disp-formula">13</xref>), <xref rid="f2" ref-type="fig">Figure 2D</xref>). Moreover, the primary role of functional enrichment analysis is to guide for interpreting the omics data. Additional experimental verification is essential to substantiate the analysis results.</p>
    <p>Multi-omic studies are increasingly prevalent and so are the demands for functional enrichment analysis of all types of omics data [<xref rid="ref48" ref-type="bibr">48–51</xref>]. The GRSA applies to all types of omics datasets as long as a relevant relational database is available. As demonstrated by case studies, we confirmed previous key findings and acquired new biological insights. For example, applying GRSA on the IHSMGC dataset suggested different functional profiles between aging and young skin microbiota. Biosynthesis of KDO2-lipid A and CMP-KDO increased while degradation pathways of several sulfated glycosaminoglycans decreased in older skin microbiota, which may be linked to changes in the skin’s physiological properties. Further studies are needed to investigate the underlying mechanisms and their implications for skin health. Applying GRSA on the transcriptomic data of cardiomyocyte differentiations revealed that hiPSCs/hESCs at day 2 specialized in various RNA-related metabolisms, suggesting the involvement of complex transcriptional regulation in further mesoderm formation. Finally, applying GRSA to the metabolomic data from the Danish pregnancy cohort showed that several pathways related to human diseases were up-regulated with gestational age, including Cushing syndrome and PABC.</p>
    <p>The GRSA offers the option for user-specified patterns for enrichment analysis, allowing for rapid testing of educated hypotheses in complex multi-group studies. This is demonstrated in our analysis of the transcriptomic data during cardiomyocyte differentiations. The GRSA offers applications beyond functional enrichment analysis. Applying GRSA in the taxonomic enrichment analysis of the IHSMGC dataset identified key genera that significantly differed between the two cutotypes. The results were highly consistent with the microbial co-occurrence network analysis in the previous study, but performing GRSA was much easier and faster than the network analysis.</p>
    <p>In summary, we believe the GRSA and the ReporterScore package can greatly facilitate the functional enrichment analyses of diverse omics data, with higher sensitivity, compatibility with multi-group and longitudinal designs, and flexibility with customized databases for creative applications beyond functional enrichment analyses. In the future, we plan to incorporate additional built-in databases and visualization techniques, while consistently maintaining and updating the ReporterScore package.</p>
    <boxed-text id="box01" position="float">
      <sec id="sec17">
        <title>Key Points</title>
        <list list-type="bullet">
          <list-item>
            <p>We developed generalized reporter score enrichment analysis (GRSA) and the R package ReporterScore, significantly expanding the capabilities of the classic RSA to multi-group and longitudinal experimental designs and is inherently compatible with nearly all types of omics data.</p>
          </list-item>
          <list-item>
            <p>The GRSA offers higher sensitivity than commonly used enrichment analysis approaches. We confirmed previous key findings and acquired new biological insights in 4 case studies using GRSA.</p>
          </list-item>
          <list-item>
            <p>The GRSA can be applied to any established relational database and perform customized enrichment analysis, such as taxonomy enrichment analysis.</p>
          </list-item>
        </list>
      </sec>
    </boxed-text>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>RS_supp_BIB3-final_bbae116</label>
      <media xlink:href="rs_supp_bib3-final_bbae116.docx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="bbae116-ack">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We are grateful to our colleagues at the core facility of the Life Sciences Institute, especially the NECHO high-performance computing cluster.</p>
  </ack>
  <sec id="sec21">
    <title>FUNDING</title>
    <p>This research was supported by grants from NSFC (82173645 and 82341109) and the Fundamental Research Funds for the Central Universities (2022FZZX03-03-07).</p>
  </sec>
  <sec id="sec19">
    <title>AUTHOR CONTRIBUTIONS</title>
    <p><bold>Chen Peng:</bold> Conceptualization, Methodology, Investigation, Software, Visualization, Formal Analysis, Validation, Writing – Original Draft and Writing – Review &amp; Editing. <bold>Qiong Chen:</bold> Writing – Review &amp; Editing. <bold>Shangjin Tan:</bold> Writing – Review &amp; Editing. <bold>Xiaotao Shen:</bold> Writing – Review &amp; Editing. <bold>Chao Jiang:</bold> Conceptualization, Methodology, Investigation, Writing – Original Draft, Writing – Review &amp; Editing, Supervision, Project Administration and Funding Acquisition.</p>
  </sec>
  <sec sec-type="data-availability" id="sec18">
    <title>DATA AVAILABILITY</title>
    <p>Code is available as an open-source R package ‘ReporterScore’ on the Comprehensive R Archive Network (CRAN) (<ext-link xlink:href="https://cran.r-project.org/web/packages/ReporterScore" ext-link-type="uri">https://cran.r-project.org/web/packages/ReporterScore</ext-link>). The main analysis scripts (Rmarkdown format) and source data are available from GitHub (<ext-link xlink:href="https://github.com/Asa12138/Analysis_code/tree/main/GRSA_figures" ext-link-type="uri">https://github.com/Asa12138/Analysis_code/tree/main/GRSA_figures</ext-link>).</p>
  </sec>
  <notes id="bio3">
    <title>Author Biographies</title>
    <p><bold>Chen Peng</bold> is a PhD student in the Life Sciences Institute at Zhejiang University.</p>
    <sec sec-type="author-bio" id="sec22b">
      <p><bold>Qiong Chen</bold> is a post-doctoral fellow in the Life Sciences Institute at Zhejiang University.</p>
    </sec>
    <sec sec-type="author-bio" id="sec22c">
      <p><bold>Shangjin Tan</bold> is working in the BGI Research.</p>
    </sec>
    <sec sec-type="author-bio" id="sec22d">
      <p><bold>Xiaotao Shen</bold> is a post-doctoral fellow in Prof. Michael Snyder’s lab at Stanford University School of Medicine.</p>
    </sec>
    <sec sec-type="author-bio" id="sec22e">
      <p><bold>Chao Jiang</bold> is a principal investigator in the Life Sciences Institute at Zhejiang University.</p>
    </sec>
  </notes>
  <ref-list id="bib1">
    <title>References</title>
    <ref id="ref1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>K</given-names></string-name>, <string-name><surname>Rhee</surname><given-names>SY</given-names></string-name></person-group>. <article-title>Interpreting omics data with pathway enrichment analysis</article-title>. <source>Trends Genet</source><year>2023</year>;<volume>39</volume>:<fpage>308</fpage>–<lpage>19</lpage>.<pub-id pub-id-type="pmid">36750393</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mubeen</surname><given-names>S</given-names></string-name>, <string-name><surname>Tom Kodamullil</surname><given-names>A</given-names></string-name>, <string-name><surname>Hofmann-Apitius</surname><given-names>M</given-names></string-name>, <string-name><surname>Domingo-Fernández</surname><given-names>D</given-names></string-name></person-group>. <article-title>On the influence of several factors on pathway enrichment analysis</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbac143</fpage>.<pub-id pub-id-type="pmid">35453140</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sherman</surname><given-names>BT</given-names></string-name>, <string-name><surname>Hao</surname><given-names>M</given-names></string-name>, <string-name><surname>Qiu</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>DAVID: a web server for functional enrichment analysis and functional annotation of gene lists (2021 update)</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>W216</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">35325185</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>T</given-names></string-name>, <string-name><surname>Hu</surname><given-names>E</given-names></string-name>, <string-name><surname>Xu</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>clusterProfiler 4.0: a universal enrichment tool for interpreting omics data</article-title>. <source>Innovation (Camb)</source><year>2021</year>;<volume>2</volume>:<fpage>100141</fpage>.<pub-id pub-id-type="pmid">34557778</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname><given-names>A</given-names></string-name>, <string-name><surname>Tamayo</surname><given-names>P</given-names></string-name>, <string-name><surname>Mootha</surname><given-names>VK</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc Natl Acad Sci</source><year>2005</year>;<volume>102</volume>:<fpage>15545</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barry</surname><given-names>WT</given-names></string-name>, <string-name><surname>Nobel</surname><given-names>AB</given-names></string-name>, <string-name><surname>Wright</surname><given-names>FA</given-names></string-name></person-group>. <article-title>Significance analysis of functional categories in gene expression studies: a structured permutation approach</article-title>. <source>Bioinformatics</source><year>2005</year>;<volume>21</volume>:<fpage>1943</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">15647293</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Efron</surname><given-names>B</given-names></string-name>, <string-name><surname>Tibshirani</surname><given-names>R</given-names></string-name></person-group>. <article-title>On testing the significance of sets of genes</article-title>. <source>Ann Appl Stat</source><year>2007</year>;<volume>1</volume>:<fpage>107</fpage>–<lpage>29</lpage>.</mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarca</surname><given-names>AL</given-names></string-name>, <string-name><surname>Draghici</surname><given-names>S</given-names></string-name>, <string-name><surname>Bhatti</surname><given-names>G</given-names></string-name>, <string-name><surname>Romero</surname><given-names>R</given-names></string-name></person-group>. <article-title>Down-weighting overlapping genes improves gene set analysis</article-title>. <source>BMC Bioinformatics</source><year>2012</year>;<volume>13</volume>:<fpage>136</fpage>.<pub-id pub-id-type="pmid">22713124</pub-id></mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hänzelmann</surname><given-names>S</given-names></string-name>, <string-name><surname>Castelo</surname><given-names>R</given-names></string-name>, <string-name><surname>Guinney</surname><given-names>J</given-names></string-name></person-group>. <article-title>GSVA: gene set variation analysis for microarray and RNA-Seq data</article-title>. <source>BMC Bioinformatics</source><year>2013</year>;<volume>14</volume>:<fpage>7</fpage>.<pub-id pub-id-type="pmid">23323831</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Q</given-names></string-name>, <string-name><surname>Wang</surname><given-names>S</given-names></string-name>, <string-name><surname>Dai</surname><given-names>E</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Pathway enrichment analysis approach based on topological structure and updated annotation of pathway</article-title>. <source>Brief Bioinform</source><year>2019</year>;<volume>20</volume>:<fpage>168</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">28968630</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goeman</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Bühlmann</surname><given-names>P</given-names></string-name></person-group>. <article-title>Analyzing gene expression data in terms of gene sets: methodological issues</article-title>. <source>Bioinformatics</source><year>2007</year>;<volume>23</volume>:<fpage>980</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">17303618</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patil</surname><given-names>KR</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>J</given-names></string-name></person-group>. <article-title>Uncovering transcriptional regulation of metabolism by using metabolic network topology</article-title>. <source>Proc Natl Acad Sci U S A</source><year>2005</year>;<volume>102</volume>:<fpage>2685</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">15710883</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>F</given-names></string-name>, <string-name><surname>Ju</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Metagenome-wide association of gut microbiome features for schizophrenia</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>1612</fpage>.<pub-id pub-id-type="pmid">32235826</pub-id></mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>L</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>R</given-names></string-name>, <string-name><surname>Wu</surname><given-names>D</given-names></string-name></person-group>. <article-title>Misuse of reporter score in microbial enrichment analysis</article-title>. <source>iMeta</source><year>2023</year>;<volume>2</volume>:<fpage>e95</fpage>.<pub-id pub-id-type="pmid">38868431</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oliveira</surname><given-names>AP</given-names></string-name>, <string-name><surname>Patil</surname><given-names>KR</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>J</given-names></string-name></person-group>. <article-title>Architecture of transcriptional regulatory circuits is knitted over the topology of bio-molecular interaction networks</article-title>. <source>BMC Syst Biol</source><year>2008</year>;<volume>2</volume>:<fpage>17</fpage>.<pub-id pub-id-type="pmid">18261202</pub-id></mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liang</surname><given-names>L</given-names></string-name>, <string-name><surname>Rasmussen</surname><given-names>M-LH</given-names></string-name>, <string-name><surname>Piening</surname><given-names>B</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Metabolic dynamics and prediction of gestational age and time to delivery in pregnant women</article-title>. <source>Cell</source><year>2020</year>;<volume>181</volume>:<fpage>1680</fpage>–<lpage>1692.e15</lpage>.<pub-id pub-id-type="pmid">32589958</pub-id></mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Z</given-names></string-name>, <string-name><surname>Xia</surname><given-names>J</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Characterization of the human skin resistome and identification of two microbiota cutotypes</article-title>. <source>Microbiome</source><year>2021</year>;<volume>9</volume>:<fpage>47</fpage>.<pub-id pub-id-type="pmid">33597039</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>C</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Genome-wide temporal profiling of transcriptome and open chromatin of early cardiomyocyte differentiation derived from hiPSCs and hESCs</article-title>. <source>Circ Res</source><year>2017</year>;<volume>121</volume>:<fpage>376</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">28663367</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bezdek</surname><given-names>JC</given-names></string-name>, <string-name><surname>Ehrlich</surname><given-names>R</given-names></string-name>, <string-name><surname>Full</surname><given-names>W</given-names></string-name></person-group>. <article-title>FCM: the fuzzy c-means clustering algorithm</article-title>. <source>Comput Geosci</source><year>1984</year>;<volume>10</volume>:<fpage>191</fpage>–<lpage>203</lpage>.</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shi</surname><given-names>L</given-names></string-name>, <string-name><surname>Shi</surname><given-names>L</given-names></string-name>, <string-name><surname>Reid</surname><given-names>LH</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The MicroArray quality control (MAQC) project shows inter- and intraplatform reproducibility of gene expression measurements</article-title>. <source>Nat Biotechnol</source><year>2006</year>;<volume>24</volume>:<fpage>1151</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">16964229</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zyla</surname><given-names>J</given-names></string-name>, <string-name><surname>Marczyk</surname><given-names>M</given-names></string-name>, <string-name><surname>Weiner</surname><given-names>J</given-names></string-name>, <string-name><surname>Polanska</surname><given-names>J</given-names></string-name></person-group>. <article-title>Ranking metrics in gene set enrichment analysis: do they matter?</article-title><source>BMC Bioinformatics</source><year>2017</year>;<volume>18</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">28049414</pub-id></mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nguyen</surname><given-names>T-M</given-names></string-name>, <string-name><surname>Shafi</surname><given-names>A</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>T</given-names></string-name>, <string-name><surname>Draghici</surname><given-names>S</given-names></string-name></person-group>. <article-title>Identifying significantly impacted pathways: a comprehensive review and assessment</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>203</fpage>.<pub-id pub-id-type="pmid">31597578</pub-id></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Geistlinger</surname><given-names>L</given-names></string-name>, <string-name><surname>Csaba</surname><given-names>G</given-names></string-name>, <string-name><surname>Santarelli</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Toward a gold standard for benchmarking gene set enrichment analysis</article-title>. <source>Brief Bioinform</source><year>2021</year>;<volume>22</volume>:<fpage>545</fpage>–<lpage>56</lpage>.<pub-id pub-id-type="pmid">32026945</pub-id></mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M</given-names></string-name>, <string-name><surname>Sato</surname><given-names>Y</given-names></string-name></person-group>. <article-title>KEGG mapper for inferring cellular functions from protein sequences</article-title>. <source>Protein Sci</source><year>2020</year>;<volume>29</volume>:<fpage>28</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">31423653</pub-id></mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M</given-names></string-name>, <string-name><surname>Sato</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kawashima</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>KEGG as a reference resource for gene and protein annotation</article-title>. <source>Nucleic Acids Res</source><year>2016</year>;<volume>44</volume>:<fpage>D457</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">26476454</pub-id></mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huerta-Cepas</surname><given-names>J</given-names></string-name>, <string-name><surname>Szklarczyk</surname><given-names>D</given-names></string-name>, <string-name><surname>Heller</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>eggNOG 5.0: a hierarchical, functionally and phylogenetically annotated orthology resource based on 5090 organisms and 2502 viruses</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>D309</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">30418610</pub-id></mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nearing</surname><given-names>JT</given-names></string-name>, <string-name><surname>Douglas</surname><given-names>GM</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>MG</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Microbiome differential abundance methods produce different results across 38 datasets</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>342</fpage>.<pub-id pub-id-type="pmid">35039521</pub-id></mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>J</given-names></string-name>, <string-name><surname>Shojaie</surname><given-names>A</given-names></string-name>, <string-name><surname>Michailidis</surname><given-names>G</given-names></string-name></person-group>. <article-title>A comparative study of topology-based pathway enrichment analysis methods</article-title>. <source>BMC Bioinformatics</source><year>2019</year>;<volume>20</volume>:<fpage>546</fpage>.<pub-id pub-id-type="pmid">31684881</pub-id></mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ocvirk</surname><given-names>S</given-names></string-name>, <string-name><surname>O’Keefe</surname><given-names>SJD</given-names></string-name></person-group>. <article-title>Dietary fat, bile acid metabolism and colorectal cancer</article-title>. <source>Semin Cancer Biol</source><year>2021</year>;<volume>73</volume>:<fpage>347</fpage>–<lpage>55</lpage>.<pub-id pub-id-type="pmid">33069873</pub-id></mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jarocki</surname><given-names>M</given-names></string-name>, <string-name><surname>Karska</surname><given-names>J</given-names></string-name>, <string-name><surname>Kowalski</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Interleukin 17 and its involvement in renal cell carcinoma</article-title>. <source>J Clin Med</source><year>2022</year>;<volume>11</volume>:<fpage>4973</fpage>.<pub-id pub-id-type="pmid">36078902</pub-id></mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Banumathy</surname><given-names>G</given-names></string-name>, <string-name><surname>Cairns</surname><given-names>P</given-names></string-name></person-group>. <article-title>Signaling pathways in renal cell carcinoma</article-title>. <source>Cancer Biol Ther</source><year>2010</year>;<volume>10</volume>:<fpage>658</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">20814228</pub-id></mixed-citation>
    </ref>
    <ref id="ref32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arabian</surname><given-names>S</given-names></string-name>, <string-name><surname>Boostan</surname><given-names>A</given-names></string-name>, <string-name><surname>Darzi</surname><given-names>S</given-names></string-name></person-group>. <article-title>The role of toll-like receptors (TLRs) and their therapeutic applications in endometrial cancer</article-title>. <source>Clin Transl Oncol</source><year>2023</year>;<volume>25</volume>:<fpage>859</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">36374404</pub-id></mixed-citation>
    </ref>
    <ref id="ref33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Larsson</surname><given-names>SC</given-names></string-name>, <string-name><surname>Lee</surname><given-names>W-H</given-names></string-name>, <string-name><surname>Kar</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Assessing the role of cortisol in cancer: a wide-ranged Mendelian randomisation study</article-title>. <source>Br J Cancer</source><year>2021</year>;<volume>125</volume>:<fpage>1025</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">34316022</pub-id></mixed-citation>
    </ref>
    <ref id="ref34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diehl</surname><given-names>FF</given-names></string-name>, <string-name><surname>Miettinen</surname><given-names>TP</given-names></string-name>, <string-name><surname>Elbashir</surname><given-names>R</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Nucleotide imbalance decouples cell growth from cell proliferation</article-title>. <source>Nat Cell Biol</source><year>2022</year>;<volume>24</volume>:<fpage>1252</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">35927450</pub-id></mixed-citation>
    </ref>
    <ref id="ref35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>X</given-names></string-name>, <string-name><surname>Quinn</surname><given-names>PJ</given-names></string-name>, <string-name><surname>Yan</surname><given-names>A</given-names></string-name></person-group>. <article-title>Kdo2-lipid a: structural diversity and impact on immunopharmacology</article-title>. <source>Biol Rev</source><year>2015</year>;<volume>90</volume>:<fpage>408</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">24838025</pub-id></mixed-citation>
    </ref>
    <ref id="ref36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heyes</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Levy</surname><given-names>C</given-names></string-name>, <string-name><surname>Lafite</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Structure-based mechanism of CMP-2-keto-3-deoxymanno-octulonic acid synthetase</article-title>. <source>J Biol Chem</source><year>2009</year>;<volume>284</volume>:<fpage>35514</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">19815542</pub-id></mixed-citation>
    </ref>
    <ref id="ref37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shin</surname><given-names>J-W</given-names></string-name>, <string-name><surname>Kwon</surname><given-names>S-H</given-names></string-name>, <string-name><surname>Choi</surname><given-names>J-Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Molecular mechanisms of dermal aging and antiaging approaches</article-title>. <source>Int J Mol Sci</source><year>2019</year>;<volume>20</volume>:<fpage>2126</fpage>.<pub-id pub-id-type="pmid">31036793</pub-id></mixed-citation>
    </ref>
    <ref id="ref38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>ST</given-names></string-name>, <string-name><surname>Neo</surname><given-names>BH</given-names></string-name>, <string-name><surname>Betts</surname><given-names>RJ</given-names></string-name></person-group>. <article-title>Glycosaminoglycans: sweet as sugar targets for topical skin anti-aging</article-title>. <source>Clin Cosmet Investig Dermatol</source><year>2021</year>;<volume>14</volume>:<fpage>1227</fpage>–<lpage>46</lpage>.</mixed-citation>
    </ref>
    <ref id="ref39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oh</surname><given-names>J-H</given-names></string-name>, <string-name><surname>Kim</surname><given-names>YK</given-names></string-name>, <string-name><surname>Jung</surname><given-names>J-Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Changes in glycosaminoglycans and related proteoglycans in intrinsically aged human skin in vivo</article-title>. <source>Exp Dermatol</source><year>2011</year>;<volume>20</volume>:<fpage>454</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">21426414</pub-id></mixed-citation>
    </ref>
    <ref id="ref40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chrousos</surname><given-names>GP</given-names></string-name>, <string-name><surname>Torpy</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Gold</surname><given-names>PW</given-names></string-name></person-group>. <article-title>Interactions between the hypothalamic-pituitary-adrenal axis and the female reproductive system: clinical implications</article-title>. <source>Ann Intern Med</source><year>1998</year>;<volume>129</volume>:<fpage>229</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">9696732</pub-id></mixed-citation>
    </ref>
    <ref id="ref41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levitz</surname><given-names>M</given-names></string-name>, <string-name><surname>Kadner</surname><given-names>S</given-names></string-name>, <string-name><surname>Young</surname><given-names>BK</given-names></string-name></person-group>. <article-title>Intermediary metabolism of estriol in pregnancy</article-title>. <source>J Steroid Biochem</source><year>1984</year>;<volume>20</volume>:<fpage>971</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">6727356</pub-id></mixed-citation>
    </ref>
    <ref id="ref42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Makieva</surname><given-names>S</given-names></string-name>, <string-name><surname>Saunders</surname><given-names>PTK</given-names></string-name>, <string-name><surname>Norman</surname><given-names>JE</given-names></string-name></person-group>. <article-title>Androgens in pregnancy: roles in parturition</article-title>. <source>Hum Reprod Update</source><year>2014</year>;<volume>20</volume>:<fpage>542</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">24643344</pub-id></mixed-citation>
    </ref>
    <ref id="ref43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cox</surname><given-names>BD</given-names></string-name>, <string-name><surname>Calame</surname><given-names>DP</given-names></string-name></person-group>. <article-title>Changes in plasma amino acid levels during the human menstrual cycle and in early pregnancy. A preliminary report</article-title>. <source>Horm Metab Res</source><year>1978</year>;<volume>10</volume>:<fpage>428</fpage>–<lpage>33</lpage>.<pub-id pub-id-type="pmid">711138</pub-id></mixed-citation>
    </ref>
    <ref id="ref44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamblin</surname><given-names>R</given-names></string-name>, <string-name><surname>Coulden</surname><given-names>A</given-names></string-name>, <string-name><surname>Fountas</surname><given-names>A</given-names></string-name>, <string-name><surname>Karavitaki</surname><given-names>N</given-names></string-name></person-group>. <article-title>The diagnosis and management of Cushing’s syndrome in pregnancy</article-title>. <source>J Neuroendocrinol</source><year>2022</year>;<volume>34</volume>:<elocation-id>e13118</elocation-id>.<pub-id pub-id-type="pmid">35491087</pub-id></mixed-citation>
    </ref>
    <ref id="ref45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Genin</surname><given-names>AS</given-names></string-name>, <string-name><surname>De Rycke</surname><given-names>Y</given-names></string-name>, <string-name><surname>Stevens</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Association with pregnancy increases the risk of local recurrence but does not impact overall survival in breast cancer: a case-control study of 87 cases</article-title>. <source>Breast (Edinburgh, Scotland)</source><year>2016</year>;<volume>30</volume>:<fpage>222</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">26456897</pub-id></mixed-citation>
    </ref>
    <ref id="ref46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ebrahimpoor</surname><given-names>M</given-names></string-name>, <string-name><surname>Spitali</surname><given-names>P</given-names></string-name>, <string-name><surname>Hettne</surname><given-names>K</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Simultaneous enrichment analysis of all possible gene-sets: unifying self-contained and competitive methods</article-title>. <source>Brief Bioinform</source><year>2020</year>;<volume>21</volume>:<fpage>1302</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">31297505</pub-id></mixed-citation>
    </ref>
    <ref id="ref47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarca</surname><given-names>AL</given-names></string-name>, <string-name><surname>Bhatti</surname><given-names>G</given-names></string-name>, <string-name><surname>Romero</surname><given-names>R</given-names></string-name></person-group>. <article-title>A comparison of gene set analysis methods in terms of sensitivity, prioritization and specificity</article-title>. <source>PLoS One</source><year>2013</year>;<volume>8</volume>:<elocation-id>e79217</elocation-id>.<pub-id pub-id-type="pmid">24260172</pub-id></mixed-citation>
    </ref>
    <ref id="ref48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gao</surname><given-names>P</given-names></string-name>, <string-name><surname>Shen</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Precision environmental health monitoring by longitudinal exposome and multi-omics profiling</article-title>. <source>Genome Res</source><year>2022</year>;<volume>32</volume>:<fpage>1199</fpage>–<lpage>214</lpage>.<pub-id pub-id-type="pmid">35667843</pub-id></mixed-citation>
    </ref>
    <ref id="ref49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname><given-names>C</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Dynamic human environmental exposome revealed by longitudinal personal monitoring</article-title>. <source>Cell</source><year>2018</year>;<volume>175</volume>:<fpage>277</fpage>–<lpage>291.e31</lpage>.<pub-id pub-id-type="pmid">30241608</pub-id></mixed-citation>
    </ref>
    <ref id="ref50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>F</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>L</given-names></string-name>, <string-name><surname>Pan</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Multi-omic profiling reveals that intra-abdominal-hypertension-induced intestinal damage can be prevented by microbiome and metabolic modulations with 5-hydroxyindoleacetic acid as a diagnostic marker</article-title>. <source>mSystems</source><year>2022</year>;<volume>7</volume>:<fpage>e01204</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">35574681</pub-id></mixed-citation>
    </ref>
    <ref id="ref51">
      <label>51.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname><given-names>X</given-names></string-name>, <string-name><surname>Huang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Charting the landscape of the environmental exposome</article-title>. <source>iMeta</source><year>2022</year>;<volume>1</volume>:<fpage>e50</fpage>.<pub-id pub-id-type="pmid">38867899</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10976918</article-id>
    <article-id pub-id-type="pmid">38546324</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbae116</article-id>
    <article-id pub-id-type="publisher-id">bbae116</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Problem Solving Protocol</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Generalized reporter score-based enrichment analysis for omics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Peng</surname>
          <given-names>Chen</given-names>
        </name>
        <!--pengchen2001@zju.edu.cn-->
        <aff><institution>MOE Key Laboratory of Biosystems Homeostasis &amp; Protection</institution>, and Zhejiang Provincial Key Laboratory of Cancer Molecular Cell Biology, <institution>Life Sciences Institute, Zhejiang University</institution>, <addr-line>Hangzhou, Zhejiang 310030</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>State Key Laboratory for Diagnosis and Treatment of Infectious Diseases</institution>, First Affiliated Hospital, <institution>Zhejiang University School of Medicine</institution>, <addr-line>Hangzhou, Zhejiang 310009</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Qiong</given-names>
        </name>
        <!--qiong_chen@zju.edu.cn-->
        <aff><institution>MOE Key Laboratory of Biosystems Homeostasis &amp; Protection</institution>, and Zhejiang Provincial Key Laboratory of Cancer Molecular Cell Biology, <institution>Life Sciences Institute, Zhejiang University</institution>, <addr-line>Hangzhou, Zhejiang 310030</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>State Key Laboratory for Diagnosis and Treatment of Infectious Diseases</institution>, First Affiliated Hospital, <institution>Zhejiang University School of Medicine</institution>, <addr-line>Hangzhou, Zhejiang 310009</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tan</surname>
          <given-names>Shangjin</given-names>
        </name>
        <!--tanshangjin@genomics.cn-->
        <aff><institution>BGI Research</institution>, <addr-line>Wuhan, Hubei 430074</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>BGI Research</institution>, <addr-line>Shenzhen, Guangdong 518083</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shen</surname>
          <given-names>Xiaotao</given-names>
        </name>
        <!--xiaotaoshen@gmail.com-->
        <aff><institution>Department of Genetics, Stanford University School of Medicine</institution>, <addr-line>Stanford, CA</addr-line>, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0260-7271</contrib-id>
        <name>
          <surname>Jiang</surname>
          <given-names>Chao</given-names>
        </name>
        <!--jiang_chao@zju.edu.cn-->
        <aff><institution>MOE Key Laboratory of Biosystems Homeostasis &amp; Protection</institution>, and Zhejiang Provincial Key Laboratory of Cancer Molecular Cell Biology, <institution>Life Sciences Institute, Zhejiang University</institution>, <addr-line>Hangzhou, Zhejiang 310030</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>State Key Laboratory for Diagnosis and Treatment of Infectious Diseases</institution>, First Affiliated Hospital, <institution>Zhejiang University School of Medicine</institution>, <addr-line>Hangzhou, Zhejiang 310009</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>Center for Life Sciences, Shaoxing Institute, Zhejiang University</institution>, <addr-line>Shaoxing, Zhejiang 321000</addr-line>, <country country="CN">China</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Corresponding author. Chao Jiang, MOE Key Laboratory of Biosystems Homeostasis &amp; Protection, and Zhejiang Provincial Key Laboratory of Cancer Molecular Cell Biology, Life Sciences Institute, Zhejiang University, Hangzhou, Zhejiang 310030, China. Tel.: +86 0571 88208922; E-mail: <email>jiang_chao@zju.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-03-27">
      <day>27</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <issue>3</issue>
    <elocation-id>bbae116</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>25</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bbae116.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Enrichment analysis contextualizes biological features in pathways to facilitate a systematic understanding of high-dimensional data and is widely used in biomedical research. The emerging reporter score-based analysis (RSA) method shows more promising sensitivity, as it relies on <italic toggle="yes">P</italic>-values instead of raw values of features. However, RSA cannot be directly applied to multi-group and longitudinal experimental designs and is often misused due to the lack of a proper tool. Here, we propose the Generalized Reporter Score-based Analysis (GRSA) method for multi-group and longitudinal omics data. A comparison with other popular enrichment analysis methods demonstrated that GRSA had increased sensitivity across multiple benchmark datasets. We applied GRSA to microbiome, transcriptome and metabolome data and discovered new biological insights in omics studies. Finally, we demonstrated the application of GRSA beyond functional enrichment using a taxonomy database. We implemented GRSA in an R package, ReporterScore, integrating with a powerful visualization module and updatable pathway databases, which is available on the Comprehensive R Archive Network (<ext-link xlink:href="https://cran.r-project.org/web/packages/ReporterScore" ext-link-type="uri">https://cran.r-project.org/web/packages/ReporterScore</ext-link>). We believe that the ReporterScore package will be a valuable asset for broad biomedical research fields.</p>
    </abstract>
    <abstract abstract-type="graphical">
      <title>Graphical Abstract</title>
      <p>
        <fig position="float" id="ga1">
          <label>Graphical Abstract</label>
          <graphic xlink:href="bbae116ga1" position="float"/>
        </fig>
      </p>
    </abstract>
    <kwd-group>
      <kwd>reporter score</kwd>
      <kwd>enrichment analysis</kwd>
      <kwd>multi-group</kwd>
      <kwd>omics data</kwd>
      <kwd>customized database</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Nature Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>82173645</award-id>
        <award-id>82341109</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Fundamental Research Funds for the Central Universities</institution>
            <institution-id institution-id-type="DOI">10.13039/501100012226</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2022FZZX03-03-07</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="14"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec3">
    <title>INTRODUCTION</title>
    <p>Functional enrichment analysis is a popular bioinformatic method that helps understand the biological significance of large omics datasets, such as transcriptomic, metagenomic, and metabolic data. We gain insights into the underlying biological processes and functions by identifying enriched functional categories, such as gene ontology terms or biological pathways, and formulate hypotheses for downstream experimental investigations [<xref rid="ref1" ref-type="bibr">1</xref>].</p>
    <p>Methods for functional enrichment analysis can be roughly divided into three categories based on underlying statistical methods: (i) overrepresentation analysis (ORA), (ii) functional class scoring (FCS) and (iii) pathway topology-based (PT) [<xref rid="ref2" ref-type="bibr">2</xref>]. Common enrichment analysis methods in omics research are shown in <xref rid="TB1" ref-type="table">Table 1</xref>. In addition, Goeman and Bühlmann classified enrichment analysis methods based on the underlying null hypothesis as ‘competitive’ or ‘self-contained’. In ‘competitive’ methods, a gene set is compared against the background of all genes not in the set to assess if the level of statistical differences exceeds the background level, whereas a ‘self-contained’ method analyzes each gene set in isolation [<xref rid="ref11" ref-type="bibr">11</xref>].</p>
    <table-wrap position="float" id="TB1">
      <label>Table 1</label>
      <caption>
        <p>Some commonly used enrichment analysis methods</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th align="left" rowspan="1" colspan="1">Category</th>
            <th align="left" rowspan="1" colspan="1">Method</th>
            <th align="left" rowspan="1" colspan="1">Tools</th>
            <th align="left" rowspan="1" colspan="1">Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" rowspan="1" colspan="1">ORA</td>
            <td align="left" rowspan="1" colspan="1">Hypergeometric test/Fisher’s exact test</td>
            <td align="left" rowspan="1" colspan="1">DAVID (website) [<xref rid="ref3" ref-type="bibr">3</xref>], clusterProfiler (R package) [<xref rid="ref4" ref-type="bibr">4</xref>]</td>
            <td align="left" rowspan="1" colspan="1">The most common methods used in enrichment analysis. Selecting a list of genes is required</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Gene set enrichment analysis (GSEA)</td>
            <td align="left" rowspan="1" colspan="1">GSEA (website) [<xref rid="ref5" ref-type="bibr">5</xref>]</td>
            <td align="left" rowspan="1" colspan="1">GSEA creatively uses gene ranking, rather than selecting a list of genes, to identify statistically significant and concordant differences across gene sets</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Generalized reporter score-based analysis (GRSA/RSA)</td>
            <td align="left" rowspan="1" colspan="1">ReporterScore (R package developed in this study)</td>
            <td align="left" rowspan="1" colspan="1">Find significant metabolites (first report), pathways and taxonomy based on the <italic toggle="yes">P</italic>-values for multi-omics data</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Significance Analysis of Function and Expression (SAFE)</td>
            <td align="left" rowspan="1" colspan="1">SAFE (R package) [<xref rid="ref6" ref-type="bibr">6</xref>]</td>
            <td align="left" rowspan="1" colspan="1">SAFE assesses the significance of gene categories by calculating both local and global statistics from gene expression data</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Gene Set Analysis (GSA)</td>
            <td align="left" rowspan="1" colspan="1">GSA (R Package) [<xref rid="ref7" ref-type="bibr">7</xref>]</td>
            <td align="left" rowspan="1" colspan="1">GSA was proposed as an improvement of GSEA, using the ‘maxmean’ statistic instead of the weighted sign KS statistic</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Pathway Analysis with Down-weighting of Overlapping Genes (PADOG)</td>
            <td align="left" rowspan="1" colspan="1">PADOG (R package) [<xref rid="ref8" ref-type="bibr">8</xref>]</td>
            <td align="left" rowspan="1" colspan="1">PADOG assumes that genes associated with fewer pathways have more significant effects than genes associated with more pathways</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Gene Set Variation Analysis (GSVA)</td>
            <td align="left" rowspan="1" colspan="1">GSVA (R package) [<xref rid="ref9" ref-type="bibr">9</xref>]</td>
            <td align="left" rowspan="1" colspan="1">A non-parametric, unsupervised method that transforms gene expression data into gene set scores for downstream differential pathway activity analysis</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">PT</td>
            <td align="left" rowspan="1" colspan="1">Topology-based pathway enrichment analysis (TPEA)</td>
            <td align="left" rowspan="1" colspan="1">TPEA (R package) [<xref rid="ref10" ref-type="bibr">10</xref>]</td>
            <td align="left" rowspan="1" colspan="1">Integrate topological properties and global upstream/downstream positions of genes in pathways</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>The algorithm of reporter score-based analysis (RSA) was originally developed by Patil and Nielsen in 2005 to identify metabolites associated with the metabolic network’s regulatory hotspots [<xref rid="ref12" ref-type="bibr">12</xref>]. The RSA has recently gained popularity due to its extended application in functional enrichment analysis in microbiome research [<xref rid="ref13" ref-type="bibr">13</xref>]. RSA is a competitive FCS method based on parsing the <italic toggle="yes">P</italic>-values of selected statistical analyses without a priori cut-off (threshold-free). The rationale is that the <italic toggle="yes">P</italic>-value can be considered a standardized statistic reflecting the differences between different genes or features, regardless of the mean expression values. The pathways with significantly lower <italic toggle="yes">P</italic>-values than the background <italic toggle="yes">P</italic>-value distribution are enriched [<xref rid="ref12" ref-type="bibr">12</xref>].</p>
    <p>However, RSA is often misused due to a lack of specific tools and a systematic understanding of the algorithm [<xref rid="ref14" ref-type="bibr">14</xref>]. In addition, the sign (plus or minus) of the reporter score of each pathway in classic RSA does not represent the increasing or decreasing trend of the pathway expression; rather, reporter scores (including negative value) less than a specified threshold indicate that the corresponding pathway is not significantly enriched. This often leads to misinterpretations of the results.</p>
    <p>Inspired by the classic RSA, we developed the improved Generalized Reporter Score-based Analysis (GRSA) method, implemented in the R package ReporterScore, along with comprehensive visualization methods and pathway databases. GRSA is a threshold-free method that works well with all types of biomedical features, such as genes, chemical compounds and microbial species. GRSA works in the mixed (classic RSA) and directed modes (enhanced RSA). The directed mode uses signs of the reporter score to distinguish up-regulated or down-regulated pathways, which is more intuitive. Importantly, the GRSA supports multi-group and longitudinal experimental designs because of the included multi-group-compatible statistical methods (for a full list of supported methods, please see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The ReporterScore package also supports custom hierarchical and relational databases (e.g. tables containing the correspondence between pathways and genes), providing extra flexibility for advanced users. In this study, we described the comprehensive utility of GRSA. We benchmarked GRSA against other popular enrichment methods across multiple datasets and demonstrated the applications of GRSA on diverse omics datasets.</p>
  </sec>
  <sec id="sec4">
    <title>MATERIALS AND METHODS</title>
    <sec id="sec5">
      <title>Algorithm</title>
      <p>The algorithm of GRSA is described as follows, using metagenomic data as an example.</p>
      <sec id="sec5a">
        <title>(1) Calculating the <italic toggle="yes">P</italic>-values</title>
        <p>A statistical method (the full list of supported statistical methods is in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>) was used to obtain the <italic toggle="yes">P</italic>-values of the features (i.e. <inline-formula><tex-math notation="LaTeX" id="ineq01">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${p}_{K{O}_i}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ineq02">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> represents a certain KO; <xref rid="f1" ref-type="fig">Figure 1A</xref>). We used KO to represent different features in the formulas for simplicity.</p>
        <fig position="float" id="f1">
          <label>Figure 1</label>
          <caption>
            <p>The overall workflow of GRSA in the ReporterScore package. (<bold>A</bold>) GRSA workflow consists of four parts: Calculate the <italic toggle="yes">P</italic>-values for KOs between two or multiple groups by various statistical methods; convert the <italic toggle="yes">P</italic>-values of KOs to <italic toggle="yes">Z</italic>-scores by inverse normal distribution and assignment of a plus or minus sign to each <italic toggle="yes">Z</italic>-score in the directed mode; mapping KOs to annotated pathways and calculating the reporter score for each pathway; visualize the results of GRSA. <inline-formula><tex-math notation="LaTeX" id="ineq03">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> represents a certain KO; <inline-formula><tex-math notation="LaTeX" id="ineq04">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${p}_{K{O}_i}$\end{document}</tex-math></inline-formula> is the <italic toggle="yes">P</italic>-value of <inline-formula><tex-math notation="LaTeX" id="ineq05">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ineq06">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_i}$\end{document}</tex-math></inline-formula> is the <italic toggle="yes">Z</italic>-score transformed from <inline-formula><tex-math notation="LaTeX" id="ineq07">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${p}_{K{O}_i}$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ineq08">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varDelta K{O}_i$\end{document}</tex-math></inline-formula> is the abundance difference of between groups. A total of <inline-formula><tex-math notation="LaTeX" id="ineq09">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula> KOs were annotated to the corresponding pathway. <inline-formula><tex-math notation="LaTeX" id="ineq10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\mu}_{k_j}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ineq11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\sigma}_{k_j}$\end{document}</tex-math></inline-formula> are the mean and the standard deviation of the background <italic toggle="yes">Z</italic>-score distribution <inline-formula><tex-math notation="LaTeX" id="ineq12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ null}$\end{document}</tex-math></inline-formula>, respectively. The ReporterScore package provides various visualization methods for the GRSA result. (<bold>B</bold>) The bar chart shows reporter scores of pathways in the mixed mode. The red color indicates significantly enriched pathways, with reporter scores greater than 1.64, corresponding to a <italic toggle="yes">P</italic>-value of 0.05. (<bold>C</bold>) The bar chart shows reporter scores of pathways in the directed mode. The orange and green colors indicate up-regulated and down-regulated pathways with absolute reporter scores &gt;1.64. (<bold>D</bold> and <bold>E</bold>) The line charts show the pattern of a selected pathway in the directed mode with a multi-group (<bold>D</bold>) and a longitudinal design (<bold>E</bold>), each line represents the trend of the average abundance of one KO. Line colors indicate whether the KO is significantly enriched (orange), depleted (green) or neither (gray). (<bold>F</bold>) The network plot shows the KOs present in selected pathways; some KOs can be shared by several pathways. Big dots represent pathways, and small dots represent KOs. The colors of small dots represent the trend of KOs. The colors of the shades encircling pathways denote whether the pathway is overall up-regulated (orange) or down-regulated (green). (<bold>G</bold>) The heatmap displays the abundance of each KO in a pathway for different samples (columns). (<bold>H</bold>) The circular packing plot shows the hierarchical relationship of selected pathways; the size of the circle indicates the absolute value of the reporter score, and the color of the circle indicates that the pathway is overall up-regulated (orange) and down-regulated (green).</p>
          </caption>
          <graphic xlink:href="bbae116f1" position="float"/>
        </fig>
      </sec>
      <sec id="sec5b">
        <title>(2) Converting the <italic toggle="yes">P</italic>-values into <italic toggle="yes">Z</italic>-scores</title>
        <p>For the classic mixed RSA, we used an inverse normal cumulative distribution function (<inline-formula><tex-math notation="LaTeX" id="ineq13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\theta}^{-1}$\end{document}</tex-math></inline-formula>) to convert the <italic toggle="yes">P</italic>-values of KOs into <italic toggle="yes">Z</italic>-scores. Thus, assuming uniformly distributed <italic toggle="yes">P</italic>-values under the random data assumption ranges, the resulting <italic toggle="yes">Z</italic>-scores will follow a standard normal distribution (<xref rid="f1" ref-type="fig">Figure 1A</xref>), and the formula is</p>
        <disp-formula id="deqn01">
          <label>(1)</label>
          <tex-math notation="LaTeX" id="DmEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} {Z}_{K{O}_i}={\theta}^{-1}\left(1-{p}_{K{O}_i}\right) \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>For the new directed RSA, we first divided the <italic toggle="yes">P</italic>-values by 2, transforming the range of <italic toggle="yes">P</italic>-values from <inline-formula><tex-math notation="LaTeX" id="ineq14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\left(0,1\right]$\end{document}</tex-math></inline-formula> to <inline-formula><tex-math notation="LaTeX" id="ineq15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\left(0,0.5\right]$\end{document}</tex-math></inline-formula> :</p>
        <disp-formula id="deqn02">
          <label>(2)</label>
          <tex-math notation="LaTeX" id="DmEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} {p}_{K{O}_i}={p}_{K{O}_i}/2\kern2.00em \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>Secondly, we used an inverse normal cumulative distribution function to convert the <italic toggle="yes">P</italic>-values of KOs into <italic toggle="yes">Z</italic>-scores (equation (<xref rid="deqn01" ref-type="disp-formula">1</xref>)). When the <italic toggle="yes">P</italic>-value is 0.5, the converted <italic toggle="yes">Z</italic>-score equals 0. Since the above <italic toggle="yes">P</italic>-values are no greater than 0.5, all converted <italic toggle="yes">Z</italic>-scores will be &gt;0 (<xref rid="f1" ref-type="fig">Figure 1A</xref>).</p>
        <p>We then determined if a KO is up-regulated or down-regulated and calculated the <inline-formula><tex-math notation="LaTeX" id="ineq16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varDelta K{O}_i$\end{document}</tex-math></inline-formula>.</p>
        <p>In a differential abundance analysis (two-group design):</p>
        <disp-formula id="deqn03">
          <label>(3)</label>
          <tex-math notation="LaTeX" id="DmEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \varDelta K{O}_i=\overline{K{O}_{i_{g1}}}-\overline{K{O}_{i_{g2}}} \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p><inline-formula><tex-math notation="LaTeX" id="ineq17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\overline{K{O}_{i_{g1}}}$\end{document}</tex-math></inline-formula> is the average abundance of <inline-formula><tex-math notation="LaTeX" id="ineq18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> in group 1, and <inline-formula><tex-math notation="LaTeX" id="ineq19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\overline{K{O}_{i_{g2}}}$\end{document}</tex-math></inline-formula> is the average abundance of <inline-formula><tex-math notation="LaTeX" id="ineq20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> in group 2.</p>
        <p>In a correlation analysis (two-group, multi-group and longitudinal design):</p>
        <disp-formula id="deqn04">
          <label>(4)</label>
          <tex-math notation="LaTeX" id="DmEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \varDelta K{O}_i={\rho}_{K{O}_i} \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p><inline-formula><tex-math notation="LaTeX" id="ineq21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\rho}_{K{O}_i}$\end{document}</tex-math></inline-formula> is the correlation coefficient between <inline-formula><tex-math notation="LaTeX" id="ineq22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> and the numeric variable.</p>
        <p>Finally, assign a plus or minus sign to each <italic toggle="yes">Z</italic>-score:</p>
        <disp-formula id="deqn05">
          <label>(5)</label>
          <tex-math notation="LaTeX" id="DmEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} {Z}_{K{O}_i}=\left\{\begin{array}{@{}cc}-{Z}_{K{O}_i},&amp; \left(\varDelta K{O}_i&lt;0\right)\\{}+{Z}_{K{O}_i},&amp; \left(\varDelta K{O}_i\ge 0\right)\end{array}\right. \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>Therefore, a <inline-formula><tex-math notation="LaTeX" id="ineq23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> with a <inline-formula><tex-math notation="LaTeX" id="ineq24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_i}$\end{document}</tex-math></inline-formula> &gt;0 is up-regulated and a <inline-formula><tex-math notation="LaTeX" id="ineq25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> with a <inline-formula><tex-math notation="LaTeX" id="ineq26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_i}$\end{document}</tex-math></inline-formula> &lt;0 is down-regulated.</p>
      </sec>
      <sec id="sec5c">
        <title>(3) Scoring the pathway</title>
        <p>We next used the <italic toggle="yes">Z</italic>-scores of KOs to score the pathway. First, choose a pathway database as the reference. It is of particular interest to note any hierarchy relational table (e.g. KEGG, taxonomy database) can be used as a reference as long as the relationship between the upstream and downstream features (e.g. pathways and KOs) can be represented by a bipartite network (<xref rid="f1" ref-type="fig">Figure 1A</xref>). For each pathway in the selected database, calculate the <italic toggle="yes">Z</italic>-score of pathway <italic toggle="yes">j</italic> (<inline-formula><tex-math notation="LaTeX" id="ineq27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula>) as follows:</p>
        <disp-formula id="deqn06">
          <label>(6)</label>
          <tex-math notation="LaTeX" id="DmEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} {Z}_{pat{h}_j}=\frac{1}{\sqrt{k_j}}\sum_{i=1}^{k_j}{Z}_{K{O}_i} \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ineq28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_i}$\end{document}</tex-math></inline-formula> is the <italic toggle="yes">Z</italic>-score of <inline-formula><tex-math notation="LaTeX" id="ineq29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> within <inline-formula><tex-math notation="LaTeX" id="ineq30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$pat{h}_j$\end{document}</tex-math></inline-formula>, and <inline-formula><tex-math notation="LaTeX" id="ineq31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula> denotes the total number of KOs in <inline-formula><tex-math notation="LaTeX" id="ineq32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$pat{h}_j$\end{document}</tex-math></inline-formula>.</p>
        <p>Next, we corrected <inline-formula><tex-math notation="LaTeX" id="ineq33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula> using the randomly sampled <inline-formula><tex-math notation="LaTeX" id="ineq34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula> from the background distribution of the <italic toggle="yes">Z</italic>-scores of all KOs (<inline-formula><tex-math notation="LaTeX" id="ineq35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_{all}}=\big\{{Z}_{K{O}_1},{Z}_{K{O}_2},\dots, {Z}_{K{O}_j}\big\}$\end{document}</tex-math></inline-formula>) to evaluate the significance of enrichment. Specifically, for a given pathway <inline-formula><tex-math notation="LaTeX" id="ineq36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$pat{h}_j$\end{document}</tex-math></inline-formula> including <inline-formula><tex-math notation="LaTeX" id="ineq37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula> KOs, we randomly sampled the same number (<inline-formula><tex-math notation="LaTeX" id="ineq38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j$\end{document}</tex-math></inline-formula>) of KOs from the background <inline-formula><tex-math notation="LaTeX" id="ineq39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_{all}}$\end{document}</tex-math></inline-formula> without replacement, and calculated the <inline-formula><tex-math notation="LaTeX" id="ineq40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula>, for <italic toggle="yes">N</italic> times (<italic toggle="yes">N</italic> = 10 000 in this study [<xref rid="ref15" ref-type="bibr">15</xref>]). We then standardized <inline-formula><tex-math notation="LaTeX" id="ineq41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula> by subtracting the mean (<inline-formula><tex-math notation="LaTeX" id="ineq42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\mu}_{k_j}$\end{document}</tex-math></inline-formula>) and dividing by the standard deviation (<inline-formula><tex-math notation="LaTeX" id="ineq43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\sigma}_{k_j}$\end{document}</tex-math></inline-formula>) of the <inline-formula><tex-math notation="LaTeX" id="ineq44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula> distribution. The standardized <inline-formula><tex-math notation="LaTeX" id="ineq45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula> is the <inline-formula><tex-math notation="LaTeX" id="ineq46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$ReporterScor{e}_j$\end{document}</tex-math></inline-formula>. The <italic toggle="yes">P</italic>-value of <inline-formula><tex-math notation="LaTeX" id="ineq47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$ReporterScor{e}_j$\end{document}</tex-math></inline-formula> is also estimated by the above permutation. The formulas for the reporter scores and associated <italic toggle="yes">P</italic>-values are</p>
        <disp-formula id="deqn07">
          <label>(7)</label>
          <tex-math notation="LaTeX" id="DmEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} ReporterScor{e}_j=\frac{Z_{pat{h}_j}-{\mu}_{k_j}}{\sigma_{k_j}} \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn08">
          <label>(8)</label>
          <tex-math notation="LaTeX" id="DmEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} p\_ valu{e}_j=\frac{\sum_{n=1}^NI\left({Z}_{pat{h}_j},{Z}_{pat h\_ nul{l}_{jn}}\right)+1}{N+1}\kern1em \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ineq48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula> have the same <inline-formula><tex-math notation="LaTeX" id="ineq49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$k$\end{document}</tex-math></inline-formula> to <inline-formula><tex-math notation="LaTeX" id="ineq50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ineq51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\mu}_{k_j}$\end{document}</tex-math></inline-formula> is the mean of the randomly generated <italic toggle="yes">N</italic><inline-formula><tex-math notation="LaTeX" id="ineq52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ineq53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\sigma}_{k_j}$\end{document}</tex-math></inline-formula> is the standard deviation of the randomly generated <italic toggle="yes">N</italic><inline-formula><tex-math notation="LaTeX" id="ineq54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula>.</p>
        <p>For the classic mixed RSA:</p>
        <disp-formula id="deqn09">
          <label>(9)</label>
          <tex-math notation="LaTeX" id="DmEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} I\left(a,b\right)=\left\{\begin{array}{@{}cc}1&amp; \left(a\ge b\right)\\{}0&amp; \left(a&lt;b\right)\end{array}\right. \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>For the new directed RSA:</p>
        <disp-formula id="deqn10">
          <label>(10)</label>
          <tex-math notation="LaTeX" id="DmEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} I\left(a,b\right)=\left\{\begin{array}{@{}cc}1&amp; \left( ReporterScor{e}_j\ge 0\&amp;a\ge b\right)\\{}1&amp; \left( ReporterScor{e}_j&lt;0\&amp;a\le b\right)\\{}0&amp; \left(\mathrm{Otherwise}\right)\end{array}\right. \end{equation*}\end{document}</tex-math>
        </disp-formula>
      </sec>
    </sec>
    <sec id="sec6">
      <title>Statistical analyses</title>
      <p>All statistical analyses were done on the R 4.2.2 platform. The developed ReporterScore package (<ext-link xlink:href="https://cran.r-project.org/web/packages/ReporterScore/" ext-link-type="uri">https://cran.r-project.org/web/packages/ReporterScore/</ext-link>) was used for GRSA and visualization. The Venn diagram and Venn network diagram were drawn by the pcutils package (<ext-link xlink:href="https://cran.r-project.org/web/packages/pcutils/" ext-link-type="uri">https://cran.r-project.org/web/packages/pcutils/</ext-link>). We collected several datasets for benchmarking and three different type omics datasets as case study [<xref rid="ref16" ref-type="bibr">16–18</xref>]. Details of these datasets can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Notes</xref>.</p>
      <p>To compare the performance of different statistical methods in the two-group experimental design, we defined a Jaccard similarity index:</p>
      <disp-formula id="deqn11">
        <label>(11)</label>
        <tex-math notation="LaTeX" id="DmEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \mathrm{Similarity}=\frac{\left| method(i)\cap method(j)\right|}{\left| method(i)\cup method(j)\right|}\kern2.00em \end{equation*}\end{document}</tex-math>
      </disp-formula>
      <p>where <italic toggle="yes">method</italic>(<italic toggle="yes">i</italic>) (<italic toggle="yes">method</italic>(<italic toggle="yes">j</italic>)) is the number of significant pathways based on benchmark data sets enriched by different methods.</p>
      <p>We used fuzzy c-means (FCM) clustering to explore the performance of different statistical test methods in multi-group experimental design (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2B,C</xref>) and gene expression patterns in transcriptome (<xref rid="f4" ref-type="fig">Figure 4A</xref>). FCM is an unsupervised machine-learning technique that partitions a population into groups or clusters [<xref rid="ref19" ref-type="bibr">19</xref>]. Three methods (Elbow, Silhouette and Gap statistic) were used to determine the optimal number of clusters. In FCM, the membership score is the probability that a feature belongs to a cluster. Each feature is assigned to a cluster based on its highest membership score.</p>
    </sec>
    <sec id="sec7">
      <title>Comparison with other enrichment analysis methods</title>
      <p>We compared GRSA against six commonly used enrichment analysis methods (<xref rid="TB1" ref-type="table">Table 1</xref>) using 50 benchmark datasets (41 human gene expression datasets related to disease and 9 wild-type/knockout mice gene expression datasets).</p>
      <p>We first calculated the <italic toggle="yes">P</italic>-values of features by <italic toggle="yes">t</italic>-test and performed adjustment of the <italic toggle="yes">P</italic>-values using the Benjamini and Hochberg (BH) method to control for false discovery rate. In order to perform the overrepresentation analysis, we selected the genes that have <italic toggle="yes">P</italic>-values &lt;0.05. The top 400 genes with the highest unsigned log-fold changes were considered as differentially expressed genes (DEGs) [<xref rid="ref20" ref-type="bibr">20</xref>]. Improved fisher.test (CP) was performed by enricher function in the clusterProfiler package with the DEGs list. Gene set enrichment analysis (GSEA) was performed by the GSEA function in the clusterProfiler package, and the <italic toggle="yes">t</italic>-test statistic was used as the metric for ranking [<xref rid="ref21" ref-type="bibr">21</xref>]. The R packages safe, GSVA, GSA and PADOG were used to run the respective methods. GRSA and RSA were performed with the BH-adjusted <italic toggle="yes">P</italic>-values of features by the ReporterScore package in the directed and mixed mode, respectively. A number of 1000 permutations were used in all methods relying on sample or gene permutations.</p>
      <p>Each human gene expression dataset in <xref rid="sup1" ref-type="supplementary-material">Supplementary</xref><xref rid="sup1" ref-type="supplementary-material">Table S2</xref> was associated with a disease with the defined mechanism in a KEGG pathway (termed the target pathway). Ideally, a good enrichment analysis method would rank the target pathway at or near the top of the list with a small adjusted <italic toggle="yes">P</italic>-value. Our human gene expression datasets were sourced from a list provided by Nguyen et al. [<xref rid="ref22" ref-type="bibr">22</xref>]. Based on statistical and biological considerations, we selected datasets in which the number of samples was consistent between the control and treatment groups (&lt;2× difference in sample size is allowed). Furthermore, there should be a measurable overall statistical difference between the gene expressions of the two groups (Adonis <italic toggle="yes">P</italic>-value &lt;0.05). The final 24 benchmark datasets are related to 10 human diseases, and each disease is associated with 2–4 datasets. For further benchmarking analysis, we also included 32 datasets provided by the ‘GSEABenchmarkeR’ package [<xref rid="ref23" ref-type="bibr">23</xref>].</p>
      <p>For wild-type/knockout mice gene expression datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>), we searched the GEO database for mouse single-gene knockout experiments. We selected datasets where more than three pathways were impacted, as this provides a robust basic for benchmarking various methods. We considered the pathways containing the knockout gene as true positives and the pathways without the knockout gene as true negatives [<xref rid="ref22" ref-type="bibr">22</xref>]. An adjusted <italic toggle="yes">P</italic>-value threshold of 0.05 was used to determine if a pathway is significantly affected. Based on the definitions of true positives (TP), true negatives (TN), false positives (FP) and false negatives (FN), we can calculate the sensitivity and specificity as follows:</p>
      <disp-formula id="deqn12">
        <label>(12)</label>
        <tex-math notation="LaTeX" id="DmEquation12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \mathrm{Sensitivity}=\frac{TP}{TP+ FN}\kern1em \end{equation*}\end{document}</tex-math>
      </disp-formula>
      <disp-formula id="deqn13">
        <label>(13)</label>
        <tex-math notation="LaTeX" id="DmEquation13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \mathrm{Specificity}=\frac{TN}{TN+ FP}\kern1em \end{equation*}\end{document}</tex-math>
      </disp-formula>
    </sec>
  </sec>
  <sec id="sec8">
    <title>RESULTS</title>
    <sec id="sec9">
      <title>Workflow overview</title>
      <p>The ReporterScore package has built-in KEGG pathway, module, gene, compound and GO databases and also allows customized databases, making it compatible with feature abundance tables from diverse omics data. A complete gene abundance table can be used for transcriptomic, scRNA-seq and related gene-based omics data of a specific species. For metagenomic and metatranscriptomic data, which involve many different species, a KO abundance table can be used, generated using Blast, Diamond or KEGG official mapper software [<xref rid="ref24" ref-type="bibr">24</xref>] to align the reads or contigs to the KEGG [<xref rid="ref25" ref-type="bibr">25</xref>] or the EggNOG database [<xref rid="ref26" ref-type="bibr">26</xref>]. An annotated compound abundance table can be used for metabolomic data, but the standardization of compound IDs (e.g. convert compound IDs to KEGG IDs) is required.</p>
      <p>The workflow of GRSA in the ReporterScore package is shown in <xref rid="f1" ref-type="fig">Figure 1</xref>, using metagenomic data as an example. The KO abundance table (rows are KOs and columns are samples) and metadata table (rows are samples and columns are experimental design groups) were used as the input for GRSA. Importantly, the input data should not be prefiltered to retain the background information. First, the <italic toggle="yes">P</italic>-values for all KOs were calculated by a proper statistical method. Then, in the classic mode, the <italic toggle="yes">P</italic>-values were directly converted to <italic toggle="yes">Z</italic>-scores (<xref rid="f1" ref-type="fig">Figure 1A</xref>, equation [i]). In the directed mode, the <italic toggle="yes">P</italic>-values were divided by 2, converted to <italic toggle="yes">Z</italic>-scores, and assigned plus or minus signs, denoting up- and down-regulated KOs (<xref rid="f1" ref-type="fig">Figure 1A</xref>, equations [ii–iv]). Next, the <italic toggle="yes">Z</italic>-score of pathway <inline-formula><tex-math notation="LaTeX" id="ineq55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j$\end{document}</tex-math></inline-formula> (<inline-formula><tex-math notation="LaTeX" id="ineq56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula>) was calculated by summing the <italic toggle="yes">Z</italic>-scores of KOs within pathway <inline-formula><tex-math notation="LaTeX" id="ineq57">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j$\end{document}</tex-math></inline-formula> and dividing by the square root of the number of KOs (<inline-formula><tex-math notation="LaTeX" id="ineq58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula>) in pathway <inline-formula><tex-math notation="LaTeX" id="ineq59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j$\end{document}</tex-math></inline-formula> (Figure 1A, equation [v]). The <inline-formula><tex-math notation="LaTeX" id="ineq60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula> is further standardized by the background pathway <italic toggle="yes">Z</italic>-score distribution, generated by randomly sampling <inline-formula><tex-math notation="LaTeX" id="ineq61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula> KOs from the total KO pool (<xref rid="f1" ref-type="fig">Figure 1A</xref>, equation [vi]). The standardized pathway <italic toggle="yes">Z</italic>-score is defined as the reporter score of a pathway (<inline-formula><tex-math notation="LaTeX" id="ineq62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$ReporterScor{e}_j$\end{document}</tex-math></inline-formula>).</p>
      <p>We designed the ReporterScore package to be user-friendly. In one step, the function reporter_score calculates the reporter scores for a feature abundance table with associated metadata. The included assorted visualization methods can be used to explore the entire pathways and features within pathways (<xref rid="f1" ref-type="fig">Figure 1B–H</xref>). The demo code is included in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Notes</xref>.</p>
    </sec>
    <sec id="sec10">
      <title>Applying GRSA to multi-group and longitudinal omics data</title>
      <p>An important feature of GRSA is the newly developed directed mode. The key difference between the directed mode and the mixed mode (classic RSA) is that in the directed mode, the reporter score’s plus or minus sign indicates the pathway’s increasing or decreasing trend (<xref rid="f1" ref-type="fig">Figure 1C</xref>). However, in the mixed mode, the signs of the reporter score do not indicate the trends of the pathways. We performed GRSA on the public ex_KO_profile dataset (a metagenomic dataset) in two modes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1A</xref>). For pathways enriched in the directed mode, most KOs within the pathway shared the same trend. The pathway with consistently increasing (decreasing) KOs would acquire a significantly bigger (smaller) aggregated <italic toggle="yes">Z</italic>-score than the background (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref>, blue and red boxes). If KOs within a pathway had opposing trends, the signed <italic toggle="yes">Z</italic>-scores would cancel each other, leading to insignificant results (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref>, orange box). In comparison, in the mixed mode, the increasing and decreasing trend of the enriched pathway cannot be determined (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1C</xref>). Therefore, the directed mode helps find pathways with consistently changing KOs. Several previous studies aimed for the result of the directed mode but mistakenly employed classic RSA (mixed mode) [<xref rid="ref14" ref-type="bibr">14</xref>].</p>
      <p>Another major advantage of GRSA is the full support of multi-group and longitudinal omics data. The ReporterScore package calculates the <italic toggle="yes">P</italic>-value for each feature between groups using differential abundance analysis or correlation analysis. The Kruskal–Wallis test or ANOVA assesses if the feature abundance varies significantly across multiple groups. The default correlation analysis treats group assignments as ordinal (e.g. groups ‘G1’, ‘G2’ and ‘G3’ will be converted to 1, 2 and 3), so the correlation analysis could evaluate if the feature abundance linearly increases or decreases. Moreover, the ReporterScore package also supports any specified patterns. For example, groups ‘G1’, ‘G2’ and ‘G3’ can be set as 1, 10, and 100 if an exponentially increasing trend is expected. To explore potential patterns within the data, clustering methods, such as C-means clustering, can be used.</p>
      <p>As a general rule, the users must ensure the selected statistical methods are applicable to the datasets and experimental designs. We applied GRSA with different statistical methods on multiple benchmark datasets. For the classic two-group design, the Jaccard similarity exceeded 0.84 for parametric methods and 0.78 for non-parametric methods, but the Jaccard similarity between parametric and non-parametric methods was lower than 0.63 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2A</xref>). The differences mainly stemmed from parametric versus non-parametric methods. For the multi-group data, users can choose the differential abundance analyses if they aim to enrich significantly altered pathways across groups. Correlation analysis is the preferred choice if the goal is to enrich pathways that show consistent increasing or decreasing patterns (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2B,C</xref>). Lastly, GRSA also supports other statistical tests, such as ‘DESeq2’, ‘Edger’, ‘Limma’, ‘ALDEX’ and ‘ANCOM’ [<xref rid="ref27" ref-type="bibr">27</xref>], to calculate the reporter scores. The demo code is shown in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Notes</xref>.</p>
      <fig position="float" id="f2">
        <label>Figure 2</label>
        <caption>
          <p>Comparisons of GRSA and other commonly used methods of enrichment analyses. (<bold>A</bold>–<bold>B</bold>) The box charts show the ranks (<bold>A</bold>) and adjusted <italic toggle="yes">P</italic>-values (<bold>B</bold>) of target pathways derived by four methods on 24 gene expression datasets. Numbers represent the median values for each method. (<bold>C</bold>–<bold>D</bold>) The box charts show the sensitivity (<bold>C</bold>) and specificity (<bold>D</bold>) of four methods on nine wild-type/knockout gene expression datasets. Numbers represent the median values for each method. CP: improved Fisher’s exact test used by the clusterProfiler package; GSEA: gene set enrichment analysis; SAFE: significance analysis of function and expression; GSA: gene set analysis in the GSA package; PADOG: pathway analysis with down-weighting of overlapping genes; GSVA: gene set variation analysis; RSA: classic reporter score-based analysis; GRSA: generalized reporter score-based analysis.</p>
        </caption>
        <graphic xlink:href="bbae116f2" position="float"/>
      </fig>
    </sec>
    <sec id="sec11">
      <title>GRSA showed higher sensitivity than other commonly used enrichment analysis methods</title>
      <p>Next, we evaluated the performance of GRSA and compared it with other commonly used enrichment analysis methods (<xref rid="TB1" ref-type="table">Table 1</xref>) on several benchmark datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables 2</xref>, <xref rid="sup1" ref-type="supplementary-material">3</xref> and the GEO list from ‘GSEABenchmarkeR’ package). PT-based methods may better identify biologically meaningful pathways than non-PT-based methods in certain scenarios [<xref rid="ref22" ref-type="bibr">22</xref>]. However, PT-based methods require comprehensive topological structures of pathways, limiting their applications in other non-human organisms [<xref rid="ref28" ref-type="bibr">28</xref>]. Therefore, we focused on the comparison against non-PT enrichment analysis methods. Nguyen et al. proposed several approaches to compare enrichment methods [<xref rid="ref22" ref-type="bibr">22</xref>], and we adapted their methodologies and evaluated the performance of GRSA against the other popular enrichment analysis methods using the identical pathway database (KEGG v109.0).</p>
      <p>We first compared the efficacy of different methods in identifying the target disease pathways using the 24 gene expression datasets associated with known human diseases (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). The rationale is that since each dataset is affiliated with a specific disease-linked KEGG pathway (the target pathway), an optimal enrichment analysis method should rank the target pathway among the top of all 342 pathways and enrich the target pathway with a smaller adjusted <italic toggle="yes">P</italic>-value. The results indicate that in terms of assigning a smaller rank to the target pathway, PADOG, GSA, GRSA, GSEA and SAFE performed similarly, as their median ranks all fall within the top 20% (<xref rid="f2" ref-type="fig">Figure 2A</xref>). In addition, GRSA achieves the lowest median adjusted <italic toggle="yes">P</italic>-values of the target pathways (<xref rid="f2" ref-type="fig">Figure 2B</xref>). We also used datasets from a GEO list provided by ‘GSEABenchmarkeR’ for further benchmarking and found similar results (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3A</xref>, <xref rid="sup1" ref-type="supplementary-material">B</xref>). Overall, GRSA’s performance is quite favorable among the threshold-free FCS methods, outperforming the conventional ORA method.</p>
      <p>We next evaluated the proficiency of different methods in detecting pathways disturbed by gene knockout experiments. In a gene knockout experiment, the knockout gene is a confirmed source of perturbation. Nguyen et al. considered pathways that included the knockout genes as true positives and pathways not including the target genes as true negatives, so the enrichment of such pathways would be considered false positives. Under these assumptions, we could calculate the sensitivity and specificity of a method. GRSA showed the highest median sensitivity among the methods considered, although its specificity is slightly reduced compared to others (<xref rid="f2" ref-type="fig">Figure 2C, D</xref>). We prioritize the sensitivity of a method because for pathways that included the knockout gene, deleting it should have a sizable impact on the pathway (sensitivity); however, for pathways that do not include the knockout gene in the database, given the potential incompleteness of pathway and gene databases, simply attributing these enriched pathways as false positives (specificity) may not always be appropriate.</p>
      <p>Lastly, we evaluated the ability of different methods to enrich biologically meaningful pathways [<xref rid="ref10" ref-type="bibr">10</xref>]. We compared the proportions of pathways identified by the GRSA, the competing tool and both, using the number of all significant pathways as the denominator (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3C</xref>). GRSA consistently identified a larger proportion of pathways than the ORA method and largely overlapped with GSEA. In these datasets, GRSA identified more enriched pathways than GSEA. For example, in the renal cell carcinoma dataset (GSE6344), pathways related to cytokine−cytokine receptor interaction [<xref rid="ref29" ref-type="bibr">29</xref>], IL-17 signaling [<xref rid="ref30" ref-type="bibr">30</xref>] and PI3K–Akt signaling [<xref rid="ref31" ref-type="bibr">31</xref>] were only enriched by GRSA (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4A</xref>). In the endometrial cancer dataset (GSE7305), GRSA identified pathways related to cancer, Toll-like receptor [<xref rid="ref32" ref-type="bibr">32</xref>] and cortisol synthesis [<xref rid="ref33" ref-type="bibr">33</xref>], which have been shown to be involved in the pathological characteristics of endometrial cancer (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4B</xref>). Therefore, GRSA can potentially identify more pathways biologically relevant to the studied diseases.</p>
    </sec>
    <sec id="sec12">
      <title>Case study 1: the functional analysis and age-related dynamics of the skin microbiota</title>
      <p>Next, we showcased the versatile applications of GRSA with different types of omics data. For microbiome data, we collected the KO profile of the IHSMGC (integrated Human Skin Microbial Gene Catalog) dataset published by Wang et al. [<xref rid="ref17" ref-type="bibr">17</xref>] and re-analyzed the data using the GRSA method. The previous study calculated the pathway abundance by aggregating the abundances of features within a pathway and then performed differential abundance analysis. We applied the GRSA to find the functional differences between the two cutotypes. The results were largely consistent. As an example, modules related to the biosynthesis of thiamine, phylloquinone and cobalamin were enriched in the <italic toggle="yes">M-cutotype</italic>, while modules related to tetrahydrofolate, menaquinone, pantothenate and ubiquinone were enriched in the <italic toggle="yes">C-cutotype</italic> (<xref rid="f3" ref-type="fig">Figure 3A</xref>). In addition, the <italic toggle="yes">M-cutotype</italic> was enriched with a large number of modules related to the metabolism of sulfur, phenylacetate (aromatic compound) and amino acids, while the <italic toggle="yes">C-cutotype</italic> was enriched with modules related to carbohydrate metabolism (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>). Importantly, GRSA also identified pathways not found in the previous study. The <italic toggle="yes">M-cutotype</italic> was enriched with modules related to nucleotide metabolism, such as the degradation and <italic toggle="yes">de novo</italic> biosynthesis of purine (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>), indicating that the <italic toggle="yes">M-cutotype</italic> microbiota may have a higher nucleotide turnover rate and stronger proliferation [<xref rid="ref34" ref-type="bibr">34</xref>].</p>
      <fig position="float" id="f3">
        <label>Figure 3</label>
        <caption>
          <p>Application of GRSA to the skin microbiome of the IHSMGC dataset. (<bold>A</bold>) The network of KO-Module enriched in the <italic toggle="yes">M-cutotype</italic> (green) and <italic toggle="yes">C-cutotype</italic> (blue). Only modules related to vitamin biosynthesis were shown. Big dots represent modules; small dots represent KOs. The colors of small dots represent cutotypes. Shades indicate modules involved in the biosynthesis of the same vitamin. The colors of shades denote modules enriched in the <italic toggle="yes">M-cutotype</italic> (green) or enriched in the <italic toggle="yes">C-cutotype</italic> (blue). (<bold>B</bold>–<bold>C</bold>) The box charts of modules ‘M00866’ (<bold>B</bold>) and ‘M00061’ (<bold>C</bold>) across ages. The colors of the lines represent the trend of KO’s relative abundance in the module. ‘M00866’ had the biggest positive reporter score (increasing), while ‘M00061’ had the biggest absolute value of negative score (decreasing). (<bold>D</bold>) The bar charts show significantly enriched modules over aging; the reporter score threshold of 2.5 corresponds to a confidence of about 0.995, and these modules are grouped based on the KEGG level B. Colors denote up-regulated (red) or down-regulated (green) modules with aging.</p>
        </caption>
        <graphic xlink:href="bbae116f3" position="float"/>
      </fig>
      <p>The previous study divided samples into five aging groups and found that the prevalence of the <italic toggle="yes">M-cutotype</italic> significantly increased with age. However, they did not perform age-related functional analysis. We re-analyzed the multi-group data using GRSA to explore the functional dynamics related to aging. The larger positive reporter scores indicate that the module had an overall increasing trend with respect to age, such as ‘M00866’, related to lipid A biosynthesis (<xref rid="f3" ref-type="fig">Figure 3B</xref>), while modules with negative reporter scores show an overall decreasing trend with respect to age, such as ‘M00061’, related to <sc>d</sc>-glucuronate degradation (<xref rid="f3" ref-type="fig">Figure 3C</xref>). We next analyzed the chronological trend of the functional modules at the KEGG level B (<xref rid="f3" ref-type="fig">Figure 3D</xref>), which better reflects the overall metabolic activities of the microbiome. We found that the carbohydrate metabolism activity of the skin microbiota decreased with aging, while the lipid, amino acid and nucleotide metabolism activity increased with aging. These results suggest that the energy sources of the skin microbiota significantly change with aging.</p>
      <p>The vitamin biosynthesis-related functional modules also showed differences with respect to aging (<xref rid="f3" ref-type="fig">Figure 3D</xref>). For the glycan metabolism-related functional modules, biosynthesis of KDO2-lipid A and CMP-KDO increased with aging. KDO2-lipid A is an essential lipopolysaccharide (LPS) component in most gram-negative bacteria, which has endotoxin activity and stimulates host immune responses through Toll-like receptor 4 (TLR4) [<xref rid="ref35" ref-type="bibr">35</xref>]. CMP-KDO is an important intermediate in the synthesis of KDO2-lipid A, and CMP-KDO synthesis is the key rate-limiting step for introducing KDO into LPS [<xref rid="ref36" ref-type="bibr">36</xref>]. These results suggest that the microbiota of aging skins likely accumulated endotoxins, which can stimulate host inflammation. In addition, we found that degradation pathways of several sulfated glycosaminoglycans (chondroitin sulfate, dermatan sulfate and keratan sulfate) decreased in aging skin. Sulfated glycosaminoglycans play a key role in regulating skin physiology, and there is ample evidence that their properties and functions change over time and with extrinsic skin aging [<xref rid="ref37" ref-type="bibr">37</xref>, <xref rid="ref38" ref-type="bibr">38</xref>]. Total sulfated glycosaminoglycan abundance was reduced in aging skin [<xref rid="ref39" ref-type="bibr">39</xref>], which may lead to the decreased degrading ability of the skin microbiota for the sulfated glycosaminoglycans.</p>
    </sec>
    <sec id="sec13">
      <title>Case study 2: the functional transcriptional dynamics during cardiomyocyte differentiation</title>
      <p>We applied GRSA to the transcriptomic dataset published by Liu et al. in 2017 [<xref rid="ref18" ref-type="bibr">18</xref>]. The study used the weighted gene co-expression network analysis (WGCNA) method to analyze the temporal transcriptomic changes during the differentiation of cardiomyocytes from 2 hiPSC lines and 2 hESC lines at 4 timepoints (pluripotent stem cells at day 0, mesoderm at day 2, cardiac mesoderm at day 4 and differentiated cardiomyocytes at day 30). Significant changes were observed in the four stages of differentiation among all cell lines. For example, genes in module 1 were highly expressed only in differentiated cardiomyocytes (stage CM), and their enriched Gene Ontology (GO) terms of Biological Process were related to heart functions, such as regulation of cardiac contraction and muscular system processes. WGCNA did not assume the patterns to be linear so that genes can be only highly expressed at day 2 during mesoderm development, for example.</p>
      <p>In addition to linearly increasing or decreasing patterns, GRSA allows users to specify any expected patterns for enrichment analysis. To start, we used the fuzzy C-means clustering method to identify the main gene expression patterns (<xref rid="f4" ref-type="fig">Figure 4A</xref>) and then used these patterns for GRSA to obtain significantly enriched pathways in each pattern (using the RSA_by_cm function in the ReporterScore package). For example, ‘Heart process (GO:0003015)’ was a significantly enriched GO term for Cluster 6, which was highly expressed only in stage CM (day 30). We identified many genes consistent with the expression pattern of Cluster 6 (<xref rid="f4" ref-type="fig">Figure 4B</xref>).</p>
      <fig position="float" id="f4">
        <label>Figure 4</label>
        <caption>
          <p>Application of GRSA to the transcriptomic dataset on the cardiomyocyte differentiation processes. (<bold>A</bold>) C-means clustering result of gene abundance profiles across four differentiation stages. The genes with membership scores greater than 0.8 are displayed. The alpha (transparency) of each line was related to the value of its membership score, and the <italic toggle="yes">y</italic>-axis represents the standardized abundance. (<bold>B</bold>) The box chart shows the abundance of genes in ‘GO:0003015’ (heart process) across four time points; the colors of the lines represent the correlative significance of each gene with Cluster 6 within the GO term. ‘GO:0003015’ is a representative term of Cluster 6. (<bold>C</bold>) The bar chart shows significantly enriched GO terms for each clustering pattern corresponding to the differentiation stages. The colors of the bars represent the cluster information, and the representative GO terms with high reporter scores in each cluster are shown. The text labels on the left are colored according to the stages with the highest expression. In general, Cluster 2 corresponds to day 0, Clusters 4 and 5 correspond to day 2, Cluster 1 corresponds to day 4, and Clusters 3 and 6 correspond to CM. Note that only pathways with significant positive scores are shown. The negative score of specified patterns would indicate anti-correlative patterns, which should have already been identified by c-means analysis, such as Cluster 3 versus 4.</p>
        </caption>
        <graphic xlink:href="bbae116f4" position="float"/>
      </fig>
      <p>GRSA results for all clusters are shown in <xref rid="f4" ref-type="fig">Figure 4C</xref>. Cluster 2 was highly expressed only at day 0, and its enriched GO terms were mainly related to the mitotic cell cycle, which was expected for stem cell self-renewal processes. Cluster 5 had the highest expression level on day 2 and was mainly enriched in various transcription and translation processes. Cluster 4 was highly expressed at day 0 and day 2 and showed a gradually decreasing trend; its function overlapped with Clusters 2 and 5. Cluster 1, highly expressed at day 4, was related to mesoderm formation, such as morphogenesis and organ development. Clusters 3 and 6 were primarily up-regulated in differentiated cardiomyocytes (CM stage), and they were related to heart functions, such as regulation of heart contraction and muscle system processes, similar to module 1 in the previous study. Interestingly, the biological processes of hiPSCs/hESCs at day 2 (Cluster 5) induced various RNA-related metabolisms, which were not found in the previous study, indicating that complex transcriptional regulations are involved for further mesoderm formation. Therefore, using the identified expression patterns across groups, we successfully identified pathways and modules essential to different stages of the cardiomyocyte differentiation processes.</p>
    </sec>
    <sec id="sec14">
      <title>Case study 3: the systematic maternal metabolomic changes correlated with gestational age</title>
      <p>We next applied GRSA to metabolomic data from a Danish pregnancy cohort in which female participants had blood drawn weekly from pregnancy to the postpartum period for untargeted metabolomics analysis [<xref rid="ref16" ref-type="bibr">16</xref>]. Using gestational age as the study variable, they modeled a metabolic clock and found that several marker metabolites increased linearly with gestational age.</p>
      <p>We found several important pathways up-regulated with gestational age: steroid hormone biosynthesis, cortisol synthesis and secretion, and oocyte meiosis (<xref rid="f5" ref-type="fig">Figure 5A</xref>). Multiple steroid hormones were up-regulated with increasing gestational age (<xref rid="f5" ref-type="fig">Figure 5B</xref>), including progesterone that interacts with the hypothalamic–pituitary–adrenal axis [<xref rid="ref40" ref-type="bibr">40</xref>] and estriol-16-glucuronide produced by the placenta [<xref rid="ref41" ref-type="bibr">41</xref>]. At the same time, two androgen-related steroid hormones were down-regulated: dehydroepiandrosterone sulfate and androsterone 3-glucuronide, as the concentration of androgens plays important physiological functions during pregnancy [<xref rid="ref42" ref-type="bibr">42</xref>]. We also found that pathways related to the metabolism of aromatic amino acids were down-regulated with increasing gestational age (<xref rid="f5" ref-type="fig">Figure 5A</xref>), which has been reported [<xref rid="ref43" ref-type="bibr">43</xref>].</p>
      <fig position="float" id="f5">
        <label>Figure 5</label>
        <caption>
          <p>Application of GRSA in the metabolic data of the Danish pregnancy cohort and the taxonomic enrichment analysis of the IHSMGC dataset. (<bold>A</bold>) The circle packing chart shows the hierarchical relationships of significantly enriched pathways identified by GRSA in the metabolomic study. The size of the circle indicates the absolute value of the reporter score, and the color of the circle indicates the sign of the reporter score. The positive reporter score indicates the pathway was increased (orange), while the negative reporter score indicates the pathway was decreased (purple). (<bold>B</bold>) The heatmap shows the abundance of metabolites in the pathway ‘steroid hormone biosynthesis’. The columns are samples ordered by the increasing gestational age. (<bold>C</bold>) The bar chart shows significantly enriched genera in the <italic toggle="yes">C-cutotype</italic> and <italic toggle="yes">M-cutotype</italic>. (<bold>D</bold>) The network plot shows the species in <italic toggle="yes">g_Moraxella</italic> and <italic toggle="yes">g_Cutibacterium</italic> enriched in the <italic toggle="yes">M-cutotype</italic> (green) or <italic toggle="yes">C-cutotype</italic> (blue).</p>
        </caption>
        <graphic xlink:href="bbae116f5" position="float"/>
      </fig>
      <p>Importantly, we identified several up-regulated pathways related to human diseases not mentioned in the previous study. Cushing syndrome happens when the body has too much of the hormone cortisol for a long time, which could be induced by a healthy pregnancy [<xref rid="ref44" ref-type="bibr">44</xref>]. The up-regulation of pathways related to breast cancer was also noticeable, as pregnancy-associated breast cancer (PABC) accounts for 7% of all breast cancer in young women [<xref rid="ref45" ref-type="bibr">45</xref>]. More potential discoveries can be made if the metabolite-pathway database is improved.</p>
    </sec>
    <sec id="sec15">
      <title>Case study 4: the application of GRSA beyond functional enrichment analysis</title>
      <p>The algorithm of GRSA suggests that any features organized in a hierarchical relationship can be used as an enrichment database. For example, we can perform taxonomic enrichment analysis using the phylogenetic relationships of microbes, such as genus–species relationships. To demonstrate, with the custom_modulelist function, we used the species abundance table from the IHSMGC dataset and looked for genera enriched in the two cutotypes. We found that <italic toggle="yes">Psychrobacter</italic>, <italic toggle="yes">Paracoccus</italic>, <italic toggle="yes">Chryseobacterium</italic>, <italic toggle="yes">Elizabethkingia</italic>, <italic toggle="yes">Deinococcus</italic> and <italic toggle="yes">Microbacterium</italic> were enriched in the <italic toggle="yes">M-cutotype</italic>, while <italic toggle="yes">Acidipropionibacterium</italic>, <italic toggle="yes">Staphylococcus</italic>, <italic toggle="yes">Corynebacterium</italic> and <italic toggle="yes">Cutibacterium</italic> were enriched in the <italic toggle="yes">C-cutotype</italic> (<xref rid="f5" ref-type="fig">Figure 5C</xref>), some of which were highly consistent with the differential species modules found by co-occurrence network in the previous study. However, we additionally found some genera, such as <italic toggle="yes">Brevundimonas</italic> and <italic toggle="yes">Rhodobacter</italic>, enriched in the <italic toggle="yes">M-cutotype</italic>, while <italic toggle="yes">Pahexavirus</italic> (phages of <italic toggle="yes">Propionibacterium</italic> and <italic toggle="yes">Cutibacterium</italic>) was enriched in the <italic toggle="yes">C-cutotype</italic> (<xref rid="f5" ref-type="fig">Figure 5C</xref>), probably due to the higher sensitivity of GRSA.</p>
      <p>Two species, <italic toggle="yes">Moraxella osloensis</italic> and <italic toggle="yes">Cutibacterium acnes</italic>, were used to define the cutotype in the previous study. Interestingly, while the <italic toggle="yes">Cutibacterium</italic> genus was a good biomarker between cutotypes, the <italic toggle="yes">Moraxella</italic> genus was not, as the included species did not share the same trend (<xref rid="f5" ref-type="fig">Figure 5D</xref>). Therefore, in addition to functional enrichment analysis, GRSA can be extended to any hierarchical relational data structure.</p>
    </sec>
  </sec>
  <sec id="sec16">
    <title>DISCUSSION</title>
    <p>We developed the ReporterScore package and demonstrated broad applications of the GRSA enrichment analyses. We improved the classic RSA method for easier interpretation of the plus and minus signs of the reporter scores. More importantly, we expanded the scope of GRSA from two-group designs to multi-group and longitudinal designs. We demonstrated these new features with metagenomic, transcriptomic and metabolomic data (<xref rid="f3" ref-type="fig">Figures 3</xref>–<xref rid="f5" ref-type="fig">5</xref>). Lastly, we showed that the GRSA is not limited to functional enrichment analysis. Notably, all figures were generated using the visualization module in the ReporterScore package.</p>
    <p>GRSA considers all KOs involved in the pathway compared to hypergeometric tests that only consider a pre-defined list (e.g. KO/gene with <italic toggle="yes">P</italic>-value &lt; 0.05). Thus, GRSA is more sensitive and can comprehensively assess the feature abundance differences in the pathway (<xref rid="f2" ref-type="fig">Figure 2</xref>). GRSA still has some limitations: (1) GRSA exhibits a slightly lower specificity, underscoring the necessity for additional experimental validations. (2) GRSA relies on <italic toggle="yes">Z</italic>-scores derived from <italic toggle="yes">P</italic>-values as the statistical measure, which depends on the upstream statistical methods. Users are required to select appropriate statistical methods based on the nature of the data and experimental design. (3) GRSA is a competitive enrichment analysis method that relies on the key assumption of feature independence [<xref rid="ref46" ref-type="bibr">46</xref>].</p>
    <p>We must acknowledge that comparing enrichment analysis methods is fraught with risks, as there is no established gold standard in the field despite continuous efforts [<xref rid="ref2" ref-type="bibr">2</xref>]. Many reviews typically use disease datasets to evaluate methods based on prioritization or phenotype relevance [<xref rid="ref8" ref-type="bibr">8</xref>, <xref rid="ref23" ref-type="bibr">23</xref>, <xref rid="ref28" ref-type="bibr">28</xref>, <xref rid="ref47" ref-type="bibr">47</xref>]. We used the ranks and <italic toggle="yes">P</italic>-values of statistical methods to evaluate the prioritization in our comparison (<xref rid="f2" ref-type="fig">Figure 2A,B</xref>), assuming a single true positive: the target disease-associated pathway. However, diseases like cancer cause significant disruptions to complex biological systems. For some diseases, many different pathways could be impacted to varying degrees, with non-target pathways sometimes affected even more than the target pathway [<xref rid="ref22" ref-type="bibr">22</xref>].</p>
    <p>We used the knockout gene experiment datasets to assess sensitivity and specificity referred to Nguyen et al. [<xref rid="ref22" ref-type="bibr">22</xref>]. We considered sensitivity a crucial metric for enrichment methods because an effective method should maximize the identification of the expected pathways (<xref rid="f2" ref-type="fig">Figure 2C</xref>). The gene–pathway relationships recorded in the database are typically backed by experimental evidence, making the definitions of true positives and false negatives more suitable. Thus, the sensitivity can be effectively evaluated (equation (<xref rid="deqn12" ref-type="disp-formula">12</xref>)). In contrast, it is difficult to define the true negatives due to the complexity of biological systems leading to the incompleteness of databases. For example, a knocked-out gene may impact pathway A through a signaling pathway yet to be discovered, which frequently happens in molecular biology research. Thus, the specificity of a method cannot be accurately evaluated (equation (<xref rid="deqn13" ref-type="disp-formula">13</xref>), <xref rid="f2" ref-type="fig">Figure 2D</xref>). Moreover, the primary role of functional enrichment analysis is to guide for interpreting the omics data. Additional experimental verification is essential to substantiate the analysis results.</p>
    <p>Multi-omic studies are increasingly prevalent and so are the demands for functional enrichment analysis of all types of omics data [<xref rid="ref48" ref-type="bibr">48–51</xref>]. The GRSA applies to all types of omics datasets as long as a relevant relational database is available. As demonstrated by case studies, we confirmed previous key findings and acquired new biological insights. For example, applying GRSA on the IHSMGC dataset suggested different functional profiles between aging and young skin microbiota. Biosynthesis of KDO2-lipid A and CMP-KDO increased while degradation pathways of several sulfated glycosaminoglycans decreased in older skin microbiota, which may be linked to changes in the skin’s physiological properties. Further studies are needed to investigate the underlying mechanisms and their implications for skin health. Applying GRSA on the transcriptomic data of cardiomyocyte differentiations revealed that hiPSCs/hESCs at day 2 specialized in various RNA-related metabolisms, suggesting the involvement of complex transcriptional regulation in further mesoderm formation. Finally, applying GRSA to the metabolomic data from the Danish pregnancy cohort showed that several pathways related to human diseases were up-regulated with gestational age, including Cushing syndrome and PABC.</p>
    <p>The GRSA offers the option for user-specified patterns for enrichment analysis, allowing for rapid testing of educated hypotheses in complex multi-group studies. This is demonstrated in our analysis of the transcriptomic data during cardiomyocyte differentiations. The GRSA offers applications beyond functional enrichment analysis. Applying GRSA in the taxonomic enrichment analysis of the IHSMGC dataset identified key genera that significantly differed between the two cutotypes. The results were highly consistent with the microbial co-occurrence network analysis in the previous study, but performing GRSA was much easier and faster than the network analysis.</p>
    <p>In summary, we believe the GRSA and the ReporterScore package can greatly facilitate the functional enrichment analyses of diverse omics data, with higher sensitivity, compatibility with multi-group and longitudinal designs, and flexibility with customized databases for creative applications beyond functional enrichment analyses. In the future, we plan to incorporate additional built-in databases and visualization techniques, while consistently maintaining and updating the ReporterScore package.</p>
    <boxed-text id="box01" position="float">
      <sec id="sec17">
        <title>Key Points</title>
        <list list-type="bullet">
          <list-item>
            <p>We developed generalized reporter score enrichment analysis (GRSA) and the R package ReporterScore, significantly expanding the capabilities of the classic RSA to multi-group and longitudinal experimental designs and is inherently compatible with nearly all types of omics data.</p>
          </list-item>
          <list-item>
            <p>The GRSA offers higher sensitivity than commonly used enrichment analysis approaches. We confirmed previous key findings and acquired new biological insights in 4 case studies using GRSA.</p>
          </list-item>
          <list-item>
            <p>The GRSA can be applied to any established relational database and perform customized enrichment analysis, such as taxonomy enrichment analysis.</p>
          </list-item>
        </list>
      </sec>
    </boxed-text>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>RS_supp_BIB3-final_bbae116</label>
      <media xlink:href="rs_supp_bib3-final_bbae116.docx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="bbae116-ack">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We are grateful to our colleagues at the core facility of the Life Sciences Institute, especially the NECHO high-performance computing cluster.</p>
  </ack>
  <sec id="sec21">
    <title>FUNDING</title>
    <p>This research was supported by grants from NSFC (82173645 and 82341109) and the Fundamental Research Funds for the Central Universities (2022FZZX03-03-07).</p>
  </sec>
  <sec id="sec19">
    <title>AUTHOR CONTRIBUTIONS</title>
    <p><bold>Chen Peng:</bold> Conceptualization, Methodology, Investigation, Software, Visualization, Formal Analysis, Validation, Writing – Original Draft and Writing – Review &amp; Editing. <bold>Qiong Chen:</bold> Writing – Review &amp; Editing. <bold>Shangjin Tan:</bold> Writing – Review &amp; Editing. <bold>Xiaotao Shen:</bold> Writing – Review &amp; Editing. <bold>Chao Jiang:</bold> Conceptualization, Methodology, Investigation, Writing – Original Draft, Writing – Review &amp; Editing, Supervision, Project Administration and Funding Acquisition.</p>
  </sec>
  <sec sec-type="data-availability" id="sec18">
    <title>DATA AVAILABILITY</title>
    <p>Code is available as an open-source R package ‘ReporterScore’ on the Comprehensive R Archive Network (CRAN) (<ext-link xlink:href="https://cran.r-project.org/web/packages/ReporterScore" ext-link-type="uri">https://cran.r-project.org/web/packages/ReporterScore</ext-link>). The main analysis scripts (Rmarkdown format) and source data are available from GitHub (<ext-link xlink:href="https://github.com/Asa12138/Analysis_code/tree/main/GRSA_figures" ext-link-type="uri">https://github.com/Asa12138/Analysis_code/tree/main/GRSA_figures</ext-link>).</p>
  </sec>
  <notes id="bio3">
    <title>Author Biographies</title>
    <p><bold>Chen Peng</bold> is a PhD student in the Life Sciences Institute at Zhejiang University.</p>
    <sec sec-type="author-bio" id="sec22b">
      <p><bold>Qiong Chen</bold> is a post-doctoral fellow in the Life Sciences Institute at Zhejiang University.</p>
    </sec>
    <sec sec-type="author-bio" id="sec22c">
      <p><bold>Shangjin Tan</bold> is working in the BGI Research.</p>
    </sec>
    <sec sec-type="author-bio" id="sec22d">
      <p><bold>Xiaotao Shen</bold> is a post-doctoral fellow in Prof. Michael Snyder’s lab at Stanford University School of Medicine.</p>
    </sec>
    <sec sec-type="author-bio" id="sec22e">
      <p><bold>Chao Jiang</bold> is a principal investigator in the Life Sciences Institute at Zhejiang University.</p>
    </sec>
  </notes>
  <ref-list id="bib1">
    <title>References</title>
    <ref id="ref1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>K</given-names></string-name>, <string-name><surname>Rhee</surname><given-names>SY</given-names></string-name></person-group>. <article-title>Interpreting omics data with pathway enrichment analysis</article-title>. <source>Trends Genet</source><year>2023</year>;<volume>39</volume>:<fpage>308</fpage>–<lpage>19</lpage>.<pub-id pub-id-type="pmid">36750393</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mubeen</surname><given-names>S</given-names></string-name>, <string-name><surname>Tom Kodamullil</surname><given-names>A</given-names></string-name>, <string-name><surname>Hofmann-Apitius</surname><given-names>M</given-names></string-name>, <string-name><surname>Domingo-Fernández</surname><given-names>D</given-names></string-name></person-group>. <article-title>On the influence of several factors on pathway enrichment analysis</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbac143</fpage>.<pub-id pub-id-type="pmid">35453140</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sherman</surname><given-names>BT</given-names></string-name>, <string-name><surname>Hao</surname><given-names>M</given-names></string-name>, <string-name><surname>Qiu</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>DAVID: a web server for functional enrichment analysis and functional annotation of gene lists (2021 update)</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>W216</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">35325185</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>T</given-names></string-name>, <string-name><surname>Hu</surname><given-names>E</given-names></string-name>, <string-name><surname>Xu</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>clusterProfiler 4.0: a universal enrichment tool for interpreting omics data</article-title>. <source>Innovation (Camb)</source><year>2021</year>;<volume>2</volume>:<fpage>100141</fpage>.<pub-id pub-id-type="pmid">34557778</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname><given-names>A</given-names></string-name>, <string-name><surname>Tamayo</surname><given-names>P</given-names></string-name>, <string-name><surname>Mootha</surname><given-names>VK</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc Natl Acad Sci</source><year>2005</year>;<volume>102</volume>:<fpage>15545</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barry</surname><given-names>WT</given-names></string-name>, <string-name><surname>Nobel</surname><given-names>AB</given-names></string-name>, <string-name><surname>Wright</surname><given-names>FA</given-names></string-name></person-group>. <article-title>Significance analysis of functional categories in gene expression studies: a structured permutation approach</article-title>. <source>Bioinformatics</source><year>2005</year>;<volume>21</volume>:<fpage>1943</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">15647293</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Efron</surname><given-names>B</given-names></string-name>, <string-name><surname>Tibshirani</surname><given-names>R</given-names></string-name></person-group>. <article-title>On testing the significance of sets of genes</article-title>. <source>Ann Appl Stat</source><year>2007</year>;<volume>1</volume>:<fpage>107</fpage>–<lpage>29</lpage>.</mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarca</surname><given-names>AL</given-names></string-name>, <string-name><surname>Draghici</surname><given-names>S</given-names></string-name>, <string-name><surname>Bhatti</surname><given-names>G</given-names></string-name>, <string-name><surname>Romero</surname><given-names>R</given-names></string-name></person-group>. <article-title>Down-weighting overlapping genes improves gene set analysis</article-title>. <source>BMC Bioinformatics</source><year>2012</year>;<volume>13</volume>:<fpage>136</fpage>.<pub-id pub-id-type="pmid">22713124</pub-id></mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hänzelmann</surname><given-names>S</given-names></string-name>, <string-name><surname>Castelo</surname><given-names>R</given-names></string-name>, <string-name><surname>Guinney</surname><given-names>J</given-names></string-name></person-group>. <article-title>GSVA: gene set variation analysis for microarray and RNA-Seq data</article-title>. <source>BMC Bioinformatics</source><year>2013</year>;<volume>14</volume>:<fpage>7</fpage>.<pub-id pub-id-type="pmid">23323831</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Q</given-names></string-name>, <string-name><surname>Wang</surname><given-names>S</given-names></string-name>, <string-name><surname>Dai</surname><given-names>E</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Pathway enrichment analysis approach based on topological structure and updated annotation of pathway</article-title>. <source>Brief Bioinform</source><year>2019</year>;<volume>20</volume>:<fpage>168</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">28968630</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goeman</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Bühlmann</surname><given-names>P</given-names></string-name></person-group>. <article-title>Analyzing gene expression data in terms of gene sets: methodological issues</article-title>. <source>Bioinformatics</source><year>2007</year>;<volume>23</volume>:<fpage>980</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">17303618</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patil</surname><given-names>KR</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>J</given-names></string-name></person-group>. <article-title>Uncovering transcriptional regulation of metabolism by using metabolic network topology</article-title>. <source>Proc Natl Acad Sci U S A</source><year>2005</year>;<volume>102</volume>:<fpage>2685</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">15710883</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>F</given-names></string-name>, <string-name><surname>Ju</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Metagenome-wide association of gut microbiome features for schizophrenia</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>1612</fpage>.<pub-id pub-id-type="pmid">32235826</pub-id></mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>L</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>R</given-names></string-name>, <string-name><surname>Wu</surname><given-names>D</given-names></string-name></person-group>. <article-title>Misuse of reporter score in microbial enrichment analysis</article-title>. <source>iMeta</source><year>2023</year>;<volume>2</volume>:<fpage>e95</fpage>.<pub-id pub-id-type="pmid">38868431</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oliveira</surname><given-names>AP</given-names></string-name>, <string-name><surname>Patil</surname><given-names>KR</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>J</given-names></string-name></person-group>. <article-title>Architecture of transcriptional regulatory circuits is knitted over the topology of bio-molecular interaction networks</article-title>. <source>BMC Syst Biol</source><year>2008</year>;<volume>2</volume>:<fpage>17</fpage>.<pub-id pub-id-type="pmid">18261202</pub-id></mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liang</surname><given-names>L</given-names></string-name>, <string-name><surname>Rasmussen</surname><given-names>M-LH</given-names></string-name>, <string-name><surname>Piening</surname><given-names>B</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Metabolic dynamics and prediction of gestational age and time to delivery in pregnant women</article-title>. <source>Cell</source><year>2020</year>;<volume>181</volume>:<fpage>1680</fpage>–<lpage>1692.e15</lpage>.<pub-id pub-id-type="pmid">32589958</pub-id></mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Z</given-names></string-name>, <string-name><surname>Xia</surname><given-names>J</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Characterization of the human skin resistome and identification of two microbiota cutotypes</article-title>. <source>Microbiome</source><year>2021</year>;<volume>9</volume>:<fpage>47</fpage>.<pub-id pub-id-type="pmid">33597039</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>C</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Genome-wide temporal profiling of transcriptome and open chromatin of early cardiomyocyte differentiation derived from hiPSCs and hESCs</article-title>. <source>Circ Res</source><year>2017</year>;<volume>121</volume>:<fpage>376</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">28663367</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bezdek</surname><given-names>JC</given-names></string-name>, <string-name><surname>Ehrlich</surname><given-names>R</given-names></string-name>, <string-name><surname>Full</surname><given-names>W</given-names></string-name></person-group>. <article-title>FCM: the fuzzy c-means clustering algorithm</article-title>. <source>Comput Geosci</source><year>1984</year>;<volume>10</volume>:<fpage>191</fpage>–<lpage>203</lpage>.</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shi</surname><given-names>L</given-names></string-name>, <string-name><surname>Shi</surname><given-names>L</given-names></string-name>, <string-name><surname>Reid</surname><given-names>LH</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The MicroArray quality control (MAQC) project shows inter- and intraplatform reproducibility of gene expression measurements</article-title>. <source>Nat Biotechnol</source><year>2006</year>;<volume>24</volume>:<fpage>1151</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">16964229</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zyla</surname><given-names>J</given-names></string-name>, <string-name><surname>Marczyk</surname><given-names>M</given-names></string-name>, <string-name><surname>Weiner</surname><given-names>J</given-names></string-name>, <string-name><surname>Polanska</surname><given-names>J</given-names></string-name></person-group>. <article-title>Ranking metrics in gene set enrichment analysis: do they matter?</article-title><source>BMC Bioinformatics</source><year>2017</year>;<volume>18</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">28049414</pub-id></mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nguyen</surname><given-names>T-M</given-names></string-name>, <string-name><surname>Shafi</surname><given-names>A</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>T</given-names></string-name>, <string-name><surname>Draghici</surname><given-names>S</given-names></string-name></person-group>. <article-title>Identifying significantly impacted pathways: a comprehensive review and assessment</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>203</fpage>.<pub-id pub-id-type="pmid">31597578</pub-id></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Geistlinger</surname><given-names>L</given-names></string-name>, <string-name><surname>Csaba</surname><given-names>G</given-names></string-name>, <string-name><surname>Santarelli</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Toward a gold standard for benchmarking gene set enrichment analysis</article-title>. <source>Brief Bioinform</source><year>2021</year>;<volume>22</volume>:<fpage>545</fpage>–<lpage>56</lpage>.<pub-id pub-id-type="pmid">32026945</pub-id></mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M</given-names></string-name>, <string-name><surname>Sato</surname><given-names>Y</given-names></string-name></person-group>. <article-title>KEGG mapper for inferring cellular functions from protein sequences</article-title>. <source>Protein Sci</source><year>2020</year>;<volume>29</volume>:<fpage>28</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">31423653</pub-id></mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M</given-names></string-name>, <string-name><surname>Sato</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kawashima</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>KEGG as a reference resource for gene and protein annotation</article-title>. <source>Nucleic Acids Res</source><year>2016</year>;<volume>44</volume>:<fpage>D457</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">26476454</pub-id></mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huerta-Cepas</surname><given-names>J</given-names></string-name>, <string-name><surname>Szklarczyk</surname><given-names>D</given-names></string-name>, <string-name><surname>Heller</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>eggNOG 5.0: a hierarchical, functionally and phylogenetically annotated orthology resource based on 5090 organisms and 2502 viruses</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>D309</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">30418610</pub-id></mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nearing</surname><given-names>JT</given-names></string-name>, <string-name><surname>Douglas</surname><given-names>GM</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>MG</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Microbiome differential abundance methods produce different results across 38 datasets</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>342</fpage>.<pub-id pub-id-type="pmid">35039521</pub-id></mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>J</given-names></string-name>, <string-name><surname>Shojaie</surname><given-names>A</given-names></string-name>, <string-name><surname>Michailidis</surname><given-names>G</given-names></string-name></person-group>. <article-title>A comparative study of topology-based pathway enrichment analysis methods</article-title>. <source>BMC Bioinformatics</source><year>2019</year>;<volume>20</volume>:<fpage>546</fpage>.<pub-id pub-id-type="pmid">31684881</pub-id></mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ocvirk</surname><given-names>S</given-names></string-name>, <string-name><surname>O’Keefe</surname><given-names>SJD</given-names></string-name></person-group>. <article-title>Dietary fat, bile acid metabolism and colorectal cancer</article-title>. <source>Semin Cancer Biol</source><year>2021</year>;<volume>73</volume>:<fpage>347</fpage>–<lpage>55</lpage>.<pub-id pub-id-type="pmid">33069873</pub-id></mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jarocki</surname><given-names>M</given-names></string-name>, <string-name><surname>Karska</surname><given-names>J</given-names></string-name>, <string-name><surname>Kowalski</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Interleukin 17 and its involvement in renal cell carcinoma</article-title>. <source>J Clin Med</source><year>2022</year>;<volume>11</volume>:<fpage>4973</fpage>.<pub-id pub-id-type="pmid">36078902</pub-id></mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Banumathy</surname><given-names>G</given-names></string-name>, <string-name><surname>Cairns</surname><given-names>P</given-names></string-name></person-group>. <article-title>Signaling pathways in renal cell carcinoma</article-title>. <source>Cancer Biol Ther</source><year>2010</year>;<volume>10</volume>:<fpage>658</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">20814228</pub-id></mixed-citation>
    </ref>
    <ref id="ref32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arabian</surname><given-names>S</given-names></string-name>, <string-name><surname>Boostan</surname><given-names>A</given-names></string-name>, <string-name><surname>Darzi</surname><given-names>S</given-names></string-name></person-group>. <article-title>The role of toll-like receptors (TLRs) and their therapeutic applications in endometrial cancer</article-title>. <source>Clin Transl Oncol</source><year>2023</year>;<volume>25</volume>:<fpage>859</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">36374404</pub-id></mixed-citation>
    </ref>
    <ref id="ref33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Larsson</surname><given-names>SC</given-names></string-name>, <string-name><surname>Lee</surname><given-names>W-H</given-names></string-name>, <string-name><surname>Kar</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Assessing the role of cortisol in cancer: a wide-ranged Mendelian randomisation study</article-title>. <source>Br J Cancer</source><year>2021</year>;<volume>125</volume>:<fpage>1025</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">34316022</pub-id></mixed-citation>
    </ref>
    <ref id="ref34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diehl</surname><given-names>FF</given-names></string-name>, <string-name><surname>Miettinen</surname><given-names>TP</given-names></string-name>, <string-name><surname>Elbashir</surname><given-names>R</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Nucleotide imbalance decouples cell growth from cell proliferation</article-title>. <source>Nat Cell Biol</source><year>2022</year>;<volume>24</volume>:<fpage>1252</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">35927450</pub-id></mixed-citation>
    </ref>
    <ref id="ref35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>X</given-names></string-name>, <string-name><surname>Quinn</surname><given-names>PJ</given-names></string-name>, <string-name><surname>Yan</surname><given-names>A</given-names></string-name></person-group>. <article-title>Kdo2-lipid a: structural diversity and impact on immunopharmacology</article-title>. <source>Biol Rev</source><year>2015</year>;<volume>90</volume>:<fpage>408</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">24838025</pub-id></mixed-citation>
    </ref>
    <ref id="ref36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heyes</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Levy</surname><given-names>C</given-names></string-name>, <string-name><surname>Lafite</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Structure-based mechanism of CMP-2-keto-3-deoxymanno-octulonic acid synthetase</article-title>. <source>J Biol Chem</source><year>2009</year>;<volume>284</volume>:<fpage>35514</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">19815542</pub-id></mixed-citation>
    </ref>
    <ref id="ref37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shin</surname><given-names>J-W</given-names></string-name>, <string-name><surname>Kwon</surname><given-names>S-H</given-names></string-name>, <string-name><surname>Choi</surname><given-names>J-Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Molecular mechanisms of dermal aging and antiaging approaches</article-title>. <source>Int J Mol Sci</source><year>2019</year>;<volume>20</volume>:<fpage>2126</fpage>.<pub-id pub-id-type="pmid">31036793</pub-id></mixed-citation>
    </ref>
    <ref id="ref38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>ST</given-names></string-name>, <string-name><surname>Neo</surname><given-names>BH</given-names></string-name>, <string-name><surname>Betts</surname><given-names>RJ</given-names></string-name></person-group>. <article-title>Glycosaminoglycans: sweet as sugar targets for topical skin anti-aging</article-title>. <source>Clin Cosmet Investig Dermatol</source><year>2021</year>;<volume>14</volume>:<fpage>1227</fpage>–<lpage>46</lpage>.</mixed-citation>
    </ref>
    <ref id="ref39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oh</surname><given-names>J-H</given-names></string-name>, <string-name><surname>Kim</surname><given-names>YK</given-names></string-name>, <string-name><surname>Jung</surname><given-names>J-Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Changes in glycosaminoglycans and related proteoglycans in intrinsically aged human skin in vivo</article-title>. <source>Exp Dermatol</source><year>2011</year>;<volume>20</volume>:<fpage>454</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">21426414</pub-id></mixed-citation>
    </ref>
    <ref id="ref40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chrousos</surname><given-names>GP</given-names></string-name>, <string-name><surname>Torpy</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Gold</surname><given-names>PW</given-names></string-name></person-group>. <article-title>Interactions between the hypothalamic-pituitary-adrenal axis and the female reproductive system: clinical implications</article-title>. <source>Ann Intern Med</source><year>1998</year>;<volume>129</volume>:<fpage>229</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">9696732</pub-id></mixed-citation>
    </ref>
    <ref id="ref41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levitz</surname><given-names>M</given-names></string-name>, <string-name><surname>Kadner</surname><given-names>S</given-names></string-name>, <string-name><surname>Young</surname><given-names>BK</given-names></string-name></person-group>. <article-title>Intermediary metabolism of estriol in pregnancy</article-title>. <source>J Steroid Biochem</source><year>1984</year>;<volume>20</volume>:<fpage>971</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">6727356</pub-id></mixed-citation>
    </ref>
    <ref id="ref42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Makieva</surname><given-names>S</given-names></string-name>, <string-name><surname>Saunders</surname><given-names>PTK</given-names></string-name>, <string-name><surname>Norman</surname><given-names>JE</given-names></string-name></person-group>. <article-title>Androgens in pregnancy: roles in parturition</article-title>. <source>Hum Reprod Update</source><year>2014</year>;<volume>20</volume>:<fpage>542</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">24643344</pub-id></mixed-citation>
    </ref>
    <ref id="ref43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cox</surname><given-names>BD</given-names></string-name>, <string-name><surname>Calame</surname><given-names>DP</given-names></string-name></person-group>. <article-title>Changes in plasma amino acid levels during the human menstrual cycle and in early pregnancy. A preliminary report</article-title>. <source>Horm Metab Res</source><year>1978</year>;<volume>10</volume>:<fpage>428</fpage>–<lpage>33</lpage>.<pub-id pub-id-type="pmid">711138</pub-id></mixed-citation>
    </ref>
    <ref id="ref44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamblin</surname><given-names>R</given-names></string-name>, <string-name><surname>Coulden</surname><given-names>A</given-names></string-name>, <string-name><surname>Fountas</surname><given-names>A</given-names></string-name>, <string-name><surname>Karavitaki</surname><given-names>N</given-names></string-name></person-group>. <article-title>The diagnosis and management of Cushing’s syndrome in pregnancy</article-title>. <source>J Neuroendocrinol</source><year>2022</year>;<volume>34</volume>:<elocation-id>e13118</elocation-id>.<pub-id pub-id-type="pmid">35491087</pub-id></mixed-citation>
    </ref>
    <ref id="ref45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Genin</surname><given-names>AS</given-names></string-name>, <string-name><surname>De Rycke</surname><given-names>Y</given-names></string-name>, <string-name><surname>Stevens</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Association with pregnancy increases the risk of local recurrence but does not impact overall survival in breast cancer: a case-control study of 87 cases</article-title>. <source>Breast (Edinburgh, Scotland)</source><year>2016</year>;<volume>30</volume>:<fpage>222</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">26456897</pub-id></mixed-citation>
    </ref>
    <ref id="ref46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ebrahimpoor</surname><given-names>M</given-names></string-name>, <string-name><surname>Spitali</surname><given-names>P</given-names></string-name>, <string-name><surname>Hettne</surname><given-names>K</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Simultaneous enrichment analysis of all possible gene-sets: unifying self-contained and competitive methods</article-title>. <source>Brief Bioinform</source><year>2020</year>;<volume>21</volume>:<fpage>1302</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">31297505</pub-id></mixed-citation>
    </ref>
    <ref id="ref47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarca</surname><given-names>AL</given-names></string-name>, <string-name><surname>Bhatti</surname><given-names>G</given-names></string-name>, <string-name><surname>Romero</surname><given-names>R</given-names></string-name></person-group>. <article-title>A comparison of gene set analysis methods in terms of sensitivity, prioritization and specificity</article-title>. <source>PLoS One</source><year>2013</year>;<volume>8</volume>:<elocation-id>e79217</elocation-id>.<pub-id pub-id-type="pmid">24260172</pub-id></mixed-citation>
    </ref>
    <ref id="ref48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gao</surname><given-names>P</given-names></string-name>, <string-name><surname>Shen</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Precision environmental health monitoring by longitudinal exposome and multi-omics profiling</article-title>. <source>Genome Res</source><year>2022</year>;<volume>32</volume>:<fpage>1199</fpage>–<lpage>214</lpage>.<pub-id pub-id-type="pmid">35667843</pub-id></mixed-citation>
    </ref>
    <ref id="ref49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname><given-names>C</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Dynamic human environmental exposome revealed by longitudinal personal monitoring</article-title>. <source>Cell</source><year>2018</year>;<volume>175</volume>:<fpage>277</fpage>–<lpage>291.e31</lpage>.<pub-id pub-id-type="pmid">30241608</pub-id></mixed-citation>
    </ref>
    <ref id="ref50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>F</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>L</given-names></string-name>, <string-name><surname>Pan</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Multi-omic profiling reveals that intra-abdominal-hypertension-induced intestinal damage can be prevented by microbiome and metabolic modulations with 5-hydroxyindoleacetic acid as a diagnostic marker</article-title>. <source>mSystems</source><year>2022</year>;<volume>7</volume>:<fpage>e01204</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">35574681</pub-id></mixed-citation>
    </ref>
    <ref id="ref51">
      <label>51.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname><given-names>X</given-names></string-name>, <string-name><surname>Huang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Charting the landscape of the environmental exposome</article-title>. <source>iMeta</source><year>2022</year>;<volume>1</volume>:<fpage>e50</fpage>.<pub-id pub-id-type="pmid">38867899</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10976918</article-id>
    <article-id pub-id-type="pmid">38546324</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbae116</article-id>
    <article-id pub-id-type="publisher-id">bbae116</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Problem Solving Protocol</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Generalized reporter score-based enrichment analysis for omics data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Peng</surname>
          <given-names>Chen</given-names>
        </name>
        <!--pengchen2001@zju.edu.cn-->
        <aff><institution>MOE Key Laboratory of Biosystems Homeostasis &amp; Protection</institution>, and Zhejiang Provincial Key Laboratory of Cancer Molecular Cell Biology, <institution>Life Sciences Institute, Zhejiang University</institution>, <addr-line>Hangzhou, Zhejiang 310030</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>State Key Laboratory for Diagnosis and Treatment of Infectious Diseases</institution>, First Affiliated Hospital, <institution>Zhejiang University School of Medicine</institution>, <addr-line>Hangzhou, Zhejiang 310009</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Qiong</given-names>
        </name>
        <!--qiong_chen@zju.edu.cn-->
        <aff><institution>MOE Key Laboratory of Biosystems Homeostasis &amp; Protection</institution>, and Zhejiang Provincial Key Laboratory of Cancer Molecular Cell Biology, <institution>Life Sciences Institute, Zhejiang University</institution>, <addr-line>Hangzhou, Zhejiang 310030</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>State Key Laboratory for Diagnosis and Treatment of Infectious Diseases</institution>, First Affiliated Hospital, <institution>Zhejiang University School of Medicine</institution>, <addr-line>Hangzhou, Zhejiang 310009</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tan</surname>
          <given-names>Shangjin</given-names>
        </name>
        <!--tanshangjin@genomics.cn-->
        <aff><institution>BGI Research</institution>, <addr-line>Wuhan, Hubei 430074</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>BGI Research</institution>, <addr-line>Shenzhen, Guangdong 518083</addr-line>, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shen</surname>
          <given-names>Xiaotao</given-names>
        </name>
        <!--xiaotaoshen@gmail.com-->
        <aff><institution>Department of Genetics, Stanford University School of Medicine</institution>, <addr-line>Stanford, CA</addr-line>, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0260-7271</contrib-id>
        <name>
          <surname>Jiang</surname>
          <given-names>Chao</given-names>
        </name>
        <!--jiang_chao@zju.edu.cn-->
        <aff><institution>MOE Key Laboratory of Biosystems Homeostasis &amp; Protection</institution>, and Zhejiang Provincial Key Laboratory of Cancer Molecular Cell Biology, <institution>Life Sciences Institute, Zhejiang University</institution>, <addr-line>Hangzhou, Zhejiang 310030</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>State Key Laboratory for Diagnosis and Treatment of Infectious Diseases</institution>, First Affiliated Hospital, <institution>Zhejiang University School of Medicine</institution>, <addr-line>Hangzhou, Zhejiang 310009</addr-line>, <country country="CN">China</country></aff>
        <aff><institution>Center for Life Sciences, Shaoxing Institute, Zhejiang University</institution>, <addr-line>Shaoxing, Zhejiang 321000</addr-line>, <country country="CN">China</country></aff>
        <xref rid="cor1" ref-type="corresp"/>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Corresponding author. Chao Jiang, MOE Key Laboratory of Biosystems Homeostasis &amp; Protection, and Zhejiang Provincial Key Laboratory of Cancer Molecular Cell Biology, Life Sciences Institute, Zhejiang University, Hangzhou, Zhejiang 310030, China. Tel.: +86 0571 88208922; E-mail: <email>jiang_chao@zju.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-03-27">
      <day>27</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>3</month>
      <year>2024</year>
    </pub-date>
    <volume>25</volume>
    <issue>3</issue>
    <elocation-id>bbae116</elocation-id>
    <history>
      <date date-type="received">
        <day>5</day>
        <month>12</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>25</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>3</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bbae116.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Enrichment analysis contextualizes biological features in pathways to facilitate a systematic understanding of high-dimensional data and is widely used in biomedical research. The emerging reporter score-based analysis (RSA) method shows more promising sensitivity, as it relies on <italic toggle="yes">P</italic>-values instead of raw values of features. However, RSA cannot be directly applied to multi-group and longitudinal experimental designs and is often misused due to the lack of a proper tool. Here, we propose the Generalized Reporter Score-based Analysis (GRSA) method for multi-group and longitudinal omics data. A comparison with other popular enrichment analysis methods demonstrated that GRSA had increased sensitivity across multiple benchmark datasets. We applied GRSA to microbiome, transcriptome and metabolome data and discovered new biological insights in omics studies. Finally, we demonstrated the application of GRSA beyond functional enrichment using a taxonomy database. We implemented GRSA in an R package, ReporterScore, integrating with a powerful visualization module and updatable pathway databases, which is available on the Comprehensive R Archive Network (<ext-link xlink:href="https://cran.r-project.org/web/packages/ReporterScore" ext-link-type="uri">https://cran.r-project.org/web/packages/ReporterScore</ext-link>). We believe that the ReporterScore package will be a valuable asset for broad biomedical research fields.</p>
    </abstract>
    <abstract abstract-type="graphical">
      <title>Graphical Abstract</title>
      <p>
        <fig position="float" id="ga1">
          <label>Graphical Abstract</label>
          <graphic xlink:href="bbae116ga1" position="float"/>
        </fig>
      </p>
    </abstract>
    <kwd-group>
      <kwd>reporter score</kwd>
      <kwd>enrichment analysis</kwd>
      <kwd>multi-group</kwd>
      <kwd>omics data</kwd>
      <kwd>customized database</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Nature Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>82173645</award-id>
        <award-id>82341109</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Fundamental Research Funds for the Central Universities</institution>
            <institution-id institution-id-type="DOI">10.13039/501100012226</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2022FZZX03-03-07</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="14"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec3">
    <title>INTRODUCTION</title>
    <p>Functional enrichment analysis is a popular bioinformatic method that helps understand the biological significance of large omics datasets, such as transcriptomic, metagenomic, and metabolic data. We gain insights into the underlying biological processes and functions by identifying enriched functional categories, such as gene ontology terms or biological pathways, and formulate hypotheses for downstream experimental investigations [<xref rid="ref1" ref-type="bibr">1</xref>].</p>
    <p>Methods for functional enrichment analysis can be roughly divided into three categories based on underlying statistical methods: (i) overrepresentation analysis (ORA), (ii) functional class scoring (FCS) and (iii) pathway topology-based (PT) [<xref rid="ref2" ref-type="bibr">2</xref>]. Common enrichment analysis methods in omics research are shown in <xref rid="TB1" ref-type="table">Table 1</xref>. In addition, Goeman and Bühlmann classified enrichment analysis methods based on the underlying null hypothesis as ‘competitive’ or ‘self-contained’. In ‘competitive’ methods, a gene set is compared against the background of all genes not in the set to assess if the level of statistical differences exceeds the background level, whereas a ‘self-contained’ method analyzes each gene set in isolation [<xref rid="ref11" ref-type="bibr">11</xref>].</p>
    <table-wrap position="float" id="TB1">
      <label>Table 1</label>
      <caption>
        <p>Some commonly used enrichment analysis methods</p>
      </caption>
      <table frame="hsides" rules="groups">
        <colgroup span="1">
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
          <col align="left" span="1"/>
        </colgroup>
        <thead>
          <tr>
            <th align="left" rowspan="1" colspan="1">Category</th>
            <th align="left" rowspan="1" colspan="1">Method</th>
            <th align="left" rowspan="1" colspan="1">Tools</th>
            <th align="left" rowspan="1" colspan="1">Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" rowspan="1" colspan="1">ORA</td>
            <td align="left" rowspan="1" colspan="1">Hypergeometric test/Fisher’s exact test</td>
            <td align="left" rowspan="1" colspan="1">DAVID (website) [<xref rid="ref3" ref-type="bibr">3</xref>], clusterProfiler (R package) [<xref rid="ref4" ref-type="bibr">4</xref>]</td>
            <td align="left" rowspan="1" colspan="1">The most common methods used in enrichment analysis. Selecting a list of genes is required</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Gene set enrichment analysis (GSEA)</td>
            <td align="left" rowspan="1" colspan="1">GSEA (website) [<xref rid="ref5" ref-type="bibr">5</xref>]</td>
            <td align="left" rowspan="1" colspan="1">GSEA creatively uses gene ranking, rather than selecting a list of genes, to identify statistically significant and concordant differences across gene sets</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Generalized reporter score-based analysis (GRSA/RSA)</td>
            <td align="left" rowspan="1" colspan="1">ReporterScore (R package developed in this study)</td>
            <td align="left" rowspan="1" colspan="1">Find significant metabolites (first report), pathways and taxonomy based on the <italic toggle="yes">P</italic>-values for multi-omics data</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Significance Analysis of Function and Expression (SAFE)</td>
            <td align="left" rowspan="1" colspan="1">SAFE (R package) [<xref rid="ref6" ref-type="bibr">6</xref>]</td>
            <td align="left" rowspan="1" colspan="1">SAFE assesses the significance of gene categories by calculating both local and global statistics from gene expression data</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Gene Set Analysis (GSA)</td>
            <td align="left" rowspan="1" colspan="1">GSA (R Package) [<xref rid="ref7" ref-type="bibr">7</xref>]</td>
            <td align="left" rowspan="1" colspan="1">GSA was proposed as an improvement of GSEA, using the ‘maxmean’ statistic instead of the weighted sign KS statistic</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Pathway Analysis with Down-weighting of Overlapping Genes (PADOG)</td>
            <td align="left" rowspan="1" colspan="1">PADOG (R package) [<xref rid="ref8" ref-type="bibr">8</xref>]</td>
            <td align="left" rowspan="1" colspan="1">PADOG assumes that genes associated with fewer pathways have more significant effects than genes associated with more pathways</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">FCS</td>
            <td align="left" rowspan="1" colspan="1">Gene Set Variation Analysis (GSVA)</td>
            <td align="left" rowspan="1" colspan="1">GSVA (R package) [<xref rid="ref9" ref-type="bibr">9</xref>]</td>
            <td align="left" rowspan="1" colspan="1">A non-parametric, unsupervised method that transforms gene expression data into gene set scores for downstream differential pathway activity analysis</td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">PT</td>
            <td align="left" rowspan="1" colspan="1">Topology-based pathway enrichment analysis (TPEA)</td>
            <td align="left" rowspan="1" colspan="1">TPEA (R package) [<xref rid="ref10" ref-type="bibr">10</xref>]</td>
            <td align="left" rowspan="1" colspan="1">Integrate topological properties and global upstream/downstream positions of genes in pathways</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>The algorithm of reporter score-based analysis (RSA) was originally developed by Patil and Nielsen in 2005 to identify metabolites associated with the metabolic network’s regulatory hotspots [<xref rid="ref12" ref-type="bibr">12</xref>]. The RSA has recently gained popularity due to its extended application in functional enrichment analysis in microbiome research [<xref rid="ref13" ref-type="bibr">13</xref>]. RSA is a competitive FCS method based on parsing the <italic toggle="yes">P</italic>-values of selected statistical analyses without a priori cut-off (threshold-free). The rationale is that the <italic toggle="yes">P</italic>-value can be considered a standardized statistic reflecting the differences between different genes or features, regardless of the mean expression values. The pathways with significantly lower <italic toggle="yes">P</italic>-values than the background <italic toggle="yes">P</italic>-value distribution are enriched [<xref rid="ref12" ref-type="bibr">12</xref>].</p>
    <p>However, RSA is often misused due to a lack of specific tools and a systematic understanding of the algorithm [<xref rid="ref14" ref-type="bibr">14</xref>]. In addition, the sign (plus or minus) of the reporter score of each pathway in classic RSA does not represent the increasing or decreasing trend of the pathway expression; rather, reporter scores (including negative value) less than a specified threshold indicate that the corresponding pathway is not significantly enriched. This often leads to misinterpretations of the results.</p>
    <p>Inspired by the classic RSA, we developed the improved Generalized Reporter Score-based Analysis (GRSA) method, implemented in the R package ReporterScore, along with comprehensive visualization methods and pathway databases. GRSA is a threshold-free method that works well with all types of biomedical features, such as genes, chemical compounds and microbial species. GRSA works in the mixed (classic RSA) and directed modes (enhanced RSA). The directed mode uses signs of the reporter score to distinguish up-regulated or down-regulated pathways, which is more intuitive. Importantly, the GRSA supports multi-group and longitudinal experimental designs because of the included multi-group-compatible statistical methods (for a full list of supported methods, please see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). The ReporterScore package also supports custom hierarchical and relational databases (e.g. tables containing the correspondence between pathways and genes), providing extra flexibility for advanced users. In this study, we described the comprehensive utility of GRSA. We benchmarked GRSA against other popular enrichment methods across multiple datasets and demonstrated the applications of GRSA on diverse omics datasets.</p>
  </sec>
  <sec id="sec4">
    <title>MATERIALS AND METHODS</title>
    <sec id="sec5">
      <title>Algorithm</title>
      <p>The algorithm of GRSA is described as follows, using metagenomic data as an example.</p>
      <sec id="sec5a">
        <title>(1) Calculating the <italic toggle="yes">P</italic>-values</title>
        <p>A statistical method (the full list of supported statistical methods is in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>) was used to obtain the <italic toggle="yes">P</italic>-values of the features (i.e. <inline-formula><tex-math notation="LaTeX" id="ineq01">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${p}_{K{O}_i}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ineq02">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> represents a certain KO; <xref rid="f1" ref-type="fig">Figure 1A</xref>). We used KO to represent different features in the formulas for simplicity.</p>
        <fig position="float" id="f1">
          <label>Figure 1</label>
          <caption>
            <p>The overall workflow of GRSA in the ReporterScore package. (<bold>A</bold>) GRSA workflow consists of four parts: Calculate the <italic toggle="yes">P</italic>-values for KOs between two or multiple groups by various statistical methods; convert the <italic toggle="yes">P</italic>-values of KOs to <italic toggle="yes">Z</italic>-scores by inverse normal distribution and assignment of a plus or minus sign to each <italic toggle="yes">Z</italic>-score in the directed mode; mapping KOs to annotated pathways and calculating the reporter score for each pathway; visualize the results of GRSA. <inline-formula><tex-math notation="LaTeX" id="ineq03">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> represents a certain KO; <inline-formula><tex-math notation="LaTeX" id="ineq04">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${p}_{K{O}_i}$\end{document}</tex-math></inline-formula> is the <italic toggle="yes">P</italic>-value of <inline-formula><tex-math notation="LaTeX" id="ineq05">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ineq06">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_i}$\end{document}</tex-math></inline-formula> is the <italic toggle="yes">Z</italic>-score transformed from <inline-formula><tex-math notation="LaTeX" id="ineq07">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${p}_{K{O}_i}$\end{document}</tex-math></inline-formula>; <inline-formula><tex-math notation="LaTeX" id="ineq08">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varDelta K{O}_i$\end{document}</tex-math></inline-formula> is the abundance difference of between groups. A total of <inline-formula><tex-math notation="LaTeX" id="ineq09">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula> KOs were annotated to the corresponding pathway. <inline-formula><tex-math notation="LaTeX" id="ineq10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\mu}_{k_j}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ineq11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\sigma}_{k_j}$\end{document}</tex-math></inline-formula> are the mean and the standard deviation of the background <italic toggle="yes">Z</italic>-score distribution <inline-formula><tex-math notation="LaTeX" id="ineq12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ null}$\end{document}</tex-math></inline-formula>, respectively. The ReporterScore package provides various visualization methods for the GRSA result. (<bold>B</bold>) The bar chart shows reporter scores of pathways in the mixed mode. The red color indicates significantly enriched pathways, with reporter scores greater than 1.64, corresponding to a <italic toggle="yes">P</italic>-value of 0.05. (<bold>C</bold>) The bar chart shows reporter scores of pathways in the directed mode. The orange and green colors indicate up-regulated and down-regulated pathways with absolute reporter scores &gt;1.64. (<bold>D</bold> and <bold>E</bold>) The line charts show the pattern of a selected pathway in the directed mode with a multi-group (<bold>D</bold>) and a longitudinal design (<bold>E</bold>), each line represents the trend of the average abundance of one KO. Line colors indicate whether the KO is significantly enriched (orange), depleted (green) or neither (gray). (<bold>F</bold>) The network plot shows the KOs present in selected pathways; some KOs can be shared by several pathways. Big dots represent pathways, and small dots represent KOs. The colors of small dots represent the trend of KOs. The colors of the shades encircling pathways denote whether the pathway is overall up-regulated (orange) or down-regulated (green). (<bold>G</bold>) The heatmap displays the abundance of each KO in a pathway for different samples (columns). (<bold>H</bold>) The circular packing plot shows the hierarchical relationship of selected pathways; the size of the circle indicates the absolute value of the reporter score, and the color of the circle indicates that the pathway is overall up-regulated (orange) and down-regulated (green).</p>
          </caption>
          <graphic xlink:href="bbae116f1" position="float"/>
        </fig>
      </sec>
      <sec id="sec5b">
        <title>(2) Converting the <italic toggle="yes">P</italic>-values into <italic toggle="yes">Z</italic>-scores</title>
        <p>For the classic mixed RSA, we used an inverse normal cumulative distribution function (<inline-formula><tex-math notation="LaTeX" id="ineq13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\theta}^{-1}$\end{document}</tex-math></inline-formula>) to convert the <italic toggle="yes">P</italic>-values of KOs into <italic toggle="yes">Z</italic>-scores. Thus, assuming uniformly distributed <italic toggle="yes">P</italic>-values under the random data assumption ranges, the resulting <italic toggle="yes">Z</italic>-scores will follow a standard normal distribution (<xref rid="f1" ref-type="fig">Figure 1A</xref>), and the formula is</p>
        <disp-formula id="deqn01">
          <label>(1)</label>
          <tex-math notation="LaTeX" id="DmEquation1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} {Z}_{K{O}_i}={\theta}^{-1}\left(1-{p}_{K{O}_i}\right) \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>For the new directed RSA, we first divided the <italic toggle="yes">P</italic>-values by 2, transforming the range of <italic toggle="yes">P</italic>-values from <inline-formula><tex-math notation="LaTeX" id="ineq14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\left(0,1\right]$\end{document}</tex-math></inline-formula> to <inline-formula><tex-math notation="LaTeX" id="ineq15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\left(0,0.5\right]$\end{document}</tex-math></inline-formula> :</p>
        <disp-formula id="deqn02">
          <label>(2)</label>
          <tex-math notation="LaTeX" id="DmEquation2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} {p}_{K{O}_i}={p}_{K{O}_i}/2\kern2.00em \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>Secondly, we used an inverse normal cumulative distribution function to convert the <italic toggle="yes">P</italic>-values of KOs into <italic toggle="yes">Z</italic>-scores (equation (<xref rid="deqn01" ref-type="disp-formula">1</xref>)). When the <italic toggle="yes">P</italic>-value is 0.5, the converted <italic toggle="yes">Z</italic>-score equals 0. Since the above <italic toggle="yes">P</italic>-values are no greater than 0.5, all converted <italic toggle="yes">Z</italic>-scores will be &gt;0 (<xref rid="f1" ref-type="fig">Figure 1A</xref>).</p>
        <p>We then determined if a KO is up-regulated or down-regulated and calculated the <inline-formula><tex-math notation="LaTeX" id="ineq16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\varDelta K{O}_i$\end{document}</tex-math></inline-formula>.</p>
        <p>In a differential abundance analysis (two-group design):</p>
        <disp-formula id="deqn03">
          <label>(3)</label>
          <tex-math notation="LaTeX" id="DmEquation3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \varDelta K{O}_i=\overline{K{O}_{i_{g1}}}-\overline{K{O}_{i_{g2}}} \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p><inline-formula><tex-math notation="LaTeX" id="ineq17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\overline{K{O}_{i_{g1}}}$\end{document}</tex-math></inline-formula> is the average abundance of <inline-formula><tex-math notation="LaTeX" id="ineq18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> in group 1, and <inline-formula><tex-math notation="LaTeX" id="ineq19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$\overline{K{O}_{i_{g2}}}$\end{document}</tex-math></inline-formula> is the average abundance of <inline-formula><tex-math notation="LaTeX" id="ineq20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> in group 2.</p>
        <p>In a correlation analysis (two-group, multi-group and longitudinal design):</p>
        <disp-formula id="deqn04">
          <label>(4)</label>
          <tex-math notation="LaTeX" id="DmEquation4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \varDelta K{O}_i={\rho}_{K{O}_i} \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p><inline-formula><tex-math notation="LaTeX" id="ineq21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\rho}_{K{O}_i}$\end{document}</tex-math></inline-formula> is the correlation coefficient between <inline-formula><tex-math notation="LaTeX" id="ineq22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> and the numeric variable.</p>
        <p>Finally, assign a plus or minus sign to each <italic toggle="yes">Z</italic>-score:</p>
        <disp-formula id="deqn05">
          <label>(5)</label>
          <tex-math notation="LaTeX" id="DmEquation5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} {Z}_{K{O}_i}=\left\{\begin{array}{@{}cc}-{Z}_{K{O}_i},&amp; \left(\varDelta K{O}_i&lt;0\right)\\{}+{Z}_{K{O}_i},&amp; \left(\varDelta K{O}_i\ge 0\right)\end{array}\right. \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>Therefore, a <inline-formula><tex-math notation="LaTeX" id="ineq23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> with a <inline-formula><tex-math notation="LaTeX" id="ineq24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_i}$\end{document}</tex-math></inline-formula> &gt;0 is up-regulated and a <inline-formula><tex-math notation="LaTeX" id="ineq25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> with a <inline-formula><tex-math notation="LaTeX" id="ineq26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_i}$\end{document}</tex-math></inline-formula> &lt;0 is down-regulated.</p>
      </sec>
      <sec id="sec5c">
        <title>(3) Scoring the pathway</title>
        <p>We next used the <italic toggle="yes">Z</italic>-scores of KOs to score the pathway. First, choose a pathway database as the reference. It is of particular interest to note any hierarchy relational table (e.g. KEGG, taxonomy database) can be used as a reference as long as the relationship between the upstream and downstream features (e.g. pathways and KOs) can be represented by a bipartite network (<xref rid="f1" ref-type="fig">Figure 1A</xref>). For each pathway in the selected database, calculate the <italic toggle="yes">Z</italic>-score of pathway <italic toggle="yes">j</italic> (<inline-formula><tex-math notation="LaTeX" id="ineq27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula>) as follows:</p>
        <disp-formula id="deqn06">
          <label>(6)</label>
          <tex-math notation="LaTeX" id="DmEquation6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} {Z}_{pat{h}_j}=\frac{1}{\sqrt{k_j}}\sum_{i=1}^{k_j}{Z}_{K{O}_i} \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ineq28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_i}$\end{document}</tex-math></inline-formula> is the <italic toggle="yes">Z</italic>-score of <inline-formula><tex-math notation="LaTeX" id="ineq29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$K{O}_i$\end{document}</tex-math></inline-formula> within <inline-formula><tex-math notation="LaTeX" id="ineq30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$pat{h}_j$\end{document}</tex-math></inline-formula>, and <inline-formula><tex-math notation="LaTeX" id="ineq31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula> denotes the total number of KOs in <inline-formula><tex-math notation="LaTeX" id="ineq32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$pat{h}_j$\end{document}</tex-math></inline-formula>.</p>
        <p>Next, we corrected <inline-formula><tex-math notation="LaTeX" id="ineq33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula> using the randomly sampled <inline-formula><tex-math notation="LaTeX" id="ineq34">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula> from the background distribution of the <italic toggle="yes">Z</italic>-scores of all KOs (<inline-formula><tex-math notation="LaTeX" id="ineq35">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_{all}}=\big\{{Z}_{K{O}_1},{Z}_{K{O}_2},\dots, {Z}_{K{O}_j}\big\}$\end{document}</tex-math></inline-formula>) to evaluate the significance of enrichment. Specifically, for a given pathway <inline-formula><tex-math notation="LaTeX" id="ineq36">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$pat{h}_j$\end{document}</tex-math></inline-formula> including <inline-formula><tex-math notation="LaTeX" id="ineq37">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula> KOs, we randomly sampled the same number (<inline-formula><tex-math notation="LaTeX" id="ineq38">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j$\end{document}</tex-math></inline-formula>) of KOs from the background <inline-formula><tex-math notation="LaTeX" id="ineq39">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{K{O}_{all}}$\end{document}</tex-math></inline-formula> without replacement, and calculated the <inline-formula><tex-math notation="LaTeX" id="ineq40">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula>, for <italic toggle="yes">N</italic> times (<italic toggle="yes">N</italic> = 10 000 in this study [<xref rid="ref15" ref-type="bibr">15</xref>]). We then standardized <inline-formula><tex-math notation="LaTeX" id="ineq41">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula> by subtracting the mean (<inline-formula><tex-math notation="LaTeX" id="ineq42">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\mu}_{k_j}$\end{document}</tex-math></inline-formula>) and dividing by the standard deviation (<inline-formula><tex-math notation="LaTeX" id="ineq43">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\sigma}_{k_j}$\end{document}</tex-math></inline-formula>) of the <inline-formula><tex-math notation="LaTeX" id="ineq44">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula> distribution. The standardized <inline-formula><tex-math notation="LaTeX" id="ineq45">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula> is the <inline-formula><tex-math notation="LaTeX" id="ineq46">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$ReporterScor{e}_j$\end{document}</tex-math></inline-formula>. The <italic toggle="yes">P</italic>-value of <inline-formula><tex-math notation="LaTeX" id="ineq47">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$ReporterScor{e}_j$\end{document}</tex-math></inline-formula> is also estimated by the above permutation. The formulas for the reporter scores and associated <italic toggle="yes">P</italic>-values are</p>
        <disp-formula id="deqn07">
          <label>(7)</label>
          <tex-math notation="LaTeX" id="DmEquation7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} ReporterScor{e}_j=\frac{Z_{pat{h}_j}-{\mu}_{k_j}}{\sigma_{k_j}} \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <disp-formula id="deqn08">
          <label>(8)</label>
          <tex-math notation="LaTeX" id="DmEquation8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} p\_ valu{e}_j=\frac{\sum_{n=1}^NI\left({Z}_{pat{h}_j},{Z}_{pat h\_ nul{l}_{jn}}\right)+1}{N+1}\kern1em \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>where <inline-formula><tex-math notation="LaTeX" id="ineq48">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula> have the same <inline-formula><tex-math notation="LaTeX" id="ineq49">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$k$\end{document}</tex-math></inline-formula> to <inline-formula><tex-math notation="LaTeX" id="ineq50">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula>, <inline-formula><tex-math notation="LaTeX" id="ineq51">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\mu}_{k_j}$\end{document}</tex-math></inline-formula> is the mean of the randomly generated <italic toggle="yes">N</italic><inline-formula><tex-math notation="LaTeX" id="ineq52">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula> and <inline-formula><tex-math notation="LaTeX" id="ineq53">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${\sigma}_{k_j}$\end{document}</tex-math></inline-formula> is the standard deviation of the randomly generated <italic toggle="yes">N</italic><inline-formula><tex-math notation="LaTeX" id="ineq54">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{path\_ nul{l}_j}$\end{document}</tex-math></inline-formula>.</p>
        <p>For the classic mixed RSA:</p>
        <disp-formula id="deqn09">
          <label>(9)</label>
          <tex-math notation="LaTeX" id="DmEquation9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} I\left(a,b\right)=\left\{\begin{array}{@{}cc}1&amp; \left(a\ge b\right)\\{}0&amp; \left(a&lt;b\right)\end{array}\right. \end{equation*}\end{document}</tex-math>
        </disp-formula>
        <p>For the new directed RSA:</p>
        <disp-formula id="deqn10">
          <label>(10)</label>
          <tex-math notation="LaTeX" id="DmEquation10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} I\left(a,b\right)=\left\{\begin{array}{@{}cc}1&amp; \left( ReporterScor{e}_j\ge 0\&amp;a\ge b\right)\\{}1&amp; \left( ReporterScor{e}_j&lt;0\&amp;a\le b\right)\\{}0&amp; \left(\mathrm{Otherwise}\right)\end{array}\right. \end{equation*}\end{document}</tex-math>
        </disp-formula>
      </sec>
    </sec>
    <sec id="sec6">
      <title>Statistical analyses</title>
      <p>All statistical analyses were done on the R 4.2.2 platform. The developed ReporterScore package (<ext-link xlink:href="https://cran.r-project.org/web/packages/ReporterScore/" ext-link-type="uri">https://cran.r-project.org/web/packages/ReporterScore/</ext-link>) was used for GRSA and visualization. The Venn diagram and Venn network diagram were drawn by the pcutils package (<ext-link xlink:href="https://cran.r-project.org/web/packages/pcutils/" ext-link-type="uri">https://cran.r-project.org/web/packages/pcutils/</ext-link>). We collected several datasets for benchmarking and three different type omics datasets as case study [<xref rid="ref16" ref-type="bibr">16–18</xref>]. Details of these datasets can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Notes</xref>.</p>
      <p>To compare the performance of different statistical methods in the two-group experimental design, we defined a Jaccard similarity index:</p>
      <disp-formula id="deqn11">
        <label>(11)</label>
        <tex-math notation="LaTeX" id="DmEquation11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \mathrm{Similarity}=\frac{\left| method(i)\cap method(j)\right|}{\left| method(i)\cup method(j)\right|}\kern2.00em \end{equation*}\end{document}</tex-math>
      </disp-formula>
      <p>where <italic toggle="yes">method</italic>(<italic toggle="yes">i</italic>) (<italic toggle="yes">method</italic>(<italic toggle="yes">j</italic>)) is the number of significant pathways based on benchmark data sets enriched by different methods.</p>
      <p>We used fuzzy c-means (FCM) clustering to explore the performance of different statistical test methods in multi-group experimental design (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2B,C</xref>) and gene expression patterns in transcriptome (<xref rid="f4" ref-type="fig">Figure 4A</xref>). FCM is an unsupervised machine-learning technique that partitions a population into groups or clusters [<xref rid="ref19" ref-type="bibr">19</xref>]. Three methods (Elbow, Silhouette and Gap statistic) were used to determine the optimal number of clusters. In FCM, the membership score is the probability that a feature belongs to a cluster. Each feature is assigned to a cluster based on its highest membership score.</p>
    </sec>
    <sec id="sec7">
      <title>Comparison with other enrichment analysis methods</title>
      <p>We compared GRSA against six commonly used enrichment analysis methods (<xref rid="TB1" ref-type="table">Table 1</xref>) using 50 benchmark datasets (41 human gene expression datasets related to disease and 9 wild-type/knockout mice gene expression datasets).</p>
      <p>We first calculated the <italic toggle="yes">P</italic>-values of features by <italic toggle="yes">t</italic>-test and performed adjustment of the <italic toggle="yes">P</italic>-values using the Benjamini and Hochberg (BH) method to control for false discovery rate. In order to perform the overrepresentation analysis, we selected the genes that have <italic toggle="yes">P</italic>-values &lt;0.05. The top 400 genes with the highest unsigned log-fold changes were considered as differentially expressed genes (DEGs) [<xref rid="ref20" ref-type="bibr">20</xref>]. Improved fisher.test (CP) was performed by enricher function in the clusterProfiler package with the DEGs list. Gene set enrichment analysis (GSEA) was performed by the GSEA function in the clusterProfiler package, and the <italic toggle="yes">t</italic>-test statistic was used as the metric for ranking [<xref rid="ref21" ref-type="bibr">21</xref>]. The R packages safe, GSVA, GSA and PADOG were used to run the respective methods. GRSA and RSA were performed with the BH-adjusted <italic toggle="yes">P</italic>-values of features by the ReporterScore package in the directed and mixed mode, respectively. A number of 1000 permutations were used in all methods relying on sample or gene permutations.</p>
      <p>Each human gene expression dataset in <xref rid="sup1" ref-type="supplementary-material">Supplementary</xref><xref rid="sup1" ref-type="supplementary-material">Table S2</xref> was associated with a disease with the defined mechanism in a KEGG pathway (termed the target pathway). Ideally, a good enrichment analysis method would rank the target pathway at or near the top of the list with a small adjusted <italic toggle="yes">P</italic>-value. Our human gene expression datasets were sourced from a list provided by Nguyen et al. [<xref rid="ref22" ref-type="bibr">22</xref>]. Based on statistical and biological considerations, we selected datasets in which the number of samples was consistent between the control and treatment groups (&lt;2× difference in sample size is allowed). Furthermore, there should be a measurable overall statistical difference between the gene expressions of the two groups (Adonis <italic toggle="yes">P</italic>-value &lt;0.05). The final 24 benchmark datasets are related to 10 human diseases, and each disease is associated with 2–4 datasets. For further benchmarking analysis, we also included 32 datasets provided by the ‘GSEABenchmarkeR’ package [<xref rid="ref23" ref-type="bibr">23</xref>].</p>
      <p>For wild-type/knockout mice gene expression datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>), we searched the GEO database for mouse single-gene knockout experiments. We selected datasets where more than three pathways were impacted, as this provides a robust basic for benchmarking various methods. We considered the pathways containing the knockout gene as true positives and the pathways without the knockout gene as true negatives [<xref rid="ref22" ref-type="bibr">22</xref>]. An adjusted <italic toggle="yes">P</italic>-value threshold of 0.05 was used to determine if a pathway is significantly affected. Based on the definitions of true positives (TP), true negatives (TN), false positives (FP) and false negatives (FN), we can calculate the sensitivity and specificity as follows:</p>
      <disp-formula id="deqn12">
        <label>(12)</label>
        <tex-math notation="LaTeX" id="DmEquation12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \mathrm{Sensitivity}=\frac{TP}{TP+ FN}\kern1em \end{equation*}\end{document}</tex-math>
      </disp-formula>
      <disp-formula id="deqn13">
        <label>(13)</label>
        <tex-math notation="LaTeX" id="DmEquation13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
\begin{equation*} \mathrm{Specificity}=\frac{TN}{TN+ FP}\kern1em \end{equation*}\end{document}</tex-math>
      </disp-formula>
    </sec>
  </sec>
  <sec id="sec8">
    <title>RESULTS</title>
    <sec id="sec9">
      <title>Workflow overview</title>
      <p>The ReporterScore package has built-in KEGG pathway, module, gene, compound and GO databases and also allows customized databases, making it compatible with feature abundance tables from diverse omics data. A complete gene abundance table can be used for transcriptomic, scRNA-seq and related gene-based omics data of a specific species. For metagenomic and metatranscriptomic data, which involve many different species, a KO abundance table can be used, generated using Blast, Diamond or KEGG official mapper software [<xref rid="ref24" ref-type="bibr">24</xref>] to align the reads or contigs to the KEGG [<xref rid="ref25" ref-type="bibr">25</xref>] or the EggNOG database [<xref rid="ref26" ref-type="bibr">26</xref>]. An annotated compound abundance table can be used for metabolomic data, but the standardization of compound IDs (e.g. convert compound IDs to KEGG IDs) is required.</p>
      <p>The workflow of GRSA in the ReporterScore package is shown in <xref rid="f1" ref-type="fig">Figure 1</xref>, using metagenomic data as an example. The KO abundance table (rows are KOs and columns are samples) and metadata table (rows are samples and columns are experimental design groups) were used as the input for GRSA. Importantly, the input data should not be prefiltered to retain the background information. First, the <italic toggle="yes">P</italic>-values for all KOs were calculated by a proper statistical method. Then, in the classic mode, the <italic toggle="yes">P</italic>-values were directly converted to <italic toggle="yes">Z</italic>-scores (<xref rid="f1" ref-type="fig">Figure 1A</xref>, equation [i]). In the directed mode, the <italic toggle="yes">P</italic>-values were divided by 2, converted to <italic toggle="yes">Z</italic>-scores, and assigned plus or minus signs, denoting up- and down-regulated KOs (<xref rid="f1" ref-type="fig">Figure 1A</xref>, equations [ii–iv]). Next, the <italic toggle="yes">Z</italic>-score of pathway <inline-formula><tex-math notation="LaTeX" id="ineq55">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j$\end{document}</tex-math></inline-formula> (<inline-formula><tex-math notation="LaTeX" id="ineq56">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula>) was calculated by summing the <italic toggle="yes">Z</italic>-scores of KOs within pathway <inline-formula><tex-math notation="LaTeX" id="ineq57">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j$\end{document}</tex-math></inline-formula> and dividing by the square root of the number of KOs (<inline-formula><tex-math notation="LaTeX" id="ineq58">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula>) in pathway <inline-formula><tex-math notation="LaTeX" id="ineq59">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$j$\end{document}</tex-math></inline-formula> (Figure 1A, equation [v]). The <inline-formula><tex-math notation="LaTeX" id="ineq60">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${Z}_{pat{h}_j}$\end{document}</tex-math></inline-formula> is further standardized by the background pathway <italic toggle="yes">Z</italic>-score distribution, generated by randomly sampling <inline-formula><tex-math notation="LaTeX" id="ineq61">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
${k}_j$\end{document}</tex-math></inline-formula> KOs from the total KO pool (<xref rid="f1" ref-type="fig">Figure 1A</xref>, equation [vi]). The standardized pathway <italic toggle="yes">Z</italic>-score is defined as the reporter score of a pathway (<inline-formula><tex-math notation="LaTeX" id="ineq62">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
$ReporterScor{e}_j$\end{document}</tex-math></inline-formula>).</p>
      <p>We designed the ReporterScore package to be user-friendly. In one step, the function reporter_score calculates the reporter scores for a feature abundance table with associated metadata. The included assorted visualization methods can be used to explore the entire pathways and features within pathways (<xref rid="f1" ref-type="fig">Figure 1B–H</xref>). The demo code is included in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Notes</xref>.</p>
    </sec>
    <sec id="sec10">
      <title>Applying GRSA to multi-group and longitudinal omics data</title>
      <p>An important feature of GRSA is the newly developed directed mode. The key difference between the directed mode and the mixed mode (classic RSA) is that in the directed mode, the reporter score’s plus or minus sign indicates the pathway’s increasing or decreasing trend (<xref rid="f1" ref-type="fig">Figure 1C</xref>). However, in the mixed mode, the signs of the reporter score do not indicate the trends of the pathways. We performed GRSA on the public ex_KO_profile dataset (a metagenomic dataset) in two modes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1A</xref>). For pathways enriched in the directed mode, most KOs within the pathway shared the same trend. The pathway with consistently increasing (decreasing) KOs would acquire a significantly bigger (smaller) aggregated <italic toggle="yes">Z</italic>-score than the background (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref>, blue and red boxes). If KOs within a pathway had opposing trends, the signed <italic toggle="yes">Z</italic>-scores would cancel each other, leading to insignificant results (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref>, orange box). In comparison, in the mixed mode, the increasing and decreasing trend of the enriched pathway cannot be determined (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1C</xref>). Therefore, the directed mode helps find pathways with consistently changing KOs. Several previous studies aimed for the result of the directed mode but mistakenly employed classic RSA (mixed mode) [<xref rid="ref14" ref-type="bibr">14</xref>].</p>
      <p>Another major advantage of GRSA is the full support of multi-group and longitudinal omics data. The ReporterScore package calculates the <italic toggle="yes">P</italic>-value for each feature between groups using differential abundance analysis or correlation analysis. The Kruskal–Wallis test or ANOVA assesses if the feature abundance varies significantly across multiple groups. The default correlation analysis treats group assignments as ordinal (e.g. groups ‘G1’, ‘G2’ and ‘G3’ will be converted to 1, 2 and 3), so the correlation analysis could evaluate if the feature abundance linearly increases or decreases. Moreover, the ReporterScore package also supports any specified patterns. For example, groups ‘G1’, ‘G2’ and ‘G3’ can be set as 1, 10, and 100 if an exponentially increasing trend is expected. To explore potential patterns within the data, clustering methods, such as C-means clustering, can be used.</p>
      <p>As a general rule, the users must ensure the selected statistical methods are applicable to the datasets and experimental designs. We applied GRSA with different statistical methods on multiple benchmark datasets. For the classic two-group design, the Jaccard similarity exceeded 0.84 for parametric methods and 0.78 for non-parametric methods, but the Jaccard similarity between parametric and non-parametric methods was lower than 0.63 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2A</xref>). The differences mainly stemmed from parametric versus non-parametric methods. For the multi-group data, users can choose the differential abundance analyses if they aim to enrich significantly altered pathways across groups. Correlation analysis is the preferred choice if the goal is to enrich pathways that show consistent increasing or decreasing patterns (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2B,C</xref>). Lastly, GRSA also supports other statistical tests, such as ‘DESeq2’, ‘Edger’, ‘Limma’, ‘ALDEX’ and ‘ANCOM’ [<xref rid="ref27" ref-type="bibr">27</xref>], to calculate the reporter scores. The demo code is shown in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Notes</xref>.</p>
      <fig position="float" id="f2">
        <label>Figure 2</label>
        <caption>
          <p>Comparisons of GRSA and other commonly used methods of enrichment analyses. (<bold>A</bold>–<bold>B</bold>) The box charts show the ranks (<bold>A</bold>) and adjusted <italic toggle="yes">P</italic>-values (<bold>B</bold>) of target pathways derived by four methods on 24 gene expression datasets. Numbers represent the median values for each method. (<bold>C</bold>–<bold>D</bold>) The box charts show the sensitivity (<bold>C</bold>) and specificity (<bold>D</bold>) of four methods on nine wild-type/knockout gene expression datasets. Numbers represent the median values for each method. CP: improved Fisher’s exact test used by the clusterProfiler package; GSEA: gene set enrichment analysis; SAFE: significance analysis of function and expression; GSA: gene set analysis in the GSA package; PADOG: pathway analysis with down-weighting of overlapping genes; GSVA: gene set variation analysis; RSA: classic reporter score-based analysis; GRSA: generalized reporter score-based analysis.</p>
        </caption>
        <graphic xlink:href="bbae116f2" position="float"/>
      </fig>
    </sec>
    <sec id="sec11">
      <title>GRSA showed higher sensitivity than other commonly used enrichment analysis methods</title>
      <p>Next, we evaluated the performance of GRSA and compared it with other commonly used enrichment analysis methods (<xref rid="TB1" ref-type="table">Table 1</xref>) on several benchmark datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables 2</xref>, <xref rid="sup1" ref-type="supplementary-material">3</xref> and the GEO list from ‘GSEABenchmarkeR’ package). PT-based methods may better identify biologically meaningful pathways than non-PT-based methods in certain scenarios [<xref rid="ref22" ref-type="bibr">22</xref>]. However, PT-based methods require comprehensive topological structures of pathways, limiting their applications in other non-human organisms [<xref rid="ref28" ref-type="bibr">28</xref>]. Therefore, we focused on the comparison against non-PT enrichment analysis methods. Nguyen et al. proposed several approaches to compare enrichment methods [<xref rid="ref22" ref-type="bibr">22</xref>], and we adapted their methodologies and evaluated the performance of GRSA against the other popular enrichment analysis methods using the identical pathway database (KEGG v109.0).</p>
      <p>We first compared the efficacy of different methods in identifying the target disease pathways using the 24 gene expression datasets associated with known human diseases (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). The rationale is that since each dataset is affiliated with a specific disease-linked KEGG pathway (the target pathway), an optimal enrichment analysis method should rank the target pathway among the top of all 342 pathways and enrich the target pathway with a smaller adjusted <italic toggle="yes">P</italic>-value. The results indicate that in terms of assigning a smaller rank to the target pathway, PADOG, GSA, GRSA, GSEA and SAFE performed similarly, as their median ranks all fall within the top 20% (<xref rid="f2" ref-type="fig">Figure 2A</xref>). In addition, GRSA achieves the lowest median adjusted <italic toggle="yes">P</italic>-values of the target pathways (<xref rid="f2" ref-type="fig">Figure 2B</xref>). We also used datasets from a GEO list provided by ‘GSEABenchmarkeR’ for further benchmarking and found similar results (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3A</xref>, <xref rid="sup1" ref-type="supplementary-material">B</xref>). Overall, GRSA’s performance is quite favorable among the threshold-free FCS methods, outperforming the conventional ORA method.</p>
      <p>We next evaluated the proficiency of different methods in detecting pathways disturbed by gene knockout experiments. In a gene knockout experiment, the knockout gene is a confirmed source of perturbation. Nguyen et al. considered pathways that included the knockout genes as true positives and pathways not including the target genes as true negatives, so the enrichment of such pathways would be considered false positives. Under these assumptions, we could calculate the sensitivity and specificity of a method. GRSA showed the highest median sensitivity among the methods considered, although its specificity is slightly reduced compared to others (<xref rid="f2" ref-type="fig">Figure 2C, D</xref>). We prioritize the sensitivity of a method because for pathways that included the knockout gene, deleting it should have a sizable impact on the pathway (sensitivity); however, for pathways that do not include the knockout gene in the database, given the potential incompleteness of pathway and gene databases, simply attributing these enriched pathways as false positives (specificity) may not always be appropriate.</p>
      <p>Lastly, we evaluated the ability of different methods to enrich biologically meaningful pathways [<xref rid="ref10" ref-type="bibr">10</xref>]. We compared the proportions of pathways identified by the GRSA, the competing tool and both, using the number of all significant pathways as the denominator (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3C</xref>). GRSA consistently identified a larger proportion of pathways than the ORA method and largely overlapped with GSEA. In these datasets, GRSA identified more enriched pathways than GSEA. For example, in the renal cell carcinoma dataset (GSE6344), pathways related to cytokine−cytokine receptor interaction [<xref rid="ref29" ref-type="bibr">29</xref>], IL-17 signaling [<xref rid="ref30" ref-type="bibr">30</xref>] and PI3K–Akt signaling [<xref rid="ref31" ref-type="bibr">31</xref>] were only enriched by GRSA (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4A</xref>). In the endometrial cancer dataset (GSE7305), GRSA identified pathways related to cancer, Toll-like receptor [<xref rid="ref32" ref-type="bibr">32</xref>] and cortisol synthesis [<xref rid="ref33" ref-type="bibr">33</xref>], which have been shown to be involved in the pathological characteristics of endometrial cancer (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4B</xref>). Therefore, GRSA can potentially identify more pathways biologically relevant to the studied diseases.</p>
    </sec>
    <sec id="sec12">
      <title>Case study 1: the functional analysis and age-related dynamics of the skin microbiota</title>
      <p>Next, we showcased the versatile applications of GRSA with different types of omics data. For microbiome data, we collected the KO profile of the IHSMGC (integrated Human Skin Microbial Gene Catalog) dataset published by Wang et al. [<xref rid="ref17" ref-type="bibr">17</xref>] and re-analyzed the data using the GRSA method. The previous study calculated the pathway abundance by aggregating the abundances of features within a pathway and then performed differential abundance analysis. We applied the GRSA to find the functional differences between the two cutotypes. The results were largely consistent. As an example, modules related to the biosynthesis of thiamine, phylloquinone and cobalamin were enriched in the <italic toggle="yes">M-cutotype</italic>, while modules related to tetrahydrofolate, menaquinone, pantothenate and ubiquinone were enriched in the <italic toggle="yes">C-cutotype</italic> (<xref rid="f3" ref-type="fig">Figure 3A</xref>). In addition, the <italic toggle="yes">M-cutotype</italic> was enriched with a large number of modules related to the metabolism of sulfur, phenylacetate (aromatic compound) and amino acids, while the <italic toggle="yes">C-cutotype</italic> was enriched with modules related to carbohydrate metabolism (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>). Importantly, GRSA also identified pathways not found in the previous study. The <italic toggle="yes">M-cutotype</italic> was enriched with modules related to nucleotide metabolism, such as the degradation and <italic toggle="yes">de novo</italic> biosynthesis of purine (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>), indicating that the <italic toggle="yes">M-cutotype</italic> microbiota may have a higher nucleotide turnover rate and stronger proliferation [<xref rid="ref34" ref-type="bibr">34</xref>].</p>
      <fig position="float" id="f3">
        <label>Figure 3</label>
        <caption>
          <p>Application of GRSA to the skin microbiome of the IHSMGC dataset. (<bold>A</bold>) The network of KO-Module enriched in the <italic toggle="yes">M-cutotype</italic> (green) and <italic toggle="yes">C-cutotype</italic> (blue). Only modules related to vitamin biosynthesis were shown. Big dots represent modules; small dots represent KOs. The colors of small dots represent cutotypes. Shades indicate modules involved in the biosynthesis of the same vitamin. The colors of shades denote modules enriched in the <italic toggle="yes">M-cutotype</italic> (green) or enriched in the <italic toggle="yes">C-cutotype</italic> (blue). (<bold>B</bold>–<bold>C</bold>) The box charts of modules ‘M00866’ (<bold>B</bold>) and ‘M00061’ (<bold>C</bold>) across ages. The colors of the lines represent the trend of KO’s relative abundance in the module. ‘M00866’ had the biggest positive reporter score (increasing), while ‘M00061’ had the biggest absolute value of negative score (decreasing). (<bold>D</bold>) The bar charts show significantly enriched modules over aging; the reporter score threshold of 2.5 corresponds to a confidence of about 0.995, and these modules are grouped based on the KEGG level B. Colors denote up-regulated (red) or down-regulated (green) modules with aging.</p>
        </caption>
        <graphic xlink:href="bbae116f3" position="float"/>
      </fig>
      <p>The previous study divided samples into five aging groups and found that the prevalence of the <italic toggle="yes">M-cutotype</italic> significantly increased with age. However, they did not perform age-related functional analysis. We re-analyzed the multi-group data using GRSA to explore the functional dynamics related to aging. The larger positive reporter scores indicate that the module had an overall increasing trend with respect to age, such as ‘M00866’, related to lipid A biosynthesis (<xref rid="f3" ref-type="fig">Figure 3B</xref>), while modules with negative reporter scores show an overall decreasing trend with respect to age, such as ‘M00061’, related to <sc>d</sc>-glucuronate degradation (<xref rid="f3" ref-type="fig">Figure 3C</xref>). We next analyzed the chronological trend of the functional modules at the KEGG level B (<xref rid="f3" ref-type="fig">Figure 3D</xref>), which better reflects the overall metabolic activities of the microbiome. We found that the carbohydrate metabolism activity of the skin microbiota decreased with aging, while the lipid, amino acid and nucleotide metabolism activity increased with aging. These results suggest that the energy sources of the skin microbiota significantly change with aging.</p>
      <p>The vitamin biosynthesis-related functional modules also showed differences with respect to aging (<xref rid="f3" ref-type="fig">Figure 3D</xref>). For the glycan metabolism-related functional modules, biosynthesis of KDO2-lipid A and CMP-KDO increased with aging. KDO2-lipid A is an essential lipopolysaccharide (LPS) component in most gram-negative bacteria, which has endotoxin activity and stimulates host immune responses through Toll-like receptor 4 (TLR4) [<xref rid="ref35" ref-type="bibr">35</xref>]. CMP-KDO is an important intermediate in the synthesis of KDO2-lipid A, and CMP-KDO synthesis is the key rate-limiting step for introducing KDO into LPS [<xref rid="ref36" ref-type="bibr">36</xref>]. These results suggest that the microbiota of aging skins likely accumulated endotoxins, which can stimulate host inflammation. In addition, we found that degradation pathways of several sulfated glycosaminoglycans (chondroitin sulfate, dermatan sulfate and keratan sulfate) decreased in aging skin. Sulfated glycosaminoglycans play a key role in regulating skin physiology, and there is ample evidence that their properties and functions change over time and with extrinsic skin aging [<xref rid="ref37" ref-type="bibr">37</xref>, <xref rid="ref38" ref-type="bibr">38</xref>]. Total sulfated glycosaminoglycan abundance was reduced in aging skin [<xref rid="ref39" ref-type="bibr">39</xref>], which may lead to the decreased degrading ability of the skin microbiota for the sulfated glycosaminoglycans.</p>
    </sec>
    <sec id="sec13">
      <title>Case study 2: the functional transcriptional dynamics during cardiomyocyte differentiation</title>
      <p>We applied GRSA to the transcriptomic dataset published by Liu et al. in 2017 [<xref rid="ref18" ref-type="bibr">18</xref>]. The study used the weighted gene co-expression network analysis (WGCNA) method to analyze the temporal transcriptomic changes during the differentiation of cardiomyocytes from 2 hiPSC lines and 2 hESC lines at 4 timepoints (pluripotent stem cells at day 0, mesoderm at day 2, cardiac mesoderm at day 4 and differentiated cardiomyocytes at day 30). Significant changes were observed in the four stages of differentiation among all cell lines. For example, genes in module 1 were highly expressed only in differentiated cardiomyocytes (stage CM), and their enriched Gene Ontology (GO) terms of Biological Process were related to heart functions, such as regulation of cardiac contraction and muscular system processes. WGCNA did not assume the patterns to be linear so that genes can be only highly expressed at day 2 during mesoderm development, for example.</p>
      <p>In addition to linearly increasing or decreasing patterns, GRSA allows users to specify any expected patterns for enrichment analysis. To start, we used the fuzzy C-means clustering method to identify the main gene expression patterns (<xref rid="f4" ref-type="fig">Figure 4A</xref>) and then used these patterns for GRSA to obtain significantly enriched pathways in each pattern (using the RSA_by_cm function in the ReporterScore package). For example, ‘Heart process (GO:0003015)’ was a significantly enriched GO term for Cluster 6, which was highly expressed only in stage CM (day 30). We identified many genes consistent with the expression pattern of Cluster 6 (<xref rid="f4" ref-type="fig">Figure 4B</xref>).</p>
      <fig position="float" id="f4">
        <label>Figure 4</label>
        <caption>
          <p>Application of GRSA to the transcriptomic dataset on the cardiomyocyte differentiation processes. (<bold>A</bold>) C-means clustering result of gene abundance profiles across four differentiation stages. The genes with membership scores greater than 0.8 are displayed. The alpha (transparency) of each line was related to the value of its membership score, and the <italic toggle="yes">y</italic>-axis represents the standardized abundance. (<bold>B</bold>) The box chart shows the abundance of genes in ‘GO:0003015’ (heart process) across four time points; the colors of the lines represent the correlative significance of each gene with Cluster 6 within the GO term. ‘GO:0003015’ is a representative term of Cluster 6. (<bold>C</bold>) The bar chart shows significantly enriched GO terms for each clustering pattern corresponding to the differentiation stages. The colors of the bars represent the cluster information, and the representative GO terms with high reporter scores in each cluster are shown. The text labels on the left are colored according to the stages with the highest expression. In general, Cluster 2 corresponds to day 0, Clusters 4 and 5 correspond to day 2, Cluster 1 corresponds to day 4, and Clusters 3 and 6 correspond to CM. Note that only pathways with significant positive scores are shown. The negative score of specified patterns would indicate anti-correlative patterns, which should have already been identified by c-means analysis, such as Cluster 3 versus 4.</p>
        </caption>
        <graphic xlink:href="bbae116f4" position="float"/>
      </fig>
      <p>GRSA results for all clusters are shown in <xref rid="f4" ref-type="fig">Figure 4C</xref>. Cluster 2 was highly expressed only at day 0, and its enriched GO terms were mainly related to the mitotic cell cycle, which was expected for stem cell self-renewal processes. Cluster 5 had the highest expression level on day 2 and was mainly enriched in various transcription and translation processes. Cluster 4 was highly expressed at day 0 and day 2 and showed a gradually decreasing trend; its function overlapped with Clusters 2 and 5. Cluster 1, highly expressed at day 4, was related to mesoderm formation, such as morphogenesis and organ development. Clusters 3 and 6 were primarily up-regulated in differentiated cardiomyocytes (CM stage), and they were related to heart functions, such as regulation of heart contraction and muscle system processes, similar to module 1 in the previous study. Interestingly, the biological processes of hiPSCs/hESCs at day 2 (Cluster 5) induced various RNA-related metabolisms, which were not found in the previous study, indicating that complex transcriptional regulations are involved for further mesoderm formation. Therefore, using the identified expression patterns across groups, we successfully identified pathways and modules essential to different stages of the cardiomyocyte differentiation processes.</p>
    </sec>
    <sec id="sec14">
      <title>Case study 3: the systematic maternal metabolomic changes correlated with gestational age</title>
      <p>We next applied GRSA to metabolomic data from a Danish pregnancy cohort in which female participants had blood drawn weekly from pregnancy to the postpartum period for untargeted metabolomics analysis [<xref rid="ref16" ref-type="bibr">16</xref>]. Using gestational age as the study variable, they modeled a metabolic clock and found that several marker metabolites increased linearly with gestational age.</p>
      <p>We found several important pathways up-regulated with gestational age: steroid hormone biosynthesis, cortisol synthesis and secretion, and oocyte meiosis (<xref rid="f5" ref-type="fig">Figure 5A</xref>). Multiple steroid hormones were up-regulated with increasing gestational age (<xref rid="f5" ref-type="fig">Figure 5B</xref>), including progesterone that interacts with the hypothalamic–pituitary–adrenal axis [<xref rid="ref40" ref-type="bibr">40</xref>] and estriol-16-glucuronide produced by the placenta [<xref rid="ref41" ref-type="bibr">41</xref>]. At the same time, two androgen-related steroid hormones were down-regulated: dehydroepiandrosterone sulfate and androsterone 3-glucuronide, as the concentration of androgens plays important physiological functions during pregnancy [<xref rid="ref42" ref-type="bibr">42</xref>]. We also found that pathways related to the metabolism of aromatic amino acids were down-regulated with increasing gestational age (<xref rid="f5" ref-type="fig">Figure 5A</xref>), which has been reported [<xref rid="ref43" ref-type="bibr">43</xref>].</p>
      <fig position="float" id="f5">
        <label>Figure 5</label>
        <caption>
          <p>Application of GRSA in the metabolic data of the Danish pregnancy cohort and the taxonomic enrichment analysis of the IHSMGC dataset. (<bold>A</bold>) The circle packing chart shows the hierarchical relationships of significantly enriched pathways identified by GRSA in the metabolomic study. The size of the circle indicates the absolute value of the reporter score, and the color of the circle indicates the sign of the reporter score. The positive reporter score indicates the pathway was increased (orange), while the negative reporter score indicates the pathway was decreased (purple). (<bold>B</bold>) The heatmap shows the abundance of metabolites in the pathway ‘steroid hormone biosynthesis’. The columns are samples ordered by the increasing gestational age. (<bold>C</bold>) The bar chart shows significantly enriched genera in the <italic toggle="yes">C-cutotype</italic> and <italic toggle="yes">M-cutotype</italic>. (<bold>D</bold>) The network plot shows the species in <italic toggle="yes">g_Moraxella</italic> and <italic toggle="yes">g_Cutibacterium</italic> enriched in the <italic toggle="yes">M-cutotype</italic> (green) or <italic toggle="yes">C-cutotype</italic> (blue).</p>
        </caption>
        <graphic xlink:href="bbae116f5" position="float"/>
      </fig>
      <p>Importantly, we identified several up-regulated pathways related to human diseases not mentioned in the previous study. Cushing syndrome happens when the body has too much of the hormone cortisol for a long time, which could be induced by a healthy pregnancy [<xref rid="ref44" ref-type="bibr">44</xref>]. The up-regulation of pathways related to breast cancer was also noticeable, as pregnancy-associated breast cancer (PABC) accounts for 7% of all breast cancer in young women [<xref rid="ref45" ref-type="bibr">45</xref>]. More potential discoveries can be made if the metabolite-pathway database is improved.</p>
    </sec>
    <sec id="sec15">
      <title>Case study 4: the application of GRSA beyond functional enrichment analysis</title>
      <p>The algorithm of GRSA suggests that any features organized in a hierarchical relationship can be used as an enrichment database. For example, we can perform taxonomic enrichment analysis using the phylogenetic relationships of microbes, such as genus–species relationships. To demonstrate, with the custom_modulelist function, we used the species abundance table from the IHSMGC dataset and looked for genera enriched in the two cutotypes. We found that <italic toggle="yes">Psychrobacter</italic>, <italic toggle="yes">Paracoccus</italic>, <italic toggle="yes">Chryseobacterium</italic>, <italic toggle="yes">Elizabethkingia</italic>, <italic toggle="yes">Deinococcus</italic> and <italic toggle="yes">Microbacterium</italic> were enriched in the <italic toggle="yes">M-cutotype</italic>, while <italic toggle="yes">Acidipropionibacterium</italic>, <italic toggle="yes">Staphylococcus</italic>, <italic toggle="yes">Corynebacterium</italic> and <italic toggle="yes">Cutibacterium</italic> were enriched in the <italic toggle="yes">C-cutotype</italic> (<xref rid="f5" ref-type="fig">Figure 5C</xref>), some of which were highly consistent with the differential species modules found by co-occurrence network in the previous study. However, we additionally found some genera, such as <italic toggle="yes">Brevundimonas</italic> and <italic toggle="yes">Rhodobacter</italic>, enriched in the <italic toggle="yes">M-cutotype</italic>, while <italic toggle="yes">Pahexavirus</italic> (phages of <italic toggle="yes">Propionibacterium</italic> and <italic toggle="yes">Cutibacterium</italic>) was enriched in the <italic toggle="yes">C-cutotype</italic> (<xref rid="f5" ref-type="fig">Figure 5C</xref>), probably due to the higher sensitivity of GRSA.</p>
      <p>Two species, <italic toggle="yes">Moraxella osloensis</italic> and <italic toggle="yes">Cutibacterium acnes</italic>, were used to define the cutotype in the previous study. Interestingly, while the <italic toggle="yes">Cutibacterium</italic> genus was a good biomarker between cutotypes, the <italic toggle="yes">Moraxella</italic> genus was not, as the included species did not share the same trend (<xref rid="f5" ref-type="fig">Figure 5D</xref>). Therefore, in addition to functional enrichment analysis, GRSA can be extended to any hierarchical relational data structure.</p>
    </sec>
  </sec>
  <sec id="sec16">
    <title>DISCUSSION</title>
    <p>We developed the ReporterScore package and demonstrated broad applications of the GRSA enrichment analyses. We improved the classic RSA method for easier interpretation of the plus and minus signs of the reporter scores. More importantly, we expanded the scope of GRSA from two-group designs to multi-group and longitudinal designs. We demonstrated these new features with metagenomic, transcriptomic and metabolomic data (<xref rid="f3" ref-type="fig">Figures 3</xref>–<xref rid="f5" ref-type="fig">5</xref>). Lastly, we showed that the GRSA is not limited to functional enrichment analysis. Notably, all figures were generated using the visualization module in the ReporterScore package.</p>
    <p>GRSA considers all KOs involved in the pathway compared to hypergeometric tests that only consider a pre-defined list (e.g. KO/gene with <italic toggle="yes">P</italic>-value &lt; 0.05). Thus, GRSA is more sensitive and can comprehensively assess the feature abundance differences in the pathway (<xref rid="f2" ref-type="fig">Figure 2</xref>). GRSA still has some limitations: (1) GRSA exhibits a slightly lower specificity, underscoring the necessity for additional experimental validations. (2) GRSA relies on <italic toggle="yes">Z</italic>-scores derived from <italic toggle="yes">P</italic>-values as the statistical measure, which depends on the upstream statistical methods. Users are required to select appropriate statistical methods based on the nature of the data and experimental design. (3) GRSA is a competitive enrichment analysis method that relies on the key assumption of feature independence [<xref rid="ref46" ref-type="bibr">46</xref>].</p>
    <p>We must acknowledge that comparing enrichment analysis methods is fraught with risks, as there is no established gold standard in the field despite continuous efforts [<xref rid="ref2" ref-type="bibr">2</xref>]. Many reviews typically use disease datasets to evaluate methods based on prioritization or phenotype relevance [<xref rid="ref8" ref-type="bibr">8</xref>, <xref rid="ref23" ref-type="bibr">23</xref>, <xref rid="ref28" ref-type="bibr">28</xref>, <xref rid="ref47" ref-type="bibr">47</xref>]. We used the ranks and <italic toggle="yes">P</italic>-values of statistical methods to evaluate the prioritization in our comparison (<xref rid="f2" ref-type="fig">Figure 2A,B</xref>), assuming a single true positive: the target disease-associated pathway. However, diseases like cancer cause significant disruptions to complex biological systems. For some diseases, many different pathways could be impacted to varying degrees, with non-target pathways sometimes affected even more than the target pathway [<xref rid="ref22" ref-type="bibr">22</xref>].</p>
    <p>We used the knockout gene experiment datasets to assess sensitivity and specificity referred to Nguyen et al. [<xref rid="ref22" ref-type="bibr">22</xref>]. We considered sensitivity a crucial metric for enrichment methods because an effective method should maximize the identification of the expected pathways (<xref rid="f2" ref-type="fig">Figure 2C</xref>). The gene–pathway relationships recorded in the database are typically backed by experimental evidence, making the definitions of true positives and false negatives more suitable. Thus, the sensitivity can be effectively evaluated (equation (<xref rid="deqn12" ref-type="disp-formula">12</xref>)). In contrast, it is difficult to define the true negatives due to the complexity of biological systems leading to the incompleteness of databases. For example, a knocked-out gene may impact pathway A through a signaling pathway yet to be discovered, which frequently happens in molecular biology research. Thus, the specificity of a method cannot be accurately evaluated (equation (<xref rid="deqn13" ref-type="disp-formula">13</xref>), <xref rid="f2" ref-type="fig">Figure 2D</xref>). Moreover, the primary role of functional enrichment analysis is to guide for interpreting the omics data. Additional experimental verification is essential to substantiate the analysis results.</p>
    <p>Multi-omic studies are increasingly prevalent and so are the demands for functional enrichment analysis of all types of omics data [<xref rid="ref48" ref-type="bibr">48–51</xref>]. The GRSA applies to all types of omics datasets as long as a relevant relational database is available. As demonstrated by case studies, we confirmed previous key findings and acquired new biological insights. For example, applying GRSA on the IHSMGC dataset suggested different functional profiles between aging and young skin microbiota. Biosynthesis of KDO2-lipid A and CMP-KDO increased while degradation pathways of several sulfated glycosaminoglycans decreased in older skin microbiota, which may be linked to changes in the skin’s physiological properties. Further studies are needed to investigate the underlying mechanisms and their implications for skin health. Applying GRSA on the transcriptomic data of cardiomyocyte differentiations revealed that hiPSCs/hESCs at day 2 specialized in various RNA-related metabolisms, suggesting the involvement of complex transcriptional regulation in further mesoderm formation. Finally, applying GRSA to the metabolomic data from the Danish pregnancy cohort showed that several pathways related to human diseases were up-regulated with gestational age, including Cushing syndrome and PABC.</p>
    <p>The GRSA offers the option for user-specified patterns for enrichment analysis, allowing for rapid testing of educated hypotheses in complex multi-group studies. This is demonstrated in our analysis of the transcriptomic data during cardiomyocyte differentiations. The GRSA offers applications beyond functional enrichment analysis. Applying GRSA in the taxonomic enrichment analysis of the IHSMGC dataset identified key genera that significantly differed between the two cutotypes. The results were highly consistent with the microbial co-occurrence network analysis in the previous study, but performing GRSA was much easier and faster than the network analysis.</p>
    <p>In summary, we believe the GRSA and the ReporterScore package can greatly facilitate the functional enrichment analyses of diverse omics data, with higher sensitivity, compatibility with multi-group and longitudinal designs, and flexibility with customized databases for creative applications beyond functional enrichment analyses. In the future, we plan to incorporate additional built-in databases and visualization techniques, while consistently maintaining and updating the ReporterScore package.</p>
    <boxed-text id="box01" position="float">
      <sec id="sec17">
        <title>Key Points</title>
        <list list-type="bullet">
          <list-item>
            <p>We developed generalized reporter score enrichment analysis (GRSA) and the R package ReporterScore, significantly expanding the capabilities of the classic RSA to multi-group and longitudinal experimental designs and is inherently compatible with nearly all types of omics data.</p>
          </list-item>
          <list-item>
            <p>The GRSA offers higher sensitivity than commonly used enrichment analysis approaches. We confirmed previous key findings and acquired new biological insights in 4 case studies using GRSA.</p>
          </list-item>
          <list-item>
            <p>The GRSA can be applied to any established relational database and perform customized enrichment analysis, such as taxonomy enrichment analysis.</p>
          </list-item>
        </list>
      </sec>
    </boxed-text>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>RS_supp_BIB3-final_bbae116</label>
      <media xlink:href="rs_supp_bib3-final_bbae116.docx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="bbae116-ack">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We are grateful to our colleagues at the core facility of the Life Sciences Institute, especially the NECHO high-performance computing cluster.</p>
  </ack>
  <sec id="sec21">
    <title>FUNDING</title>
    <p>This research was supported by grants from NSFC (82173645 and 82341109) and the Fundamental Research Funds for the Central Universities (2022FZZX03-03-07).</p>
  </sec>
  <sec id="sec19">
    <title>AUTHOR CONTRIBUTIONS</title>
    <p><bold>Chen Peng:</bold> Conceptualization, Methodology, Investigation, Software, Visualization, Formal Analysis, Validation, Writing – Original Draft and Writing – Review &amp; Editing. <bold>Qiong Chen:</bold> Writing – Review &amp; Editing. <bold>Shangjin Tan:</bold> Writing – Review &amp; Editing. <bold>Xiaotao Shen:</bold> Writing – Review &amp; Editing. <bold>Chao Jiang:</bold> Conceptualization, Methodology, Investigation, Writing – Original Draft, Writing – Review &amp; Editing, Supervision, Project Administration and Funding Acquisition.</p>
  </sec>
  <sec sec-type="data-availability" id="sec18">
    <title>DATA AVAILABILITY</title>
    <p>Code is available as an open-source R package ‘ReporterScore’ on the Comprehensive R Archive Network (CRAN) (<ext-link xlink:href="https://cran.r-project.org/web/packages/ReporterScore" ext-link-type="uri">https://cran.r-project.org/web/packages/ReporterScore</ext-link>). The main analysis scripts (Rmarkdown format) and source data are available from GitHub (<ext-link xlink:href="https://github.com/Asa12138/Analysis_code/tree/main/GRSA_figures" ext-link-type="uri">https://github.com/Asa12138/Analysis_code/tree/main/GRSA_figures</ext-link>).</p>
  </sec>
  <notes id="bio3">
    <title>Author Biographies</title>
    <p><bold>Chen Peng</bold> is a PhD student in the Life Sciences Institute at Zhejiang University.</p>
    <sec sec-type="author-bio" id="sec22b">
      <p><bold>Qiong Chen</bold> is a post-doctoral fellow in the Life Sciences Institute at Zhejiang University.</p>
    </sec>
    <sec sec-type="author-bio" id="sec22c">
      <p><bold>Shangjin Tan</bold> is working in the BGI Research.</p>
    </sec>
    <sec sec-type="author-bio" id="sec22d">
      <p><bold>Xiaotao Shen</bold> is a post-doctoral fellow in Prof. Michael Snyder’s lab at Stanford University School of Medicine.</p>
    </sec>
    <sec sec-type="author-bio" id="sec22e">
      <p><bold>Chao Jiang</bold> is a principal investigator in the Life Sciences Institute at Zhejiang University.</p>
    </sec>
  </notes>
  <ref-list id="bib1">
    <title>References</title>
    <ref id="ref1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>K</given-names></string-name>, <string-name><surname>Rhee</surname><given-names>SY</given-names></string-name></person-group>. <article-title>Interpreting omics data with pathway enrichment analysis</article-title>. <source>Trends Genet</source><year>2023</year>;<volume>39</volume>:<fpage>308</fpage>–<lpage>19</lpage>.<pub-id pub-id-type="pmid">36750393</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mubeen</surname><given-names>S</given-names></string-name>, <string-name><surname>Tom Kodamullil</surname><given-names>A</given-names></string-name>, <string-name><surname>Hofmann-Apitius</surname><given-names>M</given-names></string-name>, <string-name><surname>Domingo-Fernández</surname><given-names>D</given-names></string-name></person-group>. <article-title>On the influence of several factors on pathway enrichment analysis</article-title>. <source>Brief Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbac143</fpage>.<pub-id pub-id-type="pmid">35453140</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sherman</surname><given-names>BT</given-names></string-name>, <string-name><surname>Hao</surname><given-names>M</given-names></string-name>, <string-name><surname>Qiu</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>DAVID: a web server for functional enrichment analysis and functional annotation of gene lists (2021 update)</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>W216</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">35325185</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>T</given-names></string-name>, <string-name><surname>Hu</surname><given-names>E</given-names></string-name>, <string-name><surname>Xu</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>clusterProfiler 4.0: a universal enrichment tool for interpreting omics data</article-title>. <source>Innovation (Camb)</source><year>2021</year>;<volume>2</volume>:<fpage>100141</fpage>.<pub-id pub-id-type="pmid">34557778</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname><given-names>A</given-names></string-name>, <string-name><surname>Tamayo</surname><given-names>P</given-names></string-name>, <string-name><surname>Mootha</surname><given-names>VK</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc Natl Acad Sci</source><year>2005</year>;<volume>102</volume>:<fpage>15545</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barry</surname><given-names>WT</given-names></string-name>, <string-name><surname>Nobel</surname><given-names>AB</given-names></string-name>, <string-name><surname>Wright</surname><given-names>FA</given-names></string-name></person-group>. <article-title>Significance analysis of functional categories in gene expression studies: a structured permutation approach</article-title>. <source>Bioinformatics</source><year>2005</year>;<volume>21</volume>:<fpage>1943</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">15647293</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Efron</surname><given-names>B</given-names></string-name>, <string-name><surname>Tibshirani</surname><given-names>R</given-names></string-name></person-group>. <article-title>On testing the significance of sets of genes</article-title>. <source>Ann Appl Stat</source><year>2007</year>;<volume>1</volume>:<fpage>107</fpage>–<lpage>29</lpage>.</mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarca</surname><given-names>AL</given-names></string-name>, <string-name><surname>Draghici</surname><given-names>S</given-names></string-name>, <string-name><surname>Bhatti</surname><given-names>G</given-names></string-name>, <string-name><surname>Romero</surname><given-names>R</given-names></string-name></person-group>. <article-title>Down-weighting overlapping genes improves gene set analysis</article-title>. <source>BMC Bioinformatics</source><year>2012</year>;<volume>13</volume>:<fpage>136</fpage>.<pub-id pub-id-type="pmid">22713124</pub-id></mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hänzelmann</surname><given-names>S</given-names></string-name>, <string-name><surname>Castelo</surname><given-names>R</given-names></string-name>, <string-name><surname>Guinney</surname><given-names>J</given-names></string-name></person-group>. <article-title>GSVA: gene set variation analysis for microarray and RNA-Seq data</article-title>. <source>BMC Bioinformatics</source><year>2013</year>;<volume>14</volume>:<fpage>7</fpage>.<pub-id pub-id-type="pmid">23323831</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Q</given-names></string-name>, <string-name><surname>Wang</surname><given-names>S</given-names></string-name>, <string-name><surname>Dai</surname><given-names>E</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Pathway enrichment analysis approach based on topological structure and updated annotation of pathway</article-title>. <source>Brief Bioinform</source><year>2019</year>;<volume>20</volume>:<fpage>168</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">28968630</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goeman</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Bühlmann</surname><given-names>P</given-names></string-name></person-group>. <article-title>Analyzing gene expression data in terms of gene sets: methodological issues</article-title>. <source>Bioinformatics</source><year>2007</year>;<volume>23</volume>:<fpage>980</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">17303618</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patil</surname><given-names>KR</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>J</given-names></string-name></person-group>. <article-title>Uncovering transcriptional regulation of metabolism by using metabolic network topology</article-title>. <source>Proc Natl Acad Sci U S A</source><year>2005</year>;<volume>102</volume>:<fpage>2685</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">15710883</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>F</given-names></string-name>, <string-name><surname>Ju</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Metagenome-wide association of gut microbiome features for schizophrenia</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>1612</fpage>.<pub-id pub-id-type="pmid">32235826</pub-id></mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>L</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>R</given-names></string-name>, <string-name><surname>Wu</surname><given-names>D</given-names></string-name></person-group>. <article-title>Misuse of reporter score in microbial enrichment analysis</article-title>. <source>iMeta</source><year>2023</year>;<volume>2</volume>:<fpage>e95</fpage>.<pub-id pub-id-type="pmid">38868431</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oliveira</surname><given-names>AP</given-names></string-name>, <string-name><surname>Patil</surname><given-names>KR</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>J</given-names></string-name></person-group>. <article-title>Architecture of transcriptional regulatory circuits is knitted over the topology of bio-molecular interaction networks</article-title>. <source>BMC Syst Biol</source><year>2008</year>;<volume>2</volume>:<fpage>17</fpage>.<pub-id pub-id-type="pmid">18261202</pub-id></mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liang</surname><given-names>L</given-names></string-name>, <string-name><surname>Rasmussen</surname><given-names>M-LH</given-names></string-name>, <string-name><surname>Piening</surname><given-names>B</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Metabolic dynamics and prediction of gestational age and time to delivery in pregnant women</article-title>. <source>Cell</source><year>2020</year>;<volume>181</volume>:<fpage>1680</fpage>–<lpage>1692.e15</lpage>.<pub-id pub-id-type="pmid">32589958</pub-id></mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Z</given-names></string-name>, <string-name><surname>Xia</surname><given-names>J</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Characterization of the human skin resistome and identification of two microbiota cutotypes</article-title>. <source>Microbiome</source><year>2021</year>;<volume>9</volume>:<fpage>47</fpage>.<pub-id pub-id-type="pmid">33597039</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>C</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Genome-wide temporal profiling of transcriptome and open chromatin of early cardiomyocyte differentiation derived from hiPSCs and hESCs</article-title>. <source>Circ Res</source><year>2017</year>;<volume>121</volume>:<fpage>376</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">28663367</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bezdek</surname><given-names>JC</given-names></string-name>, <string-name><surname>Ehrlich</surname><given-names>R</given-names></string-name>, <string-name><surname>Full</surname><given-names>W</given-names></string-name></person-group>. <article-title>FCM: the fuzzy c-means clustering algorithm</article-title>. <source>Comput Geosci</source><year>1984</year>;<volume>10</volume>:<fpage>191</fpage>–<lpage>203</lpage>.</mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shi</surname><given-names>L</given-names></string-name>, <string-name><surname>Shi</surname><given-names>L</given-names></string-name>, <string-name><surname>Reid</surname><given-names>LH</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The MicroArray quality control (MAQC) project shows inter- and intraplatform reproducibility of gene expression measurements</article-title>. <source>Nat Biotechnol</source><year>2006</year>;<volume>24</volume>:<fpage>1151</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">16964229</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zyla</surname><given-names>J</given-names></string-name>, <string-name><surname>Marczyk</surname><given-names>M</given-names></string-name>, <string-name><surname>Weiner</surname><given-names>J</given-names></string-name>, <string-name><surname>Polanska</surname><given-names>J</given-names></string-name></person-group>. <article-title>Ranking metrics in gene set enrichment analysis: do they matter?</article-title><source>BMC Bioinformatics</source><year>2017</year>;<volume>18</volume>:<fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">28049414</pub-id></mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nguyen</surname><given-names>T-M</given-names></string-name>, <string-name><surname>Shafi</surname><given-names>A</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>T</given-names></string-name>, <string-name><surname>Draghici</surname><given-names>S</given-names></string-name></person-group>. <article-title>Identifying significantly impacted pathways: a comprehensive review and assessment</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>203</fpage>.<pub-id pub-id-type="pmid">31597578</pub-id></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Geistlinger</surname><given-names>L</given-names></string-name>, <string-name><surname>Csaba</surname><given-names>G</given-names></string-name>, <string-name><surname>Santarelli</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Toward a gold standard for benchmarking gene set enrichment analysis</article-title>. <source>Brief Bioinform</source><year>2021</year>;<volume>22</volume>:<fpage>545</fpage>–<lpage>56</lpage>.<pub-id pub-id-type="pmid">32026945</pub-id></mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M</given-names></string-name>, <string-name><surname>Sato</surname><given-names>Y</given-names></string-name></person-group>. <article-title>KEGG mapper for inferring cellular functions from protein sequences</article-title>. <source>Protein Sci</source><year>2020</year>;<volume>29</volume>:<fpage>28</fpage>–<lpage>35</lpage>.<pub-id pub-id-type="pmid">31423653</pub-id></mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M</given-names></string-name>, <string-name><surname>Sato</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kawashima</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>KEGG as a reference resource for gene and protein annotation</article-title>. <source>Nucleic Acids Res</source><year>2016</year>;<volume>44</volume>:<fpage>D457</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">26476454</pub-id></mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huerta-Cepas</surname><given-names>J</given-names></string-name>, <string-name><surname>Szklarczyk</surname><given-names>D</given-names></string-name>, <string-name><surname>Heller</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>eggNOG 5.0: a hierarchical, functionally and phylogenetically annotated orthology resource based on 5090 organisms and 2502 viruses</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>D309</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">30418610</pub-id></mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nearing</surname><given-names>JT</given-names></string-name>, <string-name><surname>Douglas</surname><given-names>GM</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>MG</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Microbiome differential abundance methods produce different results across 38 datasets</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>342</fpage>.<pub-id pub-id-type="pmid">35039521</pub-id></mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>J</given-names></string-name>, <string-name><surname>Shojaie</surname><given-names>A</given-names></string-name>, <string-name><surname>Michailidis</surname><given-names>G</given-names></string-name></person-group>. <article-title>A comparative study of topology-based pathway enrichment analysis methods</article-title>. <source>BMC Bioinformatics</source><year>2019</year>;<volume>20</volume>:<fpage>546</fpage>.<pub-id pub-id-type="pmid">31684881</pub-id></mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ocvirk</surname><given-names>S</given-names></string-name>, <string-name><surname>O’Keefe</surname><given-names>SJD</given-names></string-name></person-group>. <article-title>Dietary fat, bile acid metabolism and colorectal cancer</article-title>. <source>Semin Cancer Biol</source><year>2021</year>;<volume>73</volume>:<fpage>347</fpage>–<lpage>55</lpage>.<pub-id pub-id-type="pmid">33069873</pub-id></mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jarocki</surname><given-names>M</given-names></string-name>, <string-name><surname>Karska</surname><given-names>J</given-names></string-name>, <string-name><surname>Kowalski</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Interleukin 17 and its involvement in renal cell carcinoma</article-title>. <source>J Clin Med</source><year>2022</year>;<volume>11</volume>:<fpage>4973</fpage>.<pub-id pub-id-type="pmid">36078902</pub-id></mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Banumathy</surname><given-names>G</given-names></string-name>, <string-name><surname>Cairns</surname><given-names>P</given-names></string-name></person-group>. <article-title>Signaling pathways in renal cell carcinoma</article-title>. <source>Cancer Biol Ther</source><year>2010</year>;<volume>10</volume>:<fpage>658</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">20814228</pub-id></mixed-citation>
    </ref>
    <ref id="ref32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arabian</surname><given-names>S</given-names></string-name>, <string-name><surname>Boostan</surname><given-names>A</given-names></string-name>, <string-name><surname>Darzi</surname><given-names>S</given-names></string-name></person-group>. <article-title>The role of toll-like receptors (TLRs) and their therapeutic applications in endometrial cancer</article-title>. <source>Clin Transl Oncol</source><year>2023</year>;<volume>25</volume>:<fpage>859</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">36374404</pub-id></mixed-citation>
    </ref>
    <ref id="ref33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Larsson</surname><given-names>SC</given-names></string-name>, <string-name><surname>Lee</surname><given-names>W-H</given-names></string-name>, <string-name><surname>Kar</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Assessing the role of cortisol in cancer: a wide-ranged Mendelian randomisation study</article-title>. <source>Br J Cancer</source><year>2021</year>;<volume>125</volume>:<fpage>1025</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">34316022</pub-id></mixed-citation>
    </ref>
    <ref id="ref34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diehl</surname><given-names>FF</given-names></string-name>, <string-name><surname>Miettinen</surname><given-names>TP</given-names></string-name>, <string-name><surname>Elbashir</surname><given-names>R</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Nucleotide imbalance decouples cell growth from cell proliferation</article-title>. <source>Nat Cell Biol</source><year>2022</year>;<volume>24</volume>:<fpage>1252</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">35927450</pub-id></mixed-citation>
    </ref>
    <ref id="ref35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>X</given-names></string-name>, <string-name><surname>Quinn</surname><given-names>PJ</given-names></string-name>, <string-name><surname>Yan</surname><given-names>A</given-names></string-name></person-group>. <article-title>Kdo2-lipid a: structural diversity and impact on immunopharmacology</article-title>. <source>Biol Rev</source><year>2015</year>;<volume>90</volume>:<fpage>408</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">24838025</pub-id></mixed-citation>
    </ref>
    <ref id="ref36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heyes</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Levy</surname><given-names>C</given-names></string-name>, <string-name><surname>Lafite</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Structure-based mechanism of CMP-2-keto-3-deoxymanno-octulonic acid synthetase</article-title>. <source>J Biol Chem</source><year>2009</year>;<volume>284</volume>:<fpage>35514</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">19815542</pub-id></mixed-citation>
    </ref>
    <ref id="ref37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shin</surname><given-names>J-W</given-names></string-name>, <string-name><surname>Kwon</surname><given-names>S-H</given-names></string-name>, <string-name><surname>Choi</surname><given-names>J-Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Molecular mechanisms of dermal aging and antiaging approaches</article-title>. <source>Int J Mol Sci</source><year>2019</year>;<volume>20</volume>:<fpage>2126</fpage>.<pub-id pub-id-type="pmid">31036793</pub-id></mixed-citation>
    </ref>
    <ref id="ref38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>ST</given-names></string-name>, <string-name><surname>Neo</surname><given-names>BH</given-names></string-name>, <string-name><surname>Betts</surname><given-names>RJ</given-names></string-name></person-group>. <article-title>Glycosaminoglycans: sweet as sugar targets for topical skin anti-aging</article-title>. <source>Clin Cosmet Investig Dermatol</source><year>2021</year>;<volume>14</volume>:<fpage>1227</fpage>–<lpage>46</lpage>.</mixed-citation>
    </ref>
    <ref id="ref39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oh</surname><given-names>J-H</given-names></string-name>, <string-name><surname>Kim</surname><given-names>YK</given-names></string-name>, <string-name><surname>Jung</surname><given-names>J-Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Changes in glycosaminoglycans and related proteoglycans in intrinsically aged human skin in vivo</article-title>. <source>Exp Dermatol</source><year>2011</year>;<volume>20</volume>:<fpage>454</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">21426414</pub-id></mixed-citation>
    </ref>
    <ref id="ref40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chrousos</surname><given-names>GP</given-names></string-name>, <string-name><surname>Torpy</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Gold</surname><given-names>PW</given-names></string-name></person-group>. <article-title>Interactions between the hypothalamic-pituitary-adrenal axis and the female reproductive system: clinical implications</article-title>. <source>Ann Intern Med</source><year>1998</year>;<volume>129</volume>:<fpage>229</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">9696732</pub-id></mixed-citation>
    </ref>
    <ref id="ref41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levitz</surname><given-names>M</given-names></string-name>, <string-name><surname>Kadner</surname><given-names>S</given-names></string-name>, <string-name><surname>Young</surname><given-names>BK</given-names></string-name></person-group>. <article-title>Intermediary metabolism of estriol in pregnancy</article-title>. <source>J Steroid Biochem</source><year>1984</year>;<volume>20</volume>:<fpage>971</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">6727356</pub-id></mixed-citation>
    </ref>
    <ref id="ref42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Makieva</surname><given-names>S</given-names></string-name>, <string-name><surname>Saunders</surname><given-names>PTK</given-names></string-name>, <string-name><surname>Norman</surname><given-names>JE</given-names></string-name></person-group>. <article-title>Androgens in pregnancy: roles in parturition</article-title>. <source>Hum Reprod Update</source><year>2014</year>;<volume>20</volume>:<fpage>542</fpage>–<lpage>59</lpage>.<pub-id pub-id-type="pmid">24643344</pub-id></mixed-citation>
    </ref>
    <ref id="ref43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cox</surname><given-names>BD</given-names></string-name>, <string-name><surname>Calame</surname><given-names>DP</given-names></string-name></person-group>. <article-title>Changes in plasma amino acid levels during the human menstrual cycle and in early pregnancy. A preliminary report</article-title>. <source>Horm Metab Res</source><year>1978</year>;<volume>10</volume>:<fpage>428</fpage>–<lpage>33</lpage>.<pub-id pub-id-type="pmid">711138</pub-id></mixed-citation>
    </ref>
    <ref id="ref44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamblin</surname><given-names>R</given-names></string-name>, <string-name><surname>Coulden</surname><given-names>A</given-names></string-name>, <string-name><surname>Fountas</surname><given-names>A</given-names></string-name>, <string-name><surname>Karavitaki</surname><given-names>N</given-names></string-name></person-group>. <article-title>The diagnosis and management of Cushing’s syndrome in pregnancy</article-title>. <source>J Neuroendocrinol</source><year>2022</year>;<volume>34</volume>:<elocation-id>e13118</elocation-id>.<pub-id pub-id-type="pmid">35491087</pub-id></mixed-citation>
    </ref>
    <ref id="ref45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Genin</surname><given-names>AS</given-names></string-name>, <string-name><surname>De Rycke</surname><given-names>Y</given-names></string-name>, <string-name><surname>Stevens</surname><given-names>D</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Association with pregnancy increases the risk of local recurrence but does not impact overall survival in breast cancer: a case-control study of 87 cases</article-title>. <source>Breast (Edinburgh, Scotland)</source><year>2016</year>;<volume>30</volume>:<fpage>222</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">26456897</pub-id></mixed-citation>
    </ref>
    <ref id="ref46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ebrahimpoor</surname><given-names>M</given-names></string-name>, <string-name><surname>Spitali</surname><given-names>P</given-names></string-name>, <string-name><surname>Hettne</surname><given-names>K</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Simultaneous enrichment analysis of all possible gene-sets: unifying self-contained and competitive methods</article-title>. <source>Brief Bioinform</source><year>2020</year>;<volume>21</volume>:<fpage>1302</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">31297505</pub-id></mixed-citation>
    </ref>
    <ref id="ref47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarca</surname><given-names>AL</given-names></string-name>, <string-name><surname>Bhatti</surname><given-names>G</given-names></string-name>, <string-name><surname>Romero</surname><given-names>R</given-names></string-name></person-group>. <article-title>A comparison of gene set analysis methods in terms of sensitivity, prioritization and specificity</article-title>. <source>PLoS One</source><year>2013</year>;<volume>8</volume>:<elocation-id>e79217</elocation-id>.<pub-id pub-id-type="pmid">24260172</pub-id></mixed-citation>
    </ref>
    <ref id="ref48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gao</surname><given-names>P</given-names></string-name>, <string-name><surname>Shen</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Precision environmental health monitoring by longitudinal exposome and multi-omics profiling</article-title>. <source>Genome Res</source><year>2022</year>;<volume>32</volume>:<fpage>1199</fpage>–<lpage>214</lpage>.<pub-id pub-id-type="pmid">35667843</pub-id></mixed-citation>
    </ref>
    <ref id="ref49">
      <label>49.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname><given-names>C</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Dynamic human environmental exposome revealed by longitudinal personal monitoring</article-title>. <source>Cell</source><year>2018</year>;<volume>175</volume>:<fpage>277</fpage>–<lpage>291.e31</lpage>.<pub-id pub-id-type="pmid">30241608</pub-id></mixed-citation>
    </ref>
    <ref id="ref50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>F</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>L</given-names></string-name>, <string-name><surname>Pan</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Multi-omic profiling reveals that intra-abdominal-hypertension-induced intestinal damage can be prevented by microbiome and metabolic modulations with 5-hydroxyindoleacetic acid as a diagnostic marker</article-title>. <source>mSystems</source><year>2022</year>;<volume>7</volume>:<fpage>e01204</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">35574681</pub-id></mixed-citation>
    </ref>
    <ref id="ref51">
      <label>51.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname><given-names>X</given-names></string-name>, <string-name><surname>Huang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>L</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Charting the landscape of the environmental exposome</article-title>. <source>iMeta</source><year>2022</year>;<volume>1</volume>:<fpage>e50</fpage>.<pub-id pub-id-type="pmid">38867899</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
