<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7267826</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa140</article-id>
    <article-id pub-id-type="publisher-id">btaa140</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MESA: automated assessment of synthetic DNA fragments and simulation of DNA synthesis, storage, sequencing and PCR errors</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Schwarz</surname>
          <given-names>Michael</given-names>
        </name>
        <xref ref-type="aff" rid="btaa140-aff1">b1</xref>
        <xref ref-type="author-notes" rid="btaa140-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-4946-2156</contrib-id>
        <name>
          <surname>Welzel</surname>
          <given-names>Marius</given-names>
        </name>
        <xref ref-type="aff" rid="btaa140-aff1">b1</xref>
        <xref ref-type="author-notes" rid="btaa140-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kabdullayeva</surname>
          <given-names>Tolganay</given-names>
        </name>
        <xref ref-type="aff" rid="btaa140-aff2">b2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Becker</surname>
          <given-names>Anke</given-names>
        </name>
        <xref ref-type="aff" rid="btaa140-aff2">b2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Freisleben</surname>
          <given-names>Bernd</given-names>
        </name>
        <xref ref-type="aff" rid="btaa140-aff1">b1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-3108-8311</contrib-id>
        <name>
          <surname>Heider</surname>
          <given-names>Dominik</given-names>
        </name>
        <xref ref-type="aff" rid="btaa140-aff1">b1</xref>
        <xref ref-type="corresp" rid="btaa140-cor1"/>
        <!--<email>dominik.heider@uni-marburg.de</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btaa140-aff1">
      <label>b1</label>
      <institution>Department of Mathematics &amp; Computer Science</institution>
    </aff>
    <aff id="btaa140-aff2"><label>b2</label><institution>Department of Biology</institution>, SYNMIKRO, University of Marburg, Marburg D-35032, <country country="DE">Germany</country></aff>
    <author-notes>
      <fn id="btaa140-FM1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="btaa140-cor1">To whom correspondence should be addressed. Email: <email>dominik.heider@uni-marburg.de</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>6</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-03-04">
      <day>04</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>11</issue>
    <fpage>3322</fpage>
    <lpage>3326</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>1</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>2</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa140.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>The development of <italic>de novo</italic> DNA synthesis, polymerase chain reaction (PCR), DNA sequencing and molecular cloning gave researchers unprecedented control over DNA and DNA-mediated processes. To reduce the error probabilities of these techniques, DNA composition has to adhere to method-dependent restrictions. To comply with such restrictions, a synthetic DNA fragment is often adjusted manually or by using custom-made scripts. In this article, we present MESA (<italic>Mosla Error Simulator</italic>), a web application for the assessment of DNA fragments based on limitations of DNA synthesis, amplification, cloning, sequencing methods and biological restrictions of host organisms. Furthermore, MESA can be used to simulate errors during synthesis, PCR, storage and sequencing processes.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>MESA is available at <ext-link ext-link-type="uri" xlink:href="http://mesa.mosla.de">mesa.mosla.de</ext-link>, with the source code available at <ext-link ext-link-type="uri" xlink:href="http://github.com/umr-ds/mesa_dna_sim">github.com/umr-ds/mesa_dna_sim</ext-link>.</p>
      </sec>
      <sec id="s3">
        <title>Contact</title>
        <p>
          <email>dominik.heider@uni-marburg.de</email>
        </p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>LOEWE program of the State of Hesse</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>MOSLA research cluster</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The ability to synthesize increasingly large artificial DNA constructs, insert these fragments into organisms, and retrieve the genetic information using DNA sequencing led to numerous important discoveries in the biological sciences and opened up new applications for modified DNA, for example, personalized gene therapy (<xref rid="btaa140-B14" ref-type="bibr">Kitada <italic>et al.</italic>, 2018</xref>) and DNA data storage systems (<xref rid="btaa140-B3" ref-type="bibr">Ceze <italic>et al.</italic>, 2019</xref>). The composition of DNA fragments for such applications is still restricted by the limitations of DNA synthesis technologies, cloning methods and the genetic composition of the host organism, while the retrieved information can be corrupted by mutation events or errors during the sequencing process.</p>
    <p>Synthetic DNA often has to adhere to a combination of such restrictions, leading to a time consuming and error-prone evaluation process. Depending on the application for the synthetic DNA, it is also often useful to know where and what kind of errors can be expected for a given combination of processes and DNA composition. To ease the evaluation of synthetic DNA and allow user-friendly error simulation, we present MESA (<italic>Mosla Error Simulator</italic>), a web application for the assessment of DNA fragments in terms of guanine-cytosine (GC) content, homopolymer occurrences and length, repeating subsequences and undesirable sequence motifs. Furthermore, MESA contains a mutation simulator, using either the error probabilities of the assessment calculation, literature-based or user-defined error rates and error spectra. MESA is fully customizable using an easy-to-use web interface, without requiring programming experience. All functionality of MESA is also contained in a REST API, enabling the incorporation of MESA evaluations into custom workflows for high-throughput evaluation and error simulation of DNA.</p>
    <p>The limitations of the genetic engineering techniques mentioned above can be reduced to limitations regarding GC content, long stretches of a single nucleotide (homopolymers), repeating subsequences and motifs with biological relevance. For example, to synthesize synthetic DNA, <italic>in silico</italic> designed constructs have to be split into smaller fragments [usually 200–3000 base pairs (bp)] (<xref rid="btaa140-B15" ref-type="bibr">Kosuri and Church, 2014</xref>). The fragments are further split into 40–100 bp oligonucleotides (oligos) that are synthesized separately. After synthesis, the oligos are assembled using ligase or polymerase-based methods. Depending on the synthesis method and the overall GC content of a fragment, the GC content of each oligo has to be within a specific range. In oligos with a high GC content, neighboring guanines tend to form an increased amount of hydrogen bonds, leading to inter- and intra-strand folding (<xref rid="btaa140-B12" ref-type="bibr">Jensen <italic>et al.</italic>, 2010</xref>). To assemble oligos into larger fragments, the melting temperature (and thus the GC content) should only deviate slightly between oligos. To adhere to this restriction, the designed DNA fragments should be homogenous with respect to GC content. Homopolymers further increase the synthesis complexity, leading to fragments that are only synthesizable by using modified oligos and more sophisticated assembly methods, resulting in increased synthesis costs.</p>
    <p>The amplification of DNA using polymerase chain reaction (PCR) is indispensable for biological science. From DNA synthesis over cloning to DNA sequencing, PCR is used in a wide range of applications. One important factor of a successful PCR is the base composition of the amplification substrate. High melting temperatures due to high GC content of the DNA fragments hinder the separation of strands during the denaturation phase of the PCR. This reduces the yield of the PCR process, since the polymerase cannot efficiently synthesize the growing strand in the presence of previously existing hydrogen bonds. Stretches of repetitive DNA or high GC content can lead to the formation of secondary structures, hindering the elongation of the growing strand. Repetitive regions, as well as homopolymers, can also lead to polymerase slippage, a process in which polymerase briefly loses the connection to the template strand and reconnects at a different position (<xref rid="btaa140-B5" ref-type="bibr">Fazekas <italic>et al.</italic>, 2010</xref>). Further restrictions on the composition of the DNA construct are due to the cloning process: the GC content should be close to the GC percentage of the host genome and motifs used for the cloning process have to be avoided during the design of the DNA construct. The base composition of a DNA fragment is also an important factor for the successful retrieval of genetic information using DNA sequencing technologies. Illumina sequencing, Oxford Nanopore and PacBio sequencing technologies are biased toward DNA with an intermediate GC content, leading to reduced coverage of regions with strongly deviating GC content (<xref rid="btaa140-B16" ref-type="bibr">Laehnemann <italic>et al.</italic>, 2016</xref>). Illumina and Nanopore sequencers also show an increased error rate in the presence of homopolymers (<xref rid="btaa140-B16" ref-type="bibr">Laehnemann <italic>et al.</italic>, 2016</xref>). Depending on the sequencing method used, the resulting data show increased substitution rates for specific DNA patterns: for PacBio data, common substitution patterns are CG → CA and CG → TG, Nanopore data contain an increased amount of TAG → TGG and TAC → TGC substitutions (<xref rid="btaa140-B23" ref-type="bibr">Weirather <italic>et al.</italic>, 2017</xref>) and a common substitution pattern in Illumina data is GGG → GGT (<xref rid="btaa140-B21" ref-type="bibr">Schirmer <italic>et al.</italic>, 2016</xref>).</p>
  </sec>
  <sec>
    <title>2 MESA usage</title>
    <p>The main workflow of MESA is shown in <xref ref-type="fig" rid="btaa140-F1">Figure 1</xref>. Users can enter any DNA sequence or upload a FASTA file containing multiple sequences. For single short sequences, the results are either shown directly in the web browser or are sent via email when the calculation is finished. If longer and/or multiple sequences are used, notification by email is mandatory. The email contains UUID links for each evaluated sequence as well as FASTQ files of the input and the modified sequence(s) of the error simulation. Calculated error probabilities are displayed in the fourth line of each sequence entry, encoded in ASCII base 33, making them directly comparable to PHRED quality scores. The UUID points to the results page of a single sequence. By default, a UUID link is valid for 365 days, with registered users having the option to change the expiration date or to delete UUIDs of their results. The FASTQ files and UUID links are also available on the results page. Reproducibility is ensured by (i) the ability to download the configuration of the application in JSON format and (ii) by reporting the pseudo-random element of the error simulation in the form of a seed. The configuration file can be uploaded or dragged into the main window, allowing the reuse of prior configurations, while the seed can be entered into the main window to reproduce the results of the error simulation. To save configuration parameters without downloading the configuration file, users can register on the website. Registration is optional and only required for persistent configuration changes, API key generation, a history of completed evaluations and requests to validate user-defined undesired DNA motifs, error rates and error spectra.</p>
    <fig id="btaa140-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Main workflow of MESA: rectangles denote methods used by the web application and are available in the API, large arrows denote input/output. An extended flowchart of the workflow can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref></p>
      </caption>
      <graphic xlink:href="btaa140f1"/>
    </fig>
    <p>A fully documented REST API allows the incorporation of MESA evaluations into custom workflows for high-throughput evaluation and error simulation of DNA.</p>
    <sec>
      <title>2.1 Error probability estimation</title>
      <p>The web interface allows the use of error probability functions for the GC content, length of homopolymers and sequence repeats by manipulation of a graph. The GC error function and the identification of sequence repeats are applied to the complete query sequence as well as to sequence windows of user-defined length. We provide pre-defined error probabilities and descriptions for DNA motifs that are commonly used for cloning or have biological relevance that could hinder the cloning process. The user can adjust the error probability of each motif. It is also possible to add user-defined motifs with custom error probabilities and descriptions. To make a specific motif available for all users of the application, a request for validation can be performed. The validation process involves biologists reviewing each request if (i) the motif has biological relevance and (ii) the motif and the description match. A validation request can be sent via the simulation settings page.</p>
      <p>The prediction of secondary structures is based on RNAStructure (<xref rid="btaa140-B20" ref-type="bibr">Reuter and Mathews, 2010</xref>). Users can define the temperature at which the prediction should be carried out. The results are divided into cells for each analysis step and an overall error probability as the sum of all individual error probabilities per DNA region. The regions are color-coded according to their calculated error probability, while hovering over a specific region will show the error probability percentage for it. The predicted secondary structure with the highest probability is shown as dot-bracket notation, in which each base is represented by a character. Dots represent unpaired bases. An open parenthesis represents a base that is paired to another base ahead of it, while a closed parenthesis represents a base that is paired to another base behind it. It is also possible to download the predicted secondary structure as SVG image, PS image, PDF image, CT file or DOT file as well as the PFS distribution file (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Error simulation</title>
      <p>MESA also facilitates the simulation of synthesis, sequencing, PCR and storage, and uses either published or user-defined error rates and error spectra. All processes are optional and can be freely mixed and matched, allowing users to customize the simulation to their specific experimental structure and needs.</p>
      <p>The available synthesis error rates and spectra are shown in <xref rid="btaa140-T1" ref-type="table">Table 1</xref>, containing published error information for different combinations of synthesis methods and error correction methods. The PCR error rates are based on the employed polymerase and the number of PCR cycles that are simulated. We provide error rates for the polymerases <italic>Taq</italic>, <italic>Pfu</italic>, <italic>Pwo</italic> and <italic>Phusion</italic>, which are described by McInerney <italic>et al.</italic><xref rid="btaa140-B18" ref-type="bibr">(2014)</xref>. The storage simulation can be used to simulate mutations of host organisms during an adjustable time interval (<xref rid="btaa140-T2" ref-type="table">Table 2</xref>), <italic>in</italic> <italic>vitro</italic> depurination rates calculated using the equation described by <xref rid="btaa140-B1" ref-type="bibr">An <italic>et al.</italic> (2014)</xref> or the Kimura model of molecular evolution (<xref rid="btaa140-B13" ref-type="bibr">Kimura, 1980</xref>). Instead of using published mutation rates, users can also use the binary erasure channel or the additive white Gaussian noise channel for the storage simulation. The DNA sequencing process is simulated using error rates and error spectra of the Illumina single-read and paired-end sequencing methods (<xref rid="btaa140-B21" ref-type="bibr">Schirmer <italic>et al.</italic>, 2016</xref>), PacBio subread and CCS methods (<xref rid="btaa140-B23" ref-type="bibr">Weirather <italic>et al.</italic>, 2017</xref>) and Nanopore 1D and 2D methods (<xref rid="btaa140-B23" ref-type="bibr">Weirather <italic>et al.</italic>, 2017</xref>). The number of errors for a chosen method is calculated by multiplying the sequence length with the raw error rate of the method. The selected type of each error is based on the weights of each error class, positional weights or restrictions and a random number generator. The errors are applied sequentially, allowing for error cross-talk. For example, if a deletion led to the formation of a triplet with a high error probability, this triplet will be included in further error evaluations.</p>
      <table-wrap id="btaa140-T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Pre-defined DNA synthesis error profiles</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Method</th>
              <th rowspan="1" colspan="1">Error correction</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">CSO</td>
              <td rowspan="1" colspan="1">ErrASE</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CSO</td>
              <td rowspan="1" colspan="1">MutS</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CSO</td>
              <td rowspan="1" colspan="1">Consensus shuffle</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MBOP</td>
              <td rowspan="1" colspan="1">OH</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MBOP</td>
              <td rowspan="1" colspan="1">HTLH</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MBOP</td>
              <td rowspan="1" colspan="1">ErrASE</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MBOP</td>
              <td rowspan="1" colspan="1">NB</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MBOP</td>
              <td rowspan="1" colspan="1">NGS</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic>Source:</italic> Data based on Kosuri and Church <xref rid="btaa140-B15" ref-type="bibr">(2014)</xref>.</p>
          </fn>
          <fn id="tblfn2">
            <p>CSO, column synthesized oligos; MBOP, microarray-based oligo pools; OH, oligo hybridization-based error correction; HTLH, high-temperature ligation/hybridization-based error correction; NB, nuclease-based error correction; NGS, NGS-based error correction.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap id="btaa140-T2" orientation="portrait" position="float">
        <label>Table 2.</label>
        <caption>
          <p>Pre-defined mutation rates and spectra</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Host organism</th>
              <th rowspan="1" colspan="1">References</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>Escherichia coli</italic>
              </td>
              <td rowspan="1" colspan="1">Lee <italic>et al.</italic><xref rid="btaa140-B17" ref-type="bibr">(2012)</xref> and Sung <italic>et al.</italic><xref rid="btaa140-B22" ref-type="bibr">(2016)</xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>Saccharomyces cerevisiae</italic>
              </td>
              <td rowspan="1" colspan="1">Drake <italic>et al.</italic><xref rid="btaa140-B4" ref-type="bibr">(1998)</xref> and Sung <italic>et al.</italic><xref rid="btaa140-B22" ref-type="bibr">(2016)</xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>Mus musculus</italic>
              </td>
              <td rowspan="1" colspan="1">Drake <italic>et al.</italic><xref rid="btaa140-B4" ref-type="bibr">(1998)</xref> and Sung <italic>et al.</italic><xref rid="btaa140-B22" ref-type="bibr">(2016)</xref></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic>Homo sapiens</italic>
              </td>
              <td rowspan="1" colspan="1">Nachman and Crowell <xref rid="btaa140-B19" ref-type="bibr">(2000)</xref> and Sung <italic>et al.</italic><xref rid="btaa140-B22" ref-type="bibr">(2016)</xref></td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The final sequence including all simulated modifications is shown in a cell of the main results page and can optionally be downloaded in FASTQ format. Modifications are color-coded according to the process in which they occurred, deletions are represented by empty spaces. Hovering over a modified base shows the type of error (insertion, deletion or substitution) and the process that led to it. If multiple modifications of a single base occurred during simulation, the complete sequence of modifications is shown.</p>
      <p>For each of the simulated processes, the overall error rate, the distribution of errors between the error types deletions, insertions and substitutions, the rate of errors for each base, substitution patterns and the position of the occurrence of each error type can be adjusted using an intuitive interface. Furthermore, it is possible to send a validation request for custom error rates and error spectra, allowing all users access to the created simulation parameters.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Customization</title>
    <p>The creation of new rules for the error assessment or simulation can be achieved using the rule modification tools of the web application.</p>
    <sec>
      <title>3.1 Error probability estimation customization</title>
      <p>The web interface supports the creation of error probability functions for the GC content, length of homopolymers and repeating subsequences by either click and drag manipulation of a graph or by using the corresponding input fields (<xref ref-type="fig" rid="btaa140-F2">Fig. 2</xref>). The vertical positioning (and the horizontal positioning if the ‘Allow drag along <italic>X</italic>-axis’ option is enabled) of each point of the graph can be adjusted. Adding, modifying and deleting points are achieved by specifying the <italic>X</italic>-value of the point and activating the desired function. It is also possible to change the vertical position of multiple points. Custom undesired DNA motifs can be saved in the user profile for subsequent evaluations.</p>
      <fig id="btaa140-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Graph manipulation interface for the creation of custom error probability functions</p>
        </caption>
        <graphic xlink:href="btaa140f2"/>
      </fig>
    </sec>
    <sec>
      <title>3.2 Error simulation customization</title>
      <p>Rules for the simulation of synthesis, PCR, storage or sequencing errors can be added and existing rules can be used as templates for new rules by using the simulation rule modification tool (<xref ref-type="fig" rid="btaa140-F3">Fig. 3</xref>). A new rule contains at least a name, a raw error rate and the distribution of the different error types (insertion, deletion and substitution). The raw rate in the upper right corner of the tool is the probability of an error event per base. The distribution of the error types is adjusted using the sliders at the top of the tool. For deletions and insertions, sliders on the left side of the tool allow the adjustment of the probabilities to be deleted or inserted for each of the bases, while also allowing to specify the probability that this error occurs in a random position of the input or a homopolymeric region. The right-hand side of the rule modification tool can be used to create substitution rules and positional substitution rules. A substitution rule consists of the target DNA sequence with a length of at least one base, the number of possible substitutions for this target sequence, the sequences for which the target sequence is switched out and the probability for each substitution sequence to be inserted into the input instead of the target sequence. The positional range where substitution occurs can also be defined, which can be used to simulate positional biases in DNA processing methods. An example is given by Schirmer <italic>et al.</italic><xref rid="btaa140-B21" ref-type="bibr">(2016)</xref>, who observed an increased substitution of <italic>T</italic> at position 35 in R2 reads of Illumina data. Depurination rates for <italic>in</italic> <italic>vitro</italic> storage can be calculated for a given pH and temperature by clicking on the <italic>calculate in</italic> <italic>vitro rate</italic> button in the upper right corner of the storage rule customization interface. <xref ref-type="disp-formula" rid="E1">Equation 1</xref> (<xref rid="btaa140-B1" ref-type="bibr">An <italic>et al.</italic>, 2014</xref>) is used for the calculation of the depurination rates.
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mtable><mml:mtr><mml:mtd><mml:mtext>pH</mml:mtext><mml:mo>&lt;</mml:mo><mml:mn>2.5</mml:mn><mml:mo>,</mml:mo><mml:mi>lg</mml:mi><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>14.6</mml:mn><mml:mo>−</mml:mo><mml:mn>0.707</mml:mn><mml:mo>·</mml:mo><mml:mtext>pH</mml:mtext><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>5.63</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow><mml:mi>T</mml:mi></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>pH</mml:mtext><mml:mo>≥</mml:mo><mml:mn>2.5</mml:mn><mml:mo>,</mml:mo><mml:mi>lg</mml:mi><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>16.5</mml:mn><mml:mo>−</mml:mo><mml:mn>0.982</mml:mn><mml:mo>·</mml:mo><mml:mtext>pH</mml:mtext><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>5.85</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow><mml:mi>T</mml:mi></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <italic>T</italic> = absolute Temperature (in Kelvin) and <italic>k</italic> = depurination rate per base per second.</p>
      <fig id="btaa140-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Structure of the simulation rule modification tool for the customization of the DNA error simulation processes</p>
        </caption>
        <graphic xlink:href="btaa140f3"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Comparison with other tools</title>
    <p>To the best of our knowledge, tools for the evaluation of synthetic DNA are only available from sequencing or synthesis companies. These tools are closed source and specifically designed to evaluate DNA sequences according to the methods used by the company without allowing users to customize evaluation parameters.</p>
    <p>Existing tools for the simulation of DNA mutation events in the literature are predominantly used to test the main algorithm of a publication <italic>in silico</italic>. Since these tools are not the main focus, they contain only rudimentary functionality and do not offer customization options. Balado <xref rid="btaa140-B2" ref-type="bibr">(2013)</xref> used the Kimura model of molecular evolution to obtain the Shannon capacity of DNA data embedding. To evaluate two algorithms for data embedding, <xref rid="btaa140-B2" ref-type="bibr">Haughton and Balado (2013)</xref> also used the Kimura model. <xref rid="btaa140-B7" ref-type="bibr">Heider and Barnekow (2007</xref>, <xref rid="btaa140-B8" ref-type="bibr">2008</xref>, <xref rid="btaa140-B9" ref-type="bibr">2011</xref>) and <xref rid="btaa140-B11" ref-type="bibr">Heider <italic>et al.</italic> (2009)</xref> used a similar approach, combining either prokaryotic or eukaryotic mutation rates with base-pair specific mutation rates. Moreover, <xref rid="btaa140-B10" ref-type="bibr">Heider <italic>et al.</italic> (2008)</xref> evaluated recombination events in sexually reproducing organisms with respect to DNA watermarking. Nevertheless, these models only account for substitutions of single bases, without accounting for indels and do not include position-based mutation simulation or pattern substitutions. Customization of these tools is strongly limited, tools that contain pseudo-random elements have no mechanisms to ensure reproducibility, and no tool exists that allows users to create and share new rules.</p>
  </sec>
  <sec>
    <title>5 Validation</title>
    <p>User-defined error simulation parameters, undesired subsequences as well as error functions for the homopolymer, GC content and repeating subsequence evaluations can be saved in the user’s profile or exported as a JSON file. It is also possible to request validation for custom content. The following aspects influence the validation process: (i) accompanied references, (ii) biological relevance, (iii) mathematical correctness and (iv) description. Validated content is permanently available for all users, making MESA flexible to be used for different fields and applications.</p>
  </sec>
  <sec>
    <title>6 REST API</title>
    <p>Each registered user can generate an API key to directly access methods used for the evaluation of DNA sequences and the simulation of errors during DNA processing methods. Methods that are available in the API and a brief summary of each method are shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S7</xref>.</p>
  </sec>
  <sec>
    <title>7 Deployment and administration</title>
    <p>The MESA source code is freely available at <ext-link ext-link-type="uri" xlink:href="http://github.com/umr-ds/dna_sim">github.com/umr-ds/dna_sim</ext-link>, containing instructions for application deployment. After deployment, the first user created will have full administration rights and access to an administration interface with options to confirm or deny validation requests and user management settings.</p>
    <p>User information is stored in the Docker network internal PostgreSQL database, with each entry containing (i) a user-ID, (ii) the email address of the user, (iii) a hash value of the user’s password and (iv) information related to the user’s access rights. The algorithm used for password hashing is bcrypt. User accounts can be deleted in the user profile. This action removes all information saved for the corresponding user in the database.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btaa140_Supplementary_Data</label>
      <media xlink:href="btaa140_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgement</title>
    <p>The authors want to thank Janik Mesch for his contributions to the code base.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the LOEWE program of the State of Hesse (Germany) in the MOSLA research cluster.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa140-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>An</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Non-enzymatic depurination of nucleic acids: factors and mechanisms</article-title>. <source>PLoS One</source>, <volume>9</volume>, <fpage>e115950</fpage>.<pub-id pub-id-type="pmid">25546310</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Balado</surname><given-names>F.</given-names></name></person-group> (<year>2013</year>) 
<article-title>Capacity of DNA data embedding under substitution mutations</article-title>. <source>IEEE Trans. Inf. Theory</source>, <volume>59</volume>, <fpage>928</fpage>–<lpage>941</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa140-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ceze</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Molecular digital data storage using DNA</article-title>. <source>Nat. Rev. Genet</source>., <volume>20</volume>, <fpage>456</fpage>–<lpage>466</lpage>.<pub-id pub-id-type="pmid">31068682</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Drake</surname><given-names>J.W.</given-names></name></person-group><etal>et al</etal> (<year>1998</year>) 
<article-title>Rates of spontaneous mutation</article-title>. <source>Genetics</source>, <volume>148</volume>, <fpage>1667</fpage>–<lpage>1686</lpage>.<pub-id pub-id-type="pmid">9560386</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fazekas</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Improving sequencing quality from PCR products containing long mononucleotide repeats</article-title>. <source>BioTechniques</source>, <volume>48</volume>, <fpage>277</fpage>–<lpage>285</lpage>.<pub-id pub-id-type="pmid">20569204</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Haughton</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Balado</surname><given-names>F.</given-names></name></person-group> (<year>2013</year>) 
<article-title>BioCode: two biologically compatible algorithms for embedding data in non-coding and coding regions of DNA</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>, <fpage>121</fpage>.<pub-id pub-id-type="pmid">23570444</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Heider</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Barnekow</surname><given-names>A.</given-names></name></person-group> (<year>2007</year>) 
<article-title>DNA-based watermarks using the DNA-crypt algorithm</article-title>. <source>BMC Bioinformatics</source>, <volume>8</volume>, <fpage>176</fpage>.<pub-id pub-id-type="pmid">17535434</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Heider</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Barnekow</surname><given-names>A.</given-names></name></person-group> (<year>2008</year>) 
<article-title>DNA watermarks: a proof of concept</article-title>. <source>BMC Mol. Biol</source>., <volume>9</volume>, <fpage>40</fpage>.<pub-id pub-id-type="pmid">18426578</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Heider</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Barnekow</surname><given-names>A.</given-names></name></person-group> (<year>2011</year>) 
<article-title>DNA watermarking: challenging perspectives for biotechnological applications</article-title>. <source>Curr. Bioinformatics</source>, <volume>6</volume>, <fpage>375</fpage>–<lpage>382</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa140-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Heider</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Watermarking sexually reproducing diploid organisms</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>1961</fpage>–<lpage>1962</lpage>.<pub-id pub-id-type="pmid">18599517</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Heider</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>DNA watermarks in non-coding regulatory sequences</article-title>. <source>BMC Res. Notes</source>, <volume>2</volume>, <fpage>125</fpage>.<pub-id pub-id-type="pmid">19583865</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jensen</surname><given-names>M.A.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>DMSO and betaine greatly improve amplification of GC-rich constructs in de novo synthesis</article-title>. <source>PLoS One</source>, <volume>5</volume>, <fpage>e11024</fpage>.<pub-id pub-id-type="pmid">20552011</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kimura</surname><given-names>M.</given-names></name></person-group> (<year>1980</year>) 
<article-title>A simple method for estimating evolutionary rates of base substitutions through comparative studies of nucleotide sequences</article-title>. <source>J. Mol. Evol</source>., <volume>16</volume>, <fpage>111</fpage>–<lpage>120</lpage>.<pub-id pub-id-type="pmid">7463489</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kitada</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Programming gene and engineered-cell therapies with synthetic biology</article-title>. <source>Science</source>, <volume>359</volume>, <fpage>eaad1067</fpage>.<pub-id pub-id-type="pmid">29439214</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kosuri</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Church</surname><given-names>G.M.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Large-scale de novo DNA synthesis: technologies and applications</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>499</fpage>–<lpage>507</lpage>.<pub-id pub-id-type="pmid">24781323</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Laehnemann</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Denoising DNA deep sequencing data—high-throughput sequencing errors and their correction</article-title>. <source>Brief. Bioinformatics</source>, <volume>17</volume>, <fpage>154</fpage>–<lpage>179</lpage>.<pub-id pub-id-type="pmid">26026159</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Rate and molecular spectrum of spontaneous mutations in the bacterium <italic>Escherichia coli</italic> as determined by whole-genome sequencing</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>109</volume>, <fpage>E2774</fpage>–<lpage>E2783</lpage>.<pub-id pub-id-type="pmid">22991466</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McInerney</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Error rate comparison during polymerase chain reaction by DNA polymerase</article-title>. <source>Mol. Biol. Int</source>., <volume>2014</volume>, <fpage>1</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa140-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nachman</surname><given-names>M.W.</given-names></name>, <name name-style="western"><surname>Crowell</surname><given-names>S.L.</given-names></name></person-group> (<year>2000</year>) 
<article-title>Estimate of the mutation rate per nucleotide in humans</article-title>. <source>Genetics</source>, <volume>156</volume>, <fpage>297</fpage>–<lpage>304</lpage>.<pub-id pub-id-type="pmid">10978293</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Reuter</surname><given-names>J.S.</given-names></name>, <name name-style="western"><surname>Mathews</surname><given-names>D.H.</given-names></name></person-group> (<year>2010</year>) 
<article-title>RNAstructure: software for RNA secondary structure prediction and analysis</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>129</fpage>.<pub-id pub-id-type="pmid">20230624</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schirmer</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Illumina error profiles: resolving fine-scale variation in metagenomic sequencing data</article-title>. <source>BMC Bioinformatics</source>, <volume>17</volume>, <fpage>125</fpage>.<pub-id pub-id-type="pmid">26968756</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sung</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Evolution of the insertion-deletion mutation rate across the tree of life</article-title>. <source>G3</source>, <volume>6</volume>, <fpage>2583</fpage>–<lpage>2591</lpage>.<pub-id pub-id-type="pmid">27317782</pub-id></mixed-citation>
    </ref>
    <ref id="btaa140-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weirather</surname><given-names>J.L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Comprehensive comparison of Pacific Biosciences and Oxford Nanopore Technologies and their applications to transcriptome analysis</article-title>. <source>F1000Res</source>., <volume>6</volume>, <fpage>100</fpage>.<pub-id pub-id-type="pmid">28868132</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
