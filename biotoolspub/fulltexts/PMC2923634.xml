<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2923634</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-11-403</article-id>
    <article-id pub-id-type="pmid">20667133</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-11-403</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Data reduction for spectral clustering to analyze high throughput flow cytometry data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Zare</surname>
          <given-names>Habil</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>zare@cs.ubc.ca</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Shooshtari</surname>
          <given-names>Parisa</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>pshoosht@bccrc.ca</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Gupta</surname>
          <given-names>Arvind</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>arvind@mitacs.math.ca</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A4">
        <name>
          <surname>Brinkman</surname>
          <given-names>Ryan R</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>rbrinkman@bccrc.ca</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Computing Science, University of British Columbia, Vancouver, BC, Canada</aff>
    <aff id="I2"><label>2</label>Terry Fox Laboratory, BC Cancer Agency, 675 W 10th Ave., Vancouver, BC, Canada</aff>
    <aff id="I3"><label>3</label>Faculty of Science, University of British Columbia, Vancouver, BC, Canada</aff>
    <aff id="I4"><label>4</label>Department of Medical Genetics, University of British Columbia, Vancouver, BC, Canada</aff>
    <pub-date pub-type="collection">
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>28</day>
      <month>7</month>
      <year>2010</year>
    </pub-date>
    <volume>11</volume>
    <fpage>403</fpage>
    <lpage>403</lpage>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>12</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>7</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2010 Zare et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <copyright-holder>Zare et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/11/403"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Recent biological discoveries have shown that clustering large datasets is essential for better understanding biology in many areas. Spectral clustering in particular has proven to be a powerful tool amenable for many applications. However, it cannot be directly applied to large datasets due to time and memory limitations. To address this issue, we have modified spectral clustering by adding an information preserving sampling procedure and applying a post-processing stage. We call this entire algorithm SamSPECTRAL.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We tested our algorithm on flow cytometry data as an example of large, multidimensional data containing potentially hundreds of thousands of data points (<italic>i.e</italic>., "events" in flow cytometry, typically corresponding to cells). Compared to two state of the art model-based flow cytometry clustering methods, SamSPECTRAL demonstrates significant advantages in proper identification of populations with non-elliptical shapes, low density populations close to dense ones, minor subpopulations of a major population and rare populations.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>This work is the first successful attempt to apply spectral methodology on flow cytometry data. An implementation of our algorithm as an R package is freely available through BioConductor.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>High throughput data analysis is a crucial step in research endeavours involving gene expression, protein classification, and flow cytometry. A classical approach for analysing biological data is to first group individual data points based on some similarity criterion, a process known as clustering, and then compare the outcome of clustering with the biological hypotheses. An example of this approach is in the analysis of flow cytometry data where populations of cells that express specific intracellular or surface proteins are identified. Flow cytometry is a technique for measuring physical, chemical and biological characteristics of individual microscopic particles such as cells and chromosomes. It has many applications in molecular and cell biology for both clinical diagnosis and research purposes [<xref ref-type="bibr" rid="B1">1</xref>]. In cytometers, cells are individually passed through a laser beam and the scattered light is captured to measure up to 19 characteristic of each cell [<xref ref-type="bibr" rid="B2">2</xref>]. As thousands of cells can be analyzed per second, cytometers can generate large-sized datasets. Recently, sophisticated methods have been developed for automatic analysis of flow cytometry data [<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B5">5</xref>]. The proposed clustering techniques include: mixture modeling approach [<xref ref-type="bibr" rid="B6">6</xref>], model-based cluster analysis [<xref ref-type="bibr" rid="B7">7</xref>], feature-guided clustering [<xref ref-type="bibr" rid="B8">8</xref>], density-based clustering [<xref ref-type="bibr" rid="B9">9</xref>], combining the curvature information with density information [<xref ref-type="bibr" rid="B10">10</xref>], and image processing [<xref ref-type="bibr" rid="B11">11</xref>]. The automatic techniques are useful in clinical and research applications such as: application of high-content flow cytometric screening (FC-HCS) to the problem of cellular signature definition for acute graft-versus-host-disease [<xref ref-type="bibr" rid="B12">12</xref>], vaccine trials [<xref ref-type="bibr" rid="B13">13</xref>], visualizing data in stem cell research [<xref ref-type="bibr" rid="B14">14</xref>], and immunophenotypic characterization of B-cell chronic lymphoproliferative disorders (B-CLPD) [<xref ref-type="bibr" rid="B15">15</xref>].</p>
    <sec>
      <title>Problem Statement</title>
      <p>Automated identification of flow cytometry cell populations is complicated by overlapping and adjacent populations, especially when low and high density populations are close to each other. Analysing such data requires clustering methods that can separate these populations. Non-parametric methods include density clustering [<xref ref-type="bibr" rid="B16">16</xref>], real-time adaptive clustering [<xref ref-type="bibr" rid="B17">17</xref>], and Kohonen self-organizing maps [<xref ref-type="bibr" rid="B18">18</xref>]. The application of these methods is restricted since the first two are subjective due to a dependency on user-defined thresholds, and the latter one requires the number of clusters to be determined by the user. While accurately determining the number of clusters may not be a key issue in some clinical cytometry analysis [<xref ref-type="bibr" rid="B19">19</xref>], this requirement can be a critical obstacle for other analyses such as identifying novel populations for biomarker discovery [<xref ref-type="bibr" rid="B3">3</xref>].</p>
      <p>Model-based clustering techniques such as FLAME [<xref ref-type="bibr" rid="B20">20</xref>], flowClust [<xref ref-type="bibr" rid="B21">21</xref>] and flowMerge [<xref ref-type="bibr" rid="B22">22</xref>] have been developed to improve results. flowMerge uses the flowClust framework to identify clusters based on a t-mixture model methodology, followed by a merging step to account for overestimation of the number of clusters by the Bayesian information criterion. FLAME uses a skew t-mixture model, which is in theory more robust to skew, because unlike t-distributions, skew t-distributions can be asymmetric [<xref ref-type="bibr" rid="B20">20</xref>]. However, the running time of this algorithm increases with the fourth degree of the number of dimensions. In practice this tends to make the algorithm impractical for more than five dimensions, while flow cytometry data can have up to 19 dimensions. Overall, the major drawback of these parametric methods is the requirement for assumptions on either the size of the clusters or the cluster distributions and shapes [<xref ref-type="bibr" rid="B23">23</xref>], which could result in incorrect identification of biologically interesting populations. In addition, one challenge for existing approaches is the identification of rare populations. Spectral clustering is a non-parametric clustering method that avoids the problems of estimating probability distribution functions by using a heuristic based on graphs [<xref ref-type="bibr" rid="B24">24</xref>]. It has proved useful in many pattern recognition areas [<xref ref-type="bibr" rid="B25">25</xref>-<xref ref-type="bibr" rid="B28">28</xref>]. Not only does it not require <italic>a priori </italic>assumptions on the size, shape or distribution of clusters, but it has features that make it particularly well-suited to clustering biological data:</p>
      <p>• It is not sensitive to outliers, noise or shape of clusters;</p>
      <p>• It is adjustable so that biological knowledge can be utilized to adapt it for a specific problem or dataset;</p>
      <p>• There is mathematical evidence to guarantee its proper performance [<xref ref-type="bibr" rid="B29">29</xref>].</p>
      <p>Two main challenges in applying spectral clustering algorithm on large data sets are the computationally expensive steps of constructing the normalized matrix and computing its eigenspace. For instance, for high throughput biological data containing one million data points (<italic>i.e</italic>., vertices), it requires computing eigenspace of a million by million matrix, which is infeasible in terms of memory and time. Although there are some approximation methods for speeding up this computation [<xref ref-type="bibr" rid="B30">30</xref>,<xref ref-type="bibr" rid="B31">31</xref>], these could produce undesired errors in the final results. The problem of applying this algorithm on large datasets has been studied in [<xref ref-type="bibr" rid="B32">32</xref>] using Nyström's method. They suggest a strategy of sampling data uniformly, clustering the sampled points and extrapolating this solution to the full set of points. However, sampling data uniformly can miss low-density populations entirely when the density of adjacent populations varies considerably, a situation that often arises for biologically interesting populations in flow cytometry data. Appendix 3 includes an experiment to explain the effect of uniform sampling in such cases.</p>
      <p>Data reduction schemes have been developed to reduce the complexity of the flow cytometry data while preserving the information [<xref ref-type="bibr" rid="B33">33</xref>,<xref ref-type="bibr" rid="B34">34</xref>]. These methods reduce the dimensionality but not the size of the dataset, the latter being the more important bottleneck for spectral clustering.</p>
    </sec>
    <sec>
      <title>Our Approach</title>
      <p>We hypothesized that spectral clustering could significantly improve high throughput biological data analysis. However, serious empirical barriers are encountered when applying this method to large data sets. Specifically, for <italic>n </italic>data points, the running time is <italic>O</italic>(<italic>n</italic><sup>3</sup>), requiring <italic>O</italic>(<italic>n<sup>2</sup></italic>) units of memory. For instance, it would take 2 years and 5 terabytes of memory to analyze a typical flow cytometry sample with 300,000 events. We developed a novel solution for this problem through our non-uniform information preserving sampling. Our heuristic approach is specific to cytometry applications and made it possible for the first time, to apply spectral clustering method on flow cytometry data.</p>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <p>In this paper, we distinguish between the terms biological populations, clusters and components as follows. A <italic>population </italic>is a set of cells with similar functionality or molecular content. By a <italic>cluster</italic>, we mean a set of data points that are grouped together by spectral clustering algorithm. We incorporate a post-processing stage on spectral clusters to find the <italic>connected components </italic>intended to estimate the biological populations.</p>
    <sec>
      <title>Algorithm</title>
      <sec>
        <title>Spectral Clustering</title>
        <p>The first step is to build a graph. The vertices represent the <italic>n </italic>data points (<italic>e.g</italic>., cells in flow cytometry data), and the edges between the vertices are weighted based on some <italic>similarity </italic>criterion. The adjacency matrix of the graph is then normalized using the following formula:</p>
        <p>
          <disp-formula id="bmcM1">
            <label>(1)</label>
            <mml:math id="M1" name="1471-2105-11-403-i1" overflow="scroll">
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mi>A</mml:mi>
                  <mml:mo>ƒ</mml:mo>
                </mml:mover>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mi>D</mml:mi>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mn>2</mml:mn>
                    </mml:mfrac>
                  </mml:mrow>
                </mml:msup>
                <mml:mi>A</mml:mi>
                <mml:msup>
                  <mml:mi>D</mml:mi>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mfrac>
                      <mml:mn>1</mml:mn>
                      <mml:mn>2</mml:mn>
                    </mml:mfrac>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>A </italic>is the adjacency matrix of the graph and <italic>D </italic>is a diagonal matrix where the (<italic>i</italic>, <italic>i</italic>) entry is equal to the sum of the weights on the edges that are adjacent to vertex <italic>i</italic>.</p>
        <p>The next step is to compute eigenspace of the normalized matrix. That is, all vectors <italic>V<sub>i </sub></italic>and values <italic>λ<sub>i </sub></italic>satisfying the following equation are computed:</p>
        <p>
          <disp-formula id="bmcM2">
            <label>(2)</label>
            <mml:math id="M2" name="1471-2105-11-403-i2" overflow="scroll">
              <mml:mrow>
                <mml:mover accent="true">
                  <mml:mi>A</mml:mi>
                  <mml:mo>ƒ</mml:mo>
                </mml:mover>
                <mml:msub>
                  <mml:mrow>
                    <mml:mover accent="true">
                      <mml:mi>V</mml:mi>
                      <mml:mo stretchy="true">→</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mi>λ</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mover accent="true">
                  <mml:mi>V</mml:mi>
                  <mml:mo stretchy="true">→</mml:mo>
                </mml:mover>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>In order to find <italic>k </italic>clusters, an <italic>n </italic>by <italic>k </italic>matrix is built using the <italic>k </italic>eigenvectors with highest eigenvalues. The rows of this matrix are normalized and finally k-means is used to cluster the rows.</p>
        <p>However, the above method cannot be directly applied to flow cytometry data due to large number of data points (cells) per sample. Our solution for this problem is a data reduction scheme developed specifically for this purpose. This reduces the number of vertices significantly, but in a way such that biological information can be preserved by updating the weights on the edges.</p>
      </sec>
      <sec>
        <title>Data Reduction Scheme</title>
        <p>While data size can be reduced by known sampling methods [<xref ref-type="bibr" rid="B35">35</xref>], a very delicate method should be used to preserve biologically important information. From a high-level perspective, our data reduction scheme (Figure <xref ref-type="fig" rid="F1">1</xref>) consists of two major steps; first we sample the data in a representative manner to reduce the number of vertices of the graph (Figure <xref ref-type="fig" rid="F1">1b</xref>). Sample points cover the whole data space uniformly (Figures <xref ref-type="fig" rid="F2">2b</xref>), a property that aids in the identification of both low density and rare populations. In the second step as described below, we define a similarity matrix that assigns weights to the edges between the sampled data points. Higher weights are assigned to the edges between nodes in dense regions so that information about the density is preserved (Figure <xref ref-type="fig" rid="F1">1c</xref>).</p>
        <fig id="F1" position="float">
          <label>Figure 1</label>
          <caption>
            <p><bold>Data reduction scheme</bold>. (a) Running spectral clustering is impractical on data that contains thousands of points. (b) Faithful sampling picks up a reasonable subset of points such that running spectral clustering is possible on them. However, all information about the local density is lost by considering only these sample points. (c) We assign weights to the edges of the graph; the edges between the nodes in denser regions are weighted considerably higher. The information about the local density is retrieved in this way.</p>
          </caption>
          <graphic xlink:href="1471-2105-11-403-1"/>
        </fig>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p><bold>Faithful sampling</bold>. (a) Original data from telomere data set before sampling. (b) The distribution of representatives is almost uniform in the space after faithful sampling.</p>
          </caption>
          <graphic xlink:href="1471-2105-11-403-2"/>
        </fig>
        <p>Faithful Sampling Algorithm</p>
        <p>1. Label all data points as <italic>unregistered</italic>.</p>
        <p>2. <bold>repeat</bold></p>
        <p>3.    Pick a random unregistered point <italic>p </italic> {the representative of a new community}</p>
        <p>4.    Label all unregistered data points within distance <italic>h </italic>from <italic>p </italic>as <italic>registering</italic></p>
        <p>5.    Put registering points in a set called <italic>community p</italic></p>
        <p>6.    Relabel registering points as <italic>registered</italic></p>
        <p>7. <bold>until </bold>All points are registered</p>
        <p>8. <bold>return </bold>All communities</p>
        <p>After faithful sampling is completed, the set of all representatives can be regarded as a sample from the data. Reducing the value of parameter <italic>h </italic>will increase the number of sample points, resulting in increased computation time and required memory. Conversely, increasing <italic>h </italic>will result in fewer sample points that may lead to too low a resolution. In such a case, the computed spectral clusters may fail to estimate the real cell populations appropriately. In our implementation, we use an iterative procedure (explained in the overview of our algorithm) to adjust <italic>h </italic>automatically such that the number of representatives will be in range 1500-3000. As a result of this adjustment, the following two objectives are achieved. First, computing the eigenspace of a graph with a number of points in this range is feasible, (it takes less than one minute by a 2.7 GHz processor.) Second, the communities are "small" (Figure <xref ref-type="fig" rid="F2">2</xref>) and the resulting resolution is high enough such that no biologically interesting information is lost.</p>
        <p>In the sampling stage, there is no preference in picking up the next data point, therefore, the final distribution of the sampled points will be uniform in the "effective" space. That is, the representatives are distributed almost uniformly in the space where data points were present (Figure <xref ref-type="fig" rid="F2">2</xref>). As a consequence, by repeating sampling procedure the final results of clustering will not change significantly. This observation is confirmed quantitatively in Appendix 1. By considering just the representatives, density information is effectively ignored so working directly with these representatives results in improper outcome. On the other hand, some biological information from the original data is preserved by the above algorithm that can be retrieved to guide the clustering algorithm. More precisely, for each sample point, we know the list of all points in its neighbourhood (<italic>i.e</italic>., the <italic>members </italic>of the corresponding community). In the next stage, we use this information to define the similarity between two sample points to modify the behaviour of spectral clustering. In this sense, our sampling scheme is <italic>faithful</italic>, meaning that the valuable biological information from the original data points is preserved even after sampling. We call the overall procedure, which consists of faithful sampling, computing modified similarity matrix and spectral clustering, SamSPECTRAL clustering.</p>
      </sec>
      <sec>
        <title>Similarity Matrix</title>
        <p>In this study, we use the following heat kernel formula [<xref ref-type="bibr" rid="B36">36</xref>] to compute the similarity between two vertices <italic>i </italic>and <italic>j:</italic></p>
        <p>
          <disp-formula id="bmcM3">
            <label>(3)</label>
            <mml:math id="M3" name="1471-2105-11-403-i3" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>s</mml:mi>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mi>e</mml:mi>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mi mathvariant="script">D</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>p</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mi>p</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:msup>
                          <mml:mi>σ</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <inline-formula><mml:math id="M4" name="1471-2105-11-403-i4" overflow="scroll"><mml:mi mathvariant="script">D</mml:mi></mml:math></inline-formula> (<italic>p<sub>i</sub>, p<sub>j</sub></italic>) is the Euclidean distance between them. <italic>σ </italic>is a scaling parameter that controls how rapidly similarity between <italic>p<sub>i </sub></italic>and <italic>p<sub>j </sub></italic>falls off with increasing distance. We define the similarity between two communities <italic>c </italic>and <italic>c' </italic>as the sum of all pairwise similarities between all members of the first community and all members of the second community. That is,</p>
        <p>
          <disp-formula id="bmcM4">
            <label>(4)</label>
            <mml:math id="M5" name="1471-2105-11-403-i5" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>S</mml:mi>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msup>
                      <mml:mi>c</mml:mi>
                      <mml:mo>′</mml:mo>
                    </mml:msup>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munder>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:msup>
                            <mml:mi>c</mml:mi>
                            <mml:mo>′</mml:mo>
                          </mml:msup>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>s</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>i </italic>and <italic>j </italic>are members of <italic>c </italic>and <italic>c' </italic>respectively.</p>
        <p>We do not normalize the similarity by dividing the above sum by the size of communities because we would lose valuable biological information that is supposed to be preserved. In short, the size of the communities determines the local density of the data points, which is biologically of great importance.</p>
        <p>The above definition is motivated by the following intuition from potential theory that explains how biological information is preserved after faithful sampling by assigning similarities in this way. The eigenvectors of a graph are interpreted as potential functions on the electric network modeled by the graph [<xref ref-type="bibr" rid="B37">37</xref>]. Assuming the radius of each community is small enough, the potential values of the community members are almost the same. On the other hand, in potential theory, the equivalent conductance between a group of nodes {<italic>v<sub>i</sub></italic>} with equal potential values and another group of nodes {<italic>w<sub>j</sub></italic>} that also have equal potential values is computed by the summation of pairwise conductance between nodes <italic>v<sub>i </sub></italic>and <italic>w<sub>j </sub></italic>for all <italic>i </italic>and <italic>j</italic>. Since in our model, the similarity between two vertices is equivalent to the conductance between the corresponding electrical nodes, it is reasonable to sum up pairwise similarities to estimate the equivalent similarity between communities (Figure <xref ref-type="fig" rid="F3">3a</xref>).</p>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p><bold>Defining the similarity between two communities and identifying the number of clusters</bold>. (a) We define the similarity between two communities <italic>c </italic>and <italic>c' </italic>as the sum of pairwise similarities between the members of <italic>c </italic>and the members of <italic>c'</italic>. (b) This figure shows the largest eigenvalues of a sample from the stem cell dataset. The number of clusters is estimated according to the knee point of eigenvalues curve. This point is defined as the intersection of the above regression line and the line <italic>y </italic>= 1. The horizontal coordinate of the knee point estimates the number of spectral clusters.</p>
          </caption>
          <graphic xlink:href="1471-2105-11-403-3"/>
        </fig>
      </sec>
      <sec>
        <title>Number of Clusters</title>
        <p>The number of clusters must be determined before running the spectral clustering algorithm [<xref ref-type="bibr" rid="B38">38</xref>]. To find this number automatically and in an efficient manner, we propose a method that is motivated by the following observation from spectral graph theory:</p>
        <p><bold>Theorem </bold>[<xref ref-type="bibr" rid="B39">39</xref>]: The number of connected partitions of a graph is equal to the number of eigenvectors with eigenvalue 1.</p>
        <p>We observed that typically for flow cytometry data, if <italic>σ </italic>is adjusted properly as explained in the SamSPECTRAL package vignette [<xref ref-type="bibr" rid="B40">40</xref>], the first few eigenvalues are close to one and at a point we call <italic>knee point </italic>they start to decrease almost linearly. We compute the knee point by applying linear regression to the eigenvalues curve (Figure <xref ref-type="fig" rid="F3">3b</xref>) and use the horizontal coordinate of this point as a rough estimate for the number of spectral clusters.</p>
      </sec>
      <sec>
        <title>Combining Clusters</title>
        <p>Applying spectral clustering on sampled data results in graph partitioning, which is almost optimum in the sense of having minimum normalized cut [<xref ref-type="bibr" rid="B41">41</xref>,<xref ref-type="bibr" rid="B42">42</xref>]. However, in some cases, a biologically interesting population might be split into two or more smaller clusters by SamSPECTRAL. We addressed this issue by adding a post-processing stage wherein the partitions of a population are combined based on known properties of flow cytometry cell populations. Typically, biologically meaningful cell populations in flow cytometry data have their highest density at the centre, and their density decreases towards the border of the population. Since higher density regions indicate communities with relatively more members, the conductance between them is expected to be relatively higher (Equation 4). Thus, similarity between communities is higher in regions with higher densities and the highest similarity is expected to be at the centre of the biological population. This observation forms the basis for our criterion for combining clusters. Specifically, similarity between communities determines the weight on graph edges and we define the maximum weight of the edges of a spectral cluster as <italic>within similarity </italic>of that cluster. Also, the maximum weight of the edges between two different spectral clusters is defined as <italic>between similarity</italic>. If the ratio of <italic>between similarity </italic>to <italic>within similarity </italic>is greater than a predefined threshold (<italic>separation factor</italic>), we conclude that these clusters are partitions of a single population, and should combine them to form a component. We repeat this stage until no two components can be combined. The final components computed in this way are called connected components of the data, and estimate the real biological populations. With smaller separation factors, spectral clusters tend to combine more often.</p>
      </sec>
      <sec>
        <title>Overview of SamSPECTRAL Algorithm</title>
        <p>In summary, the stages of our algorithm are as follows, assuming the data contains <italic>n </italic>points in a <italic>d </italic>dimensional space of volume <italic>V</italic>, and the parameters <italic>m </italic>(max number of communities), <italic>σ </italic>(scaling parameter), and separation factor are set properly.</p>
        <p>1. Sampling:</p>
        <p>(a) Let <inline-formula><mml:math id="M6" name="1471-2105-11-403-i6" overflow="scroll"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mroot><mml:mrow><mml:mfrac><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mi>d</mml:mi></mml:mroot></mml:mrow></mml:math></inline-formula>.</p>
        <p>(b) <bold>Repeat:</bold></p>
        <p>• Run faithful (biological information preserving) sampling algorithm. Suppose <italic>m' </italic>communities are built.</p>
        <p>• Update: <inline-formula><mml:math id="M7" name="1471-2105-11-403-i7" overflow="scroll"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mroot><mml:mrow><mml:mfrac><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mi>d</mml:mi></mml:mroot></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
        <p><bold>Until </bold><inline-formula><mml:math id="M8" name="1471-2105-11-403-i8" overflow="scroll"><mml:mrow><mml:mfrac><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>≤</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≤</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
        <p>2. Compute the similarities between communities by adding pairwise similarities <italic>s<sub>i</sub></italic>, <italic><sub>j </sub></italic>defined by <bold>3:</bold></p>
        <p>
          <disp-formula id="bmcM5">
            <label>(5)</label>
            <mml:math id="M9" name="1471-2105-11-403-i9" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>S</mml:mi>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msup>
                      <mml:mi>c</mml:mi>
                      <mml:mo>′</mml:mo>
                    </mml:msup>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munder>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:msup>
                            <mml:mi>c</mml:mi>
                            <mml:mo>′</mml:mo>
                          </mml:msup>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>s</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>3. Build a graph wherein each community is a vertex. Put edges between all pairs of vertices and weight them by similarity between corresponding communities.</p>
        <p>4. Analyze the spectrum of the above graph to find the clusters;</p>
        <p>(a) Normalize the adjacency matrix of the graph according to Equation 1.</p>
        <p>(b) Compute the eigenspace of the graph and set <italic>k</italic>, number of clusters, according to the knee point of eigenvalues curve.</p>
        <p>(c) Run classical spectral clustering algorithm to find <italic>k </italic>clusters.</p>
        <p>5. Combine the clusters to find connected components:</p>
        <p>(a) Initiate the list of components equal to the list of spectral clusters.</p>
        <p>(b) <bold>Repeat:</bold></p>
        <p>• For any pairs of components <italic>C<sub>i</sub></italic>, <italic>C<sub>j </sub></italic>, set:</p>
        <p>
          <disp-formula id="bmcM6">
            <label>(6)</label>
            <mml:math id="M10" name="1471-2105-11-403-i10" overflow="scroll">
              <mml:mrow>
                <mml:mtext>separation</mml:mtext>
                <mml:mo>_</mml:mo>
                <mml:mtext>ratio</mml:mtext>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mtext>between</mml:mtext>
                    <mml:mo>_</mml:mo>
                    <mml:mtext>simi</mml:mtext>
                    <mml:mn>1</mml:mn>
                    <mml:mtext>arity</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>C</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>C</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mtext>within</mml:mtext>
                      </mml:mrow>
                      <mml:mo>_</mml:mo>
                    </mml:msub>
                    <mml:mtext>simi</mml:mtext>
                    <mml:mn>1</mml:mn>
                    <mml:mtext>arity</mml:mtext>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>C</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>C</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>• For each component <italic>C<sub>i</sub></italic>, compute:</p>
        <p>
          <disp-formula>
            <mml:math id="M11" name="1471-2105-11-403-i11" overflow="scroll">
              <mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:munder>
                  <mml:mrow>
                    <mml:mi>max</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mo>≠</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:munder>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mtext>separation</mml:mtext>
                <mml:mo>_</mml:mo>
                <mml:mtext>ratio</mml:mtext>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>C</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:mtext> </mml:mtext>
                <mml:msub>
                  <mml:mi>C</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>• If for all <italic>i</italic>, <italic>M</italic>(<italic>i</italic>) ≤ separation_factor, <bold>break</bold>.</p>
        <p>• Pick an <italic>i </italic>such that <italic>M</italic>(<italic>i</italic>) &gt; separation_factor and let:</p>
        <p>
          <disp-formula>
            <mml:math id="M12" name="1471-2105-11-403-i12" overflow="scroll">
              <mml:mrow>
                <mml:mi>j</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:munder>
                  <mml:mrow>
                    <mml:mtext>arg</mml:mtext>
                    <mml:mi>max</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mo>≠</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:munder>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mtext>separation</mml:mtext>
                <mml:mo>_</mml:mo>
                <mml:mtext>ratio</mml:mtext>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>C</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mi>C</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>• Combine <italic>C<sub>i </sub></italic>and <italic>C<sub>j </sub></italic>, then update list of components.</p>
        <p><bold>Until </bold>number of components &gt; 1.</p>
        <p>In the sampling stage, we start with the initial value <inline-formula><mml:math id="M13" name="1471-2105-11-403-i6" overflow="scroll"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mroot><mml:mrow><mml:mfrac><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:mfrac></mml:mrow><mml:mi>d</mml:mi></mml:mroot></mml:mrow></mml:math></inline-formula> for the neighbourhood. <italic>m </italic>is a parameter that controls <italic>m'</italic>, the final number of sample points such that <inline-formula><mml:math id="M14" name="1471-2105-11-403-i8" overflow="scroll"><mml:mrow><mml:mfrac><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>≤</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≤</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>. Since in our implementation, we use Manhattan metric to measure the distance between points, the volume of a community can be estimated by <inline-formula><mml:math id="M15" name="1471-2105-11-403-i13" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.08</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.30</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Therefore if the the data points were distributed uniformly in the space, we would get <italic>m </italic>sample points in the first run. However, in practice, we need to repeat the procedure after updating the neighbourhood value. According to our experiments, a few iterations are enough to fulfil the terminating condition <inline-formula><mml:math id="M16" name="1471-2105-11-403-i8" overflow="scroll"><mml:mrow><mml:mfrac><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>≤</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≤</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>. As the running time of this part of SamSPECTRAL is <italic>O</italic>(<italic>nm</italic>), which is negligible compared to eigenspace computation time, we did not attempt to optimize the sampling loop.</p>
      </sec>
      <sec>
        <title>Modified Markov Clustering Algorithm (MCL)</title>
        <p>Step 4 in the above algorithm is the classic spectral clustering method. This step potentially could be substituted by any clustering algorithm for weighted graphs. To verify that our approach is extensible in this sense, we substituted classic spectral clustering with Markov Clustering (MCL) [<xref ref-type="bibr" rid="B43">43</xref>] keeping the rest of our algorithm, sampling and post-processing steps, unchanged.</p>
        <p>MCL finds the partitions of a graph by simulating flow on the nodes. Simulation is done by iteratively multiplying two type of matrices that correspond to <italic>expansion </italic>and <italic>inflation </italic>operations [<xref ref-type="bibr" rid="B43">43</xref>]. Because flow and eigenspace of a graph are strongly related<sup>1</sup>, the outcome of this approach tends to be similar to spectral clustering through computing eigenspace.</p>
      </sec>
    </sec>
    <sec>
      <title>Testing</title>
      <p>We implemented our algorithm with R, and applied it on four different datasets. We were able to identify some types of biologically interesting populations that were previously known to be hard to distinguish, including:</p>
      <p>1. <italic>Overlapping populations </italic>(Figure <xref ref-type="fig" rid="F4">4a-c</xref>).</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Comparative clustering of the telomere dataset</bold>. (a-c) Proper identification of overlapping populations. Although two populations shown by red and blue contours are overlapping in all bi-variant plots of this 3-dimensional sample, SamSPECTRAL can properly distinguish them by considering multiple parameters simultaneously.(d) SamSPECTRAL can also identify two major subpopulations of granulocytes correctly, as verified by expert analysis. (e) flowMerge does not distinguish between two populations of interest, and (f) FLAME improperly splits the same sample into several clusters.</p>
        </caption>
        <graphic xlink:href="1471-2105-11-403-4"/>
      </fig>
      <p>2. <italic>Subpopulations of a major population </italic>(Figure <xref ref-type="fig" rid="F4">4d-f</xref>).</p>
      <p>3. <italic>Non-elliptical shaped populations </italic>(Figures <xref ref-type="fig" rid="F5">5</xref> and Figure <xref ref-type="fig" rid="F6">6a-c</xref>).</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Comparative clustering of dead cells (PI positive) and live cells (PI negative) in the viability data</bold>. (a) SamSPECTRAL could distinguish between dead cells (blue) and live cells (red) properly. (b) flowMerge identified dead cells correctly, but split live cells into two clusters. (c) FLAME did not distinguish between these two population.</p>
        </caption>
        <graphic xlink:href="1471-2105-11-403-5"/>
      </fig>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>Comparative clustering of the GvHD dataset</bold>. (Left) Identification of non-elliptical shaped populations. (a) SamSPECTRAL could properly identify the red, non-elliptical population, while (b) flowMerge mixed this population with the one below it. (c) FLAME produced satisfactory results in identifying this population. (Right) Identification of low density populations close to dense populations. (d) SamSPECTRAL and (e) flowMerge could identify the low density population shown in red at the centre of the figure correctly, while (f) FLAME merged this population with the other ones surrounding it.</p>
        </caption>
        <graphic xlink:href="1471-2105-11-403-6"/>
      </fig>
      <p>4. <italic>Low density populations close to dense ones </italic>(Figures <xref ref-type="fig" rid="F6">6d-f</xref> and Figure <xref ref-type="fig" rid="F7">7</xref>).</p>
      <fig id="F7" position="float">
        <label>Figure 7</label>
        <caption>
          <p><bold>Comparative identification of a low density population surrounded by much denser populations in the stem cell data set</bold>. (a-c) SamSPECTRAL correctly identified the blue, low density population, while (d-f) flowMerge merged it to the yellow, high density population. (g-i) FLAME merged it to the red population. (j-l) The outcome of our modified MCL was similar to that obtained by SamSPECTRAL using classic spectral clustering. This shows that SamSPECTRAL is extensible by substituting classic spectral clustering with other clustering algorithms for weighted graph.</p>
        </caption>
        <graphic xlink:href="1471-2105-11-403-7"/>
      </fig>
      <p>5. <italic>Rare populations comprising less than 2% of all data points </italic>(Figure <xref ref-type="fig" rid="F8">8</xref>).</p>
      <fig id="F8" position="float">
        <label>Figure 8</label>
        <caption>
          <p><bold>Rare population in the stem cell data set</bold>. (a-c) This is a typical sample from the stem cell data set that contains a rare population. In these three dimensional plots, the red dots represent the cells that are positive for all three markers. Only 23/9721 (0.24%) events belong to this population in this sample. SamSPECTRAL could properly identify the rare population in 27/34 (79.4%) samples from the stem cell data set.</p>
        </caption>
        <graphic xlink:href="1471-2105-11-403-8"/>
      </fig>
      <p>Here, we demonstrate the capabilities of SamSPECTRAL in identifying biological populations in these cases and compare our results with two state of the art methods for clustering flow cytometry data, flowMerge (version 0.4.1) and FLAME (version 3), respectively obtained through BioConductor and GenePattern.</p>
      <sec>
        <title>Overlapping Populations</title>
        <p>Traditionally, identifying cell populations in flow cytometry data is accomplished by visualizing the multidimensional data as a series of bivariate plots, and separating interesting sections manually, in a process termed gating. Gating becomes challenging for high dimensional data since when the data is mapped to two dimensions, some clusters may overlap, resulting in the mixing of different populations. Consequently, even a trained operator cannot identify overlapping populations properly in all cases. However, our algorithm prevents this undesired error by considering all data dimensions together (Figure <xref ref-type="fig" rid="F4">4a-c</xref>). Model based multidimensional techniques also perform generally well in this regard.</p>
      </sec>
      <sec>
        <title>Subpopulations of a Population</title>
        <p>Figure <xref ref-type="fig" rid="F4">4d-f</xref> shows a major blood population (granulocytes) formed from two distinct subpopulations as verified by expert manual analysis. SamSPECTRAL could clearly distinguish between two subpopulations. flowMerge merged these two populations into one, while FLAME split both subpopulations.</p>
      </sec>
      <sec>
        <title>Non-elliptical Shaped Populations</title>
        <p>While most model based techniques have <italic>a priori </italic>assumptions on the shape of populations that resulted in mixing or splitting populations, our method worked relatively well on the samples with arbitrary shape populations. In Figure <xref ref-type="fig" rid="F5">5</xref>, the PI positive population (blue diagonal one) was clearly identified despite its non-elliptical shape. flowMerge could also distinguish this population, but it incorrectly split the PI negative population into two parts. FLAME did not correctly distinguish the two populations. Figure <xref ref-type="fig" rid="F6">6a-c</xref> shows the output of the three algorithms on a four dimensional sample from GvHD dataset. While the red population has a complex shape, it could be identified with high accuracy by SamSPECTRAL. While FLAME produced a satisfactory result, flowMerge mixed this population with the one below it.</p>
      </sec>
      <sec>
        <title>Low Density Populations Close to Dense Populations</title>
        <p>Figure <xref ref-type="fig" rid="F6">6d-f</xref> shows a sample from GvHD dataset containing a relatively low density and a high density population close together. SamSPECTRAL clearly distinguished the red population in the centre of the plot from the yellow dense population to its left. Moreover, it did not mix the red population with the other low density population to its right. FlowMerge also clustered this sample relatively well, requiring five times more processing time. The performance of FLAME was not satisfactory for this sample due to mixing the desired population with the other low density ones.</p>
        <p>Figure <xref ref-type="fig" rid="F7">7</xref> depicts a sample from the stem cell dataset containing a relatively low density population shown in blue. In each row, three 2-dimensional plots of the 3-dimensional data sample are presented. SamSPECTRAL could distinguish the blue population although it was surrounded by three relatively denser populations (the yellow, green and red ones). FlowMerge mixed this population with the yellow one, while FLAME mixed it with the red one.</p>
      </sec>
      <sec>
        <title>Rare Populations</title>
        <p>Identifying rare populations has many significant applications in flow cytometry experiments including distinguishing cancer stem cells, hematopoietic stem cell transplantation, detection of fetal cells in maternal blood, detection of leukocytes in leukocyte-depleted platelet products, detection of injected cells for biotherapy and malaria diagnosis [<xref ref-type="bibr" rid="B44">44</xref>].</p>
        <p>Figure <xref ref-type="fig" rid="F8">8</xref> shows a typical sample from the stem cell data set that contains a rare population in red. This population is positive for all the three markers and in each sample, it comprises between 0.1% to 2% of total cells. We performed an experiment on 34 samples from the stem cell data set and compared the performance of SamSPECTRAL, flowMerge and FLAME. This rare population was distinguished manually and the result of manual gating was considered as the basis for our comparison. FLAME and flowMerge could identify this population only in 11 (32%) and 9 (26%) of samples, respectively.</p>
        <p>SamSPECTRAL could distinguish this population in 27 (79%) samples including all the ones that were identified by FLAME and flowMerge. In the 7 (21%) samples that SamSPECTRAL failed, the rare population of interest contained less than 0.15% of all data points.</p>
        <p>To measure the accuracy of SamSPECTRAL, we define sensitivity and specificity as follows. For each sample, we call a cell positive if it belongs to the rare population of interest, and it is negative otherwise. Sensitivity is defined to be the number of truly identified rare cells divided by the total number of rare cells. Accordingly, specificity is the number of cells identified as negative divided by the total number of truly negative cell. The 27 (79%) cases where SamSPECTRAL correctly identified the rare population, had a 0.83 mean sensitivity with a 0.26 standard deviation. The median sensitivity was .99. Specificity was 1 except for one sample. If we consider the samples with a rare population bigger than 0.2% of the total data, we obtained median = 1, mean = 0.93 and standard deviation of 0.15 for sensitivity. A detailed report of the results of this experiment is provided as a table in additional file <xref ref-type="supplementary-material" rid="S1">1</xref>.</p>
      </sec>
      <sec>
        <title>SamSPECTRAL with MCL</title>
        <p>Figure <xref ref-type="fig" rid="F7">7j-l</xref> depicts the output of MCL on a sample from stem cells dataset. We ran MCL on the sampled data obtained by our faithful sampling algorithm and then the post-processing step was applied to the resulting clusters. This experiment showed there was no significant difference for SamSPECTRAL in clustering either through computing eigenvectors (Figure <xref ref-type="fig" rid="F7">7a-c</xref>) or by MCL (Figure <xref ref-type="fig" rid="F7">7j-l</xref>)<sup>2</sup>.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>Although spectral clustering algorithm is a powerful technique, it can not be directly applied to large datasets as it is computationally expensive both in time and memory. In this study, we developed a sampling method and combined it with spectral clustering by modifying the similarity matrix based on potential theory. As a result, for the first time, analysing flow cytometry data using spectral methods becomes possible and practical. We applied SamSPECTRAL to four different flow cytometry datasets to demonstrate its applicability on a broad spectrum of flow cytometry data, and compared its performance to two state of the art model-based clustering methods optimized for flow cytometry data.</p>
    <p>Detecting rare populations is a challenging problem and in spite of its significant applications in medical and biological research, little progress has been achieved in automatic identification of such populations. Our data reduction scheme is delicate enough not to miss rare populations comprising between 0.2% to 2% of the total data. SamSPECTRAL can identify populations of relative size in this range with acceptable accuracy.</p>
    <p>Since our method, SamSPECTRAL, is a multidimensional clustering approach, it can identify overlapping populations that are generally hard to identify by manual gating that uses sequential two dimensional visualizations of the data. SamSPECTRAL is the first method that has demonstrated the ability to correctly identify subpopulations of major flow cytometry cell populations.</p>
    <p>An important challenge in analysing flow cytometry data is in clustering data files that contain populations that significantly differ in density. Model-based techniques can produce errors in identifying a low density population close to denser populations because they typically make assumptions on the density of clusters [<xref ref-type="bibr" rid="B23">23</xref>]. Our experiments demonstrated that SamSPECTRAL can properly tackle this problem. Besides the practical observations, this capability is justified by the following observation. Spectral methodology clusters the graph such that the normal cut is "almost" optimum [<xref ref-type="bibr" rid="B41">41</xref>]. Now, assume that it can distinguish between two clusters when their densities are comparable. Then, if the size of the smaller cluster is reduced without change in its shape or distribution, the normal cut between them remains similar because the number of vertices and edges reduces almost proportionally to each other. Therefore, the clusters remain distinguishable. This explains why the overall performance of SamSPECTRAL is independent of cluster densities as long as their shapes are preserved.</p>
    <p>Since parametric methods such as FLAME and flowMerge make <italic>a priori </italic>assumptions on the distribution or shape of the clusters [<xref ref-type="bibr" rid="B23">23</xref>], they may fail in identifying populations with arbitrary shapes. Although flowMerge attempts to solve this issue by finding more clusters than needed and then merging them together, it still does not produce satisfactory results when the shape of the cluster is complex. SamSPECTRAL has the capability of identifying arbitrary shape clusters since it is a non-parametric approach that makes no assumptions on the shape and distribution of clusters, and clusters data based only on similarity between data points. Compared to other non-parametric methods, our algorithm has the advantages of automatically identifying the number of clusters and having low sensitivity to the predefined thresholds. Therefore, users can adjust the parameters only once by running SamSPECTRAL on one or two random samples from a flow cytometry data set. Then, the algorithm can be run on the rest of data set without changing the parameters.</p>
    <p>Not only does our sampling scheme increase the speed of spectral clustering without losing important biological information, but the resulting algorithm is faster than other methods considered in this study. More precisely, the running time of SamSPECTRAL is <italic>O</italic>(<italic>dmn</italic>) + <italic>O</italic>(<italic>m</italic><sup>3</sup>) where <italic>O</italic>(<italic>dmn</italic>) is the running time for building <italic>m </italic>communities from <italic>n </italic>points in <italic>d </italic>dimension and <italic>O</italic>(<italic>m</italic><sup>3</sup>) is the running time for computing the eigenspace. After this step, the k-means clustering runs very fast in time O(k m t) to find <italic>k </italic>clusters using eigenvectors by <italic>t </italic>iterations. In comparison, the time complexity of the original MCL method is <italic>O</italic>(<italic>nr</italic><sup>2</sup>) with no guarantee on upper bound for number of iterations <italic>r</italic>, other than <italic>n</italic>. Practically, for our model of flow cytometry data where all pairs of data points are connected, we could not run MCL before applying our modification to it. Moreover, SamSPECTRAL running time is significantly less than model-based techniques. The running time of flowMerge is <italic>O</italic>(<italic>d</italic><sup>2</sup><italic>k</italic><sup>2</sup><italic>nt</italic>) and FLAME runs in time <italic>O</italic>(<italic>d</italic><sup>4</sup><italic>klnt</italic>) where <italic>l </italic>is the number of times it runs to find the optimal number of clusters. In practice, we can keep <italic>m </italic>as small as 1500-3000 without loosing important biological information, and consequently SamSPECTRAL ran at least 5-10 times faster than flowMerge and FLAME on the studied datasets. Furthermore, the time efficiency of our algorithm is more noticeable for higher dimensional data such as the one provided as additional file <xref ref-type="supplementary-material" rid="S2">2</xref>. This sample contains 100,000 events in 23 dimensions and SamSPECTRAL can analyze it in less than 25 minutes by a 2.7 GHz processor.</p>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>Faithful sampling is based on potential theory. It reduces the size of input for spectral clustering algorithms and consequently they can now be efficiently applied on flow cytometry data in spite of its large size. Practically, our approach demonstrated significant advantages in proper identification of populations with non-elliptical shapes, low density populations close to dense ones, minor subpopulations of a major population, rare populations, and overlapping populations. No state of the art method can solve the challenges in identifying populations with the above properties simultaneously. Moreover, applying SamSPECTRAL to other biological data such as microarrays and protein databases may result in significant improvements in gene expression and protein classification.</p>
    <p>Besides, our faithful sampling algorithm can have interesting applications by itself. For instance, it can be used appropriately to reduce the size of input for other clustering algorithms that are based on spectral graph theory such as Markov Clustering Algorithm (MCL), electrical circuit based clustering, and agent based graph clustering [<xref ref-type="bibr" rid="B45">45</xref>]. We have shown the extendibility of our approach in this sense by substituting classic spectral clustering with MCL, a method that has many applications in bioinformatics.</p>
    <p>Other directions for future work include applying other schemes for estimating similarities between communities, combining clusters based on other combinatorial algorithms or biological criteria, and repeating the algorithm several times to obtain a more stable outcome.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>To run flowMerge and FLAME optimally, we used several settings for their parameters, finally selecting those that gave us the best results. For SamSPECTRAL algorithm, we set <italic>m </italic>= 3000 to keep the running time bellow 1 minute by a 2.7 GHz processor and the obtained results remained satisfactory for all samples we analyzed. The separation factor and scaling parameter (<italic>σ</italic>) are two main parameters that needed to be adjusted. Decreasing <italic>σ </italic>and increasing the separation factor will result in identifying more populations. In particular, if <italic>σ </italic>is decreased, then according to the heat kernel formula, the weights on the edges of the graph will decrease exponentially. Therefore, the graph will be sparser and tends to obtain more partitions. In consequence, the algorithm identifies more spectral clusters. This phenomenon can be useful in identifying rare populations. On the other hand, if separation factor is too high, a single population may be split into parts. In our experiments, we applied SamSPECTRAL on one or two random data samples of a data set and tried different values. Then, the selected parameters were fixed and used to apply SamSPECTRAL on the rest of data samples. The parameters values for the data sets presented in this paper are provided in additional file <xref ref-type="supplementary-material" rid="S3">3</xref>, <xref ref-type="supplementary-material" rid="S4">4</xref>, <xref ref-type="supplementary-material" rid="S5">5</xref>, and <xref ref-type="supplementary-material" rid="S6">6</xref>. The reader is referred to the SamSPECTRAL <bold>Bioconductor </bold>package vignette for more explanation on how to adjust parameters for a given data set<sup>3</sup>.</p>
    <sec>
      <title>Datasets</title>
      <p>We tested our algorithm on four different flow cytometry datasets as explained briefly here. The GvHD dataset is available in flowCore package through BioConductor, and the rest are available upon request.</p>
      <sec>
        <title>Stem Cells</title>
        <p>To investigate heterogeneity in the differentiation behaviour of hematopoietic stem cells, a subpopulation of adult mouse bone marrow was isolated and then each single stem cell was transplanted into one of 352 recipients [<xref ref-type="bibr" rid="B46">46</xref>]. 16 blood samples were taken from the recipients in biweekly intervals and were studied in a cytometer. The investigation contained hundreds of data files that needed to be analyzed to count the frequency of each subtype of white cells they contained.</p>
      </sec>
      <sec>
        <title>Telomere</title>
        <p>In all vertebrates, telomeres consist of tandem DNA repeats of the sequence d(TTAGGG) and associated proteins. Telomere length is known to be crucial elements in ageing and various diseases including cancer and it can be estimated by flow cytometry [<xref ref-type="bibr" rid="B47">47</xref>]. Since telomere length is different for various cell populations, these need to be distinguished before calculating telomere length.</p>
      </sec>
      <sec>
        <title>GvHD</title>
        <p>Acute graft versus host disease (GvHD) is a common outcome after bone marrow transplantation. It is difficult to diagnose in its early stages in order to provide timely treatment. To investigate how flow cytometry can help predict the development of GvHD, and to study its advantages over microarrays, peripheral blood samples from 31 patients undergoing allogeneic blood and marrow transplant were analyzed [<xref ref-type="bibr" rid="B48">48</xref>]. The samples were taken at progressive time points post-transplant and were stained with four appropriate lymphocyte phenotypic and activation markers defining 121 different populations using six markers.</p>
      </sec>
      <sec>
        <title>Viability</title>
        <p>Propidium iodide (PI) is a widely used marker for determining viability of mammalian cells [<xref ref-type="bibr" rid="B49">49</xref>] because it has the capability of passing through only damaged cell membranes. However, depending on the complexity of the data, identifying dead cells automatically might still be difficult even if this marker is used. We tested the capability of our algorithm in identifying dead cells using PI marker on a dataset from the Terry Fox Laboratory.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>The authors wish it to be known that, in their opinion, the first two authors, HZ and PS, should be regarded joint first authors. HZ designed and implemented the faithful sampling algorithm, and the method for computing similarity between communities. PS developed the idea of non-uniform sampling for spectral clustering and experimentally verified the stability of the algorithm. HZ and PS jointly worked on the method for estimating the number of clusters, and post-processing steps. HZ and PS performed the experiments. HZ, PS and RB wrote the paper. RB provided data and computing facilities. AG studied the convergence of faithful sampling. AG and RB supervised the project. All authors read, edited and approved the final manuscript.</p>
  </sec>
  <sec>
    <title>Appendix 1</title>
    <p>In the results section, we explained that the resolution of the sample points (Figure <xref ref-type="fig" rid="F2">2</xref>) is high enough such that by repeating the randomized faithful sampling procedure, the outcome of SamSPECTRAL does not vary significantly. The following experiment is performed to confirm this observation quantitatively. In this experiment we used F-measure, which is known to be appropriate for comparing clustering results of flow cytometry data [<xref ref-type="bibr" rid="B50">50</xref>]. F-measure varies in range 0-1 and reaches its best value at 1 when the two clustering results are identical. We ran SamSPECTRAL on a sample from the stem cell data set 20 times and compared the final results. The F-measure values obtained by pairwise comparison between the final results had mean = 0.98, median = 0.98 and standard deviation 0.0097.</p>
  </sec>
  <sec>
    <title>Appendix 2</title>
    <p>We performed the following experiment to show the effect of edge weights on performance of spectral clustering. As shown in Figure <xref ref-type="fig" rid="F9">9</xref>, we produced synthetic data containing one normal distribution with relatively high density surrounded by four relatively small clusters with lower densities. The number of points in each small cluster is less than 0.01% of the whole data and noise is added to the data space uniformly (Figure <xref ref-type="fig" rid="F9">9a</xref>). For the central dense distribution, we set <italic>σ<sub>xx </sub></italic>= <italic>σ<sub>yy </sub></italic>= 2,</p>
    <p><italic>σ<sub>xy </sub></italic>= <italic>σ<sub>yx </sub></italic>= 0 and the surrounding clusters are normal distributions with</p>
    <p><inline-formula><mml:math id="M17" name="1471-2105-11-403-i14" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.08</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.30</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>,</p>
    <p><inline-formula><mml:math id="M18" name="1471-2105-11-403-i15" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.07</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.08</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>,</p>
    <p><inline-formula><mml:math id="M19" name="1471-2105-11-403-i16" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.50</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.10</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>,</p>
    <p><inline-formula><mml:math id="M20" name="1471-2105-11-403-i17" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.10</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.70</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
    <p>The R code to produce this synthetic data and run SamSPECTRAL on it is provided in additional file <xref ref-type="supplementary-material" rid="S7">7</xref>.</p>
    <fig id="F9" position="float">
      <label>Figure 9</label>
      <caption>
        <p><bold>Performance of SamSPECTRAL on synthetic data</bold>. (a) This synthetic two dimensional data consists of a normal distribution with 30,000 points, four normal distribution each with 300 points and a uniform background noise with 4000 points. (b) Around 3000 sample points are picked up by faithful sampling. These are distributed almost uniformly in the space, therefore, almost all information about density will be lost if one considers only the samples points. (c) The final outcome of SamSPECTRAL confirms that the information about density could be retrieved by properly assigning weights to the edges of the graph. The high density cluster is shown in red and the surrounding sparser clusters are shown in yellow, light blue, green and black.</p>
      </caption>
      <graphic xlink:href="1471-2105-11-403-9"/>
    </fig>
    <p>After faithful sampling is done (Figure <xref ref-type="fig" rid="F9">9b</xref>), the sample points are distributed almost uniformly, and the information about the local density of original data is lost. However, faithful sampling provides us with more information than only the sample points. It will also return the members of each community and our data reduction scheme uses this information to assign weight to the edges. According to formulas 3 and 4, the more populated and closer two communities are, the higher the weight between them will be (Figure <xref ref-type="fig" rid="F1">1c</xref>). According to Figure <xref ref-type="fig" rid="F9">9c</xref>, this strategy is successful in retrieving information about local density as all the five clusters are distinguished properly by SamSPECTRAL.</p>
  </sec>
  <sec>
    <title>Appendix 3</title>
    <p>We observed that some low density populations disappeared entirely when simple uniform sampling was employed. To investigate the effect of this phenomenon on the final clustering results, we performed an experiment on a sample of the stem cell dataset that contained 48,000 events in 3 dimensions. First, 3,000 data points were selected uniformly at random. Then, we assigned a label to each of these selected points by applying classical spectral clustering on them. Finally, for each original data point, the label of the closest selected point was considered as its cluster label. Figures <xref ref-type="fig" rid="F10">10d</xref> and <xref ref-type="fig" rid="F10">10c</xref> show the results of this approach and SamSPECTRAL, accordingly. The red population that was distinguished by SamSPECTRAL correctly in Figure <xref ref-type="fig" rid="F10">10c</xref> consists of only 4% of the data. This population could not be distinguished properly by any setting of the parameters after uniform sampling (Figure <xref ref-type="fig" rid="F10">10d</xref>).</p>
    <fig id="F10" position="float">
      <label>Figure 10</label>
      <caption>
        <p><bold>Comparing Uniform sampling with faithful sampling</bold>. Directly applying classical spectral clustering is not efficient on this sample of the stem cell dataset which contains 48000 cytometry events in 3 dimensions. (a) Although only 2115 data points were selected by faithful sampling, each population has a considerable number of representatives in the selected points. (b) 3000 points were selected by uniform sampling. The low density population in the middle of the plot consists of only 55 sample points resulting in mixing this population with a high density one incorrectly (d). (c) The result of SamSPECTRAL on the original data is satisfactory because the low density red population and other high density populations are identified properly.</p>
      </caption>
      <graphic xlink:href="1471-2105-11-403-10"/>
    </fig>
  </sec>
  <sec>
    <title>Footnotes</title>
    <p><sup>1 </sup>Cheeger inequality is an example of such a relation [<xref ref-type="bibr" rid="B41">41</xref>].</p>
    <p><sup>2 </sup>The CD45+ cells that are considered as outliers by MCL are not plotted in Figure <xref ref-type="fig" rid="F7">7j-l</xref>.</p>
    <p><sup>3 </sup>The vignette is located at: <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/devel/bioc/vignettes/SamSPECTRAL/inst/doc/Clustering_by_SamSPECTRAL.pdf">http://bioconductor.org/packages/devel/bioc/vignettes/SamSPECTRAL/inst/doc/Clustering_by_SamSPECTRAL.pdf</ext-link></p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Report on identification of rare population</bold>. The table contains the full detailed report on our comparative experiment for identifying rare populations.</p>
      </caption>
      <media xlink:href="1471-2105-11-403-S1.xls" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>High dimensional flow cytometry data</bold>. This data file contains a matrix with 100,000 rows and 23 columns that represents a flow cytometry sample with 100,000 events. It can be directly loaded in R and analyzed by SamSPECTRAL. It takes less than 12 minutes to perform faithful sampling on this 23 dimensional data.</p>
      </caption>
      <media xlink:href="1471-2105-11-403-S2.rdat" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p><bold>Parameters for GvHD data set</bold>. These values are appropriate for running SamSPECTRAL on GvHD data set.</p>
      </caption>
      <media xlink:href="1471-2105-11-403-S3.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4</title>
        <p><bold>Parameters for stem cell data set</bold>. These values are appropriate for running SamSPECTRAL on stem cell data set.</p>
      </caption>
      <media xlink:href="1471-2105-11-403-S4.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S5">
      <caption>
        <title>Additional file 5</title>
        <p><bold>Parameters for telomere data set</bold>. These values are appropriate for running SamSPECTRAL on telomere data set.</p>
      </caption>
      <media xlink:href="1471-2105-11-403-S5.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S6">
      <caption>
        <title>Additional file 6</title>
        <p><bold>Parameters for viability data set</bold>. These values are appropriate for running SamSPECTRAL on viability data set.</p>
      </caption>
      <media xlink:href="1471-2105-11-403-S6.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S7">
      <caption>
        <title>Additional file 7</title>
        <p><bold>Simulation with synthetic data</bold>. This R source code produces synthetic data with 5 clusters shown in Figure <xref ref-type="fig" rid="F5">5</xref>. The resulting data is passed to SamSPECTRAL to be clustered.</p>
      </caption>
      <media xlink:href="1471-2105-11-403-S7.r" mimetype="text" mime-subtype="plain">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Adrian Cortes, Connie Eaves, Peter Lansdorp and Keith Humphries for providing data, Bari Zahedi and Irma Vulto for their biological insight and manual data analysis, Josef Spidlen for assistance in running FLAME, Aaron Barsky and Nima Aghaeepour for their editorial comments, and Mani Ranjbar for programming guidance. This work was supported by NIH grants 1R01EB008400 and 1R01EB005034, the Michael Smith Foundation for Health Research, the National Science and Engineering Research Council and the MITACS Network of Centres of Excellence.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="book">
        <name>
          <surname>Hawley</surname>
          <given-names>TS</given-names>
        </name>
        <name>
          <surname>Hawley</surname>
          <given-names>RG</given-names>
        </name>
        <source>Flow Cytometry Protocols, Methods in Molecular Biology</source>
        <year>2005</year>
        <edition>2</edition>
        <publisher-name>Humana Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Perfetto</surname>
          <given-names>SP</given-names>
        </name>
        <name>
          <surname>Chattopadhyay</surname>
          <given-names>PK</given-names>
        </name>
        <name>
          <surname>Roederer</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Seventeen-colour flow cytometry: unravelling the immune system</article-title>
        <source>Nat Rev Immunol</source>
        <year>2004</year>
        <volume>4</volume>
        <issue>8</issue>
        <fpage>648</fpage>
        <lpage>655</lpage>
        <pub-id pub-id-type="doi">10.1038/nri1416</pub-id>
        <pub-id pub-id-type="pmid">15286731</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bashashati</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Brinkman</surname>
          <given-names>R</given-names>
        </name>
        <article-title>A survey of flow cytometry data analysis methods</article-title>
        <source>Advances in Bioinformatics</source>
        <year>2009</year>
        <volume>2009</volume>
        <fpage>1</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1155/2009/584603</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Klinke</surname>
          <given-names>D</given-names>
          <suffix>II</suffix>
        </name>
        <name>
          <surname>Brundage</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Scalable analysis of flow cytometry data using R/Bioconductor</article-title>
        <source>Cytometry Part A</source>
        <year>2009</year>
        <volume>75</volume>
        <issue>8</issue>
        <fpage>699</fpage>
        <lpage>706</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20746</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lugli</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Roederer</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Cossarizza</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Data analysis in flow cytometry: The future just started</article-title>
        <source>Cytometry Part A</source>
        <year>2010</year>
        <volume>77</volume>
        <issue>7</issue>
        <fpage>705</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20901</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Boedigheimer</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Ferbas</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Mixture modeling approach to flow cytometry data</article-title>
        <source>Cytometry Part A</source>
        <year>2008</year>
        <volume>73</volume>
        <issue>5</issue>
        <fpage>421</fpage>
        <lpage>429</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20553</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="other">
        <name>
          <surname>Simon</surname>
          <given-names>U</given-names>
        </name>
        <name>
          <surname>Mucha</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Bruggemann</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Model-based cluster analysis applied to flow cytometry data</article-title>
        <source>Innovations in Classification, Data Science, and Information Systems</source>
        <year>2005</year>
        <fpage>69</fpage>
        <lpage>76</lpage>
        <comment>full_text</comment>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zeng</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Pratt</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Pak</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Ravnic</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Huss</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Mentzer</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Feature-guided clustering of multi-dimensional flow cytometry datasets</article-title>
        <source>Journal of Biomedical Informatics</source>
        <year>2007</year>
        <volume>40</volume>
        <issue>3</issue>
        <fpage>325</fpage>
        <lpage>331</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jbi.2006.06.005</pub-id>
        <pub-id pub-id-type="pmid">16901761</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Scheuermann</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Qian</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Wei</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Sanz</surname>
          <given-names>I</given-names>
        </name>
        <article-title>ImmPort FLOCK: Automated cell population identification in high dimensional flow cytometry data</article-title>
        <source>The Journal of Immunology</source>
        <year>2009</year>
        <volume>182</volume>
        <issue>Meeting Abstracts 1</issue>
        <fpage>42</fpage>
        <lpage>17</lpage>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Naumann</surname>
          <given-names>U</given-names>
        </name>
        <name>
          <surname>Luta</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Wand</surname>
          <given-names>M</given-names>
        </name>
        <article-title>The curvHDR method for gating flow cytometry samples</article-title>
        <source>BMC bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>44</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-44</pub-id>
        <pub-id pub-id-type="pmid">20096119</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Jeffries</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Zaidi</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>de Jong</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Holland</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Miles</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Analysis of flow cytometry data using an automatic processing tool</article-title>
        <source>Cytometry Part A</source>
        <year>2008</year>
        <volume>73</volume>
        <issue>9</issue>
        <fpage>857</fpage>
        <lpage>867</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20611</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Naumann</surname>
          <given-names>U</given-names>
        </name>
        <name>
          <surname>Wand</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Automation in high-content flow cytometry screening</article-title>
        <source>Cytometry Part A</source>
        <year>2009</year>
        <volume>75</volume>
        <issue>9</issue>
        <fpage>789</fpage>
        <lpage>797</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20754</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Shulman</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Bellew</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Snelling</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Carter</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Huang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Self</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>McElrath</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>De Rosa</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Development of an automated analysis system for data from flow cytometric intracellular cytokine staining assays from clinical vaccine trials</article-title>
        <source>Cytometry Part A</source>
        <year>2008</year>
        <volume>73</volume>
        <issue>9</issue>
        <fpage>847</fpage>
        <lpage>856</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20600</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Preffer</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Dombkowski</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Advances in complex multiparameter flow cytometry technology: Applications in stem cell research</article-title>
        <source>Cytometry Part B: Clinical Cytometry</source>
        <year>2009</year>
        <volume>76</volume>
        <issue>5</issue>
        <fpage>295</fpage>
        <lpage>314</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.b.20480</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pedreira</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Costa</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Barrena</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Lecrevisse</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Almeida</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>van Dongen</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Orfao</surname>
          <given-names>A</given-names>
        </name>
        <etal/>
        <article-title>Generation of flow cytometry data files with a potentially infinite number of dimensions</article-title>
        <source>Cytometry Part A</source>
        <year>2008</year>
        <volume>73</volume>
        <issue>9</issue>
        <fpage>834</fpage>
        <lpage>846</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20608</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Conrad</surname>
          <given-names>MP</given-names>
        </name>
        <article-title>A rapid, non-parametric clustering scheme for flow cytometric data</article-title>
        <source>Pattern Recognition</source>
        <year>1987</year>
        <volume>20</volume>
        <issue>2</issue>
        <fpage>229</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1016/0031-3203(87)90056-2</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fu</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Braylan</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Benson</surname>
          <given-names>N</given-names>
        </name>
        <article-title>Real-time adaptive clustering of flow cytometric data</article-title>
        <source>Pattern Recognition</source>
        <year>1993</year>
        <volume>26</volume>
        <issue>2</issue>
        <fpage>365</fpage>
        <lpage>373</lpage>
        <pub-id pub-id-type="doi">10.1016/0031-3203(93)90044-W</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Boddy</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Wilkins</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Morris</surname>
          <given-names>C</given-names>
        </name>
        <article-title>Pattern recognition in flow cytometry</article-title>
        <source>Cytometry</source>
        <year>2001</year>
        <volume>44</volume>
        <issue>3</issue>
        <fpage>195</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1002/1097-0320(20010701)44:3&lt;195::AID-CYTO1112&gt;3.0.CO;2-H</pub-id>
        <pub-id pub-id-type="pmid">11429770</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Finn</surname>
          <given-names>WG</given-names>
        </name>
        <name>
          <surname>Carter</surname>
          <given-names>KM</given-names>
        </name>
        <name>
          <surname>Raich</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Stoolman</surname>
          <given-names>LM</given-names>
        </name>
        <name>
          <surname>Hero</surname>
          <given-names>AO</given-names>
        </name>
        <article-title>Analysis of clinical flow cytometric immunophenotyping data by clustering on statistical manifolds: Treating flow cytometry data as high-dimensional objects</article-title>
        <source>Cytometry Part B: Clinical Cytometry</source>
        <year>2009</year>
        <volume>76B</volume>
        <fpage>1</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.b.20435</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pyne</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Hu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Rossin</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Lin</surname>
          <given-names>TI</given-names>
        </name>
        <name>
          <surname>Maier</surname>
          <given-names>LM</given-names>
        </name>
        <name>
          <surname>Baecher-Allan</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Mclachlan</surname>
          <given-names>GJ</given-names>
        </name>
        <name>
          <surname>Tamayo</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Hafler</surname>
          <given-names>DA</given-names>
        </name>
        <name>
          <surname>De Jager</surname>
          <given-names>PL</given-names>
        </name>
        <name>
          <surname>Mesirov</surname>
          <given-names>JP</given-names>
        </name>
        <article-title>Automated high-dimensional flow cytometric data analysis</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <year>2009</year>
        <volume>106</volume>
        <issue>21</issue>
        <fpage>8519</fpage>
        <lpage>8524</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0903028106</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lo</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Hahne</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Brinkman</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Gottardo</surname>
          <given-names>R</given-names>
        </name>
        <article-title>flowClust: a Bioconductor package for automated gating of flow cytometry data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>1</fpage>
        <lpage>145</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-145</pub-id>
        <pub-id pub-id-type="pmid">19118496</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Finak</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Bashashati</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Brinkman</surname>
          <given-names>RR</given-names>
        </name>
        <name>
          <surname>Gottardo</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Merging Mixture Components for Cell Population Identification in Flow Cytometry</article-title>
        <source>Advances in Bioinformatics</source>
        <year>2009</year>
        <volume>2009</volume>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1155/2009/247646</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chan</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Feng</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Ottinger</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Foster</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>West</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Kepler</surname>
          <given-names>TB</given-names>
        </name>
        <article-title>Statistical mixture modeling for cell subtype identification in flow cytometry</article-title>
        <source>Cytometry Part A</source>
        <year>2008</year>
        <volume>73A</volume>
        <issue>8</issue>
        <fpage>693</fpage>
        <lpage>701</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.a.20583</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>von Luxburg</surname>
          <given-names>U</given-names>
        </name>
        <article-title>A tutorial on spectral clustering</article-title>
        <source>Statistics and Computing</source>
        <year>2007</year>
        <volume>17</volume>
        <issue>4</issue>
        <fpage>395</fpage>
        <lpage>416</lpage>
        <pub-id pub-id-type="doi">10.1007/s11222-007-9033-z</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="book">
        <name>
          <surname>Ng</surname>
          <given-names>AY</given-names>
        </name>
        <name>
          <surname>Jordan</surname>
          <given-names>MI</given-names>
        </name>
        <name>
          <surname>Weiss</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>On Spectral Clustering: Analysis and an algorithm</article-title>
        <source>Advances in Neural Information Processing Systems 14</source>
        <year>2001</year>
        <publisher-name>MIT Press</publisher-name>
        <fpage>849</fpage>
        <lpage>856</lpage>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Azran</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Ghahramani</surname>
          <given-names>Z</given-names>
        </name>
        <article-title>Spectral Methods for Automatic Multiscale Data Clustering</article-title>
        <source>Computer Vision and Pattern Recognition, 2006 IEEE Computer Society Conference on</source>
        <year>2006</year>
        <volume>1</volume>
        <fpage>190</fpage>
        <lpage>197</lpage>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="other">
        <name>
          <surname>Pentney</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Meila</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Spectral Clustering of Biological Sequence Data</article-title>
        <source>AAAI</source>
        <year>2005</year>
        <fpage>845</fpage>
        <lpage>850</lpage>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bach</surname>
          <given-names>FR</given-names>
        </name>
        <name>
          <surname>Jordan</surname>
          <given-names>MI</given-names>
        </name>
        <article-title>Learning Spectral Clustering, With Application To Speech Separation</article-title>
        <source>J Mach Learn Res</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>1963</fpage>
        <lpage>2001</lpage>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>von Luxburg</surname>
          <given-names>U</given-names>
        </name>
        <name>
          <surname>Belkin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Bousquet</surname>
          <given-names>O</given-names>
        </name>
        <article-title>Consistency of Spectral Clustering</article-title>
        <source>Annals of Statistics</source>
        <year>2008</year>
        <volume>36</volume>
        <issue>2</issue>
        <fpage>555</fpage>
        <lpage>586</lpage>
        <pub-id pub-id-type="doi">10.1214/009053607000000640</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="book">
        <name>
          <surname>Trefethen</surname>
          <given-names>LN</given-names>
        </name>
        <name>
          <surname>Bau</surname>
          <given-names>D</given-names>
        </name>
        <source>Numerical Linear Algebra</source>
        <year>1997</year>
        <publisher-name>SIAM</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="book">
        <name>
          <surname>Cullum</surname>
          <given-names>JK</given-names>
        </name>
        <name>
          <surname>Willoughby</surname>
          <given-names>RA</given-names>
        </name>
        <source>Lanczos Algorithms for Large Symmetric Eigenvalue Computations</source>
        <year>2002</year>
        <volume>I</volume>
        <publisher-name>SIAM</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Fowlkes</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Belongie</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Chung</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Malik</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Spectral Grouping Using the Nystrom Method</article-title>
        <source>IEEE Transactions on Pattern Analysis and Machine Intelligence</source>
        <year>2004</year>
        <volume>26</volume>
        <issue>2</issue>
        <fpage>214</fpage>
        <lpage>225</lpage>
        <pub-id pub-id-type="doi">10.1109/TPAMI.2004.1262185</pub-id>
        <pub-id pub-id-type="pmid">15376896</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Carter</surname>
          <given-names>KM</given-names>
        </name>
        <name>
          <surname>Raich</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Finn</surname>
          <given-names>WG</given-names>
        </name>
        <name>
          <surname>Hero</surname>
          <given-names>AO</given-names>
        </name>
        <article-title>Information Preserving Component Analysis: Data Projections for Flow Cytometry Analysis</article-title>
        <source>IEEE Journal of Selected Topics in Signal Processing</source>
        <year>2009</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>148</fpage>
        <lpage>158</lpage>
        <pub-id pub-id-type="doi">10.1109/JSTSP.2008.2011112</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mann</surname>
          <given-names>RC</given-names>
        </name>
        <article-title>On multiparameter data analysis in flow cytometry</article-title>
        <source>Cytometry A</source>
        <year>1987</year>
        <volume>8</volume>
        <issue>2</issue>
        <fpage>184</fpage>
        <lpage>189</lpage>
        <pub-id pub-id-type="doi">10.1002/cyto.990080211</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="book">
        <name>
          <surname>Yan</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Huang</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Jordan</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Fast Approximate Spectral Clustering</article-title>
        <source>Tech. Rep. UCB/EECS-2009-45</source>
        <year>2009</year>
        <publisher-name>EECS Department, University of California, Berkeley</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="other">
        <name>
          <surname>Kondor</surname>
          <given-names>RI</given-names>
        </name>
        <name>
          <surname>Lafferty</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Diffusion Kernels on Graphs and Other Discrete Structures</article-title>
        <source>In Proceedings of the ICML</source>
        <year>2002</year>
        <fpage>315</fpage>
        <lpage>322</lpage>
      </mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="book">
        <name>
          <surname>Biyikoglu</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Leydold</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Stadler</surname>
          <given-names>PF</given-names>
        </name>
        <article-title>Laplacian eigenvectors of graphs</article-title>
        <source>Lecture notes in mathematics; 1915</source>
        <year>2007</year>
        <publisher-name>Springer</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Xiang</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Gong</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Spectral clustering with eigenvector selection</article-title>
        <source>Pattern Recogn</source>
        <year>2008</year>
        <volume>41</volume>
        <issue>3</issue>
        <fpage>1012</fpage>
        <lpage>1029</lpage>
        <pub-id pub-id-type="doi">10.1016/j.patcog.2007.07.023</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="other">
        <name>
          <surname>Biggs</surname>
          <given-names>N</given-names>
        </name>
        <source>Topics in Algebraic Graph Theory: Encyclopedia of Mathematics and its Applications</source>
        <year>2007</year>
        <volume>16</volume>
        <fpage>171</fpage>
        <lpage>172</lpage>
      </mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="other">
        <article-title>SamSPECTRAL package at BioConductor</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/devel/bioc/html/SamSPECTRAL.html">http://www.bioconductor.org/packages/devel/bioc/html/SamSPECTRAL.html</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="other">
        <name>
          <surname>Chung</surname>
          <given-names>FRK</given-names>
        </name>
        <source>Spectral Graph Theory (CBMS Regional Conference Series in Mathematics, No. 92). American Mathematical Society</source>
        <year>1997</year>
      </mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Shi</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Malik</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Normalized Cuts and Image Segmentation</article-title>
        <source>IEEE Transactions on Pattern Analysis and Machine Intelligence</source>
        <year>1997</year>
        <volume>22</volume>
        <fpage>888</fpage>
        <lpage>905</lpage>
      </mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dongen</surname>
          <given-names>SV</given-names>
        </name>
        <article-title>Graph Clustering Via a Discrete Uncoupling Process</article-title>
        <source>SIAM Journal on Matrix Analysis and Applications</source>
        <year>2008</year>
        <volume>30</volume>
        <fpage>121</fpage>
        <lpage>141</lpage>
        <pub-id pub-id-type="doi">10.1137/040608635</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Donnenberg</surname>
          <given-names>AD</given-names>
        </name>
        <name>
          <surname>Donnenberg</surname>
          <given-names>VS</given-names>
        </name>
        <article-title>Rare-Event Analysis in Flow Cytometry</article-title>
        <source>Clinics in Laboratory Medicine</source>
        <year>2007</year>
        <volume>27</volume>
        <issue>3</issue>
        <fpage>627</fpage>
        <lpage>652</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cll.2007.05.013</pub-id>
        <pub-id pub-id-type="pmid">17658410</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B45">
      <mixed-citation publication-type="book">
        <name>
          <surname>Gil Alterovitz</surname>
          <given-names>MR</given-names>
        </name>
        <name>
          <surname>Benson</surname>
          <given-names>Roseann</given-names>
        </name>
        <source>Automation in proteomics and genomics: an engineering case-based approach</source>
        <year>2009</year>
        <publisher-name>Wiley</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B46">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Dykstra</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Kent</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Bowie</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>McCaffrey</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Hamilton</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lyons</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Brinkman</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Eaves</surname>
          <given-names>C</given-names>
        </name>
        <article-title>Long-term propagation of distinct hematopoietic differentiation programs in vivo</article-title>
        <source>Cell Stem Cell</source>
        <year>2007</year>
        <volume>1</volume>
        <issue>2</issue>
        <fpage>218</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="doi">10.1016/j.stem.2007.05.015</pub-id>
        <pub-id pub-id-type="pmid">18371352</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B47">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Baerlocher</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Vulto</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>de</surname>
          <given-names>JG</given-names>
        </name>
        <name>
          <surname>Lansdorp</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Flow cytometry and FISH to measure the average length of telomeres (flow FISH)</article-title>
        <source>Nature protocols</source>
        <year>2006</year>
        <volume>1</volume>
        <issue>5</issue>
        <fpage>2365.</fpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2006.263</pub-id>
        <pub-id pub-id-type="pmid">17406480</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B48">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Brinkman</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Gasparetto</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Ribickas</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Perkins</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Janssen</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Smiley</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>C</given-names>
        </name>
        <article-title>High-content flow cytometry and temporal data analysis for defining a cellular signature of graft-versus-host disease</article-title>
        <source>Biol Blood Marrow Transplant</source>
        <year>2007</year>
        <volume>13</volume>
        <issue>6</issue>
        <fpage>691</fpage>
        <lpage>700</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bbmt.2007.02.002</pub-id>
        <pub-id pub-id-type="pmid">17531779</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B49">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Yeh</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Hsi</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Faulk</surname>
          <given-names>W</given-names>
        </name>
        <article-title>Propidium iodide as a nuclear marker in immunofluorescence. II. Use with cellular identification and viability studies</article-title>
        <source>J Immunol Methods</source>
        <year>1981</year>
        <volume>43</volume>
        <issue>3</issue>
        <fpage>269</fpage>
        <lpage>275</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-1759(81)90174-5</pub-id>
        <pub-id pub-id-type="pmid">7019344</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B50">
      <mixed-citation publication-type="other">
        <name>
          <surname>Aghaeepour</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Khodabakhshi</surname>
          <given-names>AH</given-names>
        </name>
        <name>
          <surname>Brinkman</surname>
          <given-names>RR</given-names>
        </name>
        <article-title>An Empirical Study of Cluster Evaluation Metrics using Flow Cytometry Data</article-title>
        <source>Proceedings of NIPS workshop "Clustering: Science or Art"</source>
        <year>2009</year>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
