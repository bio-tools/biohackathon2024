<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9825778</article-id>
    <article-id pub-id-type="pmid">36478203</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac790</article-id>
    <article-id pub-id-type="publisher-id">btac790</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>bmVAE: a variational autoencoder method for clustering single-cell mutation data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yan</surname>
          <given-names>Jiaqian</given-names>
        </name>
        <aff><institution>School of Information Engineering, Ningxia University</institution>, Yinchuan 750021, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Ming</given-names>
        </name>
        <aff><institution>School of Information Engineering, Ningxia University</institution>, Yinchuan 750021, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6526-6991</contrib-id>
        <name>
          <surname>Yu</surname>
          <given-names>Zhenhua</given-names>
        </name>
        <aff><institution>School of Information Engineering, Ningxia University</institution>, Yinchuan 750021, <country country="CN">China</country></aff>
        <aff><institution>Collaborative Innovation Center for Ningxia Big Data and Artificial Intelligence Co-founded by Ningxia Municipality and Ministry of Education, Ningxia University</institution>, Yinchuan 750021, <country country="CN">China</country></aff>
        <xref rid="btac790-cor1" ref-type="corresp"/>
        <!--zhyu@nxu.edu.cn-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac790-cor1">To whom correspondence should be addressed. <email>zhyu@nxu.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-12-07">
      <day>07</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac790</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>26</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>02</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>06</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>15</day>
        <month>12</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac790.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Genetic intra-tumor heterogeneity (ITH) characterizes the differences in genomic variations between tumor clones, and accurately unmasking ITH is important for personalized cancer therapy. Single-cell DNA sequencing now emerges as a powerful means for deciphering underlying ITH based on point mutations of single cells. However, detecting tumor clones from single-cell mutation data remains challenging due to the error-prone and discrete nature of the data.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce bmVAE, a bioinformatics tool for learning low-dimensional latent representation of single cell based on a variational autoencoder and then clustering cells into subpopulations in the latent space. bmVAE takes single-cell binary mutation data as inputs, and outputs inferred cell subpopulations as well as their genotypes. To achieve this, the bmVAE framework is designed to consist of three modules including dimensionality reduction, cell clustering and genotype estimation. We assess the method on various synthetic datasets where different factors including false negative rate, data size and data heterogeneity are considered in simulation, and further demonstrate its effectiveness on two real datasets. The results suggest bmVAE is highly effective in reasoning ITH, and performs competitive to existing methods.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>bmVAE is freely available at <ext-link xlink:href="https://github.com/zhyu-lab/bmvae" ext-link-type="uri">https://github.com/zhyu-lab/bmvae</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Cancer develops by accumulating genomic mutations (<xref rid="btac790-B25" ref-type="bibr">Nowell, 1976</xref>), and this evolutionary process can be depicted by a phylogenetic tree where distinct tumor clones appear at different nodes of the tree (<xref rid="btac790-B27" ref-type="bibr">Ross and Markowetz, 2016</xref>). Each clone is characterized by a set of genomic mutations, and genetic differences among tumor clones are known as intra-tumor heterogeneity (ITH) (<xref rid="btac790-B30" ref-type="bibr">Stratton <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btac790-B32" ref-type="bibr">Swanton, 2012</xref>). ITH acts as one of the important factors leading to drug resistance and cancer relapse, therefore accurately deciphering ITH from genome data is essential for personalized cancer therapy. Conventional bulk sequencing has been widely used for ITH profiling (<xref rid="btac790-B7" ref-type="bibr">Eaton <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac790-B29" ref-type="bibr">Satas and Raphael, 2017</xref>), while it requires a deconvolution step to identify all clones from the averaged signal of thousands or even millions of cells, which often results in low-resolution indication of the ITH due to deficient coverage of low-prevalence clones. By comparison, single-cell DNA sequencing (scDNA-seq) (<xref rid="btac790-B10" ref-type="bibr">Gawad <italic toggle="yes">et al.</italic>, 2016</xref>) is a powerful technique to profile genomic variations at single-cell resolution, and particularly useful to decipher the ITH and evolutionary history of tumor based on single-cell mutation data (<xref rid="btac790-B19" ref-type="bibr">Kuipers <italic toggle="yes">et al.</italic>, 2017</xref>).</p>
    <p>Despite to its advantage of providing high resolution indication of the ITH, scDNA-seq has some technological factors that complicate the downstream data analysis. Whole-genome amplification involved in scDNA-seq often results in unbalanced amplification of alleles and even allele-dropout (ADO) (<xref rid="btac790-B24" ref-type="bibr">Navin, 2014</xref>). ADO has a significant effect on heterozygous mutation sites, where one or both of the alleles are not adequately amplified, and this often yields false negative (FN) calls for heterozygous mutations (<xref rid="btac790-B9" ref-type="bibr">Gawad <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btac790-B14" ref-type="bibr">Hou <italic toggle="yes">et al.</italic>, 2012</xref>). In addition, sequencing errors impose a challenge of distinguishing true mutations from technological background noise, and often result in false positive (FP) calls (<xref rid="btac790-B14" ref-type="bibr">Hou <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btac790-B35" ref-type="bibr">Xu <italic toggle="yes">et al.</italic>, 2012</xref>). ADO and uneven coverage also cause unobserved sites (<xref rid="btac790-B14" ref-type="bibr">Hou <italic toggle="yes">et al.</italic>, 2012</xref>). Another issue related to scDNA-seq data is cell doublet that represents mixed profiles of two or more cells (<xref rid="btac790-B39" ref-type="bibr">Zafar <italic toggle="yes">et al.</italic>, 2017</xref>). These critical issues give rise to a challenge of accurately decipher the ITH and tumor evolutionary history.</p>
    <p>Many computational methods have been developed in recent years to infer tumor phylogenetic tree from single-nucleotide variations of cells. These methods are typically classified into three categories based on the adopted evolutionary model: infinite-sites model (ISM), Dollo parsimony model and finite-site model (FSM). ISM takes a strict evolutionary assumption that each mutation can be gained at most once and the acquired mutations will not be lost during the evolutionary process. For instance, SCITE (<xref rid="btac790-B15" ref-type="bibr">Jahn <italic toggle="yes">et al.</italic>, 2016</xref>) employs a Markov chain Monte Carlo-based approach to reconstruct tumor mutation tree under the ISM assumption, and PhISCS-BnB (<xref rid="btac790-B1" ref-type="bibr">Sadeqi Azer <italic toggle="yes">et al.</italic>, 2020</xref>) uses a branch and bound algorithm to deliver perfect phylogeny. To relieve the constraint of the ISM, Dollo parsimony model allows each mutation to be lost multiple times. Popular methods built on the Dollo model include SPhyR (<xref rid="btac790-B8" ref-type="bibr">El-Kebir, 2018</xref>), SASC (<xref rid="btac790-B6" ref-type="bibr">Ciccolella <italic toggle="yes">et al.</italic>, 2021b</xref>) and GRMT (<xref rid="btac790-B37" ref-type="bibr">Yu <italic toggle="yes">et al.</italic>, 2021</xref>). To further relax the constraint on the evolutionary model, FSM allows both parallel evolution and back mutation. For instance, SiFit (<xref rid="btac790-B39" ref-type="bibr">Zafar <italic toggle="yes">et al.</italic>, 2017</xref>) uses a Markov chain Monte Carlo-based method to reason cell lineage tree following FSM, and CellPhy (<xref rid="btac790-B18" ref-type="bibr">Kozlov <italic toggle="yes">et al.</italic>, 2022</xref>) employs a finite-site Markov genotype model to infer tumor phylogenetic tree. These methods perform well on small datasets, while their scalability may be limited on large datasets containing thousands of cells due to huge search space of the tumor evolutionary tree. One feasible solution to simplify phylogeny inference is to cluster cells or mutations before tree reconstruction, where clustering of cells or mutations is adopted as a preprocessing task to shrink the search space of tree structures, thus improves the efficiency of phylogeny inference.</p>
    <p>To date, several bioinformatics methods have been proposed to cluster single-cell mutation data (<xref rid="btac790-B3" ref-type="bibr">Borgsmüller <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac790-B4" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac790-B23" ref-type="bibr">Myers <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac790-B27" ref-type="bibr">Ross and Markowetz, 2016</xref>; <xref rid="btac790-B28" ref-type="bibr">Roth <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btac790-B38" ref-type="bibr">Yu <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btac790-B36" ref-type="bibr">Yu and Du, 2022</xref>; <xref rid="btac790-B40" ref-type="bibr">Zafar <italic toggle="yes">et al.</italic>, 2019</xref>). These methods can be divided into two classes: detecting tumor clones with or without phylogeny inference. Clonal tree depicts the lineage relationship between distinct tumor clones, and can be treated as a ‘regularizer’ on the mutational states of clones. OncoNEM (<xref rid="btac790-B27" ref-type="bibr">Ross and Markowetz, 2016</xref>) employs a heuristic algorithm and SiCloneFit (<xref rid="btac790-B40" ref-type="bibr">Zafar <italic toggle="yes">et al.</italic>, 2019</xref>) uses a Bayesian framework to jointly infer clonal structure and phylogeny. RobustClone (<xref rid="btac790-B4" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2020</xref>) first recovers genotypes of single cells based on robust principal component analysis, and then reconstructs clonal tree using the Louvain–Jaccard clustering method (<xref rid="btac790-B20" ref-type="bibr">Levine <italic toggle="yes">et al.</italic>, 2015</xref>). A recent method called AMC (<xref rid="btac790-B36" ref-type="bibr">Yu and Du, 2022</xref>) maps mutations into distinct clusters, and reasons tumor phylogeny based on the mutation clusters. celluloid (<xref rid="btac790-B5" ref-type="bibr">Ciccolella <italic toggle="yes">et al.</italic>, 2021a</xref>) aims to address the similar problem of mutation clustering, but does not provide clonal genotypes. These methods show good performance on small datasets, but may suffer from low efficiency when dealing with complex clonal architectures. Clustering cells without phylogeny inference forms another paradigm for detecting tumor clones. For instance, SCG (<xref rid="btac790-B28" ref-type="bibr">Roth <italic toggle="yes">et al.</italic>, 2016</xref>) leverages variational inference to estimate clonal composition and genotypes. BnpC (<xref rid="btac790-B3" ref-type="bibr">Borgsmüller <italic toggle="yes">et al.</italic>, 2020</xref>) employs a Bayesian model to jointly infer tumor clones and their genotypes, while it suffers from high computational complexity especially on large datasets (<xref rid="btac790-B36" ref-type="bibr">Yu and Du, 2022</xref>). SBMClone (<xref rid="btac790-B23" ref-type="bibr">Myers <italic toggle="yes">et al.</italic>, 2020</xref>) uses a biclustering method to identify blocks of cells and blocks of mutations from sparse mutation data and can deal with dataset containing tens of thousands of single-nucleotide variations. One disadvantage of SBMClone is that it does not output genotypes of inferred clones. SCClone (<xref rid="btac790-B38" ref-type="bibr">Yu <italic toggle="yes">et al.</italic>, 2022</xref>) employs an expectation–maximization algorithm to jointly infer tumor clones and their mutational states, but suffers from high computational complexity on large datasets. Taken together, clustering high-dimensional single-cell mutation data is a hard challenge, and more efficient and accurate methods are still needed for scDNA-seq mutation data.</p>
    <p>In this article, we introduce a novel method called bmVAE to cluster single-cell mutation data based on a variational autoencoder (VAE). VAE combines unsupervised deep learning with Bayesian inference and acts as an important type of generative models (<xref rid="btac790-B2" ref-type="bibr">Bi <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btac790-B11" ref-type="bibr">Goodfellow <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac790-B13" ref-type="bibr">Higgins <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btac790-B17" ref-type="bibr">Kingma and Welling, 2013</xref>). It has been widely used to project single-cell RNA sequencing (scRNA-seq) data into a latent space where single cells are clustered (<xref rid="btac790-B12" ref-type="bibr">Grønbech <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac790-B22" ref-type="bibr">Mitra and MacLean, 2021</xref>; <xref rid="btac790-B26" ref-type="bibr">Rashid <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac790-B31" ref-type="bibr">Svensson <italic toggle="yes">et al.</italic>, 2020</xref>). For instance, Dhaka (<xref rid="btac790-B26" ref-type="bibr">Rashid <italic toggle="yes">et al.</italic>, 2021</xref>) uses a VAE model to unmask tumor heterogeneity from copy number alterations or gene expression data of single cells. The intuition behind our modeling of single-cell mutation data using a VAE-based approach is that the observed mutational signatures actually result from some underlying biological processes related to tumor evolution, and these processes are represented as distribution over the latent space (<xref rid="btac790-B26" ref-type="bibr">Rashid <italic toggle="yes">et al.</italic>, 2021</xref>). bmVAE first employs a VAE model to learn latent representation of each cell in a low-dimensional space, then uses a Gaussian mixture model (GMM) to find clusters of cells, finally uses a Gibbs sampling-based approach to estimate genotypes of each subpopulation. To the best of our knowledge, bmVAE is the first method that employs VAE model to scDNA-seq data for dimensionality reduction. We comprehensively compare bmVAE to the state-of-the-art methods on both simulated and real datasets, and the results show our method is an effective complementation to current arsenal of methods for detecting tumor clones from scDNA-seq mutation data.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>The framework of bmVAE consists of three modules: dimensionality reduction, cell clustering and genotype estimation (as shown in <xref rid="btac790-F1" ref-type="fig">Fig. 1</xref>). For dimensionality reduction, we use the VAE to project mutation data of each cell into a low-dimensional space. Based on the learned latent representation, cells are clustered into distinct subpopulations via the GMM and the optimal number of clusters is selected using Bayesian information criterion (BIC). Given the labels of cells inferred by the GMM, the Gibbs sampling method is used to reason the genotypes of each subpopulation. The following sections provide detailed descriptions about the three modules of bmVAE.</p>
    <fig position="float" id="btac790-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>The framework of bmVAE. The workflow of bmVAE consists of three steps: dimensionality reduction, cell clustering and genotype estimation. bmVAE first uses a VAE to infer the low-dimensional representation of each cell by minimizing the Kullback–Leibler divergence loss and reconstruction loss (measured using cross-entropy). Based on the latent features of cells, GMM is employed to cluster cells into distinct subpopulations each of which has a different complement of mutations. Given the inferred cell-to-cluster assignments, Gibbs sampling method is used to estimate the genotypes of each subpopulation based on the input binary mutation data</p>
      </caption>
      <graphic xlink:href="btac790f1" position="float"/>
    </fig>
    <sec>
      <title>2.1 VAE for dimensionality reduction</title>
      <p>Given a binary genotype matrix <italic toggle="yes">X</italic> of <italic toggle="yes">N</italic> cells at <italic toggle="yes">M</italic> genomic loci, we aim to learn an effective low-dimensional representation <italic toggle="yes">Z</italic> of <italic toggle="yes">X</italic> through unsupervised learning via the VAE model. The VAE consists of an encoder <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mo>ϕ</mml:mo></mml:math></inline-formula> to deduce the conditional distribution <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>ϕ</mml:mo></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of latent representation <italic toggle="yes">z</italic> given input <italic toggle="yes">x</italic> (here <italic toggle="yes">x</italic> denotes the mutational profile of a cell and is recorded as one row of <italic toggle="yes">X</italic>), and a decoder <italic toggle="yes">θ</italic> to reconstruct <italic toggle="yes">x</italic> from <italic toggle="yes">z</italic>. Instead of representing the input data under an unconstrained manner, we impose a regularization constraint on the distribution of latent variables. Specifically, we assume <italic toggle="yes">z</italic> follows a multivariate Gaussian that has a diagonal covariance matrix, i.e. <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>z</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script" class="calligraphy">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This assumption is reasonable as distinct tumor clones have different mutational patterns that are characterized by the underlying tumor phylogenetic tree. The mutational patterns result from some biological processes related to tumor evolution, and these processes are modeled as the latent variables that are assumed to be independent with each other. A forward propagation of the VAE can now be described as: (i) the encoder <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mo>ϕ</mml:mo></mml:math></inline-formula> takes <italic toggle="yes">x</italic> (the missing elements of <italic toggle="yes">x</italic> are simply set to 0) as input and outputs the means <italic toggle="yes">μ<sub>z</sub></italic> and variances <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> of the normal distributions; (ii) the latent representation <italic toggle="yes">z</italic> is sampled from the distribution <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>z</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>; and (iii) the decoder <italic toggle="yes">θ</italic> takes <italic toggle="yes">z</italic> as input to reconstruct the input <italic toggle="yes">x</italic>.</p>
      <p>The VAE model is trained to minimize the reconstruction loss <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>;</mml:mo><mml:mo>ϕ</mml:mo><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> under the regularization constraint applied on the posterior distribution <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>ϕ</mml:mo></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the output of the decoder. Formally, the optimization problem is formulated as follows:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mo>ϕ</mml:mo><mml:mo>,</mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:munder><mml:mo>λ</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>ϕ</mml:mo></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>θ</mml:mo></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>;</mml:mo><mml:mo>ϕ</mml:mo><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">λ</italic> is a weight factor, <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denotes the Kullback–Leibler divergence and <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>θ</mml:mo></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> represents the true posterior of <italic toggle="yes">z</italic>. To make sure gradient descent algorithm can be used to train our model, we employ the reparameterization trick proposed in <xref rid="btac790-B17" ref-type="bibr">Kingma and Welling (2013)</xref> to make the optimization function differentiable (we do not directly sample <italic toggle="yes">z</italic> from the posterior but generate <italic toggle="yes">z</italic> with <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>z</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>z</mml:mi></mml:msub><mml:mo>⊙</mml:mo><mml:mo>ϵ</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">ϵ</italic> is sampled from the standard normal distribution). This reformulation enables the gradient can be backward propagated for updating the model parameters.</p>
      <p>For binary mutation data, we treat each element of <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> as the probability parameter of Bernoulli distribution, and regard corresponding element of <italic toggle="yes">x</italic> as the observation, then the loss function <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>;</mml:mo><mml:mo>ϕ</mml:mo><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> can be defined as:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>;</mml:mo><mml:mo>ϕ</mml:mo><mml:mo>,</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">M</italic> is the number of mutations, and we apply cross-entropy loss for each element of <italic toggle="yes">x</italic> (missing entries of <italic toggle="yes">x</italic> are not considered when calculating the loss). By calculating the mean loss for a batch of samples, we employ gradient descent algorithm to jointly update the parameters of encoder and decoder. After the model converges, each cell is passed through the encoder to get its latent representation <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.2 GMM for cell clustering</title>
      <p>We use the GMM to cluster cells into distinct subpopulations based on the latent representations, and employ BIC to determine the best number of clusters. Formally, we begin with data homogeneity assumption (all cells come from same population), and iteratively increase the number of clusters until the minimum BIC value has not changed at least <italic toggle="yes">κ</italic> times (<italic toggle="yes">κ</italic> is set to 10 in this study) or a predefined maximum number of clusters is reached. This clustering procedure finally gives the labels of cells that can be used to infer the binary mutational profile of each subpopulation.</p>
    </sec>
    <sec>
      <title>2.3 Gibbs sampling for genotype estimation</title>
      <p>Cells originating from the same cluster share highly similar mutational profile, and inferring the underlying mutational profile of each cluster is an optimization problem over discrete space where the latent state is binary. As scDNA-seq mutation data are frequently confounded by FN and FP errors, parametric modeling of these errors is essential for accurately predicting the mutational states of tumor clones. Formally, we employ the Gibbs sampling to reason the posterior of the genotypes, and infer the maximum-likelihood estimations of the error rates. Suppose the inferred labels of cells are denoted by a vector <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, <italic toggle="yes">E</italic> is a <italic toggle="yes">K </italic>×<italic toggle="yes"> M</italic> binary matrix to represent the mutational states of <italic toggle="yes">K</italic> clusters, FP rate (FPR) and FN rate (FNR) are <italic toggle="yes">α</italic> and <italic toggle="yes">β</italic>, respectively, we calculate the posterior of <italic toggle="yes">E<sub>kj</sub></italic> as follows:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>Δ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mi>p</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where we use <italic toggle="yes">t</italic> to denote the iteration index of Gibbs sampling, assume uniform prior for <italic toggle="yes">E<sub>kj</sub></italic>, set both <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to 0.01. The conditional probability <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is defined as adopted in <xref rid="btac790-B28" ref-type="bibr">Roth <italic toggle="yes">et al.</italic> (2016)</xref>:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>α</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mo>β</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>α</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>β</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>We then sample each <italic toggle="yes">E<sub>kj</sub></italic> from the posterior to generate <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Given the mutational states of all clusters, the parameters <italic toggle="yes">α</italic> and <italic toggle="yes">β</italic> can be updated by maximizing the log-likelihood:
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>In summary, the parameters <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are sampled or updated by following three steps: (i) initialize <italic toggle="yes">α</italic> and <italic toggle="yes">β</italic> at time step <italic toggle="yes">t </italic>=<italic toggle="yes"> </italic>0; (ii) calculate the posterior of <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and generate <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> by sampling from the posterior; (iii) update <italic toggle="yes">α</italic> and <italic toggle="yes">β</italic> to get <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>; (iv) repeat Steps (i) and (iii) until the model converges. More details about parameter estimation are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>.</p>
    </sec>
    <sec>
      <title>2.4 Datasets</title>
      <p>There are several factors that control the generation of scDNA-seq mutation data, these factors include <italic toggle="yes">α</italic>, <italic toggle="yes">β</italic>, <italic toggle="yes">N</italic>, <italic toggle="yes">M</italic> and <italic toggle="yes">K</italic>. To fully assess the performance of bmVAE, we simulate various datasets by specifying different combinations of <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>β</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The default values are set to <italic toggle="yes">α</italic> = 0.01, <italic toggle="yes">β</italic> = 0.3, <italic toggle="yes">N </italic>=<italic toggle="yes"> </italic>1000, <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>1000 and <italic toggle="yes">K </italic>=<italic toggle="yes"> </italic>20. For each of the controlling factors, the candidate values selected for simulation are {0.3, 0.4, 0.5, 0.6} for <italic toggle="yes">β</italic> (dataset D1), {500, 1000, 2000, 5000} for <italic toggle="yes">N</italic> (dataset D2) and M (dataset D3) and {20, 30, 40, 50} for K (dataset D4). We also generate two smaller datasets to examine the minimum number of cells and mutations required by bmVAE to make accurate inferences: <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi><mml:mo>∈</mml:mo></mml:mrow></mml:math></inline-formula> {100, 200, 300, 400, 500}, <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>100 and <italic toggle="yes">K </italic>=<italic toggle="yes"> </italic>5 for dataset D5; <italic toggle="yes">N </italic>=<italic toggle="yes"> </italic>500, <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>∈</mml:mo></mml:mrow></mml:math></inline-formula> {20, 30, 40, 50, 60} and <italic toggle="yes">K </italic>=<italic toggle="yes"> </italic>5 for dataset D6. We repeat the simulation five times for each setting of the parameters, thus get a total of 130 datasets for testing. In addition, to mimic doublet events, 10% of cells in each simulation are randomly selected to generate doublets following the approaches in <xref rid="btac790-B4" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> (2020)</xref> and <xref rid="btac790-B15" ref-type="bibr">Jahn <italic toggle="yes">et al.</italic> (2016)</xref>. More details about the simulation procedure are given in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>.</p>
      <p>We also obtain a high-grade serous ovarian cancer (HGSOC) dataset (<xref rid="btac790-B21" ref-type="bibr">McPherson <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btac790-B28" ref-type="bibr">Roth <italic toggle="yes">et al.</italic>, 2016</xref>) and an IDH-mutant gliomas dataset (<xref rid="btac790-B5" ref-type="bibr">Ciccolella <italic toggle="yes">et al.</italic>, 2021a</xref>; <xref rid="btac790-B34" ref-type="bibr">Venteicher <italic toggle="yes">et al.</italic>, 2017</xref>) to further assess our method.</p>
    </sec>
    <sec>
      <title>2.5 Performance evaluation</title>
      <p>We compare bmVAE to four state-of-the-art methods including RobustClone (<xref rid="btac790-B4" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2020</xref>), BnpC (<xref rid="btac790-B3" ref-type="bibr">Borgsmüller <italic toggle="yes">et al.</italic>, 2020</xref>), AMC (<xref rid="btac790-B36" ref-type="bibr">Yu and Du, 2022</xref>) and SCClone (<xref rid="btac790-B38" ref-type="bibr">Yu <italic toggle="yes">et al.</italic>, 2022</xref>), and two baseline dimensionality reduction methods including PCA (<xref rid="btac790-B16" ref-type="bibr">Joliffe and Morgan, 1992</xref>) and t-SNE (<xref rid="btac790-B33" ref-type="bibr">van der Maaten and Hinton, 2008</xref>). We select these methods for evaluation as they are significantly different from each other in the way of clustering mutation data. When making comparison to PCA and t-SNE, we replace the first module (dimensionality reduction) of bmVAE with the PCA and t-SNE, while remain other components unchanged. More details about how each method is used are provided in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>.</p>
      <p>We use two performance metrics to compare different methods. First, given the predicted and ground truth labels of cells, adjusted rand index (ARI) is calculated to evaluate clustering accuracy. Second, by comparing the inferred and ground truth genotype matrices, we use genotyping accuracy to indicate how well a method recovers the underlying mutational states of single cells. All methods except RobustClone are run five times on each sample to get the best performance metrics.</p>
    </sec>
    <sec>
      <title>2.6 Implementation</title>
      <p>All layers of the VAE network are fully-connected layers. Specifically, the encoder is composed of two hidden layers each with <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>/</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>/</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> neurons and a 3D latent layer, and the decoder has a mirrored structure to the encoder (a coarse search of the architecture hyper-parameters is given in Section 3.1). We use Leaky Rectified Linear unit (LeakyReLU) activation function in intermediate layers of the encoder and decoder, while employ sigmoid activation function in the final layer of the decoder. The network weights are updated using ‘RMSprop’ algorithm with learning rate of 0.0001 and batch size of 64. We set the number of epochs to 300, 300 and 50 on the simulated, HGSOC and IDH-mutant gliomas datasets, respectively. The weight factor <italic toggle="yes">λ</italic> in training the VAE is set to 0.0001 (details on search of the <italic toggle="yes">λ</italic> values can be found in Section 3.1). We run all the experiments on a computational server with 128 GB RAM, 64 CPU cores and 1 GeForce RTX 2080 Ti GPU. bmVAE is implemented in PyTorch, and the source code is freely available at <ext-link xlink:href="https://github.com/zhyu-lab/bmvae" ext-link-type="uri">https://github.com/zhyu-lab/bmvae</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Hyper-parameter search</title>
      <p>We conduct a coarse search of the architecture hyper-parameters, such as number of layers and hidden nodes of each layer. Specifically, values of 2, 3 and 4 are tested for the number of layers of the encoder network, and the numbers of hidden nodes in each layer are set to <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>/</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>M</mml:mi><mml:mo>/</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>M</mml:mi><mml:mo>/</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>/</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math></inline-formula>, respectively. We compare the clustering results associated with different architecture hyper-parameters (as shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>) on the simulated dataset D1, and the parameter setting of two hidden layers each with <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>/</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>/</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> hidden nodes gives the best results, therefore, we chose this architecture to analyze all datasets. In addition, we test different latent dimensions and compare the clustering and genotyping results. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref>, setting latent dimension to three achieves the best performance, and we set latent dimension to three on all experiments.</p>
      <p>We also investigate the effect of hyper-parameter <italic toggle="yes">λ</italic> on clustering results. Specifically, values in {1e−5, 5e−5, 0.0001, 0.0005, 0.001} are tested for <italic toggle="yes">λ</italic>, and the comparison of clustering results on the simulated dataset D1 is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S3</xref>. The results indicate setting <italic toggle="yes">λ</italic> to 0.0001 produces the highest ARI and genotyping accuracy, therefore, we use <italic toggle="yes">λ </italic>= 0.0001 on all experiments.</p>
    </sec>
    <sec>
      <title>3.2 Results on simulated datasets</title>
      <sec>
        <label>3.2.1</label>
        <title>bmVAE shows higher robustness to the change of FNR</title>
        <p>We first assess bmVAE on the simulated dataset D1 where the FNR <italic toggle="yes">β</italic> is in {0.3, 0.4, 0.5, 0.6}. An example of the clustering results of bmVAE is depicted in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref>. The performance comparison results (<xref rid="btac790-F2" ref-type="fig">Fig. 2</xref>) show bmVAE achieves the highest accuracy on both clustering and genotyping compared to other methods. For instance, with <italic toggle="yes">β</italic> = 0.3, bmVAE performs the best with mean ARI of &gt;0.999 and genotyping accuracy of &gt;0.999, AMC outperforms other existing methods by achieving mean ARI of 0.98 as well as genotyping accuracy of &gt;0.999, and BnpC also exhibits good performance with corresponding metric values of 0.966 and 0.999, whereas RobustClone and SCClone show lower accuracy. By comparison, t-SNE gets similar performance to BnpC, while dimensionality reduction using PCA does not provide similar results as bmVAE, indicating PCA is less effective in clustering binary data. When <italic toggle="yes">β</italic> increases to 0.6, the performance of each method degrades as the information related to clonal composition is severely attenuated by FN errors. Our method still gets higher accuracy than other methods on the highly disturbed binary data, it delivers average ARI of 0.947, while the ARIs of BnpC, AMC, SCClone, RobustClone, PCA and t-SNE are 0.86, 0.532, 0.658, 0.016, 0.389 and 0.421, respectively. An example of the clustering results with bmVAE, PCA and t-SNE when <italic toggle="yes">β</italic> = 0.6 is given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref>, and the results clearly show the superior performance of bmVAE in learning latent representations of the cells. The results also suggest RobustClone is sensitive to FN errors, thus its performance degrades significantly when <italic toggle="yes">β</italic> increases.</p>
        <fig position="float" id="btac790-F2">
          <label>Fig. 2.</label>
          <caption>
            <p>Performance comparison results on simulated datasets. The simulated FNR <italic toggle="yes">β</italic> changes from 0.3 to 0.6, number of cells <italic toggle="yes">N</italic> and number of mutations <italic toggle="yes">M</italic> change from 500 to 5000 and number of clusters <italic toggle="yes">K</italic> ranges from 20 to 50. Two performance metrics including ARI for clustering and genotyping accuracy are employed to assess the methods</p>
          </caption>
          <graphic xlink:href="btac790f2" position="float"/>
        </fig>
        <p>We also make a comparison between bmVAE and BnpC in estimating the FNR. The results in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6</xref> show the predictions of bmVAE are closer to the ground truth value, while BnpC tends to underestimate the FNR, which may explain the better performance gained by bmVAE in both clustering and genotyping.</p>
      </sec>
      <sec>
        <label>3.2.2</label>
        <title>bmVAE performs well on different-sized datasets</title>
        <p>We evaluate the robustness of bmVAE to change in data size by applying it to the simulated datasets D2 and D3 where the number of cells <italic toggle="yes">N</italic> or mutations <italic toggle="yes">M</italic> is in {500, 1000, 2000, 5000}.</p>
        <p>The results on dataset D2 (<xref rid="btac790-F2" ref-type="fig">Fig. 2</xref>) suggest bmVAE’ performance is robust to the change of number of cells. When mutation data of more than 1000 cells are exploited, bmVAE is able to accurately decipher the clonal composition (an example of the clustering results is given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>) and recover the mutational profiles of cells, implying bmVAE effectively captures underlying evolutional patterns in latent space and maps them into distinct clusters. bmVAE also shows good runtime efficiency, and only requires ∼7 min per sample when handling large genotype matrix with <italic toggle="yes">N </italic>=<italic toggle="yes"> </italic>5000. BnpC achieves similar accuracy to bmVAE when <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi><mml:mo>≥</mml:mo></mml:mrow></mml:math></inline-formula> 2000, while it uses ∼100 min to process a sample with <italic toggle="yes">N </italic>=<italic toggle="yes"> </italic>5000. Compared to bmVAE and BnpC, AMC suffers from slightly degraded performance as the number of cells increases, and SCClone’ accuracy fluctuates significantly on large datasets, which indicates it may frequently converge to suboptimal solutions. Same to bmVAE and BnpC, RobustClone yields improved genotyping accuracy when more cells are used for analysis. As RobustClone first recovers genotypes of the cells and then finds cell clusters, the improvement on genotyping accuracy does not promise an elevation on clustering accuracy. Interestingly, increasing the number of cells appreciably enhances the performance of t-SNE in clustering cells, thus enables improved genotyping results. For instance, the mean ARI of t-SNE increases from 0.208 at <italic toggle="yes">N </italic>=<italic toggle="yes"> </italic>500 to 0.965 at <italic toggle="yes">N </italic>=<italic toggle="yes"> </italic>5000. By comparison, PCA is less effective than t-SNE as the clustering accuracy does not change significantly across different <italic toggle="yes">N</italic> values.</p>
        <p>We proceed to investigate how well bmVAE and other methods perform when the number of mutations changes. The results in <xref rid="btac790-F2" ref-type="fig">Figure 2</xref> show bmVAE, AMC, PCA, t-SNE and RobustClone get elevated accuracy when the number of mutations increases. For instance, mean clustering accuracy of t-SNE improves from 0.681 at <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>500 to 0.983 at <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>5000, and bmVAE consistently achieves &gt;0.98 ARI across different <italic toggle="yes">M</italic> values. AMC performs similarly to bmVAE when <italic toggle="yes">M </italic>&gt;<italic toggle="yes"> </italic>1000. The mutational difference between tumor clones is enhanced with the increased number of mutations; therefore, the mutational patterns that distinguish different clones can be represented more effectively in latent space, which may contribute as a main factor resulting in the performance boost of bmVAE, PCA and t-SNE. As AMC and RobustClone employ PCA based methods to recover the genotypes of cells, their genotyping accuracies also improve with the number of mutations. By comparison, BnpC shows degraded accuracy when the number of mutations increases (its clustering accuracy decreases from 0.969 at <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>500 to 0.807 at <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>5000), and SCClone performs better than RobustClone and PCA. As BnpC jointly infers the cell clusters and their genotypes, it generally yields better clustering results than RobustClone especially on datasets with <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mo>≤</mml:mo></mml:math></inline-formula>1000 mutations.</p>
        <p>To determine the minimum number of cells and mutations required by bmVAE to make accurate inferences, we further evaluate bmVAE on the simulated datasets D5 and D6. The number of cells <italic toggle="yes">N</italic> ranges from 100 to 500 for D5 and the number of mutations <italic toggle="yes">M</italic> varies from 20 to 60 for D6. The results in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S8</xref> imply with <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mo>≥</mml:mo></mml:math></inline-formula>200 cells bmVAE is able to accurately recover the clonal structure and estimate the genotypes. In addition, the results in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S9 and S10</xref> show with &gt;30 mutations bmVAE achieves &gt;0.91 median clustering accuracy and &gt;0.995 median genotyping accuracy. Taken together, we recommend using bmVAE on datasets with at least 200 cells and 30 mutations.</p>
      </sec>
      <sec>
        <label>3.2.3</label>
        <title>bmVAE is able to better detect clusters</title>
        <p>We benchmark all methods on the simulated dataset D4, where the number of clusters <italic toggle="yes">K</italic> changes from 20 to 50, to check how data heterogeneity affects the clustering and genotyping accuracy. The number of cells and mutations are set to 2000. It is observed from <xref rid="btac790-F2" ref-type="fig">Figure 2</xref> that all methods tend to yield less accurate clustering results on datasets with higher data heterogeneity. For instance, the mean ARIs of bmVAE, BnpC, AMC, SCClone, RobustClone and t-SNE are 0.992, 0.968, 0.991, 0.991, 0.424 and 0.978 at <italic toggle="yes">K </italic>=<italic toggle="yes"> </italic>20, while decrease to 0.943, 0.698, 0.893, 0.709, 0.213 and 0.694 at <italic toggle="yes">K </italic>=<italic toggle="yes"> </italic>50, respectively. Compared to other methods, bmVAE appreciably gets higher clustering accuracy across different values of <italic toggle="yes">K</italic>, and also consistently maintains better genotyping results especially when <italic toggle="yes">K </italic>=<italic toggle="yes"> </italic>50. The results also suggest PCA and t-SNE are less effective than bmVAE in learning latent representations of cells from data with high heterogeneity.</p>
        <p>To further assess how well each method performs in predicting clonal composition, we make a comparison between the estimated and ground truth number of clusters, and the results are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S11</xref>. On simple datasets with 20 clusters, bmVAE, BnpC, AMC, SCClone and t-SNE are able to report the number of clusters close to the ground truth, while RobustClone and PCA consistently underestimate the number of clusters in all cases, which explains their lower clustering and genotyping accuracy. On highly heterogeneous datasets with more than 30 clusters, all methods except AMC tend to underestimate the number of clusters whereas AMC overestimates it, and bmVAE still yields better predictions that are closer to the true value.</p>
      </sec>
    </sec>
    <sec>
      <title>3.3 Results on real datasets</title>
      <sec>
        <label>3.3.1</label>
        <title>HGSOC dataset</title>
        <p>The HGSOC dataset describes binary genotypes of 420 cells at 43 genomic loci. The cells are taken from omentum (Om), left ovary (LOv) and right ovary (ROv). Previous studies have applied RobustClone, BnpC and SCClone to this dataset for detecting tumor clones, and all of the three methods identify five clusters.</p>
        <p>We check if bmVAE is able to give similar findings as RobustClone, BnpC and SCClone on this dataset. Interestingly, bmVAE clusters the cells into five subpopulations by learning latent representations of the cells in a 3D space (<xref rid="btac790-F3" ref-type="fig">Fig. 3A and B</xref>), and estimates the error rates as FPR = 0.028 and FNR = 0.338. Similar to the clustering results observed on the simulated dataset D6 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>), the distances between distinct clusters are less significant in the latent space, while they are still clearly separated and keep a reasonable margin with each other. The clustering results show there are apparent mutational differences between cells originating from different tumor sites. For instance, Cluster 3 mainly consists of ROv and Om cells taken from metastatic tumor sites, Cluster 4 mainly contains LOv cells that originate from the primary tumor site, while Cluster 5 only encompasses ROv and Om cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>), and our findings are similar to the reported results of BnpC. In addition, we further examine if PCA and t-SNE are also effective in learning low-dimensional representations of cells on this dataset. The results show both PCA and t-SNE detect five clusters (<xref rid="btac790-F3" ref-type="fig">Fig. 3A</xref>). Compared to PCA and t-SNE, bmVAE produces clearer boundary between distinct clusters in the latent space.</p>
        <fig position="float" id="btac790-F3">
          <label>Fig. 3.</label>
          <caption>
            <p>Clustering and genotyping results on real datasets. (<bold>A</bold>) Clustering results of bmVAE, PCA and t-SNE in low-dimensional space. On the HGSOC dataset (left subplots), bmVAE, PCA and t-SNE find five clusters. On the IDH-mutant gliomas dataset (right subplots), bmVAE clusters the cells into eight subpopulations, PCA finds seven clusters and t-SNE captures five clusters; (<bold>B</bold>) genotypes of subpopulations estimated by bmVAE on HGSOC dataset; (<bold>C</bold>) genotypes of subpopulations estimated by bmVAE on the IDH-mutant gliomas dataset</p>
          </caption>
          <graphic xlink:href="btac790f3" position="float"/>
        </fig>
      </sec>
      <sec>
        <label>3.3.2</label>
        <title>IDH-mutant gliomas dataset</title>
        <p>Finally, we apply bmVAE to the IDH-mutant glioma dataset that contains a 926 × 1392 genotype matrix. bmVAE takes 2 min to finish the clustering and genotyping pipeline, identifies a normal population and seven tumor clones (<xref rid="btac790-F3" ref-type="fig">Fig. 3A and C</xref>). The estimated error rates are FPR = 0.015 and FNR = 0.727, which suggests the data may be heavily confounded by ADO.</p>
        <p>We also obtain results of BnpC and RobustClone on this dataset, to evaluate the similarity of the tumor clonal structures captured by different methods. BnpC finds as high as 33 clusters, estimates the FPR as 0.011 and FNR as 0.77. Compared to bmVAE, BnpC yields similar predictions of the error rates, but subdivides the cells into more small clusters. Conversely, RobustClone fails to identify any tumor clones due to high sparsity of the data and assigns all cells to normal population, which is in concordance with the results observed on simulated dataset D1 that RobustClone suffers from severe performance degradation on high FNR data. AMC reports 18 clusters on this dataset while estimates the error rates as FPR = 0.0096 and FNR = 0.81 (<xref rid="btac790-B36" ref-type="bibr">Yu and Du, 2022</xref>). These results, to some extent, are similar to those of bmVAE and BnpC. Moreover, we use PCA and t-SNE to reduce the dimensionality, and cluster cells based on the projected low-dimensional data. PCA identifies seven clusters on this dataset, while the inferred clusters are not clearly separated in the latent space (as shown in <xref rid="btac790-F3" ref-type="fig">Fig. 3A</xref>). t-SNE finds five clusters, and may underestimate the underlying number of clusters as the results on simulated dataset D1 show t-SNE is less effective in clustering cells from high FNR data.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Clustering single-cell mutation data comes as an important paradigm of analyzing scDNA-seq data and can be treated as a preprocessing task to reduce data size before inference of tumor phylogeny. In this article, we develop a VAE-based method for this purpose, and our method is specifically designed to process binary data. One advantage of bmVAE is the effective learning of latent representation of cell via the VAE model. VAE has been successfully applied to scRNA-seq data for dimensionality reduction and shows better performance compared to conventional methods, such as PCA and t-SNE. This encourages us to introduce a new VAE model for single-cell binary mutation data, and infer the low-dimensional representation of mutational patterns that characterize distinct tumor clones, which facilitates clustering of cells with high efficiency. Another advantage of bmVAE is the efficient estimation of clonal genotypes via Gibbs sampling method. Given the learned labels of cells, the clonal genotypes as well as error rates are efficiently inferred under a Gibbs sampling scheme. Unlike the pipeline adopted by RobustClone that first recovers the genotypes of cells and then finds clusters of the cells, our method employs a contrary flow and gains higher robustness in both clustering and genotyping.</p>
    <p>Despite of the novelty mentioned above, there are still two limitations in using bmVAE. First, some of the clusters may result from doublet cells, while bmVAE does not distinguish between them and true clonal clusters, which may affect the inference accuracy when doublets frequently occur in the data. Incorporating the effects of doublets into the downstream analysis may deliver more accurate predictions of the clonal genotypes, while this requires more complex statistical models. Second, the lineage relationship between distinct clones is defined in the underlying tumor phylogeny that imposes a constraint on the mutational states of clones, while bmVAE does not consider tumor phylogeny when estimating the genotypes, which may lead to biased predictions. Joint estimation of clonal genotypes and tumor phylogeny is an effective way to further improve the inference accuracy of bmVAE. As mutations that appear in the same edge or node of the phylogeny tree can be grouped together (<xref rid="btac790-B36" ref-type="bibr">Yu and Du, 2022</xref>), biclustering can be used to jointly find blocks of cells and blocks of mutations, which helps to yield more accurate predictions of tumor clones. We plan to investigate this research direction in near future.</p>
    <p>In summary, we introduce bmVAE for clustering single-cell mutation data based on dimensionality reduction. bmVAE can be used as a plug-in module in the pipeline of tumor phylogeny inference to reduce the data size, thus improves the efficiency and accuracy of tumor tree reconstruction.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac790_Supplementary_Data</label>
      <media xlink:href="btac790_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This work was supported in part by the National Natural Science Foundation of China [61901238]; and West Light Foundation of The Chinese Academy of Sciences [XAB2019AW12].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article will be shared on reasonable request to the corresponding author.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac790-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Azer</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>PhISCS-BnB: a fast branch and bound algorithm for the perfect tumor phylogeny reconstruction problem</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>i169</fpage>–<lpage>i176</lpage>.<pub-id pub-id-type="pmid">32657358</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bi</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>IHGC-GAN: influence hypergraph convolutional generative adversarial network for risk prediction of late mild cognitive impairment based on imaging genetic data</article-title>. <source>Brief. Bioinform</source>., <volume>23</volume>, <fpage>bbac093</fpage>.<pub-id pub-id-type="pmid">35348583</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Borgsmüller</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>BnpC: Bayesian non-parametric clustering of single-cell mutation profiles</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>4854</fpage>–<lpage>4859</lpage>.<pub-id pub-id-type="pmid">32592465</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>RobustClone: a robust PCA method for tumor clone and evolution inference from single-cell sequencing data</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>3299</fpage>–<lpage>3306</lpage>.<pub-id pub-id-type="pmid">32159762</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ciccolella</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021a</year>) <article-title>Effective clustering for single cell sequencing cancer data</article-title>. <source>IEEE J. Biomed. Health Inform</source>., <volume>25</volume>, <fpage>4068</fpage>–<lpage>4078</lpage>.<pub-id pub-id-type="pmid">34003758</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ciccolella</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021b</year>) <article-title>Inferring cancer progression from Single-Cell Sequencing while allowing mutation losses</article-title>. <source>Bioinformatics</source>, <volume>37</volume>, <fpage>326</fpage>–<lpage>333</lpage>.<pub-id pub-id-type="pmid">32805010</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eaton</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Deconvolution and phylogeny inference of structural variations in tumor genomic samples</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>i357</fpage>–<lpage>i365</lpage>.<pub-id pub-id-type="pmid">29950001</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>El-Kebir</surname><given-names>M.</given-names></string-name></person-group> (<year>2018</year>) <article-title>SPhyR: tumor phylogeny estimation from single-cell sequencing data under loss and error</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>i671</fpage>–<lpage>i679</lpage>.<pub-id pub-id-type="pmid">30423070</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gawad</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Dissecting the clonal origins of childhood acute lymphoblastic leukemia by single-cell genomics</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>111</volume>, <fpage>17947</fpage>–<lpage>17952</lpage>.<pub-id pub-id-type="pmid">25425670</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gawad</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Single-cell genome sequencing: current state of the science</article-title>. <source>Nat. Rev. Genet</source>., <volume>17</volume>, <fpage>175</fpage>–<lpage>188</lpage>.<pub-id pub-id-type="pmid">26806412</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goodfellow</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Generative adversarial networks</article-title>. <source>Commun. ACM</source>, <volume>63</volume>, <fpage>139</fpage>–<lpage>144</lpage>.</mixed-citation>
    </ref>
    <ref id="btac790-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grønbech</surname><given-names>C.H.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>scVAE: variational auto-encoders for single-cell gene expression data</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>4415</fpage>–<lpage>4422</lpage>.<pub-id pub-id-type="pmid">32415966</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Higgins</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) beta-VAE: learning basic visual concepts with a constrained variational framework. In: <italic toggle="yes">International Conference on Learning Representations, Toulon, France.</italic></mixed-citation>
    </ref>
    <ref id="btac790-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hou</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Single-cell exome sequencing and monoclonal evolution of a JAK2-negative myeloproliferative neoplasm</article-title>. <source>Cell</source>, <volume>148</volume>, <fpage>873</fpage>–<lpage>885</lpage>.<pub-id pub-id-type="pmid">22385957</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jahn</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Tree inference for single-cell data</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>86</fpage>.<pub-id pub-id-type="pmid">27149953</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Joliffe</surname><given-names>I.T.</given-names></string-name>, <string-name><surname>Morgan</surname><given-names>B.</given-names></string-name></person-group> (<year>1992</year>) <article-title>Principal component analysis and exploratory factor analysis</article-title>. <source>Stat. Methods Med. Res</source>., <volume>1</volume>, <fpage>69</fpage>–<lpage>95</lpage>.<pub-id pub-id-type="pmid">1341653</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Kingma</surname><given-names>D.P.</given-names></string-name>, <string-name><surname>Welling</surname><given-names>M.</given-names></string-name></person-group> (<year>2013</year>) Auto-encoding variational bayes. <italic toggle="yes">arXiv preprint arXiv:1312.6114.</italic></mixed-citation>
    </ref>
    <ref id="btac790-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kozlov</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>CellPhy: accurate and fast probabilistic inference of single-cell phylogenies from scDNA-seq data</article-title>. <source>Genome Biol</source>., <volume>23</volume>, <fpage>37</fpage>.<pub-id pub-id-type="pmid">35081992</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuipers</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Advances in understanding tumour evolution through single-cell sequencing</article-title>. <source>Biochim. Biophys. Acta. Rev. Cancer</source>, <volume>1867</volume>, <fpage>127</fpage>–<lpage>138</lpage>.<pub-id pub-id-type="pmid">28193548</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levine</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Data-driven phenotypic dissection of AML reveals progenitor-like cells that correlate with prognosis</article-title>. <source>Cell</source>, <volume>162</volume>, <fpage>184</fpage>–<lpage>197</lpage>.<pub-id pub-id-type="pmid">26095251</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McPherson</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Divergent modes of clonal spread and intraperitoneal mixing in high-grade serous ovarian cancer</article-title>. <source>Nat. Genet</source>., <volume>48</volume>, <fpage>758</fpage>–<lpage>767</lpage>.<pub-id pub-id-type="pmid">27182968</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mitra</surname><given-names>R.</given-names></string-name>, <string-name><surname>MacLean</surname><given-names>A.L.</given-names></string-name></person-group> (<year>2021</year>) <article-title>RVAgene: generative modeling of gene expression time series data</article-title>. <source>Bioinformatics</source>, <volume>37</volume>, <fpage>3252</fpage>–<lpage>3262</lpage>.<pub-id pub-id-type="pmid">33974008</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Myers</surname><given-names>M.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Identifying tumor clones in sparse single-cell mutation data</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>i186</fpage>–<lpage>i193</lpage>.<pub-id pub-id-type="pmid">32657385</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Navin</surname><given-names>N.E.</given-names></string-name></person-group> (<year>2014</year>) <article-title>Cancer genomics: one cell at a time</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>452</fpage>.<pub-id pub-id-type="pmid">25222669</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nowell</surname><given-names>P.</given-names></string-name></person-group> (<year>1976</year>) <article-title>The clonal evolution of tumor cell populations</article-title>. <source>Science</source>, <volume>194</volume>, <fpage>23</fpage>–<lpage>28</lpage>.<pub-id pub-id-type="pmid">959840</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rashid</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Dhaka: variational autoencoder for unmasking tumor heterogeneity from single cell genomic data</article-title>. <source>Bioinformatics</source>, <volume>37</volume>, <fpage>1535</fpage>–<lpage>1543</lpage>.</mixed-citation>
    </ref>
    <ref id="btac790-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ross</surname><given-names>E.M.</given-names></string-name>, <string-name><surname>Markowetz</surname><given-names>F.</given-names></string-name></person-group> (<year>2016</year>) <article-title>OncoNEM: inferring tumor evolution from single-cell sequencing data</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>69</fpage>.<pub-id pub-id-type="pmid">27083415</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roth</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Clonal genotype and population structure inference from single-cell tumor sequencing</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>573</fpage>–<lpage>576</lpage>.<pub-id pub-id-type="pmid">27183439</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satas</surname><given-names>G.</given-names></string-name>, <string-name><surname>Raphael</surname><given-names>B.J.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Tumor phylogeny inference using tree-constrained importance sampling</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>i152</fpage>–<lpage>i160</lpage>.<pub-id pub-id-type="pmid">28882002</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stratton</surname><given-names>M.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>The cancer genome</article-title>. <source>Nature</source>, <volume>458</volume>, <fpage>719</fpage>–<lpage>724</lpage>.<pub-id pub-id-type="pmid">19360079</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Svensson</surname><given-names>V.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Interpretable factor models of single-cell RNA-seq via variational autoencoders</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>3418</fpage>–<lpage>3421</lpage>.<pub-id pub-id-type="pmid">32176273</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Swanton</surname><given-names>C.</given-names></string-name></person-group> (<year>2012</year>) <article-title>Intratumor heterogeneity: evolution through space and time</article-title>. <source>Cancer Res</source>., <volume>72</volume>, <fpage>4875</fpage>–<lpage>4882</lpage>.<pub-id pub-id-type="pmid">23002210</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van der Maaten</surname><given-names>L.</given-names></string-name>, <string-name><surname>Hinton</surname><given-names>G.</given-names></string-name></person-group> (<year>2008</year>) <article-title>Visualizing data using t-SNE</article-title>. <source>J. Mach. Learn. Res</source>., <volume>9</volume>, <fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation>
    </ref>
    <ref id="btac790-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Venteicher</surname><given-names>A.S.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Decoupling genetics, lineages, and microenvironment in IDH-mutant gliomas by single-cell RNA-seq</article-title>. <source>Science</source>, <volume>355</volume>, <fpage>eaai8478</fpage>.<pub-id pub-id-type="pmid">28360267</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Single-cell exome sequencing reveals single-nucleotide mutation characteristics of a kidney tumor</article-title>. <source>Cell</source>, <volume>148</volume>, <fpage>886</fpage>–<lpage>895</lpage>.<pub-id pub-id-type="pmid">22385958</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Du</surname><given-names>F.</given-names></string-name></person-group> (<year>2022</year>) <article-title>AMC: accurate mutation clustering from single-cell DNA sequencing data</article-title>. <source>Bioinformatics</source>, <volume>38</volume>, <fpage>1732</fpage>–<lpage>1734</lpage>.<pub-id pub-id-type="pmid">34951625</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>GRMT: generative reconstruction of mutation tree from scratch using single-cell sequencing data</article-title>. <source>Front. Genet</source>., <volume>12</volume>, <fpage>692964</fpage>.<pub-id pub-id-type="pmid">34149820</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>SCClone: accurate clustering of tumor single-cell DNA sequencing data</article-title>. <source>Front. Genet</source>., <volume>13</volume>, <fpage>823941</fpage>.<pub-id pub-id-type="pmid">35154282</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zafar</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>SiFit: inferring tumor trees from single-cell sequencing data under finite-sites models</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>178</fpage>.<pub-id pub-id-type="pmid">28927434</pub-id></mixed-citation>
    </ref>
    <ref id="btac790-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zafar</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>SiCloneFit: Bayesian inference of population structure, genotype, and phylogeny of tumor clones from single-cell genome sequencing data</article-title>. <source>Genome Res</source>., <volume>29</volume>, <fpage>1847</fpage>–<lpage>1859</lpage>.<pub-id pub-id-type="pmid">31628257</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
