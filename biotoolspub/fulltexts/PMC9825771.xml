<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9825771</article-id>
    <article-id pub-id-type="pmid">36394253</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac747</article-id>
    <article-id pub-id-type="publisher-id">btac747</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>htseq-clip: a toolset for the preprocessing of eCLIP/iCLIP datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Sahadevan</surname>
          <given-names>Sudeep</given-names>
        </name>
        <aff><institution>Genome Biology / Directors' Research, European Molecular Biology Laboratory (EMBL)</institution>, Heidelberg 69117, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sekaran</surname>
          <given-names>Thileepan</given-names>
        </name>
        <aff><institution>Genome Biology / Directors' Research, European Molecular Biology Laboratory (EMBL)</institution>, Heidelberg 69117, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ashaf</surname>
          <given-names>Nadia</given-names>
        </name>
        <aff><institution>Directors' Research, Previously European Molecular Biology Laboratory (EMBL)</institution>, Heidelberg 69117, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fritz</surname>
          <given-names>Marko</given-names>
        </name>
        <aff><institution>Directors' Research, Previously European Molecular Biology Laboratory (EMBL)</institution>, Heidelberg 69117, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hentze</surname>
          <given-names>Matthias W</given-names>
        </name>
        <aff><institution>Genome Biology / Directors' Research, European Molecular Biology Laboratory (EMBL)</institution>, Heidelberg 69117, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huber</surname>
          <given-names>Wolfgang</given-names>
        </name>
        <aff><institution>Genome Biology / Directors' Research, European Molecular Biology Laboratory (EMBL)</institution>, Heidelberg 69117, <country country="DE">Germany</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7697-7000</contrib-id>
        <name>
          <surname>Schwarzl</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>Genome Biology / Directors' Research, European Molecular Biology Laboratory (EMBL)</institution>, Heidelberg 69117, <country country="DE">Germany</country></aff>
        <xref rid="btac747-cor1" ref-type="corresp"/>
        <!--schwarzl@embl.de-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alkan</surname>
          <given-names>Can</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac747-cor1">To whom correspondence should be addressed. <email>schwarzl@embl.de</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-11-17">
      <day>17</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac747</elocation-id>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>10</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>16</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>23</day>
        <month>12</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac747.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Transcriptome-wide detection of binding sites of RNA-binding proteins is achieved using Individual-nucleotide crosslinking and immunoprecipitation (iCLIP) and its derivative enhanced CLIP (eCLIP) sequencing methods. Here, we introduce htseq-clip, a python package developed for preprocessing, extracting and summarizing crosslink site counts from i/eCLIP experimental data. The package delivers crosslink site count matrices along with other metrics, which can be directly used for filtering and downstream analyses such as the identification of differential binding sites.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The Python package htseq-clip is available via pypi (python package index), bioconda and the Galaxy Tool Shed under the open source MIT License. The code is hosted at <ext-link xlink:href="https://github.com/EMBL-Hentze-group/htseq-clip" ext-link-type="uri">https://github.com/EMBL-Hentze-group/htseq-clip</ext-link> and documentation is available under <ext-link xlink:href="https://htseq-clip.readthedocs.io/en/latest" ext-link-type="uri">https://htseq-clip.readthedocs.io/en/latest</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>EMBL Interdisciplinary Postdoc (EIPOD) programme under Marie Sklodowska-Curie Actions COFUND programme</institution>
          </institution-wrap>
        </funding-source>
        <award-id>291772</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In recent years, a 4-figure number of novel RNA-binding proteins (RBPs) was discovered, many of them containing disease-associated mutations (<xref rid="btac747-B3" ref-type="bibr">Gebauer <italic toggle="yes">et al.</italic>, 2021</xref>). Crosslinking and immunoprecipitation (CLIP) coupled with next-generation sequencing (NGS) is the current state of the art used for the transcriptome-wide detection of RBP binding sites to study their underlying mechanisms. Individual-nucleotide CLIP (iCLIP) (<xref rid="btac747-B4" ref-type="bibr">Konig <italic toggle="yes">et al.</italic>, 2011</xref>) methods and its derivatives, enhanced CLIP (eCLIP) (<xref rid="btac747-B10" ref-type="bibr">Van Nostrand <italic toggle="yes">et al.</italic>, 2016</xref>), infrared-CLIP (irCLIP) (<xref rid="btac747-B12" ref-type="bibr">Zarnegar <italic toggle="yes">et al.</italic>, 2016</xref>), easyCLIP (<xref rid="btac747-B7" ref-type="bibr">Porter <italic toggle="yes">et al.</italic>, 2021</xref>) and others use UV light to induce a covalent bond between the protein and the bound RNA. The property of reverse transcriptase enzymes to stop heuristically at those crosslinks results in truncations. Occasional skipping of these sites can introduce mutations or deletions. A handful of tools such as PIPE-CLIP and pyCRAC have been developed for the preprocessing of CLIP datasets. PIPE-CLIP was designed primarily for processing HITS-CLIP, PAR-CLIP and iCLIP datasets (<xref rid="btac747-B2" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2014</xref>). pyCRAC is mainly aimed at the processing of CLIP and CRAC (crosslinking and cDNA analysis) datasets (<xref rid="btac747-B11" ref-type="bibr">Webb <italic toggle="yes">et al.</italic>, 2014</xref>). Our recently developed R/Bioconductor package DEWSeq uses a sliding window approach based on DESeq2 (<xref rid="btac747-B6" ref-type="bibr">Love <italic toggle="yes">et al.</italic>, 2014</xref>) for the analysis of CLIP datasets. For this, the data need to be prepared as follows: truncation sites need to be extracted as individual nucleotide positions and summarized into sliding windows, which are generated based on a user provided gene annotation file in gff3 format.</p>
    <p>Here, we present <italic toggle="yes">htseq-clip</italic>, an open-source Python package, for this type of pre-processing of CLIP datasets. <italic toggle="yes">htseq-clip</italic> can be used to extract truncation, mutation or deletion sites from CLIP NGS data and to summarize these data into a count matrix format for downstream analyses. In addition, it provides metrics such as crosslink site density and maximum number of crosslink sites for an individual nucleotide for filtering.</p>
  </sec>
  <sec>
    <title>2 Design and implementation</title>
    <p>The development of <italic toggle="yes">htseq-clip</italic> was inspired by popular bioinformatics tools such as htseq-count (<xref rid="btac747-B1" ref-type="bibr">Anders <italic toggle="yes">et al.</italic>, 2015</xref>), bedtools (<xref rid="btac747-B9" ref-type="bibr">Quinlan and Hall, 2010</xref>) and featureCounts (<xref rid="btac747-B5" ref-type="bibr">Liao <italic toggle="yes">et al.</italic>, 2014</xref>). Although these software packages can be used in combination, for processing and counting crosslink sites from i/eCLIP datasets, <italic toggle="yes">htseq-clip</italic> simplifies the process and provides additional statistics for crosslink sites and annotation features.</p>
    <p><italic toggle="yes">htseq-clip</italic> is designed to extract crosslink sites from a wide range of CLIP protocols. Based on user-specified input parameters, <italic toggle="yes">htseq-clip</italic> can extract truncation sites with an offset from either the 5′ end or the 3′ end of the read, from either the first mate or the second mate of an alignment through command line parameters. Furthermore, htseq-clip is able to aggregate these sites either into entire gene features (intron, exon, UTR) or into sliding windows over these features. Thus, htseq-clip allows a user to have granular control over the information extracted from i/eCLIP datasets.</p>
    <p><italic toggle="yes">htseq-clip</italic> is written in Python 3 and builds upon the <italic toggle="yes">htseq</italic> package (<xref rid="btac747-B1" ref-type="bibr">Anders <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btac747-B8" ref-type="bibr">Putri <italic toggle="yes">et al.</italic>, 2022</xref>). <italic toggle="yes">htseq</italic> includes parsers for the most commonly used file formats in genomics.</p>
    <sec>
      <title>2.1 System requirements</title>
      <p>The system requirements of htseq-clip are the same as those of <italic toggle="yes">htseq</italic>, namely Linux or macOS.</p>
    </sec>
    <sec>
      <title>2.2 Data requirements</title>
      <p><italic toggle="yes">htseq-clip</italic> requires the following inputs:
</p>
      <list list-type="order">
        <list-item>
          <p>A gene annotation file in .gff3 format, as it is available from the GENCODE project for example.</p>
        </list-item>
        <list-item>
          <p>Alignment (.bam) files after polymerase chain reaction (PCR) duplicate removal using unique molecular identifiers (UMIs). Ideally, the experiment should be performed in replicates with proper size-matched input controls.</p>
        </list-item>
      </list>
    </sec>
    <sec>
      <title>2.3 Data processing workflow</title>
      <p>The workflow implemented in <italic toggle="yes">htseq-clip</italic> can be grouped into three steps:
</p>
      <list list-type="order">
        <list-item>
          <p>Prepare annotation: flatten the gene annotations to unique annotations for chromosomal positions, create sliding windows from flattened annotation and a mapping file for downstream analyses.</p>
        </list-item>
        <list-item>
          <p>Extract crosslink sites: extract truncation, deletion, insertion sites and summarize them as counts per sliding window.</p>
        </list-item>
        <list-item>
          <p>Count and summarize crosslink sites: summarize counts of multiple samples to a count matrix for further analysis.</p>
        </list-item>
      </list>
      <p><xref rid="btac747-F1" ref-type="fig">Figure 1</xref> illustrates the data flow and commands used in processing CLIP datasets with htseq-clip.</p>
      <fig position="float" id="btac747-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>htseq-clip data processing workflow</p>
        </caption>
        <graphic xlink:href="btac747f1" position="float"/>
      </fig>
      <sec>
        <title>2.3.1 Prepare annotation</title>
        <p>The first step in processing i/eCLIP data using htseq-clip is to prepare the annotation file. This step requires a .gff3 formatted gene annotation file as input. The supplied annotation file is flattened into BED6 format and is further used to create sliding windows. Users can set the width and step (slide) of the windows. The gene feature boundaries are taken into consideration at this step such that the sliding windows do not span multiple gene features (e.g. a window beginning in an exon of a gene and ending in the neighboring intron). The last step is to generate a mapping file. This file contains all the metadata related to a sliding window such as: window id, window size, step size, corresponding gene, gene feature, gene type, gene name and gene id. This information is essential for downstream filtering, quality control and analyses.</p>
      </sec>
      <sec>
        <title>2.3.2 Extract crosslink sites</title>
        <p>In this step, alignment files are processed and crosslink sites are extracted in BED6 format. The parameters used in this step give the user flexibility to define the read/mate, crosslink type and offset length parameters which can be used to convert an RT stop position into a crosslink site position. Additionally, users also have the flexibility to choose alignment quality, minimum and maximum lengths of reads and whether only primary alignments or both primary and secondary alignments of a read can be used for crosslink site counting. An additional advantage of extracting crosslink sites in BED6 format is that users gain flexibility to convert the crosslink site file into bigWig or bedGraph format, for visualization using a genome browser.</p>
      </sec>
      <sec>
        <title>2.3.3 Count and summarize crosslink sites</title>
        <p>In this step, a sliding window file created in the first step is used to count and summarize the crosslink sites into sliding windows. Along with the total number of sites per window, additional information such as length of the window, number of positions in a window with crosslink sites, maximum site count in the window and crosslink site position density (ratio of number of nucleotides with crosslink sites compared to the length of the window) are also given. In downstream analysis, users may filter the sliding windows based on this information. As an additional step, crosslink site counts from multiple samples can be concatenated into one matrix, creating a site count matrix file. This step is intended to create an R-friendly output matrix file, as R/Bioconductor packages are the default choice for statistical analysis in bioinformatics pipelines.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Summary</title>
    <p><italic toggle="yes">htseq-clip</italic> provides an easy-to-use solution for the pre-processing of i/eCLIP alignment files using custom gene annotations. The parameter combinations available in <italic toggle="yes">htseq-clip</italic> enable users to work with data from a wide variety of common CLIP protocols. The output crosslink site matrix and other metrics can be used for downstream analysis such as the R/Bioconductor Package <italic toggle="yes">DEWSeq</italic>.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Michael Uhl for creating a Bioconda package and Galaxy wrapper and members of the Hentze and Huber groups for input.</p>
    <sec>
      <title>Funding</title>
      <p>Thomas Schwarzl was supported by a fellowship from the EMBL Interdisciplinary Postdoc (EIPOD) programme under Marie Sklodowska-Curie Actions COFUND programme (grant number 291772).</p>
      <p><italic toggle="yes">Conflict of Interest:</italic> none declared.</p>
    </sec>
  </ack>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>There are no new data associated with this article.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac747-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anders</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>HTSeq—a python framework to work with high-throughput sequencing data</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>166</fpage>–<lpage>169</lpage>.<pub-id pub-id-type="pmid">25260700</pub-id></mixed-citation>
    </ref>
    <ref id="btac747-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>PIPE-CLIP: a comprehensive online tool for CLIP-seq data analysis</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>R18</fpage>.<pub-id pub-id-type="pmid">24451213</pub-id></mixed-citation>
    </ref>
    <ref id="btac747-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gebauer</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>RNA-binding proteins in human genetic disease</article-title>. <source>Nat. Rev. Genet</source>., <volume>22</volume>, <fpage>185</fpage>–<lpage>198</lpage>.<pub-id pub-id-type="pmid">33235359</pub-id></mixed-citation>
    </ref>
    <ref id="btac747-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Konig</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2011</year>) <article-title>iCLIP–transcriptome-wide mapping of protein-RNA interactions with individual nucleotide resolution</article-title>. <source>J. Vis. Exp</source>., <bold>50</bold>, e2638.</mixed-citation>
    </ref>
    <ref id="btac747-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liao</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>923</fpage>–<lpage>930</lpage>.<pub-id pub-id-type="pmid">24227677</pub-id></mixed-citation>
    </ref>
    <ref id="btac747-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Love</surname><given-names>M.I.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>550</fpage>.<pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="btac747-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Porter</surname><given-names>D.F.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>easyCLIP analysis of RNA-protein interactions incorporating absolute quantification</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>1569</fpage>.<pub-id pub-id-type="pmid">33692367</pub-id></mixed-citation>
    </ref>
    <ref id="btac747-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Putri</surname><given-names>G.H.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Analysing high-throughput sequencing data in python with HTSeq 2.0</article-title>. <source>Bioinformatics</source>, <volume>38</volume>, <fpage>2943</fpage>–<lpage>2945</lpage>.<pub-id pub-id-type="pmid">35561197</pub-id></mixed-citation>
    </ref>
    <ref id="btac747-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quinlan</surname><given-names>A.R.</given-names></string-name>, <string-name><surname>Hall</surname><given-names>I.M.</given-names></string-name></person-group> (<year>2010</year>) <article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>841</fpage>–<lpage>842</lpage>.<pub-id pub-id-type="pmid">20110278</pub-id></mixed-citation>
    </ref>
    <ref id="btac747-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Nostrand</surname><given-names>E.L.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Robust transcriptome-wide discovery of RNA-binding protein binding sites with enhanced CLIP (eCLIP)</article-title>. <source>Nat. Methods</source>., <volume>13</volume>, <fpage>508</fpage>–<lpage>514</lpage>.<pub-id pub-id-type="pmid">27018577</pub-id></mixed-citation>
    </ref>
    <ref id="btac747-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Webb</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>PAR-CLIP data indicate that Nrd1-Nab3-dependent transcription termination regulates expression of hundreds of protein coding genes in yeast</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>R8</fpage>.<pub-id pub-id-type="pmid">24393166</pub-id></mixed-citation>
    </ref>
    <ref id="btac747-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zarnegar</surname><given-names>B.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>irCLIP platform for efficient characterization of protein-RNA interactions</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>489</fpage>–<lpage>492</lpage>.<pub-id pub-id-type="pmid">27111506</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
