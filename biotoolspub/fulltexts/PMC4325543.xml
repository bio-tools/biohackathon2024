<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4325543</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btu674</article-id>
    <article-id pub-id-type="publisher-id">btu674</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Statistical significance of variables driving systematic variation in high-dimensional data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chung</surname>
          <given-names>Neo Christopher</given-names>
        </name>
        <xref ref-type="aff" rid="btu674-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Storey</surname>
          <given-names>John D.</given-names>
        </name>
        <xref ref-type="aff" rid="btu674-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btu674-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="btu674-COR1">*</xref>
      </contrib>
      <aff id="btu674-AFF1"><sup>1</sup>Lewis-Sigler Institute for Integrative Genomics and <sup>2</sup>Department of Molecular Biology, Princeton University, Princeton, NJ 08544, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btu674-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: Janet Kelso</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>2</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>10</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>10</month>
      <year>2014</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>4</issue>
    <fpage>545</fpage>
    <lpage>554</lpage>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>1</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>31</day>
        <month>7</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>10</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2014. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation</bold>: There are a number of well-established methods such as principal component analysis (PCA) for automatically capturing systematic variation due to latent variables in large-scale genomic data. PCA and related methods may directly provide a quantitative characterization of a complex biological variable that is otherwise difficult to precisely define or model. An unsolved problem in this context is how to systematically identify the genomic variables that are drivers of systematic variation captured by PCA. Principal components (PCs) (and other estimates of systematic variation) are directly constructed from the genomic variables themselves, making measures of statistical significance artificially inflated when using conventional methods due to over-fitting.</p>
      <p><bold>Results</bold>: We introduce a new approach called the <italic>jackstraw</italic> that allows one to accurately identify genomic variables that are statistically significantly associated with any subset or linear combination of PCs. The proposed method can greatly simplify complex significance testing problems encountered in genomics and can be used to identify the genomic variables significantly associated with latent variables. Using simulation, we demonstrate that our method attains accurate measures of statistical significance over a range of relevant scenarios. We consider yeast cell-cycle gene expression data, and show that the proposed method can be used to straightforwardly identify genes that are cell-cycle regulated with an accurate measure of statistical significance. We also analyze gene expression data from post-trauma patients, allowing the gene expression data to provide a molecularly driven phenotype. Using our method, we find a greater enrichment for inflammatory-related gene sets compared to the original analysis that uses a clinically defined, although likely imprecise, phenotype. The proposed method provides a useful bridge between large-scale quantifications of systematic variation and gene-level significance analyses.</p>
      <p><bold>Availability and implementation</bold>: An R software package, called <monospace>jackstraw</monospace>, is available in CRAN.</p>
      <p><bold>Contact</bold>: <email>jstorey@princeton.edu</email></p>
    </abstract>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p>Latent variable models play an important role in understanding variation in genomic data (<xref rid="btu674-B20" ref-type="bibr">Leek and Storey, 2007</xref>; <xref rid="btu674-B30" ref-type="bibr">Price <italic>et al.</italic>, 2006</xref>). They are particularly useful for characterizing systematic variation in genomic data whose variable representation is unobserved or imprecisely known (<xref ref-type="fig" rid="btu674-F1">Fig. 1</xref>). Principal component analysis (PCA) has proven to be an especially informative method for capturing quantitative signatures of latent variables in genomic data, and it is in widespread use across a range of applications. For example, PCA has been successfully applied to uncover the systematic variation in gene expression (<xref rid="btu674-B2" ref-type="bibr">Alter <italic>et al.</italic>, 2000</xref>; <xref rid="btu674-B15" ref-type="bibr">Holter <italic>et al.</italic>, 2000</xref>; <xref rid="btu674-B33" ref-type="bibr">Raychaudhuri <italic>et al.</italic>, 2000</xref>), estimate structure in population genetics (<xref rid="btu674-B30" ref-type="bibr">Price <italic>et al.</italic>, 2006</xref>; <xref rid="btu674-B44" ref-type="bibr">Zhu <italic>et al.</italic>, 2002</xref>), and account for dependence in multiple hypothesis testing (<xref rid="btu674-B20" ref-type="bibr">Leek and Storey, 2007</xref>, <xref rid="btu674-B21" ref-type="bibr">2008</xref>). Generally, principal components (PCs) can be thought of as estimates of unobserved manifestation of latent variables; they are constructed by aggregating variation across thousands or more genomic variables (<xref rid="btu674-B17" ref-type="bibr">Jolliffe, 2002</xref>). What is missing from this highly successful system is a method to precisely identify which genomic variables are the statistically significant drivers of the PCs in genomic data, which in turn identifies the genomic variables associated with the unobserved latent variables.
<fig id="btu674-F1" position="float"><label>Fig. 1.</label><caption><p>Illustration of systematic variation genomic data due to latent variables. Complex biological variables, such as clinical subtypes and cell-cycle regulation, may be difficult to define, measure, or model. Instead, we can characterize the manifestation of latent variables, <inline-formula><mml:math id="MM1"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>L</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, directly from high-dimensional genomic data using PCA and related methods. The proposed method calculates the statistical significance of associations between variables in <bold>Y</bold> and estimates of <bold>L</bold>, while accounting for over-fitting due to the fact that <bold>L</bold> must be estimated from <bold>Y</bold></p></caption><graphic xlink:href="btu674f1p"/></fig></p>
    <p>In a typical application of PCA to genomic data, all variables will have non-zero loadings, meaning that they all make some contribution to the construction of PCs. We refer to genomic variables as the high-dimensional variables considered in a genomics study such as genes, array probe sets, or genetic loci. In some cases, when many (or most) of these contributions are forcibly set to zero, similar PCs nevertheless emerge. Methods have been proposed to induce sparsity in the loadings, for example, with a lasso penalized PCA or a Bayesian prior (<xref rid="btu674-B11" ref-type="bibr">Engelhardt and Stephens, 2010</xref>; <xref rid="btu674-B18" ref-type="bibr">Jolliffe <italic>et al.</italic>, 2003</xref>;<xref rid="btu674-B40" ref-type="bibr">Witten <italic>et al.</italic>, 2009</xref>; <xref rid="btu674-B45" ref-type="bibr">Zou <italic>et al.</italic>, 2006</xref>). Methods have also been developed to consider uncertainty in PCA expansions (<xref rid="btu674-B13" ref-type="bibr">Goldsmith <italic>et al.</italic>, 2013</xref>). Various formulations of statistical significance have been considered previously in the context of PCA. These have usually been focused on scenarios where the number of observations is substantially larger than the number of variables, significance is measured in terms of a completely unstructured data matrix where all variables are mutually independent, or the goal is to only determine the number of significant PCs (<xref rid="btu674-B3" ref-type="bibr">Anderson, 1963</xref>; <xref rid="btu674-B4" ref-type="bibr">Buja and Eyuboglu, 1992</xref>; <xref rid="btu674-B12" ref-type="bibr">Girshick, 1939</xref>; <xref rid="btu674-B16" ref-type="bibr">Johnstone, 2001</xref>; <xref rid="btu674-B24" ref-type="bibr">Linting <italic>et al.</italic>, 2011</xref>; <xref rid="btu674-B28" ref-type="bibr">Peres-Neto <italic>et al.</italic>, 2003</xref>; <xref rid="btu674-B37" ref-type="bibr">Tracy and Widom, 1996</xref>; <xref rid="btu674-B36" ref-type="bibr">Timmerman <italic>et al.</italic>, 2010</xref>). The problem we consider here differs from those scenarios.</p>
    <p>Our goal is not a minimal representation of a PCA; we would like instead to develop a strategy that accurately identifies which genomic variables are truly associated with systematic variation of interest. This can be phrased in statistical terminology as developing a significance test for associations between genomic variables and a given set, subset, or linear combination of PCs estimated from genomic data. We introduce a new resampling approach, which we call the <italic>jackstraw</italic>, to rigorously identify the genomic variables associated with PCs of interest, as well as subsets and rotations of PCs of interest. Our approach is capable of obtaining the empirical null distribution of association statistics (e.g. <italic>F</italic>-statistics) and applying these to the observed association statistics between genomic features and PCs to obtain valid statistical significance measures. Succinctly, new PCs are computed from a dataset with a few independently permuted variables, which become tractable ‘synthetic’ null variables. The association statistics between newly computed PCs and synthetic null variables serve as empirical null statistics, accounting for the measurement error and over-fitting of PCA.</p>
    <p>As an application, we consider the problem of identifying genes whose expression is cell-cycle regulated. In this case, there are infinitely many theoretical curves that would represent ‘cell-cycle regulation’ to the point where a standard statistical analysis involves an unwieldy ‘composite null hypothesis’ (<xref rid="btu674-B23" ref-type="bibr">Lehmann, 1997</xref>). We identify the few realized patterns of cell-cycle regulated gene expression through PCA and we are able to directly test whether each gene is associated with these using the proposed approach. As another application, we analyzed observational gene expression profiles of blunt-force trauma patients (<xref rid="btu674-B8" ref-type="bibr">Desai <italic>et al.</italic>, 2011</xref>), whose post-trauma inflammatory responses are difficult to be quantified using conventional means. When the clinical phenotype of interest cannot be precisely measured and modeled, we may estimate it directly from genomic data itself. We identify genes driving systematic variation in gene expression of post-trauma patients and demonstrate that our analysis is biologically richer than the original analysis (<xref rid="btu674-B8" ref-type="bibr">Desai <italic>et al.</italic>, 2011</xref>).</p>
    <p>PCA has direct connections to independent component analysis (ICA; <xref rid="btu674-B14" ref-type="bibr">Hastie <italic>et al.</italic>, 2011</xref>) and <italic>K</italic>-means clustering (<xref rid="btu674-B9" ref-type="bibr">Ding and He, 2004</xref>; <xref rid="btu674-B43" ref-type="bibr">Zha <italic>et al.</italic>, 2001</xref>). Therefore, the methods we propose are likely applicable to those models as well. Furthermore, this approach has potential generalizations to a much broader class of clustering and latent variable methods that all seek to capture systematic variation.</p>
  </sec>
  <sec id="SEC2">
    <title>2 STATISTICAL MODEL AND APPROACH</title>
    <p>Consider an <italic>m</italic> × <italic>n</italic> row-wise mean-centered expression data matrix <bold>Y</bold> with <italic>m</italic> observed variables measured over <italic>n</italic> observations (<inline-formula><mml:math id="MM2"><mml:mrow><mml:mi>m</mml:mi><mml:mo>≫</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>). <bold>Y</bold> may contain systematic variation across the variables from an arbitrarily complex function of latent variables <bold><italic>z</italic></bold>. We may calculate the expected influence of the latent variables on <bold>Y</bold> by <inline-formula><mml:math id="MM3"><mml:mrow><mml:mtext>E</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, and then write <inline-formula><mml:math id="MM4"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mtext>E</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle></mml:mrow></mml:math></inline-formula>, where <bold>E</bold> is defined as <inline-formula><mml:math id="MM5"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mtext>E</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. There exists a <italic>r</italic> × <italic>n</italic> matrix, called <inline-formula><mml:math id="MM6"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>L</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, that is a row basis for <inline-formula><mml:math id="MM7"><mml:mrow><mml:mtext>E</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="MM8"><mml:mrow><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> (<xref rid="btu674-B20" ref-type="bibr">Leek and Storey, 2007</xref>, <xref rid="btu674-B21" ref-type="bibr">2008</xref>). This low-dimensional matrix <inline-formula><mml:math id="MM9"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>L</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> can be thought of as the manifestation of the latent variables in the genomic data. As illustrated in <xref ref-type="fig" rid="btu674-F1">Figure 1</xref>, this conditional factor model is common for biomedical and genomic data (<xref rid="btu674-B19" ref-type="bibr">Leek, 2010</xref>). Since <bold><italic>z</italic></bold> is never directly observed or used in the model, we will abbreviate <inline-formula><mml:math id="MM10"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>L</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as <bold>L</bold>. This yields the model 
<disp-formula id="btu674-M1"><label>(1)</label><mml:math id="MM11"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi><mml:mi>L</mml:mi></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM12"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle></mml:math></inline-formula> is a <italic>m</italic> × <italic>r</italic> matrix of unknown parameters of interest. The <inline-formula><mml:math id="MM13"><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> row of <inline-formula><mml:math id="MM14"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle></mml:math></inline-formula>, which we write as <inline-formula><mml:math id="MM15"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>b</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, quantifies the relationship between the latent variable basis <bold>L</bold> and genomic variable <inline-formula><mml:math id="MM16"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. This model (<xref ref-type="disp-formula" rid="btu674-M1">1</xref>) is schematized in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Material, Figure S1</ext-link>.</p>
    <p>The PCs of <bold>Y</bold> may be calculated by taking the singular value decomposition (SVD) of <bold>Y</bold>. This yields <inline-formula><mml:math id="MM17"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>U</mml:mi><mml:mi>D</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="MM18"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>U</mml:mi></mml:mstyle></mml:math></inline-formula> is a <italic>m</italic> × <italic>n</italic> orthonormal matrix, <inline-formula><mml:math id="MM19"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle></mml:math></inline-formula> is a <italic>n</italic> × <italic>n</italic> diagonal matrix and <inline-formula><mml:math id="MM20"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle></mml:math></inline-formula> is a <italic>n</italic> × <italic>n</italic> orthonormal matrix. The diagonal elements in <inline-formula><mml:math id="MM21"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle></mml:math></inline-formula> are the <italic>n</italic> singular values, which are in a decreasing order of magnitude. The rows of <inline-formula><mml:math id="MM22"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> are the right singular vectors, with corresponding singular values in <inline-formula><mml:math id="MM23"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle></mml:math></inline-formula>. PCs are then the rows of <inline-formula><mml:math id="MM24"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, where the <inline-formula><mml:math id="MM25"><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> PC is found in the <inline-formula><mml:math id="MM26"><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mtext>th</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> row of <inline-formula><mml:math id="MM27"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. The columns of <inline-formula><mml:math id="MM28"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>U</mml:mi></mml:mstyle></mml:math></inline-formula> are considered to be the loadings of their respective PCs.</p>
    <p>Suppose that the row-space of <bold>L</bold> has dimension <italic>r</italic>. The top <italic>r</italic> PCs may then be used to estimate the row basis for <bold>L</bold> (<xref rid="btu674-B17" ref-type="bibr">Jolliffe, 2002</xref>). Specifically, under a mild set of assumptions, it has been shown that as <inline-formula><mml:math id="MM29"><mml:mrow><mml:mi>m</mml:mi><mml:mo>→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula>, the top <italic>r</italic> PCs of <bold>Y</bold> converge with probability 1 to a matrix whose row space is equivalent to that of <bold>L</bold> (<xref rid="btu674-B19" ref-type="bibr">Leek, 2010</xref>). For our estimation purposes, we only need to consider the <inline-formula><mml:math id="MM30"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> matrix since this captures the row-space. We would therefore estimate <bold>L</bold> by simply obtaining the top <italic>r</italic> right singular vectors, which we denote by <inline-formula><mml:math id="MM31"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
    <p>Let’s now consider a concrete example of <inline-formula><mml:math id="MM32"><mml:mrow><mml:mi>z</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>L</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, and the ultimate inference goal. <xref rid="btu674-B35" ref-type="bibr">Spellman <italic>et al.</italic> (1998)</xref> carried out a gene expression study to identify cell-cycle regulated genes of <italic>Saccharomyces cerevisiae</italic> (<xref ref-type="fig" rid="btu674-F2">Fig. 2</xref>). In this experiment, <italic>m</italic> = 5981 genes’ expression values were originally measured over <italic>n</italic> = 14 time points in a culture of yeast cells whose cell cycles had been synchronized. (Note that an inspection of the 14 microarrays from <xref rid="btu674-B35" ref-type="bibr">Spellman <italic>et al.</italic> (1998)</xref> reveals an aberrant gene expression profile from 300-min, so we removed this array in our analysis—see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Figure S2</ext-link>.) Here, <bold><italic>z</italic></bold> is the latent variable that represents the dynamic gene expression regulatory program over the yeast cell cycle. <bold>L</bold> is the manifested influence of <bold><italic>z</italic></bold> on the observed scale of gene expression measurements (<xref ref-type="fig" rid="btu674-F1">Fig. 1</xref>). The ordered time points themselves do not capture the underlying cell-cycle regulation, and it is, therefore, not clear how to <italic>a priori</italic> accurately model <bold>L</bold>. If <bold>L</bold> were directly observed, then we could identify which genes are cell-cycle regulated by performing a significance test of <inline-formula><mml:math id="MM33"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>b</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:math></inline-formula> versus <inline-formula><mml:math id="MM34"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>b</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:menclose notation="updiagonalstrike"><mml:mo>=</mml:mo></mml:menclose><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:math></inline-formula> for each gene <italic>i</italic>.
<fig id="btu674-F2" position="float"><label>Fig. 2.</label><caption><p>Identification of yeast genes associated with the cell-cycle regulation. (a) The top two PCs of gene expression measured over time in a population of yeast whose cell cycles have been synchronized by elutriation; these PCs appear to capture cell-cycle regulation patterns (<xref rid="btu674-B35" ref-type="bibr">Spellman et al., 1998</xref>). The dashed lines are natural cubic smoothing splines fit to each PC, respectively (with 5 degrees of freedom). (b) The percent variance explained by PCs shows that the top two PCs capture 48% of the total variance in the data. (c) Hierarchical clustering of expression levels of genes significantly associated with the top two PCs at <inline-formula><mml:math id="MM35"><mml:mrow><mml:mtext>FDR</mml:mtext><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mi>%</mml:mi></mml:mrow></mml:math></inline-formula>, where rows are genes and columns are time points. Hierarchical clustering was applied to this subset of 2998 genes</p></caption><graphic xlink:href="btu674f2p"/></fig></p>
    <p>However, since <bold>L</bold> is not observed, we can instead perform the analogous association test using <inline-formula><mml:math id="MM36"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="btu674-F2">Figure 2</xref>(a) shows the first two PCs of <bold>Y</bold>, where it can be seen that these capture systematic variation that resembles cell-cycle regulation. (It should be noted that the remaining PCs, three and higher, do not appear to capture systematic variation of interest.) Since the row-spaces of <bold>L</bold> and <inline-formula><mml:math id="MM37"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> (<italic>r</italic> = 2) are theoretically close (<xref rid="btu674-B19" ref-type="bibr">Leek, 2010</xref>), we can instead use the model
<disp-formula id="btu674-M2"><label>(2)</label><mml:math id="MM38"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mi mathvariant="bold">Γ</mml:mi><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM39"><mml:mi mathvariant="bold">Γ</mml:mi></mml:math></inline-formula> is a <italic>m</italic> × <italic>r</italic> matrix of unknown coefficients. We would then perform a significance test of <inline-formula><mml:math id="MM40"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:math></inline-formula> versus <inline-formula><mml:math id="MM41"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:math></inline-formula> for each gene <italic>i</italic>.</p>
    <p>Note that if <inline-formula><mml:math id="MM42"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>→</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>L</mml:mi></mml:mstyle></mml:mrow></mml:math></inline-formula> in row-space as <inline-formula><mml:math id="MM43"><mml:mrow><mml:mi>m</mml:mi><mml:mo>→</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></inline-formula>, then these two hypothesis tests would be asymptotically (in the number of variables) equivalent. However, for fixed <italic>m</italic>, they are not equivalent. There are two main issues: (i) <inline-formula><mml:math id="MM44"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is a noisy estimate of <bold>L</bold>; (ii) <inline-formula><mml:math id="MM45"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is itself a function of <bold>Y</bold>, so hypothesis testing on <inline-formula><mml:math id="MM46"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mi mathvariant="bold">Γ</mml:mi><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> results in an anti-conservative bias due to overfitting. Our proposed method deals with problem (ii) by accounting for the over-fitting that is intrinsic to performing hypothesis testing on model (<xref ref-type="disp-formula" rid="btu674-M2">2</xref>). The numerical results in this article are carried out so that we generate the data from model (<xref ref-type="disp-formula" rid="btu674-M1">1</xref>) and evaluate the accuracy of the significance based on the truth from model (<xref ref-type="disp-formula" rid="btu674-M1">1</xref>). Therefore, our thorough simulations provide evidence that the proposed method accounts for both issues (i) and (ii).</p>
  </sec>
  <sec id="SEC3">
    <title>3 PROPOSED ALGORITHMS</title>
    <p>We have developed a resampling method (<xref ref-type="fig" rid="btu674-F3">Fig. 3</xref>) to obtain accurate statistical significance measures of the associations between observed variables and their PCs, accounting for the over-fitting characteristics due to computation of PCs from the same set of observed variables. The proposed algorithm replaces a small number <italic>s</italic> (<inline-formula><mml:math id="MM47"><mml:mrow><mml:mi>s</mml:mi><mml:mo>≪</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>) of observed variables with independently permuted ‘synthetic’ null variables, while preserving the overall systematic variation in the data. Note that the jackstraw disrupts the systematic variation among the randomly chosen <italic>s</italic> rows by applying independently generated permutation mappings. We denote the new matrix with the <italic>s</italic> synthetic null variables replacing their original values as <inline-formula><mml:math id="MM48"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>. This is simply the original matrix <bold>Y</bold> with the <italic>s</italic> rows of <bold>Y</bold> replaced by independently permuted versions. On each permutation dataset <inline-formula><mml:math id="MM49"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, we calculate association statistics for each synthetic null variable, exactly as was done on the original data. We carry this out <italic>B</italic> times, effectively creating <italic>B</italic> sets of permutation statistics. The association statistics calculated on <bold>Y</bold> are then compared to the association statistics calculated on only the <italic>s</italic> synthetic null rows of <inline-formula><mml:math id="MM50"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> to obtain statistical significance measures.
<fig id="btu674-F3" position="float"><label>Fig. 3.</label><caption><p>A schematic of the general steps of the proposed algorithm to calculate the statistical significance of associations between variables (rows in <bold>Y</bold>) and their top <italic>r</italic> PCs (<inline-formula><mml:math id="MM51"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>). By independently permuting a small number (<italic>s</italic>) of variables and recalculating the PCs, we generate tractable “synthetic” null variables while preserving the overall systematic variation. Association statistics between the <italic>s</italic> synthetic null variables in <inline-formula><mml:math id="MM52"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM53"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> form the empirical null distribution, automatically taking account over-fitting intrinsic to testing for associations between a set of observed variables and their PCs</p></caption><graphic xlink:href="btu674f3p"/></fig></p>
    <boxed-text id="btu674-BOX1" position="float">
      <caption>
        <title>Algorithm to Calculate Significance of Variables Associated with PCs</title>
      </caption>
      <p>
        <list list-type="simple">
          <list-item>
            <p>1. Obtain <italic>r</italic> PCs of interest, <inline-formula><mml:math id="MM54"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> by applying SVD to the row-wise mean-centered matrix <inline-formula><mml:math id="MM55"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>U</mml:mi><mml:mi>D</mml:mi></mml:mstyle><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
          </list-item>
          <list-item>
            <p>2. Calculate <italic>m</italic> observed <italic>F</italic>-statistics <inline-formula><mml:math id="MM56"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, testing <inline-formula><mml:math id="MM57"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:math></inline-formula> versus <inline-formula><mml:math id="MM58"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:math></inline-formula> from model (<xref ref-type="disp-formula" rid="btu674-M2">2</xref>).</p>
          </list-item>
          <list-item>
            <p>3. Randomly select and permute <italic>s</italic> rows of <inline-formula><mml:math id="MM59"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, resulting in <inline-formula><mml:math id="MM60"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
          </list-item>
          <list-item>
            <p>4. Obtain <inline-formula><mml:math id="MM61"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> from SVD applied to <inline-formula><mml:math id="MM62"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>U</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:mo>*</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
          </list-item>
          <list-item>
            <p>5. Calculate null <italic>F</italic>-statistics <inline-formula><mml:math id="MM63"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mn>0</mml:mn><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> from the <italic>s</italic> synthetic null rows of <inline-formula><mml:math id="MM64"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> as in step 2, where <inline-formula><mml:math id="MM65"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is replaced with <inline-formula><mml:math id="MM66"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
          </list-item>
          <list-item>
            <p>6. Repeat steps 3–5 <inline-formula><mml:math id="MM67"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:math></inline-formula> times to obtain a total <italic>s</italic> × <italic>B</italic> of null <italic>F</italic>-statistics.</p>
          </list-item>
          <list-item>
            <p>7. Compute the <italic>P</italic> value for variable <italic>i</italic> (<inline-formula><mml:math id="MM68"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>) by:</p>
          </list-item>
        </list>
        <disp-formula>
          <mml:math id="MM69">
            <mml:mrow>
              <mml:msub>
                <mml:mi>p</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mo>#</mml:mo>
                  <mml:mo>{</mml:mo>
                  <mml:msubsup>
                    <mml:mi>F</mml:mi>
                    <mml:mi>j</mml:mi>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>≥</mml:mo>
                  <mml:msub>
                    <mml:mi>F</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mo>;</mml:mo>
                  <mml:mi>j</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mo>…</mml:mo>
                  <mml:mo>,</mml:mo>
                  <mml:mi>s</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>b</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mo>…</mml:mo>
                  <mml:mo>,</mml:mo>
                  <mml:mi>B</mml:mi>
                  <mml:mo>}</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                  <mml:mo>×</mml:mo>
                  <mml:mi>B</mml:mi>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <list list-type="simple">
          <list-item>
            <p>8. Identify statistically significant tests based on the <italic>P</italic> values <inline-formula><mml:math id="MM70"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula>
<italic>p<sub>m</sub></italic> (e.g. using false discovery rates).</p>
          </list-item>
        </list>
      </p>
    </boxed-text>
    <p>We call this approach the <italic>jackstraw</italic> for the following reason. By permuting a relatively small amount of observed variables in the original matrix, the underlying systematic variation due to latent variables is preserved as a whole. This makes the PCs of <inline-formula><mml:math id="MM71"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> almost identical to the PCs of the original data, <bold>Y</bold>, up to variation due to over-fitting of the noise. Replacing <italic>s</italic> variables with null versions is reminiscent of the game of jackstraws where the goal is to remove one stick at a time from a structured set of sticks without disrupting the overall structure of the sticks. Since the overall structure of <bold>Y</bold> is preserved in <inline-formula><mml:math id="MM72"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, we know that the level of associations between these synthetic null variables and the top <italic>r</italic> PCs is purely due to the over-fitting nature of PCA. From these synthetic null statistics, we can, therefore, capture and adjust for the over-fitting among the original statistics.</p>
    <p>A balance between the number of resampling iterations <italic>B</italic> and the number of synthetic null variables <italic>s</italic> is relevant to the speed of the algorithm and the accuracy of the resulting <italic>P</italic> values. In each resampling iteration, <italic>s</italic> determines the number of estimated null statistics, so to get the same resolution of a particular empirical null distribution (<italic>s</italic> × <italic>B</italic> total null statistics), <italic>B</italic> must increase proportionally with a decreasing <italic>s</italic>. Suppose we fix the total number of null statistics <italic>s</italic> × <italic>B</italic> that are generated (e.g. <inline-formula><mml:math id="MM73"><mml:mrow><mml:mi>s</mml:mi><mml:mo>×</mml:mo><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mtext> </mml:mtext><mml:mn>000</mml:mn></mml:mrow></mml:math></inline-formula>). One extreme is to set <italic>s</italic> = 1 and <italic>B</italic> = 10 000, where the accuracy of the <italic>P</italic> values is maximized while the algorithm is the least efficient. However, setting <italic>s</italic> = 100 and <italic>B</italic> = 100 yields the same number of null statistics; this configuration would lead to a savings in computational time while it may result in slightly more conservative <italic>P</italic> values. The number of true null variables in <inline-formula><mml:math id="MM74"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> is always greater than or equal to the number of true null variables in the original matrix <bold>Y</bold>. Therefore, an increase of <italic>s</italic> in the proposed algorithm may lead to a greater over-fitting into the noise of <inline-formula><mml:math id="MM75"><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> relative to the over-fitting in <bold>Y</bold>, resulting in conservative estimates of significance. Due to this favorable trade-off between <italic>s</italic> and <italic>B</italic>, the proposed algorithm is guarded against anti-conservative bias.</p>
    <p>The hypothesis test <inline-formula><mml:math id="MM76"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:math></inline-formula> versus <inline-formula><mml:math id="MM176"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:math></inline-formula> applied to model (<xref ref-type="disp-formula" rid="btu674-M2">2</xref>) may be generalized to performing the test on subspaces spanned by the PCs, shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Material</ext-link>. This generalization allows one to perform the association tests on a subset of PCs, while adjusting for other PCs. It also allows for one to consider rotations of <inline-formula><mml:math id="MM78"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> and projections of <inline-formula><mml:math id="MM79"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> onto relevant subspaces. For example, it may be possible to rotate the PCs to obtain ‘independent components’ from ICA (<xref rid="btu674-B14" ref-type="bibr">Hastie <italic>et al.</italic>, 2011</xref>) and then perform our algorithm on any desired subset of the independent components. Note that when a subset of <inline-formula><mml:math id="MM80"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> is considered, the largest <italic>r</italic> eigenvalues corresponding to the top <italic>r</italic> PCs must be sufficiently distinguished to ensure their stability (<xref rid="btu674-B27" ref-type="bibr">Ng <italic>et al.</italic>, 2001</xref>).</p>
  </sec>
  <sec>
    <title>4 RESULTS</title>
    <p>We evaluated the proposed method on simulated data so that we could directly assess its accuracy, and we also applied the method to two genomic datasets to demonstrate its utility in practice.</p>
    <sec id="SEC4.1">
      <title>4.1 Simulation studies</title>
      <p>Through a set of simulation studies, we demonstrated that the proposed method is able to accurately estimate the statistical significance of associations between the latent variable basis <bold>L</bold> and observed variables <inline-formula><mml:math id="MM81"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (where <inline-formula><mml:math id="MM82"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>). The data in our simulation studies were generated from model (<xref ref-type="disp-formula" rid="btu674-M1">1</xref>) <inline-formula><mml:math id="MM83"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Y</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi><mml:mi>L</mml:mi></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>E</mml:mi></mml:mstyle></mml:mrow></mml:math></inline-formula>, where variables <inline-formula><mml:math id="MM84"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> corresponding to <inline-formula><mml:math id="MM85"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>b</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:math></inline-formula> are, by definition, the ‘null variables’ not associated with <bold>L</bold> (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S1</ext-link>). The accuracy of our approach is evaluated by performing <italic>m</italic> hypothesis tests using the proposed algorithm (where only <bold>Y</bold> is observed) and assessing whether the joint distribution of <italic>P</italic> values corresponding to the null variables is correctly behaved.</p>
      <sec id="SEC4.1.1">
        <title>4.1.1 The joint null criterion</title>
        <p>We used the ‘joint null criterion’ of <xref rid="btu674-B22" ref-type="bibr">Leek and Storey (2011)</xref> to assess whether the set of <italic>P</italic> values corresponding to the null variables follow the desired joint distribution (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S3</ext-link>). When testing a single hypothesis, a valid procedure generates null <italic>P</italic> values that are distributed uniformly between 0 and 1. For multiple hypothesis tests, the goal is that the set of null <italic>P</italic> values produced by a method satisfies the <italic>joint null criterion</italic>, which means their joint distribution is equivalent to a set of i.i.d. observations from the Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>) (<xref rid="btu674-B22" ref-type="bibr">Leek and Storey, 2011</xref>). Verifying that the proposed method satisfies the joint null criterion not only demonstrates that the method accounts for the over-fitting inherent in methods such as PCA, but also verifies that our approach to calculating the <italic>P</italic> value for each variable <italic>i</italic> is valid, which uses the set of <italic>s</italic> × <italic>B</italic> synthetic null statistics that have been pooled across variables. <xref rid="btu674-B22" ref-type="bibr">Leek and Storey (2011)</xref> prove that when the joint null criterion holds, then a large body of multiple testing procedures (such as the standard false discovery rate procedures) control their respective error measure.</p>
        <p>There are two ways in which we measured deviations from the Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>) joint null criterion. The first is via a two-sided Kolmogorov–Smirnov test (KS test), which detects any deviation; the second is a one-sided KS test, which detects anti-conservative deviations where the null <italic>P</italic> values are skewed towards zero. Anti-conservative deviations will occur when a method does not properly take into account the fact that the association statistics are formed between the variables and PCs (which have been built from the variables themselves), leading to over-fitting and anti-conservative <italic>P</italic> values. Evaluation of the joint null criterion works by simulating many datasets (corresponding to independently repeated studies) from a given data generating process (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S3</ext-link>). The joint behavior of the null <italic>P</italic> values is then evaluated among these.</p>
        <p>We considered 16 simulation scenarios, described below. For a given scenario, we simulated 500 independent studies and calculated 500 KS test <italic>P</italic> values, each of which is based on the set of null <italic>P</italic> values from its respective study. In other words, for 500 simulation datasets per scenario, 500 KS test <italic>P</italic> values are calculated to measure deviations from the Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>); a second application of the KS test is then performed on these 500 KS <italic>P</italic> values to assess whether any anti-conservative deviation from the Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>) among these studies has occurred (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S3</ext-link>). If the statistical method being evaluated provides accurate measures of statistical significance, the collection of double KS test <italic>P</italic> values must be distributed Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>). This guards against any single simulated dataset leading one to an incorrect conclusion by chance. This technique is the ‘double KS test’ introduced by <xref rid="btu674-B22" ref-type="bibr">Leek and Storey (2011)</xref>.</p>
        <p>Overall, we demonstrate that our proposed method provides accurate measures of statistical significance of the associations between variables and the latent variables, when the latent variables themselves are directly estimated from the data via PCA. At the same time, we show that the conventional method does not provide accurate statistical significance measures.</p>
      </sec>
      <sec id="SEC4.1.2">
        <title>4.1.2 Simulation scenarios and results</title>
        <p>We constructed 16 simulation scenarios representing a wide range of configurations of signal and noise (<xref ref-type="fig" rid="btu674-F4">Fig. 4</xref>), with 500 independent studies simulated from each. Let us first consider one of the simpler scenarios in detail. Model (<xref ref-type="disp-formula" rid="btu674-M1">1</xref>) is used to generate the data. In this particular scenario, we have <italic>m</italic> = 1000, <italic>n</italic> = 20, <italic>r</italic> = 1 and
<disp-formula><mml:math id="MM86"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>L</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
a dichotomous mean shift resembling differential expression between the first 10 observations and the second 10 observations. (The factor <inline-formula><mml:math id="MM88"><mml:mrow><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula> is to give <bold>L</bold> unit variance.) For 95% of the variables, we set <italic>b<sub>i</sub></italic> = 0, implying they are null variables; we parameterize this proportion by <inline-formula><mml:math id="MM89"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>. The other 50 non-null variables were simulated such that <inline-formula><mml:math id="MM90"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mover><mml:mo>∼</mml:mo><mml:mrow><mml:mtext>i.i.d</mml:mtext></mml:mrow></mml:mover></mml:mrow></mml:math></inline-formula> Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>). The noise terms are simulated as <inline-formula><mml:math id="MM91"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mover><mml:mo>∼</mml:mo><mml:mrow><mml:mtext>i.i.d</mml:mtext></mml:mrow></mml:mover></mml:mrow></mml:math></inline-formula> Normal(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>). The data for variable <italic>i</italic> are thus simulated according to <inline-formula><mml:math id="MM92"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>L</mml:mi></mml:mstyle><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>e</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.
<fig id="btu674-F4" position="float"><label>Fig. 4.</label><caption><p>Sixteen simulation scenarios generated by combining four design factors. To assess the statistical accuracy of the conventional <italic>F</italic>-test and the proposed method, we simulated 500 independent studies for each scenario, and assessed statistical accuracy according to the “joint null criterion” (<xref rid="btu674-B22" ref-type="bibr">Leek and Storey, 2011</xref>). For the <inline-formula><mml:math id="MM87"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>b</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> scenarios, non-null coefficients were set to either -1 or 1 with a probability of 0.5. For a given simulation study, a valid statistical testing procedure must yield a set of null <italic>P</italic> values that are jointly distributed Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>). We use a KS test to identify deviations from the Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>) distribution. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Material, Figure S3</ext-link> provides a detailed overview of the evaluation pipeline</p></caption><graphic xlink:href="btu674f4p"/></fig></p>
        <p>For a given simulated dataset, we tested for the associations between the observed variables and the latent variables by forming association statistics between the observed <inline-formula><mml:math id="MM93"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>y</mml:mi></mml:mstyle><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and their collective PC, <inline-formula><mml:math id="MM94"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>r</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> (<italic>r</italic> = 1). We calculated <italic>P</italic> values using both the conventional <italic>F</italic> test and the proposed method with <italic>s</italic> = 50 synthetic null variables (<xref ref-type="fig" rid="btu674-F5">Fig. 5</xref>). Over 500 simulated datasets, the conventional <italic>F</italic> test resulted in 500 one-sided KS <italic>P</italic> values that exhibit a strong anti-conservative bias with a double KS <italic>P</italic> value of <inline-formula><mml:math id="MM95"><mml:mrow><mml:mo>=</mml:mo><mml:mn>9.71</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>196</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S4</ext-link>, black points). Conversely, the proposed method correctly calculates null <italic>P</italic> values, by accounting for the over-fitted measurement error in PCA, with a double KS <italic>P</italic> value of 0.502 (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S4</ext-link>, orange points). Alternatively, a comparison of estimated versus true FDR demonstrates an appropriate adjustment for over-fitting in the jackstraw method (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S5</ext-link>). Note that the classification of null <italic>P</italic> values is based on the true association status from the population-level data generating distribution from model (<xref ref-type="disp-formula" rid="btu674-M1">1</xref>), not based on model (<xref ref-type="disp-formula" rid="btu674-M2">2</xref>) or on the observed loadings from the PCA.
<fig id="btu674-F5" position="float"><label>Fig. 5.</label><caption><p>Evaluation of significance measures of associations between variables and their PCs by comparing true null <italic>P</italic> values and the Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>) distribution. (a) The conventional <italic>F</italic>-test results in anti-conservative <italic>P</italic> values, as demonstrated by null <italic>P</italic> values being skewed towards 0. (b) The proposed method produces null <italic>P</italic> values distributed Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>). The dashed line shows the Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>) density function</p></caption><graphic xlink:href="btu674f5p"/></fig></p>
        <p>We carried out analogous analyses on 15 more simulation scenarios, detailed in <xref ref-type="fig" rid="btu674-F4">Fig. 4</xref>. We used all possible combinations of the following: (<xref ref-type="disp-formula" rid="btu674-M1">1</xref>) either dichotomous or sinusoidal functions for <bold>L</bold>; (<xref ref-type="disp-formula" rid="btu674-M2">2</xref>) the parameters <inline-formula><mml:math id="MM96"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle></mml:math></inline-formula> were simulated from either a Bernoulli or Uniform distribution; (3) <italic>m</italic> = 1000 or <italic>m</italic> = 5000 variables; and (4) the proportion of true null variables set to either <inline-formula><mml:math id="MM97"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.75</mml:mn></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="MM98"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></inline-formula>. The proposed method was applied with <inline-formula><mml:math id="MM99"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>0.10</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="MM100"><mml:mrow><mml:mn>0.25</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> to study the impact of the choice of the number of synthetic null variables. For each scenario, we applied the joint null criterion double KS evaluation (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S3</ext-link>), using 500 simulated data sets. The conventional <italic>F</italic> test method consistently produced anti-conservative null <italic>P</italic> values, while the proposed method yielded accurately distributed null <italic>P</italic> values (<xref ref-type="fig" rid="btu674-F6">Fig. 6</xref>).
<fig id="btu674-F6" position="float"><label>Fig. 6.</label><caption><p>QQ-plots of double KS test <italic>P</italic> values from 16 simulation scenarios versus the Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>) distribution. For each of 500 independent studies per scenario, we tested for deviation of null <italic>P</italic> values from Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>), resulting in 500 KS test <italic>P</italic> values for each scenario. An individual point in the QQ-plot represents a double KS test <italic>P</italic> value for one scenario, comparing its 500 KS test <italic>P</italic> values to Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>). On the left panel, the systematic downward displacement of 16 black points indicates an anti-conservative bias of the conventional <italic>F</italic>-test. In contrast, the proposed method produces null <italic>P</italic> values that are not anti-conservative. On the right panel, a set of 16 points are below the diagonal red line if the joint null distribution deviates from the Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>) distribution. The proposed method adjusts for over-fitting of PCA and produces accurate estimates of association significance</p></caption><graphic xlink:href="btu674f6p"/></fig></p>
        <p>In these simulations, we found that the proposed method tended to produce more conservative null <italic>P</italic> values as <italic>s</italic> increased (<xref ref-type="fig" rid="btu674-F6">Fig. 6</xref>). The explanation for this is that inclusion of a larger number of synthetic null variables leads to a greater over-fitting of PCA to the noise, which in turn yields a conservative empirical null distribution formed by the synthetic null statistics. We, therefore, identified a trade-off between computational speed and how conservative the calculated <italic>P</italic> values are in the choice of <italic>s</italic>. We note, however, that the null <italic>P</italic> values were never observed to be prohibitively conservative in that the power became unreasonably diminished. In practice, the user has the option to lower the value of <italic>s</italic> to minimize this, at the cost of greater computation.</p>
        <p>We note that we also investigated a delete-<italic>s</italic> version of the jackstraw, which draws on ideas from our proposed method, which one could call the permute-<italic>s</italic> jackstraw. However, this implementation did not produce valid null <italic>P</italic> values (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Material</ext-link>).</p>
      </sec>
      <sec id="SEC4.1.3">
        <title>4.1.3 Testing for associations on subsets of PCs</title>
        <p>We have generalized the proposed method to be able to test for associations on any subset of the top <italic>r</italic> PCs, while adjusting for the remaining PCs among the top <italic>r</italic>. Here, we demonstrate that the proposed method can identify variables driving a chosen subset of PCs of interest, <inline-formula><mml:math id="MM101"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, while adjusting for the remaining of the top <italic>r</italic> PCs which are not of interest, <inline-formula><mml:math id="MM102"><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="MM103"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:math></inline-formula>. Based on model (<xref ref-type="disp-formula" rid="btu674-M1">1</xref>), we simulated data with <italic>m</italic> = 1000, <italic>n</italic> = 20, <italic>r</italic> = 2 and
<disp-formula><mml:math id="MM104"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>L</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
<disp-formula><mml:math id="MM105"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>L</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>-</mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
        <p><inline-formula><mml:math id="MM106"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>L</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM107"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>L</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are truly associated with 100 variables and 60 variables, respectively. Among these, 40 variables that are truly associated with both <inline-formula><mml:math id="MM108"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>L</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM109"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>L</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. We generated the noise term as <inline-formula><mml:math id="MM110"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mover><mml:mo>∼</mml:mo><mml:mrow><mml:mtext>i.i.d</mml:mtext></mml:mrow></mml:mover></mml:mrow></mml:math></inline-formula> Normal(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>). We set <italic>r</italic> = 2 and tested for associations with the first PC while adjusting for the second PC. Note that the first PC effectively captured the signal from the first latent variable. In this case, the null variables were defined to be 900 variables associated with either only the second latent variable or no latent variable. The conventional <italic>F</italic> test resulted in an anti-conservative bias among the null <italic>P</italic> values, with a double KS test <italic>P</italic> value of <inline-formula><mml:math id="MM111"><mml:mrow><mml:mn>8.73</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, while the proposed method produced a correct joint null <italic>P</italic> value distribution with a double KS test <italic>P</italic> value of 0.352 (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S6</ext-link>).</p>
        <p>We performed a similar simulation with <italic>r</italic> = 5 true underlying latent variables and also studied the result of setting <italic>r</italic> to be too small or too large in model (<xref ref-type="disp-formula" rid="btu674-M2">2</xref>). For <italic>m</italic> = 1000 variables and <italic>n</italic> = 20 observations (<inline-formula><mml:math id="MM112"><mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.75</mml:mn></mml:mrow></mml:math></inline-formula>), we simulated <italic>r</italic> = 5 latent variables simulated from one of each of the following distributions: a randomized dichotomous variable, Normal(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>), Uniform(0,<xref ref-type="disp-formula" rid="btu674-M1">1</xref>), Bin(2, 0.5), and Normal(0,0.25). We applied the jackstraw algorithm with <inline-formula><mml:math id="MM113"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> and the conventional <italic>F</italic> test to the simulated data with <inline-formula><mml:math id="MM114"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo>,</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula> used in model (<xref ref-type="disp-formula" rid="btu674-M2">2</xref>). To detect an anti-conservative bias, we applied a one-sided KS-test on <italic>P</italic> values corresponding to the true null variables as done above. Since there exist in truth <italic>r</italic> = 5 latent variables, the results with <inline-formula><mml:math id="MM115"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM116"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>7</mml:mn><mml:mo>,</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula> demonstrate the operating characteristics when the number of PCs is under- or over-specified, respectively. We found that the jackstraw method resulted in valid null <italic>P</italic> values while the conventional test did not (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S7</ext-link>).</p>
      </sec>
    </sec>
    <sec id="SEC4.2">
      <title>4.2 Application to gene expression studies</title>
      <p>Typically, genomic variables are tested for the associations with external variables, which are measured independently of genomic profiling technology, such as disease status, treatment labels, or time points. However, external variables may be imprecise or inaccurate due to poor understanding of the biology or technological limitations; sometimes the external variables of interest may not be capable of being measured at all. For example, in a cancer gene expression study, the cancer types may be based on histological classification of the tumor cells. Then, association tests, such as <italic>F</italic> tests, are conducted between the histological classification and transcriptional levels to discover genes of interest. However, the histological classification of cancer tumors may not distinguish important cancer subtypes (<xref rid="btu674-B1" ref-type="bibr">Alizadeh <italic>et al.</italic>, 2000</xref>; <xref rid="btu674-B7" ref-type="bibr">DeRisi <italic>et al.</italic>, 1996</xref>). This lack of information may lead to a spurious signal or reduced power in statistical inference.</p>
      <p>When the external variables are unmeasured or imprecise, we are interested in using the latent variable basis, <bold>L</bold>, to discover genes of interest (<xref ref-type="fig" rid="btu674-F1">Fig. 1</xref>). Because <bold>L</bold> is never directly measured, we must estimate it from the genomic data, using PCA and related methods. We apply our proposed method to two genomic datasets to demonstrate its utility in practice.</p>
      <sec id="SEC4.2.1">
        <title>4.2.1 Cell-cycle regulated gene expression in S. cerevisiae</title>
        <p>It is known that in S. cerevisiae there is an abundance of genes whose transcription is regulated with respect to the cell cycle (<xref rid="btu674-B5" ref-type="bibr">Cho <italic>et al.</italic>, 1998</xref>; <xref rid="btu674-B35" ref-type="bibr">Spellman <italic>et al.</italic>, 1998</xref>). Nonetheless, comprehensive identification of the yeast genes whose expression is regulated by the cell cycle is still an active area of research, since it is unclear how the yeast cell-cycle regulation should be quantified and modeled (<xref rid="btu674-B29" ref-type="bibr">Pramila <italic>et al.</italic>, 2006</xref>; <xref rid="btu674-B34" ref-type="bibr">Rowicka <italic>et al.</italic>, 2007</xref>; <xref rid="btu674-B38" ref-type="bibr">Tu <italic>et al.</italic>, 2005</xref>; <xref rid="btu674-B41" ref-type="bibr">Wu and Li, 2008</xref>). The experimental time points after cell population synchronization are readily measured, but this external variable does not directly represent periodic transcriptional regulation with respect to the cell cycle.</p>
        <p>Suppose that we want to carry out a hypothesis test on each gene of whether it shows regulation associated with a periodic pattern over the cell cycle. The null hypothesis is then that population mean is not periodic over the cell cycle. This null hypothesis contains an infinite number of mean time-course trajectories that are non-periodic, making the null hypothesis composite. A composite null hypothesis such as this one is largely intractable because it contains an unwieldy class of potential probability distributions describing gene expression. Indeed, a survey of the literature reveals that this composite null hypothesis is the major challenge when a traditional hypothesis testing approach is taken. However, using our approach, we can reduce the complexity of this problem by directly estimating the manifested systematic periodic expression variation and applying the proposed method to identify genes associated with this systematic variation due to the latent variables, <bold>L</bold>.</p>
        <p><xref rid="btu674-B35" ref-type="bibr">Spellman <italic>et al.</italic> (1998)</xref> measured transcriptional levels of <italic>m</italic> = 5981 yeast genes, every 30 min for 390 min after synchronizing the cell cycle among a population of cells by elutriation. The top two PCs capture the manifestation of cell-cycle regulation on gene expression (<xref rid="btu674-B2" ref-type="bibr">Alter <italic>et al.</italic>, 2000</xref>), explaining 48% of total variance (<xref ref-type="fig" rid="btu674-F2">Fig. 2</xref>a, b). By testing for associations between time-course gene expression and the top two PCs, we avoid this challenging problem and consider instead the tractable association significance testing problem with a simple null hypothesis <inline-formula><mml:math id="MM117"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:math></inline-formula> versus <inline-formula><mml:math id="MM118"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle></mml:mrow></mml:math></inline-formula> (as opposed to a composite null). The hypothesis test is now simply whether gene <italic>i</italic> is associated with <inline-formula><mml:math id="MM119"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> latent variables estimated by the top two PCs.</p>
        <p>We applied the proposed method (with <italic>s</italic> = 100 and <inline-formula><mml:math id="MM120"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>) to test this hypothesis and identified a large number of genes associated with yeast cell-cycle regulation. (We did not use functional PCA (<xref rid="btu674-B32" ref-type="bibr">Ramsay and Silverman, 2005</xref>; <xref rid="btu674-B42" ref-type="bibr">Yao <italic>et al.</italic>, 2005</xref>) to smooth the PCs with respect to time, although the jackstraw method is amendable to do so.) We discovered that approximately 84% of the 5981 measured genes are associated with the top two PCs (<inline-formula><mml:math id="MM121"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.16</mml:mn></mml:mrow></mml:math></inline-formula>). At <inline-formula><mml:math id="MM122"><mml:mrow><mml:mtext>FDR</mml:mtext><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mi>%</mml:mi></mml:mrow></mml:math></inline-formula>, 2998 genes were found to be statistically significant. Hierarchical clustering applied to these 2998 genes reveals the cell-cycle patterns captured by the top two PCs (<xref ref-type="fig" rid="btu674-F2">Fig. 2</xref>c). The generalized proposed method allows us to compute statistical significance measures of associations with a subset of PCs. When testing for associations with the first PC while adjusting for the second PC, 1666 genes were called statistically significant at <inline-formula><mml:math id="MM123"><mml:mrow><mml:mtext>FDR</mml:mtext><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mi>%</mml:mi></mml:mrow></mml:math></inline-formula>, with the estimated proportion of null variables <inline-formula><mml:math id="MM124"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>34.4</mml:mn><mml:mi>%</mml:mi></mml:mrow></mml:math></inline-formula>. On the other hand, at the same <inline-formula><mml:math id="MM125"><mml:mrow><mml:mtext>FDR</mml:mtext></mml:mrow></mml:math></inline-formula> threshold, we found 984 genes were significantly associated with the second PC with <inline-formula><mml:math id="MM126"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>39.6</mml:mn><mml:mi>%</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
        <p>We applied the conventional test to the top two PCs in this data set and investigated its degree of over-fitting (yielding artificially small <italic>P</italic> values) as a function of the number of variables. This was accomplished by randomly sampling a subset of variables, applying each method to this subset of data, and then comparing the <italic>P</italic> value distributions of the jackstraw and conventional tests. It can be observed that smaller numbers of variables yield larger differences in the <italic>P</italic> value distributions, where the conventional test <italic>P</italic> values tend to be artificially small (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S8</ext-link>).</p>
        <p>To explore the impact of the choice of <italic>r</italic> on the proposed method, we conducted the jackstraw analysis setting <inline-formula><mml:math id="MM127"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM128"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> in model (<xref ref-type="disp-formula" rid="btu674-M2">2</xref>) (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S10</ext-link>). Notably, we found that setting <inline-formula><mml:math id="MM129"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> yielded similar results to setting <inline-formula><mml:math id="MM130"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>, similarly to what we observed in the simulation study (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S7</ext-link>). Setting <inline-formula><mml:math id="MM131"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> resulted in lower levels of statistical significance, and there was no obvious evidence of adverse effects from the fact that ignoring the 2nd PC induces dependence in the residuals of the model used with <inline-formula><mml:math id="MM132"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> (<xref rid="btu674-B20" ref-type="bibr">Leek and Storey, 2007</xref>, <xref rid="btu674-B21" ref-type="bibr">2008</xref>).</p>
        <p>It was demonstrated in the simulation studies that the proposed method produces valid null <italic>P</italic> values that satisfy the joint null criterion. To complement this analysis, we sought to verify on the real data set that applying the proposed algorithm with <italic>s</italic> = 100 and <italic>B</italic> = 10 produces <italic>P</italic> values that are similar to the most exhaustive method that makes the fewest assumptions. Specifically, we applied the proposed algorithm with <italic>s</italic> = 1 and <italic>B</italic> = 1000 where in calculating the <italic>P</italic> value for variable <italic>i</italic>, synthetic null statistics were constructed only on variable <italic>i</italic>. [The exhaustive method calculates within-gene <italic>P</italic> values, whereas the proposed method calculates <italic>P</italic> values from null statistics pooled across genes; see <xref rid="btu674-B22" ref-type="bibr">Leek and Storey (2011)</xref> for more on this distinction.] This required <italic>B</italic> = 1000 iterations of the algorithm for each of the <italic>m</italic> = 5981 genes, for a total of 5 981 000 SVD calculations and synthetic null statistics. Then, we calculated <inline-formula><mml:math id="MM133"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>#</mml:mi><mml:mo>{</mml:mo><mml:msubsup><mml:mi>F</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1000</mml:mn><mml:mo>}</mml:mo><mml:mo>/</mml:mo><mml:mn>1000</mml:mn></mml:mrow></mml:math></inline-formula> for each gene <inline-formula><mml:math id="MM134"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>5981</mml:mn></mml:mrow></mml:math></inline-formula>. This set-up gives an equivalent resolution to our proposed method with <italic>s</italic> = 100 and <italic>B</italic> = 10 because each <italic>P</italic> value is also based on 1000 synthetic null statistics. However, for the exhaustive method, the number of null statistic calculations is 5981-fold higher and the number of SVD calculations is 598 100-fold higher. We plotted the <italic>P</italic> values for each set-up against one another, where it can be seen in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S9</ext-link> that the set of 5981 <italic>P</italic> values is very similar between the proposed method and the exhaustive method.</p>
      </sec>
      <sec id="SEC4.2.2">
        <title>4.2.2 Inflammation associated gene expression in post-trauma patients</title>
        <p>Large-scale clinical genomic studies often lead to unique analytical challenges, including dealing with a large number of clinical variables, unclear clinical endpoints or disease labels, and expression heterogeneity (<xref rid="btu674-B20" ref-type="bibr">Leek and Storey, 2007</xref>). The ‘Inflammation and the Host Response to Injury’ (IHRI) consortium carried out a longitudinal clinical genomics study on blunt force trauma patients. They collected 393 clinical variables (some longitudinal) and time-course gene expression (total of 797 microarrays) on 168 post-trauma patients (<xref rid="btu674-B8" ref-type="bibr">Desai <italic>et al.</italic>, 2011</xref>). One of the main goals in this study was to elucidate how inflammatory responses after blunt force trauma are manifested on gene expression. To aggregate relevant clinical variables into a manageable daily score, the IHRI consortium used a modified version of the Marshall score to rate the severity of multiple organ dysfunction syndrome (<xref rid="btu674-B26" ref-type="bibr">Marshall <italic>et al.</italic>, 1995</xref>).</p>
        <p>Based on the modified Marshall score trajectories, <xref rid="btu674-B8" ref-type="bibr">Desai <italic>et al.</italic> (2011)</xref> clustered post-trauma patients into five groups, called ‘ordered categorical Multiple Organ Failure’ (ocMOF) labels. The time-course gene expression profiles of each patient were summarized by ‘within patient expression changes’ (WPEC; <xref rid="btu674-B8" ref-type="bibr">Desai <italic>et al.</italic>, 2011</xref>). Then, they tested for correlations between the WPEC genomic variables and the ocMOF score to discover genes associated with inflammatory responses of post-trauma patients. However, the use of the potentially noisy ocMOF clinical variable may impose limitations, as patients with similar Marshall scores may exhibit a wide range of clinical outcomes (<xref rid="btu674-B6" ref-type="bibr">Cobb <italic>et al.</italic>, 2005</xref>). Furthermore, five discrete values for the ocMOF scores potentially limits the resolution of the clinical variable.</p>
        <p>To investigate this further, we used our proposed approach where the gene expression itself was used to construct clinical phenotypes on the patients. We directly used the WPEC data to characterize the molecular signature of inflammatory responses to blunt force trauma. We estimated the manifestation of post-trauma inflammatory responses on gene expression, <bold>L</bold>, with the top nine PCs (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S11</ext-link>). Then, we applied the proposed method to identify the genomic variables in WPEC associated with the top nine PCs. The original analysis in <xref rid="btu674-B8" ref-type="bibr">Desai <italic>et al.</italic> (2011)</xref> estimated 24% of the 54 675 genomic variables (probe sets) to be associated with the ocMOF score. In contrast, our analysis revealed a much larger proportions of the genomic variables to be significantly associated with the major sources of variation, ranging from 62% for first PC to 39% for ninth PC.</p>
        <p>The genes identified in the original analysis (<xref rid="btu674-B8" ref-type="bibr">Desai <italic>et al.</italic>, 2011</xref>) were largely identified in our analysis, although our analysis provided many more significant genes. To compare the biological relevance of our re-analysis versus the original analysis, we tested for enrichment of 17 inflammation-related gene sets (<xref rid="btu674-B25" ref-type="bibr">Loza <italic>et al.</italic>, 2007</xref>), using one-sided Mann–Whitney–Wilcoxon tests with permutation-based significance. At the <inline-formula><mml:math id="MM135"><mml:mrow><mml:mtext>FDR</mml:mtext><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mi>%</mml:mi></mml:mrow></mml:math></inline-formula>, none of the inflammatory-related gene sets is enriched for the original analysis using the ocMOF scores (<xref rid="btu674-B8" ref-type="bibr">Desai <italic>et al.</italic>, 2011</xref>). In contrast, a large number of inflammation-related gene sets are significantly enriched when the genomic variables are tested for the associations with the top nine PCs individually (<xref ref-type="table" rid="btu674-T1">Table 1</xref>). MAPK signaling is enriched for every PC, except fifth PC, whereas Innate Pathogen Detection is enriched for first, fourth, sixth, and ninth PCs, at the <inline-formula><mml:math id="MM136"><mml:mrow><mml:mtext>FDR</mml:mtext><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mi>%</mml:mi></mml:mrow></mml:math></inline-formula>. Those two biological pathways were emphasized in the original analysis (<xref rid="btu674-B8" ref-type="bibr">Desai <italic>et al.</italic>, 2011</xref>) as indicating down-regulation of innate pathogen detection and up-regulation of MAPK signaling pathway, and they were seen as strong predictors of long-term complications from brute force trauma. Based on enrichment tests, the proposed method appears to provide a biologically richer source of information than the analysis based on the ocMOF scores.
<table-wrap id="btu674-T1" position="float"><label>Table 1.</label><caption><p><italic>Q</italic> values from gene enrichment analysis using inflammation-related gene sets</p></caption><table frame="hsides" rules="groups"><tbody align="left"><tr><td rowspan="1" colspan="1"><inline-graphic xlink:href="btu674t1.jpg"/></td></tr></tbody></table><table-wrap-foot><fn id="btu674-TF1"><p><italic>Note</italic> Darkened cells indicate <italic>q</italic> value <inline-formula><mml:math id="MM137"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> for a gene set enrichment test.</p></fn></table-wrap-foot></table-wrap></p>
        <p>As with the previous study, we applied the conventional test in comparison to the jackstraw method as a function of number of variables, and we observed the same phenomenon where the conventional method clearly overfits as a function of the number of variables (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Fig. S8</ext-link>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>5 DISCUSSION</title>
    <p>We have developed a method to accurately carry out statistical significance tests of associations between high-dimensional variables and latent variables, which have been estimated through systematic variation present in the observed high-dimensional variables themselves. Our approach is to maintain the overall systematic variation in the high-dimensional dataset, while replacing a small number of observed variables with independently permuted synthetic null variables. These synthetic null variables allow us to estimate the null distribution of the association statistics calculated on the original data that takes into account the inherent over-fitting that occurs when estimating latent variables through methods such as PCA. We call this approach the <italic>jackstraw</italic> because it draws on the idea of the game of jackstraws, where a player must remove a stick (i.e. a variable) from a pile of tangled sticks without disturbing the overall structure. Through extensive simulations, we demonstrated that the proposed method is capable of accounting for over-fitting and producing accurate statistical significance measures. We also demonstrated that applying conventional association testing methods to this problem artificially inflates the statistical significance of associations.</p>
    <p>An input required for the proposed method is the number of PCs, <italic>r</italic>, that capture systematic variation from latent variables. Determining the number of ‘statistically significant’ PCs is an active area of research, and defining a number of significant PCs depends on the data structure and the context (<xref rid="btu674-B3" ref-type="bibr">Anderson, 1963</xref>; <xref rid="btu674-B4" ref-type="bibr">Buja and Eyuboglu, 1992</xref>; <xref rid="btu674-B16" ref-type="bibr">Johnstone, 2001</xref>; <xref rid="btu674-B19" ref-type="bibr">Leek, 2010</xref>; <xref rid="btu674-B37" ref-type="bibr">Tracy and Widom, 1996</xref>). Note that setting <italic>r</italic> to be too small leads to dependence in the residuals of model (<xref ref-type="disp-formula" rid="btu674-M2">2</xref>). This leads to the problems of dependence discussed in Leek and Storey (<xref rid="btu674-B20" ref-type="bibr">2007</xref>, <xref rid="btu674-B21" ref-type="bibr">2008</xref>). Subsets of PCs can be considered while conditioning on other PCs in the jackstraw framework (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Material</ext-link>), so it is possible to avoid setting <italic>r</italic> to be too small. For example, if one would like to identify variables associated with the top three PCs, but is unsure whether the given data has three or four significant PCs, we have found it more robust to input <inline-formula><mml:math id="MM138"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>, which will adjust for potential systematic residual variation captured by the fourth PC.</p>
    <p>We demonstrated our approach using PCA. It is well known that individual PCs may not be directly interpretable or may contain multiple signals of interest that the user wishes to distinguish. The jackstraw method allows one to pinpoint a set of genomic variables associated with any given PC, a subset of PCs, a linear combination of two or more PCs, the projection of a subset of PCs onto an external variable, rotations of subsets of PCs, and low-dimensional latent variable estimates from other methods (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btu674/-/DC1">Supplementary Material</ext-link>). Therefore, this approach can be used to investigate and identify biological signals that may manifest in a particular subspace spanned by the estimated latent variables. We do not advocate blindly applying our method to the top <italic>r</italic> PCs without considering these issues.</p>
    <p>Since the proposed method allows one to rigorously identify subsets of genomic variables associated with PCs, it allows one to also investigate whether these subsets have any biological coherence. This may be useful in investigating whether a space spanned by a subset of PCs captures relevant biological signal or is merely reflecting technical artifacts (e.g. batch effects in gene expression data). The method also improves the surrogate variable analysis algorithm of Leek and Storey (<xref rid="btu674-B20" ref-type="bibr">2007</xref>, <xref rid="btu674-B21" ref-type="bibr">2008</xref>) in that it allows a more precise determination of the control variables that are used to estimate the surrogate variables. Thus, we have found the jackstraw to also be useful in the context of dealing with latent variables that reflect technical effects of no biological relevance.</p>
    <p>The proposed method represents a novel resampling approach operating on variables, whereas established resampling approaches, such as the jackknife and the bootstrap, tend to operate on observations (<xref rid="btu674-B10" ref-type="bibr">Efron, 1979</xref>; <xref rid="btu674-B31" ref-type="bibr">Quenouille, 1949</xref>; <xref rid="btu674-B39" ref-type="bibr">Tukey, 1958</xref>). When applying these methods, systematic variation due to latent variables is intentionally perturbed, since their purpose is typically to assess the sampling variation of a single variable. In high-dimensional data, we may need to preserve systematic variation due to latent variables, which is the problem that the jackstraw addresses.</p>
    <p>By accurately testing for associations between observed high-dimensional variables and the systematic manifestation of latent variables in the observed variables, our proposed method allows for the automatic discovery of complex sources of variation and the genomic variables that drive them. The proposed method extends PCA and related methods beyond their popular applications in exploring, visualizing and characterizing the systematic variation to genomic variable level (e.g. gene-level) significance analyses. Given the increasingly important role that non-parametric estimation of systematic variation plays in the analysis of genomic data (<xref rid="btu674-B2" ref-type="bibr">Alter <italic>et al.</italic>, 2000</xref>; <xref rid="btu674-B20" ref-type="bibr">Leek and Storey, 2007</xref>; <xref rid="btu674-B30" ref-type="bibr">Price <italic>et al.</italic>, 2006</xref>), the proposed method may be useful in many areas of quantitative biology using high-throughput technologies as well as other areas of high-dimensional data analysis.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_31_4_545__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btu674_supplementary.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>This research was supported in part by <funding-source>NIH</funding-source> grant <funding-source>HG002913</funding-source> and <funding-source>Office of Naval Research</funding-source> grant <award-id>N00014-12-1-0764</award-id>.</p>
    <p><italic>Conflict of interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="btu674-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alizadeh</surname>
            <given-names>AA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Distinct types of diffuse large b-cell lymphoma identified by gene expression profiling</article-title>
        <source>Nature</source>
        <year>2000</year>
        <volume>403</volume>
        <fpage>503</fpage>
        <lpage>511</lpage>
        <pub-id pub-id-type="pmid">10676951</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alter</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Singular value decomposition for genome-wide expression data processing and modeling</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2000</year>
        <volume>97</volume>
        <fpage>10101</fpage>
        <lpage>10106</lpage>
        <pub-id pub-id-type="pmid">10963673</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anderson</surname>
            <given-names>TW</given-names>
          </name>
        </person-group>
        <article-title>Asymptotic theory for principal component analysis</article-title>
        <source>Ann. Math. Stat.</source>
        <year>1963</year>
        <volume>34</volume>
        <fpage>122</fpage>
        <lpage>148</lpage>
      </element-citation>
    </ref>
    <ref id="btu674-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buja</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eyuboglu</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Remarks on parallel analysis</article-title>
        <source>Multivar. Behav. Res.</source>
        <year>1992</year>
        <volume>27</volume>
        <fpage>509</fpage>
        <lpage>540</lpage>
      </element-citation>
    </ref>
    <ref id="btu674-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cho</surname>
            <given-names>RJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A genome-wide transcriptional analysis of the mitotic cell cycle</article-title>
        <source>Mol. Cell</source>
        <year>1998</year>
        <volume>2</volume>
        <fpage>65</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="pmid">9702192</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cobb</surname>
            <given-names>JP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tompkins, and inflammation host response injury. Application of genome-wide expression analysis to human health and disease</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>4801</fpage>
        <lpage>4806</lpage>
        <pub-id pub-id-type="pmid">15781863</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeRisi</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Use of a cDNA microarray to analyse gene expression patterns in human cancer</article-title>
        <source>Nat. Genet.</source>
        <year>1996</year>
        <volume>14</volume>
        <fpage>457</fpage>
        <lpage>460</lpage>
        <pub-id pub-id-type="pmid">8944026</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Desai</surname>
            <given-names>KH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dissecting inflammatory complications in critically injured patients by within-patient gene expression changes: A longitudinal clinical genomics study</article-title>
        <source>PLoS Med.</source>
        <year>2011</year>
        <volume>8</volume>
        <fpage>e1001093</fpage>
        <pub-id pub-id-type="pmid">21931541</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B9">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>K-means clustering via principal component analysis</article-title>
        <source>Proceedings of the 21st International Conference on Machine learning</source>
        <year>2004</year>
        <fpage>225</fpage>
        <lpage>232</lpage>
        <comment>ICML ’04, New York, NY, USA. ACM</comment>
      </element-citation>
    </ref>
    <ref id="btu674-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Bootstrap methods: Another look at the jackknife</article-title>
        <source>Ann. Stat.</source>
        <year>1979</year>
        <volume>7</volume>
        <fpage>126</fpage>
      </element-citation>
    </ref>
    <ref id="btu674-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Engelhardt</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Analysis of population structure: a unifying framework and novel methods based on sparse factor analysis</article-title>
        <source>PLoS Genet.</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1001117</fpage>
        <pub-id pub-id-type="pmid">20862358</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Girshick</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>On the sampling theory of roots of determinantal equations</article-title>
        <source>Ann. Math. Stat.</source>
        <year>1939</year>
        <volume>10</volume>
        <fpage>203</fpage>
        <lpage>224</lpage>
      </element-citation>
    </ref>
    <ref id="btu674-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldsmith</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Corrected confidence bands for functional data using principal components</article-title>
        <source>Biometrics</source>
        <year>2013</year>
        <volume>69</volume>
        <fpage>41</fpage>
        <lpage>51</lpage>
        <comment>ISSN 0006-341X</comment>
        <pub-id pub-id-type="pmid">23003003</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B14">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <source>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</source>
        <year>2011</year>
        <edition>2nd edn</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="btu674-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holter</surname>
            <given-names>NS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fundamental patterns underlying gene expression profiles: simplicity from complexity</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2000</year>
        <volume>97</volume>
        <fpage>8409</fpage>
        <lpage>8414</lpage>
        <pub-id pub-id-type="pmid">10890920</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnstone</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>On the distribution of the largest eigenvalue in principal components analysis</article-title>
        <source>Ann. Stat.</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>295</fpage>
        <lpage>327</lpage>
      </element-citation>
    </ref>
    <ref id="btu674-B17">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Jolliffe</surname>
            <given-names>IT</given-names>
          </name>
        </person-group>
        <source>Principal Component Analysis</source>
        <year>2002</year>
        <edition>2nd edn</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer-Verlag</publisher-name>
      </element-citation>
    </ref>
    <ref id="btu674-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jolliffe</surname>
            <given-names>IT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A modified principal component technique based on the lasso</article-title>
        <source>JCGS</source>
        <year>2003</year>
        <volume>12</volume>
        <fpage>531</fpage>
        <lpage>547</lpage>
      </element-citation>
    </ref>
    <ref id="btu674-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
        </person-group>
        <article-title>Asymptotic conditional singular value decomposition for high-dimensional genomic data</article-title>
        <source>Biometrics</source>
        <year>2010</year>
        <volume>67</volume>
        <fpage>344</fpage>
        <lpage>352</lpage>
        <pub-id pub-id-type="pmid">20560929</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Capturing heterogeneity in gene expression studies by surrogate variable analysis</article-title>
        <source>PLoS Genet.</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e161</fpage>
      </element-citation>
    </ref>
    <ref id="btu674-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>A general framework for multiple testing dependence</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>18718</fpage>
        <lpage>18723</lpage>
        <pub-id pub-id-type="pmid">19033188</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leek</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>The joint null criterion for multiple hypothesis tests</article-title>
        <source>Stat. Appl. Genet. Mol. Biol.</source>
        <year>2011</year>
        <volume>10</volume>
        <fpage>Article 28</fpage>
      </element-citation>
    </ref>
    <ref id="btu674-B23">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lehmann</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <source>Testing Statistical Hypotheses</source>
        <year>1997</year>
        <edition>2nd edn</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="btu674-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Linting</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Statistical significance of the contribution of variables to the PCA solution: an alternative permutation strategy</article-title>
        <source>Psychometrika</source>
        <year>2011</year>
        <volume>76</volume>
        <fpage>440</fpage>
        <lpage>460</lpage>
      </element-citation>
    </ref>
    <ref id="btu674-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loza</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembly of inflammation-related genes for pathway-focused genetic analysis</article-title>
        <source>PLoS One</source>
        <year>2007</year>
        <volume>2</volume>
        <fpage>e1035</fpage>
        <pub-id pub-id-type="pmid">17940599</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marshall</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiple organ dysfunction score—a reliable descriptor of a complex clinical outcome</article-title>
        <source>Crit. Care Med.</source>
        <year>1995</year>
        <volume>23</volume>
        <fpage>1638</fpage>
        <lpage>1652</lpage>
        <pub-id pub-id-type="pmid">7587228</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ng</surname>
            <given-names>AY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Link analysis, eigenvectors and stability</article-title>
        <source>Int. Jt. Conf. Artif. Intell.</source>
        <year>2001</year>
        <volume>2</volume>
        <fpage>903</fpage>
        <lpage>910</lpage>
      </element-citation>
    </ref>
    <ref id="btu674-B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peres-Neto</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Giving meaningful interpretation to ordination axes: assessing loading significance in principal component analysis</article-title>
        <source>Ecology</source>
        <year>2003</year>
        <volume>84</volume>
        <fpage>2347</fpage>
        <lpage>2363</lpage>
      </element-citation>
    </ref>
    <ref id="btu674-B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pramila</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The forkhead transcription factor hcm1 regulates chromosome segregation genes and fills the s-phase gap in the transcriptional circuitry of the cell cycle</article-title>
        <source>Genes Dev.</source>
        <year>2006</year>
        <volume>20</volume>
        <fpage>2266</fpage>
        <lpage>2278</lpage>
        <pub-id pub-id-type="pmid">16912276</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>AK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Principal components analysis corrects for stratification in genome-wide association studies</article-title>
        <source>Nat. Genet.</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>904</fpage>
        <lpage>909</lpage>
        <pub-id pub-id-type="pmid">16862161</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quenouille</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Approximate tests of correlation in time series</article-title>
        <source>J. R. Stat. Soc. Ser. B</source>
        <year>1949</year>
        <volume>11</volume>
        <fpage>68</fpage>
        <lpage>84</lpage>
      </element-citation>
    </ref>
    <ref id="btu674-B32">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Ramsay</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Silverman</surname>
            <given-names>BW</given-names>
          </name>
        </person-group>
        <source>Functional Data Analysis</source>
        <year>2005</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer Series in Statistics. Springer</publisher-name>
        <comment>2nd edn</comment>
      </element-citation>
    </ref>
    <ref id="btu674-B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raychaudhuri</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Principal components analysis to summarize microarray experiments: application to sporulation time series</article-title>
        <source>Pac. Symp. Biocomput.</source>
        <year>2000</year>
        <volume>5</volume>
        <fpage>452</fpage>
        <lpage>463</lpage>
      </element-citation>
    </ref>
    <ref id="btu674-B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rowicka</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-resolution timing of cell cycle-regulated gene expression</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2007</year>
        <volume>104</volume>
        <fpage>16892</fpage>
        <lpage>16897</lpage>
        <pub-id pub-id-type="pmid">17827275</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spellman</surname>
            <given-names>PT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive identification of cell cycle-regulated genes of the yeast <italic>Saccharomyces cerevisiae</italic> by microarray hybridization</article-title>
        <source>Mol. Biol. Cell</source>
        <year>1998</year>
        <volume>9</volume>
        <fpage>3273</fpage>
        <lpage>3297</lpage>
        <pub-id pub-id-type="pmid">9843569</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Timmerman</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Estimating confidence intervals for principal component loadings: a comparison between the bootstrap and asymptotic results</article-title>
        <source>Br. J. Math. Stat. Psychol.</source>
        <year>2010</year>
        <volume>60</volume>
        <fpage>295</fpage>
        <lpage>314</lpage>
        <pub-id pub-id-type="pmid">17971271</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tracy</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Widom</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>On orthogonal and symplectic matrix ensembles</article-title>
        <source>Commun. Math. Phys.</source>
        <year>1996</year>
        <volume>177</volume>
        <fpage>727</fpage>
        <lpage>754</lpage>
      </element-citation>
    </ref>
    <ref id="btu674-B38">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tu</surname>
            <given-names>BP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Logic of the yeast metabolic cycle: temporal compartmentalization of cellular processes</article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>310</volume>
        <fpage>1152</fpage>
        <lpage>1158</lpage>
        <pub-id pub-id-type="pmid">16254148</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B39">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tukey</surname>
            <given-names>JW</given-names>
          </name>
        </person-group>
        <article-title>Bias and confidence in not quite large samples</article-title>
        <source>Ann. Math. Stat.</source>
        <year>1958</year>
        <volume>29</volume>
        <fpage>614</fpage>
      </element-citation>
    </ref>
    <ref id="btu674-B40">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Witten</surname>
            <given-names>DM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A penalized matrix decomposition, with applications to sparse principal components and canonical correlation analysis</article-title>
        <source>Biostatistics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>515</fpage>
        <lpage>534</lpage>
        <pub-id pub-id-type="pmid">19377034</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B41">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>W-S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W-H</given-names>
          </name>
        </person-group>
        <article-title>Systematic identification of yeast cell cycle transcription factors using multiple data sources</article-title>
        <source>BMC Bioinf.</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>522</fpage>
      </element-citation>
    </ref>
    <ref id="btu674-B42">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yao</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Functional data analysis for sparse longitudinal data</article-title>
        <source>J. Am. Stat. Assoc.</source>
        <year>2005</year>
        <volume>100</volume>
        <fpage>577</fpage>
        <lpage>590</lpage>
      </element-citation>
    </ref>
    <ref id="btu674-B43">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zha</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spectral relaxation for k-means clustering</article-title>
        <source>Neural Information Processing Systems vol.14 (NIPS 2001)</source>
        <year>2001</year>
        <comment>p. 10571064, Vancouver, Canada</comment>
      </element-citation>
    </ref>
    <ref id="btu674-B44">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Association mapping, using a mixture model for complex traits</article-title>
        <source>Genet. Epidemiol.</source>
        <year>2002</year>
        <volume>23</volume>
        <fpage>181</fpage>
        <lpage>196</lpage>
        <pub-id pub-id-type="pmid">12214310</pub-id>
      </element-citation>
    </ref>
    <ref id="btu674-B45">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zou</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sparse principal component analysis</article-title>
        <source>JCGS</source>
        <year>2006</year>
        <volume>15</volume>
        <fpage>262</fpage>
        <lpage>286</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
