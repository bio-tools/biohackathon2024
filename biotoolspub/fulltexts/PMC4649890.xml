<?DTDIdentifier.IdentifierValue -//NPG//DTD XML Article//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName NPG_XML_Article.dtd?>
<?SourceDTD.Version 2.7.10?>
<?ConverterInfo.XSLTName nature2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4649890</article-id>
    <article-id pub-id-type="pii">srep09743</article-id>
    <article-id pub-id-type="doi">10.1038/srep09743</article-id>
    <article-id pub-id-type="pmid">25988396</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MICCA: a complete and accurate software for taxonomic profiling of metagenomic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Albanese</surname>
          <given-names>Davide</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="author-notes" rid="n1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fontana</surname>
          <given-names>Paolo</given-names>
        </name>
        <xref ref-type="aff" rid="a1">1</xref>
        <xref ref-type="author-notes" rid="n1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>De Filippo</surname>
          <given-names>Carlotta</given-names>
        </name>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cavalieri</surname>
          <given-names>Duccio</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Donati</surname>
          <given-names>Claudio</given-names>
        </name>
        <xref ref-type="corresp" rid="c2">b</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <aff id="a1"><label>1</label><institution>Fondazione Edmund Mach, Research and Innovation Centre, Computational Biology Department</institution>, Via E. Mach 1, 38010 - S. Michele all'Adige (TN), <country>Italy</country></aff>
      <aff id="a2"><label>2</label><institution>Fondazione Edmund Mach, Research and Innovation Centre, Food Quality Nutrition &amp; Health Department</institution>, Via E. Mach 1, 38010 - S. Michele all'Adige (TN), <country>Italy</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email>duccio.cavalieri@fmach.it</email>
      </corresp>
      <corresp id="c2">
        <label>b</label>
        <email>claudio.donati@fmach.it</email>
      </corresp>
      <fn id="n1">
        <label>*</label>
        <p>These authors contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>05</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2015</year>
    </pub-date>
    <volume>5</volume>
    <elocation-id>9743</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>11</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>03</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2015, Macmillan Publishers Limited. All rights reserved</copyright-statement>
      <copyright-year>2015</copyright-year>
      <copyright-holder>Macmillan Publishers Limited. All rights reserved</copyright-holder>
      <license xmlns:xlink="http://www.w3.org/1999/xlink" license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <!--author-paid-->
        <license-p>This work is licensed under a Creative Commons Attribution 4.0 International License. The images or other third party material in this article are included in the article's Creative Commons license, unless indicated otherwise in the credit line; if the material is not included under the Creative Commons license, users will need to obtain permission from the license holder in order to reproduce the material. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p>The introduction of high throughput sequencing technologies has triggered an increase of the number of studies in which the microbiota of environmental and human samples is characterized through the sequencing of selected marker genes. While experimental protocols have undergone a process of standardization that makes them accessible to a large community of scientist, standard and robust data analysis pipelines are still lacking. Here we introduce MICCA, a software pipeline for the processing of amplicon metagenomic datasets that efficiently combines quality filtering, clustering of Operational Taxonomic Units (OTUs), taxonomy assignment and phylogenetic tree inference. MICCA provides accurate results reaching a good compromise among modularity and usability. Moreover, we introduce a de-novo clustering algorithm specifically designed for the inference of Operational Taxonomic Units (OTUs). Tests on real and synthetic datasets shows that thanks to the optimized reads filtering process and to the new clustering algorithm, MICCA provides estimates of the number of OTUs and of other common ecological indices that are more accurate and robust than currently available pipelines. Analysis of public metagenomic datasets shows that the higher consistency of results improves our understanding of the structure of environmental and human associated microbial communities. MICCA is an open source project.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>Microbial communities are an essential part of every ecosystem ranging from marine water to soil and to the human body. The recent advancements in High Throughput Sequencing technologies have greatly increased our understanding of the role of the microbiota in different habitats and health conditions. The structure of microbial communities is often investigated through the sequencing of selected genomic markers able to characterize the sample to a given level of taxonomic resolution. The choice of these markers usually falls on the variable regions of the 16S rDNA gene if the target microbial community is composed by bacteria, or on the internal transcribed spacer (ITS) region in the case of fungal communities.</p>
  <p>To characterize the taxonomic structure of the samples, the sequences are organized into Operational Taxonomic Units (OTUs) at varying levels of identity (usually 97%), which represent the common working definition of bacterial species. OTU clustering is a key step for the definition of the microbial diversity and taxonomic composition of the analysed samples, and its accuracy depends not only on the clustering algorithm, but also on the pre-processing of the reads for the removal of low quality reads and of chimera sequences that might be generated by template switching during the cloning step. An aggressive approach using strict quality filtering may lead to a loss of information particularly affecting the least abundant species, while, on the other hand, clustering of low quality reads may produce spurious OTUs leading to an overestimate of the complexity of the analysed samples.</p>
  <p>Given the complexity of next generation sequencing (NGS) datasets, a common approach of the available pipelines for OTUs identification is based on incremental algorithms like the one implemented in mothur<xref ref-type="bibr" rid="b1">1</xref>, a pipeline for targeted metagenomic data incorporating several tools for sequence filtering, OTUs definition and estimate of ecological parameters. For the OTU definition mothur exploits a greedy algorithm, that assigns sequences to OTUs according to three different criteria: in <italic>nearest neighbour</italic> method a sequence is inserted into an OTU if it is similar to any other sequence in that group, <italic>furthest neighbour</italic> criteria assigns a sequence to an OTU if it is similar to all the sequences in that group and <italic>average neighbour</italic> method instead averages the distances among the sequences in a group. QIIME<xref ref-type="bibr" rid="b2">2</xref>, a recent workflow for metagenomic data analysis, integrates several tools in a single pipeline to analyse sequencing data including also the possibility to display the results in a graphical form. To cluster sequences into OTUs, QIIME uses UCLUST<xref ref-type="bibr" rid="b3">3</xref>, a heuristic recursive algorithm that first identifies the centroid of the OTU based on its abundance and then includes in the OTU all sequences having sequence identity above a prefixed threshold with the centroid. A recently introduced pipeline, UPARSE<xref ref-type="bibr" rid="b4">4</xref>, implements a slightly different approach than mothur and QIIME: after cleaning, quality filtering and dereplication, the input sequences are ordered according to their abundances considering that high abundance reads are more likely to be correct and then are suitable to use as cluster seeds. Given a sequence, a maximum parsimony model is found using UPARSE-REF and the read can be assigned to a known OTU, marked as chimeric (and therefore discarded) or become a new centroid. Compared to the other two tools UPARSE has been shown to be more accurate in OTU reconstruction<xref ref-type="bibr" rid="b4">4</xref>.</p>
  <p>Here we present MICCA, a software pipeline for the processing of targeted metagenomic datasets that efficiently combines filtering process, OTU clustering and taxonomic assignment. Besides reaching a good compromise among modularity, usability and efficiency, MICCA includes OTUCLUST (<xref ref-type="supplementary-material" rid="s1">Supplementary Figure S1</xref>), a new de novo OTUs clustering algorithm that improves the performances of available software. Using synthetic datasets we show that thanks to the optimized reads filtering process and to the performances of OTUCLUST, MICCA can reconstruct the structure of microbial community with higher accuracy and efficiency than currently available pipelines. Analysis of public metagenomic datasets demonstrates that the noise reduction accomplished by MICCA improves our understanding of microbial communities both in environmental and human associated samples.</p>
  <sec disp-level="1">
    <title>Results</title>
    <p>MICCA is a software pipeline for the analysis of targeted metagenomic data, which includes tools for quality, chimera filtering and OTU clustering. In addition, we have also included modules for taxonomic classification, multiple alignment and phylogenetic tree inference (<xref ref-type="table" rid="t1">Table 1</xref>). MICCA can be used with any kind of amplicon reads obtained by different sequencers such as Roche 454 or Illumina. In order to assess the performances of our pipeline, we have generated and analysed three synthetic metagenomic datasets (16S-10, ITS-10 and 16S-R) of known structure and composition using MICCA, and compared the results to other popular analysis pipelines The results were analysed in term of number of reads passing the quality filtering, percentage of identified chimeras, number of OTUs and stability of the main diversity indices. To comparatively test the robustness of MICCA and other pipelines to different choices of the amplified region, we have analysed datasets derived from the Human Microbiome Project (HMP)<xref ref-type="bibr" rid="b5">5</xref>, for which the V1-V3, V3-V5 and V6-V9 variable regions of the 16S rDNA gene were amplified and sequenced.</p>
    <sec disp-level="2">
      <title>Quality filtering and chimera identification</title>
      <p>To investigate the ability of MICCA to filter low quality reads and identify chimeric sequences, we have analysed the 16S-10 and ITS-10 datasets generated using a realistic error model for 454 reads and including 20% of chimera sequences. The results in term of number of reads passing the filtering and number of identified chimeras are reported in <xref ref-type="table" rid="t2">Table 2</xref>. While the number of reads discarded by MICCA and QIIME are very similar, UPARSE tends to discard a higher number of reads, keeping only 42.3% and 66.8% of the reads on the 16S-10 and ITS-10 datasets, respectively. This behaviour is due to the stringent quality filtering approach used by UPARSE<xref ref-type="bibr" rid="b4">4</xref>, which is based on truncating the reads at the first base position which has a quality score less than a specified threshold. Combined with the requirement of a minimum read length, this behaviour causes the loss of a large fraction of the sequence data and has potentially a negative impact on the ability to estimate the frequency of low-abundant species.</p>
      <p>We have also measured the number of chimeric reads that are still present in the processed datasets from the three pipelines. The results are shown in <xref ref-type="table" rid="t2">Table 2</xref>. While the performances obtained by MICCA and QIIME are very close, UPARSE obtained the worst results in terms of number of chimeric reads retained on both 16S-10 and ITS-10 datasets (15.6% and 15.5% respectively).</p>
    </sec>
    <sec disp-level="2">
      <title>OTUs identification</title>
      <p>To measure the ability of MICCA to correctly estimate the number of OTUs in metagenomic datasets, we have generated 16S-R, a large synthetic sequence dataset including 500 different OTUs and 100000 sequence reads. The sample was rarefied to a fixed depth of increasing size at steps of 1000 reads, obtaining 30 samples containing from 1000 to 30000 sequences and from 231 to 500 OTUs. By analysing subsamples of growing size, we expect the estimated number of OTUs to approach the actual number of species in the original dataset. Larger systematic deviations from this number are indication of decreasing performance of the software. In <xref ref-type="fig" rid="f1">Figure 1a</xref> (see also <xref ref-type="supplementary-material" rid="s1">Supplementary Table S1</xref>) we show the number of OTUs estimated by MICCA and MICCA-FAST, with the latter implementing an exact string matching dereplication algorithm (see OTUCLUST algorithm), as a function of the size of the rarefied sample. The green solid lines are the true number of OTUs in the subsamples, while the dashed lines are the estimates obtained by MICCA, MICCA-FAST, QIIME and UPARSE. The data demonstrates that while QIIME overestimates the complexity of the sample with no sign of levelling of the number of OTUs for increasing size of the sequence sample, UPARSE is more conservative, converging to a number of estimated OTUs that is approximately 64% on average of the real number. The performances of mothur were qualitatively similar to QIIME (<xref ref-type="supplementary-material" rid="s1">Supplementary Figure S2</xref>) not reaching a plateau in the rarefaction curve and overestimating the number of OTUs<xref ref-type="bibr" rid="b4">4</xref>. Amongst the tested software suites, MICCA and MICCA-FAST achieve the best performances, converging to a number of estimated OTUs that are on average approximately 77% and 68% of the real number, respectively. In <xref ref-type="supplementary-material" rid="s1">Supplementary Table S2</xref> we also report the Shannon diversity index, a popular ecological measure used to estimate the complexity of microbial populations from metagenomic data, to highlight the effects of the more accurate estimation of the OTUs. In the case of UPARSE, the lower number of reads passing the quality filter could contribute to the lower number of estimated OTUs. To assess this point, we have repeated the analysis skipping the filtering step for MICCA and UPARSE. Even in this case, the number of OTUs predicted by MICCA is much closer to the real number (see <xref ref-type="supplementary-material" rid="s1">Supplementary Figure S3</xref>), demonstrating that the superior performances of MICCA are due to the efficient clustering algorithm.</p>
      <p>Besides estimating the biological complexity of a sample, metagenomic data provide a picture of the taxonomic structure of microbial communities. To understand the performances of the different pipelines, in <xref ref-type="fig" rid="f1">Figure 1b</xref> we plot the relative abundances of the top 20 most abundant OTUs in the synthetic dataset estimated by MICCA, MICCA-Fast, QIIME and UPARSE against the effective abundances (see also <xref ref-type="supplementary-material" rid="s1">Supplementary Figure S4</xref> for mothur). Amongst the tested pipelines, MICCA shows the smallest deviation form the real relative abundances, with a value of the Residual Sum of Squares (RSS) of 0.004, to be compared with 0.027 and 0.028 for QIIME and UPARSE, respectively (0.008 for mothur). Thus, compared to other software, MICCA provides a more realistic estimate of both the number of distinct OTUs present in the sample and of the relative frequency of the most abundant samples.</p>
      <p>In order to quantify to what extent the improved estimate of the OTUs given by MICCA translates into the identification of novel taxa, we have analysed samples of variable biological complexity from the Human Microbiome Project<xref ref-type="bibr" rid="b5">5</xref> and determined the distinct bacterial genera identified by the various pipelines. To take into account possible biases introduced by the choice of the amplified region, we have selected datasets where the V1-V3, V3-V5 and V6-V9 hypervariable regions of the bacterial 16S gene have been amplified and sequenced. The OTUs identified by the different pipelines were classified to known genera using RDP<xref ref-type="bibr" rid="b6">6</xref> (confidence level ≥ 90%), discarding those that could not be classified, thus guaranteeing that low quality OTUs or chimaeras that might have not been identified in the filtering step did not influence the results. Counting the number of distinct genera guarantees that novel OTUs deriving from the artificial splitting of single taxa do not bias our measure of sensitivity. Results are shown in <xref ref-type="fig" rid="f2">Figure 2</xref> and in <xref ref-type="supplementary-material" rid="s1">Supplementary Table S3</xref>. In all cases, we found that MICCA estimates a number of OTUs that is intermediate between what found by QIIME and UPARSE (always much closer to the UPARSE estimate), as already found on the synthetic datasets. However, the number of distinct genera is always only marginally smaller than the estimate given by QIIME, showing that the higher selectivity in the OTUs identification does not affect the ability of MICCA to characterize the biological complexity of the analysed samples. These results (number of OTUs and number of distinct genera) indicate that MICCA reaches a good compromise between the need to guarantee the quality of the OTUs and to identify less abundant taxa, without excessive loss of information due to filtering, thus confirming the advantage of MICCA over competing software.</p>
    </sec>
    <sec disp-level="2">
      <title>Estimates of the diversity indices</title>
      <p>To assess the stability of the OTUs estimates and of various ecological measure of complexity, we generated two independent datasets, one for 16S bacterial amplicons (16S-10) and one composed by ITS fungal amplicons (ITS-10). Each dataset was composed by 10 independent samples having the same community structure and number of OTUs. Results are shown in <xref ref-type="fig" rid="f3">Figure 3a and 3b</xref> for the 16S-10 and ITS-10 datasets respectively, where the horizontal lines indicates the median over the replicated datasets and the dashed lines indicates the real values. The impact of these different reconstructions of the microbial communities is immediately evident calculating the Shannon, Simpson and Inverse Simpson diversity indices, commonly used in environmental metagenomic studies to measure the complexity of the microbial communities. With the exception of the Shannon diversity index for the ITS-10 dataset, the median of the indices estimated using MICCA are closer to the real value than the indices estimated with the other two pipelines. Moreover, the spread in terms of interquartile range (IQR) of the estimates obtained by MICCA is always considerably lower than the dispersion of the estimates obtained both with UPARSE and QIIME (<xref ref-type="supplementary-material" rid="s1">Supplementary Table S4</xref>).</p>
    </sec>
    <sec disp-level="2">
      <title>Performances on biological datasets</title>
      <p>To show the effect of the MICCA pipeline on real data, we have analysed two public metagenomic datasets, one reporting the bacterial composition of samples collected along the Delaware Bay, and the other reporting the bacterial component of the distal gut microbiota of three individuals in a time series including two courses of antibiotic treatment with ciprofloxacin. The analysis of an environmental dataset and a gut dataset puts MICCA to the test of two of the most common applications of metagenomics. The Delaware Bay study is focused on the analysis of diversity, composition and activity of bacteria in a salinity gradient typical of estuarial environment. We have evaluated the Chao1 estimator of the number of OTUs after sample pooling and rarefaction using MICCA, UPARSE and QIIME. The results are shown in <xref ref-type="fig" rid="f4">Figure 4</xref>. Qualitatively the results confirm the behaviours of the three pipelines observed on the simulated datasets. QIIME finds more than twice as many OTUs as identified by MICCA, while UPARSE is much more conservative and individuates less OTUs in each of the different samples.</p>
      <p>Analysis of the antibiotic treatments study highlights the advantages of using MICCA in term of the higher number of sequences used and more consistent estimates of the number of OTUs across replicates. In the original study a custom pipeline based on mothur and UCLUST with a reference-based clustering protocol was applied<xref ref-type="bibr" rid="b7">7</xref>. In this protocol, sequences that did not have a hit with a reference OTU were excluded from the analysis. After pre-processing, clustering and rarefaction, the number of reads per sample obtained by using the MICCA pipeline was 3.2 × 10<sup>6</sup> clustered into 1466 OTUs, while the reads per sample used in Ref. <xref ref-type="bibr" rid="b7">7</xref> was 1.8 × 10<sup>6</sup> clustered into 2582 OTUs. By aligning the representative sequences of the OTUs obtained in Ref. <xref ref-type="bibr" rid="b7">7</xref> against the representative sequences of the OTUs inferred by MICCA, we found that 1395 original OTUs aligned to 702 OTUs of MICCA (alignments performed using blastn and considering only hits with identity &gt;0.97 and alignment length &gt;100 bp) (see <xref ref-type="fig" rid="f5">Figure 5a</xref>). The more robust estimate of the number of OTUs improves the consistency of the results at the different time points. For instance, in the case of patient E, first Cp treatment, (<xref ref-type="fig" rid="f5">Figure 5b</xref>) it is worth noting that, as expected, the number of OTUs estimated by MICCA decreases during the first antibiotic treatment (solid line, days 79-83), while we observe an inverse trend with the analysis pipeline used in the paper of Dethlefsen (dashed line), probably due to a less robust estimate of the number of OTUs. A generally lower number of OTUs and smoother time series are obtained also for the other patients (patients D, E and F in <xref ref-type="supplementary-material" rid="s1">Supplementary Figures S5</xref>, <xref ref-type="supplementary-material" rid="s1">S6</xref>, <xref ref-type="supplementary-material" rid="s1">S7</xref> respectively).</p>
    </sec>
  </sec>
  <sec disp-level="1">
    <title>Discussion</title>
    <p>The increasing throughput of NGS technologies and the decreasing costs of sequencing is triggering an explosion of the number of projects that use metagenomics to characterize the structure and composition of microbial communities. However, while standard experimental protocols and technologies are emerging that allow the comparison of raw datasets generated by different groups, the reusability of the processed data is often hampered by the lack of standard processing and analysis pipelines. In addition, existing software are often complex to use and allow many different combinations of parameters that make it difficult to document and compare results from different experiments. The availability of standard, easy-to-use and optimized software pipelines would greatly benefit the scientific community involved in the study of the microbiota using metagenomic technologies.</p>
    <p>The analysis of metagenomic sequences can be divided into three main steps: i) quality filtering of the reads and chimera detection; ii) OTU clustering; iii) OTU annotation and analysis. While the third step relies on reference sequence databases to define the taxonomic structure of the sample, the first two steps mostly depend on complex computational procedures for quality filtering and clustering and are critical in order to produce consistent data. For example, failing to eliminate spurious reads might lead to an overestimate of the sample complexity, while a stringent filtering process might eliminate too many reads penalizing the least abundant species. One example of this behaviour is represented by UPARSE, which implements a stringent quality filtering algorithm at the cost of discarding a large fraction of the sequence data. MICCA, implementing a more flexible filtering strategy, tends to use more efficiently the sequenced reads and therefore provides a more realistic estimate of the sample complexity.</p>
    <p>The second step of the procedure, the clustering process, is also critical. The use of greedy clustering algorithms, while being capable to quickly analyse large datasets, might lead to a definition of OTUs that overestimates the number of different species actually present in the sample. One example of this is represented by UCLUST algorithm exploited by QIIME, which systematically overestimates the sample richness, failing to converge to a finite number of OTUs in rarefaction analysis. This feature, share by mothur, makes it difficult to merge samples sequenced to different depths and might lead to sequencing to excessive depth thus increasing the experimental costs. A more accurate approach for the choice of the centroid is implemented in the UPARSE and MICCA pipelines, starting the clustering process from the most abundant reads individuated after the dereplication step. In this way UPARSE and MICCA, using abundance information in the clustering step, are able to provide estimates of the number of OTUs that are less dependent on sequencing depth, thus allowing to attain a good description of metagenomic samples with lower sequencing depth than needed by QIIIME and mothur. In addition, the efficient use of sequence data identifies a richer population structure than UPARSE, avoiding the danger of filtering out the complexity of the sample.</p>
    <p>Given the lack of official and well-studied datasets to test the analysis tools, it is generally difficult to assess the accuracy and reliability of a metagenomic pipeline. To overcome these limitations we tested our pipeline on simulated data where the OTU composition was known, showing that MICCA improves over the existing software. MICCA was able to accurately reconstruct the OTU composition of the samples and gave reliable estimate of the most commonly used diversity indices. In addition, the estimated OTUs, although less numerous that what obtained by QIIME, covered a similar range of biological diversity, as witnessed by the similar number of identified bacterial genera in samples derived from the HMP. When tested on real datasets representing the two most common scenarios for metagenomics studies, <italic>i.e.</italic> environmental metagenomics and gut metagenomics, MICCA showed a higher consistency of the results. For instance, MICCA was able to reconstruct the expected growing curve of the microbiota during two antibiotic courses even in the absence of a reference database for OTUs. This suggests that MICCA can be effectively used also on samples that are rich in species not previously characterized, as is often the case in environmental metagenomic projects.</p>
  </sec>
  <sec disp-level="1">
    <title>Methods</title>
    <sec disp-level="2">
      <title>MICCA</title>
      <p>MICCA is an open-source software pipeline built using the Python and C programming languages (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://www.python.org/">https://www.python.org/</ext-link>) and several external applications. Starting from raw sequencing data, MICCA performs a series of initial analyses to clean the reads cutting the primers and trimming the low quality regions. The pre-processing module of MICCA implements a sliding window approach for quality filtering, discarding the 3′-end of the read when the average quality in the sliding window (including 10% of the read length) drops below a specified threshold. Moreover, ending and contiguous Ns are discarded. After trimming, sequences are discarded if their length is below a specified threshold. All the preprocessing steps are performed by a single command line tool (micca-preproc) which wraps cutadapt<xref ref-type="bibr" rid="b8">8</xref> for primers trimming (modified to include IUPAC codes support) and sickle (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://github.com/najoshi/sickle">https://github.com/najoshi/sickle</ext-link>) for the windowed adaptive quality filtering. After that, a de novo clustering (micca-otu-denovo, using OTUCLUST, a clustering algorithm specifically designed for MICCA) or a reference-based clustering (micca-otu-ref, which wraps DNACLUST<xref ref-type="bibr" rid="b9">9</xref>) can be performed. For the chimera-filtering step, OTUCLUST embeds the public domain version of UCHIME<xref ref-type="bibr" rid="b10">10</xref>. In de novo mode, the representative sequences of the OTUs can finally be classified using BLAST+ (against a QIIME-formatted database, such as Greengenes<xref ref-type="bibr" rid="b11">11</xref>, UNITE<xref ref-type="bibr" rid="b12">12</xref>) or exploiting the RDP classifier<xref ref-type="bibr" rid="b6">6</xref> (version 2.6+ are supported). Furthermore, the single command micca-phylogeny produces a multiple alignments using MUSCLE<xref ref-type="bibr" rid="b13">13</xref>, T-Coffee<xref ref-type="bibr" rid="b14">14</xref> or PyNAST<xref ref-type="bibr" rid="b15">15</xref> and infers a phylogenetic tree with FastTree<xref ref-type="bibr" rid="b16">16</xref>. In <xref ref-type="supplementary-material" rid="s1">Supplementary Table S5</xref> we reported the computation times of the MICCA pipeline using different wrapped tools available in each processing step.</p>
      <p>MICCA can be easily used on a wide range of *NIX platforms, from laptops to high performance computing clusters. The output of MICCA is fully compatible with the R package phyloseq<xref ref-type="bibr" rid="b17">17</xref> for downstream analyses.</p>
    </sec>
    <sec disp-level="2">
      <title>OTUCLUST</title>
      <p>OTUCLUST is a new open-source application specifically created to partition a set of amplicon reads into clusters of sequences within a given identity threshold. OTUCLUST is the default clustering method used in micca-otu-denovo. In OTUCLUST, a cluster is built starting from a centroid (the representative sequence) and from the sequences which have pair-wise similarity with the representative one above the threshold.</p>
    </sec>
    <sec disp-level="2">
      <title>Overview of OTUCLUST algorithm</title>
      <p>The OTUCLUST algorithm can be divided into three main steps: a) dereplication and abundance estimation, b) de novo chimera removal (optional) and c) clustering using a greedy approach, where representative sequences are selected starting from high-abundance reads, which are more likely to be representative sequences (<xref ref-type="supplementary-material" rid="s1">Supplementary Figure S1</xref>).</p>
      <p>The aim of the dereplication is the removal of duplicate sequences. This step is performed by the clustering procedure (described below) with an identity threshold of 100%. Given the increasing size of metagenomic datasets, this step is computationally intensive. In order to provide a faster alternative we have included the possibility to use an exact prefix matching algorithm (MICCA-FAST). Abundances of the dereplicated sequences are estimated by counting the number of reads. Dereplicated sequences are ordered by their abundance and passed to UCHIME<xref ref-type="bibr" rid="b10">10</xref> for chimera detection. Reads detected as chimeras are removed.</p>
      <p>Dereplicated and chimera-free sequences, ordered according to their abundance, are used as cluster seeds by the clustering algorithm. The clustering procedure relies on a search algorithm defined as follows:</p>
      <p>Inputs:
<list id="l1" list-type="bullet"><list-item><p>Query sequence: a cluster seed (dereplicated sequence)</p></list-item><list-item><p>Sequence database: all sequences</p></list-item></list>
<list id="l2" list-type="bullet"><list-item><p>Given a query sequence Q, the sequence database is sorted by decreasing k-mer similarity. The k-mer similarity is defined as in Ref. <xref ref-type="bibr" rid="b13">13</xref>:<inline-formula id="m1"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e392" xlink:href="srep09743-m1.jpg"/></inline-formula>where <italic>τ</italic> is a k-mer, <italic>n</italic> is the number of occurences of the k-mer in the sequences and <italic>l<sub>i</sub></italic>, <italic>l<sub>j</sub></italic> are the lenght of sequences <italic>i</italic> and <italic>j</italic> respectively.</p></list-item><list-item><p>For each sequence in the sorted database (target sequence, T) the similarity <inline-formula id="m3"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e421" xlink:href="srep09743-m3.jpg"/></inline-formula> is computed using the Needleman–Wunsch algorithm. If <inline-formula id="m4"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e424" xlink:href="srep09743-m4.jpg"/></inline-formula> is greater or equal than the identity threshold <italic>s</italic><sup>thr</sup> (e.g. 0.97) the sequence Q is added to the results and the reject counter <italic>n</italic><sub>rej</sub> is set to zero, otherwise <italic>n</italic><sub>rej</sub> is incremented by one.<italic>Definition of pair-wise similarity</italic>
<inline-formula id="m5"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e446" xlink:href="srep09743-m5.jpg"/></inline-formula>. Given a global alignment (GA), between the sequences <italic>i</italic> and <italic>j</italic>, the pair-wise identity is defined as:<inline-formula id="m2"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e457" xlink:href="srep09743-m2.jpg"/></inline-formula>Internal and external gaps are ignored in the definition of <inline-formula id="m6"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e461" xlink:href="srep09743-m6.jpg"/></inline-formula><xref ref-type="bibr" rid="b18">18</xref>, and mismatch and gap penalties are set equal to one in the GA.</p></list-item><list-item><p>If <italic>n</italic><sub>rej</sub> is above the given threshold <italic>m</italic> (a value of 32 has proven to be a good choice for this threshold) it is unlikely that another hit exists. In this case the reads belonging to the cluster are removed from the sequence database and a new seed sequence is chosen according to its abundance.</p></list-item></list>
</p>
    </sec>
    <sec disp-level="2">
      <title>Synthetic data</title>
      <p>We generated two amplicon datasets for the V3-V5 variable region of the16S rRNA gene for bacteria (datasets 16S-R and 16S-10) and one dataset for the ITS (ITS2) region for fungi, mimicking data obtained from a Life Sciences 454 sequencer (GS FLX Titanium series reagents) using Grinder<xref ref-type="bibr" rid="b19">19</xref> starting from 99% clustered OTUs in Greengenes<xref ref-type="bibr" rid="b11">11</xref> version 13_05 for the 16S data and 99% clustered OTUs in the UNITE database<xref ref-type="bibr" rid="b12">12</xref> release 04_07_2014 (after removing duplicate sequences) for the ITS datasets (details, commands and Grinder profile files in <xref ref-type="supplementary-material" rid="s1">Supplementary Data</xref>). Quality profiles of the reads of the 454 pyrosequencing process were simulated with flowsim<xref ref-type="bibr" rid="b20">20</xref>. Community structures were simulated with a power law rank-abundance distribution and 20% of chimeras were generated (90% bimeras, 10% trimeras).</p>
      <sec disp-level="3">
        <title>16S-R</title>
        <p>30 samples were generated from a single Grinder run (100000 reads, 500 OTUs). After the application of the flowsim model, samples were rarefied to a fixed depth at steps of 1000 reads, obtaining 30 samples containing between 1000 and 30000 sequences (dataset available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://compmetagen.github.io/micca/data/16S-R.tar.bz2">http://compmetagen.github.io/micca/data/16S-R.tar.bz2</ext-link>).</p>
      </sec>
      <sec disp-level="3">
        <title>16S-10</title>
        <p>10 independent samples containing 5000 sequences were generated using Grinder (200 OTUs) and flowsim (dataset available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://compmetagen.github.io/micca/data/16S-10.tar.bz2">http://compmetagen.github.io/micca/data/16S-10.tar.bz2</ext-link>).</p>
      </sec>
      <sec disp-level="3">
        <title>ITS-10</title>
        <p>10 independent samples containing 5000 sequences were generated using Grinder (100 OTUs) and flowsim (dataset available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://compmetagen.github.io/micca/data/ITS-10.tar.bz2">http://compmetagen.github.io/micca/data/ITS-10.tar.bz2</ext-link>).</p>
      </sec>
    </sec>
    <sec disp-level="2">
      <title>Biological data</title>
      <sec disp-level="3">
        <title>HMP dataset</title>
        <p>We analysed 12 samples of the Human Microbiome Project<xref ref-type="bibr" rid="b5">5</xref> dataset where the V1-V3, V3-V5 and V6-V9 hypervariable regions of the bacterial 16S gene have been amplified and sequenced using the Roche-454 FLX Titanium platform. Details and NCBI accession numbers are available in the <xref ref-type="supplementary-material" rid="s1">Supplementary Table S6</xref>.</p>
      </sec>
      <sec disp-level="3">
        <title>Salinity dataset</title>
        <p>This dataset characterizes the bacterial communities along the salinity gradient in the Delaware Bay and it is described in Ref. <xref ref-type="bibr" rid="b21">21</xref>. The 454 GS FLX Titanium “whole water” samples were downloaded from the NCBI Sequence Read Archive database, accession number SRA052537 (samples FB_WD, Bay_WD, X14_WD, X16_WD, X18_WD, X20_WD, X22_WD, X26_WD, X28_WD).</p>
      </sec>
      <sec disp-level="3">
        <title>Antibiotic dataset</title>
        <p>Dataset of distal gut of three adult healthy subjects obtained by collecting stool samples (52–56 per subject) over a 10-mo interval, during which time these subjects took two 5-d courses of the antibiotic ciprofloxacin (Cp) separated by 6 mo. 454 GS FLX Titanium data from NCBI Sequence Read Archive, accession number SRA020961<xref ref-type="bibr" rid="b7">7</xref>.</p>
      </sec>
    </sec>
    <sec disp-level="2">
      <title>Software availability</title>
      <p>MICCA is an Open Source project and it is freely available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://compmetagen.github.io/micca/">http://compmetagen.github.io/micca/</ext-link>.</p>
    </sec>
  </sec>
  <sec disp-level="1">
    <title>Additional Information</title>
    <p><bold>How to cite this article</bold>: Albanese, D., Fontana, P., De Filippo, C., Cavalieri, D. &amp; Donati, C. Serum FGF21 levels are associated with brown adipose tissue activity in humans. <italic>Sci. Rep.</italic>
<bold>5</bold>, 9743; doi: 10.1038/srep09743 (2015).</p>
  </sec>
  <sec sec-type="supplementary-material" id="s1">
    <title>Supplementary Material</title>
    <supplementary-material id="d33e30" content-type="local-data">
      <caption>
        <title>Supplementary Information</title>
        <p>Supplementary Info</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep09743-s1.pdf"/>
    </supplementary-material>
    <supplementary-material id="d33e36" content-type="local-data">
      <caption>
        <title>Supplementary Information</title>
        <p>Supplementary Table S3</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep09743-s2.xls"/>
    </supplementary-material>
    <supplementary-material id="d33e42" content-type="local-data">
      <caption>
        <title>Supplementary Information</title>
        <p>Supplementary Table S6</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep09743-s3.xls"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>This work was supported by the Autonomous Province of Trento under the project METAFOODLABS, protocol number S116/2012/537723. We thank P. Sonego, S. Riccadonna and L. Bianco for useful discussions during the course of this work.</p>
  </ack>
  <ref-list>
    <ref id="b1">
      <mixed-citation publication-type="journal"><name><surname>Schloss</surname><given-names>P. D.</given-names></name><italic>et al.</italic><article-title>Introducing mothur: open-source, platform-independent, community-supported software for describing and comparing microbial communities</article-title>. <source>Appl Environ Microbiol</source><volume>75</volume>, <fpage>7537</fpage>–<lpage>7541</lpage>, <pub-id pub-id-type="doi">10.1128/aem.01541-09</pub-id> (<year>2009</year>).<pub-id pub-id-type="pmid">19801464</pub-id></mixed-citation>
    </ref>
    <ref id="b2">
      <mixed-citation publication-type="journal"><name><surname>Caporaso</surname><given-names>J. G.</given-names></name><italic>et al.</italic><article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>. <source>Nat Methods</source><volume>7</volume>, <fpage>335</fpage>–<lpage>336</lpage>, <pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id> (<year>2010</year>).<pub-id pub-id-type="pmid">20383131</pub-id></mixed-citation>
    </ref>
    <ref id="b3">
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>R. C.</given-names></name><article-title>Search and clustering orders of magnitude faster than BLAST</article-title>. <source>Bioinformatics</source><volume>26</volume>, <fpage>2460</fpage>–<lpage>2461</lpage>, <pub-id pub-id-type="doi">10.1093/bioinformatics/btq461</pub-id> (<year>2010</year>).<pub-id pub-id-type="pmid">20709691</pub-id></mixed-citation>
    </ref>
    <ref id="b4">
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>R. C.</given-names></name><article-title>UPARSE: highly accurate OTU sequences from microbial amplicon reads</article-title>. <source>Nat Methods</source><volume>10</volume>, <fpage>996</fpage>–<lpage>998</lpage>, <pub-id pub-id-type="doi">10.1038/nmeth.2604</pub-id> (<year>2013</year>).<pub-id pub-id-type="pmid">23955772</pub-id></mixed-citation>
    </ref>
    <ref id="b5">
      <mixed-citation publication-type="journal">A framework for human microbiome research. . <source>Nature</source>
<volume>486</volume>, <fpage>215</fpage>–<lpage>221</lpage>, <pub-id pub-id-type="doi">10.1038/nature11209</pub-id> (<year>2012</year>).<pub-id pub-id-type="pmid">22699610</pub-id></mixed-citation>
    </ref>
    <ref id="b6">
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Q.</given-names></name>, <name><surname>Garrity</surname><given-names>G. M.</given-names></name>, <name><surname>Tiedje</surname><given-names>J. M.</given-names></name> &amp; <name><surname>Cole</surname><given-names>J. R.</given-names></name>
<article-title>Naive Bayesian classifier for rapid assignment of rRNA sequences into the new bacterial taxonomy</article-title>. <source>Appl Environ Microbiol</source>
<volume>73</volume>, <fpage>5261</fpage>–<lpage>5267</lpage>, <pub-id pub-id-type="doi">10.1128/aem.00062-07</pub-id> (<year>2007</year>).<pub-id pub-id-type="pmid">17586664</pub-id></mixed-citation>
    </ref>
    <ref id="b7">
      <mixed-citation publication-type="journal"><name><surname>Dethlefsen</surname><given-names>L.</given-names></name> &amp; <name><surname>Relman</surname><given-names>D. A.</given-names></name>
<article-title>Incomplete recovery and individualized responses of the human distal gut microbiota to repeated antibiotic perturbation</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>108</volume>
<bold>Suppl 1</bold><fpage>4554</fpage>–<lpage>4561</lpage>, <pub-id pub-id-type="doi">10.1073/pnas.1000087107</pub-id> (<year>2011</year>).<pub-id pub-id-type="pmid">20847294</pub-id></mixed-citation>
    </ref>
    <ref id="b8">
      <mixed-citation publication-type="journal"><name><surname>Martin</surname><given-names>M.</given-names></name><article-title>Cutadapt removes adapter sequences from high-throughput sequencing reads</article-title>. <source>2011</source><volume>17</volume>, <pub-id pub-id-type="doi">10.14806/ej.17.1.200</pub-id>pp. 10-12 (<year>2011</year>).</mixed-citation>
    </ref>
    <ref id="b9">
      <mixed-citation publication-type="journal"><name><surname>Ghodsi</surname><given-names>M.</given-names></name>, <name><surname>Liu</surname><given-names>B.</given-names></name> &amp; <name><surname>Pop</surname><given-names>M.</given-names></name>
<article-title>DNACLUST: accurate and efficient clustering of phylogenetic marker genes</article-title>. <source>BMC Bioinformatics</source>
<volume>12</volume>, <fpage>271</fpage>, <pub-id pub-id-type="doi">10.1186/1471-2105-12-271</pub-id> (<year>2011</year>).<pub-id pub-id-type="pmid">21718538</pub-id></mixed-citation>
    </ref>
    <ref id="b10">
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>R. C.</given-names></name>, <name><surname>Haas</surname><given-names>B. J.</given-names></name>, <name><surname>Clemente</surname><given-names>J. C.</given-names></name>, <name><surname>Quince</surname><given-names>C.</given-names></name> &amp; <name><surname>Knight</surname><given-names>R.</given-names></name>
<article-title>UCHIME improves sensitivity and speed of chimera detection</article-title>. <source>Bioinformatics</source>
<volume>27</volume>, <fpage>2194</fpage>–<lpage>2200</lpage>, <pub-id pub-id-type="doi">10.1093/bioinformatics/btr381</pub-id> (<year>2011</year>).<pub-id pub-id-type="pmid">21700674</pub-id></mixed-citation>
    </ref>
    <ref id="b11">
      <mixed-citation publication-type="journal"><name><surname>DeSantis</surname><given-names>T. Z.</given-names></name><italic>et al.</italic><article-title>Greengenes, a chimera-checked 16S rRNA gene database and workbench compatible with ARB</article-title>. <source>Appl Environ Microbiol</source><volume>72</volume>, <fpage>5069</fpage>–<lpage>5072</lpage>, <pub-id pub-id-type="doi">10.1128/aem.03006-05</pub-id> (<year>2006</year>).<pub-id pub-id-type="pmid">16820507</pub-id></mixed-citation>
    </ref>
    <ref id="b12">
      <mixed-citation publication-type="journal"><name><surname>Koljalg</surname><given-names>U.</given-names></name><italic>et al.</italic><article-title>UNITE: a database providing web-based methods for the molecular identification of ectomycorrhizal fungi</article-title>. <source>New Phytol</source><volume>166</volume>, <fpage>1063</fpage>–<lpage>1068</lpage>, <pub-id pub-id-type="doi">10.1111/j.1469-8137.2005.01376.x</pub-id> (<year>2005</year>).<pub-id pub-id-type="pmid">15869663</pub-id></mixed-citation>
    </ref>
    <ref id="b13">
      <mixed-citation publication-type="journal"><name><surname>Edgar</surname><given-names>R. C.</given-names></name><article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Res</source><volume>32</volume>, <fpage>1792</fpage>–<lpage>1797</lpage>, <pub-id pub-id-type="doi">10.1093/nar/gkh340</pub-id> (<year>2004</year>).<pub-id pub-id-type="pmid">15034147</pub-id></mixed-citation>
    </ref>
    <ref id="b14">
      <mixed-citation publication-type="journal"><name><surname>Notredame</surname><given-names>C.</given-names></name>, <name><surname>Higgins</surname><given-names>D. G.</given-names></name> &amp; <name><surname>Heringa</surname><given-names>J.</given-names></name>
<article-title>T-Coffee: A novel method for fast and accurate multiple sequence alignment</article-title>. <source>J Mol Biol</source>
<volume>302</volume>, <fpage>205</fpage>–<lpage>217</lpage>, <pub-id pub-id-type="doi">10.1006/jmbi.2000.4042</pub-id> (<year>2000</year>).<pub-id pub-id-type="pmid">10964570</pub-id></mixed-citation>
    </ref>
    <ref id="b15">
      <mixed-citation publication-type="journal"><name><surname>Caporaso</surname><given-names>J. G.</given-names></name><italic>et al.</italic><article-title>PyNAST: a flexible tool for aligning sequences to a template alignment</article-title>. <source>Bioinformatics</source><volume>26</volume>, <fpage>266</fpage>–<lpage>267</lpage>, <pub-id pub-id-type="doi">10.1093/bioinformatics/btp636</pub-id> (<year>2010</year>).<pub-id pub-id-type="pmid">19914921</pub-id></mixed-citation>
    </ref>
    <ref id="b16">
      <mixed-citation publication-type="journal"><name><surname>Price</surname><given-names>M. N.</given-names></name>, <name><surname>Dehal</surname><given-names>P. S.</given-names></name> &amp; <name><surname>Arkin</surname><given-names>A. P.</given-names></name>
<article-title>FastTree 2–approximately maximum-likelihood trees for large alignments</article-title>. <source>PLoS One</source>
<volume>5</volume>, <fpage>e9490</fpage>, <pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id> (<year>2010</year>).<pub-id pub-id-type="pmid">20224823</pub-id></mixed-citation>
    </ref>
    <ref id="b17">
      <mixed-citation publication-type="journal"><name><surname>McMurdie</surname><given-names>P. J.</given-names></name> &amp; <name><surname>Holmes</surname><given-names>S.</given-names></name>
<article-title>phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data</article-title>. <source>PLoS One</source>
<volume>8</volume>, <fpage>e61217</fpage>, <pub-id pub-id-type="doi">10.1371/journal.pone.0061217</pub-id> (<year>2013</year>).<pub-id pub-id-type="pmid">23630581</pub-id></mixed-citation>
    </ref>
    <ref id="b18">
      <mixed-citation publication-type="journal"><name><surname>Hwang</surname><given-names>K.</given-names></name><italic>et al.</italic><article-title>CLUSTOM: a novel method for clustering 16S rRNA next generation sequences by overlap minimization</article-title>. <source>PLoS One</source><volume>8</volume>, <fpage>e62623</fpage>, <pub-id pub-id-type="doi">10.1371/journal.pone.0062623</pub-id> (<year>2013</year>).<pub-id pub-id-type="pmid">23650520</pub-id></mixed-citation>
    </ref>
    <ref id="b19">
      <mixed-citation publication-type="journal"><name><surname>Angly</surname><given-names>F. E.</given-names></name>, <name><surname>Willner</surname><given-names>D.</given-names></name>, <name><surname>Rohwer</surname><given-names>F.</given-names></name>, <name><surname>Hugenholtz</surname><given-names>P.</given-names></name> &amp; <name><surname>Tyson</surname><given-names>G. W.</given-names></name>
<article-title>Grinder: a versatile amplicon and shotgun sequence simulator</article-title>. <source>Nucleic Acids Res</source>
<volume>40</volume>, <fpage>e94</fpage>, <pub-id pub-id-type="doi">10.1093/nar/gks251</pub-id> (<year>2012</year>).<pub-id pub-id-type="pmid">22434876</pub-id></mixed-citation>
    </ref>
    <ref id="b20">
      <mixed-citation publication-type="journal"><name><surname>Malde</surname><given-names>K.</given-names></name><article-title>Simulating a population genomics data set using FlowSim</article-title>. <source>BMC Res Notes</source><volume>7</volume>, <fpage>68</fpage>, <pub-id pub-id-type="doi">10.1186/1756-0500-7-68</pub-id> (<year>2014</year>).<pub-id pub-id-type="pmid">24479665</pub-id></mixed-citation>
    </ref>
    <ref id="b21">
      <mixed-citation publication-type="journal"><name><surname>Campbell</surname><given-names>B. J.</given-names></name> &amp; <name><surname>Kirchman</surname><given-names>D. L.</given-names></name>
<article-title>Bacterial diversity, community structure and potential growth rates along an estuarine salinity gradient</article-title>. <source>ISME J</source>
<volume>7</volume>, <fpage>210</fpage>–<lpage>220</lpage>, <pub-id pub-id-type="doi">10.1038/ismej.2012.93</pub-id> (<year>2013</year>).<pub-id pub-id-type="pmid">22895159</pub-id></mixed-citation>
    </ref>
  </ref-list>
  <fn-group>
    <fn>
      <p><bold>Author Contributions</bold> D.A. and P.F. developed the software and performed the analyses. C.D., C.D.F. and D.C. supervised the analyses. All authors wrote the manuscript.</p>
    </fn>
  </fn-group>
</back>
<floats-group>
  <fig id="f1">
    <label>Figure 1</label>
    <caption>
      <title>16S-R dataset: Evaluation of MICCA pipeline performance compared with UPARSE and QIIME.</title>
      <p>MICCA was also tested in fast variant (MICCA-FAST). In (a) the rarefaction curves are plotted. The continuous green lines represent the actual values. In (b) the relative abundances of the top 20 ranked OTUs compared to the actual values. RSS: Residual Sum of Squares.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep09743-f1"/>
  </fig>
  <fig id="f2">
    <label>Figure 2</label>
    <caption>
      <title>Number of OTUs (upper panels) and of distinct genera (lower panels) obtained using MICCA, QIIME and UPARSE for three choices of the of the 16S variable region, namely V1-V3, V3-V5 and V6-V9.</title>
      <p>Samples were taken from the HMP, selecting those for which data for the three regions were available.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep09743-f2"/>
  </fig>
  <fig id="f3">
    <label>Figure 3</label>
    <caption>
      <title>Diversity indices computed using MICCA, UPARSE and QIIME on the 16S-10 (above) and ITS-10 (below) simulated dataset.</title>
      <p>The dashed lines represent the real values.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep09743-f3"/>
  </fig>
  <fig id="f4">
    <label>Figure 4</label>
    <caption>
      <title>Curves of the salinity dataset after pooling and rarefaction.</title>
      <p>The plot represents the variation of the number of OTUs as a function of salinity in marine water in the Delaware Bay obtained analysing the data using the three pipelines, MICCA, UPARSE and QIIME.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep09743-f4"/>
  </fig>
  <fig id="f5">
    <label>Figure 5</label>
    <caption>
      <p>(a) Scatter plot of the number of OTUs identified by the analysis pipeline used in the paper of Dethlefsen et al. for patients, D, E and F vs the number of OTUs estimated by MICCA. (b) Patient E. The microbial growing curve inferred by the two pipelines during the first antibiotic ciprofloxacin (Cp) treatment and the week post Cp (WPC).</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep09743-f5"/>
  </fig>
  <table-wrap position="float" id="t1">
    <label>Table 1</label>
    <caption>
      <title>List of the software wrapped in the main tools available in the MICCA pipeline</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="left" valign="top" charoff="50">Command</th>
          <th align="center" valign="top" charoff="50">Description</th>
          <th align="center" valign="top" charoff="50">Tools</th>
          <th align="center" valign="top" charoff="50">Notes</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="left" valign="top" charoff="50">micca-preproc</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">supports gapped alignment and IUPAC codes for primer trimming</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">• primer trimming both in the 5′ and 3′ ends of reads using semi-global alignments</td>
          <td align="left" valign="top" charoff="50">• Cutadapt</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">• quality trimming using sliding windows</td>
          <td align="left" valign="top" charoff="50">• SICKLE</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">• minimum length filtering</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">micca-otu-denovo</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">BLAST+: Greengenes, Silva and UNITE QIIME-formatted databases are supported. RDP: versions 2.6+ are supported.</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">• de novo sequence clustering</td>
          <td align="left" valign="top" charoff="50">• OTUCLUST</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">• de novo chimera filtering</td>
          <td align="left" valign="top" charoff="50">• UCHIME</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">• taxonomic assignment with RDP classifier or BLAST+</td>
          <td align="left" valign="top" charoff="50">• RDP Classifier</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">• BLAST+</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">micca-otu-ref</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">Greengenes, Silva and UNITE QIIME-formatted databases are supported</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">• reference-based clustering</td>
          <td align="left" valign="top" charoff="50">• DNACLUST</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50">micca-phylogeny</td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">• de novo and template-based multiple sequence alignment (MSA)</td>
          <td align="left" valign="top" charoff="50">• MUSCLE</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">• phylogenetic tree reconstruction</td>
          <td align="left" valign="top" charoff="50">• T-Coffee</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">• PyNAST</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">• FastTree</td>
          <td align="left" valign="top" charoff="50"> </td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap position="float" id="t2">
    <label>Table 2</label>
    <caption>
      <title>Comparison of MICCA, QIIME and UPARSE on both 16-10 and ITS-10 datasets in terms of average % of reads passing the quality filtering step, number of OTUs found, chimeric and redundant OTUs (i.e. OTUs corresponding to the same centroid in the synthetic datasets). Standard deviations are indicated in parentheses</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="left" valign="top" charoff="50">Dataset</th>
          <th align="left" valign="top" charoff="50">Pipeline</th>
          <th align="left" valign="top" charoff="50">% reads passing the filtering step</th>
          <th align="left" valign="top" charoff="50">OTUs found</th>
          <th align="left" valign="top" charoff="50">% Chimeric Reads</th>
          <th align="left" valign="top" charoff="50">Chimeric OTUs</th>
          <th align="left" valign="top" charoff="50">Redundant OTUs</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="justify" valign="top" charoff="50">16S-10</td>
          <td align="left" valign="top" charoff="50">MICCA</td>
          <td align="char" valign="top" char="." charoff="50">86.6 (1.8)</td>
          <td align="char" valign="top" char="(" charoff="50">173.4 (6.2)</td>
          <td align="char" valign="top" char="." charoff="50">13.1 (0.7)</td>
          <td align="char" valign="top" char="." charoff="50">0.5 (0.5)</td>
          <td align="char" valign="top" char="(" charoff="50">0 (0)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">QIIME</td>
          <td align="char" valign="top" char="." charoff="50">84.4 (2.1)</td>
          <td align="char" valign="top" char="(" charoff="50">263.3 (9.6)</td>
          <td align="char" valign="top" char="." charoff="50">12.0 (0.6)</td>
          <td align="char" valign="top" char="." charoff="50">26.8 (5.8)</td>
          <td align="char" valign="top" char="(" charoff="50">31.5 (3.4)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">UPARSE</td>
          <td align="char" valign="top" char="." charoff="50">64.6 (2.4)</td>
          <td align="char" valign="top" char="(" charoff="50">148.3 (7.4)</td>
          <td align="char" valign="top" char="." charoff="50">15.5 (0.8)</td>
          <td align="char" valign="top" char="." charoff="50">0.2 (0.4)</td>
          <td align="char" valign="top" char="(" charoff="50">0 (0)</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">ITS-10</td>
          <td align="left" valign="top" charoff="50">MICCA</td>
          <td align="char" valign="top" char="." charoff="50">74.1 (5.2)</td>
          <td align="char" valign="top" char="(" charoff="50">93 (2.3)</td>
          <td align="char" valign="top" char="." charoff="50">12.7 (0.5)</td>
          <td align="char" valign="top" char="." charoff="50">0.6 (0.8)</td>
          <td align="char" valign="top" char="(" charoff="50">0 (0)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">QIIME</td>
          <td align="char" valign="top" char="." charoff="50">71.8 (5.5)</td>
          <td align="char" valign="top" char="(" charoff="50">179.1 (7.5)</td>
          <td align="char" valign="top" char="." charoff="50">11.5 (0.5)</td>
          <td align="char" valign="top" char="." charoff="50">28.7 (10.4)</td>
          <td align="char" valign="top" char="(" charoff="50">34 (2.3)</td>
        </tr>
        <tr>
          <td align="left" valign="top" charoff="50"> </td>
          <td align="left" valign="top" charoff="50">UPARSE</td>
          <td align="char" valign="top" char="." charoff="50">66.8 (4.1)</td>
          <td align="char" valign="top" char="(" charoff="50">89.5 (1.8)</td>
          <td align="char" valign="top" char="." charoff="50">15.5 (0.6)</td>
          <td align="char" valign="top" char="." charoff="50">0.1 (0.3)</td>
          <td align="char" valign="top" char="(" charoff="50">0.9 (0.7)</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
