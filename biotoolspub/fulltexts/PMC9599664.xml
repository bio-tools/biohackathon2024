<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with OASIS Tables v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archive-oasis-article1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats-oasis2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">mSystems</journal-id>
    <journal-id journal-id-type="iso-abbrev">mSystems</journal-id>
    <journal-id journal-id-type="publisher-id">msystems</journal-id>
    <journal-title-group>
      <journal-title>mSystems</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2379-5077</issn>
    <publisher>
      <publisher-name>American Society for Microbiology</publisher-name>
      <publisher-loc>1752 N St., N.W., Washington, DC</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9599664</article-id>
    <article-id pub-id-type="pmid">36047699</article-id>
    <article-id pub-id-type="publisher-id">00995-21</article-id>
    <article-id pub-id-type="doi">10.1128/msystems.00995-21</article-id>
    <article-id pub-id-type="publisher-id">msystems.00995-21</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods and Protocols</subject>
      </subj-group>
      <subj-group subj-group-type="biological-terms">
        <compound-subject>
          <compound-subject-part content-type="code">computational-biology</compound-subject-part>
          <compound-subject-part content-type="label">Computational Biology</compound-subject-part>
        </compound-subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>STENSL: Microbial Source Tracking with ENvironment SeLection</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>An</surname>
          <given-names>Ulzee</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <!--<xref ref-type="other" rid="cr1 cr2 cr3 cr cr"/>-->
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0003-1708-6050</contrib-id>
        <name>
          <surname>Shenhav</surname>
          <given-names>Liat</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>b</sup>
        </xref>
        <email>lshenhav@rockefeller.edu</email>
        <!--<xref ref-type="other" rid="cr4 cr5 cr6 cr7 cr8"/>-->
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Olson</surname>
          <given-names>Christine A.</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">
          <sup>c</sup>
        </xref>
        <!--<xref ref-type="other" rid="cr9"/>-->
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Hsiao</surname>
          <given-names>Elaine Y.</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">
          <sup>c</sup>
        </xref>
        <!--<xref ref-type="other" rid="cr10"/>-->
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Halperin</surname>
          <given-names>Eran</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff4" ref-type="aff">
          <sup>d</sup>
        </xref>
        <xref rid="aff5" ref-type="aff">
          <sup>e</sup>
        </xref>
        <xref rid="aff6" ref-type="aff">
          <sup>f</sup>
        </xref>
        <!--<xref ref-type="other" rid="cr11 cr12 cr13"/>-->
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Sankararaman</surname>
          <given-names>Sriram</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff4" ref-type="aff">
          <sup>d</sup>
        </xref>
        <xref rid="aff5" ref-type="aff">
          <sup>e</sup>
        </xref>
        <!--<xref ref-type="other" rid="cr14 cr15 cr16"/>-->
      </contrib>
      <aff id="aff1">
        <label>a</label>
        <addr-line>Department of Computer Science, University of California Los Angeles, Los Angeles, California, USA</addr-line>
      </aff>
      <aff id="aff2">
        <label>b</label>
        <addr-line>Center for Studies in Physics and Biology, Rockefeller University, New York, New York, USA</addr-line>
      </aff>
      <aff id="aff3">
        <label>c</label>
        <addr-line>Department of Integrative Biology and Physiology, University of California Los Angeles, Los Angeles, California, USA</addr-line>
      </aff>
      <aff id="aff4">
        <label>d</label>
        <addr-line>Department of Computational Medicine, <institution-wrap><institution>University of California, Los Angeles</institution><institution-id institution-id-type="grid">grid.19006.3e</institution-id></institution-wrap>, California, USA</addr-line>
      </aff>
      <aff id="aff5">
        <label>e</label>
        <addr-line>Department of Human Genetics, <institution-wrap><institution>University of California, Los Angeles</institution><institution-id institution-id-type="grid">grid.19006.3e</institution-id></institution-wrap>, California, USA</addr-line>
      </aff>
      <aff id="aff6">
        <label>f</label>
        <addr-line>Department of Anesthesiology and Perioperative Medicine, <institution-wrap><institution>University of California, Los Angeles</institution><institution-id institution-id-type="grid">grid.19006.3e</institution-id></institution-wrap>, California, USA</addr-line>
      </aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <role>Editor</role>
        <name>
          <surname>Shade</surname>
          <given-names>Ashley</given-names>
        </name>
        <aff>Michigan State University</aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn fn-type="equal">
        <p>Ulzee An and Liat Shenhav denote equal contribution. Author order was determined by contribution.</p>
      </fn>
      <fn fn-type="COI-statement">
        <p>The authors declare a conflict of interest. Eran Halperin is the SVP of AI/ML in Optum Labs.</p>
      </fn>
    </author-notes>
    <pub-date publication-format="electronic" date-type="pub">
      <day>1</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <pub-date publication-format="electronic" date-type="collection">
      <season>Sep-Oct</season>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>1</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <!--PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>.-->
    <volume>7</volume>
    <issue>5</issue>
    <elocation-id>e00995-21</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>8</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>7</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2022 An et al.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>An et al.</copyright-holder>
      <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2022-09-01"/>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="msystems.00995-21.pdf"/>
    <abstract>
      <title>ABSTRACT</title>
      <p>Microbial source tracking analysis has emerged as a widespread technique for characterizing the properties of complex microbial communities. However, this analysis is currently limited to source environments sampled in a specific study. In order to expand the scope beyond one single study and allow the exploration of source environments using large databases and repositories, such as the Earth Microbiome Project, a source selection procedure is required. Such a procedure will allow differentiating between contributing environments and nuisance ones when the number of potential sources considered is high. Here, we introduce STENSL (microbial Source Tracking with ENvironment SeLection), a machine learning method that extends common microbial source tracking analysis by performing an unsupervised source selection and enabling sparse identification of latent source environments. By incorporating sparsity into the estimation of potential source environments, STENSL improves the accuracy of true source contribution, while significantly reducing the noise introduced by noncontributing ones. We therefore anticipate that source selection will augment microbial source tracking analyses, enabling exploration of multiple source environments from publicly available repositories while maintaining high accuracy of the statistical inference.</p>
      <p><bold>IMPORTANCE</bold> Microbial source tracking is a powerful tool to characterize the properties of complex microbial communities. However, this analysis is currently limited to source environments sampled in a specific study. In many applications there is a clear need to consider source selection over a large array of microbial environments, external to the study. To this end, we developed STENSL (microbial Source Tracking with ENvironment SeLection), an expectation-maximization algorithm with sparsity that enables the identification of contributing sources among a large set of potential microbial environments. With the unprecedented expansion of microbiome data repositories such as the Earth Microbiome Project, recording over 200,000 samples from more than 50 types of categorized environments, STENSL takes the first steps in performing automated source exploration and selection. STENSL is significantly more accurate in identifying the contributing sources as well as the unknown source, even when considering hundreds of potential source environments, settings in which state-of-the-art microbial source tracking methods add considerable error.</p>
    </abstract>
    <kwd-group>
      <title>KEYWORDS</title>
      <kwd>feature selection</kwd>
      <kwd>microbial source tracking</kwd>
      <kwd>microbiome</kwd>
      <kwd>mixture models</kwd>
      <kwd>sparsity</kwd>
    </kwd-group>
    <counts>
      <count count="10" count-type="supplementary-material"/>
      <fig-count count="4"/>
      <table-count count="0"/>
      <equation-count count="14"/>
      <ref-count count="12"/>
      <page-count count="13"/>
      <word-count count="6152"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>September/October 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>INTRODUCTION</title>
    <p>Complex microbial communities are present in multiple biological domains and play far-reaching roles in various fields, from human health, through agriculture, to bioremediation. The study of these high-dimensional communities offers great opportunities for biological discovery, due to the ease of their measurement, the ability to perturb them, and their dynamic and rapidly evolving nature. These same characteristics, however, make it difficult to extract informative and reproducible patterns informing the origins of these ecosystems. Specifically, as microbial community assembly strongly depends on the dispersal of microbes from a mixture of source environments, the analysis of such communities requires tailored algorithms deconvolving latent structures regarding community integration.</p>
    <p>Over the last decade, several computational techniques have been proposed for tracking the assembly of such complex microbial communities (<xref rid="B1" ref-type="bibr">1</xref><xref rid="B2" ref-type="bibr">–</xref><xref rid="B3" ref-type="bibr">3</xref>). By performing “microbial source tracking,” methods such as FEAST (<xref rid="B1" ref-type="bibr">1</xref>) and SourceTracker2 (<xref rid="B2" ref-type="bibr">2</xref>) quantify the fraction, or proportion, of different microbial samples (sources) in a target microbial community (sink), while assuming the sink is a mixture of sampled microbial environments (i.e., known sources) with the possibility of unmeasured ones, collectively referred to as the “unknown source.” These methods have shown great promise in revealing new insights, particularly in quantifying contamination and tracking microbial community integration (<xref rid="B4" ref-type="bibr">4</xref><xref rid="B5" ref-type="bibr">–</xref><xref rid="B6" ref-type="bibr">6</xref>). However, in many practical scenarios the number of contributing sources is much smaller than the number of candidate sources considered in the analysis. Unfortunately, existing methods are suboptimal in such scenarios, hindering the concept of source exploration.</p>
    <p>As it may be nearly impossible to obtain sequencing data for all potential source environments in a study, source exploration using public repositories may augment microbial source tracking analyses, beyond the scope of any one study. We therefore suggest that in these settings, microbial source tracking can benefit from automated source exploration and selection. Nonetheless, this process remains largely understudied, with current methods not suitable for the task, as-is, since the estimation error increases as the number of sources considered increases. Only one previous study tried to address this limitation by exploring the utility of Aitchison distance to select “important” sources that drive community assembly (<xref rid="B7" ref-type="bibr">7</xref>). However, as we demonstrate using simulations, the accuracy of this strategy in the presence of an unknown source is very low.</p>
    <p>Here we introduce STENSL, a scalable algorithm that unveils the latent structure of a given microbial community by modeling it as a convex combination of (1) contributing sources (observed sources with a nonzero contribution to the sink), (2) nuisance or noncontributing sources (observed sources with zero contribution), and (3) unobserved or unknown sources. We use the term candidate sources to describe the union of the former two. STENSL enables the incorporation of multiple candidate sources from publicly available repositories without the need for manual selection. Unlike current microbial source tracking methods, multiple sources can be considered without increasing the error in estimating the underlying mixing proportions. We demonstrate that, when considering both contributing and noncontributing source environments, STENSL is significantly more accurate than state-of-the-art methods. Thus, by leveraging sources from publicly available repositories, STENSL can provide more accurate estimates of the origin of complex microbial communities.</p>
  </sec>
  <sec sec-type="results" id="s2">
    <title>RESULTS</title>
    <sec id="s2-1">
      <title>A brief description of the model.</title>
      <p>STENSL detects a core group of source environments within a larger group of candidate environments and quantifies their contribution to the formation of complex microbial communities. STENSL takes an input a microbiome sample (called the sink) as well as a separate group of microbial samples (called the candidate sources), detects a core group of contributing sources and estimates the fraction of the sink community that was contributed by each of these core environments. By virtue of these mixing proportions summing to less than the entire sink, STENSL also reports the fraction of the sink attributed to other, unobserved, origins (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). STENSL is based on a least-squares optimization with an L1-norm regularization, acting as a source selection procedure, integrated into the microbial source tracking mixture model. In STENSL, we also introduce a procedure to analytically reconstruct the best representation of the unknown source. Specifically, we leverage the regularized least-squares solution of the mixture model to identify taxa which are accurately reconstructed and are thus not unlikely to originate from the unknown source (Materials and Methods). STENSL identifies three types of sources: (1) contributing sources (sources observed and having a nonzero contribution), (2) nuisance sources, also called noncontributing sources (observed and having zero contribution), and (3) unobserved sources, collectively referred to as the unknown source. In other words, our method explicitly differentiates between two types of known sources introduced into the model (i.e., contributing and nuisance). As we demonstrate below, these modifications are significant in denoising and exploring a cohort of candidate sources. Specifically, we show that STENSL is significantly more accurate than existing methods when considering a large number of nuisance sources, a setting in which the identification of truly contributing sources becomes nontrivial.</p>
      <fig position="float" id="fig1">
        <label>FIG 1</label>
        <caption>
          <p>Overview of the STENSL algorithm. The source-tracking task involves estimation of the relative contribution of sources to the formation of a sink. STENSL performs sparse estimation which makes source tracking more accurate for large numbers of sources and allows consideration of sources that may not contribute to the sink.</p>
        </caption>
        <graphic xlink:href="msystems.00995-21-f001" position="anchor"/>
      </fig>
    </sec>
    <sec id="s2-2">
      <title>Model evaluation using data-driven simulations.</title>
      <p>We use simulations to compare the accuracy of STENSL to FEAST, SourceTracker2, and RAD, methods previously suggested for microbial source tracking. The samples used in these simulations are based on real microbial samples documented and processed as part of the Earth Microbiome Project (<xref rid="B8" ref-type="bibr">8</xref>). The synthetic sink samples were generated as a convex combination of real microbial samples (i.e., contributing sources) and an unknown source, hidden from the algorithm. Our evaluation extends the source tracking problem by introducing to the algorithm numerous additional sources unrelated to the sink such that all methods consider both contributing and nuisance sources. To measure accuracy, we compared the estimated mixing proportions with the true ones using mean-squared error (<xref rid="fig2" ref-type="fig">Figure 2A</xref>, <xref rid="tabS1" ref-type="supplementary-material">Table S1</xref>). Overall, we found that STENSL was the only method to consistently estimate the level of real sources’ contribution, with significantly lower mean-squared error (MSE) across positive unknown contributions up to 90% (SourceTracker2, <italic toggle="yes">P</italic> &lt; 9.13 × 10<sup>−7</sup>; FEAST, <italic toggle="yes">P</italic> &lt; 1.01 × 10<sup>−6</sup>; RAD, <italic toggle="yes">P</italic> &lt; 9.13 × 10<sup>−7</sup>; Wilcoxon signed-rank test). The ability of each method to distinguish truly contributing sources was further assessed by summing non-zero weight attributed to nuisance sources. We term this metric the “false positive rate” (see Materials and Methods).</p>
      <supplementary-material position="float" id="tabS1" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00995-21.7</object-id>
        <label>TABLE S1</label>
        <p>Performance table benchmarking methods. (a) <italic toggle="yes">P</italic>-values for difference in mean t-tests (paired) for MSE accuracy of STENSL to estimate the true mixing proportions against comparable methods. We observe that for any amount of positive unknown contribution that STENSL would obtain favorable results in the estimation task with significance. (b) <italic toggle="yes">P</italic>-values for difference in mean t-tests of false positive source detections, characterized as noisy predictions. (c) <italic toggle="yes">P</italic>-values for difference in mean t-tests of the absolute error between simulated and estimated unknown presence. Download <inline-supplementary-material id="tS1" xlink:href="msystems.00995-21-s0007.docx" content-type="local-data">Table S1, DOCX file, 0.02 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2022 An et al.</copyright-statement>
          <copyright-year>2022</copyright-year>
          <copyright-holder>An et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2022-09-01"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <p>We found that using STENSL, the false positive rate was significantly reduced compared to the other methods (<xref rid="fig2" ref-type="fig">Figure 2B</xref>; SourceTracker2, <italic toggle="yes">P</italic> &lt; <inline-formula id="ui1"><alternatives><inline-graphic xlink:href="msystems.00995-21-m015.jpg"/><mml:math id="u1" display="inline" overflow="scroll"><mml:mrow><mml:mn>9.13</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>; FEAST, <italic toggle="yes">P</italic> &lt; 1.67 × 10<sup>−6</sup>; RAD, <italic toggle="yes">P</italic> &lt; <inline-formula id="ui2"><alternatives><inline-graphic xlink:href="msystems.00995-21-m016.jpg"/><mml:math id="u2" display="inline" overflow="scroll"><mml:mrow><mml:mn>9.13</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>; Wilcoxon ranked-sum test). We note that lower false positive rates correspond to improvements in the identification of truly contributing sources as well as estimation of the unknown source proportions. Conversely, we found that for FEAST, RAD, and SourceTracker2, noncontributing sources were consistently assigned positive weights and the misattributions increased with an increasing number of candidate sources. Notably, in the absence of nuisance sources, STENSL is as accurate as FEAST, the state-of-the-art method.</p>
      <fig position="float" id="fig2">
        <label>FIG 2</label>
        <caption>
          <p>(A) Estimation of mixing proportions using STENSL. In a simulated setting of M = 50 total candidates (K = 10 contributing sources within), mean-squared error of the estimated mixing proportion was evaluated for STENSL, SourceTracker2, FEAST, and RAD. The accuracy of estimating the simulated unknown proportion was also measured using absolute error. Experiments were repeated with increasing unknown presence of 0%, 20%, 40%, 70%, and 90%. Error bars indicate standard deviation in error for tested sinks within each group. (B) Breakdown of estimated mixing proportions. For the group of sinks where we simulated intermediate unknown proportion (40%), we label how each method attributes mixing proportion weights across truly contributing sources, false positive sources, and the unknown proportion, in the setting of 50 candidate and 10 contributing sources. STENSL maintained the lowest proportion of false positive attributions in comparison to similar methods which were overwhelmed adversely by the increased number of candidates (significantly lower with <italic toggle="yes">P</italic> &lt; 7.47 × 10<sup>−4</sup> across all methods, <xref rid="figS1" ref-type="supplementary-material">Fig. S1</xref>).</p>
        </caption>
        <graphic xlink:href="msystems.00995-21-f002" position="anchor"/>
      </fig>
      <supplementary-material position="float" id="figS1" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00995-21.1</object-id>
        <label>FIG S1</label>
        <p>Performance of STENSL, FEAST, SourceTracker2, and RAD where no unknown source is present (0%) in simulations. Estimation performance is measured on a simulated sink consisting of K = 10 sources, with M = 50 sources provided in total as potential candidates as sources in the source tracking problem. For 30 such simulated source-sink problems (a) performance is quantified as mean-squared error of known simulated mixing proportion vs estimated mixing proportion and (b) sum of residuals (absolute) of estimated mixing proportion for each set of sources where error directly corresponds to misattributed proportions. Download <inline-supplementary-material id="fS1" xlink:href="msystems.00995-21-s0001.tif" content-type="local-data">FIG S1, TIF file, 0.8 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2022 An et al.</copyright-statement>
          <copyright-year>2022</copyright-year>
          <copyright-holder>An et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2022-09-01"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <p>We next quantified the accuracy of the estimated unknown proportion through absolute error (AE) against the true simulated unknown proportion ranging from 0% to 90% in the sink. To visualize how unknown proportions affect estimation, we correlated the estimated unknown proportions with the true unknown proportions in <xref rid="fig2" ref-type="fig">Fig. 2A</xref>. We found that STENSL is significantly more accurate in estimating the unknown source contribution whenever there was positive unknown presence (SourceTracker2, <italic toggle="yes">P</italic> &lt; 2.04 × 10<sup>−6</sup>; FEAST, <italic toggle="yes">P</italic> &lt; 1.63 × 10<sup>−5</sup>; RAD, <italic toggle="yes">P</italic> &lt; 9.13 × 10<sup>−7</sup>; Wilcoxon rank-sum test; <xref rid="tabS1" ref-type="supplementary-material">Table S1</xref>). For the smallest simulated setting of three true sources and six total candidate sources, we found that all methods were accurate in estimating the unknown source contribution (<xref rid="figS2" ref-type="supplementary-material">Fig. S2</xref>). However, as the number of candidate sources increased, existing methods significantly underestimated the unknown proportion due to both false identifications of sources and overestimation of truly contributing sources. In addition to stimulated sinks, we also examined the effectiveness of STENSL in discerning sources with commonality in descriptive features from the Earth Microbiome Project (EMP). We gathered samples as candidates from up to 10 separate EMP studies and found that STENSL estimated proportions highly for sources from the study where the sink was originally found (<xref rid="figS6" ref-type="supplementary-material">Fig. S6</xref>).</p>
      <supplementary-material position="float" id="figS2" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00995-21.2</object-id>
        <label>FIG S2</label>
        <p>Performance of source tracking algorithms using a small number of sources. K = 3 contributing sources were present among M = 6 candidate sources with 40% unknown contribution. 5 total simulations are visualized. Estimated source proportions were colorized as being correctly attributed to true sources (Src), false-positive detection (FP), attributed correctly as unknown proportion (Unk), and overly attributed to a source despite being correct (Over). Download <inline-supplementary-material id="fS2" xlink:href="msystems.00995-21-s0002.tif" content-type="local-data">FIG S2, TIF file, 0.5 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2022 An et al.</copyright-statement>
          <copyright-year>2022</copyright-year>
          <copyright-holder>An et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2022-09-01"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <supplementary-material position="float" id="figS6" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00995-21.6</object-id>
        <label>FIG S6</label>
        <p>Earth Microbiome Project experiments. (a) A single sea water sample was chosen from EMP study 1222 (S5), and its source proportion was estimated given samples collected across 8 total separate studies including the originating study. Up to 100 samples were considered from each study. (b) A similar experiment was performed for an urban biome sample chosen from EMP study 2192 (S10), given other samples spanning 10 separate studies. The estimated proportions were colorized by their origin; either the original study (Original) a separate study (External), or an unaccounted unknown proportion (Unknown). Download <inline-supplementary-material id="fS6" xlink:href="msystems.00995-21-s0006.tif" content-type="local-data">FIG S6, TIF file, 0.5 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2022 An et al.</copyright-statement>
          <copyright-year>2022</copyright-year>
          <copyright-holder>An et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2022-09-01"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
    </sec>
    <sec id="s2-3">
      <title><italic toggle="yes">In vitro</italic> model validation.</title>
      <p>To validate the sparsity assumption introduced by STENSL, which models a microbial community as a convex combination of contributing sources, and to further demonstrate the utility of our method, we created an <italic toggle="yes">in vitro</italic> data set. In this data, we generated <italic toggle="yes">in vitro</italic> sinks as a mixture of microbial samples acquired from the digestive systems of three human subjects and three mice subjects (Materials and Methods). Twenty-four <italic toggle="yes">in vitro</italic> sinks were assembled, each sink consisting of two to three microbial samples at varying mixing proportions. When performing microbial source tracking analyses on this set of contributing sources and sinks, we added a group of 50 additional noncontributing sources (Materials and Methods). Our analysis considered STENSL, SourceTracker2, FEAST, and RAD. We evaluated the accuracy of these methods by using MSE between the lab-generated ground-truth and the estimated mixing proportions. As part of our analysis, for each sink, we withheld one or two contributing sources to create settings in which the unknown proportions range between 0% to ~80%. Similar to our simulation results, we found that in real data, STENSL was significantly more accurate than other methods (<xref rid="fig3" ref-type="fig">Fig. 3</xref>; SourceTracker2, <italic toggle="yes">P</italic> &lt; 2.2 × 10<sup>−16</sup>; FEAST, <italic toggle="yes">P</italic> &lt; 2.1 × 10<sup>−16</sup>; RAD, <italic toggle="yes">P</italic> &lt; 2.8 × 10<sup>−16</sup>; Wilcoxon ranked-sum test). The breakdown of estimated source proportions for a subset of sink samples are visualized in <xref rid="figS5" ref-type="supplementary-material">Fig. S5</xref>.</p>
      <fig position="float" id="fig3">
        <label>FIG 3</label>
        <caption>
          <p>Analysis of <italic toggle="yes">in vitro</italic> data set of sinks created from mixture of human and mice gut samples. The accuracy of STENSL, SourceTracker2, and FEAST was evaluated using mean-squared error (MSE) against the true mixing proportion used to create <italic toggle="yes">in vitro</italic> sinks with unknown proportions ranging from 0% to ~80% and in the presence of 50 noncontributing sources.</p>
        </caption>
        <graphic xlink:href="msystems.00995-21-f003" position="anchor"/>
      </fig>
      <supplementary-material position="float" id="figS5" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00995-21.5</object-id>
        <label>FIG S5</label>
        <p>Visualization of the <italic toggle="yes">in-vitro</italic> validation experiment using human and mice gut samples. 12 samples were mixed each containing one or two contributing sources and 30% unknown contribution. Source proportions were estimated in the presence of 50 candidate sources. Estimated source proportions were colorized as being correctly attributed to true sources (Src), false-positive detection (FP), attributed correctly as unknown proportion (Unk), and overly attributed to a source despite being correct (Over). Download <inline-supplementary-material id="fS5" xlink:href="msystems.00995-21-s0005.tif" content-type="local-data">FIG S5, TIF file, 0.5 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2022 An et al.</copyright-statement>
          <copyright-year>2022</copyright-year>
          <copyright-holder>An et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2022-09-01"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <p><bold>Source selection in the Human Microbiome Project.</bold> To demonstrate the utility of STENSL when using large public repositories, we sought to assess the origins of a microbiome sample taken from a single individual found in the Human Microbiome Project (<xref rid="B9" ref-type="bibr">9</xref>). To construct the source selection problem, we defined the sink to be a saliva microbiome sample, which is one of several orally acquired samples including tongue, palate, and buccal mucosa. The candidate sources were then defined to be all the microbiome samples from the focal subject from which saliva was sampled (excluding saliva) as well as all other available microbial samples originating from 15 body sites across 88 individuals. In <xref rid="fig4" ref-type="fig">Fig. 4A</xref>, we outline results of applying both STENSL and SourceTracker2 to the same source tracking problem, with a substantially higher false positive rate attributed to the latter. Specifically, STENSL attributed a total of 43.1% to other oral microbiome samples belonging to the focal subject from which the sink was sampled (17.2% from buccal mucosa, 15.3% from tongue dorsum, and 10.6% from throat), while SourceTracker2 attributed only 4.9% to the other oral microbiome samples belonging to the focal subject from which the sink was sampled (3.6% from buccal mucosa, 0.6% from tongue dorsum, and 0.7% from throat). In addition, STENSL estimated an unknown contribution of 26% while estimating zero contribution for most noncontributing sources originating from other individuals. In contrast, SourceTracker2 assigned nonzero weights to the majority of sources from all other individuals (i.e., nuisance sources) and estimated a negligible unknown proportion (0.1%). We next performed a follow-up analysis, only considering samples from the focal individual (1 individual, 15 samples across body sites) and examined the results of this problem with no external individuals, a setting with little to no nuisance sources. Both methods estimated that the oral sites would contribute largely to the saliva (STENSL estimated 22.3% buccal mucosa, 22.1% tongue dorsum, and 20.5% throat; SourceTracker2 estimated 14.9% buccal mucosa, 12.0% tongue dorsum, and 9.1% throat), and an unknown proportion of approximately 20% (STENSL estimated 23.4% unknown, while SourceTracker2 estimated 23.7% unknown). These estimates agreed best with the results of STENSL in the full setting of 88 individuals and 997 samples. STENSL specifically highlighted tongue, buccal mucosa, and throat samples as the top contributors, which remained consistent when analyzing one subject or including the entire cohort. In addition to SourceTracker2, we also evaluated FEAST and RAD estimates on the HMP data, where we continued to observe little to no detection of the saliva samples and no identification of unknown presence (<xref rid="figS4" ref-type="supplementary-material">Fig. S4</xref>).</p>
      <fig position="float" id="fig4">
        <label>FIG 4</label>
        <caption>
          <p>A single microbial sample can be strongly attributed to its original subject in a database-wide analysis of the Human Microbiome Project using STENSL. STENSL is applied in analyzing a saliva sample from one human subject as a composition of any choice of 997 samples which were collected from other body sites from the same subject and from other human subjects. (A) Using STENSL, we identify several samples with high contributions which originate from the same human subject. (B) To verify the database-wide analysis, we compared it with the results of applying both methods to the set of 15 sources belonging to the original human subject and no additional candidate sources from other human subjects.</p>
        </caption>
        <graphic xlink:href="msystems.00995-21-f004" position="anchor"/>
      </fig>
      <supplementary-material position="float" id="figS4" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00995-21.4</object-id>
        <label>FIG S4</label>
        <p>Database-wide analysis of Human Microbiome Project using FEAST and RAD. We applied FEAST and RAD in estimating the contributors to a saliva sample in the Human Microbiome Project (HMP) given an array of candidate source samples originating from the individual and other individuals. Both FEAST and RAD estimated no unknown proportion (0%) which disagreed with initial findings using hand-selected samples from the individual as sources where unknown presence was estimated to be &gt; 10%. Using FEAST, the top contributing source was estimated as Buccal Mucosa which was correctly attributed to the original individual, but only 7.5% of the sink was attributed. RAD did not attribute any of the provided sources from the original individual to the sink, identifying 14.9% of another individual’s sample in the sink. Download <inline-supplementary-material id="fS4" xlink:href="msystems.00995-21-s0004.tif" content-type="local-data">FIG S4, TIF file, 0.5 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2022 An et al.</copyright-statement>
          <copyright-year>2022</copyright-year>
          <copyright-holder>An et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2022-09-01"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s3">
    <title>DISCUSSION</title>
    <p>In this work we present STENSL, an expectation-maximization algorithm with sparsity that enables the identification of contributing sources among a large set of potential source environments. With the unprecedented expansion of microbiome data repositories, such as the Earth Microbiome Project, recording over 200,000 samples from more than 50 types of categorized environments, STENSL takes the first steps in performing automated source exploration and selection. Using simulations, we found that STENSL is significantly more accurate in identifying the contributing sources as well as the unknown source, even when considering hundreds of candidate sources; settings in which state-of-the-art microbial source tracking methods add considerable error.</p>
    <p>The utility of STENSL is established using two real data sets. The first is an <italic toggle="yes">in vitro</italic> data set we generated, in which we mixed six microbial environments, samples from the gut of humans and mice, and generated over two dozen sink samples. As this data set provides the ground truth rather than a simulation, we validated, for the first time, the generative model of common microbial source tracking methods (i.e., a sink is a convex combination of known and unknown sources). Next, we demonstrated the added value of STENSL, by showing it is robust to the presence of nuisance sources (i.e., sources that didn’t contribute to the formation of the sink). The second data set is the Human Microbiome Project. In this analysis, we showed STENSL’s ability to accurately identify the latent contributing sources, even in the presence of hundreds of nuisance ones, while significantly reducing estimation error.</p>
    <p>Overall, using simulated and real sequencing data, we demonstrated that STENSL significantly improves the accuracy of microbial source tracking analysis over comparable methods by minimizing the contribution of nuisance sources and highlighting the actual contributing ones. By performing source selection that is robust to the presence of hundreds of nuisance sources, STENSL enables efficient source exploration using publicly available repositories thereby augmenting microbial source tracking analysis.</p>
  </sec>
  <sec id="s4">
    <title>MATERIALS AND METHODS</title>
    <sec id="s4-1">
      <title>The STENSL model.</title>
      <p>Consider a single sink sample represented by a vector <inline-formula id="ui3"><alternatives><inline-graphic xlink:href="msystems.00995-21-m017.jpg"/><mml:math id="u3" display="inline" overflow="scroll"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula> where <inline-formula id="ui4"><alternatives><inline-graphic xlink:href="msystems.00995-21-m018.jpg"/><mml:math id="u4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> corresponds to the abundance of taxa <inline-formula id="ui5"><alternatives><inline-graphic xlink:href="msystems.00995-21-m019.jpg"/><mml:math id="u5" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mo>  ≤  </mml:mo><mml:mi>j</mml:mi><mml:mo>  ≤  </mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. We define our model over M sources among which only a few sources may truly contribute to the sink, and therefore refer to them as candidates. Each source is represented by a vector <inline-formula id="ui6"><alternatives><inline-graphic xlink:href="msystems.00995-21-m020.jpg"/><mml:math id="u6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="ui7"><alternatives><inline-graphic xlink:href="msystems.00995-21-m021.jpg"/><mml:math id="u7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the observed abundance of taxa <inline-formula id="ui8"><alternatives><inline-graphic xlink:href="msystems.00995-21-m022.jpg"/><mml:math id="u8" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula> in source <inline-formula id="ui9"><alternatives><inline-graphic xlink:href="msystems.00995-21-m023.jpg"/><mml:math id="u9" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>  ≤  </mml:mo><mml:mi>i</mml:mi><mml:mo>  ≤  </mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Additionally, we assume there is an unobserved source (denoted as source <inline-formula id="ui10"><alternatives><inline-graphic xlink:href="msystems.00995-21-m024.jpg"/><mml:math id="u10" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo> + </mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>). Let <inline-formula id="ui11"><alternatives><inline-graphic xlink:href="msystems.00995-21-m025.jpg"/><mml:math id="u11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="italic">C</mml:mi><mml:mi mathvariant="italic">i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="italic">j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="italic">N</mml:mi></mml:munderover><mml:msub><mml:mi mathvariant="italic">y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="ui12"><alternatives><inline-graphic xlink:href="msystems.00995-21-m026.jpg"/><mml:math id="u12" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="italic">j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="italic">N</mml:mi></mml:munderover><mml:msub><mml:mi mathvariant="italic">X</mml:mi><mml:mi mathvariant="italic">j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> be the total taxa counts of the candidate sources and sink respectively. With this notation, the generative model is as follows: we assume that there are mixture proportions—a vector <inline-formula id="ui13"><alternatives><inline-graphic xlink:href="msystems.00995-21-m027.jpg"/><mml:math id="u13" display="inline" overflow="scroll"><mml:mrow><mml:mi>α</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> of length <inline-formula id="ui14"><alternatives><inline-graphic xlink:href="msystems.00995-21-m028.jpg"/><mml:math id="u14" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo> + </mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>—where <inline-formula id="ui15"><alternatives><inline-graphic xlink:href="msystems.00995-21-m029.jpg"/><mml:math id="u15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> corresponds to the fraction of source <italic toggle="yes">i</italic> in the sink, hence <inline-formula id="ui16"><alternatives><inline-graphic xlink:href="msystems.00995-21-m030.jpg"/><mml:math id="u16" display="inline" overflow="scroll"><mml:mrow><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Thus far, the proposed model is similar to previous methods of estimating microbial mixtures by modeling it as a convex combination of sources (<xref rid="B1" ref-type="bibr">1</xref>). However, this model is limited when the number of sources is very large. To address such scenarios, we introduce the assumption that the vector <inline-formula id="ui17"><alternatives><inline-graphic xlink:href="msystems.00995-21-m031.jpg"/><mml:math id="u17" display="inline" overflow="scroll"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula> is sparse. Formally, we assume that the fraction of each source <inline-formula id="ui18"><alternatives><inline-graphic xlink:href="msystems.00995-21-m032.jpg"/><mml:math id="u18" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> follows an exponential distribution with the hyperparameter <inline-formula id="ui19"><alternatives><inline-graphic xlink:href="msystems.00995-21-m033.jpg"/><mml:math id="u19" display="inline" overflow="scroll"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>. In keeping <inline-formula id="ui20"><alternatives><inline-graphic xlink:href="msystems.00995-21-m034.jpg"/><mml:math id="u20" display="inline" overflow="scroll"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula> a valid mixing proportion from 1…M + 1, we work with the constraints that <inline-formula id="ui21"><alternatives><inline-graphic xlink:href="msystems.00995-21-m035.jpg"/><mml:math id="u21" display="inline" overflow="scroll"><mml:mrow><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>  ≤  </mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. The hyperparameter <inline-formula id="ui22"><alternatives><inline-graphic xlink:href="msystems.00995-21-m036.jpg"/><mml:math id="u22" display="inline" overflow="scroll"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula> represents the level of sparsity in the contribution from the observed sources in our model. We also assume that the underlying relative abundance for each of the sources is unobserved, and that <inline-formula id="ui23"><alternatives><inline-graphic xlink:href="msystems.00995-21-m037.jpg"/><mml:math id="u23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are noisy realizations of these relative abundances. Formally, for each source <inline-formula id="ui24"><alternatives><inline-graphic xlink:href="msystems.00995-21-m038.jpg"/><mml:math id="u24" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>, we have a vector <inline-formula id="ui25"><alternatives><inline-graphic xlink:href="msystems.00995-21-m039.jpg"/><mml:math id="u25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="ui26"><alternatives><inline-graphic xlink:href="msystems.00995-21-m040.jpg"/><mml:math id="u26" display="inline" overflow="scroll"><mml:mrow><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi mathvariant="italic">j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="italic">N</mml:mi></mml:munderover><mml:msub><mml:mi mathvariant="italic">γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Each <inline-formula id="ui27"><alternatives><inline-graphic xlink:href="msystems.00995-21-m041.jpg"/><mml:math id="u27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> represents the true relative abundance of taxa <inline-formula id="ui28"><alternatives><inline-graphic xlink:href="msystems.00995-21-m042.jpg"/><mml:math id="u28" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula> in source <inline-formula id="ui29"><alternatives><inline-graphic xlink:href="msystems.00995-21-m043.jpg"/><mml:math id="u29" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>. Thus, the complete generative model for STENSL is given by:
<disp-formula id="uFD1"><alternatives><graphic xlink:href="msystems.00995-21-m001.jpg" position="float"/><mml:math id="um1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>  =</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="uFD2"><alternatives><graphic xlink:href="msystems.00995-21-m002.jpg" position="float"/><mml:math id="um2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>  ~  </mml:mo><mml:mi mathvariant="italic">Multinomial </mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">iN</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="uFD3"><alternatives><graphic xlink:href="msystems.00995-21-m003.jpg" position="float"/><mml:math id="um3" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>  ~  </mml:mo><mml:mi mathvariant="italic">Multinomial </mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="uFD4"><alternatives><graphic xlink:href="msystems.00995-21-m004.jpg" position="float"/><mml:math id="um4" display="block" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>  ~  </mml:mo><mml:mi mathvariant="italic">Multinomial </mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="uFD5"><alternatives><graphic xlink:href="msystems.00995-21-m005.jpg" position="float"/><mml:math id="um5" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>  ~  </mml:mo><mml:mi mathvariant="italic">Exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy="true">{</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo> ≤ </mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>We use an indicator function <inline-formula id="ui30"><alternatives><inline-graphic xlink:href="msystems.00995-21-m044.jpg"/><mml:math id="u30" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="true">{</mml:mo><mml:munderover><mml:mstyle mathsize="80%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>  ≤  </mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> which is 1 when the condition parameter is true and 0 otherwise, such that we constrain the exponential distribution in a valid range. As we do not observe <inline-formula id="ui31"><alternatives><inline-graphic xlink:href="msystems.00995-21-m045.jpg"/><mml:math id="u31" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, we use a data-driven plug-in estimate <inline-formula id="ui32"><alternatives><inline-graphic xlink:href="msystems.00995-21-m046.jpg"/><mml:math id="u32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> as described below.</p>
    </sec>
    <sec id="s4-2">
      <title>Inference of STENSL parameters.</title>
      <p>Under the STENSL model, we need to estimate the parameters <inline-formula id="ui33"><alternatives><inline-graphic xlink:href="msystems.00995-21-m047.jpg"/><mml:math id="u33" display="inline" overflow="scroll"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Given the observed taxa counts in the candidate sources and sink, several inference algorithms could be used to estimate the parameters. For a fixed <inline-formula id="ui34"><alternatives><inline-graphic xlink:href="msystems.00995-21-m048.jpg"/><mml:math id="u34" display="inline" overflow="scroll"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>, we use expectation-maximization to infer parameters <inline-formula id="ui35"><alternatives><inline-graphic xlink:href="msystems.00995-21-m049.jpg"/><mml:math id="u35" display="inline" overflow="scroll"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="ui36"><alternatives><inline-graphic xlink:href="msystems.00995-21-m050.jpg"/><mml:math id="u36" display="inline" overflow="scroll"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula>. We further introduce an initialization procedure according to the sparse model, as the initialization of the expectation-maximization (EM) algorithm (which attempts to optimize a nonconvex problem) is critical to the accuracy of the final estimates. For hyperparameter <inline-formula id="ui37"><alternatives><inline-graphic xlink:href="msystems.00995-21-m051.jpg"/><mml:math id="u37" display="inline" overflow="scroll"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>, we describe a grid-search algorithm to perform EM across a range of values, returning the set of parameters which obtains the highest likelihood as given by the generative model. The likelihood of the model is:
<disp-formula id="uFD6"><alternatives><graphic xlink:href="msystems.00995-21-m006.jpg" position="float"/><mml:math id="um6" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>C</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo><mml:mtext> </mml:mtext><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mo stretchy="true">[</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">)</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="true">]</mml:mo><mml:mtext> </mml:mtext><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mi>λ</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mn>1</mml:mn><mml:mo stretchy="true">{</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo> ≤ </mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>The following log likelihood is defined under the constraint that <inline-formula id="ui38"><alternatives><inline-graphic xlink:href="msystems.00995-21-m052.jpg"/><mml:math id="u38" display="inline" overflow="scroll"><mml:mrow><mml:munderover><mml:mstyle mathsize="80%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>  ≤  </mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>:
<disp-formula id="uFD7"><alternatives><graphic xlink:href="msystems.00995-21-m007.jpg" position="float"/><mml:math id="um7" display="block" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="italic">logP</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi mathvariant="italic">log</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi mathvariant="italic">log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mi>λ</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="italic">Mlog</mml:mi><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">const</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Given λ which is assumed to be fixed in one instance of the EM algorithm, we obtain the expected complete log likelihood (Q) in terms of α and γ; we also introduce α<sup>(<italic toggle="yes">t</italic>)</sup> and γ<sup>(<italic toggle="yes">t</italic>)</sup> which are the parameters estimated in the previous iteration of the EM.
<disp-formula id="uFD8"><alternatives><graphic xlink:href="msystems.00995-21-m008.jpg" position="float"/><mml:math id="um8" display="block" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>γ </mml:mi><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>γ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="italic">logP</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mo stretchy="false">|</mml:mo><mml:mtext> </mml:mtext><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="italic">log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi mathvariant="italic">log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="italic">Mlog</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>where 
<disp-formula id="uFD98"><alternatives><graphic xlink:href="msystems.00995-21-m009.jpg" position="float"/><mml:math id="um85" display="block" overflow="scroll"><mml:mrow><mml:mtext>p</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mtext>i </mml:mtext><mml:mo>|</mml:mo><mml:mtext> j</mml:mtext></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>To complete the EM, we then maximize the E[LL] with respect to the parameters <inline-formula id="ui39"><alternatives><inline-graphic xlink:href="msystems.00995-21-m053.jpg"/><mml:math id="u39" display="inline" overflow="scroll"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="ui40"><alternatives><inline-graphic xlink:href="msystems.00995-21-m054.jpg"/><mml:math id="u40" display="inline" overflow="scroll"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula>. We derive the maximization objective for <inline-formula id="ui41"><alternatives><inline-graphic xlink:href="msystems.00995-21-m055.jpg"/><mml:math id="u41" display="inline" overflow="scroll"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula>, for which <inline-formula id="ui42"><alternatives><inline-graphic xlink:href="msystems.00995-21-m056.jpg"/><mml:math id="u42" display="inline" overflow="scroll"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula> appears as a sparsity hyperparameter and p(i | j) was obtained in the expectation step.
<disp-formula id="uFD9"><alternatives><graphic xlink:href="msystems.00995-21-m010.jpg" position="float"/><mml:math id="um9" display="block" overflow="scroll"><mml:mrow><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="italic">argma</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mo>|</mml:mo><mml:mtext> </mml:mtext><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mi mathvariant="italic">log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:mtext> </mml:mtext><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></disp-formula>s.t. 
<disp-formula id="uFD99"><alternatives><graphic xlink:href="msystems.00995-21-m011.jpg" position="float"/><mml:math id="um86" display="block" overflow="scroll"><mml:mrow><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo> ≤ </mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>α</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>Maximization for <inline-formula id="ui43"><alternatives><inline-graphic xlink:href="msystems.00995-21-m057.jpg"/><mml:math id="u43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>:
<disp-formula id="uFD10"><alternatives><graphic xlink:href="msystems.00995-21-m012.jpg" position="float"/><mml:math id="um10" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mo>|</mml:mo><mml:mtext> </mml:mtext><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mtext> </mml:mtext><mml:mo>|</mml:mo><mml:mtext> </mml:mtext><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>In summary, STENSL obtains the locally best solution for <inline-formula id="ui44"><alternatives><inline-graphic xlink:href="msystems.00995-21-m058.jpg"/><mml:math id="u44" display="inline" overflow="scroll"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula> and <inline-formula id="ui45"><alternatives><inline-graphic xlink:href="msystems.00995-21-m059.jpg"/><mml:math id="u45" display="inline" overflow="scroll"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula> for given hyperparameter <inline-formula id="ui90"><alternatives><inline-graphic xlink:href="msystems.00995-21-m060.jpg"/><mml:math id="u90" display="inline" overflow="scroll"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>. We then test for increasing values of <inline-formula id="ui91"><alternatives><inline-graphic xlink:href="msystems.00995-21-m061.jpg"/><mml:math id="u91" display="inline" overflow="scroll"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>, the solution which reaches the highest likelihood under the model. The following pseudocode describes the steps of the STENSL algorithm.</p>
      <p>STENSL Algorithm</p>
      <p>
        <preformat position="float" xml:space="preserve">Inputs: <inline-formula id="ui46-1"><alternatives><inline-graphic xlink:href="msystems.00995-21-m062.jpg"/><mml:math id="u46-1" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> (initializations) and <inline-formula id="ui47-1"><alternatives><inline-graphic xlink:href="msystems.00995-21-m063.jpg"/><mml:math id="u47-1" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>…</mml:mo><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></preformat>
      </p>
      <p>
        <preformat position="float" xml:space="preserve">Outputs: <inline-formula id="ui48"><alternatives><inline-graphic xlink:href="msystems.00995-21-m064.jpg"/><mml:math id="u48" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></preformat>
      </p>
      <p>
        <preformat position="float" xml:space="preserve">Repeat steps below for <inline-formula id="ui49"><alternatives><inline-graphic xlink:href="msystems.00995-21-m065.jpg"/><mml:math id="u49" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mo> </mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></preformat>
      </p>
      <p>
        <preformat position="float" xml:space="preserve">1. Initialize the EM problem with <inline-formula id="ui50"><alternatives><inline-graphic xlink:href="msystems.00995-21-m066.jpg"/><mml:math id="u50" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>γ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Fix <inline-formula id="ui51"><alternatives><inline-graphic xlink:href="msystems.00995-21-m067.jpg"/><mml:math id="u51" display="inline" overflow="scroll"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> as the given value for this problem</preformat>
      </p>
      <p>
        <preformat position="float" xml:space="preserve">2. Perform EM to infer <inline-formula id="ui52"><alternatives><inline-graphic xlink:href="msystems.00995-21-m068.jpg"/><mml:math id="u52" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="ui53"><alternatives><inline-graphic xlink:href="msystems.00995-21-m069.jpg"/><mml:math id="u53" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></preformat>
      </p>
      <p>
        <preformat position="float" xml:space="preserve">3. <inline-formula id="ui54"><alternatives><inline-graphic xlink:href="msystems.00995-21-m070.jpg"/><mml:math id="u54" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the final likelihood obtained for the k-th problem</preformat>
      </p>
      <p>
        <preformat position="float" xml:space="preserve">From <inline-formula id="ui55"><alternatives><inline-graphic xlink:href="msystems.00995-21-m071.jpg"/><mml:math id="u55" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, return <inline-formula id="ui56"><alternatives><inline-graphic xlink:href="msystems.00995-21-m072.jpg"/><mml:math id="u56" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, which obtained the highest likelihood</preformat>
      </p>
      <p><bold>Source selection.</bold> STENSL assumes that only a sparse subset of the candidate sources contributes to the formation of the sink. To obtain a sparse selection of sources, we define a heuristic approach to infer the mixing proportions <inline-formula id="ui57"><alternatives><inline-graphic xlink:href="msystems.00995-21-m073.jpg"/><mml:math id="u57" display="inline" overflow="scroll"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula> under a sparsity assumption. In practice, inferring the latent taxa variables depend heavily on the observed taxa counts and motivates a heuristic that uses the observed counts directly to obtain an approximation of the hidden variables, with an added benefit that the approximation leads to an optimization problem that can be efficiently solved for large numbers of sources. A convenient choice for the initial values of <inline-formula id="ui58"><alternatives><inline-graphic xlink:href="msystems.00995-21-m074.jpg"/><mml:math id="u58" display="inline" overflow="scroll"><mml:mi>γ</mml:mi></mml:math></alternatives></inline-formula> are the observations <inline-formula id="ui59"><alternatives><inline-graphic xlink:href="msystems.00995-21-m075.jpg"/><mml:math id="u59" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and we find that the observations are a sufficient proxy of <inline-formula id="ui60"><alternatives><inline-graphic xlink:href="msystems.00995-21-m076.jpg"/><mml:math id="u60" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> in approximating <inline-formula id="ui61"><alternatives><inline-graphic xlink:href="msystems.00995-21-m077.jpg"/><mml:math id="u61" display="inline" overflow="scroll"><mml:mtext>α</mml:mtext></mml:math></alternatives></inline-formula>. We next perform inference by formulating a least-squares problem between x and <inline-formula id="ui62"><alternatives><inline-graphic xlink:href="msystems.00995-21-m078.jpg"/><mml:math id="u62" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>α</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> while ensuring that <inline-formula id="ui63"><alternatives><inline-graphic xlink:href="msystems.00995-21-m079.jpg"/><mml:math id="u63" display="inline" overflow="scroll"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula> is sparsely approximated by L1 regularization. We specifically choose the L1 regularization (Lasso), which follows this formulation, with added constraints that each proportion must be nonnegative and <inline-formula id="ui64"><alternatives><inline-graphic xlink:href="msystems.00995-21-m080.jpg"/><mml:math id="u64" display="inline" overflow="scroll"><mml:mrow><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo> ≤ </mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. In leveraging Lasso, we assume the presence of underlying noise which is normally distributed when forming the sink. We leverage this underlying noise to estimate the abundance profile of the unknown source. We therefore seek to optimize the following objective function, where we determine an optimal value for hyperparameter <inline-formula id="ui65"><alternatives><inline-graphic xlink:href="msystems.00995-21-m081.jpg"/><mml:math id="u65" display="inline" overflow="scroll"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula> through cross-validation (<xref rid="figS3" ref-type="supplementary-material">Fig. S3</xref>):
<disp-formula id="uFD11"><alternatives><graphic xlink:href="msystems.00995-21-m013.jpg" position="float"/><mml:math id="um11" display="block" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mi mathvariant="italic">argmin</mml:mi><mml:mtext> </mml:mtext><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>Y</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>X</mml:mi><mml:mtext> </mml:mtext><mml:mo>|</mml:mo><mml:msubsup><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mtext> </mml:mtext><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mtext> </mml:mtext><mml:mi>α</mml:mi><mml:mtext> </mml:mtext><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="uFD12"><alternatives><graphic xlink:href="msystems.00995-21-m014.jpg" position="float"/><mml:math id="um12" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">subject</mml:mi><mml:mtext> </mml:mtext><mml:mi mathvariant="italic">to</mml:mi><mml:mtext> </mml:mtext><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo> ≤ </mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo> ≥ </mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></disp-formula></p>
      <supplementary-material position="float" id="figS3" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00995-21.3</object-id>
        <label>FIG S3</label>
        <p>Cross-validation to determine λ. STENSL utilizes Lasso as part of the selection step, in which hyperparameter <bold>λ</bold> of the sparsity regularization must be determined. We use cross-validation on a simulated dataset of sinks (and their corresponding sources) to find an optimal <bold>λ</bold> for microbial data based on prediction errors <inline-formula id="ui66"><alternatives><inline-graphic xlink:href="msystems.00995-21-m082.jpg"/><mml:math id="u66" display="inline" overflow="scroll"><mml:mrow><mml:mi>ϵ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>X</mml:mtext><mml:mo>−</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The dataset is split in half for sinks which will be analyzed as part of training to tune the hyperparameter, and we evaluate Lasso on the reserved test set. In the validation plot, we show the average of the errors <inline-formula id="ui67"><alternatives><inline-graphic xlink:href="msystems.00995-21-m083.jpg"/><mml:math id="u67" display="inline" overflow="scroll"><mml:mi>ϵ</mml:mi></mml:math></alternatives></inline-formula> for each <bold>λ</bold> and find that choosing a value &lt; 1 × 10<sup>−4</sup> would be optimal. In our experiments, we chose λ = 1 × 10<sup>−6</sup>. Download <inline-supplementary-material id="fS3" xlink:href="msystems.00995-21-s0003.tif" content-type="local-data">FIG S3, TIF file, 0.1 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2022 An et al.</copyright-statement>
          <copyright-year>2022</copyright-year>
          <copyright-holder>An et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2022-09-01"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <p>The objective describes a least-squares problem which is solvable as a quadratic program with the stated constraints. From the initial sparse approximation of <inline-formula id="ui68"><alternatives><inline-graphic xlink:href="msystems.00995-21-m084.jpg"/><mml:math id="u68" display="inline" overflow="scroll"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula>, we consider candidate source <italic toggle="yes">i</italic>, for which contribution is positive <inline-formula id="ui69"><alternatives><inline-graphic xlink:href="msystems.00995-21-m085.jpg"/><mml:math id="u69" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, to be highly likely to be contributing to the sink. We use the sparsely estimated proportions <inline-formula id="ui70"><alternatives><inline-graphic xlink:href="msystems.00995-21-m086.jpg"/><mml:math id="u70" display="inline" overflow="scroll"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula> as initialization values, denoted as <inline-formula id="ui71"><alternatives><inline-graphic xlink:href="msystems.00995-21-m087.jpg"/><mml:math id="u71" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, in proceeding with expectation-maximization according to our model.</p>
      <p><bold>Unknown source initialization.</bold> In obtaining an initial estimate of the unknown abundances counts <inline-formula id="ui72"><alternatives><inline-graphic xlink:href="msystems.00995-21-m088.jpg"/><mml:math id="u72" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, we assume that its underlying relative abundance follows a truncated normal distribution similar to the nonnegative components of the estimation noise resulting from the selection step. In practice, to remove the prominent signal stemming from the true known sources, we subtract the scaled counts of the top contributing source, ranked based on the L-1 regularization and thus, <inline-formula id="ui73"><alternatives><inline-graphic xlink:href="msystems.00995-21-m089.jpg"/><mml:math id="u73" display="inline" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">argma</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow/></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>.</p>
    </sec>
    <sec id="s4-3">
      <title>Metrics.</title>
      <p>We measured the accuracy of the estimated source contributions in terms of overall error with respect to the ground truth, the identification of, specifically, the unknown proportion, and the proportion of falsely identified contributions which we termed “false positive rate.” Overall error of the mixing proportion estimated for M sources <inline-formula id="ui75"><alternatives><inline-graphic xlink:href="msystems.00995-21-m090.jpg"/><mml:math id="u75" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> was measured against the simulated or ground truth proportions <inline-formula id="ui76"><alternatives><inline-graphic xlink:href="msystems.00995-21-m091.jpg"/><mml:math id="u76" display="inline" overflow="scroll"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula> using mean-squared error <inline-formula id="ui77"><alternatives><inline-graphic xlink:href="msystems.00995-21-m092.jpg"/><mml:math id="u77" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">MSE</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. In evaluating the unknown proportion identified in the sink, we used absolute error <inline-formula id="ui78"><alternatives><inline-graphic xlink:href="msystems.00995-21-m093.jpg"/><mml:math id="u78" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">AE</mml:mi><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo>|</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>|</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. The false-positive rate referring to positive proportions incorrectly attributed to known noncontributing sources was calculated as the sum of such proportions, <inline-formula id="ui79"><alternatives><inline-graphic xlink:href="msystems.00995-21-m094.jpg"/><mml:math id="u79" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">FPR</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
    </sec>
    <sec id="s4-4">
      <title>Simulation procedure.</title>
      <p>To examine the accuracy of STENSL, we used multiple source environments with varying degrees of overlap in their distribution by randomly sampling from the Earth Microbiome Project. Each source environment was subsampled to contain 10,000 reads. In each iteration of the simulation, we sampled M + 1 candidate environments and used them to build a synthetic sink with different mixing proportions. To simulate an unknown source as well as sparsity in source contribution, only K source environments were designated as contributing sources. We used 30 mixing proportions (corresponding to 30 simulated sinks) and K = 10 contributing sources in each iteration with M = 50. We drew the mixing vector of length K from a Pareto distribution, which was scaled to sum to 1 for mixtures with no unknown. To simulate sinks with unknown presence, an unknown proportion of up to 90% was introduced by scaling the drawn vector to <inline-formula id="ui80"><alternatives><inline-graphic xlink:href="msystems.00995-21-m095.jpg"/><mml:math id="u80" display="inline" overflow="scroll"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, then appending the unknown proportion. Finally, the sink was generated under the model as a linear combination of the K contributing sources and the unknown source. For a detailed description of the simulation, see Supplementary Material.</p>
    </sec>
    <sec id="s4-5">
      <title><italic toggle="yes">In vitro</italic> data generation.</title>
      <p>To evaluate the performance of STENSL and validate the mixture model assumed by common microbial source tracking methods, we generated <italic toggle="yes">in vitro</italic> data, using the generative model described above following a 16S amplification protocol from Tong et al. (<xref rid="B10" ref-type="bibr">10</xref>). The contributing sources were taken from the digestive systems of three human subjects and three mice. Two of the human subjects were documented with a pre-Ketogenic diet and the third was sampled from the Human Altitude Study. Using these sources, we assembled 27 <italic toggle="yes">in vitro</italic> sinks, each sink composed of two to three microbial samples at varying mixing proportions (ranging from 20%–80%). For a detailed description of the assembly process and protocols used, see Supplementary Material. To assess the performance of microbial source tracking methods in the presence of noncontributing sources, we next generated 50 additional synthetic sources by shuffling the abundances of the six contributing sources described above. The number of taxa expressed in each synthetic source <inline-formula id="ui81"><alternatives><inline-graphic xlink:href="msystems.00995-21-m096.jpg"/><mml:math id="u81" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>; <inline-formula id="ui82"><alternatives><inline-graphic xlink:href="msystems.00995-21-m097.jpg"/><mml:math id="u82" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo> ≤ </mml:mo><mml:mi>i</mml:mi><mml:mo> ≤ </mml:mo><mml:mn>50</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> was determined following a uniform distribution <inline-formula id="ui83"><alternatives><inline-graphic xlink:href="msystems.00995-21-m098.jpg"/><mml:math id="u83" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>~</mml:mo><mml:mi mathvariant="italic">Unif</mml:mi><mml:mo>[</mml:mo><mml:mi mathvariant="italic">min</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">rea</mml:mi><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">rea</mml:mi><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="italic">max</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">rea</mml:mi><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">rea</mml:mi><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>]</mml:mo></mml:math></alternatives></inline-formula>, where <inline-formula id="ui84"><alternatives><inline-graphic xlink:href="msystems.00995-21-m099.jpg"/><mml:math id="u84" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">rea</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mtext> </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo> ≤ </mml:mo><mml:mi>j</mml:mi><mml:mo> ≤ </mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the number of taxa in the six contributing sources described above. Then, for each taxon-j, we randomly drew, without replacement, a count which was observed among all nonzero taxa.</p>
    </sec>
    <sec id="s4-6">
      <title>Data availability.</title>
      <p>The code for STENSL is a branch of the FEAST codebase, which can be found on <ext-link xlink:href="https://github.com/cozygene/FEAST/tree/STENSL" ext-link-type="uri">https://github.com/cozygene/FEAST/tree/STENSL</ext-link>. We also created a short tutorial of STENSL that can be found on <ext-link xlink:href="https://github.com/cozygene/FEAST/blob/STENSL/vignettes/STENSL_example.R" ext-link-type="uri">https://github.com/cozygene/FEAST/blob/STENSL/vignettes/STENSL_example.R</ext-link>.</p>
      <supplementary-material position="float" id="textS1" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00995-21.8</object-id>
        <label>TEXT S1</label>
        <p>Description of the in-silico simulations. Download <inline-supplementary-material id="txS1" xlink:href="msystems.00995-21-s0008.docx" content-type="local-data">Text S1, DOCX file, 0.01 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2022 An et al.</copyright-statement>
          <copyright-year>2022</copyright-year>
          <copyright-holder>An et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2022-09-01"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <supplementary-material position="float" id="textS2" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00995-21.9</object-id>
        <label>TEXT S2</label>
        <p>Description of in-vitro data generation. Download <inline-supplementary-material id="txS2" xlink:href="msystems.00995-21-s0009.docx" content-type="local-data">Text S2, DOCX file, 0.01 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2022 An et al.</copyright-statement>
          <copyright-year>2022</copyright-year>
          <copyright-holder>An et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2022-09-01"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <supplementary-material position="float" id="textS3" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00995-21.10</object-id>
        <label>TEXT S3</label>
        <p>Description of Earth Microbiome Project experiments. Download <inline-supplementary-material id="txS3" xlink:href="msystems.00995-21-s0010.docx" content-type="local-data">Text S3, DOCX file, 0.01 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2022 An et al.</copyright-statement>
          <copyright-year>2022</copyright-year>
          <copyright-holder>An et al.</copyright-holder>
          <ali:free_to_read xmlns:ali="http://www.niso.org/schemas/ali/1.0/" start_date="2022-09-01"/>
          <license license-type="open-access">
            <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="version-of-record">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGMENTS</title>
    <p>Sriram Sankararaman was supported in part by NIH grants R35GM125055 and NSF grants III-1705121. Liat Shenhav was supported on NSF 1705197. Ulzee An was supported on NIH 5R35GM125055 and NIH 1R01HG011345. Eran Halperin was partially supported by NIH/NHGRI HG010505-02.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shenhav</surname><given-names>L</given-names></string-name>, <string-name><surname>Thompson</surname><given-names>M</given-names></string-name>, <string-name><surname>Joseph</surname><given-names>TA</given-names></string-name>, <string-name><surname>Briscoe</surname><given-names>L</given-names></string-name>, <string-name><surname>Furman</surname><given-names>O</given-names></string-name>, <string-name><surname>Bogumil</surname><given-names>D</given-names></string-name>, <string-name><surname>Mizrahi</surname><given-names>I</given-names></string-name>, <string-name><surname>Pe'er</surname><given-names>I</given-names></string-name>, <string-name><surname>Halperin</surname><given-names>E</given-names></string-name></person-group>. <year>2019</year>. <article-title>FEAST: fast expectation-maximization for microbial source tracking</article-title>. <source>Nat Methods</source><volume>16</volume>:<fpage>627</fpage>–<lpage>632</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41592-019-0431-x</pub-id>.<pub-id pub-id-type="pmid">31182859</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Knights</surname><given-names>D</given-names></string-name>, <string-name><surname>Kuczynski</surname><given-names>J</given-names></string-name>, <string-name><surname>Charlson</surname><given-names>ES</given-names></string-name>, <string-name><surname>Zaneveld</surname><given-names>J</given-names></string-name>, <string-name><surname>Mozer</surname><given-names>MC</given-names></string-name>, <string-name><surname>Collman</surname><given-names>RG</given-names></string-name>, <string-name><surname>Bushman</surname><given-names>FD</given-names></string-name>, <string-name><surname>Knight</surname><given-names>R</given-names></string-name>, <string-name><surname>Kelley</surname><given-names>ST</given-names></string-name></person-group>. <year>2011</year>. <article-title>Bayesian community-wide culture-independent microbial source tracking</article-title>. <source>Nat Methods</source><volume>8</volume>:<fpage>761</fpage>–<lpage>763</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.1650</pub-id>.<pub-id pub-id-type="pmid">21765408</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>CH</given-names></string-name>, <string-name><surname>Sercu</surname><given-names>B</given-names></string-name>, <string-name><surname>Van de Werfhorst</surname><given-names>LC</given-names></string-name>, <string-name><surname>Wong</surname><given-names>J</given-names></string-name>, <string-name><surname>DeSantis</surname><given-names>TZ</given-names></string-name>, <string-name><surname>Brodie</surname><given-names>EL</given-names></string-name>, <string-name><surname>Hazen</surname><given-names>TC</given-names></string-name>, <string-name><surname>Holden</surname><given-names>PA</given-names></string-name>, <string-name><surname>Andersen</surname><given-names>GL</given-names></string-name></person-group>. <year>2010</year>. <article-title>Characterization of coastal urban watershed bacterial communities leads to alternative community-based indicators</article-title>. <source>PLoS One</source><volume>5</volume>:<elocation-id>e11285</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0011285</pub-id>.<pub-id pub-id-type="pmid">20585654</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lax</surname><given-names>S</given-names></string-name>, <string-name><surname>Smith</surname><given-names>DP</given-names></string-name>, <string-name><surname>Hampton-Marcell</surname><given-names>J</given-names></string-name>, <string-name><surname>Owens</surname><given-names>SM</given-names></string-name>, <string-name><surname>Handley</surname><given-names>KM</given-names></string-name>, <string-name><surname>Scott</surname><given-names>NM</given-names></string-name>, <string-name><surname>Gibbons</surname><given-names>SM</given-names></string-name>, <string-name><surname>Larsen</surname><given-names>P</given-names></string-name>, <string-name><surname>Shogan</surname><given-names>BD</given-names></string-name>, <string-name><surname>Weiss</surname><given-names>S</given-names></string-name>, <string-name><surname>Metcalf</surname><given-names>JL</given-names></string-name>, <string-name><surname>Ursell</surname><given-names>LK</given-names></string-name>, <string-name><surname>Vázquez-Baeza</surname><given-names>Y</given-names></string-name>, <string-name><surname>Van Treuren</surname><given-names>W</given-names></string-name>, <string-name><surname>Hasan</surname><given-names>NA</given-names></string-name>, <string-name><surname>Gibson</surname><given-names>MK</given-names></string-name>, <string-name><surname>Colwell</surname><given-names>R</given-names></string-name>, <string-name><surname>Dantas</surname><given-names>G</given-names></string-name>, <string-name><surname>Knight</surname><given-names>R</given-names></string-name>, <string-name><surname>Gilbert</surname><given-names>JA</given-names></string-name></person-group>. <year>2014</year>. <article-title>Longitudinal analysis of microbial interaction between humans and the indoor environment</article-title>. <source>Science</source><volume>345</volume>:<fpage>1048</fpage>–<lpage>1052</lpage>. doi:<pub-id pub-id-type="doi">10.1126/science.1254529</pub-id>.<pub-id pub-id-type="pmid">25170151</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dominguez-Bello</surname><given-names>MG</given-names></string-name>, <string-name><surname>De Jesus-Laboy</surname><given-names>KM</given-names></string-name>, <string-name><surname>Shen</surname><given-names>N</given-names></string-name>, <string-name><surname>Cox</surname><given-names>LM</given-names></string-name>, <string-name><surname>Amir</surname><given-names>A</given-names></string-name>, <string-name><surname>Gonzalez</surname><given-names>A</given-names></string-name>, <string-name><surname>Bokulich</surname><given-names>NA</given-names></string-name>, <string-name><surname>Song</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Hoashi</surname><given-names>M</given-names></string-name>, <string-name><surname>Rivera-Vinas</surname><given-names>JI</given-names></string-name>, <string-name><surname>Mendez</surname><given-names>K</given-names></string-name>, <string-name><surname>Knight</surname><given-names>R</given-names></string-name>, <string-name><surname>Clemente</surname><given-names>JC</given-names></string-name></person-group>. <year>2016</year>. <article-title>Partial restoration of the microbiota of cesarean-born infants via vaginal microbial transfer</article-title>. <source>Nat Med</source><volume>22</volume>:<fpage>250</fpage>–<lpage>253</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nm.4039</pub-id>.<pub-id pub-id-type="pmid">26828196</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Teaf</surname><given-names>CM</given-names></string-name>, <string-name><surname>Flores</surname><given-names>D</given-names></string-name>, <string-name><surname>Garber</surname><given-names>M</given-names></string-name>, <string-name><surname>Harwood</surname><given-names>VJ</given-names></string-name></person-group>. <year>2018</year>. <article-title>Toward forensic uses of microbial source tracking</article-title>. <source>Microbiol Spectr</source><volume>6</volume>. doi:<pub-id pub-id-type="doi">10.1128/microbiolspec.EMF-0014-2017</pub-id>.</mixed-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carter</surname><given-names>KM</given-names></string-name>, <string-name><surname>Lu</surname><given-names>M</given-names></string-name>, <string-name><surname>Luo</surname><given-names>Q</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>H</given-names></string-name>, <string-name><surname>An</surname><given-names>L</given-names></string-name></person-group>. <year>2020</year>. <article-title>Microbial community dissimilarity for source tracking with application in forensic studies</article-title>. <source>PLoS One</source><volume>15</volume>:<elocation-id>e0236082</elocation-id>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0236082</pub-id>.<pub-id pub-id-type="pmid">32702000</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thompson</surname><given-names>LR</given-names></string-name>, <string-name><surname>Sanders</surname><given-names>JG</given-names></string-name>, <string-name><surname>McDonald</surname><given-names>D</given-names></string-name>, <string-name><surname>Amir</surname><given-names>A</given-names></string-name>, <string-name><surname>Ladau</surname><given-names>J</given-names></string-name>, <string-name><surname>Locey</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Prill</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Tripathi</surname><given-names>A</given-names></string-name>, <string-name><surname>Gibbons</surname><given-names>SM</given-names></string-name>, <string-name><surname>Ackermann</surname><given-names>G</given-names></string-name>, <string-name><surname>Navas-Molina</surname><given-names>JA</given-names></string-name>, <string-name><surname>Janssen</surname><given-names>S</given-names></string-name>, <string-name><surname>Kopylova</surname><given-names>E</given-names></string-name>, <string-name><surname>Vázquez-Baeza</surname><given-names>Y</given-names></string-name>, <string-name><surname>González</surname><given-names>A</given-names></string-name>, <string-name><surname>Morton</surname><given-names>JT</given-names></string-name>, <string-name><surname>Mirarab</surname><given-names>S</given-names></string-name>, <string-name><surname>Zech Xu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>L</given-names></string-name>, <string-name><surname>Haroon</surname><given-names>MF</given-names></string-name>, <string-name><surname>Kanbar</surname><given-names>J</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Jin Song</surname><given-names>S</given-names></string-name>, <string-name><surname>Kosciolek</surname><given-names>T</given-names></string-name>, <string-name><surname>Bokulich</surname><given-names>NA</given-names></string-name>, <string-name><surname>Lefler</surname><given-names>J</given-names></string-name>, <string-name><surname>Brislawn</surname><given-names>CJ</given-names></string-name>, <string-name><surname>Humphrey</surname><given-names>G</given-names></string-name>, <string-name><surname>Owens</surname><given-names>SM</given-names></string-name>, <string-name><surname>Hampton-Marcell</surname><given-names>J</given-names></string-name>, <string-name><surname>Berg-Lyons</surname><given-names>D</given-names></string-name>, <string-name><surname>McKenzie</surname><given-names>V</given-names></string-name>, <string-name><surname>Fierer</surname><given-names>N</given-names></string-name>, <string-name><surname>Fuhrman</surname><given-names>JA</given-names></string-name>, <string-name><surname>Clauset</surname><given-names>A</given-names></string-name>, <string-name><surname>Stevens</surname><given-names>RL</given-names></string-name>, <string-name><surname>Shade</surname><given-names>A</given-names></string-name>, <string-name><surname>Pollard</surname><given-names>KS</given-names></string-name>, <string-name><surname>Goodwin</surname><given-names>KD</given-names></string-name>, <string-name><surname>Jansson</surname><given-names>JK</given-names></string-name>, <string-name><surname>Gilbert</surname><given-names>JA</given-names></string-name>, <string-name><surname>Knight</surname><given-names>R</given-names></string-name></person-group>, <collab>Earth Microbiome Project Consortium</collab>. <year>2017</year>. <article-title>A communal catalogue reveals Earth’s multiscale microbial diversity</article-title>. <source>Nature</source><volume>551</volume>:<fpage>457</fpage>–<lpage>463</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nature24621</pub-id>.<pub-id pub-id-type="pmid">29088705</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <mixed-citation publication-type="journal"><year>2012</year>. <article-title>Human Microbiome Project Consortium. Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source><volume>486</volume>:<fpage>207</fpage>–<lpage>214</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nature11234</pub-id>.<pub-id pub-id-type="pmid">22699609</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tong</surname><given-names>M</given-names></string-name>, <string-name><surname>Jacobs</surname><given-names>JP</given-names></string-name>, <string-name><surname>McHardy</surname><given-names>IH</given-names></string-name>, <string-name><surname>Braun</surname><given-names>J</given-names></string-name></person-group>. <year>2014</year>. <article-title>Sampling of intestinal microbiota and targeted amplification of bacterial 16S rRNA genes for microbial ecologic analysis</article-title>. <source>Curr Protoc Immunol</source><volume>107</volume>:<fpage>7.41.1</fpage>–<lpage>7.41.11</lpage>.<pub-id pub-id-type="pmid">25367129</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
