<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8128456</article-id>
    <article-id pub-id-type="pmid">32866221</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa757</article-id>
    <article-id pub-id-type="publisher-id">btaa757</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CSynth: an interactive modelling and visualization tool for 3D chromatin structure</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Todd</surname>
          <given-names>Stephen</given-names>
        </name>
        <aff><institution>Department of Computing, Goldsmiths, University of London</institution>, London, <country country="GB">UK</country></aff>
        <aff><institution>London Geometry, Ltd.</institution>, London, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Todd</surname>
          <given-names>Peter</given-names>
        </name>
        <aff><institution>London Geometry, Ltd.</institution>, London, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McGowan</surname>
          <given-names>Simon J</given-names>
        </name>
        <aff><institution>Analysis, Visualization and Informatics, MRC Weatherall Institute of Molecular Medicine</institution>, Oxford, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hughes</surname>
          <given-names>James R</given-names>
        </name>
        <aff><institution>Genome Biology Group, MRC WIMM Centre for Computational Biology, MRC Weatherall Institute of Molecular Medicine</institution>, Oxford, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kakui</surname>
          <given-names>Yasutaka</given-names>
        </name>
        <aff><institution>The Francis Crick Institute, Chromosome Segregation Laboratory</institution>, London, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leymarie</surname>
          <given-names>Frederic Fol</given-names>
        </name>
        <aff><institution>Department of Computing, Goldsmiths, University of London</institution>, London, <country country="GB">UK</country></aff>
        <aff><institution>London Geometry, Ltd.</institution>, London, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Latham</surname>
          <given-names>William</given-names>
        </name>
        <aff><institution>Department of Computing, Goldsmiths, University of London</institution>, London, <country country="GB">UK</country></aff>
        <aff><institution>London Geometry, Ltd.</institution>, London, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Taylor</surname>
          <given-names>Stephen</given-names>
        </name>
        <xref rid="btaa757-cor1" ref-type="corresp"/>
        <aff><institution>Analysis, Visualization and Informatics, MRC Weatherall Institute of Molecular Medicine</institution>, Oxford, <country country="GB">UK</country></aff>
        <!--stephen.taylor@imm.ox.ac.uk-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa757-cor1">To whom correspondence should be addressed. <email>stephen.taylor@imm.ox.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-08-31">
      <day>31</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>31</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <volume>37</volume>
    <issue>7</issue>
    <fpage>951</fpage>
    <lpage>955</lpage>
    <history>
      <date date-type="received">
        <day>01</day>
        <month>5</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>8</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>19</day>
        <month>8</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>8</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa757.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The 3D structure of chromatin in the nucleus is important for gene expression and regulation. Chromosome conformation capture techniques, such as Hi-C, generate large amounts of data showing interaction points on the genome but these are hard to interpret using standard tools.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We have developed CSynth, an interactive 3D genome browser and real-time chromatin restraint-based modeller to visualize models of any chromosome conformation capture (3C) data. Unlike other modelling systems, CSynth allows dynamic interaction with the modelling parameters to allow experimentation and effects on the model. It also allows comparison of models generated from data in different tissues/cell states and the results of third-party 3D modelling outputs. In addition, we include an option to view and manipulate these complicated structures using Virtual Reality (VR) so scientists can immerse themselves in the models for further understanding. This VR component has also proven to be a valuable teaching and a public engagement tool.</p>
      </sec>
      <sec id="s3">
        <title>Availabilityand implementation</title>
        <p>CSynth is web based and available to use at <ext-link xlink:href="https://csynth.org" ext-link-type="uri">csynth.org</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Medical Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000265</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>MC_UU_12025</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>106130/Z/14/B</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>It is now well established that the three-dimensional structure of the genome is important for cellular function (<xref rid="btaa757-B9" ref-type="bibr">Lieberman-Aiden <italic toggle="yes">et al.</italic>, 2009</xref>) and with the increasing amount of high resolution and throughput chromosome conformation capture (3C) data becoming available, such as Hi-C (<xref rid="btaa757-B9" ref-type="bibr">Lieberman-Aiden <italic toggle="yes">et al.</italic>, 2009</xref>), Promoter Capture Hi-C (<xref rid="btaa757-B18" ref-type="bibr">Schoenfelder <italic toggle="yes">et al.</italic>, 2018</xref>), Capture-C (<xref rid="btaa757-B6" ref-type="bibr">Hughes <italic toggle="yes">et al.</italic>, 2014</xref>) and Tri-C (<xref rid="btaa757-B4" ref-type="bibr">Davies <italic toggle="yes">et al.</italic>, 2017</xref>), there is a need to understand chromatin structure beyond visualizing data on a 2D genome browser and using heatmaps. The advent of sophisticated microscope imaging of chromatin to observe these structures using super resolution microscopy (<xref rid="btaa757-B16" ref-type="bibr">Prakash, 2017</xref>) and electron microscopy (<xref rid="btaa757-B14" ref-type="bibr">Ou <italic toggle="yes">et al.</italic>, 2017</xref>) offers the ultimate means of visualising and understanding 3D genome architecture but these methods are laborious and expensive. Computational modelling offers a way to gain a better understanding of the complexity of chromatin in the nucleus and how the differences in structure cause enhancer/promoter/gene interactions in different cell types and disease. There are a number of methods for modelling chromatin 3D structures from 3C data but still a lack of easy to use tools (<xref rid="btaa757-B12" ref-type="bibr">Oluwadare <italic toggle="yes">et al.</italic>, 2019</xref>) so C data may be better understood by bench scientists.</p>
    <p>Here, we present CSynth, an easy to use web-based portal that allows uploading of multiple 3C datasets, PDB models, annotations and quantitative data to generate 3D models of chromatin structure. The models and their parameters are interactive and may be manipulated in real time and compared in a high-quality fully rendered 3D genome browser that can be shared online and used in publications.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Using CSynth</title>
      <p>CSynth was developed to lower the barriers to the interrogation of complex multi-genomics data in the 3D rather than 2D genome. While the generation of genome-scale 3C data, such as Hi-C, is becoming commonplace, the computational barriers to generate 3D models from such data remain high. Even more limiting are the options to interact with such models in a dynamic nature and in concert with other classes of genomics data, such as ChIP-seq, ATACseq and RNA-seq. CSynth provides a flexible platform for the generation of restraint-based models as well as a fully featured environment to interact with these or externally generated models in a publication quality, fully rendered, interactive graphical 3D genome browser (<xref rid="btaa757-F1" ref-type="fig">Fig. 1</xref>).
</p>
      <fig position="float" id="btaa757-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Overview of CSynth features. The CSynth website can upload interaction frequency data from the results of chromatin capture experiments, pre-existing 3D models generated by other methods and genome annotations files. Once loaded a 3D model is built based on the input IF data. Multiple models from different cell types, tissues or modelling techniques may be loaded and compared visually and statistically. CSynth also has a fully featured VR mode</p>
        </caption>
        <graphic xlink:href="btaa757f1" position="float"/>
      </fig>
      <p>Using CSynth’s web portal, users may register and upload their interaction frequency (IF) C data (e.g. Hi-C, Capture C and ChiaPet) and genome annotations via file upload or simply drag and drop these into the CSynth window. Once uploaded, the model is generated on the fly. Its orientation may be controlled by a handheld device [such as a mouse or Virtual Reality (VR) controller] or via a touch screen (depending on what is available). CSynth simultaneously shows the 3D model and 2D heatmap view underneath, allowing visualization and understanding of Hi-C interaction frequency data (IF) and their relationship between 2D and 3D space, so interesting features on the heatmap may be more easily understood in the 3D model. The generated model is easy to share via the internet (with a simple URL) with collaborators. Examples of such publicly available models can be seen on the CSynth website in the ‘Examples’ section (<ext-link xlink:href="https://csynth.org/examples" ext-link-type="uri">csynth.org/examples</ext-link>).</p>
      <p>A key feature of CSynth is the ability to upload files, allowing the user to generate multiple different models, for example, looking at chromatin loop topology in different cell types or comparing multiple models made using different parameters. CSynth’s physics engine smoothly interpolates between the models so the viewer can more easily identify differences between structures. The various models and parameter settings are stored in the portal, allowing experiments to be tracked.</p>
      <p>Also, we implement a VR mode which offers an alternative way of viewing and interacting with these complex datasets, allowing new perspectives on the data that would not be afforded via a 2D screen.</p>
      <p>This feature has also been extensively used for teaching and public engagement. The VR mode is implemented using WebXR and available in many browsers. For example, complex chromatin loops can be observed at different points of view while actually ‘in’ the structure. The experience is tailored for use with the HTC Vive headset but other hardware could be tailored for on request.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Comparison to other 3D visualization tools</title>
      <p>There are currently several 3D genome browser implementations suitable for looking at 3D chromatin structure. See <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> for an overview of the 3D genome viewing tools available. A key problem CSynth is addressing is to make a high-quality 3D modelling accessible that is easy and fast to run so that any person generating 3C data will use it routinely to gain further insight from their experiments. Another key factor is the results should be high quality so they can be used in publications.</p>
      <p>Genome3d (<xref rid="btaa757-B2" ref-type="bibr">Asbury <italic toggle="yes">et al.</italic>, 2010</xref>) is a downloadable C++ application, which requires a computer running the Windows OS and the installation of software which makes it more limited for general use. GMOL (<xref rid="btaa757-B11" ref-type="bibr">Nowotny <italic toggle="yes">et al.</italic>, 2016</xref>) does not handle Hi-C data, but more recently the author has released GenomeFlow (<xref rid="btaa757-B22" ref-type="bibr">Trieu <italic toggle="yes">et al.</italic>, 2019</xref>) which offers a full Hi-C analysis pipeline. However, using Java requires the user to install the relevant Java version as opposed to using the desktop browser, again causing a barrier to entry to anyone who wants to rapidly and easily visualize their analysis (data). Tadkit (<xref rid="btaa757-B19" ref-type="bibr">Serra <italic toggle="yes">et al.</italic>, 2017</xref>) is web based and shows a 3D chromatin view in the context of a 2D browser based on IGV (<xref rid="btaa757-B10" ref-type="bibr">Nicol <italic toggle="yes">et al.</italic>, 2009</xref>) but there is no possibility provided to show different states (e.g. in different tissues).</p>
    </sec>
    <sec>
      <title>3.2 Examples of CSynth modelling</title>
      <p>In <xref rid="btaa757-F2" ref-type="fig">Figure 2</xref>, we show data generated from Capture-C data (<xref rid="btaa757-B13" ref-type="bibr">Oudelaar <italic toggle="yes">et al.</italic>, 2018</xref>) at the alpha globin region in mouse captured in erythroid cells at 4 kb resolution. Clearly visible is the chromatin looping of the α-globin (mm9, chr11:32 000 000–32 300 000) self-interacting domain. The coloured sections of the model represent genes loaded as Browser Extensible Data (BED) format and the ChIP-Seq data uploaded as WIG format. A video showing uploading and general features of CSynth can be seen in via the ‘Media section’ on the CSynth website at <ext-link xlink:href="https://csynth.org" ext-link-type="uri">csynth.org</ext-link> or directly on YouTube (see <ext-link xlink:href="https://youtu.be/SMgw_cfeH6Q" ext-link-type="uri">https://youtu.be/SMgw_cfeH6Q</ext-link> and <ext-link xlink:href="https://youtu.be/yO6W10Y1o04" ext-link-type="uri">https://youtu.be/yO6W10Y1o04</ext-link>). More details on the modelling may be found in Supplementary Section S1.
</p>
      <fig position="float" id="btaa757-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Modelling the mouse alpha globin locus. On uploading of IF data, CSynth generates both the heatmap and model to be inspected. ‘a’ A sub selection of menus that can be used to adjust the visualization. ‘b’ Colouring shows genes uploaded as BED format file for the region. ‘c’ Radius variation shows H3k4me1 data that has been uploaded in WIG (wiggle) format, the size of which may be adjusted using the wigmult parameter. ‘d’ The pair of green lines represents a point selected on the heatmap and the corresponding points on the 3D model which is useful to investigate patterns leading to structures seen in the heatmap and provides a direct way to interact between the 2D heatmap and proposed 3D structure</p>
        </caption>
        <graphic xlink:href="btaa757f2" position="float"/>
      </fig>
      <p>In <xref rid="btaa757-F3" ref-type="fig">Figure 3</xref>, we show an example of loading a large Hi-C dataset at 2 kb resolution from <italic toggle="yes">Schizosaccharomyces pombe</italic> Chromosome I, comparing the difference between mitosis and interphase states (<xref rid="btaa757-B8" ref-type="bibr">Kakui <italic toggle="yes">et al.</italic>, 2017</xref>) using CSynth’s dynamic GPU modelling. To find the parameters for modelling, we used the distance between certain chromosomal locations (<xref rid="btaa757-B15" ref-type="bibr">Petrova <italic toggle="yes">et al.</italic>, 2013</xref>). In interphase (<xref rid="btaa757-F3" ref-type="fig">Fig. 3a</xref>), chromatin fibre forms a characteristic structure and its telomeres are located in the vicinity as expected from Rabl orientation within the interphase nucleus in <italic toggle="yes">S.pombe</italic> (<xref rid="btaa757-B5" ref-type="bibr">Funabiki, 1993</xref>). This is where the centromeric region (the centre of which is visible between the green and red arms in <xref rid="btaa757-F3" ref-type="fig">Fig. 3</xref>) and telomeres attach to the nuclear lamina which causes the overall structure to bend at this point. Here, CSynth shows it has several interesting folding patterns and shows looping that is not obvious in the heatmap view. In mitosis (<xref rid="btaa757-F3" ref-type="fig">Fig. 3b</xref>), one can see the structure is more compact, folding into the characteristic structure and each arm becomes individualized.
</p>
      <fig position="float" id="btaa757-F3">
        <label>Fig. 3.</label>
        <caption>
          <p><italic toggle="yes">Schizosaccharomyces pombe</italic> chromosome I, comparing differences between (<bold>a</bold>) interphase and (<bold>b</bold>) mitosis states and the (<bold>c</bold>) transition between a and b. Red and green colouring show the two arms of the chromosome. Note the more compact and wide structure observed in mitosis. The same model parameters were used for both states</p>
        </caption>
        <graphic xlink:href="btaa757f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Modelling methods</title>
      <p>There are a large number of 3D genome modelling methods available that can be represented by polymer, spheres or point<bold>-</bold>based models (<xref rid="btaa757-B12" ref-type="bibr">Oluwadare <italic toggle="yes">et al.</italic>, 2019</xref>). Benchmarking all available modellers is beyond the scope of this article but we compare CSynth’s modelling to ones that apply a similar point<bold>-</bold>based approach used by Chromosome3D(<xref rid="btaa757-B1" ref-type="bibr">Adhikari <italic toggle="yes">et al.</italic>, 2016</xref>) and LorDG(<xref rid="btaa757-B23" ref-type="bibr">Trieu and Cheng, 2017</xref>). A key point is CSynth’s modelling, which is done quickly, in real time and is interactive which encourages the user to explore and gain an intuitive feel for the model by varying parameters. CSynth’s model is constantly being recalculated so transitions between states are animated and there is direct feedback when the user adjusts parameters on the model. An overview of the modelling process is shown in <xref rid="btaa757-F4" ref-type="fig">Figure 4</xref>.</p>
      <p>CSynth uses simple forces to seek conformations that best satisfy the known IFs. This builds on the work we used in FoldSynth (<xref rid="btaa757-B21" ref-type="bibr">Todd et al., 2015</xref>) which is software we developed for interacting with protein structures. For example, unsatisfied IFs can have an effect on very long distances. This allows simpler (to compute) dynamics. Our dynamics are inspired by Poing (Jefferys, Kelley and Sternberg, 2010) largely based on spring-like forces. Some of the forces used in our dynamics may be related to real physical forces but the relationship is usually indirect; our dynamics are better thought of as an emulation rather than a simulation or modelling. The various forces we have built in CSynth are detailed in the Supplementary Section 1. Our dynamics work directly from IF or distance map inputs, which are held in sampler buffers on the GPU. The modelling system is based on particles (also referred to as beads), which are represented using the size of the fragment from the capture experiment. The particles generally match the Hi-C bands one to one, but we permit the use of multiple particles per cell for more refined modelling. The particles are assumed to be joined in a backbone chain (or chains). The modelling operates in conventional Newtonian dynamics steps, where in each step an overall force is computed on each particle; the force is then applied to the velocity which is used to compute a new position.The yeast model shown in figure 3 (2798 particles) are produced in less than 30 seconds on a 3.4GHz i7 machine with 16GB RAM and a GTX 1080 graphics card whereas most modelling packages take many minutes to several hours. The number of particles is limited by GPU texture constraint which is typically, as of writing, 16,000 particles. In tests, we have resolved models of 6284 particles (3 chromosomes of yeast at 2k resolution, see Supplementary Section 2) in a few seconds on an NVidia GTX 1080.
</p>
      <fig position="float" id="btaa757-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Schematic of the 3D model and IF heatmap showing the balance of IF attraction forces (red) and global repulsion forces (blue). The IF forces for particles A and B balance with the repulsion force. Pair C/D has no recorded IF value, so the particles are pushed further apart. The backbone is held together by IF forces along the upper diagonal of the heatmap, as indicated for pair A/E. Each particle is repulsed by all the other particles, this is indicated for particle F. In a real case, each particle will have IF forces attracting it to many other particles (not shown)</p>
        </caption>
        <graphic xlink:href="btaa757f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 Model and data comparison</title>
      <p>The main purpose of CSynth is for interactive 3D modelling of IF data, and comparison of states from multiple IF sources. It can also be used to visualize and compare data from other sources and can import and display static data in xyz or pdb format. CSynth does this by creating distance-based spring models from the distance data implicit in xyz data. These models permit inbetweening of different datasets to visualize their differences and similarities. Such model-based inbetweening is smoother and more informative than simple linear inbetweening of xyz coordinates; and also, naturally aligns the visual output. Furthermore, CSynth can move smoothly between its own models of IF data and imported distance-based models. For example, with the mouse example (<xref rid="btaa757-F2" ref-type="fig">Fig. 2</xref>), we have both IF data for erythroid and non-erythroid states (embryonic stem cell), and also a xyz data from an independently derived polymer model (<xref rid="btaa757-B0680254" ref-type="bibr">Chiariello <italic toggle="yes">et al.</italic>, 2020</xref>). Loading all four datasets (2 IF, 2 xyz imported) into CSynth allows the visualization of the differences between the states for each of the models, and between the CSynth and external models for each of the states. The differences can be visualized by transitions between the states or by history trace view similar to that shown in <xref rid="btaa757-F3" ref-type="fig">Figure 3</xref>.</p>
    </sec>
    <sec>
      <title>3.5 Comparison with other modellers using simulated data</title>
      <p>The principal feature of CSynth is the ability to visualize and interact with the modelling, better to understand both the data and the modelling. We do not make strong claims for the CSynth modelling, but illustrate here that it is comparable with other recent restraint-based modellers. We carried out tests to compare with LorDG and Chromosome3D, using the LorDG simulated datasets to permit some statistical verification. We added code to the modelling framework based on the LorDG Lorentzian function to allow these comparisons to be conveniently done in CSynth itself. We used chr20 from chainDres25 from the MissouriBox dataset, and loaded the IF data plus the resulting 10 pdb results files, 5 from LorDG modelling and 5 from Chromosome3D modelling which we show graphically using the history trace view shown in <xref rid="btaa757-F5" ref-type="fig">Figure 5</xref>. As in the section above, we could perform visual comparisons between the different models, and different runs from the imported models. Visual comparison immediately showed that 3 of the LorDG results were almost identical (apart from orientation), and brought out the differences with the rest. We were able to vary the parameters of both the LorDG model (such as c and alpha) and CSynth, and see their impact, and that visual differences between our model and the LorDG model with corresponding parameters were very small.
</p>
      <fig position="float" id="btaa757-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Exploration of LorDG data. GUI layout, ‘history trace’ view to compare results of modelling in 5 runs. Selecting the dark blue ‘dists’ buttons on the right-hand side selects the different imported LorDG solutions. Rainbow colouring, with hue changing along the chromosome. The ‘narrow’ regions show the techniques have very little conformation change between the solutions, the ’wide' regions have much more variation</p>
        </caption>
        <graphic xlink:href="btaa757f5" position="float"/>
      </fig>
      <p>We also applied statistics using multiple runs and comparing results with their ‘definitive’ simulated data. The statistics of this single experiment indicates that CSynth modelling gives marginally better results than either LorDG or Chromosome3D (<xref rid="btaa757-T1" ref-type="table">Table 1</xref>). The differences are very small, and the statistical methods, scale of the experiment and the use of simulated data limit what conclusions we can safely draw.
</p>
      <table-wrap position="float" id="btaa757-T1">
        <label>Table 1.</label>
        <caption>
          <p>Performance comparison using simulated data over multiple runs (RMSE, Root Mean Square Error; WRMSE, Weighted RMSE)</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">RMSE</th>
              <th rowspan="1" colspan="1">WRMSE</th>
              <th rowspan="1" colspan="1">Pearson</th>
              <th rowspan="1" colspan="1">Spearman</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">CSynth</td>
              <td rowspan="1" colspan="1">6.260</td>
              <td rowspan="1" colspan="1">0.230</td>
              <td rowspan="1" colspan="1">0.730</td>
              <td rowspan="1" colspan="1">0.939</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">LorDG</td>
              <td rowspan="1" colspan="1">6.397</td>
              <td rowspan="1" colspan="1">0.238</td>
              <td rowspan="1" colspan="1">0.721</td>
              <td rowspan="1" colspan="1">0.930</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Chromosome3D</td>
              <td rowspan="1" colspan="1">6.380</td>
              <td rowspan="1" colspan="1">0.238</td>
              <td rowspan="1" colspan="1">0.722</td>
              <td rowspan="1" colspan="1">0.930</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>3.6 Availability</title>
      <p>CSynth can run directly in Chrome and Firefox and has been tested on all major operating systems (including tablets). It is available from <ext-link xlink:href="https://csynth.org" ext-link-type="uri">csynth.org</ext-link> where there are several example models and instructions for use. For larger models (more than 500 contact points), it is advised to use a discrete graphics card. The absolute limit typically is 16 000, but depends on the maximum texture size depending on the browser's WebGL implementation. Data can either be uploaded to the CSynth portal (<ext-link xlink:href="https://csynth.molbiol.ox.ac.uk" ext-link-type="uri">https://csynth.molbiol.ox.ac.uk</ext-link>) for later use and for sharing, or can be directly drag-dropped from the local file system for quick viewing. Code is open source and available at <ext-link xlink:href="https://github.com/csynth/csynth" ext-link-type="uri">https://github.com/csynth/csynth</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <sec>
      <title>4.1 Potential enhancements</title>
      <p>The range of features CSynth supports adds complexity to the user interface. We aim to provide simplified interfaces for common applications based on user feedback. We are extending CSynth documentation of several existing features: scripting and API (JavaScript or Python via websockets). We plan to extend CSynth VR HTC Vive support to other eXtended Reality platforms.</p>
    </sec>
    <sec>
      <title>4.2 Summary</title>
      <p>CSynth provides a high quality, interactive, user friendly and powerful way of visualizing chromatin interaction data, by combining model, heatmap and genome annotations in one display in a standard web browser. These features are critical when trying to understand how structure and biological activity are interconnected in genome function. A key improvement in CSynth, in comparison to other currently available tools, is that modelling is done on the GPU dynamically. This allows the user to load chromosome capture matrices quickly and vary model parameter values for a better understanding of their effect on the modelling process. Another unique feature of CSynth is the facility to view and compare models between any number of different samples (e.g. tissues or cell types) or even other modelling systems. Finally, we use VR to view and interact with these complex 3D structures which helps get a better intuition for the 3D modelling and is also useful for teaching and public engagement. We foresee that CSynth has the potential to be an invaluable tool to understand the structure and dynamics of more complex systems, such as data generated from different samples from existing and new 3C-based techniques such as single-cell Hi-C (<xref rid="btaa757-B20" ref-type="bibr">Stevens <italic toggle="yes">et al.</italic>, 2017</xref>).</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa757_Supplementary_Data</label>
      <media xlink:href="btaa757_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors acknowledge the use of the MRC WIMM Centre of Computational Biology computational infrastructure which hosts this work.</p>
    <sec>
      <title>Funding</title>
      <p>This research was funded in part by Medical Research Council [MC_UU_12025] and Wellcome Trust [106130/Z/14/B].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa757-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adhikari</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Chromosome3D: reconstructing three-dimensional chromosomal structures from Hi-C interaction frequency data using distance geometry simulated annealing</article-title>. <source>BMC Genomics</source>, <volume>17</volume>, <fpage>886</fpage>.<pub-id pub-id-type="pmid">27821047</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Asbury</surname><given-names>T.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>Genome3D: a viewer-model framework for integrating and visualizing multi-scale epigenomic information within a three-dimensional genome</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>444</fpage>.<pub-id pub-id-type="pmid">20813045</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B0680254">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chiariello</surname>,<given-names>A. M.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) 
<article-title>A Dynamic Folded Hairpin Conformation Is Associated with α-Globin Activation in Erythroid Cells</article-title>. <source>Cell Reports</source>, <volume>30</volume>, <fpage>2125</fpage>–<lpage>2135.e5</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.celrep.2020.01.044</pub-id><pub-id pub-id-type="pmid">32075757</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davies</surname><given-names>J.O.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>How best to identify chromosomal interactions: a comparison of approaches</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>125</fpage>–<lpage>134</lpage>.<pub-id pub-id-type="pmid">28139673</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Funabiki</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1993</year>) 
<article-title>Cell cycle-dependent specific positioning and clustering of centromeres and telomeres in fission yeast</article-title>. <source>J. Cell Biol</source>., <volume>121</volume>, <fpage>961</fpage>–<lpage>976</lpage>.<pub-id pub-id-type="pmid">8388878</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hughes</surname><given-names>J.R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Analysis of hundreds of cis-regulatory landscapes at high resolution in a single, high-throughput experiment</article-title>. <source>Nat. Genet</source>., <volume>46</volume>, <fpage>205</fpage>–<lpage>212</lpage>.<pub-id pub-id-type="pmid">24413732</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jefferys</surname><given-names>B.R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>Protein folding requires crowd control in a simulated cell</article-title>. <source>J. Mol. Biol</source>., <volume>397</volume>, <fpage>1329</fpage>–<lpage>1338</lpage>.<pub-id pub-id-type="pmid">20149797</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kakui</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Condensin-mediated remodeling of the mitotic chromatin landscape in fission yeast</article-title>. <source>Nat. Genet</source>., <volume>49</volume>, <fpage>1553</fpage>–<lpage>1557</lpage>.<pub-id pub-id-type="pmid">28825727</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lieberman-Aiden</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) 
<article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>. <source>Science</source>, <volume>326</volume>, <fpage>289</fpage>–<lpage>293</lpage>.<pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nicol</surname><given-names>J.W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) 
<article-title>The integrated genome browser: free software for distribution and exploration of genome-scale datasets</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>2730</fpage>–<lpage>2731</lpage>.<pub-id pub-id-type="pmid">19654113</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nowotny</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>GMOL: an interactive tool for 3D genome structure visualization</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>20802</fpage>.<pub-id pub-id-type="pmid">26868282</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oluwadare</surname><given-names>O.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>An overview of methods for reconstructing 3-D chromosome and genome structures from Hi-C data</article-title>. <source>Biol. Proced. Online</source>, <volume>21</volume>, <fpage>7</fpage>.<pub-id pub-id-type="pmid">31049033</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oudelaar</surname><given-names>A.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Single-allele chromatin interactions identify regulatory hubs in dynamic compartmentalized domains</article-title>. <source>Nat. Genet</source>., <volume>50</volume>, <fpage>1744</fpage>–<lpage>1751</lpage>.<pub-id pub-id-type="pmid">30374068</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ou</surname><given-names>H.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>ChromEMT: visualizing 3D chromatin structure and compaction in interphase and mitotic cells</article-title>. <source>Science</source>, <volume>357</volume>, <fpage>eaag0025</fpage>.<pub-id pub-id-type="pmid">28751582</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Petrova</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Quantitative analysis of chromosome condensation in fission yeast</article-title>. <source>Mol. Cell. Biol</source>., <volume>33</volume>, <fpage>984</fpage>–<lpage>998</lpage>.<pub-id pub-id-type="pmid">23263988</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B16">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Prakash</surname><given-names>K.</given-names></string-name></person-group> (<year>2017</year>) <source>Chromatin Architecture: Advances from High-Resolution Single Molecule DNA Imaging</source>. 
<publisher-name>Springer</publisher-name>. <ext-link xlink:href="https://www.springer.com/gp/book/9783319521824" ext-link-type="uri">https://www.springer.com/gp/book/9783319521824</ext-link>.</mixed-citation>
    </ref>
    <ref id="btaa757-B17">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Schlick</surname><given-names>T.</given-names></string-name></person-group> (<year>2002</year>) <source>Molecular Modeling and Simulation: An Interdisciplinary Guide</source>. 
<publisher-name>Springer</publisher-name>. <ext-link xlink:href="https://www.springer.com/gp/book/9781441963505" ext-link-type="uri">https://www.springer.com/gp/book/9781441963505</ext-link>.</mixed-citation>
    </ref>
    <ref id="btaa757-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schoenfelder</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Promoter capture Hi-C: high-resolution, genome-wide profiling of promoter interactions</article-title>. <source>J. Vis. Exp</source>., doi:10.3791/57320.</mixed-citation>
    </ref>
    <ref id="btaa757-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Serra</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Automatic analysis and 3D-modelling of Hi-C data using TADbit reveals structural features of the fly chromatin colors</article-title>. <source>PLoS Comput. Biol</source>., <volume>13</volume>, <fpage>e1005665</fpage>.<pub-id pub-id-type="pmid">28723903</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stevens</surname><given-names>T.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>3D structures of individual mammalian genomes studied by single-cell Hi-C</article-title>. <source>Nature</source>, <volume>544</volume>, <fpage>59</fpage>–<lpage>64</lpage>.<pub-id pub-id-type="pmid">28289288</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Todd</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>FoldSynth: interactive 2D/3D visualisation platform for molecular strands</article-title>. In: <source>VCBM</source>, pp. <fpage>41</fpage>–<lpage>50</lpage>. <ext-link xlink:href="https://dl.acm.org/doi/10.5555/2853955.2853962" ext-link-type="uri">https://dl.acm.org/doi/10.5555/2853955.2853962</ext-link>.</mixed-citation>
    </ref>
    <ref id="btaa757-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trieu</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>GenomeFlow: a comprehensive graphical tool for modeling and analyzing 3D genome structure</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>1416</fpage>–<lpage>1418</lpage>.<pub-id pub-id-type="pmid">30215673</pub-id></mixed-citation>
    </ref>
    <ref id="btaa757-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trieu</surname><given-names>T.</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>J.</given-names></string-name></person-group> (<year>2017</year>) 
<article-title>3D genome structure modeling by Lorentzian objective function</article-title>. <source>Nucleic Acids Res</source>., <volume>45</volume>, <fpage>1049</fpage>–<lpage>1058</lpage>.<pub-id pub-id-type="pmid">28180292</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
