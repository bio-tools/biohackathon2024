<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6612845</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz317</article-id>
    <article-id pub-id-type="publisher-id">btz317</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2019 Conference Proceedings</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Comparative and Functional Genomics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>hicGAN infers super resolution Hi-C data with generative adversarial networks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Qiao</given-names>
        </name>
        <xref ref-type="aff" rid="btz317-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lv</surname>
          <given-names>Hairong</given-names>
        </name>
        <xref ref-type="aff" rid="btz317-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Rui</given-names>
        </name>
        <xref ref-type="corresp" rid="btz317-cor1"/>
        <!--<email>ruijiang@tsinghua.edu.cn</email>-->
        <xref ref-type="aff" rid="btz317-aff1"/>
      </contrib>
    </contrib-group>
    <aff id="btz317-aff1">Ministry of Education Key Laboratory of Bioinformatics, Bioinformatics Division and Center for Synthetic and Systems Biology, Beijing National Research Center for Information Science and Technology, Department of Automation, Tsinghua University, Beijing, China</aff>
    <author-notes>
      <corresp id="btz317-cor1">To whom correspondence should be addressed. <email>ruijiang@tsinghua.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-07-05">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>14</issue>
    <fpage>i99</fpage>
    <lpage>i107</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz317.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Hi-C is a genome-wide technology for investigating 3D chromatin conformation by measuring physical contacts between pairs of genomic regions. The resolution of Hi-C data directly impacts the effectiveness and accuracy of downstream analysis such as identifying topologically associating domains (TADs) and meaningful chromatin loops. High resolution Hi-C data are valuable resources which implicate the relationship between 3D genome conformation and function, especially linking distal regulatory elements to their target genes. However, high resolution Hi-C data across various tissues and cell types are not always available due to the high sequencing cost. It is therefore indispensable to develop computational approaches for enhancing the resolution of Hi-C data.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We proposed hicGAN, an open-sourced framework, for inferring high resolution Hi-C data from low resolution Hi-C data with generative adversarial networks (GANs). To the best of our knowledge, this is the first study to apply GANs to 3D genome analysis. We demonstrate that hicGAN effectively enhances the resolution of low resolution Hi-C data by generating matrices that are highly consistent with the original high resolution Hi-C matrices. A typical scenario of usage for our approach is to enhance low resolution Hi-C data in new cell types, especially where the high resolution Hi-C data are not available. Our study not only presents a novel approach for enhancing Hi-C data resolution, but also provides fascinating insights into disclosing complex mechanism underlying the formation of chromatin contacts.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>We release hicGAN as an open-sourced software at <ext-link ext-link-type="uri" xlink:href="https://github.com/kimmo1019/hicGAN">https://github.com/kimmo1019/hicGAN</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Key Research and Development Program of China</named-content>
          <named-content content-type="funder-identifier">10.13039/501100012166</named-content>
        </funding-source>
        <award-id>2018YFC0910404</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Natural Science Foundation of China</named-content>
          <named-content content-type="funder-identifier">10.13039/501100001809</named-content>
        </funding-source>
        <award-id>61873141</award-id>
        <award-id>61721003</award-id>
        <award-id>61573207</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Chromatin inside nucleus adopts an intricate three-dimensional (3D) organization which is critical for regulating the genome function and nuclear processes such as DNA replication and transcription. Previous studies have revealed that such a form of genome organization is interconnected with nuclear architecture and highly dynamic across different cell states (<xref rid="btz317-B24" ref-type="bibr">Quinodoz <italic>et al.</italic>, 2018</xref>; <xref rid="btz317-B26" ref-type="bibr">Schmitt <italic>et al.</italic>, 2016</xref>; <xref rid="btz317-B31" ref-type="bibr">Uhler and Shivashankar, 2017</xref>).</p>
    <p>In the past decade, the development of the chromosome conformation capture (3C) technique (<xref rid="btz317-B5" ref-type="bibr">Dekker <italic>et al.</italic>, 2002</xref>) and its derivatives (<xref rid="btz317-B7" ref-type="bibr">Dostie <italic>et al.</italic>, 2006</xref>; <xref rid="btz317-B28" ref-type="bibr">Simonis <italic>et al.</italic>, 2006</xref>) have emerged as a proliferation of data measuring towards genome architecture. The advent of Hi-C technology (<xref rid="btz317-B17" ref-type="bibr">Lieberman-Aiden <italic>et al.</italic>, 2009</xref>) has further enabled the measurement of chromatin contacts genome wide. Hi-C technology has greatly facilitated the discoveries of topologically associating domains (TADs), chromatin loops and A/B compartment (<xref rid="btz317-B6" ref-type="bibr">Dixon <italic>et al.</italic>, 2012</xref>; <xref rid="btz317-B21" ref-type="bibr">Nora <italic>et al.</italic>, 2012</xref>; <xref rid="btz317-B25" ref-type="bibr">Rao <italic>et al.</italic>, 2014</xref>). Although both the experimental and computational methodologies for 3D genome analysis have been rapidly increased over the past few years, the current comprehension of how the organization of genome influence cell function and fate in disease and physiology is still limited. One major concern is that our understanding of genome architecture remains relatively poor at kilobase pair (Kbp) to megabase pair (Mbp) scale, which impedes the further analysis of more refined chromatin structure. For an instance, the resolution of Hi-C data is usually defined as the finest scale that one can reliably discern local features. It also refers to the bin size for dividing the genome when constructing a Hi-C contact matrix. Most available Hi-C data have relatively low resolution ranging from 25 kb to 1 Mb.</p>
    <p>On the one hand, high resolution Hi-C data that require massive sequencing reads and high sequencing cost are only available in several tissues or cell lines. On the other hand, the resolution of Hi-C data largely affects the downstream analysis such as identifying topologically associating domains (TADs) and chromatin loops (<xref rid="btz317-B6" ref-type="bibr">Dixon <italic>et al.</italic>, 2012</xref>; <xref rid="btz317-B25" ref-type="bibr">Rao <italic>et al.</italic>, 2014</xref>; <xref rid="btz317-B27" ref-type="bibr">Sexton <italic>et al.</italic>, 2012</xref>). Typically, the deeper the sequencing depth is, the higher the resolution will be. High resolution Hi-C data can not only help us identity more clear TADs, but also makes it possible for uncovering sub-TADs or contact domains at a finer genomic scale, which are believed to be more variable across cell types and species (<xref rid="btz317-B22" ref-type="bibr">Phillips-Cremins <italic>et al.</italic>, 2013</xref>; <xref rid="btz317-B36" ref-type="bibr">Yu and Ren, 2017</xref>). Based on the above considerations, it is urgent to develop computational approaches for enhancing Hi-C data resolution by learning the mapping relationship between low resolution Hi-C data and high resolution Hi-C data.</p>
    <p>Recently, deep learning technologies have achieved unprecedented advancements in many fields, including but not limited to computer vision (CV) and natural language processing (NLP) (<xref rid="btz317-B14" ref-type="bibr">LeCun <italic>et al.</italic>, 2015</xref>). In the field of computational biology, deep neural networks have been successfully applied to the prediction of functional genomic sequence (<xref rid="btz317-B2" ref-type="bibr">Alipanahi <italic>et al.</italic>, 2015</xref>; <xref rid="btz317-B16" ref-type="bibr">Li <italic>et al.</italic>, 2019</xref>; <xref rid="btz317-B18" ref-type="bibr">Liu <italic>et al.</italic>, 2018</xref>; <xref rid="btz317-B20" ref-type="bibr">Min <italic>et al.</italic>, 2017</xref>; <xref rid="btz317-B38" ref-type="bibr">Zhou and Troyanskaya, 2015</xref>), gene expression patterns (<xref rid="btz317-B29" ref-type="bibr">Singh <italic>et al.</italic>, 2016</xref>) and protein structures (<xref rid="btz317-B11" ref-type="bibr">Heffernan <italic>et al.</italic>, 2015</xref>). Nevertheless, applications of deep learning technologies to 3D genome data analysis is still rare. HiCPlus is the first work that applies a convolutional neural network in enhancing the resolution of Hi-C data by minimizing the mean squared error (MSE) between real high resolution Hi-C data and generated Hi-C data (<xref rid="btz317-B37" ref-type="bibr">Zhang <italic>et al.</italic>, 2018</xref>). However, it tends to generate Hi-C images with limited dynamic details and can only predict Hi-C matrix with fixed window size. Most importantly, it is very sensitive to the sequencing depth of the Hi-C data.</p>
    <p>Considering the limitations of previous work, we take advantage of generative adversarial networks (GANs), a hot deep learning technology that has attracted a lot of attention in producing high quality synthesized images (<xref rid="btz317-B9" ref-type="bibr">Goodfellow <italic>et al.</italic>, 2014</xref>). We present hicGAN, as an open-sourced computational framework, for inferring high resolution Hi-C data from low resolution Hi-C data with generative adversarial networks (GANs). Instead of using a single neural network for generating Hi-C data, hicGAN is composed of two competitive neural networks and adopts an adversarial training strategy. We demonstrate that hicGAN can effectively generate matrices that are highly consistent to high resolution Hi-C matrices while only adopts as few as 1/16 of original sequencing reads. We systematically evaluate the quality of generated samples by hicGAN through comparison between high resolution samples and generated samples in several perspectives, including image similarity and identified chromatin interactions. After model training in one cell type, hicGAN can even enhance the resolution of insufficient sequenced Hi-C samples in other cell types, which implies that some local patterns are shared across different cell types. We finally summarize hicGAN, as an effective prediction tool for enhancing resolution of Hi-C data, could shed light on the understanding of genome organization built on pair-wise interactions.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Overview of hicGAN</title>
      <p>The overall framework of hicGAN is illustrated in <xref ref-type="fig" rid="btz317-F1">Figure 1A</xref>. The design of hicGAN is inspired by Game Theory. Instead of using a single neural network, hicGAN is composed of two competitive neural networks, which are called the generator network (<xref ref-type="fig" rid="btz317-F1">Fig. 1B</xref>) and the discriminator network (<xref ref-type="fig" rid="btz317-F1">Fig. 1C</xref>), respectively. The generator takes low resolution Hi-C samples as input and tries to produce pseudo high resolution Hi-C (or called super resolution) samples. The discriminator works as a classifier to discern between real high resolution Hi-C data and super resolution Hi-C data. After adversarial training, the generator tends to generate real-like data underlying almost the same distribution of high resolution Hi-C data. Given paired low resolution and high resolution Hi-C samples, of which low resolution data are usually obtained from 1/16 down sampled sequencing reads of original high resolution Hi-C experiment, hicGAN is able to conduct an adversarial training process. Then we only use generator network for enhancing the resolution of Hi-C data after training converges.
</p>
      <fig id="btz317-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>The overall schematic of hicGAN. (<bold>A</bold>) hicGAN consists of two competitive networks. G tries to generate super resolution samples that are highly similar to real high resolution samples while D tries to discriminate generated super resolution samples from real high resolution Hi-C samples. Parameters of G and D are updated through an adversarial training process. (<bold>B</bold>) The architecture of the generator network. Generator network adopts a novel dual-stream residual architecture which contains five inner residual blocks (RBs) and an outer skip connection. Rectangles with different colors represent different functional layers. Blue denotes convolutional layer, orange denotes batch normalization layer and green denotes an operation of element-wise summation of the previous layer’s output and the output of the skipped layer. It outputs a super resolution Hi-C sample given an insufficient sequenced Hi-C sample as input. (<bold>C</bold>) The architecture of discriminator network. Discriminator network is a typical deep convolutional neural network. The convolutional part has been modularized as three convolutional blocks. It outputs the estimated probability that the input is a high resolution Hi-C sample</p>
        </caption>
        <graphic xlink:href="btz317f1"/>
      </fig>
      <p>The generator network (<xref ref-type="fig" rid="btz317-F1">Fig. 1B</xref>) adopts a novel dual-stream residual architecture which contains five inner residual blocks (RBs) and an outer skip connection. Each residual block consists of two convolutional layers with <inline-formula id="IE1"><mml:math id="IM1"><mml:mn>3</mml:mn><mml:mo> </mml:mo><mml:mo>×</mml:mo><mml:mo> </mml:mo><mml:mn>3</mml:mn></mml:math></inline-formula> filters and 64 feature maps. Each convolutional layer is followed up by a batch normalization layer, which is proved to effectively prevent overfitting (<xref rid="btz317-B12" ref-type="bibr">Ioffe and Szegedy, 2015</xref>). Residual architecture has shown superior performance in various computer vision tasks and has been proved to alleviate gradient vanishing problem as it contains additional shortcuts compared to traditional deep convolutional neural networks (<xref rid="btz317-B10" ref-type="bibr">He <italic>et al.</italic>, 2016</xref>; <xref rid="btz317-B15" ref-type="bibr">Ledig <italic>et al.</italic>, 2017</xref>). Note that the generator network is a typical fully convolutional network (without dense layer), thus can handle any size of input low resolution Hi-C samples in a prediction task. The discriminator network is a deep convolutional neural network, which has been modularized as three convolutional blocks (CBs). The size of input data will reduce by half when going through each CB. High-level features after CBs will be flatted before entering two dense layers and transformed by a sigmoid function. The detailed hyper-parameters of both the generator and discriminator networks can be found in <xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S1 and S2</xref>.</p>
    </sec>
    <sec>
      <title>2.2 Adversarial training</title>
      <p>We apply an adversarial training strategy for training two competitive neural network simultaneously. We define generator network as <inline-formula id="IE2"><mml:math id="IM2"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>θ</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula>, parametrized by <inline-formula id="IE3"><mml:math id="IM3"><mml:mo>θ</mml:mo></mml:math></inline-formula>, which outputs the pseudo high resolution sample (or super resolution) given an low resolution Hi-C sample. We define discriminator as <inline-formula id="IE4"><mml:math id="IM4"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>ω</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula>, parametrized by <inline-formula id="IE5"><mml:math id="IM5"><mml:mo>ω</mml:mo></mml:math></inline-formula>, which outputs the probability that the input of discriminator is a high resolution Hi-C sample. We further denote the data distributions of low resolution and high resolution Hi-C sample are <inline-formula id="IE6"><mml:math id="IM6"><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">LR</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE7"><mml:math id="IM7"><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Then the training process can be regarded as an min-max problem:
<disp-formula id="E1"><mml:math id="M1"><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mrow><mml:mo>θ</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mo>ω</mml:mo></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>ω</mml:mo></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">LR</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">LR</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>ω</mml:mo></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>θ</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">LR</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>The general idea of the above formulation is to train a generative model <inline-formula id="IE8"><mml:math id="IM8"><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>θ</mml:mo></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> with the goal of generating samples to fool the discriminator, which has the goal of discerning real high resolution samples from super resolution samples. Towards this goal, generator network gradually learns to generate samples that are highly similar to real high resolution samples by learning the mapping relationship from <inline-formula id="IE9"><mml:math id="IM9"><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">LR</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to <inline-formula id="IE10"><mml:math id="IM10"><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Different from HiCPlus (<xref rid="btz317-B37" ref-type="bibr">Zhang <italic>et al.</italic>, 2018</xref>), we do not consider minimizing any pixel-wise error measurements, such as MSE, which is believed to generate over-smoothing results (<xref rid="btz317-B34" ref-type="bibr">Xu <italic>et al.</italic>, 2017</xref>). We finally summarize the detailed adversarial training process in <xref rid="btz317-T1" ref-type="table">Table 1</xref>.</p>
      <table-wrap id="btz317-T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>The adversarial training of hicGAN model</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"><bold>Algorithm</bold> Adversarial training of hicGAN</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1"><bold>Require</bold>: <inline-formula id="IE11"><mml:math id="IM11"><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> for initial parameters of generator network, <inline-formula id="IE12"><mml:math id="IM12"><mml:msub><mml:mrow><mml:mi mathvariant="normal">ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> for initial parameters of discriminator network, batch size <inline-formula id="IE13"><mml:math id="IM13"><mml:mi>m</mml:mi></mml:math></inline-formula> and learning rate <inline-formula id="IE14"><mml:math id="IM14"><mml:mo>α</mml:mo></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><bold>While</bold><inline-formula id="IE15"><mml:math id="IM15"><mml:mi mathvariant="normal">θ</mml:mi></mml:math></inline-formula> has not converged, <bold>do</bold></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">  Sample <inline-formula id="IE16"><mml:math id="IM16"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as a batch high resolution Hi-C data</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">  Sample <inline-formula id="IE17"><mml:math id="IM17"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">LR</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">LR</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> as a batch low resolution Hi-C data</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">  <inline-formula id="IE18"><mml:math id="IM18"><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>ω</mml:mo></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:msub><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mo>ω</mml:mo></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>ω</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>ω</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>θ</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">LR</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">  <inline-formula id="IE19"><mml:math id="IM19"><mml:mi mathvariant="normal">ω</mml:mi><mml:mo>←</mml:mo><mml:mi mathvariant="normal">ω</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">α</mml:mi><mml:mo>·</mml:mo><mml:mi mathvariant="normal">Adam</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal">ω</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>ω</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">  <inline-formula id="IE20"><mml:math id="IM20"><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>θ</mml:mo></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:msub><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mo>θ</mml:mo></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mo>ω</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mo>θ</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">LR</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">  <inline-formula id="IE21"><mml:math id="IM21"><mml:mi mathvariant="normal">θ</mml:mi><mml:mo>←</mml:mo><mml:mi mathvariant="normal">θ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">α</mml:mi><mml:mo>·</mml:mo><mml:mi mathvariant="normal">Adam</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>θ</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <bold>end while</bold>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic>Note</italic>: The default settings in all the experiments are as follows. We use Adam optimizer for gradient descent and parameters updating. <inline-formula id="IE22"><mml:math id="IM22"><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>0.0001</mml:mn></mml:math></inline-formula>, <inline-formula id="IE23"><mml:math id="IM23"><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>128</mml:mn></mml:math></inline-formula>, <inline-formula id="IE24"><mml:math id="IM24"><mml:msub><mml:mrow><mml:mi mathvariant="normal">θ</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE25"><mml:math id="IM25"><mml:msub><mml:mrow><mml:mi mathvariant="normal">ω</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> are initialized with a normal distribution where mean equals 0 and standard deviation equals 0.02.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>We implement hicGAN algorithm with the TensorFlow framework (<xref rid="btz317-B1" ref-type="bibr">Abadi <italic>et al.</italic>, 2016</xref>) and all the computational experiments were carried on a Linux platform equipped with 10 NVIDIA GeForce RTX 2080 Ti GPU cards, which can significantly accelerate the training process.</p>
    </sec>
    <sec>
      <title>2.3 Data preparation and preprocessing</title>
      <p>The high resolution Hi-C datasets across four cell types (GM12878, K562, IMR90 and NHEK) were downloaded from the GEO database with accession number GSE63525. For cell type that contains multiple Hi-C experiments, we first pooled all the aligned Hi-C reads together (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>), then we used the Juicer toolbox (<xref rid="btz317-B8" ref-type="bibr">Durand <italic>et al.</italic>, 2016</xref>) for generating HIC file and further extracted raw chromatin contacts for constructing Hi-C matrix. Note that we only considered intra-chromosomal interactions and removed chromosome X and Y for each cell type to eliminate sex effect. A ChIA-PET dataset with CTCF target from K562 cell type was downloaded from <ext-link ext-link-type="uri" xlink:href="https://4dgenome.research.chop.edu">https://4dgenome.research.chop.edu</ext-link> as ground truth to verify the chromatin loops and interactions predicted by our model. Note that the ChIA-PET dataset has already been processed and we directly used the ChIA-PET chromatin contact text file. ChIP-seq data with CTCF target from K562 was download from the ENCODE project (<xref rid="btz317-B4" ref-type="bibr">Consortium, 2012</xref>) with accession number ENCSR000AKO. The narrowPeak file was used in Section 3.3 for generating background pairs of genomic regions.</p>
      <p>Let <inline-formula id="IE26"><mml:math id="IM26"><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">chr</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">chr</mml:mi><mml:mn>22</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> be the original raw contact Hi-C matrix. We first normalized the sequencing depth by the following formulation:
<disp-formula id="E2"><mml:math id="M2"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">chr</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">chr</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mi mathvariant="normal">*</mml:mi><mml:mi>N</mml:mi><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">chr</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi mathvariant="normal"> </mml:mi><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>22</mml:mn></mml:math></disp-formula>
where <inline-formula id="IE27"><mml:math id="IM27"><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">chr</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> is the total aligned reads of chromosome <italic>k</italic> and <inline-formula id="IE28"><mml:math id="IM28"><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">chr</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mn>22</mml:mn><mml:mo>}</mml:mo></mml:math></inline-formula>. Then we further transformed the normalized Hi-C matrix <inline-formula id="IE29"><mml:math id="IM29"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">chr</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> to the range [-1, 1] by performing the linear transformation <inline-formula id="IE30"><mml:math id="IM30"><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="normal">chr</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">chr</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, where <inline-formula id="IE31"><mml:math id="IM31"><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">chr</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">chr</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mi mathvariant="normal">for</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">any</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi>i</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">and</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:mi>j</mml:mi><mml:mo>}</mml:mo></mml:math></inline-formula>. As for low resolution Hi-C data, we randomly down-sampled the original aligned reads to 1/16 for simulating low resolution Hi-C data. Then we constructed Hi-C matrix with the same bin size (e.g. 10 kb) and performed the 2-step data normalization just the same as high resolution Hi-C data.</p>
      <p>Before training hicGAN, we divided normalized high resolution and low resolution Hi-C matrices into multiple non-overlapping small patches with size <inline-formula id="IE32"><mml:math id="IM32"><mml:mn>400</mml:mn><mml:mo> </mml:mo><mml:mo>×</mml:mo><mml:mo> </mml:mo><mml:mn>400</mml:mn><mml:msup><mml:mrow><mml:mi mathvariant="normal">kb</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>. Each patch contains <inline-formula id="IE33"><mml:math id="IM33"><mml:mn>40</mml:mn><mml:mo> </mml:mo><mml:mo>×</mml:mo><mml:mo> </mml:mo><mml:mn>40</mml:mn><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mn>1600</mml:mn></mml:math></inline-formula> pixels with 10 kb resolution. Considering the fact that the average genomic distance of TADs is usually less than 1 Mb, we only kept patches of which genomic distance between two loci is less than 2 Mb, thus filtering too far off-diagonal patches as there are few meaningful contacts outside 2 Mb. Then, both high resolution and low resolution Hi-C samples were fed to hicGAN for model training. Particularly, Hi-C samples extracted from chromosomes 1–17 were for training and Hi-C samples extracted from chromosomes 18–22 were for testing.</p>
      <p>In the process of prediction, there is no restriction on the input size of low resolution Hi-C sample as the generator network is a fully convolutional neural network. The generator network can make a prediction given one or multiple insufficient sequenced Hi-C samples of arbitrary size at one time. While the adversarial training process usually takes hours, the prediction process is ultra-fast and usually done in seconds.</p>
    </sec>
    <sec>
      <title>2.4 Model evaluation</title>
      <p>We evaluate the quality of generated samples by hicGAN in multiple perspectives. We first compare the pixel-wise error measurement such as MSE between high resolution samples and super resolution samples generated by generator network, which is calculated by
<disp-formula id="E3"><mml:math id="M3"><mml:mi mathvariant="normal">MSE</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">SR</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE34"><mml:math id="IM34"><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula id="IE35"><mml:math id="IM35"><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">SR</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> denote a high resolution Hi-C sample and a super resolution Hi-C sample, respectively. <inline-formula id="IE36"><mml:math id="IM36"><mml:mi>n</mml:mi></mml:math></inline-formula> is the sample size which is set to 40.</p>
      <p>We then calculate the peak signal-to-noise ratio (PSNR) and structure similarity index (SSIM) (<xref rid="btz317-B32" ref-type="bibr">Wang <italic>et al.</italic>, 2004</xref>) which are two commonly used metrics in natural images compression, synthesis and super-resolution.
<disp-formula id="E4"><mml:math id="M4"><mml:mi mathvariant="normal">PSNR</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">MAX</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">SE</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE37"><mml:math id="IM37"><mml:mi mathvariant="normal">MAX</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>−</mml:mo><mml:mi mathvariant="normal">min</mml:mi><mml:mo>⁡</mml:mo><mml:mo>{</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow></mml:msubsup><mml:mo>}</mml:mo></mml:math></inline-formula> denotes the data range of high resolution sample in our case.</p>
      <p>SSIM is an overall measurement, which considers both the brightness, contrast and structure similarity of the two comparing images. SSIM ranges from 0 to 1. The closer to 1, the higher similarity the two images have.
<disp-formula id="E5"><mml:math id="M5"><mml:mi mathvariant="normal">SSIM</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">SR</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">SR</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">SR</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">SR</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula>
where <inline-formula id="IE38"><mml:math id="IM38"><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE39"><mml:math id="IM39"><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">SR</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denote the mean value of a high resolution Hi-C sample and corresponding super resolution Hi-C sample, <inline-formula id="IE40"><mml:math id="IM40"><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE41"><mml:math id="IM41"><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">SR</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denote the standard deviation of a high resolution Hi-C sample and corresponding super resolution Hi-C sample.<inline-formula id="IE42"><mml:math id="IM42"><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">HR</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="italic">SR</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denotes covariance of a high resolution Hi-C sample and a super resolution Hi-C sample. <inline-formula id="IE43"><mml:math id="IM43"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE44"><mml:math id="IM44"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> are two constants which are set to <inline-formula id="IE45"><mml:math id="IM45"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>0.01</mml:mn><mml:mo>×</mml:mo><mml:mi mathvariant="normal">MAX</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula id="IE46"><mml:math id="IM46"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>0.02</mml:mn><mml:mo>×</mml:mo><mml:mi mathvariant="normal">MAX</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, respectively.</p>
    </sec>
    <sec>
      <title>2.5 Evaluating pairs of genomic regions with Hi-C chromatin loops</title>
      <p>We proposed a strategy for scoring any pair of genomic regions with existing Hi-C chromatin interactions to give an estimation of whether the two genomic regions have contact with each other. Note that only intra-chromosomal interactions are retained in Hi-C data. Assuming a pair of genomic regions is denoted as <inline-formula id="IE47"><mml:math id="IM47"><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="italic">chrom</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="italic">midpoint</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula id="IE48"><mml:math id="IM48"><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="italic">chrom</mml:mi><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="italic">midpoint</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula>. Hi-C chromatin interactions are represented as <inline-formula id="IE49"><mml:math id="IM49"><mml:mo>{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="italic">chrom</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="italic">midpoint</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="italic">chrom</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="italic">midpoint</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:math></inline-formula>. While <inline-formula id="IE50"><mml:math id="IM50"><mml:mi mathvariant="italic">chrom</mml:mi><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mi mathvariant="italic">chrom</mml:mi><mml:mn>2</mml:mn></mml:math></inline-formula>, the estimated score is calculated as
<disp-formula id="E6"><mml:math id="M6"><mml:mi mathvariant="italic">score</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:mo>-</mml:mo><mml:mo>γ</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="italic">midpoint</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>-</mml:mo><mml:mi mathvariant="italic">midpointk</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE51"><mml:math id="IM51"><mml:mo>γ</mml:mo></mml:math></inline-formula> is the decay parameter which is set to 0.0001 in our experiments and <inline-formula id="IE52"><mml:math id="IM52"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the indexes that ensure <inline-formula id="IE53"><mml:math id="IM53"><mml:mi mathvariant="italic">chrom</mml:mi><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="italic">chrom</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>. In other cases, score is set to 0. The higher the score is, the stronger the estimated interaction strength will be.</p>
    </sec>
    <sec>
      <title>2.6 Baseline models</title>
      <p>In order to evaluate the performance of hicGAN, we designed a series of systematical experiments and compared hicGAN to baseline models. HiCPlus (<xref rid="btz317-B37" ref-type="bibr">Zhang <italic>et al.</italic>, 2018</xref>) is a recent approach that applies a convolutional neural network in enhancing Hi-C resolution. It was downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/zhangyan32/HiCPlus">https://github.com/zhangyan32/HiCPlus</ext-link> and the default hyper-parameters were used in all experiments. Besides, we discuss in detail the limitations of HiCPlus in <xref ref-type="supplementary-material" rid="sup1">Supplementary Note S1</xref>.</p>
      <p>Another baseline model 2D Gaussian is an unsupervised approach which applies a sliding Gaussian window for smoothing the input matrix. To determine the best parameter of 2D Gaussian, the deviation Sigma is finally set to 1 after performing a grid search strategy.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 hicGAN recovers high resolution Hi-C data from insufficient sequenced samples</title>
      <p>We first designed a series of systematical experiments to verify the performance of hicGAN by multiple perspectives. We downloaded high resolution datasets of GM12878 from GEO database with accession number GSE63525. 10 kb resolution Hi-C matrix was constructed by all the aligned sequencing reads. Then we randomly down-sampled all the reads to 1/16 and constructed the interaction Hi-C matrix with the same resolution. Note we only kept intra-chromosomal interactions in a reasonable genomic distance and then cropped the matrices into non-overlapping patches with size <inline-formula id="IE54"><mml:math id="IM54"><mml:mn>400</mml:mn><mml:mo> </mml:mo><mml:mo>×</mml:mo><mml:mo> </mml:mo><mml:mn>400</mml:mn><mml:msup><mml:mrow><mml:mi mathvariant="normal">kb</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> (See Methods). Each patch was treated as an individual sample which contains <inline-formula id="IE55"><mml:math id="IM55"><mml:mn>40</mml:mn><mml:mo> </mml:mo><mml:mo>×</mml:mo><mml:mo> </mml:mo><mml:mn>40</mml:mn><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mn>1600</mml:mn></mml:math></inline-formula> pixels in the aspect of image. We used Hi-C samples from chromosomes 1–17 for training and Hi-C samples from chromosomes 18–22 for test. Then we compared the samples generated by hicGAN to high resolution Hi-C samples from test set in three different metrics (<xref ref-type="fig" rid="btz317-F2">Fig. 2A–C</xref>). We grouped the test samples based on the genomic distance of the diagonal interactions of a given sample. The three measurements show the same trend that Hi-C samples containing closer interactions are easier to be predicted. At the genomic distance of 0, Hi-C samples were extracted from diagonal of original Hi-C matrix, hicGAN on average achieves an MSE of 0.0078, a PSNR of 23.90 dB and an SSIM of 0.731. At the genomic distance of 1.2 Mb, the performance of hicGAN drops to an acceptable level with an MSE of 0.042, a PSNR of 13.07 dB and an SSIM of 0.209 on average. We also note that hicGAN outperforms HiCPlus under the above three measurements under different genomic distance by a large margin (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S1–S3</xref>).
</p>
      <fig id="btz317-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Evaluation of Hi-C data generated by hicGAN in GM12878 cell type. Model training was performed on chromosomes 1–17, model evaluation was performed on chromosomes 18–22. (<bold>A-C</bold>) Mean squared error (MSE), peak signal-to-noise ratio (PSNR) and structure similarity index (SSIM) measurements between high resolution Hi-C samples and super resolution samples generated by hicGAN. (<bold>D</bold>) The Pearson correlation coefficients (PCCs) between real Hi-C data and predicted Hi-C data under different genomic distance. hicGAN significantly outperforms other methods in different genomic distance. (<bold>E</bold>) The distribution of interaction frequency within different genomic ranges (e.g. 0–10 kb, 10–20 kb, etc.) observed from real high resolution Hi-C data and Hi-C data predicted by hicGAN. The distribution of interaction frequency captured by hicGAN is highly consistent with real Hi-C data. (<bold>F</bold>) An example shows the low resolution Hi-C sample (left), Hi-C sample predicted by hicGAN (middle) and high resolution Hi-C sample (right). Hi-C sample generated by hicGAN is highly similar to high resolution Hi-C sample</p>
        </caption>
        <graphic xlink:href="btz317f2"/>
      </fig>
      <p>We then compared hicGAN to three other approaches (HiCPlus, 2D Gaussian and baseline) by measuring the Pearson correlation at different genomic distance. The interactions with the same genomic distance were grouped and the Pearson correlation coefficient (PCC) between real interactions and interactions predicted by different methods are calculated (<xref ref-type="fig" rid="btz317-F2">Fig. 2D</xref>). HiCPlus and 2D Gaussian are described in Section 2. The baseline method is directly using interactions from down-sampled Hi-C matrix and compared to the real interactions from high resolution Hi-C matrix. Our hicGAN model outperforms HiCPlus (<italic>P</italic>-values&lt;<inline-formula id="IE56"><mml:math id="IM56"><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>) and other two methods at any genomic distance ranging from 0 to 1 Mb. At the genomic distance of 200 kb, hicGAN achieves a Pearson correlation coefficient of 0.976, compared to 0.958 of HiCPlus, 0.881 of 2D Gaussian and 0.705 of baseline. At the genomic distance of 1 Mb, hicGAN outperforms HiCPlus by a large margin (0.814 versus 0.732). We note that 2D Gaussian shows a decent performance as it can effectively reduce the noise level by a smoothing process.</p>
      <p>To verify whether hicGAN can effectively capture the interaction frequency at different genomic distance, we compared the distribution of interaction frequency within different genomic ranges, such as 0–kb, 100–200 kb, etc. We first transformed the predicted normalized Hi-C data into interaction frequency count. Then we observed that the interaction frequency predicted by hicGAN has highly similar distribution as real Hi-C data (<xref ref-type="fig" rid="btz317-F2">Fig. 2E</xref>). In the aspect of a visualized image, samples generated by hicGAN tend to have domain boundaries as clear as high resolution Hi-C data. We demonstrated vivid examples of visualized Hi-C samples generated by hicGAN model (<xref ref-type="fig" rid="btz317-F2">Fig. 2F</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S4</xref>). Leveraging only a small fraction of the original sequencing reads, hicGAN captures the features of high resolution Hi-C data across chromosomes.</p>
    </sec>
    <sec>
      <title>3.2 hicGAN recovers high resolution Hi-C data across different cell types</title>
      <p>In the previous section, hicGAN has demonstrated the powerful ability of recovering super resolution Hi-C data that are highly similar to real high resolution data. We then ask whether hicGAN can be used for enhancing the resolution of Hi-C matrix across different cell types. Towards this goal, we downloaded Hi-C data across 4 cell types (GM12878, K562, IMR90 and NHEK) from GEO database with accession number GSE63525. The same data preprocessing was performed to each cell type. With the hicGAN model trained in GM12878 in the previous section, we then applied it to enhance insufficient sequenced Hi-C matrices in three test cell types. We selected a genomic region (chr17: 70.5–75.75 Mb) that contains highly dynamic chromatin contacts across three test cell types, experiments show that hicGAN can well capture the differences of domain boundaries across different cell types and generate super resolution Hi-C samples that are highly similar to original high resolution Hi-C samples (<xref ref-type="fig" rid="btz317-F3">Fig. 3A</xref>).
</p>
      <fig id="btz317-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Cross-cell-type experiments by hicGAN. Training data is obtained from chromosomes 1–17 and test data is obtained from chromosomes 18–22. (<bold>A</bold>) hicGAN model trained in GM12878 cell type was used for generating super resolution Hi-C samples (chr17: 70.5–72.75Mb) in three other cell types (K562, IMR90 and NHEK). The generated Hi-C samples are highly similar to the high resolution Hi-C samples in the corresponding cell type. (<bold>B</bold>) hicGAN model was trained in three cell types (K562, IMR90 and NHEK), respectively. Then the trained hicGAN model in each cell type was used for predicted in the same genomic region of GM12878 (chr21: 26–28 Mb). No matter which cell type the hicGAN was trained in, it can generate Hi-C sample that is highly consistent to the original high resolution Hi-C sample in GM12878. (<bold>C</bold>) We trained four hicGAN models on chromosomes 1–17 of GM12878, K562, IMR90 and NHEK, respectively. Then we used the four trained hicGAN model to predict Hi-C samples on chromosomes 18–22 of GM12878. The performance of model trained in K562, IMR90 and NHEK drops slightly compared to model trained in GM12878. The four hicGAN models outperform 2D Gaussian and baseline by a large margin. (<bold>D</bold>) We pooled the Hi-C samples on chromosomes 1–17 of four cell types (K562, IMR90, GM12878 and NHEK) together and trained a hicGAN with the constructed assembled Hi-C dataset. For comparison, we trained a baseline hicGAN model on chromosomes 1–17 of K562 cell types. We used the above two hicGAN models to predict Hi-C samples on chromosomes 18–22 of K562 cell type. Model trained in assembled cell types achieves slightly lower mean squared error and lower variance, especially at long genomic distance</p>
        </caption>
        <graphic xlink:href="btz317f3"/>
      </fig>
      <p>To further verify our observation, we then designed an experiment in which we trained hicGAN model in different cell types while predicting the same Hi-C sample. We first trained hicGAN on chromosomes 1–17 of K562, IMR90 and NHEK, respectively. Then we used trained hicGAN model to make a prediction given the same insufficient sequenced Hi-C sample from GM12878 (chr21: 26–28 M). The results predicted by hicGAN model across three test cell types show high consistence to the high resolution Hi-C sample in GM12878 (<xref ref-type="fig" rid="btz317-F3">Fig. 3B</xref>). We further evaluated the cross-cell-type generated Hi-C samples by measuring the Pearson correlation similar to the previous section. We trained four hicGAN models on chromosomes 1–17 of GM12878, K562, IMR90 and NHEK, respectively. Then we used the four trained hicGAN model to predict Hi-C samples on chromosomes 18–22 of GM12878. 2D Gaussian applies a Gaussian smoothing to insufficient sequenced Hi-C samples on Chromosomes 18–22 of GM12878. The baseline directly shows the Pearson correlation coefficient (PCC) between insufficient sequenced Hi-C samples and high resolution Hi-C samples on chromosomes 18–22 of GM12878. Compared to training and test in the same cell type, the performance of cross-cell-type experiments only decreases slightly (<xref ref-type="fig" rid="btz317-F3">Fig. 3C</xref>). At the genomic distance of 200 kb, hicGAN trained in GM12878 achieves a Pearson correlation coefficient of 0.976, compared to 0.961 in K562, 0.952 in IMR90 and 0.967 in NHEK. The performance of four hicGAN models outperform 2D Gaussian and baseline model by a large margin (<italic>P</italic>-values &lt; <inline-formula id="IE57"><mml:math id="IM57"><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S5</xref>). The superior results of cross-cell-type experiments suggest that different cell types may share some local patterns in the 3D genome contacts map so hicGAN can borrow information of local patterns in one cell type when making prediction in another cell type.</p>
      <p>We further investigate whether hicGAN can borrow information from multiple cell types. We first pooled all the Hi-C samples from chromosomes 1–17 of four cell types together to construct an assembled training set. We then trained hicGAN model under the assembled training data and compared the performance to another hicGAN model trained on chromosomes 1–17 of K562 cell type. We finally used the above trained hicGAN model to make a prediction on chromosomes 18–22 of K562 cell type (<xref ref-type="fig" rid="btz317-F3">Fig. 3D</xref>). The hicGAN model trained in assembled cell types has a slightly better performance than the model trained in a single cell type at different genomic distance (<italic>P</italic>-values &lt; <inline-formula id="IE58"><mml:math id="IM58"><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S6</xref>). At the genomic distance of 400 kb, hicGAN trained in assembled cell types can reduce the mean squared error (MSE) by 0.0039. Moreover, hicGAN model trained in assembled cell types tends to be more robust at a long genomic distance as achieves obviously lower variance. The standard deviation of MSE achieved by hicGAN with assembled training cell types at 800 kb is 0.0117, compared to 0.0156 of single cell type trained hicGAN model. This experiment again suggests that the local patterns or features among different cell types may have some common properties. Once a hicGAN model is trained in one or multiple cell types, it can be applied to make prediction in new cell types.</p>
    </sec>
    <sec>
      <title>3.3 hicGAN facilitates identifying meaningful chromatin interactions</title>
      <p>Previous experiments have demonstrated that hicGAN is able to enhance the resolution of insufficient sequenced Hi-C samples. We then investigated that whether hicGAN can help facilitate the identification of chromatin contacts or chromatin loops. Towards this purpose, we applied Fit-Hi-C software (<xref rid="btz317-B3" ref-type="bibr">Ay <italic>et al.</italic>, 2014</xref>), as a chromatin loop caller, for identifying the significant chromatin loops given high resolution Hi-C data and predicted Hi-C data. Similar to the previous experiments, we first trained a hicGAN model on chromosomes 1–17 of GM12878 cell type, then we used the trained hicGAN model to predict Hi-C samples on chromosomes 18–22. As not all the chromatin interactions are of equal importance, what really made us interested is the interactions that are enriched for regulatory elements, such as promoters and enhancers. We applied the Fit-Hi-C tool to predicted Hi-C data and real high resolution Hi-C data in GM12878 cell type for calling significant chromatin loops with a strict threshold (<italic>q</italic>-value &lt; 1e−06), respectively. Then we filtered the called chromatin loops and only kept significant chromatin loops within the genomic distance from 30 to 300 kb, which resulted in 124 321 significant chromatin loops of high resolution Hi-C data and 147 890 significant chromatin loops of hicGAN predicted Hi-C data. We observed that 90.86% of the significant chromatin loops from high resolution Hi-C data were successfully recovered by hicGAN. 76.34% of the significant chromatin loops from hicGAN predicted Hi-C data were also identified in high resolution Hi-C data (<xref ref-type="fig" rid="btz317-F4">Fig. 4A</xref>). We also noticed that down-sampled Hi-C matrix can only recover 13.36% of the significant chromatin loops from the high resolution Hi-C data, which suggests that hicGAN can effectively promote the identification of significant chromatin loops give insufficient sequenced Hi-C samples. We also conducted similar experiments in other cell lines to further support our conclusion (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S5</xref>).
</p>
      <fig id="btz317-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Evaluation of significant chromatin loop inferred from Hi-C data predicted by hicGAN model. (<bold>A</bold>) The Venn plot of the significant chromatin loops from high resolution Hi-C data and Hi-C data predicted by hicGAN model in GM12878 cell type using Fit-Hi-C software with a strict threshold (<italic>q</italic>-value &lt; 1e−06). More than 90 percent of the significant chromatin loops from real high resolution Hi-C data can be also identified in Hi-C data predicted by hicGAN. (<bold>B</bold>) High resolution Hi-C data and Hi-C data predicted recovers comparable percentage of ChIA-PET chromatin loops while down-sampled low resolution Hi-C data recovers much less ChIA-PET chromatin loops. (<bold>C</bold>) The receiver operating characteristic (ROC) curve in discerning ChIA-PET chromatin loops from random pairs of CTCF ChIP-seq peaks. High resolution H-C data and Hi-C data predicted by hicGAN model achieve comparable results with the areas under ROC curve (auROCs) 0.844 versus 0.837, which outperform 2D Gaussian and down-sampled low resolution Hi-C. (<bold>D</bold>) The precision-recall curve in discerning ChIA-PET chromatin loops from random pairs of CTCF ChIP-seq peaks. The areas under precision-recall curve (auPRs) implicates the consistent conclusion</p>
        </caption>
        <graphic xlink:href="btz317f4"/>
      </fig>
      <p>Next, we introduced another type of chromatin contacts data from ChIA-PET, a technique that incorporates chromatin immunoprecipitation (ChIP)-based enrichment, paired-end tagging and high-throughput sequencing (<xref rid="btz317-B33" ref-type="bibr">Wei <italic>et al.</italic>, 2006</xref>). ChIA-PET can accurately help us identity <italic>de novo</italic> long-range chromatin interactions genome-wide with targeted protein. We downloaded ChIA-PET datasets of K562 cell type with CTCF target, a key transcription factor that involves in the regulation of chromatin architecture (<xref rid="btz317-B23" ref-type="bibr">Phillips and Corces, 2009</xref>). We first investigated whether hicGAN can recover CTCF chromatin interaction from ChIA-PET data. Similar to the experiments settings previously, we used Fit-Hi-C for identifying significant chromatin loops from high resolution Hi-C data, down-sampled Hi-C data and Hi-C data predicted by hicGAN with a strict threshold (<italic>q</italic>-value &lt; 1e−06) in K562 cell type. We then calculated how many CTCF chromatin interactions were covered by significant Hi-C chromatin loops. We observed that high resolution Hi-C data and Hi-C data predicted by hicGAN model can recover 62.87% and 61.16% of the ChIA-PET chromatin interactions, respectively. While the down-sampled low resolution Hi-C data can only recover 31.16% of the ChIA-PET chromatin interactions (<xref ref-type="fig" rid="btz317-F4">Fig. 4B</xref>), which implicated that hicGAN can significantly help recover ChIA-PET chromatin loops given down-sampled low resolution Hi-C data.</p>
      <p>We further investigated whether significant Hi-C loops can help discriminate ChIA-PET chromatin loops from random pairs of genomic regions. We treated ChIA-PET chromatin interactions with CTCF target as ground truth or true positives, then we selected the same number of random pairs from CTCF ChIP-seq peaks, which have no overlaps with any of the ChIA-PET chromatin loops, as negative samples. Finally, we used Hi-C chromatin interactions to score each of the above positive and negative samples (see Methods). It showed that Hi-C chromatin interactions from high resolution Hi-C data and Hi-C data predicted by hicGAN can discern ChIA-PET chromatin loops from random pairs of CTCF ChIP-seq peaks at a comparable level (<xref ref-type="fig" rid="btz317-F4">Fig. 4C–D</xref>). Using high resolution Hi-C data achieves an auROC of 0.844, compared to 0.837 of hicGAN, 0.798 of 2D Gaussian and 0.764 of using down-sampled low resolution Hi-C data. The precision-recall curves also showed that the high resolution Hi-C data and hicGAN predicted Hi-C data can achieve similar performance, which outperform 2D Gaussian and down-sampled low resolution Hi-C data by a relatively large margin.</p>
      <p>The above results demonstrate that the chromatin loops enriched in down-sampled low resolution Hi-C data are only a small portion of the chromatin loops from high resolution Hi-C data. However, with our powerful hicGAN model, one can significantly improve the number of enriched chromatin loops, thus reaching a comparable level with the high resolution Hi-C data.</p>
    </sec>
    <sec>
      <title>3.4 hicGAN facilitates identifying cell-type specific contact domain boundaries</title>
      <p>We finally applied hicGAN in inferring super resolution Hi-C data in two differential cell types GM12878 and K562 with a hicGAN model trained in NHEK cell type. Previous experiments have demonstrated the ability of cross-cell-type prediction of hicGAN. We now focus on the exploring the relationship between domain boundaries inferred from Hi-C data and the implicating functions. We extracted a 1 Mbp genomic region (chr9: 36.5–37.5 M), which contains Pax5, a master regulator of B cell development (<xref rid="btz317-B19" ref-type="bibr">Medvedovic <italic>et al.</italic>, 2011</xref>). At the same time, we collected several annotation tracks using WU Epigenome Browser (<xref rid="btz317-B39" ref-type="bibr">Zhou <italic>et al.</italic>, 2011</xref>).We note that Pax5 regulator was only expressed in GM12878 cell type according to the RNA-seq annotation track. The down-sampled low resolution Hi-C data across two cell types contained blurry contact domain boundaries while Hi-C data predicted by hicGAN showed as clear TADs or sub-TADs as high resolution Hi-C data (<xref ref-type="fig" rid="btz317-F5">Fig. 5A–B</xref>). Interestingly, hicGAN identified several promoter-enhancer interactions which are consistent with the annotations by two histone modifications. Compared to K562 cell type, GM12878 contains more sub-domain boundaries, which are enriched in signals from two histone modifications and ChIA-PET with CTCF. More importantly, except for the common contact domain boundaries (yellow dots), we also observed that GM12878 contained cell type specific domain boundaries (blue dots) that were not discovered in K562 cell types. Previous studies have shown that such cell type specific domain boundaries are crucial to the relevant chromatin architecture and the underlying gene regulations (<xref rid="btz317-B30" ref-type="bibr">Smith <italic>et al.</italic>, 2016</xref>). A great portion of the cell type specific contact domain boundaries may not be uncovered in insufficient sequenced Hi-C data. With the powerful hicGAN model, one can significantly enhance the resolution of Hi-C data and identity more refined contact domain boundaries.
</p>
      <fig id="btz317-F5" orientation="portrait" position="float">
        <label>Fig. 5.</label>
        <caption>
          <p>Three types of Hi-C data extracted from a differential genomic region (chr9: 36.5–37.5 M) between GM12878 and K562 cell type. Several annotation tracks, including RNA-seq, ChIP-seq with CTCF, ChIP-seq with two histone modifications and ChIA-PET with CTCF target across two cell types were also shown below the Hi-C data. The high resolution Hi-C data and Hi-C data predicted by hicGAN have significantly clearer chromatin contact boundaries compared to down-sampled low resolution Hi-C data. We observed that a B cell important regulator, Pax5, only expressed in GM12878 cell type. Hi-C data also reveals promoter-enhancer interactions which is highly consistent with the signals from the two histone markers (a promoter P and three potential enhancers E1-E3 were denoted in GM12878). More importantly, we noticed that the above two cell types contain common contact domain boundaries and cell-type specific contact domain boundaries (GM12878 specific contact boundaries were shown with blue dots and the common domain boundaries were shown with yellow dots). (<bold>A</bold>) Hi-C maps and annotation tracks in GM12878 cell type. (<bold>B</bold>) Hi-C maps and annotation tracks in K562 cell type</p>
        </caption>
        <graphic xlink:href="btz317f5"/>
      </fig>
    </sec>
    <sec>
      <title>3.5 Hyperparameter settings for hicGAN</title>
      <p>As hicGAN contains two neural networks with complicated architectures, we modularized both generator network and discriminator network into functional layers or blocks, which makes it easy for us to determine the best hyperparameters. We considered learning rate <inline-formula id="IE59"><mml:math id="IM59"><mml:mo>α</mml:mo></mml:math></inline-formula>, batch size <inline-formula id="IE60"><mml:math id="IM60"><mml:mi>m</mml:mi></mml:math></inline-formula>, the number of residual blocks (RBs) and the number of convolutional blocks (CBs) as the major tuning hyperparameters. We directly used a grid search strategy for the best combination of the above four hyperparameters. The learning rate <inline-formula id="IE61"><mml:math id="IM61"><mml:mo>α</mml:mo></mml:math></inline-formula> was chosen from {0.001, 0.0001, 0.00001}, batch size <inline-formula id="IE62"><mml:math id="IM62"><mml:mi>m</mml:mi></mml:math></inline-formula> was chosen from {32, 64, 128}, the number of RBs was chosen from {1, 5, 10} and the number of CBs was chosen from {1, 2, 3, 4}. The best hyperparameters were finally determined as described in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1 and S2</xref>.</p>
      <p>We also evaluated whether the batch normalization will help improve the performance of hicGAN. We tried adding batch normalization after each convolutional layer and removing batch normalization layer of both generative network and discriminator network. Interestingly, batch normalization can indeed help improve the performance of generative network, but we did not observe difference when applying to discriminator network. We implemented hicGAN with the best hyperparameters we have obtained so far in the software.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We proposed hicGAN, an open-sourced computational framework, for inferring high resolution Hi-C data from low resolution Hi-C data with adversarial generative networks (GANs). To the best of our knowledge, hicGAN is the first work to apply GANs in the generation of 3D genome data. We designed a series of systematical experiments to verify the quality of generated Hi-C samples by hicGAN model given insufficient sequenced Hi-C samples. Experimental results show that Hi-C samples generated by hicGAN (super resolution Hi-C samples) are highly similar to the original high resolution Hi-C data. With the powerful learning ability, hicGAN effectively enhances the resolution of low resolution Hi-C data, which is typically constructed by down-sampling the original aligned sequencing reads to as few as 1/16. More importantly, hicGAN can help us identify significant chromatin interactions or loops where a portion of the boundary information is already missing in the low resolution Hi-C data. A typical scenario of using hicGAN is applying it to low resolution Hi-C samples where the corresponding high resolution Hi-C data is not available. Some meaningful interactions such as promoters-enhancers might not be detected in the low resolution Hi-C data, but we have the potential to recover such interactions with our hicGAN model. We expect to see wide application of hicGAN to both public or in-house Hi-C data in the identification of chromatin interactions across various cell types.</p>
    <p>The cross-cell-type experiments implicate that Hi-C datasets consist of many local patterns that are shared across different cell types. The information of local structures or patterns can be borrowed when making a prediction in other cell types. However, due to the ‘black box’ property of neural network model, it is still somehow tough to interpret the learned features. One thing for sure is that the features should be highly related to the crucial functions of 3D genome organization, such as TADs, sub-TADs and contact domain. So a major future task is for us to visualize and interpret the features learned in hicGAN. Perhaps we can investigate the kernel weights in the convolutional layers to see if they contain low-level structure information that corresponds to chromatin boundaries.</p>
    <p>Another possible improvement of our work is to consider the potential noise in Hi-C data. Although we regard high resolution Hi-C data as the gold standard, it still contains multiple sources of noises such as the random ligations generated by Hi-C protocol (<xref rid="btz317-B13" ref-type="bibr">Lajoie <italic>et al.</italic>, 2015</xref>). So variations exist even between high resolution Hi-C data from two biological replicates (<xref rid="btz317-B6" ref-type="bibr">Dixon <italic>et al.</italic>, 2012</xref>). One feasible solution might be modifying hicGAN model by using random noise as input and low resolution Hi-C data as prior information. More experiments need to be conducted to validate our assumption and shed light on how to further improve the performance of current model. The current evaluation of generated Hi-C data mainly focusses on image-based measurements. We can further take Hi-C specialized measurement, such as HiCRep (<xref rid="btz317-B35" ref-type="bibr">Yang <italic>et al.</italic>, 2017</xref>), into consideration.</p>
    <p>Theoretically, hicGAN can be applies to any type of chromatin interaction data such as Capture Promoter Hi-C and ChIA-PET. But the current public datasets are not as abundant as Hi-C datasets. We can investigate the performance of hicGAN applied in other types of chromatin interaction data as more datasets across various tissues or cell types become available.</p>
    <p>To sum up, hicGAN presents an end-to-end solution for enhancing the resolution of insufficient sequenced Hi-C data. Our study not only provides a novel approach for inferring high resolution Hi-C data, but also implies fascinating insights into deciphering complex mechanism underlying the 3D genome organization.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz317_Supplementary_Data</label>
      <media xlink:href="btz317_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Xianglin Zhang for his helpful instructions about Hi-C data preprocessing and normalization. We also thank Fengling Chen for her useful comments on Hi-C data chromatin loops calling software. Rui Jiang is a RONG professor at the Institute for Data Science, Tsinghua University.</p>
    <sec>
      <title>Funding</title>
      <p>This research was partially supported by the National Key Research and Development Program of China (No. 2018YFC0910404), the National Natural Science Foundation of China (Nos. 61873141, 61721003, 61573207) and the Tsinghua-Fuzhou Institute for Data Technology.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz317-B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Abadi</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) <chapter-title>Tensorflow: a system for large-scale machine learning</chapter-title> In: <source>OSDI</source>, <italic>Savannah, GA, USA</italic>, pp. <fpage>265</fpage>–<lpage>283</lpage>. USENIX.</mixed-citation>
    </ref>
    <ref id="btz317-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alipanahi</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Predicting the sequence specificities of DNA- and RNA-binding proteins by deep learning</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>831</fpage>–<lpage>838</lpage>.<pub-id pub-id-type="pmid">26213851</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ay</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Statistical confidence estimation for Hi-C data reveals regulatory chromatin contacts</article-title>. <source>Genome Res</source>., <volume>24</volume>, <fpage>999</fpage>–<lpage>1011</lpage>.<pub-id pub-id-type="pmid">24501021</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Consortium</surname><given-names>E.P.</given-names></name></person-group> (<year>2012</year>) 
<article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>, <volume>489</volume>, <fpage>57</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dekker</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2002</year>) 
<article-title>Capturing chromosome conformation</article-title>. <source>Science</source>, <volume>295</volume>, <fpage>1306</fpage>–<lpage>1311</lpage>.<pub-id pub-id-type="pmid">11847345</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dixon</surname><given-names>J.R.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>. <source>Nature</source>, <volume>485</volume>, <fpage>376</fpage>.<pub-id pub-id-type="pmid">22495300</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dostie</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Chromosome Conformation Capture Carbon Copy (5C): a massively parallel solution for mapping interactions between genomic elements</article-title>. <source>Genome Res</source>., <volume>16</volume>, <fpage>1299</fpage>–<lpage>1309</lpage>.<pub-id pub-id-type="pmid">16954542</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Durand</surname><given-names>N.C.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Juicer provides a one-click system for analyzing loop-resolution Hi-C experiments</article-title>. <source>Cell Syst</source>., <volume>3</volume>, <fpage>95</fpage>–<lpage>98</lpage>.<pub-id pub-id-type="pmid">27467249</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goodfellow</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Generative adversarial nets</article-title>. In: <source>Advances in Neural Information Processing Systems</source>, Curran Associates, Inc. <italic>Montreal, Quebec, Canada, Dec 8, 2014 – Dec 13, 2014</italic>, pp. <fpage>2672</fpage>–<lpage>2680</lpage>.</mixed-citation>
    </ref>
    <ref id="btz317-B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>He</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) <chapter-title>Deep residual learning for image recognition</chapter-title> In: <source>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</source>, <italic>June 27–30, 2016</italic>,<italic> Las Vegas, NV, USA. </italic>pp. <fpage>770</fpage>–<lpage>778</lpage>.</mixed-citation>
    </ref>
    <ref id="btz317-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Heffernan</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Improving prediction of secondary structure, local backbone angles, and solvent accessible surface area of proteins by iterative deep learning</article-title>. <source>Sci. Rep</source>., <volume>5</volume>, <fpage>11476</fpage>.<pub-id pub-id-type="pmid">26098304</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B12">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Ioffe</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Szegedy</surname><given-names>C.</given-names></name></person-group> (<year>2015</year>) <chapter-title>Batch normalization: accelerating deep network training by reducing internal covariate shift</chapter-title> In: <source>Proceedings of the 32nd International Conference on International Conference on Machine Learning</source>, <italic>July 6–11, 2015</italic>, Vol. 37, <italic>Lille, France</italic>, pp. <fpage>448</fpage>–<lpage>456</lpage>.</mixed-citation>
    </ref>
    <ref id="btz317-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lajoie</surname><given-names>B.R.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>The Hitchhiker’s guide to Hi-C analysis: practical guidelines</article-title>. <source>Methods</source>, <volume>72</volume>, <fpage>65</fpage>–<lpage>75</lpage>.<pub-id pub-id-type="pmid">25448293</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>LeCun</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Deep learning</article-title>. <source>Nature</source>, <volume>521</volume>, <fpage>436.</fpage><pub-id pub-id-type="pmid">26017442</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B15">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Ledig</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) <chapter-title>Photo-realistic single image super-resolution using a generative adversarial network</chapter-title> In: <source>2017 IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</source>, <italic>Honolulu,</italic> Hawaii, July 21 to July 26, 2017, pp. <fpage>105</fpage>–<lpage>114</lpage>. IEEE.</mixed-citation>
    </ref>
    <ref id="btz317-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>DeepTACT: predicting 3D chromatin contacts via bootstrapping deep learning</article-title>. <source>Nucleic Acids Res</source>., doi.org/10.1093/nar/gkz167.</mixed-citation>
    </ref>
    <ref id="btz317-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lieberman-Aiden</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>. <source>Science</source>, <volume>326</volume>, <fpage>289</fpage>–<lpage>293</lpage>.<pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>Q.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Chromatin accessibility prediction via a hybrid deep convolutional neural network</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>732</fpage>–<lpage>738</lpage>.<pub-id pub-id-type="pmid">29069282</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Medvedovic</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) <chapter-title>Pax5: a master regulator of B cell development and leukemogenesis</chapter-title>
<source> Adv. Immunol</source>., <volume>111</volume>, <fpage>179</fpage>–<lpage>206</lpage>.<pub-id pub-id-type="pmid">21970955</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Min</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Chromatin accessibility prediction via convolutional long short-term memory networks with k-mer embedding</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>i92</fpage>–<lpage>i101</lpage>.<pub-id pub-id-type="pmid">28881969</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nora</surname><given-names>E.P.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Spatial partitioning of the regulatory landscape of the X-inactivation centre</article-title>. <source>Nature</source>, <volume>485</volume>, <fpage>381</fpage>.<pub-id pub-id-type="pmid">22495304</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Phillips-Cremins</surname><given-names>J.E.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Architectural protein subclasses shape 3D organization of genomes during lineage commitment</article-title>. <source>Cell</source>, <volume>153</volume>, <fpage>1281</fpage>–<lpage>1295</lpage>.<pub-id pub-id-type="pmid">23706625</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Phillips</surname><given-names>J.E.</given-names></name>, <name name-style="western"><surname>Corces</surname><given-names>V.G.</given-names></name></person-group> (<year>2009</year>) 
<article-title>CTCF: master weaver of the genome</article-title>. <source>Cell</source>, <volume>137</volume>, <fpage>1194</fpage>–<lpage>1211</lpage>.<pub-id pub-id-type="pmid">19563753</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Quinodoz</surname><given-names>S.A.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Higher-order inter-chromosomal hubs shape 3D genome organization in the nucleus</article-title>. <source>Cell</source>, <volume>174</volume>, <fpage>744</fpage>–<lpage>757</lpage>.<pub-id pub-id-type="pmid">29887377</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rao</surname><given-names>S.S.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>. <source>Cell</source>, <volume>159</volume>, <fpage>1665</fpage>–<lpage>1680</lpage>.<pub-id pub-id-type="pmid">25497547</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schmitt</surname><given-names>A.D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Genome-wide mapping and analysis of chromosome architecture</article-title>. <source>Nat. Rev. Mol. Cell Biol</source>., <volume>17</volume>, <fpage>743.</fpage><pub-id pub-id-type="pmid">27580841</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sexton</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Three-dimensional folding and functional organization principles of the Drosophila genome</article-title>. <source>Cell</source>, <volume>148</volume>, <fpage>458</fpage>–<lpage>472</lpage>.<pub-id pub-id-type="pmid">22265598</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Simonis</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Nuclear organization of active and inactive chromatin domains uncovered by chromosome conformation capture–on-chip (4C)</article-title>. <source>Nat. Genet</source>., <volume>38</volume>, <fpage>1348</fpage>.<pub-id pub-id-type="pmid">17033623</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Singh</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Deepchrome: deep-learning for predicting gene expression from histone modifications</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>i639</fpage>–<lpage>i648</lpage>.<pub-id pub-id-type="pmid">27587684</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>E.M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Invariant TAD boundaries constrain cell-type-specific looping interactions between promoters and distal elements around the CFTR locus</article-title>. <source>Am. J. Hum. Genet</source>., <volume>98</volume>, <fpage>185</fpage>–<lpage>201</lpage>.<pub-id pub-id-type="pmid">26748519</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Uhler</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Shivashankar</surname><given-names>G.</given-names></name></person-group> (<year>2017</year>) 
<article-title>Regulation of genome organization and gene expression by nuclear mechanotransduction</article-title>. <source>Nat. Rev. Mol. Cell Biol</source>., <volume>18</volume>, <fpage>717.</fpage><pub-id pub-id-type="pmid">29044247</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) 
<article-title>Image quality assessment: from error visibility to structural similarity</article-title>. <source>IEEE Trans. Image Process</source>., <volume>13</volume>, <fpage>600</fpage>–<lpage>612</lpage>.<pub-id pub-id-type="pmid">15376593</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wei</surname><given-names>C.-L.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>A global map of p53 transcription-factor binding sites in the human genome</article-title>. <source>Cell</source>, <volume>124</volume>, <fpage>207</fpage>–<lpage>219</lpage>.<pub-id pub-id-type="pmid">16413492</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B34">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Xu</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) <chapter-title>Learning to super-resolve blurry face and text images</chapter-title> In: <source>2017 IEEE International Conference on Computer Vision (ICCV)</source>, <italic>October 22–29, 2017</italic>, <italic>Venice, Italy</italic>, pp. <fpage>251</fpage>–<lpage>260</lpage>. IEEE.</mixed-citation>
    </ref>
    <ref id="btz317-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yang</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>HiCRep: assessing the reproducibility of Hi-C data using a stratum-adjusted correlation coefficient</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>1939</fpage>–<lpage>1949</lpage>.<pub-id pub-id-type="pmid">28855260</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Ren</surname><given-names>B.</given-names></name></person-group> (<year>2017</year>) 
<article-title>The three-dimensional organization of mammalian genomes</article-title>. <source>Annu. Rev. Cell Dev. Biol</source>., <volume>33</volume>, <fpage>265</fpage>–<lpage>289</lpage>.<pub-id pub-id-type="pmid">28783961</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Enhancing Hi-C data resolution with deep convolutional neural network HiCPlus</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>750</fpage>.<pub-id pub-id-type="pmid">29467363</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhou</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Troyanskaya</surname><given-names>O.G.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Predicting effects of noncoding variants with deep learning-based sequence model</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>931</fpage>–<lpage>934</lpage>.<pub-id pub-id-type="pmid">26301843</pub-id></mixed-citation>
    </ref>
    <ref id="btz317-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhou</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>The human epigenome browser at Washington University</article-title>. <source>Nat. Methods</source>, <volume>8</volume>, <fpage>989</fpage>.<pub-id pub-id-type="pmid">22127213</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
