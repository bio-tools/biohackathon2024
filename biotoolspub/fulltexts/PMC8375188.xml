<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8375188</article-id>
    <article-id pub-id-type="publisher-id">2445</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-021-02445-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MultiK: an automated tool to determine optimal cluster numbers in single-cell RNA sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Siyao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thennavan</surname>
          <given-names>Aatish</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Garay</surname>
          <given-names>Joseph P.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Marron</surname>
          <given-names>J. S.</given-names>
        </name>
        <address>
          <email>marron@unc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9827-2247</contrib-id>
        <name>
          <surname>Perou</surname>
          <given-names>Charles M.</given-names>
        </name>
        <address>
          <email>cperou@med.unc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.10698.36</institution-id><institution-id institution-id-type="ISNI">0000000122483208</institution-id><institution>Lineberger Comprehensive Cancer Center, </institution><institution>University of North Carolina at Chapel Hill, </institution></institution-wrap>Marsico Hall, 5th floor, CB#7599, 125 Mason Farm Road, Chapel Hill, NC 27599 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.10698.36</institution-id><institution-id institution-id-type="ISNI">0000000122483208</institution-id><institution>Department of Genetics, School of Medicine, </institution><institution>University of North Carolina at Chapel Hill, </institution></institution-wrap>Chapel Hill, NC 27599 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.410711.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 1034 1720</institution-id><institution>Curriculum in Bioinformatics and Computational Biology, </institution><institution>University of North Carolina, </institution></institution-wrap>Chapel Hill, NC 27599 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.10698.36</institution-id><institution-id institution-id-type="ISNI">0000000122483208</institution-id><institution>Oral and Craniofacial Biomedicine Program, School of Dentistry, </institution><institution>University of North Carolina at Chapel Hill, </institution></institution-wrap>Chapel Hill, NC 27599 USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.5288.7</institution-id><institution-id institution-id-type="ISNI">0000 0000 9758 5690</institution-id><institution>Department of Surgery, </institution><institution>Oregon Health &amp; Science University, </institution></institution-wrap>Portland, OR 97239 USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.10698.36</institution-id><institution-id institution-id-type="ISNI">0000000122483208</institution-id><institution>Department of Statistics and Operation Research, </institution><institution>University of North Carolina at Chapel Hill, </institution></institution-wrap>352 Hanes Hall CB#3260, Chapel Hill, NC 27599 USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.10698.36</institution-id><institution-id institution-id-type="ISNI">0000000122483208</institution-id><institution>Department of Pathology and Laboratory Medicine, </institution><institution>University of North Carolina at Chapel Hill, </institution></institution-wrap>Chapel Hill, NC 27599 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>232</elocation-id>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Single-cell RNA sequencing (scRNA-seq) provides new opportunities to characterize cell populations, typically accomplished through some type of clustering analysis. Estimation of the optimal cluster number (<italic>K</italic>) is a crucial step but often ignored. Our approach improves most current scRNA-seq cluster methods by providing an objective estimation of the number of groups using a multi-resolution perspective. MultiK is a tool for objective selection of insightful <italic>Ks</italic> and achieves high robustness through a consensus clustering approach. We demonstrate that MultiK identifies reproducible groups in scRNA-seq data, thus providing an objective means to estimating the number of possible groups or cell-type populations present.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-021-02445-5.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell RNA-seq</kwd>
      <kwd>Clustering</kwd>
      <kwd>Multi-scale</kwd>
      <kwd>Multi-resolution</kwd>
      <kwd>Genomics</kwd>
      <kwd>Reproducibility</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Cancer Institute Breast SPORE program</institution>
        </funding-source>
        <award-id>P50-CA58223</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>RO1</institution>
        </funding-source>
        <award-id>RO1-CA14876</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U01CA238475-01</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Breast Cancer Research Foundation</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100009634</institution-id>
            <institution>Susan G. Komen</institution>
          </institution-wrap>
        </funding-source>
        <award-id>SAC-160074</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Single-cell RNA sequencing (scRNA-seq) has emerged as a powerful tool for gene expression profiling, offering opportunities to study individuals cells and features like cell-to-cell variability and intra-tumor heterogeneity at a new level of data resolution [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref>]. Identifying distinct groups of cells based on transcriptome similarity, often called “clustering,” has been a key component in scRNA-seq analysis. Accurate and reliable characterization of cell types and/or cell states in healthy and diseased tissues such as cancers not only provides fundamental insights into disease development and progression, but also provides enlightenment into therapeutic resistance, which has important implications for guiding treatment [<xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par3">Estimating the optimal number of data-driven clusters (henceforth called “<italic>K</italic>”) is a critical issue in clustering analysis. Some clustering algorithms, such as <italic>K</italic>-means, require an initial choice of <italic>K</italic>. Other algorithms such as hierarchical clustering allow choosing <italic>K</italic> after partitioning. Because the cluster numbers are unknown a priori, but need to be discovered from the data, the choice of a starting <italic>K</italic> is typically subjective, with interpretations largely relying on the user’s desired clustering resolution and/or prior knowledge.</p>
    <p id="Par4">One approach to determining an optimal <italic>K</italic> is to use validation indices that evaluate the results of a clustering procedure for different values of <italic>K</italic>. Many indices have been proposed for this purpose, such as the elbow method [<xref ref-type="bibr" rid="CR8">8</xref>], the silhouette index [<xref ref-type="bibr" rid="CR9">9</xref>], the GAP statistic [<xref ref-type="bibr" rid="CR10">10</xref>], Clest [<xref ref-type="bibr" rid="CR11">11</xref>], and prediction strength [<xref ref-type="bibr" rid="CR12">12</xref>]. The main drawback of these approaches is that they lack a “multi-resolution/multi-scale” clustering perspective. A single clustering resolution approach hinders the user’s ability to explore clusters at different scales, which could also be biologically relevant. Several multi-resolution methods were recently proposed for choosing <italic>K</italic> in scRNA-seq data, such as Clustree [<xref ref-type="bibr" rid="CR13">13</xref>], scClustViz [<xref ref-type="bibr" rid="CR14">14</xref>], IKAP [<xref ref-type="bibr" rid="CR15">15</xref>], and TooManyCells [<xref ref-type="bibr" rid="CR16">16</xref>]. However, most of these were designed to explore different choices of <italic>K</italic> by visualizing the clusters at different resolutions, and do not explicitly inform the choice of <italic>K</italic>.</p>
    <p id="Par5">Previous work has shown that clustering of perturbed data multiple times at various clustering resolutions can inform the choice of <italic>K</italic> [<xref ref-type="bibr" rid="CR17">17</xref>]. The main idea is that the optimal cluster number should be stable to small perturbations such as resampling, and therefore, the stability of clusters at different resolutions can be measured to infer optimal <italic>K</italic>. Monti et al. proposed “Consensus Clustering” [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>], but it was not scalable for large-scale scRNA-seq data. Single-cell consensus clustering (SC3) [<xref ref-type="bibr" rid="CR20">20</xref>] was recently developed for that case and uses a consensus clustering framework that repeatedly applies <italic>K</italic>-means clustering to find the consensus. The estimation of <italic>K</italic> was based on Tracy-Widom theory [<xref ref-type="bibr" rid="CR21">21</xref>]; however, previous studies have shown that the accuracy of SC3 is sensitive to the parameter used in dimension reduction and transformation prior to clustering and tends to overestimate <italic>K</italic> [<xref ref-type="bibr" rid="CR22">22</xref>]. Hence, there is still a need to develop novel automated tools for objective estimation of <italic>K</italic> in scRNA-seq data contexts.</p>
    <p id="Par6">Here, we develop such a data-driven tool, termed “MultiK,” which objectively selects multiple insightful numbers of clusters from the data. We hypothesize that there exist different levels of cluster resolution (i.e., multi-resolution) that are biologically relevant in the data: some clusters are more distinct (e.g., cell types), and others are less distinct but still different (such as related subtypes within a common cell type). MultiK presents multiple diagnostic plots to assist in the determination of meaningful <italic>Ks</italic> in the data and makes objective optimal <italic>K</italic> suggestions, which encompasses both high- and low-resolution parameters.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of MultiK workflow</title>
      <p id="Par7">The MultiK analysis workflow includes two main steps (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). First, in the spirit of consensus clustering, MultiK determines candidate numbers of clusters via subsampling 80% of the cells from the original complete dataset. This is done across 100 runs of the Louvain clustering (as implemented in Seurat) over each of 40 resolution parameters (from 0.05 to 2 with an increment of 0.05). During each run, features are re-selected each time to cluster the cells. Then, for each <italic>K</italic>, MultiK aggregates all the clustering runs that give rise to the same <italic>K</italic> groups regardless of the resolution parameter and computes a consensus matrix. MultiK then evaluates the consensus of clustering using two metrics: (1) for each <italic>K</italic>, the frequency of runs where that <italic>K</italic> is observed (Fig. <xref rid="Fig1" ref-type="fig">1a</xref> center), and (2) the relative proportion of ambiguous clustering PAC (rPAC) score for each <italic>K</italic> (Fig. <xref rid="Fig1" ref-type="fig">1a</xref> center<bold>)</bold>, which is a variation of the PAC score [<xref ref-type="bibr" rid="CR23">23</xref>]. PAC quantifies the proportion of entries in the consensus matrix strictly between the lower and upper bounds that determine ambiguity. The rPAC criterion addresses the upward bias of PAC towards higher <italic>K</italic> by better handling the proportion of zeros in the consensus matrix. Combining both measures, MultiK produces a scatter plot that shows the relationship between the frequency of <italic>K</italic> and (1 – rPAC) for each observed <italic>K</italic> (Fig. <xref rid="Fig1" ref-type="fig">1a</xref> right). To determine several multi-scale optimal <italic>K</italic> candidates (mostly 2 and up to 3), MultiK applies a convex hull approach [<xref ref-type="bibr" rid="CR24">24</xref>]. This is based on the upper right of the smallest convex polygon that encloses all the points. MultiK takes extreme points from this set and uses a frequency cutoff of 100 to select candidate <italic>Ks</italic>.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of MultiK workflow. <bold>a</bold> Step 1: Starting from a count matrix, MultiK subsamples 80% of the cells and performs a standard scRNA-seq pipeline using Seurat (version 3.1.2) 100 times over each of 40 resolution parameters (from 0.05 to 2 with an increment of 0.05). Then, MultiK determines candidate <italic>Ks</italic> based on the frequency of <italic>K</italic> and rPAC across all subsampling runs. <bold>b</bold> Step 2: MultiK assigns class or subclass labels to clusters at candidate <italic>K</italic> levels. MultiK first constructs a dendrogram of the cluster centroids using hierarchical clustering and then runs SigClust on each pair of terminal clusters to determine classes and subclasses</p></caption><graphic xlink:href="13059_2021_2445_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par8">Once candidate <italic>Ks</italic> are determined, MultiK then performs a second step: label each cluster as either a <italic>class</italic> or <italic>subclass</italic> using Statistical Significance of Clustering (SigClust) [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>] (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>). MultiK first constructs a dendrogram of the cluster centroids using hierarchical clustering. Then, MultiK runs SigClust on each pair of terminal clusters. Significant terminal pairs in the dendrogram determine classes, and non-significant pairs are subclasses. For consistency of the whole dendrogram, when any split is significant, all parent splits are also considered to be significant. In this way, MultiK assigns class and subclass labels to each terminal cluster (i.e., the leaves of the dendrogram) based on the SigClust significance. This assessment of cluster significance, after deciding on the value of optimal <italic>K</italic>, helps elucidate the structural relationships between the identified clusters as well.</p>
    </sec>
    <sec id="Sec4">
      <title>Performance on a demonstration dataset</title>
      <p id="Par9">We used a dataset generated from a mixture of 3 cell lines grown in vitro [<xref ref-type="bibr" rid="CR27">27</xref>] to first evaluate MultiK’s performance. The 3 cell line mixture dataset consists of single cells from 3 distinct cell lines (human dermal fibroblasts-skin, breast cancer luminal epithelial cell line MCF-7, and breast cancer basal-like epithelial cell line MDA-MB-468) in a 1:3:6 ratio. The MultiK diagnostic plots (Fig. <xref rid="Fig2" ref-type="fig">2a–c</xref>) reveal that <italic>K</italic> = 3 and 7 are the optimal solutions. At the low-resolution level, MultiK identifies <italic>K</italic> = 3 classes, corresponding to the 3 cell lines (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1a and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). At the high-resolution level, MultiK finds <italic>K</italic> = 7, with 4 classes, one of which has 4 subclasses (Fig. <xref rid="Fig2" ref-type="fig">2d, e</xref>). Further differential gene expression analysis (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1b and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1) reveals that the four classes are fibroblast (COL1A1, VIM), luminal (GATA3, AREG), basal (KRT7, KRT17), and basal/claudin-low; among the 4 subclasses, 3 are basal cell line groups that reflect different phases of cell cycle, and the last one is the typical basal cell line feature group.
<fig id="Fig2"><label>Fig. 2</label><caption><p>MultiK identified <italic>K</italic> = 3 and 7 as optimal in the 3 cell line mixture dataset. <bold>a</bold> Bar plot of the frequency of runs for each <italic>K</italic> across a total of 4000 subsampling runs. The numbers above each vertical bar represent the frequency of runs. The dotted line is the frequency 100 threshold. <bold>b</bold> Plot of relative PAC score for each <italic>K</italic>. The <italic>X</italic>-axis represents <italic>K</italic>. The <italic>Y</italic>-axis represents the relative PAC score. <bold>c</bold> Scatterplot of (1 - rPAC) and the frequency of <italic>K</italic>. Each dot represents a level of <italic>K</italic> from <bold>a</bold> and <bold>b</bold>. The thin dotted line connects each <italic>K</italic> to show the ordering. The fat solid line connects the candidates for optimal <italic>K</italic>. <bold>d</bold>, <bold>e</bold> Left is 2-d UMAP plot of the Louvain clustering from Seurat (version 3.1.2) on the full data matrix at the suggested candidate <italic>K</italic> level. Each dot represents a single cell and each color represents a cluster at a given <italic>K</italic> level. Right is the pairwise SigClust result mapped onto the cluster mean dendrogram at suggested candidate <italic>K</italic> levels. Closed circles on the nodes indicate significant SigClust <italic>p</italic> values (&lt; 0.05) suggesting a cluster is a class, whereas open circles on the nodes indicate non-significant SigClust <italic>p</italic> values (≥ 0.05) suggesting a cluster is a subclass. Fibro=fibroblast</p></caption><graphic xlink:href="13059_2021_2445_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec5">
      <title>Synthetic dataset experiments</title>
      <p id="Par10">To further validate our method, we carried out two sets of synthetic data set experiments (see the “Methods” section details). In the first method, we randomly took a group of luminal cells and knowingly perturbed a specific group of genes in the 3 cell line mixture data, thereby providing a true known gold standard fourth group. The amount of perturbation was done through either varying the Poisson parameter that was used to model the gene counts or varying the number of modified genes. The results from MultiK in the low-resolution space under each perturbation are shown in the Uniform Manifold Approximation and Projection (UMAP) plots in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2. The first row in this figure shows that when 1 is the Poisson parameter, 100 modified genes are needed for MultiK to identify the synthetic cluster as a subclass, and 350 modified genes are needed to identify it as a class. However, as the Poisson parameter increases to 2 (the second row), only 60 and 100 modified genes were needed to identify the synthetic cluster as a subclass and a class respectively by MultiK. And when the Poisson parameter increases to 4 (the third row), even fewer modified genes were needed to see the same phenomenon.</p>
      <p id="Par11">To benchmark MultiK, we considered three other methods: Seurat (the Louvain clustering at the default resolution parameter 0.8) [<xref ref-type="bibr" rid="CR28">28</xref>], SC3 [<xref ref-type="bibr" rid="CR20">20</xref>], and IKAP [<xref ref-type="bibr" rid="CR15">15</xref>]. Consistent with previous findings [<xref ref-type="bibr" rid="CR22">22</xref>], we found that SC3 overestimated the number of groups, and Seurat roughly corresponded with MultiK high-resolution but was less stable (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S2). Although IKAP produced similar results as MultiK low-resolution, it was not as sensitive as MultiK in that IKAP did not detect the synthetic group until a stronger signal was introduced, whereas MultiK was able to identify the synthetic group with a weaker signal (either fewer modified genes or lower Poisson parameter added to the data).</p>
      <p id="Par12">For the second set of synthetic experiments, we simulated 3 scRNA-seq datasets with known groups using Splatter package [<xref ref-type="bibr" rid="CR29">29</xref>], and then tested the performance of MultiK. The first dataset had 2 equal groups (with 500 cells in each group); the second dataset had 3 unequal groups (with group probabilities 0.1, 0.3, and 0.6); the third dataset had 5 equal groups (with 200 cells in each group). Visual inspection of PCA projections showed distinct separation of the simulated groups (left column in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3), except in the 5 equal group data set where 3 of the 5 groups were clustered together, which could be due to the number of PC projections being displayed here. As expected, in each dataset, MultiK successfully identified the expected number of groups in the low <italic>K</italic> space, and the cell labels perfectly matched the group labels (right columns in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3).</p>
    </sec>
    <sec id="Sec6">
      <title>Identification of rare cell populations</title>
      <p id="Par13">Detection of rare cell type has been a challenging and important task in scRNA-seq analysis. To specifically evaluate the sensitivity of MultiK in identifying rare cell populations, we performed another simulation experiment using our 3 cell line mixture dataset as follows: we systematically removed different percentages of the smallest group (fibroblast, present at 8%) in the 3 cell line mixture dataset and ran MultiK. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4a shows the number of clusters MultiK identified as a function of the percentage of the fibroblast cells in the total number of cells. MultiK accurately identified the rare cell population even when only 0.5% of the cells (<italic>N</italic> = 13) were fibroblasts. Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4b, c shows the MultiK diagnostic plots for 1% and 2% of the fibroblast cells. In all the cases tried, most of these were like the results in the 1% case, in which MultiK identified 3 and 7 as optimal <italic>K</italic>s, and when <italic>K</italic> = 3, the cell labels from MultiK perfectly matched the true cell labels.</p>
    </sec>
    <sec id="Sec7">
      <title>Application to normal mouse mammary gland datasets</title>
      <p id="Par14">To test whether MultiK can produce robust clustering solutions using complex tissue specimens, we performed MultiK on five normal mouse mammary gland datasets (see the “Methods” section for detailed dataset description and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3), and which also spanned two sequencing technologies. MultiK suggested <italic>K</italic> = 8 and 18 as optimal in the FVB3-mammary gland set (Fig. <xref rid="Fig3" ref-type="fig">3a–c</xref>). When <italic>K</italic> = 8, MultiK identified 8 clusters including 2 epithelial clusters (luminal [Cd24a, Krt8, Krt18] and basal cluster [Acta2, Krt14, Krt17]), 2 immune clusters (macrophage [Fcer1g, Cd68] and lymphocyte [Cd74]), 1 fibroblast cluster [Dcn, Col3a1], 1 endothelial cluster [Fabp4, Cldn5], 1 smooth muscle/pericyte cluster [Procr], and 1 neural cluster [Mpz, Mbp] (Fig. <xref rid="Fig3" ref-type="fig">3d</xref>). All clusters were assigned as classes except that the fibroblast cluster and the smooth muscle/pericyte cluster were assigned as subclasses. The similarity in their top differentially expressed genes between these two clusters is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5a and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S4. When <italic>K</italic> = 18, more classes and subclasses were identified (Fig. <xref rid="Fig3" ref-type="fig">3e</xref>). The luminal epithelial cluster was split into 2 classes: mature luminal and luminal progenitor. The basal epithelial cluster was also split into 2 classes: basal and myoepithelial. Additionally, MultiK found 5 fibroblast clusters, but only 3 were assigned to classes: one showing a typical fibroblast phenotype, another associated with cell stress sensing/apoptosis, and the third related to cell motility and migration. A similar finding was seen in the endothelial cells as well: 3 classes were identified from 4 endothelial groups, one showing typical endothelial features, another related to cell stress/apoptosis, and the third showing a lymphatic phenotype. The lymphocyte cluster was split into B and T cell clusters, but interestingly, they were assigned to subclasses (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5b).
<fig id="Fig3"><label>Fig. 3</label><caption><p>MultiK identified <italic>K</italic> = 8 and 18 as optimal in the FVB3-mammary dataset. <bold>a</bold> Bar plot of the frequency of runs for each <italic>K</italic> across a total of 4000 subsampling runs. The numbers above each vertical bar represent the frequency of runs. The dotted line is the frequency 100 threshold. <bold>b</bold> Plot of relative PAC score for each <italic>K</italic>. The <italic>X</italic>-axis represents <italic>K</italic>. The <italic>Y</italic>-axis represents the relative PAC score. <bold>c</bold> Scatterplot of (1 - rPAC) and the frequency of runs for each <italic>K</italic>. Each dot represents a level of <italic>K</italic> from <bold>a</bold> and <bold>b</bold>. The thin dotted line connects each <italic>K</italic> to show the ordering. The fat solid line connects the candidates for optimal <italic>K</italic>. <bold>d</bold>, <bold>e</bold> Left is 2-d UMAP plot of the Louvain clustering from Seurat (version 3.1.2) on the full data matrix at the suggested candidate <italic>K</italic> levels. Each dot represents a single cell and each color represents a cluster at a given <italic>K</italic> level. Right is the pairwise SigClust result mapped onto the cluster mean dendrogram at suggested candidate <italic>K</italic> levels. Closed circles on the nodes indicate significant SigClust <italic>p</italic> values (&lt; 0.05) suggesting a cluster is a class, whereas open circles on the nodes indicate non-significant SigClust <italic>p</italic> values (≥ 0.05) suggesting a cluster is a subclass. Fibro=fibroblast, Epi=epithelial, Endo=endothelial, SM=smooth muscle, Lum Pro=luminal progenitor, Mature Lum=mature luminal</p></caption><graphic xlink:href="13059_2021_2445_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par15">Next, we assessed the reproducibility (defined as an ability of a group to be found in multiple independent data sets) of these identified groups across datasets. We applied MultiK to the rest of the normal mouse mammary gland datasets and identified low <italic>K</italic> and high <italic>K</italic> solutions (related MultiK diagnostic plots are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6, and differentially expressed gene lists for each cluster are provided in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Tables S4-S8). Then, we performed gene set enrichment analysis [<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR31">31</xref>] in both the low-resolution and high-resolution spaces (see the “Methods” section details, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7a, b). A group was considered reproducible if it was present in at least 3 out of the 4 normal mouse mammary gland datasets tested. Using the FVB3-mammary dataset as a reference set, we found that all 8 groups in the low-resolution space were present in the other datasets except for the neural group, which was present in only 2 of the 4 datasets (Fig. <xref rid="Fig5" ref-type="fig">5a</xref>). The two subclasses (fibroblast and smooth muscle/pericytes) were also repeatedly identified in the other datasets. In the high-resolution space, 13 out of the 18 groups were reproducibly identified including 6 subclasses (2 fibroblast subclasses, 2 endothelial subclasses, and 2 lymphocyte subclasses) (Fig. <xref rid="Fig5" ref-type="fig">5b</xref>). Combining both low-resolution and high-resolution, we identified a total of 15 reproducible groups in the normal mouse mammary gland data (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S16).</p>
    </sec>
    <sec id="Sec8">
      <title>Application to human T cell datasets</title>
      <p id="Par16">Recent single-cell studies characterizing T cells by gene expression analyses have defined multiple known, and several novel, T cell subsets associated with response and resistance to immunotherapies [<xref ref-type="bibr" rid="CR32">32</xref>–<xref ref-type="bibr" rid="CR37">37</xref>]. However, the nomenclature used to characterize these T cell subsets and/or states varies across studies, and few if any did across study comparisons. Importantly, there is little consensus on the number and nature of these T cell groups across data sets, and how they might be validated in independent studies. To identify reproducible T cell groups, and further test the performance of MultiK, we collected 6 public human scRNA-seq T cell datasets spanning multiple cancer types and applied MultiK, together with gene set enrichment analysis (see the “Methods” section details, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S7c, d, S8, and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Tables S3, S9-S14). Because the Azizi et al. breast cancer dataset contained the largest number of cells (~27,000), we used it as our reference set and then compared it to the other 5 datasets. In the low-resolution space (<italic>K</italic> = 13), MultiK identified 6 reproducible T cell groups including 2 regulatory T cell groups (Treg 1, Treg 2), 1 CD8 T naïve group, 1 CD8 T effector memory (CD8 Tem 2), 1 CD8 T exhausted group (CD8 Tex), and 1 CD4 T naïve group (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). In the high-resolution space (<italic>K</italic> = 27), MultiK identified 6 additional reproducible groups including 3 CD8 T central memory subsets (CD8 Tcm 1.1, CD8 Tcm 1.2, CD8 Tcm 1.3), 1 CD8 T tissue-resident memory subset (CD8 Trm 2), and 2 CD4 follicular helper subsets (CD4 Tfh 1.2, CD4 Tfh 2.1) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S7d, S9); thus, in total, our MultiK analysis identified 12 groups (5 classes and 7 subclasses) of T cells as being present across multiple scRNA-seq data sets (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S17).</p>
      <p id="Par17">Multiple studies have provided evidence that many of these T cell subsets play crucial roles in modulating cancer immunosurveillance and are the key targets of modulation by immune checkpoint inhibition [<xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR38">38</xref>]. For example, two studies in patients with non-small cell lung cancer (NSCLC) and triple-negative breast cancer (TNBC) have described the presence of CD8 Trm cells expressing integrin αE (ITGAE, encoding CD103) [<xref ref-type="bibr" rid="CR32">32</xref>], and Savas et al. further found that the gene signature of the CD8 Trm subset significantly correlated with better survival in patients. Guo et al. [<xref ref-type="bibr" rid="CR33">33</xref>] found two subsets of Tregs in the lung tumor microenvironment, distinguished by high or low expression of tumor necrosis factor receptor superfamily member 9 (TNFRSF9, encoding 4-1BB); they showed that the activated tumor Treg subset (expressing high levels of immune checkpoints) was associated with poor prognosis in NSCLC, which was further supported by a recent independent study of bladder tumors [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
      <p id="Par18">To assess whether our newly derived reproducible T cell groups provide any prognostic value for predicting breast cancer patient outcomes, we developed gene expression signatures (see the “Methods” section) for each of the 12 reproducible T cell groups found here and applied these signatures to 5 breast cancer bulk tumor gene expression data sets, in which associated clinical information was available: the Molecular Taxonomy of Breast Cancer International Consortium (METABRIC) [<xref ref-type="bibr" rid="CR39">39</xref>], the Harrell 855 set [<xref ref-type="bibr" rid="CR40">40</xref>] (855 primary breast tumors combined from four public microarray studies), the Cancer Genome Atlas breast tumors (TCGA BRCA) [<xref ref-type="bibr" rid="CR41">41</xref>], the Sweden Cancerome Analysis Network-Breast (SCAN-B) [<xref ref-type="bibr" rid="CR42">42</xref>], and CALGB 40601 [<xref ref-type="bibr" rid="CR43">43</xref>] (a HER2+ neoadjuvant trial). To compare with our new T cell signatures, we also evaluated additional gene expression features including single gene expression values of MKI67, CD274 (PD-L1), ERBB2, and the expression signatures that are a B cell/T cell cooperation signature [<xref ref-type="bibr" rid="CR38">38</xref>], an Immunoglobulin G (IGG) signature [<xref ref-type="bibr" rid="CR44">44</xref>], and seven CIBERSORT LM22 T cell signatures [<xref ref-type="bibr" rid="CR45">45</xref>]. We performed the signature analysis on all data sets combined and then stratified into the 3 clinical groups (ER+HER2−, HER2+, and TNBC based on immunohistochemistry (IHC) status), thus creating 4 main data sets: (1) all samples from the METABRIC, Harrell 855, TCGA BRCA, and SCAN-B; (2) ER+HER2− samples from the METABRIC, Harrell 855, TCGA BRCA, and SCAN-B; (3) HER2+ samples from the Harrell 855, TCGA BRCA, SCAN-B, and CALGB 40601; (4) TNBC samples from the METABRIC, Harrell 855, TCGA BRCA, and SCAN-B. We also performed the analysis on each data set individually, on all patients as well as within stratified clinical groups.</p>
      <p id="Par19">We found that 6 out of the 12 repeatedly identifiable T cell signatures identified from MultiK were significantly associated with improved overall survival in at least three of the combined sets (Fig. <xref rid="Fig6" ref-type="fig">6</xref>): Treg 1, CD8 Tem 2, CD4 naïve, and CD8 naïve were significant in all 4 sets; CD8 Tcm 1.1 and CD8 Tcm 1.3 were significant in all the combined sets except for the ER+HER2− set. In particular, we found that the CD4 T naïve signature was significantly associated with overall survival in all sets, supporting previous evidence for a role of intra-tumoral CD4 T cells from both mouse and human studies [<xref ref-type="bibr" rid="CR46">46</xref>, <xref ref-type="bibr" rid="CR47">47</xref>]. We also found that the two CD4 T follicular helper subsets significantly correlated with survival in TNBC samples, which was in line with previous findings from our group that CD4 T follicular helper cells mediate immune checkpoint response using mouse models of TNBC [<xref ref-type="bibr" rid="CR38">38</xref>]. Furthermore, consistent with the previous finding that the CD8 Trm signature associated with good prognosis in TNBC [<xref ref-type="bibr" rid="CR32">32</xref>], we found that our CD8T resident memory signature was significant in the HER2+ and TNBC sets. Next, we found that one of the Treg signatures was significantly correlated with overall survival in all 4 sets, but the other Treg signature was only significant in the HER2+ and TNBC sets, suggesting that different Treg subsets may play different roles in breast cancer subtypes. Lastly, in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10, we show the results of similar analyses, but performed on each individual data set according to clinical receptor subtypes.</p>
    </sec>
    <sec id="Sec9">
      <title>Discussion</title>
      <p id="Par20">scRNA-seq is a powerful new approach for studying the transcriptomes of cell lines, tissues, tumors, and diseased states. It is being widely used to identify what are often claimed to be novel cell types; however, the analysis methods are typically complex, and the user is often simply given a visual representation of the data with no assessment of the robustness of the groupings. That is, there is no data-driven guidance on how many cell populations/types are present. To address this need, we developed MultiK, an automated “multi-resolution” approach that objectively selects multiple insightful numbers of clusters (<italic>K</italic>) in scRNA-seq data. We demonstrated that MultiK successfully identified <italic>K</italic> in a ground truth dataset and was sensitive in the identification of classes and subclasses in a synthetic “spike in” experiment as well as additional simulated datasets. We further applied MultiK to identify reproducible groups in complex tissue datasets, including mouse mammary glands and multiple T cell data sets. In both cases, we identified most of the previously known subsets/cell populations and did so without any prior biological knowledge of true clusters present in the data.</p>
      <p id="Par21">Given the diversity and abundance of scRNA-seq data available in the public domain, we also observed that MultiK is robust to different single-cell sequencing technologies. For example, in our real dataset applications (both mouse mammary gland and human T cell datasets), three of which were Smart-seq2 and the rest were 10X genomics sequencing technologies (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3), we found the same reproducible groups across both platforms in our presented studies. Specifically, in the mouse mammary gland case, we found 6/7 reproducible groups on both 10X and Smart-seq2 platforms in the low <italic>K</italic> space, and all 8 reproducible groups on both platforms in the high <italic>K</italic> space (Fig. <xref rid="Fig4" ref-type="fig">4</xref>, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S15-16). In the human T cell case, all the reproducible groups were detected by both platforms in both low <italic>K</italic> and high <italic>K</italic> space (Fig. <xref rid="Fig5" ref-type="fig">5</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S7c, d, S9, Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Tables S15, S17).
<fig id="Fig4"><label>Fig. 4</label><caption><p>MultiK identified robust and reproducible groups across five mouse mammary gland datasets via gene set enrichment analysis. Using the FVB3-mammary dataset as reference, gene set analysis across datasets in both low-resolution (<bold>a</bold>) and high-resolution (<bold>b</bold>) space after applying MultiK. In each panel, left is a dendrogram constructed from the cluster means in the FVB3-mammary dataset. Closed circles on the nodes indicate significant SigClust <italic>p</italic> values (&lt; 0.05) suggesting a cluster is a class, whereas open circles on the nodes indicate non-significant SigClust <italic>p</italic> values (≥ 0.05) suggesting a cluster is a subclass. Right is a heatmap showing the presence (colored black) or absence (colored gray) of each FVB3-mammary group in the other datasets. The reproducible groups are highlighted with asterisks at the end of each row in the heatmap</p></caption><graphic xlink:href="13059_2021_2445_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>MultiK identified robust and reproducible groups in the low-resolution space across six human T cell datasets via gene set enrichment analysis. <bold>a</bold> 2-d UMAP plot of the clusters at low-resolution (<italic>K</italic> = 13) in the Azizi et al. dataset. Each dot represents a single cell and each color presents a cluster. <bold>b</bold> Heatmap of reproducible T cell groups found in the other dataset using gene set enrichment analysis. Left is a dendrogram constructed from the 13 cluster means in the Azizi et al. dataset. Closed circles on the nodes indicate significant SigClust <italic>p</italic> values (&lt; 0.05) suggesting a cluster is a class, whereas open circles on the nodes indicate non-significant SigClust <italic>p</italic> values (≥0.05) suggesting a cluster is a subclass. Right is a heatmap showing the presence (colored black) or absence (colored gray) of each Azizi et al. group in the other datasets. The reproducible groups are highlighted with asterisks at the end of each row in the heatmap</p></caption><graphic xlink:href="13059_2021_2445_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par22">Our proposed tool has several merits. First, to our best knowledge, this is the first tool that provides guidance on a multi-scale choice of <italic>K</italic> in scRNA-seq data. There are a number of sophisticated clustering and visualization tools developed in the single cell domain, including BackSPIN [<xref ref-type="bibr" rid="CR48">48</xref>], SCCAF [<xref ref-type="bibr" rid="CR49">49</xref>], and scGNN [<xref ref-type="bibr" rid="CR50">50</xref>]. However, none of these methods suggests what is the optimal number(s) of clusters/groups present in the data. The choice of <italic>K</italic> often relies on the scientist to eyeball how many “groups” they think are present. The main contribution of our study is to go beyond this previous work that focused on clustering and the goal of MultiK is to provide an objective assessment of <italic>K</italic>. Importantly, MultiK benefits most clustering methods because many methods may need an input value of <italic>K</italic> to even begin a clustering analysis. In these cases, we recommend running MultiK first, which will give a rigorous choice of <italic>K</italic> for use as input to any preferred clustering method of interest that could be run next. For methods that do not need an input choice of <italic>K</italic>, but which do not provide outputs on the optimal <italic>K</italic>, MultiK provides such a data-driven suggestion for optimal <italic>K</italic> in both the low-resolution space and high-resolution space. Other tools such as Clustree, TooManyCells, and scClustViz serve as visualization tools for exploring clusters at different clustering resolutions in scRNA-seq data, but they do not provide data-driven guidance on the choice of <italic>K</italic>. While IKAP informs <italic>K</italic> by setting an initial <italic>K</italic><sub><italic>max</italic></sub> and iteratively merging the 2 nearest clusters to obtain optimal <italic>K</italic> assessed by the GAP statistic, it is a single resolution approach and thus only selects a single option. It is clear from our multi-scale approach, that suggested <italic>K</italic>s at multiple levels of resolution are both biologically helpful, and objectively derived from the data. Next, MultiK can identify robust clustering patterns or structures that are sensitive to relatively weak signals and produce consistent and stable clustering across datasets and across scRNA-seq platforms. Lastly, MultiK can investigate the structural relationships between the clusters after the optimal <italic>K</italic> is chosen. Further assignment of classes and subclasses provides biological insights and interpretation of the clustering structure in the data.</p>
      <p id="Par23">We benchmarked the performance of MultiK against several alternatives including IKAP, SC3, and Seurat (default resolution parameter 0.8) in a synthetic experiment and demonstrated that MultiK gave sensitive and stable identification of classes and subclasses relative to other methods. To further demonstrate MultiK’s ability in finding reproducible clusters, we applied MultiK to multiple complex tissue datasets in both mouse and human. We showed that MultiK identified most of the known groups in normal mouse mammary glands, providing biological validation of the useful application of MultiK. In the human T cell case, MultiK identified a total of 12 reproducible T cell subsets spanning 6 different data sets that represent multiple cancer types. Moreover, consistent with previous findings [<xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR37">37</xref>], some of these reproducible T cell signatures showed prognostic values in predicting breast cancer patient’s survival. These T cell data set findings are especially important because as seen in the literature, most previous analyses likely overestimated the number of reproducible T cell subsets in the tumor immune microenvironment, which may lead to irreproducible findings across studies.</p>
      <p id="Par24">Despite the advantages of MultiK, we note two limitations to our method. First, our approach estimates <italic>K</italic> based on repeatedly perturbing the original data via subsampling. Small, rare clusters may not be detected due to random sampling variation, and it is possible that the sampled distribution may differ significantly from the null distribution; however, in our rare cell populations analyses where we intentionally created a rare group, we were able to detect this rare group down to the 0.5% level. Second, MultiK is computationally expensive for large datasets in large part due to the 100-fold subsampling and reclustering; however, multi-core ability and parallel computing can mitigate this problem.</p>
      <p id="Par25">In summary, we demonstrate that MultiK provides a novel tool that finds meaningful multi-resolution optimal cluster numbers, so-called <italic>K</italic>, in scRNA-seq data and provides stable clustering solutions across datasets. In addition, it is worth noting that the concept of MultiK is applicable beyond scRNA-seq data. In the future, MultiK can also be tailored and extended to other data types, such as scATACseq and mass cytometry data.</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Datasets</title>
      <p id="Par26">We used 12 scRNA-seq datasets to benchmark our method (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3). The first dataset was a 3 cell line mixture generated in our lab [<xref ref-type="bibr" rid="CR27">27</xref>]; for this dataset, we have two pieces of information providing ground truth cell identities: (1) the mixing ratio of the cell lines (1:3:6) and (2) SNPs discovered from bulk RNA-seq data unique to each cell line. The second, third, and fourth datasets were derived from normal adult whole mouse mammary glands of 2 mouse strains with different genetic backgrounds (FVB/NJ mouse strain: FVB3-mammary, FVB4-mammary, and Balbc mouse strain: Balbc-mammary). The exact cell labels in these datasets were unknown; however, we can use biological knowledge to determine the cell types as this normal tissue type has been well studied [<xref ref-type="bibr" rid="CR51">51</xref>–<xref ref-type="bibr" rid="CR56">56</xref>]. The fifth and sixth datasets were normal adult mouse mammary gland datasets of C57BL/6 mouse strain from the Tabula Muris consortium [<xref ref-type="bibr" rid="CR57">57</xref>] (referred to as TM 10X-mammary and TM Smartseq-mammary, respectively). The rest of the datasets (sets 7–12) were human T lymphocyte datasets from various cancer cohorts: 2 in breast cancer [<xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR35">35</xref>], 1 in lung cancer [<xref ref-type="bibr" rid="CR33">33</xref>], 1 in liver cancer [<xref ref-type="bibr" rid="CR34">34</xref>], 1 in colorectal cancer [<xref ref-type="bibr" rid="CR36">36</xref>], and 1 in bladder cancer [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
    </sec>
    <sec id="Sec12">
      <title>Data preprocessing</title>
      <p id="Par27">For the mixture of 3 human cell lines and the normal mouse mammary gland datasets, genes that have zero count in all cells were discarded. Cells were removed if the number of total counts or the number of detected genes (count larger than zero) or the proportion of expressed mitochondrial genes was larger or smaller than the pre-defined thresholds, which were the medians of all cells ± 3 × median absolute deviation. That filtering should remove likely cell doublets or multiplets and low-quality cells, respectively.</p>
      <p id="Par28">For T cell datasets, we first developed a “T cell bioinformatics sorting rule” to systematically extract T cells from each individual dataset before clustering to make sure each dataset was preprocessed in a similar manner. Specifically, we used the raw count gene expression of three T cell markers: CD3D, CD3E, and CD3G to select cells that have nonzero counts in at least 2 of the 3 markers. These cells were then filtered as done for the mixture of 3 cell lines and the normal mouse mammary gland datasets.</p>
    </sec>
    <sec id="Sec13">
      <title>MultiK details</title>
      <p id="Par29">MultiK is built on top of Seurat (version 3.1.2) [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR58">58</xref>] in R (version 3.5.2). First, MultiK takes a gene expression matrix as input, in which cells are the columns and genes are the rows. Each entry of the input matrix corresponds to the expression of a gene in each cell. MultiK subsamples 80% of the cells from the input preprocessed data matrix and applies the standard Seurat pipeline on the subsampled data matrix 100 times over 40 resolution parameters (from 0.05 to 2.00 with step size 0.05; thus, 4000 subsampling runs in total: 40 resolution parameters × 100 subsamples). The standard Seurat pipeline includes normalization, feature selection, PCA dimension reduction, and clustering via the Louvain algorithm [<xref ref-type="bibr" rid="CR59">59</xref>]. Specifically, library size normalization is applied to the preprocessed matrix. This is done by taking each entry of the filtered matrix, dividing it by the total number of counts per cell, multiplying it by a scale factor of 10,000, and taking a log transformation. To identify highly variable genes, MultiK applies the variance stabilizing transformation (“vst”) method in the Seurat package and selects 2000 features for downstream clustering. Then, prior to dimension reduction, each gene is scaled to have mean 0 and variance 1 across cells. MultiK performs PCA dimension reduction on the scaled data with the previously selected variable features. To cluster the cells, MultiK first constructs a K-nearest neighbor graph (default 20 nearest neighbors, same as implemented in Seurat) in the first 30 PCs space. Then, the edge weights are refined based on the shared overlap in their local neighborhoods using the Jaccard similarity measure. The Louvain algorithm [<xref ref-type="bibr" rid="CR59">59</xref>] is applied to iteratively cluster cells together.</p>
      <p id="Par30">For each candidate <italic>K</italic>, MultiK computes two evaluation metrics: (1) the frequency of each <italic>K</italic> solution across the 4000 clustering runs and (2) a score called the “relative Proportion of Ambiguous Clustering” (rPAC), which is an improvement of PAC [<xref ref-type="bibr" rid="CR23">23</xref>]. To compute rPAC, MultiK first aggregates all the clustering runs that result in the same <italic>K</italic> across all the resolution parameters, and calculates a consensus matrix for each <italic>K</italic>, which is defined as “the proportion of clustering runs in which two samples are grouped together” [<xref ref-type="bibr" rid="CR18">18</xref>]. Then, MultiK computes the Cumulative Distribution Function (CDF) curve for each consensus matrix. From the CDF, MultiK calculates the rPAC score for each <italic>K</italic> using the following formula:</p>
      <p id="Par31"><inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{r}{\mathrm{PAC}}_k\left({\mu}_1,{\mu}_2\right)=\frac{{\mathrm{CDF}}_k\left({\mu}_2\right)-{\mathrm{CDF}}_k\left({\mu}_1\right)}{{\mathrm{CDF}}_k(0)} $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">r</mml:mi><mml:msub><mml:mi>PAC</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=","><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>CDF</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>μ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced><mml:mo>−</mml:mo><mml:msub><mml:mi>CDF</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>μ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mi>CDF</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2021_2445_Article_IEq1.gif"/></alternatives></inline-formula>, where (<italic>μ</italic><sub>1</sub>, <italic>μ</italic><sub>2</sub>) ∈ [0, 1], and <italic>μ</italic><sub>1</sub> and <italic>μ</italic><sub>2</sub> are usually chosen close to 0 and 1, respectively (such as 0.1 and 0.9).</p>
    </sec>
    <sec id="Sec14">
      <title>MultiK parameter setting</title>
      <p id="Par32">Different parameter settings impact the estimation of cluster number and clustering. Through exploration of the resolution parameter space, we found that a range from 0.05 to 2 was sufficient to capture the structure and substructure within the data, and therefore set it as the default in MultiK. In addition, we explored how the number of PCs affects clustering, knowing that a more heterogeneous dataset may need more PCs to discover different diverse cell types/subtypes. We noticed that there was a trade-off between an increase in the number of PCs and loss of stability in clustering: a small number of PCs did not provide enough dimensions to capture the real clustering structure in the lower dimensional space; a large number of PCs may introduce more noise, resulting in discovering unstable clusters. Our exploratory analysis suggested 30 PCs kept a good balance between capturing clustering structure and introducing noise, and thus is the default in MultiK.</p>
    </sec>
    <sec id="Sec15">
      <title>SigClust analysis</title>
      <p id="Par33">Once a candidate <italic>K</italic> was selected, we used SigClust [<xref ref-type="bibr" rid="CR26">26</xref>] to assess the significance of individual clusters. SigClust was performed on every possible pair of clusters at a given candidate <italic>K</italic> using the cluster labels as cluster assignments, and a <italic>p</italic> value was calculated for each pair. We used the sample covariance estimates in SigClust due to the sparsity of the input data matrix (the median is zero) since the sample covariance estimate is conservative for fitting the null Gaussian.</p>
      <p id="Par34">To visualize the pairwise SigClust results, we first calculated the cluster mean for each cluster using the 2000 selected highly variable genes and then ran hierarchical clustering on the cluster means (Euclidean distance, and complete linkage) using the hc() function in R (version 3.5.2). Then, we mapped the SigClust <italic>p</italic> values onto the cluster mean dendrogram, according to the rules as follows: (1) a node is significant (<italic>p</italic> value &lt; 0.05) if at least one pair is significant; (2) a parental node is significant if any of its children nodes is significant. We further assigned <italic>class</italic> and <italic>subclass</italic> to each individual cluster (i.e., the leaves of the dendrogram) based on the node significance. We defined a cluster to be a <italic>class</italic> if all the nodes that split the cluster are significant, and a cluster to be a <italic>subclass</italic> if one of the nodes that split the cluster is non-significant.</p>
    </sec>
    <sec id="Sec16">
      <title>Synthetic experiment</title>
      <p id="Par35">We randomly sampled 30% of the luminal cells (<italic>N</italic> = 162) and modified various numbers of genes (20, 30, 60, 100, 350) for these 162 cells by replacing their original gene counts with counts modeled by a Poisson distribution at various parameters (<italic>λ</italic> = 1, 2, 4). The counts generated by the Poisson process were performed using the rpois() function in R (version 3.5.2). In total, we generated 15 synthetic datasets from different combinations of Poisson parameters and numbers of modified genes and applied MultiK and other methods to these datasets. The rationale for generating such synthetic datasets using the approach described above are as follows: (i) It is difficult to simulate scRNA-seq data that mimics real-world data. Thus, we took real-world data and systematically modified just a small part of this, leaving the real-world data structure largely untouched. (ii) We already have a 3 cell line mixture dataset, in which the cell identities are known, thus providing a ground truth dataset for us to compare the performance of different methods. A simple way to augment the data is to introduce a synthetic cluster/group of cells by adding in some signals to the original data. (iii) We chose to modify the gene counts by fitting a Poisson distribution with various Poisson parameters, and this allowed us to see the impact of the signal that we purposely added in the data. It also allowed us to identify the contexts where the synthetic cluster can be identified as a class or a subclass. The reason why we chose to use a Poisson distribution is that multiple recent studies have shown that UMI count scRNA-seq data is not significantly zero-inflated and any observed zero-inflation is likely driven by the cell-type heterogeneity and biological variation [<xref ref-type="bibr" rid="CR60">60</xref>, <xref ref-type="bibr" rid="CR61">61</xref>]. Particularly, Kim et al. [<xref ref-type="bibr" rid="CR61">61</xref>] observed that the majority of the genes fit the expected Poisson curve in a homogeneous cell population, and their results strongly suggested that it is unnecessary to model any zero counts using a zero-inflated distribution. Inspired by that, we think it is appropriate to use a simple Poisson distribution to modify a small subset of genes in a subset of luminal cells in our 3 cell line mixture dataset.</p>
    </sec>
    <sec id="Sec17">
      <title>Additional synthetic datasets</title>
      <p id="Par36">We generated 3 simulated scRNA-seq datasets using the “group” method in splatSimulate() function from R/Splatter package [<xref ref-type="bibr" rid="CR29">29</xref>]. Each dataset was simulated to contain 5000 genes and 1000 cells. The first dataset had 2 equal groups (with 500 cells in each group); the second dataset had 3 unequal groups (with group probabilities 0.1, 0.3, and 0.6); the third dataset had 5 equal groups (with 200 cells in each group). The code for generating the simulated datasets can be found in Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/siyao-liu/MultiK">https://github.com/siyao-liu/MultiK</ext-link> [<xref ref-type="bibr" rid="CR62">62</xref>].</p>
    </sec>
    <sec id="Sec18">
      <title>Benchmarked methods</title>
      <p id="Par37">We benchmarked different methods including Seurat version 3.1.2 [<xref ref-type="bibr" rid="CR58">58</xref>], SC3 [<xref ref-type="bibr" rid="CR20">20</xref>], IKAP [<xref ref-type="bibr" rid="CR15">15</xref>], and MultiK in terms of their performance in estimating the number of clusters in the synthetic experiment datasets. All methods were implemented following their guided tutorials (<ext-link ext-link-type="uri" xlink:href="https://satijalab.org/seurat/v3.1/pbmc3k_tutorial.html">https://satijalab.org/seurat/v3.1/pbmc3k_tutorial.html</ext-link>, <ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/release/bioc/vignettes/SC3/inst/doc/SC3.html">http://bioconductor.org/packages/release/bioc/vignettes/SC3/inst/doc/SC3.html</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/NHLBI-BCB/IKAP">https://github.com/NHLBI-BCB/IKAP</ext-link>). Default parameters were used everywhere.</p>
    </sec>
    <sec id="Sec19">
      <title>Differential expression analysis</title>
      <p id="Par38">In all cases, we performed differential expression analysis on all genes that met the following criteria: (1) nonzero count in a minimum of 10% of the cells in either of the tested groups; (2) positive difference in the first tested group (i.e., genes are more highly expressed). We then applied the Wilcoxon rank-sum test to cells assigned to a cluster vs. all other cells. To identify significant differences, we considered genes with a Bonferroni-corrected <italic>p</italic> value ≤ 0.05 as significant genes that define a cluster.</p>
    </sec>
    <sec id="Sec20">
      <title>Gene set enrichment analysis and deriving reproducible groups across sets</title>
      <p id="Par39">We performed gene set enrichment analysis using R/GSA version 1.03.1 package [<xref ref-type="bibr" rid="CR31">31</xref>]. We used the gene sets (top 200 positive/upregulated defining gene lists for each cluster, ranked by Bonferroni-corrected <italic>p</italic> values from lowest to highest) derived from the reference dataset and tested their enrichment in each cluster in the other datasets. For example, for the mammary gland datasets, the gene sets were developed from each cluster in both low- (<italic>K</italic> = 8) and high- (<italic>K</italic> = 18) resolution space in the FVB3 mammary gland dataset and applied to each cluster identified from the low- and high-resolution space in the FVB4 mammary gland (<italic>K</italic> = 9, 18), Balbc mammary gland (<italic>K</italic> = 10, 13), TM 10X (<italic>K</italic> = 15 used in both low and high <italic>K</italic> space), and TM Smartseq (<italic>K</italic> = 9, 18) datasets, respectively. The rule for selecting <italic>K</italic> in the low and high <italic>K</italic> space was the following: for datasets in which MultiK identified a single optimal <italic>K</italic> solution, the single optimal <italic>K</italic> was used in both low- and high-resolution analysis; for datasets in which MultiK identified 3 optimal <italic>K</italic> solutions, the lowest <italic>K</italic> was used in the low-resolution analysis; if the second lowest <italic>K</italic> was more than 2 above the lowest <italic>K</italic>, then the second lowest <italic>K</italic> was used in the high-resolution analysis; otherwise, the highest <italic>K</italic> was used in the high-resolution analysis.</p>
      <p id="Par40">A GSA score for each gene set in a cluster and its associated adjusted <italic>p</italic> value were calculated from 100 permutation runs. We considered a GSA score above a threshold (0.75 in the normal mouse mammary gland datasets and 0.6 in the T cell datasets) as highly enriched and used that threshold to identify common groups that were present in multiple datasets (related figures are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9).</p>
    </sec>
    <sec id="Sec21">
      <title>Survival analysis</title>
      <p id="Par41">The METABRIC [<xref ref-type="bibr" rid="CR39">39</xref>], Harrell 855 set [<xref ref-type="bibr" rid="CR40">40</xref>], TCGA BRCA [<xref ref-type="bibr" rid="CR41">41</xref>], SCAN-B [<xref ref-type="bibr" rid="CR42">42</xref>], and CALGB40601 [<xref ref-type="bibr" rid="CR43">43</xref>] gene expression data were used to evaluate the prognostic value of the gene signatures derived from the reproducible T cell groups (Fig. <xref rid="Fig6" ref-type="fig">6</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9). For CALGB40601, only the pretreated samples (<italic>N</italic> = 264) were used in the analysis. All gene expression data were filtered to genes that were expressed in over 70% of the samples, upper-quartile normalized and log2 transformed prior to the survival analysis. In each dataset, samples were classified into 3 clinical groups (ER+HER2−, HER2+, and TNBC) based on the clinical ER, PR, and HER2 IHC status. To make the clinical data comparable across datasets, the follow-up time was censored to 3000 days in all datasets. Overall survival was used in all datasets, except for the Harrell 855 set, where the metastasis-free survival was used (because the overall survival data was missing in that dataset). In the combined analysis, the “all” set (<italic>N</italic> = 6909) contained all patients from the METABRIC, Harrell 855, TCGA BRCA, and SCAN-B datasets; the “ER+HER2-” set (<italic>N</italic> = 4560) contained the ER+HER2− patients from the METABRIC, Harrell 855, TCGA BRCA, and SCAN-B datasets; the “HER2+” set (<italic>N</italic> = 921) contained HER2+ patients from the Harrell 855, TCGA BRCA, SCAN-B, and CALGB 40601 datasets (note that the HER2+ patients from the METABRIC dataset were excluded as the HER2+ patients in the METABRIC cohort did not get the trastuzumab treatment while the other sets did); the “TNBC” set (<italic>N</italic> = 733) contained the TNBC patients from the METABRIC, Harrell 855, TCGA BRCA, and SCAN-B datasets.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Survival analysis showed the prognostic effect of MultiK derived reproducible T cell gene signatures compared to other T cell signatures as well as single gene expression (indicated on the <italic>Y</italic>-axis) in external breast cancer datasets. Forest plots show hazard ratio (circles) and 95% confidence intervals (horizontal ranges) derived from the Cox proportional hazards model for overall survival in univariate analysis. Red indicates significant hazard ratio estimate (<italic>p</italic> value &lt; 0.05) whereas blue indicates non-significant estimate (<italic>p</italic> value ≥ 0.05). The first two vertical panels show results from combining all patients (first panel) and ER+HER2− patients (second panel) from the METABRIC, Harrell 855, TCGA BRCA, and SCAN-B datasets. The third vertical panel shows results from combining HER2+ patients from the Harrell 855, TCGA BRCA, SCAN-B, and CALGB40601 datasets. The fourth vertical panel shows results from combining TNBC patients from the METABRIC, Harrell 855, TCGA BRCA, and SCAN-B datasets</p></caption><graphic xlink:href="13059_2021_2445_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par42">The mean expression of genes in each signature was calculated for each sample in each dataset. In the combined analysis, the mean expression of signature was further median centered within each dataset to correct for the batch effect. To determine the statistical significance, we performed univariate analysis using a Cox proportional hazards model implemented in the R/survival package by fitting the gene signature as a continuous variable. For the T cell signatures developed from this study, we identified the top 50 positive/upregulated genes for each reproducible group (genes that were significantly upregulated in the cluster as compared with other clusters with FDR &lt; 5%) in the Azizi et al. dataset.</p>
    </sec>
    <sec id="Sec22">
      <title>Tissue processing of Balbc mammary gland and 10X chromium 3’ gene expression single-cell RNA-seq library construction and alignment</title>
      <p id="Par43">The Balbc mammary gland was harvested at 12 weeks of age and placed in 10 ml of a digestion medium containing EpiCult™-B Mouse Medium Kit (#05610, StemCell Technologies), Collagenase/Hyaluronidase (#07912, StemCell Technologies), and 1% penicillin-streptomycin (Gibco). The mammary gland was digested overnight in a thermocycler maintained at 37°C with continuous rotation. The cell pellets retrieved from these suspensions were treated with a 1:4 solution of Hanks balanced salt solution (HBSS) (Gibco) and ammonium chloride to remove the red blood cells (RBCs). After RBC removal, the cell suspensions were trypsinized with 0.05% Trypsin (Gibco) and a mix of Dispase (Stem Cell Technologies) and DNAse (Stem Cell Technologies). A portion of this cell suspension was stained with trypan blue and counted using the Countess Automated Cell Counter (Invitrogen). Based on the counting, the cells were diluted to the appropriate cell stock concentration for running on the 10X Chromium machine.</p>
      <p id="Par44">The cell suspensions were loaded on a 10X Genomics Chromium instrument to generate single-cell gel beads in emulsion (GEMs) for targeted retrieval of approximately 10,000 cells. Single-cell RNA-seq libraries were prepared using the following Single Cell 3’ Reagent Kits v3: Chromium™ Single Cell 3’ Library &amp; Gel Bead Kit v3, PN-1000092; Single Cell 3’ Chip B Kit PN-1000074 and i7 Multiplex Kit PN-120262 (10X Genomics) and following the Single Cell 3’ Reagent Kits v3 User Guide (CG000183_ChromiumSingleCell3'_v3_UG_RevB). Libraries were run on an Illumina HiSeq 4000 as 2 × 150 paired-end reads. The Cell Ranger Single Cell Software Suite, version 3.1, was used to perform sample de-multiplexing, barcode and UMI processing, and single-cell 3′ gene counting. A detailed description of the pipeline and specific instructions to run it can be found at https://support.10X genomics.com/single-cell-gene-expression/software/pipelines/latest/installation. All generated fastqs were aligned to mouse (mm10) genome references contained within the Cell Ranger software.</p>
    </sec>
    <sec id="Sec23" sec-type="data-availability">
      <title>Availability of data and materials</title>
      <p id="Par45">The mixture of 3 cell lines and the FVB3-mammary, FVB4-mammary datasets are available from GEO: GSE136148 [<xref ref-type="bibr" rid="CR27">27</xref>]. The Balbc-mammary dataset is published in this study (GEO: GSE165336) [<xref ref-type="bibr" rid="CR63">63</xref>]. The TM 10X-mammary and TM Smartseq-mammary datasets were downloaded from the Tabula Muris Consortium website [<xref ref-type="bibr" rid="CR57">57</xref>]. All the T cell datasets were downloaded from GEO (detailed GEO ID are provided in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3) [<xref ref-type="bibr" rid="CR32">32</xref>–<xref ref-type="bibr" rid="CR35">35</xref>, <xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR64">64</xref>]. Note, only the 10X genomics data (from breast cancer patient samples 9, 10, and 11) in the Azizi et al. [<xref ref-type="bibr" rid="CR35">35</xref>] paper were used in our study. In addition, the Oh et al. [<xref ref-type="bibr" rid="CR37">37</xref>] bladder dataset has both treated and untreated cells, and we studied only the untreated cells to be consistent with the other datasets.</p>
      <p id="Par46">External validation datasets: The METABRIC dataset was obtained from the European Genome-Phenome Archive (accession number: EGAS00000000083) and clinical information from the original publication [<xref ref-type="bibr" rid="CR39">39</xref>]. The Harrell 855 human breast tumor microarray data and the clinical data were downloaded from the Harrell et al. paper [<xref ref-type="bibr" rid="CR40">40</xref>]. The TCGA BRCA gene expression data were downloaded from the Broad Institute TCGA GDAC Firehose (<ext-link ext-link-type="uri" xlink:href="https://gdac.broadinstitute.org/">https://gdac.broadinstitute.org/</ext-link>), and the clinical data were downloaded from the Genomic Data Commons Data portal (<ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov/projects/TCGA-BRCA">https://portal.gdc.cancer.gov/projects/TCGA-BRCA</ext-link>). The clinical trial CALGB40601 gene expression data were downloaded from GEO: GSE116335 and dbGAP study accession phs001570.v2.p [<xref ref-type="bibr" rid="CR65">65</xref>]. All datasets were normalized and log2 transformed prior to the gene signature analysis.</p>
      <p id="Par47">The MultiK software is implemented in R package and is freely available under the MIT license on Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/siyao-liu/MultiK">https://github.com/siyao-liu/MultiK</ext-link> [<xref ref-type="bibr" rid="CR62">62</xref>], and deposited in Zenodo: 10.5281/zenodo.5138967 [<xref ref-type="bibr" rid="CR66">66</xref>].</p>
      <p id="Par48">The Poisson modified synthetic data sets and the code to generate the simulated datasets have been deposited in Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/siyao-liu/MultiK">https://github.com/siyao-liu/MultiK</ext-link> [<xref ref-type="bibr" rid="CR62">62</xref>] and Zenodo: 10.5281/zenodo.5138967 [<xref ref-type="bibr" rid="CR66">66</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec24">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2021_2445_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1:.</bold> Supplementary figures</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2021_2445_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2:.</bold> Supplementary tables</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2021_2445_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 3:.</bold> Review history</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank the reviewers and the handling editors for their constructive feedback.</p>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par49">Barbara Cheifet was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="FPar2">
      <title>Review history</title>
      <p id="Par50">The review history is available as Additional file <xref rid="MOESM3" ref-type="media">3</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>C.M.P. and J.S.M. coordinated the overall studies. S.L. performed the statistical analyses. S.L., C.M.P., and J.S.M. developed the statistical methodologies. A.T. and J.G. conducted the 3 cell line and mouse mammary gland experiments and assisted with preprocessing the data. S.L., C.M.P., and J.S.M. wrote the paper. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This research was in part supported by funds from the NCI Breast SPORE program (P50-CA58223), RO1-CA14876, by U01CA238475-01, by the Breast Cancer Research Foundation, and by the Susan G. Komen (SAC-160074).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par51">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par52">C.M.P is an equity stock holder and consultant of BioClassifier LLC; C.M.P is also listed as an inventor on patent applications for the Breast PAM50 Subtyping assay.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Mazutis</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Akartuna</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Tallapragada</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1187</fpage>
        <lpage>1201</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.04.044</pub-id>
        <?supplied-pmid 26000487?>
        <pub-id pub-id-type="pmid">26000487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zilionis</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nainys</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Veres</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Savova</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Zemmour</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell barcoding and sequencing using droplet microfluidics</article-title>
        <source>Nat Protoc</source>
        <year>2017</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>44</fpage>
        <lpage>73</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2016.154</pub-id>
        <?supplied-pmid 27929523?>
        <pub-id pub-id-type="pmid">27929523</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Basu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Nemesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Shekhar</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.002</pub-id>
        <?supplied-pmid 26000488?>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Zheng GXY, Terry JM, Belgrader P, Ryvkin P, Bent ZW, Wilson R, et al. Massively parallel digital transcriptional profiling of single cells. Nat Commun. 2017.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saadatpour</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>GC</given-names>
          </name>
        </person-group>
        <article-title>Single-cell analysis in cancer genomics</article-title>
        <source>Trends Genet</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>10</issue>
        <fpage>576</fpage>
        <lpage>586</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2015.07.003</pub-id>
        <?supplied-pmid 26450340?>
        <pub-id pub-id-type="pmid">26450340</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Suvà</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA sequencing in cancer: lessons learned and emerging challenges</article-title>
        <source>Mol Cell</source>
        <year>2019</year>
        <volume>75</volume>
        <issue>1</issue>
        <fpage>7</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2019.05.003</pub-id>
        <?supplied-pmid 31299208?>
        <pub-id pub-id-type="pmid">31299208</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Benson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Single-cell analyses to tailor treatments</article-title>
        <source>Sci Transl Med</source>
        <year>2017</year>
        <volume>9</volume>
        <issue>408</issue>
        <fpage>eaan4730</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.aan4730</pub-id>
        <?supplied-pmid 28931656?>
        <pub-id pub-id-type="pmid">28931656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krzanowski</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>YT</given-names>
          </name>
        </person-group>
        <article-title>A criterion for determining the number of groups in a data set using sum-of-squares clustering</article-title>
        <source>Biometrics</source>
        <year>1988</year>
        <volume>44</volume>
        <issue>1</issue>
        <fpage>23</fpage>
        <pub-id pub-id-type="doi">10.2307/2531893</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J Comput Appl Math</source>
        <year>1987</year>
        <volume>20</volume>
        <fpage>53</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/0377-0427(87)90125-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Walther</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hastie</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Estimating the number of clusters in a data set via the gap statistic</article-title>
        <source>J R Stat Soc Ser B Stat Methodol</source>
        <year>2001</year>
        <volume>63</volume>
        <issue>2</issue>
        <fpage>411</fpage>
        <lpage>423</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9868.00293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Dudoit S. A prediction-based resampling method for estimating the number of clusters in a dataset. 2002;1–21.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Ibshirani RT, Alther GW. Cluster validation by prediction strength. 2005;14(3):511–28.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Zappia L, Oshlack A. Clustering trees: a visualization for evaluating clusterings at multiple resolutions. 2018;(July):1–9.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Innes BT, Bader GD. scClustViz – single-cell RNAseq cluster assessment and visualization. F1000Research. 2018;</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Chen Y, Suresh A, Underbayev C, Sun C, Singh K, Seifuddin F, et al. IKAP — Identifying K mAjor cell Population groups in single-cell RNA-sequencing analysis. 2019;1–8.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Schwartz GW, Petrovic J, Fasolino M, Zhou Y, Cai S, Xu L, et al. TooManyCells identifies and visualizes relationships of single-cell clades. bioRxiv. 2019;</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Ben-Hur A, Elisseeff A, Guyon I. A stability based method for discovering structure in clustered data. Pac Symp Biocomput. 2002.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Monti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Consensus clustering: a resampling-based method for class discovery and visualization of gene expression microarray data</article-title>
        <source>Mach Learn</source>
        <year>2003</year>
        <volume>52</volume>
        <issue>1–2</issue>
        <fpage>91</fpage>
        <lpage>118</lpage>
        <pub-id pub-id-type="doi">10.1023/A:1023949509487</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilkerson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>DN</given-names>
          </name>
        </person-group>
        <article-title>ConsensusClusterPlus: a class discovery tool with confidence assessments and item tracking</article-title>
        <source>Bioinformatics.</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>12</issue>
        <fpage>1572</fpage>
        <lpage>1573</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq170</pub-id>
        <?supplied-pmid 20427518?>
        <pub-id pub-id-type="pmid">20427518</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Kiselev VY, Kirschner K, Schaub MT, Andrews T, Yiu A, Chandra T, et al. SC3: consensus clustering of single-cell RNA-seq data. 2017;14(5).</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Tracy CA, Widom H. Level-spacing distributions and the Airy kernel. Commun Math Phys. 1994.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Duò A, Robinson MD, Soneson C. A systematic performance evaluation of clustering methods for single-cell RNA-seq data [version 2; referees: 2 approved] Referee Status: 2018;(0).</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <mixed-citation publication-type="other">Şenbabaoǧlu Y, Michailidis G, Li JZ. Critical limitations of consensus clustering in class discovery. Sci Rep. 2014.</mixed-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Eddy WF. A new convex hull algorithm for planar sets. ACM Trans Math Softw. 1977.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hayes</surname>
            <given-names>DN</given-names>
          </name>
          <name>
            <surname>Nobel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Marron</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Statistical significance of clustering for high-dimension, low-sample size data</article-title>
        <source>J Am Stat Assoc</source>
        <year>2008</year>
        <volume>103</volume>
        <issue>483</issue>
        <fpage>1281</fpage>
        <lpage>1293</lpage>
        <pub-id pub-id-type="doi">10.1198/016214508000000454</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Huang H, Liu Y, Yuan M, Marron &amp; JS. Statistical significance of clustering using soft thresholding. J Comput Graph Stat [Internet]. 2015 [cited 2018 Sep 3];24(4):975–93. Available from: <ext-link ext-link-type="uri" xlink:href="http://amstat.tandfonline.com/action/journalInformation?journalCode=ucgs20">http://amstat.tandfonline.com/action/journalInformation?journalCode=ucgs20</ext-link></mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Dong M, Thennavan A, Urrutia E, Li Y, Perou CM, Zou F, et al. SCDC: bulk gene expression deconvolution by multiple single-cell RNA sequencing references. Brief Bioinform. 2020.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farrell</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Gennert</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Schier</surname>
            <given-names>AF</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Spatial reconstruction of single-cell gene expression data</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>5</issue>
        <fpage>495</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3192</pub-id>
        <?supplied-pmid 25867923?>
        <pub-id pub-id-type="pmid">25867923</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zappia</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Phipson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>174</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1305-0</pub-id>
        <?supplied-pmid 28899397?>
        <pub-id pub-id-type="pmid">28899397</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Paulovich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pomeroy</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2005</year>
        <volume>102</volume>
        <issue>43</issue>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <?supplied-pmid 16199517?>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Efron B, Tibshirani R. On testing the significance of sets of genes. Ann Appl Stat. 2007;1(1). 10.1214/07-AOAS101.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Savas P, Virassamy B, Ye C, Salim A, Mintoff CP, Caramia F, et al. Single-cell profiling of breast cancer T cells reveals a tissue-resident memory subset associated with improved prognosis. Nat Med. 2018.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">Guo X, Zhang Y, Zheng L, Zheng C, Song J, Zhang Q, et al. Global characterization of T cells in non-small-cell lung cancer by single-cell sequencing. Nat Med. 2018.</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yoo</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Landscape of infiltrating T cells in liver cancer revealed by single-cell sequencing</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>169</volume>
        <issue>7</issue>
        <fpage>1342</fpage>
        <lpage>1356.e16</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.05.035</pub-id>
        <?supplied-pmid 28622514?>
        <pub-id pub-id-type="pmid">28622514</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Azizi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Carr</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Plitas</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cornish</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Konopacki</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Prabhakaran</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell map of diverse immune phenotypes in the breast tumor microenvironment</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <issue>5</issue>
        <fpage>1293</fpage>
        <lpage>1308.e36</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.05.060</pub-id>
        <?supplied-pmid 29961579?>
        <pub-id pub-id-type="pmid">29961579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lineage tracking reveals dynamic relationships of T cells in colorectal cancer</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>564</volume>
        <issue>7735</issue>
        <fpage>268</fpage>
        <lpage>272</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0694-x</pub-id>
        <?supplied-pmid 30479382?>
        <pub-id pub-id-type="pmid">30479382</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oh</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Kwek</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Raju</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Chow</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Aran</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ilano</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pai</surname>
            <given-names>CCS</given-names>
          </name>
          <name>
            <surname>Rancan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Allaire</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Burra</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Spitzer</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Mangul</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Porten</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Meng</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Friedlander</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Fong</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Intratumoral CD4+ T cells mediate anti-tumor cytotoxicity in human bladder cancer</article-title>
        <source>Cell.</source>
        <year>2020</year>
        <volume>181</volume>
        <issue>7</issue>
        <fpage>1612</fpage>
        <lpage>1625.e13</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.05.017</pub-id>
        <?supplied-pmid 32497499?>
        <pub-id pub-id-type="pmid">32497499</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hollern</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Thennavan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Glodowski</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Garcia-Recio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mott</surname>
            <given-names>KR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>B cells and T follicular helper cells mediate response to checkpoint inhibitors in high mutation burden mouse models of breast cancer</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>179</volume>
        <issue>5</issue>
        <fpage>1191</fpage>
        <lpage>1206.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.10.028</pub-id>
        <?supplied-pmid 31730857?>
        <pub-id pub-id-type="pmid">31730857</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Curtis</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Turashvili</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Rueda</surname>
            <given-names>OM</given-names>
          </name>
          <name>
            <surname>Dunning</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The genomic and transcriptomic architecture of 2,000 breast tumours reveals novel subgroups</article-title>
        <source>Nature.</source>
        <year>2012</year>
        <volume>486</volume>
        <issue>7403</issue>
        <fpage>346</fpage>
        <lpage>352</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10983</pub-id>
        <?supplied-pmid 22522925?>
        <pub-id pub-id-type="pmid">22522925</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrell</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Prat</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic analysis identifies unique signatures predictive of brain, lung, and liver relapse</article-title>
        <source>Breast Cancer Res Treat</source>
        <year>2012</year>
        <volume>132</volume>
        <issue>2</issue>
        <fpage>523</fpage>
        <lpage>535</lpage>
        <pub-id pub-id-type="doi">10.1007/s10549-011-1619-7</pub-id>
        <?supplied-pmid 21671017?>
        <pub-id pub-id-type="pmid">21671017</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Koboldt DC, Fulton RS, MD ML, Schmidt H, Kalicki-Veizer J, JF MM, et al. Comprehensive molecular portraits of human breast tumours. Nature. 2012.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Brueffer C, Vallon-Christersson J, Grabau D, Ehinger A, Häkkinen J, Hegardt C, et al. Clinical value of RNA sequencing–based classifiers for prediction of the five conventional breast cancer biomarkers: a report from the population-based multicenter Sweden Cancerome Analysis Network—Breast Initiative. JCO Precis Oncol. 2018;(2):1–18. 10.1200/PO.17.00135.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carey</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Berry</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Cirrincione</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Barry</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Pitcher</surname>
            <given-names>BN</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>LN</given-names>
          </name>
          <name>
            <surname>Ollila</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Krop</surname>
            <given-names>IE</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Weckstein</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Hoadley</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Iglesia</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Cheang</surname>
            <given-names>MCU</given-names>
          </name>
          <name>
            <surname>Perou</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Winer</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Hudis</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Molecular heterogeneity and response to neoadjuvant human epidermal growth factor receptor 2 targeting in CALGB 40601, a randomized phase III trial of paclitaxel plus trastuzumab with or without lapatinib</article-title>
        <source>J Clin Oncol</source>
        <year>2016</year>
        <volume>34</volume>
        <issue>6</issue>
        <fpage>542</fpage>
        <lpage>549</lpage>
        <pub-id pub-id-type="doi">10.1200/JCO.2015.62.1268</pub-id>
        <?supplied-pmid 26527775?>
        <pub-id pub-id-type="pmid">26527775</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Fan C, Prat A, Parker JS, Liu Y, Carey LA, Troester MA, et al. Building prognostic models for breast cancer patients using clinical variables and hundreds of gene expression signatures. BMC Med Genet. 2011;4(1). 10.1186/1755-8794-4-3.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Gentles</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>5</issue>
        <fpage>453</fpage>
        <lpage>457</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3337</pub-id>
        <?supplied-pmid 25822800?>
        <pub-id pub-id-type="pmid">25822800</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Quezada</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Peggs</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Merghoub</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vider</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Blasberg</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yagita</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Muranski</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Antony</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Restifo</surname>
            <given-names>NP</given-names>
          </name>
          <name>
            <surname>Allison</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Tumor-reactive CD4+ T cells develop cytotoxic activity and eradicate large established melanoma after transfer into lymphopenic hosts</article-title>
        <source>J Exp Med</source>
        <year>2010</year>
        <volume>207</volume>
        <issue>3</issue>
        <fpage>637</fpage>
        <lpage>650</lpage>
        <pub-id pub-id-type="doi">10.1084/jem.20091918</pub-id>
        <?supplied-pmid 20156971?>
        <pub-id pub-id-type="pmid">20156971</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <mixed-citation publication-type="other">Tran E, Turcotte S, Gros A, Robbins PF, Lu YC, Dudley ME, et al. Cancer immunotherapy based on mutation-specific CD4+ T cells in a patient with epithelial cancer. Science (80- ). 2014.</mixed-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Zeisel A, Moz-Manchado AB, Codeluppi S, Lönnerberg P, Manno G La, Juréus A, et al. Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq. Science (80- ). 2015.</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Moreno</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Papatheodorou</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Brazma</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Putative cell type discovery from single-cell gene expression data</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <issue>6</issue>
        <fpage>621</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-0825-9</pub-id>
        <?supplied-pmid 32424270?>
        <pub-id pub-id-type="pmid">32424270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Wang J, Ma A, Chang Y, Gong J, Jiang Y, Qi R, et al. scGNN is a novel graph neural network framework for single-cell RNA-Seq analyses. Nat Commun. 2021.</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pal</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Vaillant</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Jamieson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rios</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Construction of developmental lineage relationships in the mouse mammary gland by single-cell RNA profiling</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1627</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-01560-x</pub-id>
        <?supplied-pmid 29158510?>
        <pub-id pub-id-type="pmid">29158510</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bach</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pensa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Grzelak</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hadfield</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Adams</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Differentiation dynamics of mammary epithelial cells revealed by single-cell RNA sequencing</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>2128</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-02001-5</pub-id>
        <?supplied-pmid 29225342?>
        <pub-id pub-id-type="pmid">29225342</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>QH</given-names>
          </name>
          <name>
            <surname>Pervolarakis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Profiling human breast epithelial cells using single cell RNA sequencing identifies cell diversity</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>2028</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-04334-1</pub-id>
        <?supplied-pmid 29795293?>
        <pub-id pub-id-type="pmid">29795293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Li CMC, Shapiro H, Tsiobikas C, Selfors L, Chen H, Gray GK, et al. Aging-associated alterations in the mammary gland revealed by single-cell RNA sequencing. bioRxiv. 2019.</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kalucka</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>de Rooij</surname>
            <given-names>LPMH</given-names>
          </name>
          <name>
            <surname>Goveia</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rohlenova</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dumas</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Meta</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome atlas of murine endothelial cells</article-title>
        <source>Cell</source>
        <year>2020</year>
        <volume>180</volume>
        <issue>4</issue>
        <fpage>764</fpage>
        <lpage>779.e20</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2020.01.015</pub-id>
        <?supplied-pmid 32059779?>
        <pub-id pub-id-type="pmid">32059779</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guerrero-Juarez</surname>
            <given-names>CF</given-names>
          </name>
          <name>
            <surname>Dedhia</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Jin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ruiz-Vega</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell analysis reveals fibroblast heterogeneity and myeloid-derived adipocyte progenitors in murine skin wounds</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>650</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-08247-x</pub-id>
        <?supplied-pmid 30737373?>
        <pub-id pub-id-type="pmid">30737373</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Schaum N, Karkanias J, Neff NF, May AP, Quake SR, Wyss-Coray T, et al. Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris. Nature. 2018.</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Papalexi</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>WM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <issue>7</issue>
        <fpage>1888</fpage>
        <lpage>1902.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <?supplied-pmid 6687398?>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levine</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Simonds</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Bendall</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>EAD</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tadmor</surname>
            <given-names>MD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Data-driven phenotypic dissection of AML reveals progenitor-like cells that correlate with prognosis</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>162</volume>
        <issue>1</issue>
        <fpage>184</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2015.05.047</pub-id>
        <?supplied-pmid 26095251?>
        <pub-id pub-id-type="pmid">26095251</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Svensson</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Droplet scRNA-seq is not zero-inflated</article-title>
        <source>Nat Biotechnol</source>
        <year>2020</year>
        <volume>38</volume>
        <issue>2</issue>
        <fpage>147</fpage>
        <lpage>150</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0379-5</pub-id>
        <?supplied-pmid 31937974?>
        <pub-id pub-id-type="pmid">31937974</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Demystifying “drop-outs” in single-cell UMI data</article-title>
        <source>Genome Biol</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>196</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-02096-y</pub-id>
        <?supplied-pmid 32762710?>
        <pub-id pub-id-type="pmid">32762710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <mixed-citation publication-type="other">Liu S, Thennavan A, Garay J, Marron JS, Perou CM, MultiK: an automated tool to determine optimal cluster numbers in single-cell RNA sequencing data. Github. 2021. <ext-link ext-link-type="uri" xlink:href="https://github.com/siyao-liu/MultiK">https://github.com/siyao-liu/MultiK</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <mixed-citation publication-type="other">Liu S, Thennavan A, Garay J, Marron JS, Perou CM, MultiK: an automated tool to determine optimal cluster numbers in single-cell RNA sequencing data. Datasets. Gene Expression Omnibus. 2021. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE165336">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE165336</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <mixed-citation publication-type="other">Zhang L, Zhang Z. Recharacterizing tumor-infiltrating lymphocytes by single-cell RNA sequencing. 2019;7(July):1040–7.</mixed-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tanioka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Hoadley</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hyslop</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Pitcher</surname>
            <given-names>BN</given-names>
          </name>
          <name>
            <surname>Soloway</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Spears</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Henry</surname>
            <given-names>LN</given-names>
          </name>
          <name>
            <surname>Tolaney</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dang</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Krop</surname>
            <given-names>IE</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>LN</given-names>
          </name>
          <name>
            <surname>Berry</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Mardis</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Winer</surname>
            <given-names>EP</given-names>
          </name>
          <name>
            <surname>Hudis</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Perou</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <article-title>Integrated analysis of RNA and DNA from the phase III trial CALGB 40601 identifies predictors of response to trastuzumab-based neoadjuvant chemotherapy in HER2-positive breast cancer</article-title>
        <source>Clin Cancer Res</source>
        <year>2018</year>
        <volume>24</volume>
        <issue>21</issue>
        <fpage>5292</fpage>
        <lpage>5304</lpage>
        <pub-id pub-id-type="doi">10.1158/1078-0432.CCR-17-3431</pub-id>
        <?supplied-pmid 30037817?>
        <pub-id pub-id-type="pmid">30037817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <mixed-citation publication-type="other">Liu S, Thennavan A, Garay J, Marron JS, Perou CM, MultiK: an automated tool to determine optimal cluster numbers in single-cell RNA sequencing data. Zenodo. 2021. 10.5281/zenodo.5138967.</mixed-citation>
    </ref>
  </ref-list>
</back>
