<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Microbiome</journal-id>
    <journal-id journal-id-type="iso-abbrev">Microbiome</journal-id>
    <journal-title-group>
      <journal-title>Microbiome</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2049-2618</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6060480</article-id>
    <article-id pub-id-type="publisher-id">517</article-id>
    <article-id pub-id-type="doi">10.1186/s40168-018-0517-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A two-stage microbial association mapping framework with advanced FDR control</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hu</surname>
          <given-names>Jiyuan</given-names>
        </name>
        <address>
          <email>Jiyuan.Hu@nyumc.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Koh</surname>
          <given-names>Hyunwook</given-names>
        </name>
        <address>
          <email>hk1785@nyu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>He</surname>
          <given-names>Linchen</given-names>
        </name>
        <address>
          <email>lh1790@nyu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Menghan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Blaser</surname>
          <given-names>Martin J.</given-names>
        </name>
        <address>
          <email>Martin.Blaser@nyumc.org</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8288-7068</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Huilin</given-names>
        </name>
        <address>
          <email>Huilin.Li@nyumc.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8753</institution-id><institution-id institution-id-type="GRID">grid.137628.9</institution-id><institution>Division of Biostatistics, Department of Population Health, </institution><institution>New York University School of Medicine, </institution></institution-wrap>New York, NY 10016 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0125 2443</institution-id><institution-id institution-id-type="GRID">grid.8547.e</institution-id><institution>Shanghai Center for Mathematical Sciences, </institution><institution>Fudan University, </institution></institution-wrap>Shanghai, 200433 China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8753</institution-id><institution-id institution-id-type="GRID">grid.137628.9</institution-id><institution>Department of Medicine, </institution><institution>New York University School of Medicine, </institution></institution-wrap>New York, NY 10016 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>7</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>7</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2018</year>
    </pub-date>
    <volume>6</volume>
    <elocation-id>131</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>2</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>7</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2018</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">In microbiome studies, it is important to detect taxa which are associated with pathological outcomes at the lowest definable taxonomic rank, such as genus or species. Traditionally, taxa at the target rank are tested for individual association, followed by the Benjamini-Hochberg (BH) procedure to control for false discovery rate (FDR). However, this approach neglects the dependence structure among taxa and may lead to conservative results. The taxonomic tree of microbiome data represents alignment from phylum to species rank and characterizes evolutionary relationships across microbial taxa. Taxa that are closer on the tree usually have similar responses to the exposure (environment). The statistical power in microbial association tests can be enhanced by efficiently employing the prior evolutionary information via the taxonomic tree.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p id="Par2">We propose a two-stage microbial association mapping framework (massMap) which uses grouping information from the taxonomic tree to strengthen statistical power in association tests at the target rank. massMap first screens the association of taxonomic groups at a pre-selected higher taxonomic rank using a powerful microbial group test OMiAT. The method then proceeds to test the association for each candidate taxon at the target rank within the significant taxonomic groups identified in the first stage. Hierarchical BH (HBH) and selected subset testing (SST) procedures are evaluated to control the FDR for the two-stage structured tests.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par3">Our simulations show that massMap incorporating OMiAT and the advanced FDR controlling methodologies largely alleviates the multiplicity issue. It is statistically more powerful than the traditional association mapping directly at the target rank while controlling the FDR at desired levels under most scenarios. In our real data analyses, massMap detects more or the same amount of associated species with smaller adjusted <italic>p</italic> values compared to the traditional method, which further illustrates the efficiency of the proposed framework. The R package of massMap is publicly available at <ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/huilinli09/software">https://sites.google.com/site/huilinli09/software</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/JiyuanHu/">https://github.com/JiyuanHu/</ext-link>.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par4">massMap is a novel microbial association mapping framework and achieves additional efficiency by utilizing the intrinsic taxonomic structure of microbiome data.</p>
      </sec>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s40168-018-0517-1) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Microbiome</kwd>
      <kwd>Two-stage microbial association mapping</kwd>
      <kwd>Taxonomic tree</kwd>
      <kwd>Microbial group association test</kwd>
      <kwd>False discovery rate</kwd>
      <kwd>Hierarchical BH</kwd>
      <kwd>Selected subset testing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>NIDDK</institution>
        </funding-source>
        <award-id>R01 DK090989</award-id>
        <award-id>R01DK110014</award-id>
        <award-id>U01AI22285</award-id>
        <principal-award-recipient>
          <name>
            <surname>Blaser</surname>
            <given-names>Martin J.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Huilin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the Diane Belfer Program in Human Microbial Ecology</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>the C&amp;D Fund</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2018</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par23">The microbiome has important interactions in human health and disease [<xref ref-type="bibr" rid="CR1">1</xref>]. Microbiota disturbance has been associated with human diseases including obesity, diabetes, Crohn’s disease, and numerous other conditions [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. With the development of next-generation sequencing techniques, it is feasible to extract all the microbiota from multiple parts of the human body, assess microbiome composition, and then link it with human health/diseases [<xref ref-type="bibr" rid="CR6">6</xref>]. Two high-throughput parallel sequencing approaches are widely used; one targeted to the 16S rRNA amplicon sequencing and the other to metagenomic shotgun sequencing [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par24">We introduce our method using microbiome data generated from 16S rRNA sequencing studies. Based on 16S rRNA sequencing, the reads from the amplicons are clustered into operational taxonomic units (OTUs) according to sequence similarity, and then their read counts or relative abundances are evaluated. OTUs are assigned to a taxonomic tree at the kingdom, phylum, class, order, family, genus, and species ranks [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>], hierarchically using either the online Greengenes [<xref ref-type="bibr" rid="CR10">10</xref>] or the RDP classifier [<xref ref-type="bibr" rid="CR11">11</xref>] taxonomy assignments. The taxonomic tree displays the evolutionary relationship among the microbial taxa; taxa that are closer on the tree tend to have similar responses to environmental shifts [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>].</p>
    <p id="Par25">There is general interest to detect association between traits and microbial taxa at the various taxonomic ranks. Researchers usually begin investigation for community-level analysis at the highest taxonomic rank to determine whether the overall microbial profiles are different between groups or associated or not with the trait. For example, the analyses of bacterial communities within (α-diversity) and between samples (β-diversity) [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR14">14</xref>] are two commonly used approaches. Significant results at the community level lead to the further identification of the roles of specific microbes to better understand the mechanisms involved in microbiome perturbations. Most often, investigators are interested in the association mapping of taxa at the lowest definable rank, such as genus or species, considered as the ‘target rank.’</p>
    <p id="Par26">Several statistical methods have been developed explicitly for microbiome data to examine for differential abundance among groups or to test for microbial association with continuous traits at a specific taxonomic rank [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. LEfSe [<xref ref-type="bibr" rid="CR15">15</xref>] uses the Kruskal-Wallis test to detect significant differential abundances among groups, but does not correct for multiple comparisons. Other association testing methods, such as metagenomeSeq-fit Zig [<xref ref-type="bibr" rid="CR16">16</xref>] and STAMP [<xref ref-type="bibr" rid="CR17">17</xref>], assume that the testing taxa are independent. They examine taxa individually and use the <italic>q</italic> value method [<xref ref-type="bibr" rid="CR19">19</xref>] or the Benjamini-Hochberg (BH) procedure [<xref ref-type="bibr" rid="CR20">20</xref>] to control the false discovery rate (FDR). Because of the sparse signal and large number of multiple comparisons, this usually leads to very few discoveries. However, the microbes in a community are usually dependent upon one another, and trait-associated taxa tend to be clustered evolutionarily instead of randomly distributed across the community [<xref ref-type="bibr" rid="CR12">12</xref>]. Therefore, an association mapping framework which could exploit the known taxonomic structure, i.e., the microbial evolutionary relationships, to better target on associated taxa would have substantial potential.</p>
    <p id="Par27">In this study, we propose a powerful two-stage microbial association mapping framework (massMap), which incorporates advanced FDR-controlling procedures based on the microbial dependence structures through the taxonomic tree. In the first stage, an upper-level taxonomic rank is first pre-selected as the ‘screening rank.’ The association for taxonomic groups at this selected rank is then tested by OMiAT, a new microbiome-based group association testing method, designed to discover significant association signals for an upper-level taxon considering various relative contributions from both microbial abundance and phylogenetic information in its lower lineages [<xref ref-type="bibr" rid="CR18">18</xref>]. In the second stage, the association tests for taxa within the groups discovered in the first stage are performed at the ‘target rank.’</p>
    <p id="Par28">The proposed framework constitutes three building components: (1) a pre-selected taxonomic rank for screening; (2) a powerful microbial group test OMiAT, to identify the taxonomic groups that contain the associated taxa; and (3) an advanced FDR-controlling methodology to resolve the dependency among taxa. The taxonomic tree classifies the microbes in the bacterial kingdom into ranks from the most general rank phylum where each taxonomic group contains many taxa, to the most specific rank species with one member in each group. Selection of a screening rank balances the group testing power as well as proportion of truly associated taxa among the significant groups. The group association test for screening is more powerful at a higher rank regarding. However, as the groups classified by the higher rank have too many members, there is still a very high proportion of unassociated taxa within the groups, i.e., the signal has not condensed enough after screening. Thus, a middle taxonomic rank such as order or family is expected to perform best in the proposed two-stage framework. A highly powerful microbial group test guarantees a higher probability that it only eliminates not-associated microbial taxa and retains true signals to the target rank. The data-driven approach of OMiAT is a microbial group test designed for this purpose and it can efficiently detect microbial groups varying in association patterns. The hierarchical BH (HBH) [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] and the selected subset testing (SST) procedures [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>] are two FDR-controlling procedures capable of handling multiple hypotheses with two-stage structures. These have been applied in microarray data analysis and permit greater discovery than the traditional BH procedure [<xref ref-type="bibr" rid="CR25">25</xref>].</p>
    <p id="Par29">massMap fully utilizes the prior information from the taxonomic tree, in which the first stage eliminates less-promising taxa and therefore condenses the association signal. Through extensive simulations and two real data analyses, we show that massMap achieves higher statistical power and detects more biologically meaningful taxa than the traditional one-stage microbial association test.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>A two-stage microbial association testing framework: massMap</title>
      <p id="Par30">Suppose we have observed the microbial abundance information of <italic>N</italic> subjects for <italic>M</italic> taxa at the target rank. We propose to perform the screening test at a pre-selected higher screening rank, and its taxonomy assignment partitions <italic>M</italic> taxa into <italic>G</italic> taxonomic groups. Let the <italic>g</italic>th group consist of <italic>m</italic><sub><italic>g</italic></sub> (<italic>m</italic><sub><italic>g</italic></sub> ≥ 1) taxa then ∑<sub><italic>g</italic></sub><italic>m</italic><sub><italic>g</italic></sub> = <italic>M</italic>. For subject <italic>i</italic>,  denote the outcome trait, either binary or continuous, as <italic>Y</italic><sub><italic>i</italic></sub>, the abundance of taxa in the <italic>g</italic>th group as <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{Z}}_{ig}={\left({Z}_{ig1},{Z}_{ig2},\dots, {Z}_{ig{m}_g}\right)}^{\prime }, $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi mathvariant="italic">ig</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="(" separators=",,,"><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ig</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ig</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi mathvariant="italic">ig</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mfenced><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq1.gif"/></alternatives></inline-formula> and <italic>p</italic> covariates as <bold><italic>X</italic></bold><sub><italic>i</italic></sub> = (<italic>X</italic><sub><italic>i</italic>1</sub>, <italic>X</italic><sub><italic>i</italic>2</sub>, …, <italic>X</italic><sub><italic>ip</italic></sub>)<sup>′</sup> respectively.</p>
      <p id="Par31">At the screening rank, the group association test is used to examine the association between each group of taxa and the outcome trait. We use the logistic regression model for a binary outcome:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{Logit}\left[\mathrm{P}\left({Y}_i=1\right)\right]={\beta}_0+{\boldsymbol{\alpha}}^{\prime }{\boldsymbol{X}}_i+{\boldsymbol{\beta}}_g^{\prime }{\boldsymbol{Z}}_{ig}, $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mtext>Logit</mml:mtext><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi mathvariant="italic">ig</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="40168_2018_517_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>and the linear regression model for a continuous outcome:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Y}_i={\beta}_0+{\boldsymbol{\alpha}}^{\prime }{\boldsymbol{X}}_i+{\boldsymbol{\beta}}_g^{\prime }{\boldsymbol{Z}}_{ig}+{\epsilon}_i. $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>g</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi mathvariant="italic">ig</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:math><graphic xlink:href="40168_2018_517_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <italic>β</italic><sub>0</sub> is the intercept, <bold><italic>α</italic></bold> = (<italic>α</italic><sub>1</sub>, …, <italic>α</italic><sub><italic>p</italic></sub>)<sup>′</sup> is the vector of coefficients of covariates, <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{\beta}}_g={\left({\beta}_{g1},{\beta}_{g2},\dots, {\beta}_{g{m}_g}\right)}^{\prime } $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="(" separators=",,,"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mfenced><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq2.gif"/></alternatives></inline-formula> is the vector of coefficients for abundance of taxa from group <italic>g</italic>, and <italic>ϵ</italic><sub><italic>i</italic></sub> is an error term with mean 0 and variance <italic>σ</italic><sup>2</sup>. The definition of a trait-associated group is that at least one of the taxa in the group is associated with the trait. Correspondingly, the screening hypothesis for the <italic>g</italic>th group is<disp-formula id="Equa"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {H}_{0g}:{\beta}_{g1}={\beta}_{g2}=\dots ={\beta}_{g{m}_g}=0\kern0.5em v.s.{H}_{1g}:\mathrm{at}\ \mathrm{least}\ \mathrm{one}\ {\beta}_{gj}\ne 0,\kern1em j=1,\dots, {m}_g. $$\end{document}</tex-math><mml:math id="M10" display="block"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>…</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.5em"/><mml:mi>v</mml:mi><mml:mo>.</mml:mo><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>at</mml:mi><mml:mspace width="0.25em"/><mml:mtext>least</mml:mtext><mml:mspace width="0.25em"/><mml:mi>one</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mi>β</mml:mi><mml:mi mathvariant="italic">gj</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:math><graphic xlink:href="40168_2018_517_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par32">OMiAT is a powerful test specifically designed for the detection of varying association patterns for a group of taxa and can accommodate multiple covariates [<xref ref-type="bibr" rid="CR18">18</xref>]. Thus, it is a useful screening test for our two-stage association mapping framework, and we employ it to test the associations between taxonomic groups and traits. The corresponding test statistic is<disp-formula id="Equb"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {M}_{OMiAT}^g=\mathrm{minP}\left\{{T}_{aSPU}^g,{Q}_{OMiRKAT}^g\right\}. $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:msubsup><mml:mi>M</mml:mi><mml:mtext mathvariant="italic">OMiAT</mml:mtext><mml:mi>g</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>minP</mml:mtext><mml:mfenced close="}" open="{" separators=","><mml:msubsup><mml:mi>T</mml:mi><mml:mtext mathvariant="italic">aSPU</mml:mtext><mml:mi>g</mml:mi></mml:msubsup><mml:msubsup><mml:mi>Q</mml:mi><mml:mtext mathvariant="italic">OMiRKAT</mml:mtext><mml:mi>g</mml:mi></mml:msubsup></mml:mfenced><mml:mo>.</mml:mo></mml:math><graphic xlink:href="40168_2018_517_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq3"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {T}_{a\mathrm{SPU}}^g $$\end{document}</tex-math><mml:math id="M14" display="inline"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>SPU</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Q}_{OMiRKAT}^g $$\end{document}</tex-math><mml:math id="M16" display="inline"><mml:msubsup><mml:mi>Q</mml:mi><mml:mtext mathvariant="italic">OMiRKAT</mml:mtext><mml:mi>g</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq4.gif"/></alternatives></inline-formula> are two adaptive test statistics. <inline-formula id="IEq5"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {T}_{a\mathrm{SPU}}^g $$\end{document}</tex-math><mml:math id="M18" display="inline"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>SPU</mml:mi></mml:mrow><mml:mi>g</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq5.gif"/></alternatives></inline-formula> is useful for modulating different association patterns arising from highly imbalanced microbial abundances. It is adapted from the sum of score powered tests (SPU) [<xref ref-type="bibr" rid="CR26">26</xref>] which was originally proposed for gene- or region-based association testing in genome-wide association studies [<xref ref-type="bibr" rid="CR18">18</xref>]. <inline-formula id="IEq6"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Q}_{OMiRKAT}^g $$\end{document}</tex-math><mml:math id="M20" display="inline"><mml:msubsup><mml:mi>Q</mml:mi><mml:mtext mathvariant="italic">OMiRKAT</mml:mtext><mml:mi>g</mml:mi></mml:msubsup><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq6.gif"/></alternatives></inline-formula>, advantageous in detecting microbial group associations utilizing phylogenetic tree information, is tailored from the microbiome regression-based kernel association test (MiRKAT) [<xref ref-type="bibr" rid="CR27">27</xref>], originally proposed as a microbial community association test. Please see Eq. (9) of [<xref ref-type="bibr" rid="CR18">18</xref>] for notation and detailed explanation. OMiAT aims to detect varying association patterns which can be captured by either aSPU or OMiRKAT, using the minP procedure within the taxonomy group.</p>
      <p id="Par33">At the target rank, we are interested in the association between each taxon and the outcome trait. For taxon <italic>j</italic>(<italic>j</italic> = 1, …, <italic>m</italic><sub><italic>g</italic></sub>) from the <italic>g</italic>th group, the model for binary, and continuous trait are<disp-formula id="Equc"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{Logit}\left[\mathrm{P}\left({Y}_i=1\right)\right]={\beta}_0+{\boldsymbol{\alpha}}^{\prime }{\boldsymbol{X}}_i+{\beta}_{gj}{Z}_{igj}, $$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mtext>Logit</mml:mtext><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi mathvariant="italic">gj</mml:mi></mml:msub><mml:msub><mml:mi>Z</mml:mi><mml:mi mathvariant="italic">igj</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="40168_2018_517_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par34">and<disp-formula id="Equd"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Y}_i={\beta}_0+{\boldsymbol{\alpha}}^{\hbox{'}}{\boldsymbol{X}}_i+{\beta}_{gj}{Z}_{igj}+{\epsilon}_i. $$\end{document}</tex-math><mml:math id="M24" display="block"><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi mathvariant="italic">gj</mml:mi></mml:msub><mml:msub><mml:mi>Z</mml:mi><mml:mi mathvariant="italic">igj</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:math><graphic xlink:href="40168_2018_517_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par35">respectively. Thus, the corresponding targeting hypotheses within group <italic>g</italic> are<disp-formula id="Eque"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {H}_{0g1}:{\beta}_{g1}=0\kern0.5em \mathrm{vs}\kern0.5em {H}_{1g1}:{\beta}_{g1}\ne 0, $$\end{document}</tex-math><mml:math id="M26" display="block"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.5em"/><mml:mi>vs</mml:mi><mml:mspace width="0.5em"/><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:math><graphic xlink:href="40168_2018_517_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par36">…<disp-formula id="Equf"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {H}_{0 gj}:{\beta}_{gj}=0\kern0.5em \mathrm{vs}\ {H}_{1 gj}:{\beta}_{gj}\ne 0, $$\end{document}</tex-math><mml:math id="M28" display="block"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi mathvariant="italic">gj</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi mathvariant="italic">gj</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.5em"/><mml:mi>vs</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="italic">gj</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi mathvariant="italic">gj</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:math><graphic xlink:href="40168_2018_517_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par37">…<disp-formula id="Equg"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {H}_{0g{m}_g}:{\beta}_{g{m}_g}=0\kern0.5em \mathrm{vs}\ {H}_{1g{m}_g}:{\beta}_{g{m}_g}\ne 0. $$\end{document}</tex-math><mml:math id="M30" display="block"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>g</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.5em"/><mml:mi>vs</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>g</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:math><graphic xlink:href="40168_2018_517_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par38">Denote the predicted value of <italic>Y</italic><sub><italic>i</italic></sub> under <italic>H</italic><sub>0<italic>gj</italic></sub> by <inline-formula id="IEq7"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{Y}}_i $$\end{document}</tex-math><mml:math id="M32" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq7.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq8"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{Y}}_i={\widehat{\beta}}_0+{\widehat{\boldsymbol{\alpha}}}^{\prime }{\boldsymbol{X}}_i $$\end{document}</tex-math><mml:math id="M34" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mspace width="0.25em"/></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>′</mml:mo></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq8.gif"/></alternatives></inline-formula> for continuous traits and <inline-formula id="IEq9"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{Y}}_i=\mathrm{Logi}{\mathrm{t}}^{-1}\left({\widehat{\beta}}_0+{\widehat{\boldsymbol{\alpha}}}^{\prime }{\boldsymbol{X}}_i\right) $$\end{document}</tex-math><mml:math id="M36" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>Logi</mml:mtext><mml:msup><mml:mi mathvariant="normal">t</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>′</mml:mo></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq9.gif"/></alternatives></inline-formula> for binary traits, respectively; <inline-formula id="IEq10"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\beta}}_0 $$\end{document}</tex-math><mml:math id="M38" display="inline"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \widehat{\boldsymbol{\alpha}} $$\end{document}</tex-math><mml:math id="M40" display="inline"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq11.gif"/></alternatives></inline-formula>are the maximum likelihood estimates (MLEs) under <italic>H</italic><sub>0<italic>gj</italic></sub>. The association between the <italic>j</italic>th taxon and the trait can be tested by the non-parametric score test statistic [<xref ref-type="bibr" rid="CR18">18</xref>]:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{U}}_{gj}=\sum \limits_{i=1}^N\left({Y}_i-{\widehat{Y}}_i\right){Z}_{igj},j=1,\dots, {m}_{g.} $$\end{document}</tex-math><mml:math id="M42" display="block"><mml:msub><mml:mi mathvariant="normal">U</mml:mi><mml:mi mathvariant="italic">gj</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mi>Z</mml:mi><mml:mi mathvariant="italic">igj</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:mspace width="0.25em"/></mml:math><graphic xlink:href="40168_2018_517_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par39">We used the residual-permutation method to calculate <italic>p</italic> values of statistics as in [<xref ref-type="bibr" rid="CR18">18</xref>].</p>
      <p id="Par40">The two-stage microbial association mapping framework massMap is described as a two-level hierarchical tree in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. The group association test and the individual taxon detection are performed at the screening rank and the target rank respectively. massMap screens out groups among which taxa are unlikely to be associated and only retains the more promising ones to the target rank. The association signal condenses after the screening step so that the proportion of truly associated taxa is increased within the candidate groups. By utilizing the advanced FDR controlling procedures introduced below, we could further enhance the association mapping power. Next, we discuss how to implement the advanced FDR controlling procedures to move from the screening rank to the target rank to discover associated taxa.<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic of the two-stage microbial association mapping framework massMap. The association testing hypotheses are organized into a two-level tree. The screening test is conducted at the first level of the tree using OMiAT (proposed) or the aggregated method (competing method). Two advanced FDR controlling procedures are evaluated in this framework: the hierarchical BH (HBH) and the selected subset testing with BH (SST) procedure [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]</p></caption><graphic xlink:href="40168_2018_517_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Advanced FDR controlling procedures</title>
      <p id="Par41">We consider two advanced FDR-controlling procedures: the hierarchical BH (HBH) procedure [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>] and the selected subset testing with BH (SST) procedure [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>] to accommodate the hierarchically structured hypotheses in massMap. Both procedures involve the assembly of multiple BH procedures. All of the BH procedures below are conducted at level FDR = <italic>q</italic> without explicit declaration. Denote the set of screening hypotheses by <inline-formula id="IEq12"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathcal{T}}_0=\left\{{H}_{01},\dots, {H}_{0g},\dots, {H}_{0G}\right\} $$\end{document}</tex-math><mml:math id="M44" display="inline"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,,,"><mml:msub><mml:mi>H</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq12.gif"/></alternatives></inline-formula> and the target hypotheses organized into groups by <inline-formula id="IEq13"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathcal{T}}_1=\left\{{H}_{011},\dots, {H}_{01j},\dots, {H}_{01{m}_1}\right\},\dots, $$\end{document}</tex-math><mml:math id="M46" display="inline"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,,,"><mml:msub><mml:mi>H</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>01</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>01</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq13.gif"/></alternatives></inline-formula>
<inline-formula id="IEq14"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathcal{T}}_G=\left\{{H}_{0G1},\dots, {H}_{0 Gj},\dots, {H}_{0G{m}_G}\right\} $$\end{document}</tex-math><mml:math id="M48" display="inline"><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,,,"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi mathvariant="italic">Gj</mml:mi></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>G</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq14.gif"/></alternatives></inline-formula>. Further, the corresponding raw <italic>p</italic> values are denoted by <inline-formula id="IEq15"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathcal{P}}_0=\left\{{p}_{01},\dots, {p}_{0g},\dots, {p}_{0G}\right\} $$\end{document}</tex-math><mml:math id="M50" display="inline"><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,,,"><mml:msub><mml:mi>p</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq15.gif"/></alternatives></inline-formula>, <inline-formula id="IEq16"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathcal{P}}_1=\left\{{p}_{011},\dots, {p}_{01j},\dots, {p}_{01{m}_1}\right\},\dots, $$\end{document}</tex-math><mml:math id="M52" display="inline"><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,,,"><mml:msub><mml:mi>p</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>01</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>01</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathcal{P}}_G=\left\{{p}_{0G1},\dots, {p}_{0 Gj},\dots, {p}_{0G{m}_G}\right\} $$\end{document}</tex-math><mml:math id="M54" display="inline"><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>G</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,,,"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi mathvariant="italic">Gj</mml:mi></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>G</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq17.gif"/></alternatives></inline-formula>, respectively.</p>
      <sec id="Sec5">
        <title>HBH procedure</title>
        <p id="Par42">The HBH procedure applies to <italic>p</italic> values arranged in a tree of disjoint subfamilies and is conducted as follows:<list list-type="bullet"><list-item><p id="Par43">▪ At the screening rank: apply the BH procedure to <inline-formula id="IEq18"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathcal{P}}_0 $$\end{document}</tex-math><mml:math id="M56" display="inline"><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq18.gif"/></alternatives></inline-formula>. The groups with adjusted <italic>p</italic> values &lt;<italic>q</italic> are called the discovered groups. Without loss of generality, we assume that the first <italic>R</italic> groups are discovered;</p></list-item><list-item><p id="Par44">▪ At the target rank: within the <italic>g</italic>th discovered group, <italic>g</italic> = 1, ⋯, <italic>R</italic>, apply the BH procedure to <inline-formula id="IEq19"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathcal{P}}_g $$\end{document}</tex-math><mml:math id="M58" display="inline"><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq19.gif"/></alternatives></inline-formula>. The taxa with adjusted <italic>p</italic> values &lt;<italic>q</italic> are reported as trait-associated taxa.</p></list-item></list></p>
      </sec>
      <sec id="Sec6">
        <title>SST procedure</title>
        <p id="Par45">The SST procedure is to treat the two-level hierarchical tree simply as a two-stage structure, and it can be implemented as follows:<list list-type="bullet"><list-item><p id="Par46">▪ At the screening rank: same as in the HBH procedure;</p></list-item><list-item><p id="Par47">▪ At the target rank: pool the <italic>p</italic> values from <italic>R</italic> discovered groups into one set and denote it as <inline-formula id="IEq20"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathcal{P}}_{\mathrm{pooled}}=\left\{{p}_{011},\dots, {p}_{01{m}_1},\dots, {p}_{0R1},\dots, {p}_{0R{m}_R}\right\} $$\end{document}</tex-math><mml:math id="M60" display="inline"><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mtext>pooled</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,,,,,"><mml:msub><mml:mi>p</mml:mi><mml:mn>011</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>01</mml:mn><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>R</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>R</mml:mi><mml:msub><mml:mi>m</mml:mi><mml:mi>R</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq20.gif"/></alternatives></inline-formula>. The corresponding taxa are called the selected subset. Apply the BH procedure to the pooled <italic>p</italic> values. The taxa with adjusted <italic>p</italic> values &lt;<italic>q</italic> are reported as trait-associated taxa.</p></list-item></list></p>
        <p id="Par48">The HBH procedure has merit since it reports many discoveries [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>], but it sometimes has higher FDR than the nominal level. In comparison, SST is more conservative than HBH. If tests between two stages are independent, either utilizing an independent source of data or testing unrelated hypotheses, SST procedure can control the FDR at the desired level. Notice that in our setting, we use the same data to implement the tests in both stages; the test statistics in the second stage might thus not be independent of those in the first stage. As the SST procedure is commonly implemented in microarray analysis where tests from both stages use the same data [<xref ref-type="bibr" rid="CR25">25</xref>], we ignore the minor dependence among tests from both stages and apply the SST procedure to the microbial association mapping analysis. For convenience, we denote the two-stage framework with OMiAT as the screening test and HBH or SST as the FDR-control procedures as OMiAT-HBH or OMiAT-SST, respectively.</p>
      </sec>
    </sec>
    <sec id="Sec7">
      <title>Aggregated methods</title>
      <p id="Par49">Apart from OMiAT [<xref ref-type="bibr" rid="CR18">18</xref>], there are other methods to detect microbial group associations which are termed aggregated methods in this article, including commonly used programs such as LEfSe [<xref ref-type="bibr" rid="CR15">15</xref>], metagenomeSeq-fit Zig [<xref ref-type="bibr" rid="CR16">16</xref>], and STAMP [<xref ref-type="bibr" rid="CR17">17</xref>]. Even though the modeling techniques and test statistics used are different, they all assume that the effect sizes and directions of all taxa within the tested group are the same. Under this assumption, the abundance within each tested group is summed and regressed towards the outcome. Here, we investigate a representative aggregated method, as illustrated in [<xref ref-type="bibr" rid="CR18">18</xref>]. Specifically, for the <italic>g</italic>th group, the corresponding logistic regression model for binary outcome is<disp-formula id="Equh"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{Logit}\left[\mathrm{P}\left({Y}_i=1\right)\right]={\beta}_0+{\boldsymbol{\alpha}}^{\prime }{\boldsymbol{X}}_i+{\beta}_g^{\ast}\sum \limits_j{Z}_{igj}, $$\end{document}</tex-math><mml:math id="M62" display="block"><mml:mtext>Logit</mml:mtext><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>g</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:msub><mml:mi>Z</mml:mi><mml:mi mathvariant="italic">igj</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="40168_2018_517_Article_Equh.gif" position="anchor"/></alternatives></disp-formula>and the linear regression model for the continuous outcome is<disp-formula id="Equi"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Y}_i={\beta}_0+{\boldsymbol{\alpha}}^{\prime }{\boldsymbol{X}}_i+{\beta}_g^{\ast}\sum \limits_j{Z}_{igj}+{\epsilon}_i $$\end{document}</tex-math><mml:math id="M64" display="block"><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>g</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:msub><mml:mi>Z</mml:mi><mml:mi mathvariant="italic">igj</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><graphic xlink:href="40168_2018_517_Article_Equi.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq21"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\beta}_g^{\ast } $$\end{document}</tex-math><mml:math id="M66" display="inline"><mml:msubsup><mml:mi>β</mml:mi><mml:mi>g</mml:mi><mml:mo>∗</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq21.gif"/></alternatives></inline-formula> is the shared coefficient for the taxa in group <italic>g</italic>, which reflects the assumption of the aggregated methods: the effect sizes and directions of all taxa within the tested group are the same. Then, its screening hypothesis is<disp-formula id="Equj"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {H}_{0g}:{\beta}_g^{\ast }=0\ \mathrm{vs}\kern0.5em {H}_{1g}:{\beta}_g^{\ast}\ne 0. $$\end{document}</tex-math><mml:math id="M68" display="block"><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>g</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.25em"/><mml:mi>vs</mml:mi><mml:mspace width="0.5em"/><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>g</mml:mi><mml:mo>∗</mml:mo></mml:msubsup><mml:mo>≠</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:math><graphic xlink:href="40168_2018_517_Article_Equj.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par50">The non-parametric score test statistic from Eq. (<xref rid="Equ3" ref-type="">3</xref>) is used to test this screening hypothesis. As a comparison, we include this test in the simulations and real data analyses and refer to it as the aggregated method. We denote the two-stage framework with the aggregated method as the screening test and HBH or SST as FDR-control procedures as AGG-HBH or AGG-SST, respectively.</p>
    </sec>
    <sec id="Sec8">
      <title>Traditional one-stage method</title>
      <p id="Par51">The traditional microbial association tests do not require a screening step, rather directly conducting the association test between the trait and taxa one by one at the target rank. Therefore, the hypotheses set is the union of hypotheses from <italic>G</italic> groups, i.e., <inline-formula id="IEq22"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathcal{T}={\mathcal{T}}_1\cup \dots \cup {\mathcal{T}}_G $$\end{document}</tex-math><mml:math id="M70" display="inline"><mml:mi mathvariant="script">T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∪</mml:mo><mml:mo>…</mml:mo><mml:mo>∪</mml:mo><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq22.gif"/></alternatives></inline-formula>. The corresponding <italic>p</italic> value set are denoted by <inline-formula id="IEq23"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathcal{P}={\mathcal{P}}_1\cup \dots \cup {\mathcal{P}}_G $$\end{document}</tex-math><mml:math id="M72" display="inline"><mml:mi mathvariant="script">P</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∪</mml:mo><mml:mo>…</mml:mo><mml:mo>∪</mml:mo><mml:msub><mml:mi mathvariant="script">P</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="40168_2018_517_Article_IEq23.gif"/></alternatives></inline-formula>, and are calculated from the non-parametric score statistics in Eq. (<xref rid="Equ3" ref-type="">3</xref>). In traditional methods, the BH procedure is most commonly used to control FDR for multiple comparisons. We used the traditional method as the benchmark method in both the simulations and real data analyses, and denoted it as BH.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results</title>
    <p id="Par52">We first conducted comprehensive simulations to evaluate the performance of OMiAT-HBH, OMiAT-SST, AGG-HBH, AGG-SST, and BH methods in relation to their false discovery rates (FDR) and true positive rates (TPR) for identifying the associated taxa at the target rank. Then, we further applied those methods to two real microbiome studies to compare their practical performance: one involving the American Gut Project (AGP) (<ext-link ext-link-type="uri" xlink:href="http://www.americangut.org">www.americangut.org</ext-link>) and the other, a two-group murine study [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
    <sec id="Sec10">
      <title>Simulation settings</title>
      <p id="Par53">The simulation settings were similar to those used in prior studies [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. In those studies, the abundance tables were first generated from the Dirichlet-multinomial (DM) distribution based on a real microbiome dataset. Then, the generalized linear model was utilized to generate the value of outcome traits. OTUs were partitioned into clusters using the partitioning-around-medoids (PAM) clustering algorithm [<xref ref-type="bibr" rid="CR30">30</xref>], where OTUs from a certain number of clusters were further assigned to be trait-associated. Following those prior studies, we generated our simulation data as below. The taxonomic and phylogenetic tree information and OTU table from AGP’s baseline microbiome data are the basis of our simulated data. In our AGP data analysis, there are 174 OTUs retained after the filtering. We generated the OTU abundance from the DM distribution with 15,000 total reads per sample, using function dirmult() from the R package “dirmult” [<xref ref-type="bibr" rid="CR31">31</xref>]. The corresponding proportion means and dispersion parameters of the DM distribution were estimated from AGP’s baseline microbiome data.</p>
      <p id="Par54">The continuous and binary traits were generated under the following linear model (4) and logistic regression model (5), respectively,</p>
      <p id="Par55">
        <disp-formula id="Equ4">
          <label>4</label>
          <alternatives>
            <tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {Y}_i={\sum}_{j\in \Lambda}{\beta}_j\mathrm{scale}\left({\mathrm{Z}}_{ij}\right)+{\upepsilon}_i $$\end{document}</tex-math>
            <mml:math id="M74" display="block">
              <mml:msub>
                <mml:mi>Y</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:msub>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mo>∈</mml:mo>
                  <mml:mi mathvariant="normal">Λ</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:msub>
                <mml:mi>β</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:msub>
              <mml:mtext>scale</mml:mtext>
              <mml:mfenced close=")" open="(">
                <mml:msub>
                  <mml:mi mathvariant="normal">Z</mml:mi>
                  <mml:mi mathvariant="italic">ij</mml:mi>
                </mml:msub>
              </mml:mfenced>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mi mathvariant="normal">ϵ</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:math>
            <graphic xlink:href="40168_2018_517_Article_Equ4.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <disp-formula id="Equ5">
          <label>5</label>
          <alternatives>
            <tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{Logit}\ \left[\mathrm{P}\left({Y}_i=1|{\boldsymbol{Z}}_i\right)\right]=\sum \limits_{j\in \varLambda }{\beta}_j\mathrm{scale}\left({Z}_{ij}\right) $$\end{document}</tex-math>
            <mml:math id="M76" display="block">
              <mml:mtext>Logit</mml:mtext>
              <mml:mspace width="0.25em"/>
              <mml:mfenced close="]" open="[">
                <mml:mrow>
                  <mml:mi mathvariant="normal">P</mml:mi>
                  <mml:mfenced close=")" open="(" separators="|">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>Y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:msub>
                      <mml:mi mathvariant="bold-italic">Z</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mfenced>
                </mml:mrow>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:munder>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mo>∈</mml:mo>
                  <mml:mi>Λ</mml:mi>
                </mml:mrow>
              </mml:munder>
              <mml:msub>
                <mml:mi>β</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:msub>
              <mml:mtext>scale</mml:mtext>
              <mml:mfenced close=")" open="(">
                <mml:msub>
                  <mml:mi>Z</mml:mi>
                  <mml:mi mathvariant="italic">ij</mml:mi>
                </mml:msub>
              </mml:mfenced>
            </mml:math>
            <graphic xlink:href="40168_2018_517_Article_Equ5.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par56">where <italic>ϵ</italic><sub><italic>i</italic></sub> ∼ <italic>N</italic>(0, 1) is the error term, and <italic>Z</italic><sub>ij</sub> is the OTU abundance for subject <italic>i</italic> = 1, …, <italic>N</italic>. <bold><italic>β =</italic></bold> (<italic>β</italic><sub>1</sub>, …, <italic>β</italic><sub><italic>j</italic></sub>, …, <italic>β</italic><sub>|<italic>Λ</italic>|</sub>)<sup>′</sup> is a vector of coefficients for the associated OTU. <italic>Λ</italic> is a set of the indices of truly associated OTU and ∣<italic>Λ</italic>∣ is the number of associated OTU.</p>
      <p id="Par57">To estimate the empirical false discovery rate (FDR) and true positive rate (TPR) at the target rank, i.e., the OTU level, we assigned 17 OTUs (10%) as the truly associated taxa as follows. We first partitioned the phylogenetic tree of AGP data into 10 groups based on the co-phenetic distance matrix using the PAM algorithm. Then, we randomly selected two groups. If the total number of OTUs in the selected groups was greater than 17, we would stop. Otherwise, we would continue selecting the group randomly without replacement until there are ≥17 OTUs in the selected groups. Lastly, we pooled all the OTUs in the selected groups together and randomly assigned 17 OTUs as trait-associated. As the PAM algorithm partitions OTUs based on their phylogenetic distances, the associated OTUs from the clusters are phylogenetically closer to each other. This procedure is believed to be more realistic to represent the situation when associated taxa are phylogenetically related [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR32">32</xref>]. Also note that the PAM clusters are only for assigning the associated taxa, and we used the original taxonomic structure from AGP data while implementing the massMap.</p>
      <p id="Par58">For those 17 associated taxa, we considered two scenarios of association. Under scenario 1, effects of associated taxa have the same sign but varied strength, with small (β<sub>j</sub>∼ uniform (0, 2)), modest (β<sub>j</sub>∼ uniform (0, 3)) or large effect sizes (β<sub>j</sub>∼ uniform (0, 4)). In contrast, the effect directions were mixed in scenario 2, i.e., β<sub>j</sub>∼ uniform (− 2, 2), uniform (− 3,3), or uniform(− 4, 4). As sensitivity studies, we generated data where only 5% OTUs are trait-associate. This represents the condition when a much smaller proportion of OTUs are associated with the outcome. We also simulated data when associated taxa spread among the taxonomic tree. We partitioned the phylogenetic tree into 50 small groups using the PAM algorithm. Then 10% trait-associated OTUs are selected from the 50 groups instead of from the 10 groups. In the sensitivity studies, we only consider scenario 1 for the binary outcome as an illustration. In each simulation, we generated <italic>N</italic>=200 subjects and control the FDR at 0.05. Two thousand independent replications are conducted for each setting. The <italic>p</italic> values at screening rank and the target rank are estimated based on 1 × 10<sup>5</sup> permutations.</p>
    </sec>
    <sec id="Sec11">
      <title>Simulation results</title>
      <p id="Par59">In this section, we present the result for the binary outcome and defer the result for the continuous outcome in Additional files <xref rid="MOESM1" ref-type="media">1</xref>, <xref rid="MOESM2" ref-type="media">2</xref> and <xref rid="MOESM3" ref-type="media">3</xref>: Figures S1–S3. We first evaluate the screening performance of OMiAT and the aggregated method using the receiver operating characteristic (ROC) curves and the area under the curves (AUCs) at the phylum, class, order, family, and genus ranks, respectively (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). From the ROC, it is evident that OMiAT’s curves are consistently higher than those from the aggregated method for all ranks under both scenarios (Fig. <xref rid="Fig2" ref-type="fig">2a</xref> for the same effect direction and Fig. <xref rid="Fig2" ref-type="fig">2b</xref> for mixed directions). When we look into the AUC, we observe that OMiAT’s performance as a screening test is consistent between two scenarios and its AUC is highest at the phylum rank, and decreases as the taxonomic rank descends. This is explainable since OMiAT is more powerful when the group size is larger and the upper rank (such as phylum) groups consist of more target level taxa than do the lower rank groups. In contrast, the screening performance of the aggregated method is less satisfactory when the associated taxa within the testing group are more in mixed directions (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>) than in the same direction (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>), because the aggregation cancels the mixed-effect signals. Further, unlike OMiAT, the AUC of the aggregated method increases as the taxonomic rank descends because in theory the aggregated method achieves the highest power when all taxa within the group have the same effect size and direction. As groups become smaller at lower taxonomic ranks, the taxa within the group are more homogeneous, which increases the power of the aggregated method. In summary, through simulations, we verified that the aggregated method is not optimal for screening microbial associated groups at the upper rank. As expected, OMiAT exhibits marked performance as screening test statistics in the proposed two-stage framework.<fig id="Fig2"><label>Fig. 2</label><caption><p>The ROC curves and area under the curves (AUCs) for OMiAT and the aggregated method for identifying the associated groups at the phylum, class, order, family, and genus ranks, respectively, in relation to the binary outcome variable. Panel <bold>a</bold> scenario 1: associated taxa have the same positive effect direction; <bold>b</bold> scenario 2: associated taxa have mixed-effect directions</p></caption><graphic xlink:href="40168_2018_517_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par60">Figures <xref rid="Fig3" ref-type="fig">3</xref> and <xref rid="Fig4" ref-type="fig">4</xref> report the empirical FDR and the TPR at the target rank for OMiAT-HBH, OMiAT-SST, AGG-HBH, and AGG-SST two-stage tests, when their screening tests are conducted at different taxonomic ranks for two association scenarios, respectively. The traditional one-stage method with BH procedure is considered as the benchmark in this simulation. The empirical FDR is defined as the proportion of the false discoveries among all discoveries at the target rank. From Figs. <xref rid="Fig3" ref-type="fig">3a</xref> and <xref rid="Fig4" ref-type="fig">4a</xref>, we observe that OMiAT-HBH and OMiAT-SST’s empirical FDRs are well-controlled around the nominal level 0.05, except when the screening test is conducted at genus rank in Scenario 2 with small effect size (empirical FDR = 0.064 and 0.062 for OMiAT-HBH and OMiAT-SST, respectively). Both AGG-HBH and AGG-SST can control the empirical FDR when the associated taxa are in the same direction (Fig. <xref rid="Fig3" ref-type="fig">3a</xref>), but they are susceptible to having inflated FDRs when the associated taxa are in mixed directions especially at the lower rank (Fig. <xref rid="Fig4" ref-type="fig">4a</xref>).<fig id="Fig3"><label>Fig. 3</label><caption><p>The false discovery rate (<bold>a</bold>) and true positive rate (power) (<bold>b</bold>) of massMap and the traditional BH method for the binary outcome variable. Scenario 1: the associated taxa have the same effect direction, with small (β ∼ uniform(0, 2), left panel), modest (β ∼ uniform(0, 3), middle panel), and large effect size (β ∼ uniform(0, 4), right panel)</p></caption><graphic xlink:href="40168_2018_517_Fig3_HTML" id="MO3"/></fig><fig id="Fig4"><label>Fig. 4</label><caption><p>The false discovery rate (<bold>a</bold>) and true positive rate (power) (<bold>b</bold>) of massMap and the traditional BH method for the binary outcome variable. Scenario 2: the associated taxa have mixed effect directions, with small (β ∼ uniform(−2, 2), left panel), modest (β ∼ uniform(−3, 3), middle panel), and large effect size (β ∼ uniform(−4, 4), right panel)</p></caption><graphic xlink:href="40168_2018_517_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par61">The TPR (power) is defined as the proportion of true positives among the true associated taxa at the target rank. Both AGG-HBH and AGG-SST suffer from poor power in both scenarios, owing to the inferior screening performance of the aggregated method. So we just focus on comparing the two-stage OMiAT-HBH and OMiAT-SST with the traditional BH method in the following. The proposed two-stage framework using OMiAT as the screening test has substantial power gain against the traditional BH method, no matter which rank is selected as the screening rank (Figs <xref rid="Fig3" ref-type="fig">3b</xref> and <xref rid="Fig4" ref-type="fig">4b</xref>). Noticeably, both OMiAT-HBH and OMiAT-SST reach the highest power when family rank is selected as the screening rank. This is a result of the balance between the screening test’s power and proportion of truly associated taxa among the significant groups. Comparing the results of HBH and SST for controlling FDR, we can see that HBH has relatively higher power than SST, since at the target rank, HBH corrects for the multiple comparisons within each discovered group. In comparison, SST pools candidate taxa from discovered groups together, leading to a higher penalty for multiple comparisons. When the rank of family is chosen as the screening stage, the results for HBH and SST are similar.</p>
      <p id="Par62">The result for the continuous outcome is consistent with that for the binary outcome, as shown in Additional files <xref rid="MOESM1" ref-type="media">1</xref>, <xref rid="MOESM2" ref-type="media">2</xref> and <xref rid="MOESM3" ref-type="media">3</xref>: Figures S1-S3. Results of sensitivity studies show that OMiAT-HBH/OMiAT-SST has the FDR well controlled around the nominal level and has marked improvement on statistical power compared with BH and AGG-HBH/AGG-SST, when a much smaller proportion of OTUs are associated with the outcome (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Figure S4) and when associated taxa spread among the taxonomic tree (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Figure S5). In summary, two implementations of massMap, i.e., OMiAT-HBH and OMiAT-SST control the FDR around the nominal level for most of the simulation scenarios. They achieve substantial statistical power gain over the aggregated method based on the two-stage method and the traditional one-stage method, as they successfully incorporate the dependence structure into the microbial association mapping; their statistical powers peak when the screening is performed at the middle taxonomic rank family. Based on the simulation results, we recommend conducting the screening at the family rank using massMap.</p>
    </sec>
    <sec id="Sec12">
      <title>Real data applications</title>
      <p id="Par63">Here, we apply OMiAT-HBH, OMiAT-SST, AGG-HBH, AGG-SST, and traditional BH methods to the population-based American Gut Project (AGP) study and a murine gut microbiome dataset [<xref ref-type="bibr" rid="CR28">28</xref>] to further compare their performance.</p>
    </sec>
    <sec id="Sec13">
      <title>American Gut Project</title>
      <p id="Par64">The American Gut Project (<ext-link ext-link-type="uri" xlink:href="http://www.americangut.org">www.americangut.org</ext-link>) is a crowd-sourced project aimed at creating a comprehensive map of the human microbiome. The data include 16S rRNA V4 region sequences from 8610 fecal samples using Illumina MiSeq platform as well as the subjects’ metadata, as described in [<xref ref-type="bibr" rid="CR33">33</xref>]. The full data set includes 22,891 OTUs from 7293 baseline samples. In our analyses, we excluded subjects who (1) were not USA resident; (2) had missing values in variables: sex, gender, body mass index (BMI), or antibiotic history (ABH); (3) were alcoholics; or (4) had BMI ≥ 80. After filtering, 1134 unique baseline samples were retained for analysis. Next, OTUs aligned to the bacteria kingdom were further filtered if (1) they could not be aligned to a family rank, or (2) they are presented in less than 3 individuals, or (3) average relative abundance &lt;0.1%. After filtering, the abundance data related to 90 species were used for our analyses. We performed the microbial association mapping at the species rank on a binary outcome antibiotic history (ABH) and a continuous outcome body mass index (BMI), respectively. Sex and age are adjusted in both analyses.</p>
      <sec id="Sec14">
        <title>Antibiotic history (ABH)</title>
        <p id="Par65">The ABH was coded into a binary response to indicate whether the subject had (ABH = 1, <italic>n</italic> = 761) or had not had (ABH = 0, <italic>n</italic> = 373) antibiotic usage in the preceding year. The logistic regression model in Eq. (<xref rid="Equ1" ref-type="">1</xref>) was used to fit the data. As suggested by the simulation results, family rank was selected to conduct the screening test. With FDR = 0.05, 12 family groups (consisting of 37 species) were significantly associated with ABH by OMiAT, while only four groups (consisting of 5 species) are reported by the aggregated method (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table S1). This indicates that OMiAT is much more powerful as a screening test compared with the aggregated method.</p>
        <p id="Par66">OMiAT-HBH, OMiAT-SST, and traditional BH methods each identified 15 ABH-associated species, among which 14 species are common (Table <xref rid="Tab1" ref-type="table">1</xref>). In contrast, AGG-HBH and AGG-SST only identified five ABH associated species due to the miss-hits of the aggregated method at the screening rank. One possible reason that OMiAT-HBH/OMiAT-SST and the traditional BH method had similar performance was that the antibiotic effect was sufficiently strong to pass the stringent multiple comparison corrections in the traditional BH method in this study. However, OMiAT-HBH and OMiAT-SST produced much smaller FDR-adjusted <italic>p</italic> values than did the traditional BH method, which implies that OMiAT-HBH and OMiAT-SST are more efficient. The microbial association mapping results of OMiAT-HBH/OMiAT-SST are illustrated on a taxonomic tree (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). There are four ABH associated microbial species clustered in family <italic>Lachnospiraceae</italic> and two species clustered in family M<italic>icrococcaceae</italic>. These observations are consistent with the hypothesis that evolutionarily closer taxa usually have similar responses to exposures. Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Figure S6 shows the relative abundance distributions for discovered species. <italic>[Ruminococcus] gnavus</italic>, <italic>Proteus|Other</italic>, <italic>Rothia mucilaginosa</italic>, <italic>Streptococcus|Other</italic>, <italic>Actinomyces|Other</italic>, <italic>[Eubacterium] dolichum</italic>, <italic>Rothia dentocariosa</italic>, <italic>Granulicatella|Other</italic>, and <italic>Haemophilus parainfluenzae</italic> are more abundant in ABH = 1 group; and <italic>Ruminococcaceae|Other</italic>, <italic>Odoribacter|Other</italic>, <italic>Christensenellaceae|Other</italic>, <italic>Anaerostipes|Other</italic>, <italic>Coprococcus|Other</italic>, and <italic>Dorea formicigenerans</italic> are more abundant in ABH = 0 group.<table-wrap id="Tab1"><label>Table 1</label><caption><p>The raw and FDR-adjusted <italic>p</italic> values for the detected ABH-associated species using the AGP data (FDR = 0.05). Adjusted <italic>p</italic> values ≥0.05 are left blank</p></caption><table frame="hsides" rules="groups"><thead><tr><th>OTU ID</th><th>Species</th><th>Raw <italic>p</italic> value</th><th>BH</th><th>OMiAT-HBH</th><th>OMiAT-SST</th><th>AGG-HBH</th><th>AGG-SST</th></tr></thead><tbody><tr><td>132657</td><td><italic>Ruminococcaceae|Other</italic></td><td>&lt; 2.0E-06</td><td>1.80E-04</td><td>1.00E-05</td><td>7.40E-05</td><td/><td/></tr><tr><td>164719</td><td><italic>[Ruminococcus] gnavus</italic></td><td>9.40E-05</td><td>4.20E-03</td><td>1.10E-03</td><td>1.70E-03</td><td/><td/></tr><tr><td>4385479</td><td><italic>Proteus|Other</italic></td><td>2.90E-04</td><td>8.80E-03</td><td>1.20E-03</td><td>3.60E-03</td><td/><td/></tr><tr><td>4476877</td><td><italic>Odoribacter|Other</italic></td><td>5.60E-04</td><td>1.30E-02</td><td>1.10E-03</td><td>5.20E-03</td><td/><td/></tr><tr><td>903426</td><td><italic>Rothia mucilaginosa</italic></td><td>7.70E-04</td><td>1.40E-02</td><td>1.50E-03</td><td>5.70E-03</td><td>1.50E-03</td><td>3.20E-03</td></tr><tr><td>145236</td><td><italic>Christensenellaceae|Other</italic></td><td>1.30E-03</td><td>1.90E-02</td><td>1.30E-03</td><td>7.90E-03</td><td>1.30E-03</td><td>3.20E-03</td></tr><tr><td>1005952</td><td><italic>Streptococcus|Other</italic></td><td>3.40E-03</td><td>3.10E-02</td><td>3.40E-03</td><td>1.40E-02</td><td>3.40E-03</td><td>4.30E-03</td></tr><tr><td>4463237</td><td><italic>Actinomyces|Other</italic></td><td>3.40E-03</td><td>3.10E-02</td><td>3.40E-03</td><td>1.40E-02</td><td>3.40E-03</td><td>4.30E-03</td></tr><tr><td>177828</td><td><italic>Anaerostipes|Other</italic></td><td>3.50E-03</td><td>3.10E-02</td><td>2.10E-02</td><td>1.40E-02</td><td/><td/></tr><tr><td>4328910</td><td><italic>Veillonella parvula</italic></td><td>3.50E-03</td><td>3.10E-02</td><td/><td/><td/><td/></tr><tr><td>4396877</td><td><italic>[Eubacterium] dolichum</italic></td><td>4.30E-03</td><td>3.50E-02</td><td>1.70E-02</td><td>1.60E-02</td><td/><td/></tr><tr><td>4466006</td><td><italic>Rothia dentocariosa</italic></td><td>5.00E-03</td><td>3.80E-02</td><td>5.00E-03</td><td>1.70E-02</td><td>5.00E-03</td><td>5.00E-03</td></tr><tr><td>47862</td><td><italic>Coprococcus|Other</italic></td><td>7.90E-03</td><td>4.90E-02</td><td>3.20E-02</td><td>2.20E-02</td><td/><td/></tr><tr><td>1102921</td><td><italic>Granulicatella|Other</italic></td><td>8.10E-03</td><td>4.90E-02</td><td>8.10E-03</td><td>2.20E-02</td><td/><td/></tr><tr><td>2654263</td><td><italic>Haemophilus parainfluenzae</italic></td><td>8.20E-03</td><td>4.90E-02</td><td>8.20E-03</td><td>2.20E-02</td><td/><td/></tr><tr><td>4424063</td><td><italic>Dorea formicigenerans</italic></td><td>1.50E-02</td><td/><td>4.40E-02</td><td>3.60E-02</td><td/><td/></tr><tr><td colspan="3">Number of detected ABH-associated species</td><td>15</td><td>15</td><td>15</td><td>5</td><td>5</td></tr></tbody></table></table-wrap><fig id="Fig5"><label>Fig. 5</label><caption><p>The microbial association mapping of antibiotic history (ABH) in American Gut Project subjects (FDR = 0.05). ABH-associated species with corresponding significant taxonomic groups reported by OMiAT-HBH and OMiAT-SST are highlighted. The taxonomic tree was generated using GraPhlAn [<xref ref-type="bibr" rid="CR46">46</xref>]. The nodes on the tree from inner to outer circles are the phylum, class, order, family, genus, and species rank. The corresponding annotations are written in the reverse order. Family rank is selected to conduct the screening test for massMap</p></caption><graphic xlink:href="40168_2018_517_Fig5_HTML" id="MO5"/></fig></p>
      </sec>
      <sec id="Sec15">
        <title>Body mass index (BMI)</title>
        <p id="Par67">The linear regression model in Eq. (<xref rid="Equ2" ref-type="">2</xref>) was adopted to investigate the association between BMI for the AGP subjects and microbes at the species level. In massMap, as suggested by the simulations, screening tests were first performed at the family rank. With FDR = 0.10, 5 family groups (consisting of 13 species) were identified as associated with BMI by OMiAT, whereas none was identified by the aggregated method (Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Table S2). Considering the target species level, the traditional BH, OMiAT-HBH, OMiAT-SST, AGG-HBH, and AGG-SST methods detected 1, 6, 6, 0, and 0 significant taxa associated with BMI respectively. The associated species identified by OMiAT-HBH/OMiAT-SST are further presented in the taxonomic tree in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. Compared with the traditional BH and massMap with the aggregated method, OMiAT-HBH and OMiAT-SST discover more taxa and exhibit extra power gain, consistent with the simulations.<fig id="Fig6"><label>Fig. 6</label><caption><p>The microbial association mapping of body mass index (BMI) in American Gut Project subjects (FDR = 0.10). The associated species with corresponding significant taxonomic groups identified by OMiAT-HBH and OMiAT-SST are highlighted in the taxonomic tree. Among six detected species, <italic>[Eubacterium] biforme</italic> in phylum <italic>Firmicutes</italic> is also detected by the traditional BH method. The taxonomic tree was generated using GraPhlAn [<xref ref-type="bibr" rid="CR46">46</xref>]. The nodes on the tree from inner to outer circles are the phylum, class, order, family, genus, and species rank. The corresponding annotations are written in the reverse order. Family rank is selected to conduct the screening test for massMap</p></caption><graphic xlink:href="40168_2018_517_Fig6_HTML" id="MO6"/></fig></p>
        <p id="Par68">The OMiAT-HBH/OMiAT-SST identified species: <italic>[Eubacterium] biforme</italic>, <italic>Bifidobacterium|Other</italic>, <italic>Catenibacterium|Other</italic>, and <italic>Prevotella stercorea</italic> (bold highlighted in Table <xref rid="Tab2" ref-type="table">2</xref>) were also reported to be associated with BMI or related phenotypes in other studies [<xref ref-type="bibr" rid="CR34">34</xref>–<xref ref-type="bibr" rid="CR36">36</xref>]. Our results show that the abundances of <italic>[Eubacterium] biforme</italic>, <italic>Catenibacterium|Other</italic>, and <italic>Prevotella stercorea</italic> were positively associated with BMI; and the abundance of <italic>Bifidobacterium|Other</italic> was negatively associated with BMI (Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Figure S7). In two separate studies [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>], genus <italic>Bifidobacterium</italic> was present at higher abundance in normal-weight than in overweight women. In another study, two <italic>Bifidobacterium</italic> strains have significant effects on obesity in high-fat diet induced rats [<xref ref-type="bibr" rid="CR34">34</xref>]. Zhang et al. (2008) [<xref ref-type="bibr" rid="CR35">35</xref>] reported that the <italic>Erysipelotrichaceae</italic> (from phylum <italic>Firmicutes</italic>) and <italic>Prevotellaceae</italic> (from phylum <italic>Bacteroidetes</italic>) families are more abundant in the obesity group than in the normal weight group. In our analyses, identifying microbial associations at the species level, <italic>Catenibacterium|Other</italic> with OTU ID 4480861 from family <italic>Erysipelotrichaceae</italic>, and <italic>Prevotella stercorea</italic> with OTU ID 513664 from family <italic>Prevotellaceae</italic> were positively associated with BMI.<table-wrap id="Tab2"><label>Table 2</label><caption><p>The raw and FDR-adjusted <italic>p</italic> values for the detected BMI-associated species using the AGP data (FDR = 0.10). Adjusted <italic>p</italic> values ≥0.10 are left blank. Note that there is no associated species reported by the aggregated method. The biological evidence for the bold highlighted taxa has been found in the literature [<xref ref-type="bibr" rid="CR34">34</xref>–<xref ref-type="bibr" rid="CR36">36</xref>] and discussed in the text</p></caption><table frame="hsides" rules="groups"><thead><tr><th>OTU ID</th><th>Species</th><th>Raw p-value</th><th>BH</th><th>OMiAT-HBH</th><th>OMiAT-SST</th></tr></thead><tbody><tr><td>297635</td><td><bold><italic>[Eubacterium] biforme</italic></bold></td><td>1.90E-04</td><td>1.70E-02</td><td>7.60E-04</td><td>2.50E-03</td></tr><tr><td>824876</td><td><bold><italic>Bifidobacterium|Other</italic></bold></td><td>2.70E-03</td><td/><td>5.30E-03</td><td>1.70E-02</td></tr><tr><td>4319938</td><td><italic>Clostridiaceae|Other</italic></td><td>1.00E-02</td><td/><td>2.00E-02</td><td>3.50E-02</td></tr><tr><td>840279</td><td><italic>[Barnesiellaceae]|Other</italic></td><td>1.10E-02</td><td/><td>1.10E-02</td><td>3.50E-02</td></tr><tr><td>4480861</td><td><bold><italic>Catenibacterium|Other</italic></bold></td><td>1.50E-02</td><td/><td>3.10E-02</td><td>4.00E-02</td></tr><tr><td>513664</td><td><bold><italic>Prevotella stercorea</italic></bold></td><td>2.00E-02</td><td/><td>8.00E-02</td><td>4.30E-02</td></tr><tr><td colspan="3">Number of detected BMI-associated species</td><td>1</td><td>6</td><td>6</td></tr></tbody></table></table-wrap></p>
        <p id="Par69">As a sensitivity analysis, the traditional BH, OMiAT-HBH, OMiAT-SST, AGG-HBH, and AGG-SST methods detected 1, 3, 3, 0, and 0 significant species associated with BMI respectively with FDR = 0.05 (Additional file <xref rid="MOESM10" ref-type="media">10</xref>: Table S3). All methods identified fewer species when a more stringent FDR threshold was used, but OMiAT-HBH and OMiAT-SST discovered more.</p>
      </sec>
    </sec>
    <sec id="Sec16">
      <title>The effects of early-life antibiotics on murine intestinal microbiota</title>
      <p id="Par70">Livanos et al. (2016) [<xref ref-type="bibr" rid="CR28">28</xref>] has conducted a longitudinal microbiome study to examine whether early-life sub-therapeutic antibiotic treatment (STAT) would alter the gut microbiota and accelerate T1D onset in non-obese diabetic (NOD) mice. DNA samples from feces were analyzed by targeting the V4 region of the bacterial 16S rRNA genes as described in [<xref ref-type="bibr" rid="CR37">37</xref>]. Using the QIIME pipeline [<xref ref-type="bibr" rid="CR38">38</xref>], OTU table and phylogenetic tree were created for 28 control and 21 STAT male mice. Compared with the observational AGP data, the number of observed OTUs and the size of the phylogenetic tree are both much smaller in this experimental mouse study. We re-examined the antibiotic effect on the fecal microbiome immediately after weaning (week 3). Originally, 75 species were observed. After filtering species that were present in ≤ 3 mice, 36 were retained for analysis.</p>
      <p id="Par71">The logistic regression model in Eq. (<xref rid="Equ1" ref-type="">1</xref>) was employed to detect differentially abundant species between the STAT and control groups. The screening test was conducted at the family rank in massMap. With FDR = 0.05, OMiAT and the aggregated method identified four and two groups associated with the antibiotic treatment, respectively (Additional file <xref rid="MOESM11" ref-type="media">11</xref>: Table S4). At the target species rank, the traditional BH, OMiAT-HBH, OMiAT-SST, AGG-HBH, and AGG-SST methods detected 9, 11, 11, 4, and 4 significant species associated with antibiotic treatment respectively (Table <xref rid="Tab3" ref-type="table">3</xref>). massMap using OMiAT, i.e., OMiAT-HBH and OMiAT-SST, reported two more significant species than the traditional BH method, whereas the aggregated method had the fewest findings. Two species <italic>Lactobacillus delbrueckii</italic> and <italic>Oscillospira guilliermondii</italic> explicitly reported by OMiAT-HBH and OMiAT-SST have much lower relative abundances in STAT mice than in control mice (Additional file <xref rid="MOESM12" ref-type="media">12</xref>: Figure S8). The associated species reported by the OMiAT-HBH and OMiAT-SST are presented in the taxonomic tree (Fig. <xref rid="Fig7" ref-type="fig">7</xref>), and they indicate a clear clustering association pattern. From the figure, we observe that there are four associated species clustered in family <italic>Lachnospiraceae</italic> and four species clustered in family <italic>Ruminococcaceae</italic> that are differentially presented in STAT and control groups. With clustered signals, massMap achieves higher power as expected.<table-wrap id="Tab3"><label>Table 3</label><caption><p>The raw and FDR-adjusted <italic>p</italic> values for the detected STAT-associated species using the murine data (FDR = 0.05). Adjusted <italic>p</italic> values ≥0.05 are left blank</p></caption><table frame="hsides" rules="groups"><thead><tr><th>OTU ID</th><th>Species</th><th>Raw <italic>p</italic> value</th><th>BH</th><th>OMiAT-HBH</th><th>OMiAT-SST</th><th>AGG-HBH</th><th>AGG-SST</th></tr></thead><tbody><tr><td>33701</td><td><italic>Adlercreutzia| Other</italic></td><td>2.90E-04</td><td>1.00E-02</td><td>2.90E-04</td><td>5.10E-03</td><td/><td/></tr><tr><td>37580</td><td><italic>Lactobacillus| Other</italic></td><td>1.70E-03</td><td>2.40E-02</td><td>6.90E-03</td><td>1.20E-02</td><td/><td/></tr><tr><td>9867</td><td><italic>Ruminococcaceae| Other</italic></td><td>2.00E-03</td><td>2.40E-02</td><td>9.20E-03</td><td>1.20E-02</td><td>9.20E-03</td><td>6.90E-03</td></tr><tr><td>50804</td><td><italic>Ruminococcus| Other</italic></td><td>3.70E-03</td><td>3.00E-02</td><td>9.20E-03</td><td>1.50E-02</td><td>9.20E-03</td><td>8.00E-03</td></tr><tr><td>47849</td><td><italic>Oscillospira| Other</italic></td><td>4.60E-03</td><td>3.00E-02</td><td>9.20E-03</td><td>1.50E-02</td><td>9.20E-03</td><td>8.00E-03</td></tr><tr><td>34428</td><td><italic>Coprococcus| Other</italic></td><td>5.40E-03</td><td>3.00E-02</td><td>1.30E-02</td><td>1.50E-02</td><td/><td/></tr><tr><td>195457</td><td><italic>Blautia producta</italic></td><td>6.80E-03</td><td>3.00E-02</td><td>1.30E-02</td><td>1.50E-02</td><td/><td/></tr><tr><td>35567</td><td><italic>[Ruminococcus] gnavus</italic></td><td>7.00E-03</td><td>3.00E-02</td><td>1.30E-02</td><td>1.50E-02</td><td/><td/></tr><tr><td>2416</td><td><italic>Anaerostipes| Other</italic></td><td>7.60E-03</td><td>3.00E-02</td><td>1.30E-02</td><td>1.50E-02</td><td/><td/></tr><tr><td>10675</td><td><italic>Lactobacillus delbrueckii</italic></td><td>1.70E-02</td><td/><td>3.30E-02</td><td>3.00E-02</td><td/><td/></tr><tr><td>20780</td><td><italic>Oscillospira guilliermondii</italic></td><td>2.30E-02</td><td/><td>3.50E-02</td><td>3.80E-02</td><td>3.50E-02</td><td>3.20E-02</td></tr><tr><td colspan="3">Number of detected STAT-associated species</td><td>9</td><td>11</td><td>11</td><td>4</td><td>4</td></tr></tbody></table></table-wrap><fig id="Fig7"><label>Fig. 7</label><caption><p>The microbial association mapping of STAT vs control groups using the murine data (FDR = 0.05). STAT-associated species with corresponding significant taxonomic groups reported by OMiAT-HBH and OMiAT-SST are highlighted. The taxonomic tree was generated using GraPhlAn [<xref ref-type="bibr" rid="CR46">46</xref>]. The nodes on the tree from inner to outer circles are the phylum, class, order, family, genus, and species rank. The corresponding annotations are written in the reverse order. Family rank is selected to conduct the screening test for massMap</p></caption><graphic xlink:href="40168_2018_517_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Discussion</title>
    <p id="Par72">massMap can easily be extended to examine survival outcome. A highly adaptive microbial group association test for survival outcome (OMiSA) has been separately developed by our group [<xref ref-type="bibr" rid="CR39">39</xref>]. Upon publication, it will be added to our massMap software. Furthermore, the concepts underlying massMap can be generalized to the functional pathway analysis of metagenomics data. Confronting numerous pathways, one can first test for differential microbial abundance at the pathway level and then proceed to test for differential microbial abundance at the gene family level. In practice, to implement massMap, it is required to pre-determine the screening rank. Based on the simulation results and our practical experience with the real data analyses, we recommend conducting the screening at the middle taxonomic rank family. We should note that massMap is an association mapping tool and does not make causal inference. It provides candidate microbial taxa for the follow-up validation studies, where additional experiments could elucidate the causal role of the discovered taxa on the outcome trait.</p>
    <p id="Par73">massMap uses the relative abundance of taxa to perform the association analysis. The relative abundance data is compositional as the summation in each sample is constrained to one [<xref ref-type="bibr" rid="CR40">40</xref>]. The log-ratio transformation of relative abundances have been used to relieve the compositionality issue [<xref ref-type="bibr" rid="CR6">6</xref>] in various methods. However, since the compositional effect is attenuating as the number of taxa increases and our goal is to detect which taxa (instead of ratio of taxa) are associated with the outcome, we prefer to work on the relative abundance for better interpretation. A school of statistical methods working on the relative abundance data have been developed, including differential abundance analyses [<xref ref-type="bibr" rid="CR41">41</xref>–<xref ref-type="bibr" rid="CR43">43</xref>] and association mapping analyses [<xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR29">29</xref>].</p>
    <p id="Par74">We shed light on the usage of advanced FDR controlling methodologies [<xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR24">24</xref>] in the two-stage microbial association analysis. Our simulations were based on the large-scale population-level microbiome AGP study with 174 OTUs after filtering. The HBH and SST FDR-controlling procedures can control the FDR in most scenarios while among few scenarios, we did observe minor FDR inflation in HBH and/or SST procedures. Similar two-stage analysis has been studied in analyzing microarray data; when there are a large number of hypotheses (usually in the thousands) at the target level in microarray studies, an inflated FDR for the HBH procedure has been reported [<xref ref-type="bibr" rid="CR21">21</xref>]. Reiner-Benaim et al. (2007) [<xref ref-type="bibr" rid="CR25">25</xref>] presented a corrected threshold <italic>q</italic><sup>∗</sup> for both stages to control the FDR around the nominal level in the microarray data analysis setting. A similar correction can be considered if the number of hypotheses in the application is very large.</p>
    <p id="Par75">Sankaran and Holmes (2014) [<xref ref-type="bibr" rid="CR44">44</xref>] applied the HBH procedure to an environmental microbiome dataset based on phylogenetic tree of the microbes, which is different from the proposed massMap based on the taxonomic tree. The phylogenetic tree is deeper than the taxonomic tree with complex structure. It consists of many levels and every parent node has a maximum of two daughter nodes. It is not clear whether the HBH procedure applied to the phylogenetic tree proposed in [<xref ref-type="bibr" rid="CR38">38</xref>] can control FDRs or not. Xiao et al. (2017) [<xref ref-type="bibr" rid="CR45">45</xref>] also proposed an FDR-controlling method based on the hierarchical tree (TreeFDR), with the underlying assumption that associated taxa have the same effect direction and are clustered in the phylogenetic tree. When this assumption is violated such as in scenario 2 of our simulation study, TreeFDR would suffer great power loss as the aggregated method did.</p>
  </sec>
  <sec id="Sec18">
    <title>Conclusions</title>
    <p id="Par76">In this paper, we focus on developing a two-stage microbial association mapping framework called massMap for binary and continuous outcomes. MassMap incorporates the highly powerful microbial group test OMiAT for screening and HBH/SST for the control of FDR. Compared with the traditional one-stage method, massMap achieves marked improvements in statistical power while well controlling FDR under most scenarios. Consequently, we recommend that massMap can be extensively used for microbiome-wide association analyses as a highly efficient method.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec19">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="40168_2018_517_MOESM1_ESM.pdf">
            <label>Additional file 1:</label>
            <caption>
              <p><bold>Figure S1.</bold> The ROC curves and area under the ROC curves (AUCs) for OMiAT and the aggregated method for identifying the associated groups at the phylum, class, order, family, and genus ranks, respectively, in relation to the continuous outcome variable. Panel (A) scenario 1: analysis of associated taxa that have the same positive effect direction. (B) Scenario 2: analysis of associated taxa that have mixed effect directions. (PDF 13004 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="40168_2018_517_MOESM2_ESM.png">
            <label>Additional file 2:</label>
            <caption>
              <p><bold>Figure S2.</bold> The false discovery rate (A) and true positive rate (power) (B) of massMap and the traditional BH method for the continuous outcome variable. Scenario 1: the associated taxa have the same effect direction, with small (β ∼ uniform(0, 2), left panel), modest (β ∼ uniform(0, 3), middle panel), and large (β ∼ uniform(0, 4), right panel) effect sizes. (PNG 397 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="40168_2018_517_MOESM3_ESM.png">
            <label>Additional file 3:</label>
            <caption>
              <p><bold>Figure S3.</bold> The false discovery rate (A) and true positive rate (power) (B) of massMap and the traditional BH method for the continuous outcome variable. Scenario 2: the associated taxa have mixed effect directions, with small (β ∼ uniform(−2, 2), left panel), modest (β ∼ uniform(−3, 3), middle panel), and large (β ∼ uniform(−4, 4), right panel) effect sizes. (PNG 370 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="40168_2018_517_MOESM4_ESM.png">
            <label>Additional file 4:</label>
            <caption>
              <p><bold>Figure S4.</bold> The false discovery rate (A) and true positive rate (power) (B) of massMap and the traditional BH method for the binary outcome variable. Five percent OTUs are assigned as the truly associated taxa and have the same effect direction, with small (β ∼ uniform(0, 2), left panel), modest (β ∼ uniform(0, 3), middle panel), and large (β ∼ uniform(0, 4), right panel) effect sizes. (PNG 135 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="40168_2018_517_MOESM5_ESM.png">
            <label>Additional file 5:</label>
            <caption>
              <p><bold>Figure S5.</bold> The false discovery rate (A) and true positive rate (power) (B) of massMap and the traditional BH method for the binary outcome variable. We partitioned the phylogenetic tree into 50 groups using PAM algorithm. Ten percent OTUs are assigned as trait-associated, with small (β ∼ uniform(0, 2), left panel), modest (β ∼ uniform(0, 3), middle panel), and large (β ∼ uniform(0, 4), right panel) effect sizes. (PNG 140 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="40168_2018_517_MOESM6_ESM.pdf">
            <label>Additional file 6:</label>
            <caption>
              <p><bold>Table S1.</bold> Candidate taxonomic groups at the family rank associated with a history of recent antibiotic use (ABH) in the AGP data analysis. Groups were detected either by OMiAT or by the aggregate method, respectively. FDR = 0.05. (PDF 91 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="40168_2018_517_MOESM7_ESM.pdf">
            <label>Additional file 7:</label>
            <caption>
              <p><bold>Figure S6.</bold> Relative abundances of ABH-associated species present in the fecal samples from AGP subjects without (indicated as 0) or with (indicated as 1) recent antibiotic use (ABH). The species were detected by the proposed two-stage framework OMiAT-HBH and OMiAT-SST. The groups with/without recent antibiotic exposure had 761 and 373 subjects, respectively. (PDF 930 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="40168_2018_517_MOESM8_ESM.pdf">
            <label>Additional file 8:</label>
            <caption>
              <p><bold>Table S2.</bold> The family groups that were associated with BMI detected by OMiAT in AGP data (FDR = 0.10). The aggregated method did not identify any significant groups at the family rank. (PDF 143 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="40168_2018_517_MOESM9_ESM.pdf">
            <label>Additional file 9:</label>
            <caption>
              <p><bold>Figure S7.</bold> The relative abundances of BMI-associated species for AGP subjects grouped by their BMI quantile. The species shown had been detected by the proposed two-stage framework OMiAT-HBH and OMiAT-SST (FDR = 0.10). (PDF 309 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="40168_2018_517_MOESM10_ESM.pdf">
            <label>Additional file 10:</label>
            <caption>
              <p><bold>Table S3.</bold> The unadjusted and FDR-adjusted <italic>p</italic> values for the detected BMI-associated species using the AGP data (FDR = 0.05). Adjusted <italic>p</italic> values ≥0.05 are left blank. There were no associated species identified by the aggregated method. (PDF 155 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM11">
          <media xlink:href="40168_2018_517_MOESM11_ESM.pdf">
            <label>Additional file 11:</label>
            <caption>
              <p><bold>Table S4.</bold> Candidate groups (at the family rank) associated with STAT exposure, detected by OMiAT or by the aggregated method, respectively, using data from a murine experiment [<xref ref-type="bibr" rid="CR28">28</xref>] (FDR = 0.05). (PDF 85 kb)</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM12">
          <media xlink:href="40168_2018_517_MOESM12_ESM.pdf">
            <label>Additional file 12:</label>
            <caption>
              <p><bold>Figure S8.</bold> Comparison of the relative abundances (RA) of the significant species between control (CONT) and STAT (STAT) groups. The species were detected by massMap: OMiAT-HBH and OMiAT-SST (FDR = 0.05). (PDF 1883 kb)</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ABH</term>
        <def>
          <p id="Par5">Antibiotic history</p>
        </def>
      </def-item>
      <def-item>
        <term>AGG</term>
        <def>
          <p id="Par6">The aggregated method</p>
        </def>
      </def-item>
      <def-item>
        <term>AGP</term>
        <def>
          <p id="Par7">American Gut Project</p>
        </def>
      </def-item>
      <def-item>
        <term>BH</term>
        <def>
          <p id="Par8">Benjamini-Hochberg</p>
        </def>
      </def-item>
      <def-item>
        <term>BMI</term>
        <def>
          <p id="Par9">Body mass index</p>
        </def>
      </def-item>
      <def-item>
        <term>DM</term>
        <def>
          <p id="Par10">Dirichlet-multinomial</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p id="Par11">False discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>HBH</term>
        <def>
          <p id="Par12">Hierarchical BH</p>
        </def>
      </def-item>
      <def-item>
        <term>MiRKAT</term>
        <def>
          <p id="Par13">Microbiome regression-based kernel association test</p>
        </def>
      </def-item>
      <def-item>
        <term>NOD mice</term>
        <def>
          <p id="Par14">Non-obese diabetic mice</p>
        </def>
      </def-item>
      <def-item>
        <term>OMiAT</term>
        <def>
          <p id="Par15">Optimal microbiome-based association test</p>
        </def>
      </def-item>
      <def-item>
        <term>OTU</term>
        <def>
          <p id="Par16">Operational taxonomic unit</p>
        </def>
      </def-item>
      <def-item>
        <term>RA</term>
        <def>
          <p id="Par17">Relative abundance</p>
        </def>
      </def-item>
      <def-item>
        <term>SPU</term>
        <def>
          <p id="Par18">Sum of score powered tests</p>
        </def>
      </def-item>
      <def-item>
        <term>SST</term>
        <def>
          <p id="Par19">Selected subset testing</p>
        </def>
      </def-item>
      <def-item>
        <term>STAT</term>
        <def>
          <p id="Par20">Sub-therapeutic antibiotic treatment</p>
        </def>
      </def-item>
      <def-item>
        <term>T1D</term>
        <def>
          <p id="Par21">Type 1 diabetes</p>
        </def>
      </def-item>
      <def-item>
        <term>TPR</term>
        <def>
          <p id="Par22">True positive rate</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (10.1186/s40168-018-0517-1) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par77">The study was supported in part by NIH grants, R01 DK090989, R01DK110014, U01AI22285, the Diane Belfer Program in Human Microbial Ecology, and the C&amp;D Fund.</p>
    </sec>
    <sec id="FPar2">
      <title>Availability of data and materials</title>
      <p id="Par78">The raw data and metadata of the American Gut Project is publicly available at the ftp website (<ext-link ext-link-type="uri" xlink:href="ftp://ftp.microbio.me/AmericanGut/">ftp://ftp.microbio.me/AmericanGut/</ext-link>). Version 07/29/2016 is used in our analyses. 16S rRNA sequencing data of the T1D mice is publicly available at EBI with accession number ERP016357.</p>
      <p id="Par79">The R package massMap implementing the two-stage microbial association mapping framework is publicly available at <ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/huilinli09/software">https://sites.google.com/site/huilinli09/software</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/JiyuanHu/">https://github.com/JiyuanHu/</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>JH developed the two-stage microbial association mapping framework, performed simulation analyses, real data analyses and manuscript writing. HK performed simulation analyses and manuscript writing. LH performed real data analyses and manuscript writing. ML performed real data analyses and provided the biological insights and interpretation. MJB contributed to the biological insights and interpretation, and to manuscript writing. HL contributed to the methodological ideas for the proposed framework, simulations, real data analyses, and manuscript writing. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par80">All utilized microbiome datasets are publicly available. No ethics approval or consent to participate was required for this study.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p id="Par81">Not applicable. All utilized microbiome datasets are publicly available. No consent for publication was required for this study.</p>
    </sec>
    <sec id="FPar5">
      <title>Competing interests</title>
      <p id="Par82">The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar6">
      <title>Publisher’s Note</title>
      <p id="Par83">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clemente</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Ursell</surname>
            <given-names>LK</given-names>
          </name>
          <name>
            <surname>Parfrey</surname>
            <given-names>LW</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>The impact of the gut microbiota on human health: an integrative view</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>148</volume>
        <fpage>1258</fpage>
        <lpage>1270</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.01.035</pub-id>
        <?supplied-pmid 22424233?>
        <pub-id pub-id-type="pmid">22424233</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cho</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Yamanishi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Methé</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Zavadil</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Mahana</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Raju</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Teitler</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Antibiotics in early life alter the murine colonic microbiome and adiposity</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>488</volume>
        <fpage>621</fpage>
        <lpage>626</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11400</pub-id>
        <?supplied-pmid 22914093?>
        <pub-id pub-id-type="pmid">22914093</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Yamanishi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sohn</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alekseyenko</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Leung</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Mahana</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Altering the intestinal microbiota during a critical developmental window has lasting metabolic consequences</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>158</volume>
        <fpage>705</fpage>
        <lpage>721</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.05.052</pub-id>
        <?supplied-pmid 25126780?>
        <pub-id pub-id-type="pmid">25126780</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bokulich</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Battaglia</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Henderson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Jay</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lieber</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Perez-Perez</surname>
            <given-names>GI</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Antibiotics, birth mode, and diet shape microbiome maturation during early life</article-title>
        <source>Sci Transl Med</source>
        <year>2016</year>
        <volume>8</volume>
        <fpage>343ra382</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.aad7121</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Halfvarson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brislawn</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Lamendella</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vázquez-Baeza</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Bramer</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>D'Amato</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bonfiglio</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>McDonald</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Dynamics of the human gut microbiome in inflammatory bowel disease</article-title>
        <source>Nat Microbiol</source>
        <year>2017</year>
        <volume>2</volume>
        <fpage>17004</fpage>
        <pub-id pub-id-type="doi">10.1038/nmicrobiol.2017.4</pub-id>
        <?supplied-pmid 28191884?>
        <pub-id pub-id-type="pmid">28191884</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Microbiome, metagenomics, and high-dimensional compositional data analysis</article-title>
        <source>Annu Rev Stat Appl</source>
        <year>2015</year>
        <volume>2</volume>
        <fpage>73</fpage>
        <lpage>94</lpage>
        <pub-id pub-id-type="doi">10.1146/annurev-statistics-010814-020351</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lauber</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Parfrey</surname>
            <given-names>LW</given-names>
          </name>
          <name>
            <surname>Clemente</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Gevers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Experimental and analytical tools for studying the human microbiome</article-title>
        <source>Nat Rev Genet</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>47</fpage>
        <lpage>58</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3129</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>DeSantis</surname>
            <given-names>TZ</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Accurate taxonomy assignments from 16S rRNA sequences produced by highly parallel pyrosequencers</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>36</volume>
        <fpage>e120</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn491</pub-id>
        <?supplied-pmid 18723574?>
        <pub-id pub-id-type="pmid">18723574</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A model for paired-multinomial data and its application to analysis of data on a taxonomic tree</article-title>
        <source>Biometrics</source>
        <year>2017</year>
        <volume>73</volume>
        <issue>4</issue>
        <fpage>1266</fpage>
        <lpage>1278</lpage>
        <pub-id pub-id-type="doi">10.1111/biom.12681</pub-id>
        <?supplied-pmid 28369713?>
        <pub-id pub-id-type="pmid">28369713</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DeSantis</surname>
            <given-names>TZ</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Larsen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Rojas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Brodie</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dalevi</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>GL</given-names>
          </name>
        </person-group>
        <article-title>Greengenes, a chimera-checked 16S rRNA gene database and workbench compatible with ARB</article-title>
        <source>Appl Environ Microbiol</source>
        <year>2006</year>
        <volume>72</volume>
        <fpage>5069</fpage>
        <lpage>5072</lpage>
        <pub-id pub-id-type="doi">10.1128/AEM.03006-05</pub-id>
        <?supplied-pmid 16820507?>
        <pub-id pub-id-type="pmid">16820507</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cole</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Chai</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Marsh</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Farris</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Kulam</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chandra</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McGarrell</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>TM</given-names>
          </name>
          <name>
            <surname>Garrity</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>The ribosomal database project (RDP-II): previewing a new autoaligner that allows regular updates and the new prokaryotic taxonomy</article-title>
        <source>Nucleic Acids Res</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>442</fpage>
        <lpage>443</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkg039</pub-id>
        <?supplied-pmid 12520046?>
        <pub-id pub-id-type="pmid">12520046</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Structure-constrained sparse canonical correlation analysis with an application to microbiome data analysis</article-title>
        <source>Biostatistics</source>
        <year>2012</year>
        <volume>14</volume>
        <fpage>244</fpage>
        <lpage>258</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxs038</pub-id>
        <?supplied-pmid 23074263?>
        <pub-id pub-id-type="pmid">23074263</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <mixed-citation publication-type="other">Purdom E. Analysis of a data matrix and a graph: metagenomic data and the phylogenetic tree. Ann Appl Stat. 2011:2326–58.</mixed-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nobel</surname>
            <given-names>YR</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Kirigin</surname>
            <given-names>FF</given-names>
          </name>
          <name>
            <surname>Bokulich</surname>
            <given-names>NA</given-names>
          </name>
          <name>
            <surname>Yamanishi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Teitler</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sohn</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Barber</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Goldfarb</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>Metabolic and metagenomic outcomes from early-life pulsed antibiotic treatment</article-title>
        <source>Nat Commun</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>7486</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms8486</pub-id>
        <?supplied-pmid 26123276?>
        <pub-id pub-id-type="pmid">26123276</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Izard</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Waldron</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gevers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Miropolsky</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Garrett</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Huttenhower</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Metagenomic biomarker discovery and explanation</article-title>
        <source>Genome Biol</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>R60</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2011-12-6-r60</pub-id>
        <?supplied-pmid 21702898?>
        <pub-id pub-id-type="pmid">21702898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paulson</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Stine</surname>
            <given-names>OC</given-names>
          </name>
          <name>
            <surname>Bravo</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Differential abundance analysis for microbial marker-gene surveys</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1200</fpage>
        <lpage>1202</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2658</pub-id>
        <?supplied-pmid 24076764?>
        <pub-id pub-id-type="pmid">24076764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parks</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Tyson</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Hugenholtz</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Beiko</surname>
            <given-names>RG</given-names>
          </name>
        </person-group>
        <article-title>STAMP: statistical analysis of taxonomic and functional profiles</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>3123</fpage>
        <lpage>3124</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu494</pub-id>
        <?supplied-pmid 25061070?>
        <pub-id pub-id-type="pmid">25061070</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A powerful microbiome-based association test and a microbial taxa discovery framework for comprehensive association mapping</article-title>
        <source>Microbiome</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>45</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-017-0262-x</pub-id>
        <?supplied-pmid 28438217?>
        <pub-id pub-id-type="pmid">28438217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Statistical significance for genomewide studies</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>9440</fpage>
        <lpage>9445</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1530509100</pub-id>
        <?supplied-pmid 12883005?>
        <pub-id pub-id-type="pmid">12883005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc Series B Stat Methodol</source>
        <year>1995</year>
        <volume>57</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yekutieli</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical false discovery rate–controlling methodology</article-title>
        <source>J Amer Statistical Assoc</source>
        <year>2008</year>
        <volume>103</volume>
        <fpage>309</fpage>
        <lpage>316</lpage>
        <pub-id pub-id-type="doi">10.1198/016214507000001373</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yekutieli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Reiner-Benaim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Elmer</surname>
            <given-names>GI</given-names>
          </name>
          <name>
            <surname>Kafkafi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Letwin</surname>
            <given-names>NE</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>NH</given-names>
          </name>
        </person-group>
        <article-title>Approaches to multiplicity issues in complex research in microarray analysis</article-title>
        <source>Stat Neerl</source>
        <year>2006</year>
        <volume>60</volume>
        <fpage>414</fpage>
        <lpage>437</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9574.2006.00343.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yekutieli</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The false discovery rate approach to quantitative trait loci analysis</article-title>
        <source>Genetics</source>
        <year>2005</year>
        <volume>171</volume>
        <fpage>783</fpage>
        <lpage>789</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.104.036699</pub-id>
        <?supplied-pmid 15956674?>
        <pub-id pub-id-type="pmid">15956674</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zehetmayer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bauer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Posch</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Two-stage designs for experiments with a large number of hypotheses</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3771</fpage>
        <lpage>3777</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti604</pub-id>
        <?supplied-pmid 16091414?>
        <pub-id pub-id-type="pmid">16091414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reiner-Benaim</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yekutieli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Letwin</surname>
            <given-names>NE</given-names>
          </name>
          <name>
            <surname>Elmer</surname>
            <given-names>GI</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Kafkafi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Associating quantitative behavioral traits with gene expression in the brain: searching for diamonds in the hay</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>2239</fpage>
        <lpage>2246</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm300</pub-id>
        <?supplied-pmid 17827208?>
        <pub-id pub-id-type="pmid">17827208</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>A powerful and adaptive association test for rare variants</article-title>
        <source>Genetics</source>
        <year>2014</year>
        <volume>197</volume>
        <fpage>1081</fpage>
        <lpage>1095</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.114.165035</pub-id>
        <?supplied-pmid 24831820?>
        <pub-id pub-id-type="pmid">24831820</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Ringel-Kulka</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Ringel</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <article-title>Testing in microbiome-profiling studies with MiRKAT, the microbiome regression-based kernel association test</article-title>
        <source>Am J Hum Genet</source>
        <year>2015</year>
        <volume>96</volume>
        <fpage>797</fpage>
        <lpage>807</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ajhg.2015.04.003</pub-id>
        <?supplied-pmid 25957468?>
        <pub-id pub-id-type="pmid">25957468</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Livanos</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Greiner</surname>
            <given-names>TU</given-names>
          </name>
          <name>
            <surname>Vangay</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pathmasiri</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Stewart</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>McRitchie</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sohn</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Antibiotic-mediated gut microbiome perturbation accelerates development of type 1 diabetes in mice</article-title>
        <source>Nat Microbiol</source>
        <year>2016</year>
        <volume>1</volume>
        <fpage>16140</fpage>
        <pub-id pub-id-type="doi">10.1038/nmicrobiol.2016.140</pub-id>
        <?supplied-pmid 27782139?>
        <pub-id pub-id-type="pmid">27782139</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>An adaptive association test for microbiome data</article-title>
        <source>Genome Med</source>
        <year>2016</year>
        <volume>8</volume>
        <fpage>56</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-016-0302-3</pub-id>
        <?supplied-pmid 27198579?>
        <pub-id pub-id-type="pmid">27198579</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reynolds</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Richards</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>de la Iglesia</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Rayward-Smith</surname>
            <given-names>VJ</given-names>
          </name>
        </person-group>
        <article-title>Clustering rules: a comparison of partitioning and hierarchical clustering algorithms</article-title>
        <source>JMMR</source>
        <year>2006</year>
        <volume>5</volume>
        <fpage>475</fpage>
        <lpage>504</lpage>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Tvedebrink</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <source>dirmult: estimation in Dirichlet-multinomial distribution. R Package Version 01</source>
        <year>2009</year>
        <fpage>3</fpage>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Chen J, Li H. Kernel methods for regression analysis of microbiome compositional data. New York, NY: In: Topics in Applied Statistics: Springer; 2013. p. 191–201.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Koh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>ZD</given-names>
          </name>
          <name>
            <surname>Battaglia</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>PeBenito</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nazzal</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>Oxalobacter formigenes-associated host features and microbial community structures examined using the American Gut Project</article-title>
        <source>Microbiome</source>
        <year>2017</year>
        <volume>5</volume>
        <fpage>108</fpage>
        <pub-id pub-id-type="doi">10.1186/s40168-017-0316-0</pub-id>
        <?supplied-pmid 28841836?>
        <pub-id pub-id-type="pmid">28841836</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yin</surname>
            <given-names>Y-N</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Q-F</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X-W</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>F-G</given-names>
          </name>
        </person-group>
        <article-title>Effects of four Bifidobacteria on obesity in high-fat diet induced rats</article-title>
        <source>World J Gastroenterol</source>
        <year>2010</year>
        <volume>16</volume>
        <fpage>3394</fpage>
        <pub-id pub-id-type="doi">10.3748/wjg.v16.i27.3394</pub-id>
        <?supplied-pmid 20632441?>
        <pub-id pub-id-type="pmid">20632441</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>DiBaise</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Zuccolo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kudrna</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Braidotti</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Parameswaran</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Crowell</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Wing</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rittmann</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>Human gut microbiota in obesity and after gastric bypass</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2009</year>
        <volume>106</volume>
        <fpage>2365</fpage>
        <lpage>2370</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0812600106</pub-id>
        <?supplied-pmid 19164560?>
        <pub-id pub-id-type="pmid">19164560</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cani</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Delzenne</surname>
            <given-names>NM</given-names>
          </name>
        </person-group>
        <article-title>Interplay between obesity and associated metabolic disorders: new insights into the gut microbiota</article-title>
        <source>Curr Opin Pharm</source>
        <year>2009</year>
        <volume>9</volume>
        <fpage>737</fpage>
        <lpage>743</lpage>
        <pub-id pub-id-type="doi">10.1016/j.coph.2009.06.016</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Lauber</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Walters</surname>
            <given-names>WA</given-names>
          </name>
          <name>
            <surname>Berg-Lyons</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fierer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Owens</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Betley</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fraser</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bauer</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Ultra-high-throughput microbial community analysis on the Illumina HiSeq and MiSeq platforms</article-title>
        <source>ISME J</source>
        <year>2012</year>
        <volume>6</volume>
        <fpage>1621</fpage>
        <pub-id pub-id-type="doi">10.1038/ismej.2012.8</pub-id>
        <?supplied-pmid 22402401?>
        <pub-id pub-id-type="pmid">22402401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caporaso</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stombaugh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bittinger</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bushman</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Fierer</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Peña</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Goodrich</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>JI</given-names>
          </name>
        </person-group>
        <article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>335</fpage>
        <lpage>336</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.f.303</pub-id>
        <?supplied-pmid 20383131?>
        <pub-id pub-id-type="pmid">20383131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Koh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Livanos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Blaser</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <source>A highly adaptive microbiome-based association test for survival traits. BMC Genomics (under second review with minor revision)</source>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Aitchison</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>The statistical analysis of compositional data</source>
        <year>1986</year>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Zero-inflated beta regression for differential abundance analysis with metagenomics data</article-title>
        <source>J Comput Biol</source>
        <year>2016</year>
        <volume>23</volume>
        <fpage>102</fpage>
        <lpage>110</lpage>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A two-part mixed-effects model for analyzing longitudinal microbiome compositional data</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>2611</fpage>
        <lpage>2617</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw308</pub-id>
        <?supplied-pmid 27187200?>
        <pub-id pub-id-type="pmid">27187200</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ospina</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ferrari</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>A general class of zero-or-one inflated beta regression models</article-title>
        <source>Comput Stat Data Anal</source>
        <year>2012</year>
        <volume>56</volume>
        <fpage>1609</fpage>
        <lpage>1623</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csda.2011.10.005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sankaran</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>structSSI: simultaneous and selective inference for grouped or hierarchically structured data</article-title>
        <source>J Stat Softw</source>
        <year>2014</year>
        <volume>59</volume>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.18637/jss.v059.i13</pub-id>
        <?supplied-pmid 26917999?>
        <pub-id pub-id-type="pmid">26917999</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>False discovery rate control incorporating phylogenetic tree increases detection power in microbiome-wide multiple testing</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>2873</fpage>
        <lpage>2881</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx311</pub-id>
        <?supplied-pmid 28505251?>
        <pub-id pub-id-type="pmid">28505251</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asnicar</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Weingart</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tickle</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Huttenhower</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Compact graphical representation of phylogenetic data and metadata with GraPhlAn</article-title>
        <source>PeerJ</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>e1029</fpage>
        <pub-id pub-id-type="doi">10.7717/peerj.1029</pub-id>
        <?supplied-pmid 26157614?>
        <pub-id pub-id-type="pmid">26157614</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
