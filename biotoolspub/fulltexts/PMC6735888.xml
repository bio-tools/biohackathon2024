<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6735888</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz019</article-id>
    <article-id pub-id-type="publisher-id">btz019</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Crisflash: open-source software to generate CRISPR guide RNAs against genomes annotated with individual variation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Jacquin</surname>
          <given-names>Adrien L S</given-names>
        </name>
        <xref ref-type="aff" rid="btz019-aff1">1</xref>
        <xref ref-type="aff" rid="btz019-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Odom</surname>
          <given-names>Duncan T</given-names>
        </name>
        <xref ref-type="aff" rid="btz019-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-0701-5358</contrib-id>
        <name>
          <surname>Lukk</surname>
          <given-names>Margus</given-names>
        </name>
        <xref ref-type="aff" rid="btz019-aff1">1</xref>
        <xref ref-type="corresp" rid="btz019-cor1"/>
        <!--<email>margus.lukk@splse.com</email>-->
      </contrib>
    </contrib-group>
    <aff id="btz019-aff1"><label>1</label><institution>Cancer Research UK Cambridge Institute, University of Cambridge</institution>, Cambridge, UK and</aff>
    <aff id="btz019-aff2"><label>2</label><institution>Cetrale Nantes</institution>, 44321 Nantes, Cedex 3, France </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hancock</surname>
          <given-names>John</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btz019-cor1">To whom correspondence should be addressed. E-mail: <email>margus.lukk@splse.com</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-01-12">
      <day>12</day>
      <month>1</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>1</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>17</issue>
    <fpage>3146</fpage>
    <lpage>3147</lpage>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>7</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>12</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>1</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz019.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>CRISPR/Cas9 system requires short guide RNAs (sgRNAs) to direct genome modification. Most currently available tools for sgRNA design operate only with standard reference genomes, and are best suited for small-scale projects. To address these limitations, we developed Crisflash, a software tool for fast sgRNA design and potential off-target discovery, built for performance and flexibility. Crisflash can rapidly design CRISPR guides against any sequenced genome or genome sequences, and can optimize guide accuracy by incorporating user-supplied variant data. Crisflash is over an order of magnitude faster than comparable tools, even using a single CPU core, and efficiently and robustly scores the potential off-targeting of all possible candidate CRISPR guide oligonucleotides.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>
          <ext-link ext-link-type="uri" xlink:href="https://github.com/crisflash">https://github.com/crisflash</ext-link>
        </p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Cancer Research UK</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000289</named-content>
        </funding-source>
        <award-id>20412</award-id>
        <award-id>22398</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>CRISPR/Cas9 system has become a popular technology for mammalian genome editing, and depends on short, single-stranded guide RNAs (sgRNAs) directing the Cas9 nuclease to a desired locus (<xref rid="btz019-B5" ref-type="bibr">Hsu <italic>et al.</italic>, 2013</xref>; <xref rid="btz019-B8" ref-type="bibr">Ran <italic>et al.</italic>, 2013</xref>). The sequence of the sgRNA, typically around 20 bp in length, is fully homologous to its genomic target, followed by a short protospacer adjacent motif (PAM). Current methods design sgRNAs in a desired locus, followed by discovery and scoring of potential off-targets based mainly on their sequence specificity. In the search for potential off-targets for each candidate guide RNA, a score is computed that reflects the total number of fully or partially matching genomic regions (typically capturing up to five mis-matches), as well as the location of mismatches within the candidate guide sequence (<xref rid="btz019-B3" ref-type="bibr">Fu <italic>et al.</italic>, 2013</xref>).</p>
    <p>Most available sgRNA design tools are web-based and created for sgRNA design in a window of up to ten thousand of base pairs (<xref rid="btz019-B2" ref-type="bibr">Cradick <italic>et al.</italic>, 2014</xref>; <xref rid="btz019-B6" ref-type="bibr">Labun <italic>et al.</italic>, 2016</xref>; Naito <italic>et al.</italic>, 2014; <xref rid="btz019-B9" ref-type="bibr">Singh <italic>et al.</italic>, 2015</xref>). Many web-based services have limited support for batch queries, due to computational power required for candidate off-target evaluation, and may provide candidate sgRNAs out of a pool of pre-computed results for a limited set of reference genomes (<xref rid="btz019-B4" ref-type="bibr">Hodgkins <italic>et al.</italic>, 2015</xref>). To our knowledge, there is no web-based system supporting sgRNA design against custom genome sequences or non-standard genomes. Although some command-line tools are available and mostly free from above limitations (<xref rid="btz019-B1" ref-type="bibr">Bae <italic>et al.</italic>, 2014</xref>; <xref rid="btz019-B10" ref-type="bibr">Xiao <italic>et al.</italic>, 2014</xref>; <xref rid="btz019-B11" ref-type="bibr">Zhu <italic>et al.</italic>, 2014</xref>), a sequence similarity-based search for potential off-targets for thousands to millions of sgRNAs remains a challenge.</p>
    <p>Historically, most CRISPR/Cas9-based research has focused on genetic manipulation of human and mouse cell lines and tissues. Accurately generating guide RNAs for gene editing targeted to specific human genomes, or to directly target spontaneous somatic mutations in the human cancer genome requires flexibility to tailor the reference genome and quickly evaluate the quality of candidate sequences. Here, we present Crisflash, a command-line sgRNA design tool built for rapid performance, and flexible and accurate handling of individual genomic variance.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>Crisflash first scans a FASTA file containing genomic sequences for PAM adjacent protospacers and adds identified gRNAs to an N-ary tree. Nodes correspond to sequence bases; hence, the depth of the tree is equal to the gRNA length. Genomic coordinates of protospacers are saved in terminal nodes. Candidate sgRNAs are then identified, and off-target sequences for these candidate guide RNAs are identified by walking the sequence into the depth of the tree. If a base in a sequence is different than that of a node, a mismatch is recorded, and children of the node are followed as long as the total number of mismatches has not been exceeded. The final score of each candidate sgRNA is computed based on the experimentally observed effects of the mismatch positions of sequences, when followed all the way to the terminal nodes (<xref rid="btz019-B5" ref-type="bibr">Hsu <italic>et al.</italic>, 2013</xref>). Off-target search and scoring steps for candidates can be run, either in single or multi-threaded mode. For improved design and off-target identification accuracy, Crisflash accepts genetic variation data in vcf format. In case of variant data, after SNP and INDEL information has been incorporated to the genomic sequence, a genome-wide scan for PAMs is executed. For phased variants, two ‘haploid’ genomic sequences are created and gRNAs, as well as modifications in PAM and protospacer areas, are tracked on haplotype level. Creation, deletion and modification of gRNAs in one or both haplotypes is discussed further in Crisflash documentation and in <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>.</p>
  </sec>
  <sec>
    <title>3 Results and discussion</title>
    <p>We benchmarked Crisflash against following tools: Cas-OFFinder (<xref rid="btz019-B1" ref-type="bibr">Bae <italic>et al.</italic>, 2014</xref>), CasOT (<xref rid="btz019-B10" ref-type="bibr">Xiao <italic>et al.</italic>, 2014</xref>) and CRISPRseek (<xref rid="btz019-B11" ref-type="bibr">Zhu <italic>et al.</italic>, 2014</xref>), all of which are comparable command-line CRISPR design software. All tests were run independently on the same hardware with minimal background computational activity (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). Off-target search space was limited to four mismatches. In single core mode, Crisflash outperformed all other tools by an order of magnitude for inputs containing more than couple of hundred sgRNAs. The performance is improved above two orders of magnitude for inputs of few thousand candidates compared with cas-offinder while producing similar results (<xref ref-type="fig" rid="btz019-F1">Fig. 1</xref>). Tests with higher number of sgRNAs for CasOT and CRISPRseek had to be terminated due to long running times.
</p>
    <fig id="btz019-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Crisflash performance compared with other command-line sgRNA design tools </p>
      </caption>
      <graphic xlink:href="btz019f1"/>
    </fig>
    <p>The speed advantage gained from tree-based, fast approximate string matching comes with a relatively high requirement for RAM. Existing tools typically rely on a few GB of operational memory. However, the 90 GB necessary for Crisflash to work with human reference genome is readily accommodated in modern server clusters.</p>
    <p>Crisflash is first of its kind to offer greater sgRNA accuracy using variant information. Most proposed applications of CRISPR in biomedical research will increasingly demand the flexibility that Crisflash provides in its highly tailored sgRNA design. Crisflash reduces undesirable off-target effects arising from individual human genetic variation and avoids designing non-operational guides.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>Crisflash is a new sgRNA design and potential off-target discovery software, which greatly outperforms similar existing software. Crisflash is built for speed and improved precision when incorporating individual-specific genetic variant data, and is suitable for large-scale guide design, including in non-standard model organisms.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work has been supported by Cancer Research UK core award [20412] and strategic award [22398]. </p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz019_Supplementary_Methods</label>
      <media xlink:href="btz019_supplementary_methods.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz019-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bae</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Cas-OFFinder: a fast and versatile algorithm that searches for potential off-target sites of Cas9 RNA-guided endonucleases</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>1473</fpage>–<lpage>1475</lpage>.<pub-id pub-id-type="pmid">24463181</pub-id></mixed-citation>
    </ref>
    <ref id="btz019-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cradick</surname><given-names>T.J.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>COSMID: a web-based tool for identifying and validating CRISPR/Cas off-target sites</article-title>. <source>Mol. Ther. Nucleic Acids</source>, <volume>3</volume>, <fpage>e214.</fpage><pub-id pub-id-type="pmid">25462530</pub-id></mixed-citation>
    </ref>
    <ref id="btz019-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fu</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>High<bold>-</bold>frequency off<bold>-</bold>target mutagenesis induced by CRISPR<bold>-</bold>Cas nucleases in human cells</article-title>. <source>Nat. Biotechnol</source>., <volume>31</volume>, <fpage>822</fpage>–<lpage>826</lpage>.<pub-id pub-id-type="pmid">23792628</pub-id></mixed-citation>
    </ref>
    <ref id="btz019-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hodgkins</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>WGE: a CRISPR database for genome engineering</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>3078</fpage>–<lpage>3080</lpage>.<pub-id pub-id-type="pmid">25979474</pub-id></mixed-citation>
    </ref>
    <ref id="btz019-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hsu</surname><given-names>P.D.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>DNA targeting specificity of RNA<bold>-</bold>guided Cas9 nucleases</article-title>. <source>Nat. Biotechnol</source>., <volume>31</volume>, <fpage>827</fpage>–<lpage>832</lpage>.<pub-id pub-id-type="pmid">23873081</pub-id></mixed-citation>
    </ref>
    <ref id="btz019-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Labun</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>CHOPCHOP v2<bold>:</bold> a web tool for the next generation of CRISPR genome engineering</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>W272</fpage>–<lpage>W276</lpage>.<pub-id pub-id-type="pmid">27185894</pub-id></mixed-citation>
    </ref>
    <ref id="btz019-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Naito</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>CRISPRdirect<bold>:</bold> software for designing CRISPR<bold>/</bold>Cas guide RNA with reduced off-target sites</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>1120</fpage>–<lpage>1123</lpage>.<pub-id pub-id-type="pmid">25414360</pub-id></mixed-citation>
    </ref>
    <ref id="btz019-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ran</surname><given-names>F.A.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Genome engineering using the CRISPR<bold>-</bold>Cas9 system</article-title>. <source>Nat. Protoc</source>., <volume>8</volume>, <fpage>2281</fpage>–<lpage>2308</lpage>.<pub-id pub-id-type="pmid">24157548</pub-id></mixed-citation>
    </ref>
    <ref id="btz019-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Singh</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Cas9<bold>-</bold>chromatin binding information enables more accurate CRISPR off<bold>-</bold>target prediction</article-title>. <source>Nucleic Acids Res</source>., <volume>43</volume>, <fpage>e118</fpage>.<pub-id pub-id-type="pmid">26032770</pub-id></mixed-citation>
    </ref>
    <ref id="btz019-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xiao</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>CasOT<bold>:</bold> a genome<bold>-</bold>wide Cas9<bold>/</bold>gRNA off<bold>-</bold>target searching tool</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>1180</fpage>–<lpage>1182</lpage>.<pub-id pub-id-type="pmid">24389662</pub-id></mixed-citation>
    </ref>
    <ref id="btz019-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhu</surname><given-names>L.J.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>CRISPRseek<bold>:</bold> a bioconductor package to identify target specific guide RNAs for CRISPR<bold>-</bold>Cas9 genome<bold>-</bold>editing systems</article-title>. <source>PLoS One</source>, <volume>9</volume>, <fpage>e108424.</fpage><pub-id pub-id-type="pmid">25247697</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
