<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName nlm2jats3.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Neuroinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Neuroinform</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Neuroinform.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Neuroinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1662-5196</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8385655</article-id>
    <article-id pub-id-type="doi">10.3389/fninf.2021.704627</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Neuroscience</subject>
        <subj-group>
          <subject>Brief Research Report</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Fitting Splines to Axonal Arbors Quantifies Relationship Between Branch Order and Geometry</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Athey</surname>
          <given-names>Thomas L.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/827708/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Teneggi</surname>
          <given-names>Jacopo</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/1326010/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vogelstein</surname>
          <given-names>Joshua T.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/1235/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tward</surname>
          <given-names>Daniel J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff5">
          <sup>5</sup>
        </xref>
        <xref ref-type="aff" rid="aff6">
          <sup>6</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/418763/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mueller</surname>
          <given-names>Ulrich</given-names>
        </name>
        <xref ref-type="aff" rid="aff7">
          <sup>7</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/523934/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Miller</surname>
          <given-names>Michael I.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/6815/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Institute for Computational Medicine, Johns Hopkins University</institution>, <addr-line>Baltimore, MD</addr-line>, <country>United States</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Department of Biomedical Engineering, Johns Hopkins University</institution>, <addr-line>Baltimore, MD</addr-line>, <country>United States</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Center for Imaging Science, Johns Hopkins University</institution>, <addr-line>Baltimore, MD</addr-line>, <country>United States</country></aff>
    <aff id="aff4"><sup>4</sup><institution>Kavli Neuroscience Discovery Institute, Johns Hopkins University</institution>, <addr-line>Baltimore, MD</addr-line>, <country>United States</country></aff>
    <aff id="aff5"><sup>5</sup><institution>Department of Computational Medicine, University of California, Los Angeles</institution>, <addr-line>Los Angeles, CA</addr-line>, <country>United States</country></aff>
    <aff id="aff6"><sup>6</sup><institution>Department of Neurology, University of California, Los Angeles</institution>, <addr-line>Los Angeles, CA</addr-line>, <country>United States</country></aff>
    <aff id="aff7"><sup>7</sup><institution>Department of Neuroscience, Johns Hopkins University</institution>, <addr-line>Baltimore, MD</addr-line>, <country>United States</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: William T. Katz, Janelia Research Campus, United States</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Mark Kittisopikul, Janelia Research Campus, United States; Kevin Boergens, Paradromics, Inc., United States</p>
      </fn>
      <corresp id="c001">*Correspondence: Thomas L. Athey <email>tathey1@jhu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>15</volume>
    <elocation-id>704627</elocation-id>
    <history>
      <date date-type="received">
        <day>03</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2021 Athey, Teneggi, Vogelstein, Tward, Mueller and Miller.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Athey, Teneggi, Vogelstein, Tward, Mueller and Miller</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Neuromorphology is crucial to identifying neuronal subtypes and understanding learning. It is also implicated in neurological disease. However, standard morphological analysis focuses on macroscopic features such as branching frequency and connectivity between regions, and often neglects the internal geometry of neurons. In this work, we treat neuron trace points as a sampling of differentiable curves and fit them with a set of branching B-splines. We designed our representation with the Frenet-Serret formulas from differential geometry in mind. The Frenet-Serret formulas completely characterize smooth curves, and involve two parameters, curvature and torsion. Our representation makes it possible to compute these parameters from neuron traces in closed form. These parameters are defined continuously along the curve, in contrast to other parameters like tortuosity which depend on start and end points. We applied our method to a dataset of cortical projection neurons traced in two mouse brains, and found that the parameters are distributed differently between primary, collateral, and terminal axon branches, thus quantifying geometric differences between different components of an axonal arbor. The results agreed in both brains, further validating our representation. The code used in this work can be readily applied to neuron traces in SWC format and is available in our open-source Python package <monospace>brainlit</monospace>: <ext-link ext-link-type="uri" xlink:href="http://brainlit.neurodata.io/">http://brainlit.neurodata.io/</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>neuron</kwd>
      <kwd>morphology</kwd>
      <kwd>axon</kwd>
      <kwd>curvature</kwd>
      <kwd>projection</kwd>
      <kwd>mouse</kwd>
      <kwd>spline</kwd>
      <kwd>python</kwd>
    </kwd-group>
    <counts>
      <fig-count count="4"/>
      <table-count count="0"/>
      <equation-count count="5"/>
      <ref-count count="16"/>
      <page-count count="8"/>
      <word-count count="5023"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>1. Introduction</title>
    <p>Not long after scientists like Ramon y Cajal started studying the nervous system with staining and microscopy, neuron morphology became a central topic in neuroscience (Parekh and Ascoli, <xref rid="B10" ref-type="bibr">2013</xref>). Morphology became the obvious way to organize neurons into categories such as pyramidal cells, Purkinje cells, and stellate cells. However, morphology is important not only for neuron subtyping, but in understanding learning and disease. For example, a now classic neuroscience experiment found altered morphology in geniculocortical axonal arbors in kittens whose eyes had been stitched shut upon birth (Antonini and Stryker, <xref rid="B1" ref-type="bibr">1993</xref>). Also, morphological changes have been associated with the gene underlying an inherited form of Parkinson's disease (MacLeod et al., <xref rid="B8" ref-type="bibr">2006</xref>). Neuron morphology has been an important part of neuroscience for over a century, and remains so – one of the <ext-link ext-link-type="uri" xlink:href="https://braininitiative.nih.gov/">BRAIN</ext-link> Initiative Cell Census Network's primary goals is to systematically characterize neuron morphology in the mammalian brain.</p>
    <p>Currently, studying neuron morphology typically involves imaging one or more neurons, then tracing the cells and storing the traces in a digital format. Several recent initiatives have accumulated large datasets of neuron traces to facilitate morphology research. NeuroMorpho.Org, for example, hosts a total of over 140,000 neuron traces from a variety of animal species (Ascoli et al., <xref rid="B2" ref-type="bibr">2007</xref>). These traces are typically stored as a list of vertices, each with some associated attributes including connections to other vertices.</p>
    <p>Many scientists analyze neuron morphology by computing various summary features such as number of branch points, total length, and total encompassed volume. Neurolucida, a popular neuromorphology software, employs this technique. Another approach focuses on neuron topology, and uses metrics such as tree edit distance (Heumann and Wittum, <xref rid="B6" ref-type="bibr">2009</xref>). However, both of these approaches neglect <italic>kinematic</italic> geometry, or how the neuron travels through space. Tortuosity index is a summary feature that captures internal axon geometry, but this feature depends on the definition of start and end points, and cannot capture an axon's curvature at a single point.</p>
    <p>In this work, we look at neuron traces through the lens of differential geometry. In particular, we establish a system of fitting interpolating splines to the neuron traces, and computing their curvature and torsion properties. To our knowledge, curvature and torsion have never been measured in neuron traces. We applied this method to cortical projection neuron traces from two mouse brains in the MouseLight dataset from HHMI Janelia (Winnubst et al., <xref rid="B16" ref-type="bibr">2019</xref>). In both brains, we found different distributions of these properties between primary, collateral, and terminal axon segments. The code used in this work is available in our open-source Python package <monospace>brainlit</monospace>: <ext-link ext-link-type="uri" xlink:href="http://brainlit.neurodata.io/">http://brainlit.neurodata.io/</ext-link>.</p>
  </sec>
  <sec sec-type="methods" id="s2">
    <title>2. Methods</title>
    <sec>
      <title>2.1. Spline Fitting</title>
      <p>First, the neuron traces were split into segments by recursively identifying the longest root to leaf path (<xref ref-type="fig" rid="F1">Figure 1A</xref>). The first axon segment to be isolated in this way was defined to be the “primary” segment. Subsequent segments that branched were defined as “collateral” segments, and those that did not branch were defined to be “terminal” segments (<xref ref-type="fig" rid="F1">Figure 1B</xref>). This classification approximates the standard morphological definitions of primary, collateral and terminal axon branches.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>(A,B)</bold> Cartoon example of how we partition an axonal arbor trace into different segment classes, with numbers indicating distances between points (with arbitrary units). <bold>(A)</bold> A neuron trace is split into different segments by identifying the longest root to leaf path (“Main branch”), and separating sub-trees from it. The sub-trees which still have branch points are processed in the same way until the neuron has been split into segments. By using path length to identify the Main branch, this splitting process is invariant to rigid transformations of the trace. <bold>(B)</bold> Illustration of how axon segments are classified as primary, collateral, or terminal. The first segment is defined as primary, and segments that have no sub-trees are defined as terminal. All other segments are defined as collateral. <bold>(C)</bold> Examples of our spline fitting method applied to neuron traces from the MouseLight project (Winnubst et al., <xref rid="B16" ref-type="bibr">2019</xref>). The splines pass through all trace points, and are thrice continuously differentiable for segments that contain at least five trace points. The blue points indicate the somas, and the spline colors indicate segment class (blue = primary, red = collateral, green = terminal). The neuron on the left is from brain 1, the one on the right is from brain 2. The scale bar only applies to <bold>(C)</bold>.</p>
        </caption>
        <graphic xlink:href="fninf-15-704627-g0001"/>
      </fig>
      <p>Next, a B-spline was fit to each point sequence using <monospace>scipy</monospace>'s function <monospace>splprep</monospace> (Virtanen et al., <xref rid="B15" ref-type="bibr">2020</xref>). Kunoth et al. (<xref rid="B7" ref-type="bibr">2018</xref>) provide an in depth description of B-splines and their applications. Briefly, B-splines are linear combinations of piecewise polynomials, sometimes called basis functions. The basis functions are defined by a set of knots, which determine where the polynomial pieces meet, and degree, which determines the degree of the polynomial pieces. The <italic>j</italic>'th basis function for a set of knots ξ and degree <italic>p</italic> is recursively defined by Equation (1.1) in Kunoth et al. (<xref rid="B7" ref-type="bibr">2018</xref>):</p>
      <disp-formula id="E1">
        <mml:math id="M1">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mi>B</mml:mi>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>p</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>ξ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mi>ξ</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ξ</mml:mi>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mi>ξ</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfrac>
                <mml:msub>
                  <mml:mi>B</mml:mi>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>p</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mstyle mathvariant="bold" mathsize="normal">
                      <mml:mi>ξ</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>x</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>+</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ξ</mml:mi>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>p</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:mi>x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ξ</mml:mi>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>p</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mi>ξ</mml:mi>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfrac>
                <mml:msub>
                  <mml:mi>B</mml:mi>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>p</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>ξ</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>x</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mtext>        with</mml:mtext>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mi>B</mml:mi>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mn>0</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mstyle mathvariant="bold" mathsize="normal">
                      <mml:mi>ξ</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mtable columnalign="left">
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mtext>if </mml:mtext>
                            <mml:mi>x</mml:mi>
                            <mml:mo>∈</mml:mo>
                            <mml:mo stretchy="false">[</mml:mo>
                            <mml:msub>
                              <mml:mi>ξ</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mo>,</mml:mo>
                            <mml:msub>
                              <mml:mi>ξ</mml:mi>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr columnalign="left">
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mn>0</mml:mn>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="left">
                          <mml:mrow>
                            <mml:mtext>otherwise</mml:mtext>
                            <mml:mo>.</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>Splines are fit to data by solving a constrained optimization problem, where a smoothing term is minimized while keeping the residual error under a specified value (Dierckx, <xref rid="B3" ref-type="bibr">1982</xref>). Here, we constrain the splines to pass exactly through all points in the original trace, which corresponds to a smoothing condition of <italic>s</italic> = 0 in <monospace>splprep</monospace>. For a sequence of <italic>n</italic> &gt; 5 points, we fit a spline of degree 5, which is the minimal degree that ensures that the splines are thrice continuously differentiable. Differentiability is important because it allows for estimation of curvature and torsion, explained in the next section.</p>
      <p>Sequences of fewer than 5 points, however, required lower degree splines to fully constrain the fitting procedure. For a sequence of 3 &lt; <italic>n</italic> ≤ 5 points we used degree 3, for a sequence of <italic>n</italic> = 3 points we used degree 2, and for a sequence of <italic>n</italic> = 2 points we used degree 1. By selecting the degree in this way, we avoided splines of large even degree, such as fourth order splines, which are not recommended in our interpolation setting (Virtanen et al., <xref rid="B15" ref-type="bibr">2020</xref>). Also, these degree choices are low enough to allow for a fully constrained fitting procedure, but high enough to make curvature/torsion nonvanishing when possible.</p>
      <p>We recall that B-splines are not required to be parameterized by the arclength of the curve. Here, we set ξ = {0, …, <italic>L</italic>}, where <italic>L</italic> is the cumulative length of the segments connecting the vertices of the trace, in μ<italic>m</italic>. All other spline fitting options were set to the defaults in <monospace>splprep</monospace>. This spline fitting method can be applied to any set of points organized in a tree structure, such as a SWC file. <xref ref-type="fig" rid="F1">Figure 1C</xref> shows examples of splines that were fit to neuron traces.</p>
    </sec>
    <sec>
      <title>2.2. Frenet-Serret Parameters</title>
      <p>An important advantage of B-splines is that their derivatives can be computed in closed form. In fact, their derivatives are defined in terms of B-splines as shown below in Theorem 3 from Kunoth et al. (<xref rid="B7" ref-type="bibr">2018</xref>):</p>
      <p><bold>Theorem</bold><italic>For a continuously differentiable b-spline</italic><italic>B</italic><sub><italic>j,p</italic>,ξ</sub>(·) <italic>defined by index</italic><italic>j</italic><italic>, degree</italic><italic>p</italic> ≥ 1<italic>, and knot sequence</italic> ξ, <italic>we have:</italic></p>
      <disp-formula id="E2">
        <mml:math id="M2">
          <mml:mrow>
            <mml:mfrac>
              <mml:mi>d</mml:mi>
              <mml:mrow>
                <mml:mi>d</mml:mi>
                <mml:mi>s</mml:mi>
              </mml:mrow>
            </mml:mfrac>
            <mml:msub>
              <mml:mi>B</mml:mi>
              <mml:mrow>
                <mml:mi>j</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>p</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mstyle mathvariant="bold" mathsize="normal">
                  <mml:mi>ξ</mml:mi>
                </mml:mstyle>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mi>s</mml:mi>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mi>p</mml:mi>
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mrow>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>B</mml:mi>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>p</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mstyle mathvariant="bold" mathsize="normal">
                          <mml:mi>ξ</mml:mi>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>s</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ξ</mml:mi>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>p</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mi>ξ</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>−</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>B</mml:mi>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mi>p</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mstyle mathvariant="bold" mathsize="normal">
                          <mml:mi>ξ</mml:mi>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>s</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ξ</mml:mi>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>p</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mi>ξ</mml:mi>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
              <mml:mo>)</mml:mo>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p><italic>where we assume by convention that fractions with zero denominator have value zero</italic>.</p>
      <p>Curvature and torsion can be easily computed because of this property. For a thrice differentiable curve <italic>x</italic>(<italic>s</italic>) ∈ ℝ<sup>3</sup> that is parameterized by arclength (i.e., ||ẋ(<italic>s</italic>)|| = 1 ∀<italic>s</italic>), one can compute the curvature (κ) and torsion (τ) with the following formulas:</p>
      <disp-formula id="E3">
        <mml:math id="M3">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mi>κ</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>s</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mo>|</mml:mo>
                <mml:mo>|</mml:mo>
                <mml:mover accent="true">
                  <mml:mi>x</mml:mi>
                  <mml:mo>˙</mml:mo>
                </mml:mover>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>s</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>×</mml:mo>
                <mml:mover accent="true">
                  <mml:mi>x</mml:mi>
                  <mml:mo>¨</mml:mo>
                </mml:mover>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>s</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>|</mml:mo>
                <mml:mo>|</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>τ</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>s</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mo>〈</mml:mo>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mover accent="true">
                      <mml:mi>x</mml:mi>
                      <mml:mo>˙</mml:mo>
                    </mml:mover>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>s</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>×</mml:mo>
                    <mml:mover accent="true">
                      <mml:mi>x</mml:mi>
                      <mml:mo>¨</mml:mo>
                    </mml:mover>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>s</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:mover accent="true">
                      <mml:mi>x</mml:mi>
                      <mml:mo>⃛</mml:mo>
                    </mml:mover>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>s</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>〉</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>|</mml:mo>
                    <mml:mo>|</mml:mo>
                    <mml:mover accent="true">
                      <mml:mi>x</mml:mi>
                      <mml:mo>˙</mml:mo>
                    </mml:mover>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>s</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>×</mml:mo>
                    <mml:mover accent="true">
                      <mml:mi>x</mml:mi>
                      <mml:mo>¨</mml:mo>
                    </mml:mover>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>s</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>|</mml:mo>
                    <mml:msup>
                      <mml:mo>|</mml:mo>
                      <mml:mn>2</mml:mn>
                    </mml:msup>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>defined with the standard Euclidean norm || · ||, inner product 〈·,·〉, and cross product ×. When curvature vanishes, we define torsion to be zero as well, since the torsion equation becomes undefined. The units of curvature and torsion are both inverse length. In this work, neuron traces have units of microns, so curvature and torsion both have units of (μ<italic>m</italic>)<sup>−1</sup>.</p>
      <p>Curvature measures how much a curve deviates from being straight, and torsion measures how much a curve deviates from being planar. Together, these quantities parametrize the Frenet-Serret formulas of differential geometry. These formulas completely characterize continuously differentiable curves in three-dimensional Euclidean space, up to rigid motion (Grenander et al., <xref rid="B5" ref-type="bibr">2007</xref>). Curvature takes non-negative values, but torsion can be positive or negative where the sign denotes the direction of the torsion in the right-handed coordinate system. In this work, we are not interested in the direction of the torsion, so we focused on the torsion magnitude (absolute value).</p>
    </sec>
    <sec>
      <title>2.3. Data</title>
      <p>We applied our methods to a collection of cortical projection neuron axon traces from two mouse brains in the HHMI Janelia MouseLight dataset. The precision of the reconstructions is limited by the resolution of the original two-photon block-face images, which was 0.3μ<italic>m</italic> × 0.3μ<italic>m</italic> × 1μ<italic>m</italic> (Winnubst et al., <xref rid="B16" ref-type="bibr">2019</xref>). Each reconstruction is the consensus of traces by two independent annotators. Winnubst et al. (<xref rid="B16" ref-type="bibr">2019</xref>) showed that using two annotators per neuron produced reconstructions that are about 93.7% accurate (in terms of total axonal length). There were 180 traces from brain 1 and 50 traces from brain 2.</p>
      <p>After fitting splines to these traces, curvature and torsion magnitude were sampled every 1μ<italic>m</italic> along the axon segments. Sampling every 1μ<italic>m</italic> is the highest sampling frequency that does not exceed the image resolution, so it is an appropriate balance of precision and computational efficiency. We studied curvature and torsion magnitude in two ways, described below in sections 2.4, 2.5.</p>
    </sec>
    <sec>
      <title>2.4. Computing Autocorrelation of Curvature and Torsion</title>
      <p>Our first goal was to identify the length scale at which straight axon segments remain straight and curved axon segments remain curved, so we studied the autocorrelation of curvature and torsion magnitude along the axon segments. For each axon segment, the autocorrelation functions of curvature and torsion were computed along the length of the segment, yielding a collection of autocorrelation functions for each brain. Then, we evaluated whether autocorrelation at a particular lag was significantly higher than 0.3 using a one-sided <italic>t</italic>-test with a significance threshold of α = 0.05. We identified 0.3 as our effect size because correlations higher than 0.3 are generally regarded as “moderate” correlations.</p>
      <p>It is worth noting that, by the nature of the spline fitting procedure in Virtanen et al. (<xref rid="B15" ref-type="bibr">2020</xref>), “lag” in our autocorrelation functions refers to straight line distances between the trace points, not by the arclength of the resulting curves.</p>
    </sec>
    <sec>
      <title>2.5. Comparing Axon Segment Classes</title>
      <p>Our second goal in the analysis was to compare curvature/torsion between segment classes. First, we estimated each segment's average curvature/torsion magnitude by taking the mean from all points that were sampled on that segment.</p>
      <p>In order to compare different segment classes, we developed a paired sample method for testing for differences in average curvature/torsion. Different neurons represented different samples, and the average curvature/torsion of two segment classes (primary vs. collateral, collateral vs. terminal, primary vs. terminal) represented the paired measurements.</p>
      <p>Define the random variable <italic>X</italic> as the average curvature/torsion of one segment class and <italic>Y</italic> as the average curvature/torsion of another segment class. Further, say <italic>X</italic> and <italic>Y</italic> are both real valued. Our null and alternative hypotheses are as follows:</p>
      <disp-formula id="E4">
        <mml:math id="M4">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mi mathvariant="script">H</mml:mi>
                  <mml:mn>0</mml:mn>
                </mml:msub>
                <mml:mo>:</mml:mo>
                <mml:mi>Pr</mml:mi>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:mi>X</mml:mi>
                <mml:mo>&gt;</mml:mo>
                <mml:mi>Y</mml:mi>
                <mml:mo stretchy="false">]</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mn>0</mml:mn>
                <mml:mo>.</mml:mo>
                <mml:mn>5</mml:mn>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:msub>
                  <mml:mi mathvariant="script">H</mml:mi>
                  <mml:mn>1</mml:mn>
                </mml:msub>
                <mml:mo>:</mml:mo>
                <mml:mi>Pr</mml:mi>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:mi>X</mml:mi>
                <mml:mo>&gt;</mml:mo>
                <mml:mi>Y</mml:mi>
                <mml:mo stretchy="false">]</mml:mo>
                <mml:mo>≠</mml:mo>
                <mml:mn>0</mml:mn>
                <mml:mo>.</mml:mo>
                <mml:mn>5</mml:mn>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>We tested these hypotheses using the sign test (Neuhauser, <xref rid="B9" ref-type="bibr">2011</xref>). The test statistic is the number of times that the data point from one sample is greater than its pair from the other sample. A key advantage of the sign test is that it does not require parametric distribution assumptions, such as normality of the data. Also, its null distribution can be computed exactly via the binomial distribution. The two different parameters (curvature and torsion), and the three different segment class pairs constitute six total tests, so we applied the Bonferroni correction to α = 0.05 to obtain the significance threshold 0.0083, which controls the family-wise error rate to 0.05. We conducted one-sided sign tests in all cases.</p>
      <p>We also wanted to study whether these results would hold if the traces were perturbed. In particular, since the annotators vary the distance between points in their trace, we decided to randomly remove trace points and repeat the curvature/torsion measurements. Since the traces are tree structures, a trace point can be removed after connecting its child node(s) to its parent node. We produced 20 copies of the original dataset and, in each case, removed every trace point with 10% probability.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s3">
    <title>3. Results</title>
    <sec>
      <title>3.1. Autocorrelation of Curvature and Torsion</title>
      <p>The autocorrelation functions for all segments of a brain were averaged, and they are shown in <xref ref-type="fig" rid="F2">Figure 2</xref>. Also shown is a shaded region that represents one standard deviation of these autocorrelation functions. The <italic>t</italic>-tests described in section 2.4 were significant at lags of 1, 2, 3, 4μ<italic>m</italic> for curvature in brain 1, 1, 2, 3μ<italic>m</italic> for curvature in brain 2, 1, 2μ<italic>m</italic> for torsion in brain 1, and 1, 2μ<italic>m</italic> for torsion in brain 2.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p>Autocorrelation of curvature and torsion magnitude averaged across all axon segments with ±1σ confidence intervals. Curvature and torsion were sampled at every 1μ<italic>m</italic> along the axon segments. One sided <italic>t</italic>-tests indicated that curvature had statistically significant autocorrelation values above 0.3 at lags of 1, 2, 3, and 4 μ<italic>m</italic> in brain 1 and 1, 2, and 3 μ<italic>m</italic> in brain 2. Torsion had statistically significant autocorrelation values above 0.3 at lags of 1 and 2μ<italic>m</italic> in both brain 1 and 2.</p>
        </caption>
        <graphic xlink:href="fninf-15-704627-g0002"/>
      </fig>
    </sec>
    <sec>
      <title>3.2. Axon Segment Class Differences</title>
      <p>The distributions of mean curvature and torsion are shown in <xref ref-type="fig" rid="F3">Figure 3</xref>. Our statistical testing procedure, described in section 2.5, rejected the null hypothesis in all cases, with all <italic>p</italic> &lt; 5 × 10<sup>−7</sup>. The directions of the one-sided tests were identical in both brains with:</p>
      <disp-formula id="E5">
        <mml:math id="M5">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:mtext>Curvature: Collateral</mml:mtext>
                <mml:mo>&gt;</mml:mo>
                <mml:mtext>Terminal</mml:mtext>
                <mml:mo>&gt;</mml:mo>
                <mml:mtext>Primary</mml:mtext>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mtext>    Torsion: Collateral</mml:mtext>
                <mml:mo>&gt;</mml:mo>
                <mml:mtext>Primary</mml:mtext>
                <mml:mo>&gt;</mml:mo>
                <mml:mtext>Terminal</mml:mtext>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>When we applied the same testing procedure to the 20 datasets with trace points randomly removed, the null hypotheses were also all rejected, in the same directions, in all cases.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p>The distributions of average curvature and average torsion differed between the different segment classes as shown in these kernel density estimates (which integrate to one, and therefore density has the units of μ<italic>m</italic>), using a Gaussian kernel. The bandwidth of the kernel was 1.2σ where σ was computed using Scott's method (Scott, <xref rid="B13" ref-type="bibr">2015</xref>). Segment averages were computed by sampling the curves at a uniform spacing of 1μ<italic>m</italic>. One-sided sign tests, testing for differences in average curvature and torsion, were conducted while controlling the family-wise error rate to 0.05. The tests were significant in all cases and the directionality of the tests agreed in both brains.</p>
        </caption>
        <graphic xlink:href="fninf-15-704627-g0003"/>
      </fig>
      <p>Neuron counts for all 36 possible curvature/torsion orderings across classes are shown in <xref ref-type="fig" rid="F4">Figure 4</xref>. The most common ordering of curvature/torsion is exactly the same as the results of the sign test (106/180 neurons followed this ordering in brain 1, 38/50 in brain 2).</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p>For each neuron, average curvature and torsion was computed for all three segment classes (P, primary; C, collateral; T, terminal) and compared between classes. These heatmaps show the neuron counts for all 36 possible orderings of curvature/torsion. The most common ordering was collateral &gt; terminal &gt; primary for curvature and collateral &gt; primary &gt; terminal for torsion.</p>
        </caption>
        <graphic xlink:href="fninf-15-704627-g0004"/>
      </fig>
      <p>In the <xref ref-type="supplementary-material" rid="SM1">Supplementary Figure 1</xref>, we plot the curvature/torsion vs. segment length. There appear to be modest correlations between segment length and curvature/torsion values in log-log plots.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s4">
    <title>4. Discussion</title>
    <p>Our work proposes a model of neuron morphology using continuously differentiable B-splines. From these curves, it is possible to measure kinematic properties of neuronal processes, including curvature and torsion. These techniques are freely available in our open source Python package <monospace>brainlit</monospace>: <ext-link ext-link-type="uri" xlink:href="http://brainlit.neurodata.io/">http://brainlit.neurodata.io/</ext-link>, and more information about how to reproduce the specific results here can be found in the data availability statement.</p>
    <p>In most contemporary neuromorphological analysis, neuron traces are regarded as piecewise linear structures, which precludes any analysis of higher order derivatives. Our spline representation makes it possible to estimate higher order derivatives and study parameters like curvature and torsion of neuron branches. In the popular piecewise linear representation, curvature and torsion would be zero along the line segments, and undefined where the line segments meet. We simulated a piecewise linear representation by modifying our spline fitting procedure to only produce splines of degree one. Indeed, with this less sophisticated representation, curvature and torsion vanished everywhere, making them not meaningful.</p>
    <p>Tortuosity index captures similar information to our curvature/torsion measurements and is popular in neuromorphological analysis (Stepanyants et al., <xref rid="B14" ref-type="bibr">2004</xref>). However, tortuosity requires the user to define start and end points whereas our method does not. Further, the piecewise linear representation of neuron traces limits the sampling frequency of tortuosity. Since tortuosity of a straight line is identically 1, placing the start and endpoints on the same linear segment will always produce a tortuosity value of 1. Our method, on the other hand, can produce more meaningful instantaneous curvature/torsion values.</p>
    <p>Our methods for fitting splines and measuring curvature and torsion can be applied in neuromorphological analysis in a variety of ways, but we highlight two applications here, on a dataset of 230 projection neuron traces from two different mouse brains. We found that the autocorrelation functions of both curvature and torsion showed statistically significant correlations above 0.3 within lags of approximately 2 microns (specific lag values given in section 3.1). Next, we defined segments as either “primary,” “collateral,” or “terminal,” and found significant differences in the distributions of curvature and torsion between these classes.</p>
    <p>The statistical analysis approach described in section 2.5 satisfies two desirable properties. First, by averaging measurements across segment classes, and pairing the data, we did not have to assume independence between segments of the same neuron. Assuming independence seemed inappropriate because, for example, segments that are connected to each other may have correlated geometry. Second, it avoided any parametric assumptions of the data, such as assuming normality of curvature/torsion measurements. A normality assumption seemed inappropriate for several reasons, including the fact that curvature is nonnegative, and that curvature/torsion was identically 0 for short segments with only 2 trace points.</p>
    <p><xref ref-type="fig" rid="F4">Figure 4</xref> shows that most individual neurons agree with the overall trend that collateral segments have the highest curvature and torsion. This suggests that the finding here is a consistent phenomenon among projection neurons in mice. In order to explore curvature/torsion distributions one level deeper, we looked into the relationship between curvature/torsion and segment length (see <xref ref-type="supplementary-material" rid="SM1">Supplementary Figure 1</xref>). In all segment classes, longer segments tend to have less curvature. The relationship between segment length and torsion is weaker, but there does appear to be a positive correlation.</p>
    <p>Together, these findings suggest that the geometry of primary axon branches is different than that of higher order branches, such as the segments in terminal arborizations. In particular, higher order branches (collaterals and terminals) had higher curvature than primary branches. Collateral branches also had the highest torsion, but primary branches had higher torsion than terminal segments.</p>
    <p>The primary limitation of our work is that our process of splitting a neuron trace into segments may not partition an axonal arbor into the most meaningful segment classes. This is because we needed an unambiguous classification system, while most definitions used in neuroscience literature are subjective and qualitative. For example, collaterals are broadly defined as branches that split off their parent branch at sharp angles, and arborize in a different location from other branches (Rockland, <xref rid="B12" ref-type="bibr">2013</xref>). However, there is no strict cutoff for how far away a branch has to travel for it to be considered a collateral. Further, a branch may be simultaneously considered a collateral and a terminal. We designed a set of segment classes which are mutually exclusive, collectively exhaustive, and agree with common usage of the terms ‘primary,’ ‘collateral,’ and ‘terminal’ by neuroscientists. Future work could include changing our definitions of these classes to incorporate other morphological properties such as branch angle, or axon radius. Also, extending these experiments to neuron trace repositories such as NeuroMorpho.Org would help verify if the results using our classification system generalize.</p>
    <p>Previous research has already indicated differences in axon geometry across neuronal cell types. For example, Stepanyants et al. (<xref rid="B14" ref-type="bibr">2004</xref>) found higher tortuosity in the axons of GABAergic interneurons vs. those of pyramidal cells. Similarly, Portera-Cailliau et al. (<xref rid="B11" ref-type="bibr">2005</xref>) found Cajal-Retzius cells to be significantly more tortuous than Thalamocortical (TC) cells, which is a type of projection neuron. Portera-Cailliau et al. (<xref rid="B11" ref-type="bibr">2005</xref>) also offers evidence that, while the primary axon in TC cells travel via a growth cone, most branching occurs via an interstitial, growth cone independent process. Our work elaborates on this distinction, suggesting that higher order axon branches have different geometry as well. While earlier research studied the differences of axonal geometry between neurons, we studied the variation of axonal geometry within neurons.</p>
    <p>It is also worth noting that this is not the first work to model neuron traces as continuous curves in ℝ<sup>3</sup>. For example, Duncan et al. (<xref rid="B4" ref-type="bibr">2018</xref>) construct a sophisticated and elegant representation of neurons that offers several useful properties. First, their representation is invariant to rigid motion and reparameterization. Second, their representation offers a vector space with a shape metric amenable to clustering and classification. However, their representation is limited to neuron topologies consisting of a main branch and only first order collaterals. Our B-splines approach does not immediately yield vector space properties, but can be applied to neurons with higher order branching, and allows for closed form computation of curvature and torsion. In short, the representation in Duncan et al. (<xref rid="B4" ref-type="bibr">2018</xref>) is designed for analysis between neurons, and our representation is designed for analysis within neurons. In the future, we are interested in bringing the advantages of their work to the open source software community, and combining it with the advantages of ours.</p>
    <p>This method could also be applied to measure curvature and torsion of dendrites, since dendrites also have a tree structure and are commonly stored in SWC format. However, the segment classes that we define (primary, collateral and terminal) would be inappropriate for dendrites. A segmentation classification system for dendrites would likely depend on the neuron type being studied. For example, a natural classification system of dendrites in pyramidal cells may separate apical dendrites from basal ones while dendrites in Purkinje cells would not have such a division. The researcher would have to define the dendrite segment classes according to the dataset, and the goals of the research.</p>
    <p>It is well known that axons are pruned and modified over time (Portera-Cailliau et al., <xref rid="B11" ref-type="bibr">2005</xref>). It is possible that this process contributes to the different geometry of proximal vs. distal axonal segments. Indeed, Portera-Cailliau et al. (<xref rid="B11" ref-type="bibr">2005</xref>) mentions the growth of short twisted branches toward the end of axon development. Future animal experiments could follow-up on this idea, and similar experiments to this one could be applied to other neuron types and other species to see if this is a widespread phenomenon in neuron morphology.</p>
  </sec>
  <sec sec-type="data-availability" id="s5">
    <title>Data Availability Statement</title>
    <p>The datasets analyzed for this study can be found in the Open Neurodata AWS account (<ext-link ext-link-type="uri" xlink:href="https://registry.opendata.aws/open-neurodata/">https://registry.opendata.aws/open-neurodata/</ext-link>). Our package, brainlit provides examples of accessing this data. Specifically, instructions on how to reproduce the figures found here can be found at <ext-link ext-link-type="uri" xlink:href="http://brainlit.neurodata.io/link_stubs/axon_geometry_readme_link.html">http://brainlit.neurodata.io/link_stubs/axon_geometry_readme_link.html</ext-link>.</p>
  </sec>
  <sec id="s6">
    <title>Author Contributions</title>
    <p>MM and DT advised on the theoretical direction of the manuscript. UM advised on the data application experiments. JV advised on the presentation of the results. TA and JT designed the study, implemented the software, and managed the manuscript text/figures. All authors contributed to manuscript revision.</p>
  </sec>
  <sec sec-type="COI-statement" id="conf1">
    <title>Conflict of Interest</title>
    <p>MM own Anatomy Works with the arrangement being managed by Johns Hopkins University in accordance with its conflict of interest policies. The remaining authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
  <sec sec-type="disclaimer" id="s7">
    <title>Publisher's Note</title>
    <p>All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated organizations, or those of the publisher, the editors and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the MouseLight team at HHMI Janelia for providing us with access to this data, and answering our questions about it.</p>
  </ack>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> This work is supported by the National Institutes of Health grants RF1MH121539, P41EB015909, R01NS086888, U19AG033655, the National Science Foundation Grant 2014862, and the National Institute of General Medical Sciences Grant T32GM119998.</p>
    </fn>
  </fn-group>
  <sec sec-type="supplementary-material" id="s8">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fninf.2021.704627/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fninf.2021.704627/full#supplementary-material</ext-link></p>
    <supplementary-material content-type="local-data" id="SM1">
      <label>Supplementary Figure 1</label>
      <caption>
        <p>The above plots show the relationship between segment length, and mean curvature or torsion in each segment class and brain. Each data point represents a single axon segment, and average curvature and torsion was computed by sampling the segments at a uniform spacing of 1 μ<italic>m</italic>. We removed segments with zero average curvature/torsion in order to plot the data on a log scale. In this data, there appear to be weak negative correlations between segment length and curvature, and a weak positive correlations between segment length torsion.</p>
      </caption>
      <media xlink:href="Image_1.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Antonini</surname><given-names>A.</given-names></name><name><surname>Stryker</surname><given-names>M. P.</given-names></name></person-group> (<year>1993</year>). <article-title>Rapid remodeling of axonal arbors in the visual cortex</article-title>. <source>Science</source>
<volume>260</volume>, <fpage>1819</fpage>–<lpage>1821</lpage>. <pub-id pub-id-type="doi">10.1126/science.8511592</pub-id><?supplied-pmid 8511592?><pub-id pub-id-type="pmid">8511592</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ascoli</surname><given-names>G. A.</given-names></name><name><surname>Donohue</surname><given-names>D. E.</given-names></name><name><surname>Halavi</surname><given-names>M.</given-names></name></person-group> (<year>2007</year>). <article-title>Neuromorpho.org: a central resource for neuronal morphologies</article-title>. <source>J. Neurosci</source>. <volume>27</volume>, <fpage>9247</fpage>–<lpage>9251</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.2055-07.2007</pub-id><?supplied-pmid 17728438?><pub-id pub-id-type="pmid">17728438</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dierckx</surname><given-names>P.</given-names></name></person-group> (<year>1982</year>). <article-title>Algorithms for smoothing data with periodic and parametric splines</article-title>. <source>Comput. Graph. Image Proc</source>. <volume>20</volume>, <fpage>171</fpage>–<lpage>184</lpage>. <pub-id pub-id-type="doi">10.1016/0146-664X(82)90043-0</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Duncan</surname><given-names>A.</given-names></name><name><surname>Klassen</surname><given-names>E.</given-names></name><name><surname>Srivastava</surname><given-names>A.</given-names></name></person-group> (<year>2018</year>). <article-title>Statistical shape analysis of simplified neuronal trees</article-title>. <source>Ann. Appl. Stat</source>. <volume>12</volume>, <fpage>1385</fpage>–<lpage>1421</lpage>. <pub-id pub-id-type="doi">10.1214/17-AOAS1107</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Grenander</surname><given-names>U.</given-names></name><name><surname>Miller</surname><given-names>M. I.</given-names></name><name><surname>Miller</surname><given-names>M.</given-names></name></person-group> (<year>2007</year>). <source>Pattern Theory: From Representation to Inference</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Heumann</surname><given-names>H.</given-names></name><name><surname>Wittum</surname><given-names>G.</given-names></name></person-group> (<year>2009</year>). <article-title>The tree-edit-distance, a measure for quantifying neuronal morphology</article-title>. <source>Neuroinformatics</source>
<volume>7</volume>, <fpage>179</fpage>–<lpage>190</lpage>. <pub-id pub-id-type="doi">10.1007/s12021-009-9051-4</pub-id><?supplied-pmid 19475518?><pub-id pub-id-type="pmid">19475518</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kunoth</surname><given-names>A.</given-names></name><name><surname>Lyche</surname><given-names>T.</given-names></name><name><surname>Sangalli</surname><given-names>G.</given-names></name><name><surname>Serra-Capizzano</surname><given-names>S.</given-names></name></person-group> (<year>2018</year>). <source>Splines and PDEs: From Approximation Theory to Numerical Linear Algebra</source>. <publisher-loc>Cham</publisher-loc>: <publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>MacLeod</surname><given-names>D.</given-names></name><name><surname>Dowman</surname><given-names>J.</given-names></name><name><surname>Hammond</surname><given-names>R.</given-names></name><name><surname>Leete</surname><given-names>T.</given-names></name><name><surname>Inoue</surname><given-names>K.</given-names></name><name><surname>Abeliovich</surname><given-names>A.</given-names></name></person-group> (<year>2006</year>). <article-title>The familial parkinsonism gene lrrk2 regulates neurite process morphology</article-title>. <source>Neuron</source>
<volume>52</volume>, <fpage>587</fpage>–<lpage>593</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2006.10.008</pub-id><?supplied-pmid 17114044?><pub-id pub-id-type="pmid">17114044</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Neuhauser</surname><given-names>M.</given-names></name></person-group> (<year>2011</year>). <source>Nonparametric Statistical Tests: A Computational Approach</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>CRC Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Parekh</surname><given-names>R.</given-names></name><name><surname>Ascoli</surname><given-names>G. A.</given-names></name></person-group> (<year>2013</year>). <article-title>Neuronal morphology goes digital: a research hub for cellular and system neuroscience</article-title>. <source>Neuron</source>
<volume>77</volume>, <fpage>1017</fpage>–<lpage>1038</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2013.03.008</pub-id><?supplied-pmid 23522039?><pub-id pub-id-type="pmid">23522039</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Portera-Cailliau</surname><given-names>C.</given-names></name><name><surname>Weimer</surname><given-names>R. M.</given-names></name><name><surname>De Paola</surname><given-names>V.</given-names></name><name><surname>Caroni</surname><given-names>P.</given-names></name><name><surname>Svoboda</surname><given-names>K.</given-names></name></person-group> (<year>2005</year>). <article-title>Diverse modes of axon elaboration in the developing neocortex</article-title>. <source>PLoS Biol</source>. <volume>3</volume>:<fpage>e272</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pbio.0030272</pub-id><?supplied-pmid 16026180?><pub-id pub-id-type="pmid">16026180</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rockland</surname><given-names>K. S.</given-names></name></person-group> (<year>2013</year>). <article-title>Collateral branching of long-distance cortical projections in monkey</article-title>. <source>J. Compar. Neurol</source>. <volume>521</volume>, <fpage>4112</fpage>–<lpage>4123</lpage>. <pub-id pub-id-type="doi">10.1002/cne.23414</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Scott</surname><given-names>D. W.</given-names></name></person-group> (<year>2015</year>). <source>Multivariate Density Estimation: Theory, Practice, and Visualization</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>John Wiley &amp; Sons</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stepanyants</surname><given-names>A.</given-names></name><name><surname>Tamás</surname><given-names>G.</given-names></name><name><surname>Chklovskii</surname><given-names>D. B.</given-names></name></person-group> (<year>2004</year>). <article-title>Class-specific features of neuronal wiring</article-title>. <source>Neuron</source>
<volume>43</volume>, <fpage>251</fpage>–<lpage>259</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2004.06.013</pub-id><?supplied-pmid 15260960?><pub-id pub-id-type="pmid">15260960</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Virtanen</surname><given-names>P.</given-names></name><name><surname>Gommers</surname><given-names>R.</given-names></name><name><surname>Oliphant</surname><given-names>T. E.</given-names></name><name><surname>Haberland</surname><given-names>M.</given-names></name><name><surname>Reddy</surname><given-names>T.</given-names></name><name><surname>Cournapeau</surname><given-names>D.</given-names></name><etal/></person-group>. (<year>2020</year>). <article-title>SciPy 1.0: fundamental algorithms for scientific computing in python</article-title>. <source>Nat. Methods</source><volume>17</volume>, <fpage>261</fpage>–<lpage>272</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id><?supplied-pmid 32015543?><pub-id pub-id-type="pmid">32015543</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winnubst</surname><given-names>J.</given-names></name><name><surname>Bas</surname><given-names>E.</given-names></name><name><surname>Ferreira</surname><given-names>T. A.</given-names></name><name><surname>Wu</surname><given-names>Z.</given-names></name><name><surname>Economo</surname><given-names>M. N.</given-names></name><name><surname>Edson</surname><given-names>P.</given-names></name><etal/></person-group>. (<year>2019</year>). <article-title>Reconstruction of 1,000 projection neurons reveals new cell types and organization of long-range connectivity in the mouse brain</article-title>. <source>Cell</source><volume>179</volume>, <fpage>268</fpage>–<lpage>281</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2019.07.042</pub-id><?supplied-pmid 31495573?><pub-id pub-id-type="pmid">31495573</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
