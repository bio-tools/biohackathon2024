<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Proc</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Proc</journal-id>
    <journal-title-group>
      <journal-title>BMC Proceedings</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1753-6561</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4043421</article-id>
    <article-id pub-id-type="publisher-id">1753-6561-7-S7-S7</article-id>
    <article-id pub-id-type="doi">10.1186/1753-6561-7-S7-S7</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Proceedings</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Adaptive bandwidth kernel density estimation for next-generation sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Ramachandran</surname>
          <given-names>Parameswaran</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>rpara26@gmail.com</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A2">
        <name>
          <surname>Perkins</surname>
          <given-names>Theodore J</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>tperkins@ohri.ca</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Ottawa Hospital Research Institute, Regenerative Medicine Program, K1H 8L6, Ottawa, Canada</aff>
    <aff id="I2"><label>2</label>University of Ottawa, Department of Biochemistry, Microbiology and Immunology, Faculty of Medicine, K1H 8M5, Ottawa, Canada</aff>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>12</month>
      <year>2013</year>
    </pub-date>
    <volume>7</volume>
    <issue>Suppl 7</issue>
    <supplement>
      <named-content content-type="supplement-title">Proceedings of the Great Lakes Bioinformatics Conference 2013</named-content>
      <named-content content-type="supplement-editor">Victor Jin</named-content>
      <named-content content-type="supplement-sponsor">Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. Articles have undergone the journal's standard review process for supplements. The Supplement Editor declares that he has no competing interests.</named-content>
    </supplement>
    <fpage>S7</fpage>
    <lpage>S7</lpage>
    <permissions>
      <copyright-statement>Copyright © 2013 Ramachandran and Perkins; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Ramachandran and Perkins; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1753-6561/7/S7/S7"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>High-throughput sequencing experiments can be viewed as measuring some sort of a "genomic signal" that may represent a biological event such as the binding of a transcription factor to the genome, locations of chromatin modifications, or even a background or control condition. Numerous algorithms have been developed to extract different kinds of information from such data. However, there has been very little focus on the reconstruction of the genomic signal itself. Such reconstructions may be useful for a variety of purposes ranging from simple visualization of the signals to sophisticated comparison of different datasets.</p>
      </sec>
      <sec>
        <title>Methods</title>
        <p>Here, we propose that adaptive-bandwidth kernel density estimators are well-suited for genomic signal reconstructions. This class of estimators is a natural extension of the fixed-bandwidth estimators that have been employed in several existing ChIP-Seq analysis programs.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Using a set of ChIP-Seq datasets from the ENCODE project, we show that adaptive-bandwidth estimators have greater accuracy at signal reconstruction compared to fixed-bandwidth estimators, and that they have significant advantages in terms of visualization as well. For both fixed and adaptive-bandwidth schemes, we demonstrate that smoothing parameters can be set automatically using a held-out set of tuning data. We also carry out a computational complexity analysis of the different schemes and confirm through experimentation that the necessary computations can be readily carried out on a modern workstation without any significant issues.</p>
      </sec>
    </abstract>
    <conference>
      <conf-date>14-16 May 2013</conf-date>
      <conf-name>Great Lakes Bioinformatics Conference 2013</conf-name>
      <conf-loc>Pittsburgh, PA, USA</conf-loc>
    </conference>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>High-throughput sequencing (HTS) has become a central technology in genome-wide studies of protein-DNA interactions, chromatin-state modifications, gene regulation and expression, copy number variations, etc. [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>]. In many cases, such experiments can be viewed abstractly as attempting to measure a "signal" <italic>f </italic>that varies across the genome. For instance, if the DNA that is sequenced comes from chromatin immunopreciptation (ChIP) of a transcription factor, then the signal <italic>f </italic>is expected to have the highest amplitude in regions of the genome where the factor binds most strongly. If the sequenced DNA comes from reverse transcription of RNA, then <italic>f </italic>is expected to have the highest amplitude in regions of the genome that are most actively transcribed. Of course, experience with HTS technologies has shown that such genome-wide signals also reflect other biases or influences--due to, for example, sequencing, chromatin accessibility, mappability, etc. [<xref ref-type="bibr" rid="B3">3</xref>]. Techniques for correcting such biases are beginning to emerge [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>]. Regardless, highthroughput sequencing continues to generate numerous important insights into the molecular networks that govern the cell.</p>
    <p>Various analysis algorithms specialize in extracting biologically-relevant information from different types of HTS data. For example, peak-calling algorithms take mapped reads and attempt to identify regions of high enrichment (for review and some comparisons, see [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>]). Some algorithms attempt to solve this problem generally, whereas others specialize in identifying punctate transcription-factor binding sites [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>] or, conversely, broader regional enrichment, as is often seen in histone modification patterns [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B10">10</xref>]. Similarly, a raft of algorithms specializes in estimating gene expression, including the expression of alternative spliceoforms (e.g., [<xref ref-type="bibr" rid="B11">11</xref>-<xref ref-type="bibr" rid="B14">14</xref>]). While such approaches are clearly valuable, few deal directly with the problem of estimating the genomewide signal <italic>f</italic>.</p>
    <p>Yet, there are many reasons to be interested in such a direct reconstruction. Perhaps the most straightforward is that reconstructing <italic>f </italic>is useful for visualization in genome browser tracks. Visualization of the signal allows biologists to sanity-check their data, compare different signals at an intuitive level, identify regions of interest, generate hypotheses, and so on [<xref ref-type="bibr" rid="B15">15</xref>]. Reconstruction also allows us to manipulate and combine different signals, for example by "subtracting" a background noise/control signal from a treatment signal. Indeed, there is some evidence from the peak-calling literature that true binding and background processes can be separated, leading to enhanced signal fidelity [<xref ref-type="bibr" rid="B10">10</xref>,<xref ref-type="bibr" rid="B16">16</xref>]. We contend that such issues have not been explored in the literature nearly as thoroughly as they should have been, in part because of a lack of focus on the more elementary problem of reconstructing genome-wide signals themselves.</p>
    <p>The question then becomes, how can we best reconstruct the genome-wide signals measured by HTS experiments? One simple approach is a read "pileup" map. The details of computing a pile-up depend on whether DNA fragments are sequenced entirely or only partially and, in the latter case, also on whether they are sequenced partially from just one end (resulting in single-end reads) or from both ends (resulting in paired-end reads). In the case of a single-end dataset, which is probably the most common type of HTS dataset at present, the sequenced reads are mapped back to the genome to obtain their locations (Figure <xref ref-type="fig" rid="F1">1A</xref>). Then the positive-and negative-strand reads are either extended to the mean fragment length (Figure <xref ref-type="fig" rid="F1">1B</xref>) or shifted towards each other by half the mean fragment length. In the former case, the signal profile is built as an aggregation of the intervals representing the fragments (Figure <xref ref-type="fig" rid="F1">1C</xref>) [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>]. In the latter case, the simplest way of building a profile is by using a moving histogram. This involves sliding a window of fixed width across the genome and counting the number of reads falling within the window as the window moves forward. Although such histograms have been implemented in various versions [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B18">18</xref>-<xref ref-type="bibr" rid="B20">20</xref>], in general, histograms are problematic as estimators because they are not smooth and the resulting estimates are strongly affected by the choice of histogram bin width.</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>Different approaches to genomic signal reconstruction</bold>. (A) Reads in a portion of the genome. Positive-strand read starts are shown as spikes above the center line, while negative-strand read starts are below the center line. (B) Extending reads by the mean fragment length in the direction indicated by the strand to which they are mapped. (C) Pile-up curve obtained by adding together the extended read intervals, regardless of direction. (D) Fixed-bandwidth kernel density estimate (KDE) obtained using Gaussian kernels and after shifting each read position by half the mean fragment length in the read direction (positive or negative strand). (E) Adaptive-bandwidth KDE, also obtained using Gaussian kernels. This method creates greater smoothing in areas of low data density and emphasizes enriched regions more strongly.</p>
      </caption>
      <graphic xlink:href="1753-6561-7-S7-S7-1"/>
    </fig>
    <p>An alternative and more accurate estimator is the <italic>kernel density estimator </italic>(KDE), where a kernel (e.g., Gaussian) of a chosen bandwidth (standard deviation) is centered at each sample point (a read), and the kernels are then summed to obtain the density estimate (Figure <xref ref-type="fig" rid="F1">1D</xref>) [<xref ref-type="bibr" rid="B21">21</xref>,<xref ref-type="bibr" rid="B22">22</xref>]. Intuitively, high-density regions would correspond to tall peaks due to the piling up of closely-spaced kernels. These KDE-based density estimates can be thought of as denoting the probability of finding a read at a given base pair location. QuEST [<xref ref-type="bibr" rid="B23">23</xref>], F-Seq [<xref ref-type="bibr" rid="B15">15</xref>], and Qeseq [<xref ref-type="bibr" rid="B7">7</xref>] apply this method to identify enriched regions in HTS data. Although the density estimates obtained by these algorithms are in general smoother and more accurate than those obtained using histograms, the bandwidths of the kernels are fixed and are chosen arbitrarily (QuEST uses 30 bp, Qeseq uses 150 bp, and F-Seq uses an indirect feature-length parameter to set bandwidth to typically a few thousand bp). The fact that the quality of the density estimates are very much dependent on the choice of the kernel bandwidth necessitates a more careful and methodical approach to bandwidth selection. In theory, a single optimal bandwidth can be systematically chosen for a given dataset using one of the popular plug-in or crossvalidation approaches [<xref ref-type="bibr" rid="B24">24</xref>-<xref ref-type="bibr" rid="B28">28</xref>]. However, the large genome sizes and the sparsity of HTS data make it a cumbersome process to estimate bandwidth in this manner. Even if achieved, a single bandwidth for the entire genome would not usually be sufficient for identifying enriched regions with a high degree of accuracy, owing to the widely varying spatial smoothness of the read distributions. Ideally, small bandwidths work best for high-density regions and large bandwidths work best for low-density regions. If the bandwidth is fixed for the entire genome, then it has to take a compromise value between the two extremes, thus limiting the accuracy of the resulting density estimate. In addition, the estimate would tend to have a large number of spurious local maxima corresponding to individual reads in low-density regions (Figure <xref ref-type="fig" rid="F1">1D</xref>). Due to these reasons, a fixed-bandwidth KDE is not the best choice for modeling the widely-varying distributions associated with ChIP-Seq or other types of HTS data.</p>
    <p>An effective alternative is to use an adaptive scheme that utilizes local data features to dynamically adjust the density estimate to reflect variations in the underlying true density. <italic>Adaptive-bandwidth </italic>KDE, as the name suggests, achieves this by adapting (or varying) the kernel bandwidth according to the local characteristics of the data. Two types of adaptive-bandwidth KDEs have been investigated in the literature. First is the <italic>balloon </italic>estimator [<xref ref-type="bibr" rid="B29">29</xref>] where, for each estimation point, a bandwidth is first chosen and the estimate at that point is then computed as an average of the identically-scaled kernels evaluated at that point. The kernels are, of course, centered at the data points. Since the bandwidth is fixed for a given estimation point, this estimator, taken pointwise, behaves like a fixed-bandwidth KDE. Although the estimator has been shown to be promising in higher dimensions, it has serious drawbacks in the univariate and bivariate settings [<xref ref-type="bibr" rid="B30">30</xref>,<xref ref-type="bibr" rid="B31">31</xref>]. Most importantly, the estimate fails to integrate to one and, in certain situations, has a performance that is worse than that of the fixed-bandwidth KDE.</p>
    <p>The second type of adaptive-bandwidth estimator is the <italic>sample-point </italic>estimator, where a bandwidth is selected for each data point instead of the estimation point [<xref ref-type="bibr" rid="B32">32</xref>]. The estimate <inline-formula><mml:math id="M1" name="1753-6561-7-S7-S7-i1" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is then an average of differently-scaled kernels centered at the data points. When the kernel function is a density, <inline-formula><mml:math id="M2" name="1753-6561-7-S7-S7-i1" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> itself is a density. This type of estimator has been generally found to be a better performer than the balloon estimator [<xref ref-type="bibr" rid="B31">31</xref>,<xref ref-type="bibr" rid="B33">33</xref>,<xref ref-type="bibr" rid="B34">34</xref>], and is easily adaptable for HTS data. In addition, considering the large genomic sizes that are encountered, the estimate is simple and straightforward to compute since there are only as many kernels as the number of reads in the data. The only caveat, pointed out in [<xref ref-type="bibr" rid="B31">31</xref>], is a phenomenon referred to as "non-locality" where the estimate at a certain point can be affected by kernels corresponding to data very far away from it. However, in practice, this would not be an issue because, for the sake of computational feasibility, the kernel tails would have to be truncated after a reasonable number of standard deviations. This truncation would typically have no serious consequence as the values involved would be very small.</p>
    <p>In this paper, we present an <italic>adaptive-bandwidth </italic>KDE for modeling the tag distributions of HTS data. The estimator automatically adjusts to the smoothness variations by choosing an appropriate local bandwidth for every read location, thereby leading to a much better estimate of the underlying distribution compared to that obtained using a fixed-bandwidth KDE. To the best of our knowledge, adaptive-bandwidth KDEs have not been considered for HTS data before. The method is inspired from the <italic>sample-point </italic>estimator [<xref ref-type="bibr" rid="B32">32</xref>], but has a number of new features that have been specifically developed to make it suitable for use in HTS data analysis. We consider three possibilities for the choice of the kernel function, namely, the square, triangular, and Gaussian distributions, and compare and evaluate their performance using a number of public datasets. For more detailed discussions on adaptive KDEs in general, the reader is referred to [<xref ref-type="bibr" rid="B29">29</xref>-<xref ref-type="bibr" rid="B31">31</xref>,<xref ref-type="bibr" rid="B33">33</xref>-<xref ref-type="bibr" rid="B35">35</xref>] and references therein.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Datasets</title>
      <p>We compare different density estimation approaches on a suite of ten ENCODE single-end ChIP-Seq datasets available through the Gene Expression Omnibus. We downloaded the data in the form of BAM files, in which reads have already been mapped to positions in the human genome. We chose five datasets describing pulldowns for histone 3 with the following modifications: H3K27ac (GSM733718), H3K27me3 (GSM733748), H3K36me3 (GSM733725), H3K4me1 (GSM733782), and H3K4me2 (GSM733670). The other five datasets describe binding of the following transcription factors: BRCA1 (GSM935377), CTCF (GSM733672), GTF2F1 (GSM935581), RAD21 (GSM803466), and REST (GSM803365). For the sake of computational convenience, we restricted our attention to estimating the genomic signal on chromosome 1. In pilot studies we conducted, there were no significant differences in conclusions based on density estimation over the whole genome versus density estimation on just chromosome 1. By focusing on chromosome 1, our computations proceeded much faster. Hence, we first isolated the reads from chromosome 1, removed any duplicate reads, and then shifted positive and negative strand reads towards each other by one half the fragment length, which was estimated using the MaSC approach [<xref ref-type="bibr" rid="B5">5</xref>]. We took the starting positions of the resulting reads as data "points" for the purpose of density estimation, and sorted them in ascending order. Each dataset was thus reduced to a sorted list of positions <italic>X </italic>= (<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>, <italic>. . </italic>., <italic>x<sub>n</sub></italic>).</p>
    </sec>
    <sec>
      <title>Fixed and adaptive bandwidth kernel density estimators</title>
      <p>From a density-estimation perspective, the data <italic>X </italic>is viewed as being sampled from some unknown distribution <italic>f</italic>(<italic>x</italic>) on the genome. The idea is to estimate <italic>f </italic>using the sample data. We do this with a <italic>kernel density estimator</italic>, which is of the form</p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math id="M3" name="1753-6561-7-S7-S7-i2" overflow="scroll">
            <mml:mrow>
              <mml:mover accent="true">
                <mml:mrow>
                  <mml:mi>f</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-op"> ^</mml:mo>
              </mml:mover>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>n</mml:mi>
                </mml:mrow>
              </mml:mfrac>
              <mml:mstyle displaystyle="true">
                <mml:munderover accent="false" accentunder="false">
                  <mml:mrow>
                    <mml:mo mathsize="big"> ∑</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo class="MathClass-rel">=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>n</mml:mi>
                  </mml:mrow>
                </mml:munderover>
              </mml:mstyle>
              <mml:mi>K</mml:mi>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                  <mml:mo class="MathClass-bin">-</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>h</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Here, <italic>x </italic>is a <italic>query point </italic>at which we want to evaluate our estimate of <italic>f</italic>, <italic>K </italic>is a kernel function, <italic>x<sub>i </sub></italic>is a sample data point, and <italic>h<sub>i </sub></italic>is the <italic>bandwidth </italic>associated with <italic>x<sub>i</sub></italic>. The kernel function <italic>K</italic>, for example, might be Gaussian in shape, with mean zero and standard deviation <italic>h<sub>i</sub></italic>. The translated kernel, <italic>K</italic>(<italic>x − x<sub>i</sub></italic>, <italic>h<sub>i</sub></italic>), would then have mean <italic>x<sub>i</sub></italic>.</p>
      <p>In a <italic>fixed-bandwidth </italic>kernel density estimate, <italic>h<sub>i </sub></italic>is equal to a constant value <italic>h</italic>, which may be chosen <italic>a priori </italic>or dependent somehow on the data. Intuitively, the larger <italic>h </italic>is, the more aggressively the data is smoothed, because the kernel function becomes broader for larger <italic>h</italic>. Below, we also experiment with blending fixed-bandwidth estimators with a uniform density. This creates a density of the form <inline-formula><mml:math id="M4" name="1753-6561-7-S7-S7-i3" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>ε</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow><mml:mo class="MathClass-rel">=</mml:mo><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo class="MathClass-bin">-</mml:mo><mml:mi>ε</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow><mml:mo class="MathClass-bin">+</mml:mo><mml:mi>ε</mml:mi><mml:mi>u</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic>ε </italic>∈ [0, 1], <inline-formula><mml:math id="M5" name="1753-6561-7-S7-S7-i4" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover><mml:mfenced close=")" open="("><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math></inline-formula> is the kernel density estimate of Eqn. 1, and <italic>u</italic>(<italic>x</italic>) is a uniform density over the genome. [In fact, because we are concerned with probabilities over integer base pair positions, we should be discussing probability <italic>distributions </italic>rather than probability <italic>densities</italic>. However, in keeping with the traditional terminology of these estimators, we will employ the term 'density' throughout.]</p>
      <p>In an <italic>adaptive-bandwidth </italic>kernel density estimator, each <italic>h<sub>i </sub></italic>is allowed to be different. We employ a variant of the <italic>k</italic>-nearest neighbor rule to assign the bandwidth <italic>h<sub>i</sub></italic>. In the statistics literature, there are various schemes for assigning bandwidths. Perhaps the simplest and the most practical rule is to assign to point <italic>x<sub>i </sub></italic>a bandwidth <italic>h<sub>i </sub></italic>equal to the absolute distance from <italic>x<sub>i </sub></italic>to its <italic>k<sub>th </sub></italic>nearest neighbor [<xref ref-type="bibr" rid="B31">31</xref>]. We will call this the KNN1 rule. Intuitively, in regions of sparse data, the <italic>k<sub>th </sub></italic>nearest neighbor will be far away, and so large bandwidths will be assigned, leading to aggressive smoothing of the signal. In dense regions, on the other hand, the <italic>k<sub>th </sub></italic>nearest neighbor will be much closer, leading to small bandwidths, and thereby an accurate reconstruction of the signal. The choice of <italic>k </italic>allows us to indirectly control (to a certain degree) the bandwidth assigned to each point--large <italic>k </italic>values generally lead to large bandwidths, although the exact bandwidth assigned to each point depends on its proximity to its neighbors.</p>
      <p>It turns out that the KNN1 rule has a minor problem which can be awkward in practice. Consider the situation where there are two regions of dense data with a sparse region in between. It may so happen that the bandwidths of all points (at least for some choices of <italic>k</italic>) may be set by points within the same dense region. Consequently, no points, including those at the inside edges of the dense regions, would be assigned a large bandwidth, wide enough to cover the span of the sparse region. Therefore, the points in the sparse region may each end up with a probability of zero. If we then evaluate a new set of data points on the density estimate, and a single point from this set happens to fall in the aforementioned sparse region, then the zero probability assigned to this point would result in the joint probability of the new set of points to be zero--all because of that single point in the sparse region. This "zero problem" is quite common with ChIP-seq datasets, where there are large numbers of very sparse regions.</p>
      <p>To circumvent this problem, we propose a variant of KNN1 for assigning bandwidths, which we call KNN2. According to this rule, a point <italic>x<sub>i </sub></italic>is assigned the same bandwidth as in the KNN1 rule unless all <italic>k </italic>of its nearest neighbors are on the same side (left or right). In that case, we instead take the bandwidth to be the distance to the single nearest point in the opposite direction. This rule ensures that the density estimate is nonzero everywhere (except possibly at the extreme ends of the range), thereby avoiding the zero problem.</p>
    </sec>
    <sec>
      <title>Kernel functions</title>
      <p>We explore three possible shapes of the kernel function: Gaussian, square (also known as the Parzen window), and triangle (also known as the hat function). As a matter of computational convenience, we truncate the Gaussian distribution at ± 5 standard deviations. We interpret the bandwidth parameter <italic>h </italic>for each shape of the kernel function in such a way that, when viewed as a distribution in its own right, the standard deviation of that distribution is approximately equal to the bandwidth parameter. This ensures the greatest comparability of results from different kernel functions in experiments where we vary bandwidths or employ adaptive bandwidths. We also take care that each kernel function sums to one. As such, the three kernel functions we consider are</p>
      <p>
        <disp-formula>
          <mml:math id="M6" name="1753-6561-7-S7-S7-i5" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>K</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:mi>h</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfenced open="{">
                <mml:mrow>
                  <mml:mtable class="array" columnlines="none none none none none none none none none none none none none none none none none none none" equalcolumns="false" equalrows="false">
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="left">
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>c</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>g</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">(</mml:mo>
                          <mml:mrow>
                            <mml:mi>h</mml:mi>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">)</mml:mo>
                        </mml:mrow>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">exp</mml:mtext>
                        </mml:mstyle>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">(</mml:mo>
                          <mml:mrow>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>x</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo class="MathClass-bin">/</mml:mo>
                            <mml:mn>2</mml:mn>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>h</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">)</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd class="array" columnalign="left">
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">if</mml:mtext>
                        </mml:mstyle>
                        <mml:mspace class="tmspace" width="2.77695pt"/>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">|</mml:mtext>
                        </mml:mstyle>
                        <mml:mi>x</mml:mi>
                        <mml:mo class="MathClass-rel">|</mml:mo>
                        <mml:mspace class="tmspace" width="2.77695pt"/>
                        <mml:mo class="MathClass-rel">≤</mml:mo>
                        <mml:mn>5</mml:mn>
                        <mml:mi>h</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="left">
                        <mml:mn>0</mml:mn>
                      </mml:mtd>
                      <mml:mtd class="array" columnalign="left">
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">if</mml:mtext>
                        </mml:mstyle>
                        <mml:mspace class="tmspace" width="2.77695pt"/>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">|</mml:mtext>
                        </mml:mstyle>
                        <mml:mi>x</mml:mi>
                        <mml:mo class="MathClass-rel">|</mml:mo>
                        <mml:mspace class="tmspace" width="2.77695pt"/>
                        <mml:mo class="MathClass-rel">&gt;</mml:mo>
                        <mml:mn>5</mml:mn>
                        <mml:mi>h</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula>
          <mml:math id="M7" name="1753-6561-7-S7-S7-i6" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>K</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                  <mml:mi>q</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:mi>h</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfenced open="{">
                <mml:mrow>
                  <mml:mtable class="array" columnlines="none none none none none none none none none none none none none none none none none none none" equalcolumns="false" equalrows="false">
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="left">
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>c</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                            <mml:mi>q</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">(</mml:mo>
                          <mml:mrow>
                            <mml:mi>h</mml:mi>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">)</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd class="array" columnalign="left">
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">if</mml:mtext>
                        </mml:mstyle>
                        <mml:mspace class="tmspace" width="2.77695pt"/>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">|</mml:mtext>
                        </mml:mstyle>
                        <mml:mi>x</mml:mi>
                        <mml:mo class="MathClass-rel">|</mml:mo>
                        <mml:mspace class="tmspace" width="2.77695pt"/>
                        <mml:mo class="MathClass-rel">≤</mml:mo>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msqrt>
                        <mml:mrow>
                          <mml:mi>h</mml:mi>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="left">
                        <mml:mn>0</mml:mn>
                      </mml:mtd>
                      <mml:mtd class="array" columnalign="left">
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">if</mml:mtext>
                        </mml:mstyle>
                        <mml:mspace class="tmspace" width="2.77695pt"/>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">|</mml:mtext>
                        </mml:mstyle>
                        <mml:mi>x</mml:mi>
                        <mml:mo class="MathClass-rel">|</mml:mo>
                        <mml:mspace class="tmspace" width="2.77695pt"/>
                        <mml:mo class="MathClass-rel">&gt;</mml:mo>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:mrow>
                        </mml:msqrt>
                        <mml:mrow>
                          <mml:mi>h</mml:mi>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula>
          <mml:math id="M8" name="1753-6561-7-S7-S7-i7" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>K</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                  <mml:mi>r</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:mi>h</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfenced open="{">
                <mml:mrow>
                  <mml:mtable class="array" columnlines="none none none none none none none none none none none none none none none none none none none" equalcolumns="false" equalrows="false">
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="left">
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>c</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>t</mml:mi>
                            <mml:mi>r</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">(</mml:mo>
                          <mml:mrow>
                            <mml:mi>h</mml:mi>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">(</mml:mo>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:mo class="MathClass-rel">|</mml:mo>
                            <mml:mi>x</mml:mi>
                            <mml:mo class="MathClass-rel">|</mml:mo>
                            <mml:mo class="MathClass-bin">/</mml:mo>
                            <mml:msqrt>
                              <mml:mrow>
                                <mml:mn>6</mml:mn>
                              </mml:mrow>
                            </mml:msqrt>
                            <mml:mrow>
                              <mml:mi>h</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">)</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd class="array" columnalign="left">
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">if</mml:mtext>
                        </mml:mstyle>
                        <mml:mspace class="tmspace" width="2.77695pt"/>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">|</mml:mtext>
                        </mml:mstyle>
                        <mml:mi>x</mml:mi>
                        <mml:mo class="MathClass-rel">|</mml:mo>
                        <mml:mspace class="tmspace" width="2.77695pt"/>
                        <mml:mo class="MathClass-rel">≤</mml:mo>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mn>6</mml:mn>
                          </mml:mrow>
                        </mml:msqrt>
                        <mml:mrow>
                          <mml:mi>h</mml:mi>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="left">
                        <mml:mn>0</mml:mn>
                      </mml:mtd>
                      <mml:mtd class="array" columnalign="left">
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">if</mml:mtext>
                        </mml:mstyle>
                        <mml:mspace class="tmspace" width="2.77695pt"/>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">|</mml:mtext>
                        </mml:mstyle>
                        <mml:mi>x</mml:mi>
                        <mml:mo class="MathClass-rel">|</mml:mo>
                        <mml:mspace class="tmspace" width="2.77695pt"/>
                        <mml:mo class="MathClass-rel">&gt;</mml:mo>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mn>6</mml:mn>
                          </mml:mrow>
                        </mml:msqrt>
                        <mml:mrow>
                          <mml:mi>h</mml:mi>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Here, <italic>c<sub>g </sub></italic>(<italic>h</italic>), <italic>c<sub>sq </sub></italic>(<italic>h</italic>), and <italic>c<sub>tr </sub></italic>(<italic>h</italic>) are normalizations that ensure, as a function of bandwidth, that each kernel sums to one.</p>
    </sec>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <sec>
      <title>Effects of different density estimation schemes in genomic signal reconstruction</title>
      <p>To help visualize the effects of different density estimation approaches on real data, we computed fixed- and adaptive-bandwidth Gaussian density estimates based on the Rad21 data in a window of chromosome 1. For fixed-bandwidth estimation, we considered two choices: <italic>h </italic>= 16 (close to the <italic>h </italic>= 15 default used in QuEST), and <italic>h </italic>= 362, which we show in the next subsection to be the optimal value according to the probability of held-out tuning data (at least when optimized over integer powers of <inline-formula><mml:math id="M9" name="1753-6561-7-S7-S7-i8" overflow="scroll"><mml:msqrt><mml:mrow><mml:mi> </mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msqrt></mml:math></inline-formula>). For adaptive bandwidth, we also considered two choices: <italic>k </italic>= 7, which is optimal according to a held-out tuning dataset, and <italic>k </italic>= 14, chosen to increase smoothing.</p>
      <p>The results are shown in Figure <xref ref-type="fig" rid="F2">2A</xref>. The fixed bandwidth estimate with <italic>h </italic>= 16 includes many fluctuations across the window. Indeed, in data-sparse regions of the window, each data point (shown by a black mark) produces its own small bump in the curve, just as in our idealized example of Figure <xref ref-type="fig" rid="F1">1</xref>. Between these bumps, the density estimate is zero--although it is probably reasonable to expect that, if the experiments were repeated, reads may appear at other locations within the region of generally low signal. Still, the density estimate is highest where the most data can be found, and these strong peaks in the curve are readily picked out by the eye. With the larger bandwidth of <italic>h </italic>= 362, most fluctuations in the curve are smoothed away, leaving only broad swells where the data is most dense. This, correctly, eliminates the visual distraction of small fluctuations, although it also de-emphasizes the more dense regions and possible structure within them (such as possible multiple peaks). The adaptive bandwidth estimates eliminate small fluctuations for both choices of <italic>k</italic>, while still strongly emphasizing data-dense regions. The difference between the estimates corresponding to <italic>k </italic>= 7 and <italic>k </italic>= 14 has more to do with the fine structure of dense regions--questions such as "is an enriched region a single peak, or two or three separate peaks?" In the next section, we demonstrate that <italic>k </italic>(or <italic>h</italic>) can be optimized using held-out data in a tuning set. However, such questions of fine structure may also be studied by considering additional information, such as the locations of binding motifs for the factor, or signals in other ChIP-Seq datasets.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Effects of different signal-reconstruction approaches</bold>. (A) From top to bottom: fixed-bandwidth Gaussian estimators for a portion of the Rad21 data using <italic>h </italic>= 16 (close to the <italic>h </italic>= 15 that is default in the QuEST software) and <italic>h </italic>= 362 (which appears optimal based on evaluation of held-out tuning data), adaptive-bandwidth Gaussian estimators using <italic>k </italic>= 7 (optimal based on held-out tuning data) and <italic>k </italic>= 14 (double the optimal choice, and intended to obtain more aggressive smoothing). In each plot, the curve shows the reconstructed density. The short black vertical marks indicate the read positions. (B) Histograms of heights of local maxima for fixed-bandwidth Gaussian (<italic>h </italic>= 362) and adaptive-bandwidth Gaussian (<italic>k </italic>= 7). Note that the vertical axes are in log scale.</p>
        </caption>
        <graphic xlink:href="1753-6561-7-S7-S7-2"/>
      </fig>
      <p>To quantitatively demonstrate the qualitative effects described above, we identified all strict local maxima for chromosome 1 in the fixed bandwith <italic>h </italic>= 362 and the adaptive bandwidth <italic>k </italic>= 7 curves. The curve <italic>f </italic>has a <italic>strict </italic>local maximum at position <italic>b </italic>if <italic>f </italic>(<italic>b</italic>) <italic>&gt; f </italic>(<italic>b − </italic>1) and <italic>f </italic>(<italic>b</italic>) <italic>&gt; f </italic>(<italic>b </italic>+ 1). While some local maxima correspond to regions of high read densities that are biologically significant, such as a transcription-factor binding site, other local maxima correspond to peaks of stand-alone kernel functions corresponding to individual reads that are likely to have no significance. Figure <xref ref-type="fig" rid="F2">2B</xref> shows histograms of the heights of these maxima. From the histograms, we see that the adaptive bandwidth estimator produces a much wider range of peak heights resulting from the fact that it strongly emphasizes data-dense regions. It also produces a smaller number of local maxima (NLM)--a trend that holds for most, though not all, of the datasets we have considered here (see Table <xref ref-type="table" rid="T1">1</xref>). Unsurprisingly, we note a generally inverse relationship between the bandwidth <italic>h </italic>or the number of nearest neighbors <italic>k </italic>and the number of local maxima in the resulting density estimate. Nevertheless, all density estimates have tens of thousands of local maxima, considering that these results correspond only to chromosome 1. Therefore, when computed for the whole genome, the numbers can be expected to be much greater than the expected number of <italic>bona fide </italic>binding sites for a transcription factor.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Optimized Parameters</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="center">Dataset</th>
              <th align="center" colspan="3">Fixed BW KDE</th>
              <th align="center" colspan="7">Adaptive BW KDE</th>
            </tr>
            <tr>
              <th/>
              <th colspan="10">
                <hr/>
              </th>
            </tr>
            <tr>
              <th/>
              <th align="center">Opt. <italic>h</italic></th>
              <th align="center">NLM</th>
              <th align="center">CPU time (s)</th>
              <th align="center">Opt. <italic>k</italic></th>
              <th align="center">NLM</th>
              <th align="center" colspan="5">CPU time (s) (Gau/Tri/Sq)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">H3K27ac</td>
              <td align="center">1024</td>
              <td align="center">40892</td>
              <td align="center">395</td>
              <td align="center">18</td>
              <td align="center">32357</td>
              <td align="center">1563</td>
              <td align="center">/</td>
              <td align="center">653</td>
              <td align="center">/</td>
              <td align="center">161</td>
            </tr>
            <tr>
              <td align="center">H3K27me3</td>
              <td align="center">2048</td>
              <td align="center">21476</td>
              <td align="center">230</td>
              <td align="center">16</td>
              <td align="center">12291</td>
              <td align="center">1513</td>
              <td align="center">/</td>
              <td align="center">620</td>
              <td align="center">/</td>
              <td align="center">128</td>
            </tr>
            <tr>
              <td align="center">H3K36me3</td>
              <td align="center">2048</td>
              <td align="center">21052</td>
              <td align="center">679</td>
              <td align="center">25</td>
              <td align="center">19035</td>
              <td align="center">2117</td>
              <td align="center">/</td>
              <td align="center">946</td>
              <td align="center">/</td>
              <td align="center">217</td>
            </tr>
            <tr>
              <td align="center">H3K4me1</td>
              <td align="center">1448</td>
              <td align="center">28264</td>
              <td align="center">240</td>
              <td align="center">7</td>
              <td align="center">43188</td>
              <td align="center">763</td>
              <td align="center">/</td>
              <td align="center">300</td>
              <td align="center">/</td>
              <td align="center">74</td>
            </tr>
            <tr>
              <td align="center">H3K4me2</td>
              <td align="center">724</td>
              <td align="center">55799</td>
              <td align="center">336</td>
              <td align="center">11</td>
              <td align="center">41147</td>
              <td align="center">934</td>
              <td align="center">/</td>
              <td align="center">376</td>
              <td align="center">/</td>
              <td align="center">83</td>
            </tr>
            <tr>
              <td align="center">BRCA1</td>
              <td align="center">1448</td>
              <td align="center">29078</td>
              <td align="center">861</td>
              <td align="center">24</td>
              <td align="center">33822</td>
              <td align="center">2158</td>
              <td align="center">/</td>
              <td align="center">842</td>
              <td align="center">/</td>
              <td align="center">233</td>
            </tr>
            <tr>
              <td align="center">CTCF</td>
              <td align="center">512</td>
              <td align="center">82386</td>
              <td align="center">184</td>
              <td align="center">8</td>
              <td align="center">53094</td>
              <td align="center">685</td>
              <td align="center">/</td>
              <td align="center">249</td>
              <td align="center">/</td>
              <td align="center">54</td>
            </tr>
            <tr>
              <td align="center">GTF2F1</td>
              <td align="center">1024</td>
              <td align="center">40399</td>
              <td align="center">573</td>
              <td align="center">22</td>
              <td align="center">37024</td>
              <td align="center">1776</td>
              <td align="center">/</td>
              <td align="center">633</td>
              <td align="center">/</td>
              <td align="center">148</td>
            </tr>
            <tr>
              <td align="center">RAD21</td>
              <td align="center">362</td>
              <td align="center">111671</td>
              <td align="center">158</td>
              <td align="center">7</td>
              <td align="center">51692</td>
              <td align="center">629</td>
              <td align="center">/</td>
              <td align="center">256</td>
              <td align="center">/</td>
              <td align="center">61</td>
            </tr>
            <tr>
              <td align="center">REST</td>
              <td align="center">724</td>
              <td align="center">57598</td>
              <td align="center">287</td>
              <td align="center">14</td>
              <td align="center">29816</td>
              <td align="center">1213</td>
              <td align="center">/</td>
              <td align="center">455</td>
              <td align="center">/</td>
              <td align="center">104</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>To the extent that some of the local maxima correspond to "noise" in the density estimate, we can say that larger kernel bandwidths and/or adaptively chosen bandwidths (as opposed to fixed bandwidths) generally produce less noisy density estimates. Specifically, among the three kernel functions considered, the square kernel tends to yield the most noisy signal, understandably due to its abrupt transitions (a rising edge and a falling edge for every kernel centered at a read). In comparison, the triangle kernel is smoother (or less noisy) due to its piecewise linearity. The Gaussian kernel, on the other hand, yields the smoothest (or the least noisy) density signal, due, of course, to its well-known smoothing and denoising properties [<xref ref-type="bibr" rid="B36">36</xref>].</p>
    </sec>
    <sec>
      <title>Adaptive-bandwidth KDE outperforms fixed-bandwidth KDE on held-out data</title>
      <p>To more formally assess the accuracy of different density estimation strategies, we randomly divided each dataset into three parts: 50% for training (i.e., creation of the density estimate), 25% for tuning (setting parameters such as bandwidth <italic>h </italic>or number of neighbors <italic>k</italic>), and 25% for testing. We first focus on the results for Rad21, which are largely representative of the other datasets, before presenting a comparison across all ten datasets.</p>
      <p>Figure <xref ref-type="fig" rid="F3">3A</xref> shows the results of several fixed-bandwidth density estimators on the Rad21 dataset: the standard fixed-bandwidth Gaussian kernel estimate (<italic>ε </italic>= 0), and that same estimate blended with a 10%, 1%, and 0.1% uniform density (<italic>ε </italic>= 0.1, 0.01, and 0.001, respectively). The vertical axis shows the mean log probability of the tuning data under the density estimate obtained using the training data. The horizontal axis shows the effect of varying the bandwidth. [The mean log probability of the tuning data is equivalent to the logarithm of the geometric mean of the tuning data point probabilities. We use the logarithm here for greater visibility of the plots. We employ the mean across tuning points so that different datasets with different total numbers of points can be compared directly.]</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Held-out tuning data analysis</bold>. Assessment of (A) fixed and (B) adaptive bandwidth schemes on held-out tuning data from the Rad21 dataset across a range of the bandwidth parameter <italic>h </italic>and the <italic>k<sub>th</sub></italic>-nearest neighbor parameter <italic>k</italic>. (C) Comparison of five different approaches on held-out test data from 10 ENCODE datasets: (i) fixed-bandwidth Gaussian with <italic>h </italic>= 16, (ii) fixed-bandwidth Gaussian with <italic>h </italic>optimized on the tuning set, (iii, iv, v) adaptive-bandwidth Gaussian, triangle, and square kernel functions with <italic>k </italic>optimized on the tuning set.</p>
        </caption>
        <graphic xlink:href="1753-6561-7-S7-S7-3"/>
      </fig>
      <p>For the <italic>ε </italic>= 0 case, it is only at the largest tested value of the bandwidth parameter, <italic>h </italic>= 2<sup>15 </sup>= 32768, that the tuning data has a nonzero probability. For smaller bandwidths, some tuning data points are left uncovered by any kernel in the training density. Such points get assigned a zero probability individually and, therefore, the entire tuning set is assigned a zero probability. For a typical, point-binding transcription factor, the peaks in the density may be a few hundred base pairs wide, and therefore smoothing with a kernel bandwidth in the tens of thousands is not ideal. In such situations, then, the vast regions of low signal levels demand a bandwidth inappropriate to the more interesting parts of the signal, and therefore choosing a single bandwidth becomes difficult.</p>
      <p>For the <italic>ε &gt;</italic>0 cases, the uniform density component solves the "zero problem" of tuning points being left uncovered (similar to our previous use of a uniform mixture component in analyzing multi-modal flow cytometry data [<xref ref-type="bibr" rid="B37">37</xref>]). The tuning data thus has nonzero probability for all choices of bandwidth, and by varying the bandwidth we can choose an appropriate one, as shown in Figure <xref ref-type="fig" rid="F3">3A</xref>. For this dataset, an appropriate bandwidth appears to be in the range of 500 to 1000 base pairs. We note that the best choice of bandwidth has some dependence on the <italic>ε </italic>parameter. Moreover, different choices of <italic>ε </italic>lead to mildly differing probabilities of the tuning data if bandwidth is optimized. For all choices of <italic>ε</italic>, however, we clearly see that too small a bandwidth leads to undersmoothing of the data, as seen by very poor probability of the tuning data. When bandwidth is too large, oversmoothing results, and the probability of the tuning data also suffers, although this loss is not as severe as that with undersmoothing. For other datasets, we often found that the tuning curves were even flatter for high bandwidths than the Rad21 tuning curve, rendering these datasets relatively resistant to oversmoothing. For the remainder of our analyses, we focus on the <italic>ε </italic>= 0.1 choice. Although the tuning data were slightly less probable with this choice than with smaller values of <italic>ε</italic>, this choice favored smaller bandwidths <italic>h</italic>, which is preferable for emphasizing regions of true signal density.</p>
      <p>Figure <xref ref-type="fig" rid="F3">3B</xref> shows the results of adaptive-bandwidth density estimators with Gaussian, triangle, and square kernel functions for varying values of the nearest-neighbor parameter <italic>k</italic>. These results are again for the Rad21 dataset, and show the mean log probability of the tuning data under the density estimate obtained from the training data. We have used the KNN2 rule for assigning bandwidths. For this dataset, we find that an optimal value of <italic>k </italic>= 7 can be chosen based on the tuningset probability. Values smaller than this optimal value result in undersmoothing, and larger values result in oversmoothing. However, in absolute terms, the tuning-set probability actually changes very little as a function of <italic>k</italic>. The probability using the best value of <italic>k </italic>(7) is only about 10% higher than under the worst value of <italic>k </italic>tested. By way of comparison, better or worse values of the bandwidth parameter <italic>h </italic>for the fixed-bandwidth estimators in Figure <xref ref-type="fig" rid="F3">3A</xref> resulted in orders-of-magnitude differences in the tuning-set probability. We also observe that the probability of the tuning data obtained under the adaptive-bandwidth scheme is higher than that obtained under the fixed-bandwidth scheme. Intuitively, the adaptive-bandwith scheme allows, by design, coverage of sparse data regions without sacrificing accuracy in high-density regions. The Gaussian and triangle kernels performed very similarly, with the Gaussian being slightly better at all values of <italic>k</italic>. The square kernel fared slightly worse, although the difference is small compared to even the small loss that may result from a poor choice of <italic>k</italic>, let alone the difference observed for fixed-bandwidth density estimators.</p>
      <p>Figure <xref ref-type="fig" rid="F3">3C</xref> compares the results of fixed and adaptive-bandwidth approaches on the full suite of the 10 datasets. We compare fixed-bandwidth Gaussian kernel estimation with <italic>ε </italic>= 0.1 and <italic>h </italic>= 16 (close to the <italic>h </italic>= <italic>σ </italic>= 15 choice that is the default in the QuEST software [<xref ref-type="bibr" rid="B23">23</xref>]), fixed-bandwidth Gaussian kernel estimation with <italic>ε </italic>= 0.1 and bandwidth <italic>h </italic>optimized on the tuning set, and adaptive-bandwidth estimation with Gaussian, triangle, and square kernel functions with KNN2 bandwidth selection and optimal <italic>k </italic>(chosen to maximize tuning-set probability). We report geometric mean probability of the test data points in the bar charts, while Table shows the optimized bandwidths <italic>h </italic>or nearest neighbor parameters <italic>k</italic>, depending on the method. The results are remarkably consistent across the 10 datasets. Adaptive-bandwidth estimation with Gaussian kernels is uniformly the best performer, followed closely by the triangle and the square kernels. Thus, by the measure of mean log probability of test data, the Gaussian kernel is consistently best at smoothing (or denoising) the data. Among the two fixed-bandwidth cases, the approach of optimizing bandwidth on a tuning set always leads to improved test-set performance, emphasizing the importance of using a tuning set to optimize algorithm parameters. For many datasets, the fixed (but optimized) bandwidth Gaussian estimator is only about 10% worse than the adaptive-bandwidth schemes, although for some datasets its performance drops to about two-thirds or even one-half of that of the adaptive-bandwidth schemes. The unoptimized fixed-bandwidth scheme is uniformly the worst, with a test-set probability on average about one-tenth of that of the other schemes.</p>
    </sec>
    <sec>
      <title>Kernel function choice influences time and space complexity</title>
      <p>Although our analysis shows that the choice of the kernel function--Gaussian, square, or triangle--has little influence on tuning or test-set probabilities, the choice does impact the computational resources needed to compute the densities. The final columns of each half of Table show the CPU times, measured in seconds on a SunFire x2250 cluster computing node, for evaluating the full density estimate across chromosome 1 for the three different kernel functions. The Gaussian estimate is always the most expensive to compute, and there are two main reasons for this. First, it has the widest support of all the kernels (10 standard deviations in diameter), and it involves evaluation of the exponential function, which is a relatively time-consuming operation. The triangle estimate, with a smaller support and a simple function to evaluate, was typically about 2.5 times faster to compute. The square estimate, with the narrowest support and a constant height (though dependent on bandwidth), was roughly 10 times as fast to evaluate as the Gaussian estimate.</p>
      <p>In slightly more formal terms, if we have <italic>D </italic>training data points, <italic>S </italic>base pairs of average kernel support, and a genome of size <italic>G </italic>base pairs, then we expect <italic>O</italic>(<italic>DS </italic>+ <italic>G</italic>) computations to evaluate a kernel density estimate. The <italic>G </italic>term is for initializing the density to zero everywhere, and the <italic>DS </italic>term is for evaluating each kernel over the base pairs to which it contributes probability mass. Empirically, the linear influences of <italic>D </italic>and <italic>S </italic>are well born out when we plot, for instance, CPU time versus dataset size or mean bandwidth size. Different kernel functions affect mainly the slope of the relationship of CPU time to <italic>D </italic>or <italic>S</italic>--i.e., they determine the constant inside the big O.</p>
      <p>This analysis, however, assumes explicit representation of the density value at every base pair. The square kernel density estimate is piecewise constant, comprising <italic>O</italic>(<italic>D</italic>) pieces--each data point contributes one rise and one fall to the function <inline-formula><mml:math id="M10" name="1753-6561-7-S7-S7-i9" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:math></inline-formula>. Thus, the density can be represented in terms of the start, end, and height of each piece, and can be computed in <italic>O</italic>(<italic>D</italic>) time and requires only <italic>O</italic>(<italic>D</italic>) space (as opposed to <italic>O</italic>(<italic>G</italic>) space for a general density over the whole genome). Moreover, such a piecewise constant density is readily represented as a BED file, making it convenient for browser viewing. For the triangle kernel function, the density estimate is piecewise linear with <italic>O</italic>(<italic>D</italic>) pieces; this too can be handled in <italic>O</italic>(<italic>D</italic>) time and space, although we know of no browser file format allowing piecewise linear functions. Given that the triangle kernel has similar computational requirements to the square kernel, and yet an accuracy comparable to the Gaussian kernel, defining a browser file format that allows for piecewise linear functions could be advantageous. Thus, although accuracy points to the Gaussian kernel as the best choice for density estimation, square and triangle kernels have points in their favor regarding computation and browsing convenience.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusions and future work</title>
    <p>We have investigated adaptive-bandwidth kernel density estimators for the reconstruction and visualization of genomic signals underlying ChIP-Seq data, with several results. First, we found that adaptive-bandwidth schemes generally outperform fixed-bandwidth schemes in terms of accuracy. In our opinion, adaptive-bandwidth schemes also hold visualization advantages, although we admit this is somewhat subjective. With optimized smoothing parameters, fixed-bandwidth estimators held a slight advantage in terms of computation time, although all estimates can be computed quickly enough that computation time does not seem to be a major concern. Among different kernel functions, we found that all yielded comparable accuracy with some having potential advantages in terms of compact representation and genome browser compatibility. It remains to be investigated whether the increased accuracy of adaptive-bandwidth estimates will translate into improved abilities of extracting biological information--for instance, in terms of transcription factor binding sites or peaks, assessment of regions of enrichment for histone marks or, more generally, comparison of different ChIP-Seq signals. Relatedly, our methods may be useful in more accurately decomposing genomic signals into constituent parts, or correcting for different sources of bias. One way to do this would be to create adaptive-bandwidth KDE smooths of different possible sources of bias (e.g., local GC content, mappability, etc.), and then use regression, deconvolution, or principal components style anlayses to isolate the true signal of interest. Alternatively, one might generalize the adaptive-bandwidth KDE approach to that of conditional density estimation to account for possible biases at the time of signal reconstruction. We leave these questions as topics for future study.</p>
    <p>Software implementing adaptive-bandwidth density estimation for ChIP-Seq data is available at <ext-link ext-link-type="uri" xlink:href="http://www.perkinslab.ca/Software.html">http://www.perkinslab.ca/Software.html</ext-link>.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>PR and TJP conceived the ideas, designed the experiments, and wrote and approved the paper.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>This work has been supported in part by grants from the Natural Sciences and Engineering Research Council of Canada (NSERC), the Government of Ontario Ministry of Economic Development and Innovation (MEDI), and the Ottawa Hospital Research Institute (OHRI).</p>
    <p>This article has been published as part of <italic>BMC Proceedings </italic>Volume 7 Supplement 7, 2013: Proceedings of the Great Lakes Bioinformatics Conference 2013. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/bmcproc/supplements/7/S7">http://www.biomedcentral.com/bmcproc/supplements/7/S7</ext-link>.</p>
  </sec>
  <sec>
    <title>Declarations</title>
    <p>Funding for the publication of this article was provided by the '<italic>Author Fund in Support of Open Access Publishing </italic>' established by the University of Ottawa.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mardis</surname>
          <given-names>ER</given-names>
        </name>
        <article-title>A decade's perspective on DNA sequencing technology</article-title>
        <source>Nature</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>198</fpage>
        <lpage>203</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09796</pub-id>
        <?supplied-pmid 21307932?>
        <pub-id pub-id-type="pmid">21307932</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Park</surname>
          <given-names>PJ</given-names>
        </name>
        <article-title>ChIP-Seq: Advantages and challenges of a maturing technology</article-title>
        <source>Nat Rev Genet</source>
        <year>2009</year>
        <volume>7</volume>
        <fpage>669</fpage>
        <lpage>680</lpage>
        <?supplied-pmid 19736561?>
        <pub-id pub-id-type="pmid">19736561</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pepke</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Wold</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Mortazavi</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Computation for ChIP-Seq and RNA-Seq studies</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>7</volume>
        <fpage>S22</fpage>
        <lpage>S32</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1371</pub-id>
        <?supplied-pmid 19844228?>
        <pub-id pub-id-type="pmid">19844228</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Benjamini</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Speed</surname>
          <given-names>TP</given-names>
        </name>
        <article-title>Summarizing and correcting the GC content bias in high-throughput sequencing</article-title>
        <source>Nucleic Acids Research</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>10</issue>
        <fpage>e72</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks001</pub-id>
        <?supplied-pmid 22323520?>
        <pub-id pub-id-type="pmid">22323520</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ramachandran</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Palidwor</surname>
          <given-names>GA</given-names>
        </name>
        <name>
          <surname>Porter</surname>
          <given-names>CJ</given-names>
        </name>
        <name>
          <surname>Perkins</surname>
          <given-names>TJ</given-names>
        </name>
        <article-title>MaSC: Mappability-sensitive cross-correlation for estimating mean fragment length of single-end short-read sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>7</volume>
        <issue>4</issue>
        <fpage>444</fpage>
        <lpage>450</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt001</pub-id>
        <?supplied-pmid 23300135?>
        <pub-id pub-id-type="pmid">23300135</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wilbanks</surname>
          <given-names>EG</given-names>
        </name>
        <name>
          <surname>Facciotti</surname>
          <given-names>MT</given-names>
        </name>
        <article-title>Evaluation of algorithm performance in ChIP-Seq peak detection</article-title>
        <source>PLoS ONE</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>7</issue>
        <fpage>e11471</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0011471</pub-id>
        <?supplied-pmid 20628599?>
        <pub-id pub-id-type="pmid">20628599</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Micsinai</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Parisi</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Strino</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Asp</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Dynlacht</surname>
          <given-names>BD</given-names>
        </name>
        <name>
          <surname>Kluger</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>Picking ChIP-Seq peak detectors for analyzing chromatin modification experiments</article-title>
        <source>Nucleic Acids Research</source>
        <year>2012</year>
        <volume>7</volume>
        <issue>9</issue>
        <fpage>e70</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks048</pub-id>
        <?supplied-pmid 22307239?>
        <pub-id pub-id-type="pmid">22307239</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Meyer</surname>
          <given-names>CA</given-names>
        </name>
        <name>
          <surname>Eeckhoute</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>DS</given-names>
        </name>
        <name>
          <surname>Bernstein</surname>
          <given-names>BE</given-names>
        </name>
        <name>
          <surname>Nusbaum</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Brown</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>XS</given-names>
        </name>
        <article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>7</volume>
        <issue>9</issue>
        <fpage>R137</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-9-r137</pub-id>
        <?supplied-pmid 18798982?>
        <pub-id pub-id-type="pmid">18798982</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Narlikar</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Jothi</surname>
          <given-names>R</given-names>
        </name>
        <etal/>
        <article-title>ChIP-Seq data analysis: Identification of protein-DNA binding sites with SISSRs peak-finder</article-title>
        <source>Methods Mol Biol</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>305</fpage>
        <lpage>322</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-61779-400-1_20</pub-id>
        <?supplied-pmid 22130889?>
        <pub-id pub-id-type="pmid">22130889</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zang</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Schones</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Zeng</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Cui</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Peng</surname>
          <given-names>W</given-names>
        </name>
        <article-title>A clustering approach for identification of enriched domains from histone modification ChIP-Seq data</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>7</volume>
        <issue>15</issue>
        <fpage>1952</fpage>
        <lpage>1958</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp340</pub-id>
        <?supplied-pmid 19505939?>
        <pub-id pub-id-type="pmid">19505939</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Anders</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Huber</surname>
          <given-names>W</given-names>
        </name>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>10</issue>
        <fpage>R106</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id>
        <?supplied-pmid 20979621?>
        <pub-id pub-id-type="pmid">20979621</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Robinson</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>McCarthy</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Smyth</surname>
          <given-names>G</given-names>
        </name>
        <article-title>edgeR: A Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <?supplied-pmid 19910308?>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Robinson</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Oshlack</surname>
          <given-names>A</given-names>
        </name>
        <etal/>
        <article-title>A scaling normalization method for differential expression analysis of RNA-Seq data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>3</issue>
        <fpage>R25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-3-r25</pub-id>
        <?supplied-pmid 20196867?>
        <pub-id pub-id-type="pmid">20196867</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Trapnell</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Hendrickson</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Sauvageau</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Goff</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Rinn</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Pachter</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Differential analysis of gene regulation at transcript resolution with RNA-Seq</article-title>
        <source>Nat Biotechnol</source>
        <year>2013</year>
        <volume>7</volume>
        <fpage>46</fpage>
        <lpage>53</lpage>
        <?supplied-pmid 23222703?>
        <pub-id pub-id-type="pmid">23222703</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Boyle</surname>
          <given-names>AP</given-names>
        </name>
        <name>
          <surname>Guinney</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Crawford</surname>
          <given-names>GE</given-names>
        </name>
        <name>
          <surname>Furey</surname>
          <given-names>TS</given-names>
        </name>
        <article-title>F-seq: A feature density estimator for high-throughput sequence tags</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>7</volume>
        <issue>21</issue>
        <fpage>2537</fpage>
        <lpage>2538</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn480</pub-id>
        <?supplied-pmid 18784119?>
        <pub-id pub-id-type="pmid">18784119</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rozowsky</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Euskirchen</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Auerbach</surname>
          <given-names>RK</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>ZD</given-names>
        </name>
        <name>
          <surname>Gibson</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Bjornson</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Carriero</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Gerstein</surname>
          <given-names>MB</given-names>
        </name>
        <article-title>Peakseq enables systematic scoring of ChIP-Seq experiments relative to controls</article-title>
        <source>Nat Biotechnol</source>
        <year>2009</year>
        <volume>7</volume>
        <fpage>66</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1518</pub-id>
        <?supplied-pmid 19122651?>
        <pub-id pub-id-type="pmid">19122651</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tuteja</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>White</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Schug</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kaestner</surname>
          <given-names>KH</given-names>
        </name>
        <article-title>Extracting transcription factor targets from ChIP-Seq data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2009</year>
        <volume>7</volume>
        <issue>17</issue>
        <fpage>e113</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkp536</pub-id>
        <?supplied-pmid 19553195?>
        <pub-id pub-id-type="pmid">19553195</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kharchenko</surname>
          <given-names>PV</given-names>
        </name>
        <name>
          <surname>Tolstorukov</surname>
          <given-names>MY</given-names>
        </name>
        <name>
          <surname>Park</surname>
          <given-names>PJ</given-names>
        </name>
        <article-title>Design and analysis of ChIP-Seq experiments for DNA-binding proteins</article-title>
        <source>Nat Biotechnol</source>
        <year>2008</year>
        <volume>7</volume>
        <fpage>1351</fpage>
        <lpage>1359</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1508</pub-id>
        <?supplied-pmid 19029915?>
        <pub-id pub-id-type="pmid">19029915</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ji</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Jiang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Ma</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>DS</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Wong</surname>
          <given-names>WH</given-names>
        </name>
        <article-title>An integrated software system for analyzing ChIP-ChIP and ChIP-Seq data</article-title>
        <source>Nat Biotechnol</source>
        <year>2008</year>
        <volume>7</volume>
        <issue>11</issue>
        <fpage>1293</fpage>
        <lpage>1300</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1505</pub-id>
        <?supplied-pmid 18978777?>
        <pub-id pub-id-type="pmid">18978777</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Jothi</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Cuddapah</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Barski</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Cui</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Genome-wide identification of in vivo protein-DNA binding sites from ChIP-Seq data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2008</year>
        <volume>7</volume>
        <fpage>5221</fpage>
        <lpage>5231</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn488</pub-id>
        <?supplied-pmid 18684996?>
        <pub-id pub-id-type="pmid">18684996</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rosenblatt</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Remarks on some nonparametric estimates of a density function</article-title>
        <source>Ann Math Statist</source>
        <year>1956</year>
        <volume>7</volume>
        <issue>3</issue>
        <fpage>832</fpage>
        <lpage>837</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177728190</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Parzen</surname>
          <given-names>E</given-names>
        </name>
        <article-title>On estimation of a probability density function and mode</article-title>
        <source>Ann Math Statist</source>
        <year>1962</year>
        <volume>7</volume>
        <issue>3</issue>
        <fpage>1065</fpage>
        <lpage>1076</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177704472</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Valouev</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>DS</given-names>
        </name>
        <name>
          <surname>Sundquist</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Medina</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Anton</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Batzoglou</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Sidow</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Genome-wide analysis of transcription factor binding sites based on chip-seq data</article-title>
        <source>Nat Methods</source>
        <year>2008</year>
        <volume>7</volume>
        <issue>9</issue>
        <fpage>829</fpage>
        <lpage>834</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1246</pub-id>
        <?supplied-pmid 19160518?>
        <pub-id pub-id-type="pmid">19160518</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rudemo</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Empirical choice of histograms and kernel density estimators</article-title>
        <source>Scandinavian Journal of Statistics</source>
        <year>1982</year>
        <volume>7</volume>
        <issue>2</issue>
        <fpage>65</fpage>
        <lpage>78</lpage>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sheather</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>Jones</surname>
          <given-names>MC</given-names>
        </name>
        <article-title>A reliable data-based bandwidth selection method for kernel density estimation</article-title>
        <source>Journal of the Royal Statistical Society, Series B</source>
        <year>1991</year>
        <volume>7</volume>
        <issue>3</issue>
        <fpage>683</fpage>
        <lpage>690</lpage>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hall</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Marron</surname>
          <given-names>JS</given-names>
        </name>
        <name>
          <surname>Park</surname>
          <given-names>BU</given-names>
        </name>
        <article-title>Smoothed crossvalidation</article-title>
        <source>Probability Theory and Related Fields</source>
        <year>1992</year>
        <volume>7</volume>
        <fpage>1</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01205233</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cao</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Cuevas</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Manteiga</surname>
          <given-names>WG</given-names>
        </name>
        <article-title>A comparative study of several smoothing methods in density estimation</article-title>
        <source>Computational Statistics &amp; Data Analysis</source>
        <year>1994</year>
        <volume>7</volume>
        <issue>2</issue>
        <fpage>153</fpage>
        <lpage>176</lpage>
        <pub-id pub-id-type="doi">10.1016/0167-9473(92)00066-Z</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Jones</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Marron</surname>
          <given-names>JS</given-names>
        </name>
        <name>
          <surname>Sheather</surname>
          <given-names>SJ</given-names>
        </name>
        <article-title>A brief survey of bandwidth selection for density estimation</article-title>
        <source>Journal of the American Statistical Association</source>
        <year>1996</year>
        <volume>7</volume>
        <issue>433</issue>
        <fpage>401</fpage>
        <lpage>407</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1996.10476701</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Loftsgaarden</surname>
          <given-names>DO</given-names>
        </name>
        <name>
          <surname>Quesenberry</surname>
          <given-names>CP</given-names>
        </name>
        <article-title>A nonparametric estimate of a multivariate density function</article-title>
        <source>Ann Math Statist</source>
        <year>1965</year>
        <volume>7</volume>
        <issue>3</issue>
        <fpage>1049</fpage>
        <lpage>1051</lpage>
        <pub-id pub-id-type="doi">10.1214/aoms/1177700079</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="book">
        <name>
          <surname>Silverman</surname>
          <given-names>BW</given-names>
        </name>
        <source>Density estimation for statistics and data analysis. Monographs on Statistics and Applied Probability</source>
        <year>1986</year>
        <publisher-name>Chapman and Hall</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Terrell</surname>
          <given-names>GR</given-names>
        </name>
        <name>
          <surname>Scott</surname>
          <given-names>DW</given-names>
        </name>
        <article-title>Variable kernel density estimation</article-title>
        <source>Ann Statist</source>
        <year>1992</year>
        <volume>7</volume>
        <issue>3</issue>
        <fpage>1236</fpage>
        <lpage>1265</lpage>
        <pub-id pub-id-type="doi">10.1214/aos/1176348768</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Breiman</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Meisel</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Purcell</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Variable kernel estimates of multivariate densities</article-title>
        <source>Technometrics</source>
        <year>1977</year>
        <volume>7</volume>
        <issue>2</issue>
        <fpage>135</fpage>
        <lpage>144</lpage>
        <pub-id pub-id-type="doi">10.1080/00401706.1977.10489521</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Jones</surname>
          <given-names>MC</given-names>
        </name>
        <article-title>Variable kernel density estimates and variable kernel density estimates</article-title>
        <source>Australian Journal of Statistics</source>
        <year>1990</year>
        <volume>7</volume>
        <issue>3</issue>
        <fpage>361</fpage>
        <lpage>371</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-842X.1990.tb01031.x</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sain</surname>
          <given-names>SR</given-names>
        </name>
        <name>
          <surname>Scott</surname>
          <given-names>DW</given-names>
        </name>
        <article-title>On locally adaptive density estimation</article-title>
        <source>Journal of the American Statistical Association</source>
        <year>1996</year>
        <volume>7</volume>
        <issue>436</issue>
        <fpage>1525</fpage>
        <lpage>1534</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1996.10476720</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Botev</surname>
          <given-names>ZI</given-names>
        </name>
        <name>
          <surname>Grotowski</surname>
          <given-names>JF</given-names>
        </name>
        <name>
          <surname>Kroese</surname>
          <given-names>DP</given-names>
        </name>
        <article-title>Kernel density estimation via diffusion</article-title>
        <source>Ann Statist</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>5</issue>
        <fpage>2916</fpage>
        <lpage>2957</lpage>
        <pub-id pub-id-type="doi">10.1214/10-AOS799</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="book">
        <name>
          <surname>Shapiro</surname>
          <given-names>LG</given-names>
        </name>
        <name>
          <surname>Stockman</surname>
          <given-names>GC</given-names>
        </name>
        <source>Computer vision</source>
        <year>2001</year>
        <publisher-name>Prentice Hall</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Song</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Phenix</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Abedi</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Scott</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Ingalls</surname>
          <given-names>BP</given-names>
        </name>
        <name>
          <surname>Kærn</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Perkins</surname>
          <given-names>TJ</given-names>
        </name>
        <article-title>Estimating the stochastic bifurcation structure of cellular networks</article-title>
        <source>PLoS computational biology</source>
        <year>2010</year>
        <volume>7</volume>
        <issue>3</issue>
        <fpage>e1000699</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000699</pub-id>
        <?supplied-pmid 20221261?>
        <pub-id pub-id-type="pmid">20221261</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
