<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Neuroinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Neuroinform</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Neuroinform.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Neuroinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1662-5196</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3931231</article-id>
    <article-id pub-id-type="doi">10.3389/fninf.2014.00008</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Neuroscience</subject>
        <subj-group>
          <subject>Methods Article</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Dipy, a library for the analysis of diffusion MRI data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Garyfallidis</surname>
          <given-names>Eleftherios</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="author-notes" rid="fn001">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brett</surname>
          <given-names>Matthew</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Amirbekian</surname>
          <given-names>Bagrat</given-names>
        </name>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rokem</surname>
          <given-names>Ariel</given-names>
        </name>
        <xref ref-type="aff" rid="aff5">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>van der Walt</surname>
          <given-names>Stefan</given-names>
        </name>
        <xref ref-type="aff" rid="aff6">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Descoteaux</surname>
          <given-names>Maxime</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nimmo-Smith</surname>
          <given-names>Ian</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <collab>Dipy Contributors</collab>
        <xref ref-type="aff" rid="aff7">
          <sup>7</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <sup>1</sup>
      <institution>Computer Science Department, University of Sherbrooke</institution>
      <country>Sherbrooke, QC, Canada</country>
    </aff>
    <aff id="aff2">
      <sup>2</sup>
      <institution>MRC Cognition and Brain Sciences Unit, University of Cambridge</institution>
      <country>Cambridge, UK</country>
    </aff>
    <aff id="aff3">
      <sup>3</sup>
      <institution>Henry H. Wheeler, Jr. Brain Imaging Center, University of California</institution>
      <country>Berkeley, CA, USA</country>
    </aff>
    <aff id="aff4">
      <sup>4</sup>
      <institution>Department of Neurology and Graduate Group in Bioengineering, University of California</institution>
      <country>San Francisco, CA, USA</country>
    </aff>
    <aff id="aff5">
      <sup>5</sup>
      <institution>Department of Psychology, Stanford University</institution>
      <country>Stanford, CA, USA</country>
    </aff>
    <aff id="aff6">
      <sup>6</sup>
      <institution>Department of Mathematical Sciences, Division of Applied Mathematics, Stellenbosch University</institution>
      <country>Stellenbosch, South Africa</country>
    </aff>
    <aff id="aff7">
      <sup>7</sup>
      <ext-link ext-link-type="uri" xlink:href="http://dipy.org/developers.html">http://dipy.org/developers.html</ext-link>
    </aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Fernando Perez, University of California at Berkeley, USA</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Krzysztof Gorgolewski, Max Planck Institute for Human Cognitive and Brain Sciences, Germany; Lester Melie-Garcia, Cuban Neuroscience Center, Cuba</p>
      </fn>
      <corresp id="fn001">*Correspondence: Eleftherios Garyfallidis, Computer Science Department, University of Sherbrooke, 2500 University Boulevard, Sherbrooke, QC J1K 2R1, Canada e-mail: <email xlink:type="simple">garyfallidis@gmail.com</email></corresp>
      <fn fn-type="other" id="fn002">
        <p>This article was submitted to the journal Frontiers in Neuroinformatics.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>2</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <volume>8</volume>
    <elocation-id>8</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>10</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>1</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2014 Garyfallidis, Brett, Amirbekian, Rokem, van der Walt, Descoteaux, Nimmo-Smith and Dipy Contributors.</copyright-statement>
      <copyright-year>2014</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/3.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) or licensor are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Diffusion Imaging in Python (Dipy) is a free and open source software project for the analysis of data from diffusion magnetic resonance imaging (dMRI) experiments. dMRI is an application of MRI that can be used to measure structural features of brain white matter. Many methods have been developed to use dMRI data to model the local configuration of white matter nerve fiber bundles and infer the trajectory of bundles connecting different parts of the brain. Dipy gathers implementations of many different methods in dMRI, including: diffusion signal pre-processing; reconstruction of diffusion distributions in individual voxels; fiber tractography and fiber track post-processing, analysis and visualization. Dipy aims to provide transparent implementations for all the different steps of dMRI analysis with a uniform programming interface. We have implemented classical signal reconstruction techniques, such as the diffusion tensor model and deterministic fiber tractography. In addition, cutting edge novel reconstruction techniques are implemented, such as constrained spherical deconvolution and diffusion spectrum imaging (DSI) with deconvolution, as well as methods for probabilistic tracking and original methods for tractography clustering. Many additional utility functions are provided to calculate various statistics, informative visualizations, as well as file-handling routines to assist in the development and use of novel techniques. In contrast to many other scientific software projects, Dipy is not being developed by a single research group. Rather, it is an open project that encourages contributions from any scientist/developer through GitHub and open discussions on the project mailing list. Consequently, Dipy today has an international team of contributors, spanning seven different academic institutions in five countries and three continents, which is still growing.</p>
    </abstract>
    <kwd-group>
      <kwd>diffusion MRI</kwd>
      <kwd>DTI</kwd>
      <kwd>DSI</kwd>
      <kwd>HARDI</kwd>
      <kwd>dMRI</kwd>
      <kwd>Python</kwd>
      <kwd>free open source software</kwd>
      <kwd>tractography</kwd>
    </kwd-group>
    <counts>
      <fig-count count="38"/>
      <table-count count="1"/>
      <equation-count count="7"/>
      <ref-count count="98"/>
      <page-count count="17"/>
      <word-count count="13355"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>1. Introduction</title>
    <p><italic>Diffusion MRI</italic> (dMRI) (LeBihan and Breton, <xref rid="B55" ref-type="bibr">1985</xref>; Merboldt et al., <xref rid="B62" ref-type="bibr">1985</xref>; Taylor and Bushell, <xref rid="B80" ref-type="bibr">1985</xref>) is an MRI technique (Callaghan, <xref rid="B16" ref-type="bibr">1991</xref>) that provides information about the structure of neuronal pathways found in the white matter and other body tissue with fiber-like structure (see Figure <xref ref-type="fig" rid="F1">1</xref>). dMRI acquires one or more <italic>T</italic><sub>2</sub> reference images, and a collection of diffusion-weighted images, in which <italic>T</italic><sub>2</sub> signal is attenuated according to the diffusivity of water along prescribed gradient directions (Behrens and Johansen-Berg, <xref rid="B11" ref-type="bibr">2009</xref>; Jones, <xref rid="B51" ref-type="bibr">2010</xref>). Because diffusion is hindered across nerve fiber membranes and less hindered along the length of nerve fibers, the signal is relatively more attenuated when diffusion-weighting is applied along the length of the fiber. Hence, the local structure of the neural tissue can be inferred from the measurements. This has led to many applications of the method, including diagnostic tools to assess the disruption of the microstructure and methods of tractography, which estimate the trajectories of nerve fibers that communicate information between different parts of the brain.</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>The fornix is a C-shaped bundle connecting the hippocampus with the hypothalamus.</bold> The body of the fornix divides into two legs knows as the crus of the fornix. We can see here a detailed recreation of the fornix using dMRI data processed with Dipy.</p>
      </caption>
      <graphic xlink:href="fninf-08-00008-g0001"/>
    </fig>
    <p>Because of its unique capability to characterize the microstructure of neural tissue, and the inferences that can be made using this information about structural connectivity, dMRI has had increasing popularity, with more than 5000 papers published in 2012 (according to PubMed). This popularity is also evident from the large number of software tools available for the analysis of diffusion-weighted images. Many of these tools are written in C/C++: 3D Slicer (Pieper et al., <xref rid="B72" ref-type="bibr">2006</xref>), AFNI (Cox, <xref rid="B27" ref-type="bibr">2012</xref>), MITK (Fritzsche et al., <xref rid="B40" ref-type="bibr">2012</xref>), BrainVoyager QX (Goebel, <xref rid="B45" ref-type="bibr">2012</xref>), DTI-Query/Quench (Sherbondy et al., <xref rid="B76" ref-type="bibr">2005</xref>), FreeSurfer (Fischl, <xref rid="B36" ref-type="bibr">2012</xref>), FSL-FDT (Smith et al., <xref rid="B77" ref-type="bibr">2004</xref>), MedInria (Toussaint et al., <xref rid="B85" ref-type="bibr">2007</xref>), MRtrix (Tournier et al., <xref rid="B83" ref-type="bibr">2012</xref>), Diffusion Toolkit/Trackvis (Wang et al., <xref rid="B94" ref-type="bibr">2007</xref>), FiberNavigator (Vaillancourt et al., <xref rid="B90" ref-type="bibr">2011</xref>; Chamberland and Descoteaux, <xref rid="B19" ref-type="bibr">2013</xref>). A few are written in other languages, such as R: TractoR (Clayden et al., <xref rid="B23" ref-type="bibr">2011</xref>), Java: Camino (Cook et al., <xref rid="B25" ref-type="bibr">2006</xref>) and Matlab: ExploreDTI (Leemans et al., <xref rid="B56" ref-type="bibr">2009</xref>), AFQ (Yeatman et al., <xref rid="B97" ref-type="bibr">2012</xref>) and others.</p>
    <p>Dipy (<italic>Diffusion Imaging in Python</italic>) (Garyfallidis et al., <xref rid="B42" ref-type="bibr">2011</xref>) is the first collective effort to create an open-source diffusion MRI analysis library using the Python language. Python is a general purpose, object-oriented programming language which was designed with an emphasis on code readability. This emphasis allows scientists who are not trained as software engineers to understand the computational steps taken during the analysis and to extend the software easily. Being an interpreted language, Python does not require additional compilation and linking, so scripts and libraries written only in Python are relatively easy to install and share. Python can be used interactively making it a good match for exploratory data analysis and methods development. Taken together, these properties of the language are powerful assets for the design of the next generation of medical imaging analysis tools.</p>
    <p>In the past, we have found that many researchers used the available tools without necessarily understanding the underlying details, often because these were hidden from the users. Dipy tackles this problem in part by being free, open source (BSD license), simple and well documented. The environment for Python packages in imaging is healthy. There has been large growth in the number of Python users, there are many Python tools for scientific computing (Pérez and Granger, <xref rid="B70" ref-type="bibr">2007</xref>; Pérez et al., <xref rid="B71" ref-type="bibr">2011</xref>; McKinney, <xref rid="B60" ref-type="bibr">2012</xref>), and there are complementary neuroimaging packages in Python<xref ref-type="fn" rid="fn0001"><sup>1</sup></xref>.</p>
    <p>Dipy takes full advantage of the growing ecosystem of tools written for scientific computing in Python, and is built on top of production-ready, high-performance Python libraries. Primarily, Dipy depends on Numpy<xref ref-type="fn" rid="fn0002"><sup>2</sup></xref>. The core structure of this library is an implementation of an N-dimensional array class (van der Walt et al., <xref rid="B91" ref-type="bibr">2011</xref>). Numpy arrays are used for representing numerical data in Python and enable efficient numerical computations through the use of vectorized operations, by avoiding data copying, and by minimizing the number of operations performed. Numpy is also used for matrix, tensor and linear algebra operations. Dipy further depends on Scipy<xref ref-type="fn" rid="fn0003"><sup>3</sup></xref> for non-linear optimization and other volumetric operations. We use Cython<xref ref-type="fn" rid="fn0004"><sup>4</sup></xref> in rare cases when both standard Python and Numpy/Scipy are not fast enough for the task at hand. Cython converts Python code into Python C extensions by interpreting static type declarations. The last required dependency for Dipy is Nibabel<xref ref-type="fn" rid="fn0005"><sup>5</sup></xref>. Nibabel is a package for loading and saving medical imaging file formats.</p>
    <p>Dipy uses other optional libraries for visualization, testing and documentation. We use Matplotlib<xref ref-type="fn" rid="fn0006"><sup>6</sup></xref> for 2D and 3D plotting and Python-VTK<xref ref-type="fn" rid="fn0007"><sup>7</sup></xref> for more advanced 3D interactive visualization. Dipy uses nose<xref ref-type="fn" rid="fn0008"><sup>8</sup></xref> for unit testing and Sphinx<xref ref-type="fn" rid="fn0009"><sup>9</sup></xref> for automated documentation. Finally, we recommend using IPython<xref ref-type="fn" rid="fn0010"><sup>10</sup></xref> as an interactive Python shell for calling and debugging scripts.</p>
    <p>In the following sections, we explain the philosophy and main design concepts behind Dipy. We also give examples which cover different parts of the diffusion MR analysis pipeline from the analysis of diffusion signal in individual voxels to streamline generation by tractography algorithms and visualization of these streamlines.</p>
  </sec>
  <sec>
    <title>2. Philosophy and mission</title>
    <p>The purpose of Dipy is to make it easier to do better diffusion MR imaging research. We aim to build software that is clearly written, well explained and thoroughly tested, while being a good fit for the underlying ideas and providing a natural meeting point for collaboration.</p>
    <p>We designed Dipy to be an international project that welcomes contributions from anywhere in the world. As for many other projects, we suffer from the tension between our desire to encourage new code and our need to keep Dipy well tested and well maintained, so that we and others can continue to use it and use it to build new things. To keep code quality high and help each other understand the new code, we use public code review. Each contribution, from any author, first gets proposed on the public website<xref ref-type="fn" rid="fn0011"><sup>11</sup></xref>. The code can be merged after everyone has had a chance to comment and ask questions. The same system allows the code to be tested automatically for test errors.</p>
    <p>We believe that this discipline makes the project more attractive for new developers, because it is clear how decisions are made, and that each developer can and must interact as a peer with his or her colleagues on the project.</p>
    <p>We are glad to see that Dipy has attracted an international and multi-departmental team of contributors from different levels of education (Master students, PhD students, Post-Docs, and Professors) spanning the fields of Computer Science, Medicine, Applied Mathematics, Biomedical Engineering and Psychology.</p>
  </sec>
  <sec>
    <title>3. Terminology</title>
    <p>As in most scientific fields, dMRI uses domain-specific terminology to describe the constructs of the measurement, as well as to present the interpretation of the results of the analysis. We rely on a recent paper (Côté et al., <xref rid="B26" ref-type="bibr">2013</xref>), that proposes specific terminology for describing different constructs of the dMRI field. In this section we describe terms for concepts in the measurement and the results of the analysis. In subsequent sections, we use this terminology to explain the analysis code and interpretation of data.</p>
    <p>The measurement in dMRI relies on the application of a pulsed magnetic gradient to make the measurement sensitive to diffusion. The degree of sensitization depends on a number of parameters, including the duration of the gradient, the time that elapses between pulses of the gradient, and the gradient amplitude. These parameters are together summarized in what is referred to as the <italic>b-value</italic>. As described above, the measurement is conducted with the magnetic field gradient applied in several different directions, and these are encoded in so-called <italic>b-vectors</italic>. These are unit vectors that describe the direction of the gradient relative to the scanner coordinate frame in which the gradients are applied. Different algorithms are used to determine the placement of these <italic>b</italic>-vectors (e.g., Jones et al., <xref rid="B52" ref-type="bibr">1999</xref>; Caruyer et al., <xref rid="B18" ref-type="bibr">2013</xref>).</p>
    <p>While we are ultimately interested in the identification of the trajectories of bundles of axons, which are the long fiber-like part of a nerve cell along which electrical impulses are conducted from cell to cell (and whose size is on the μm scale), the measurement is conducted on a much larger scale. Typically, the measurement is conducted on a grid of <italic>voxels</italic> of approximately 2 × 2 × 2 mm. The scale of measurement limits us to describing the trajectories of <italic>fascicles</italic> of nerves, which are relatively large (mm–cm scale) bundles of axons traveling through the white matter together. One of the major achievements of this field is that it is now possible to reliably and accurately identify major fascicles in individual experimental participants or patients (Mori et al., <xref rid="B64" ref-type="bibr">2005</xref>). These major fascicles are also known as <italic>tracts</italic>. This is a term taken from neuroanatomy and describes a group of neuronal axons within the central nervous system (mm scale).</p>
    <p>For the purpose of interpretation of these data, a <italic>fiber</italic> can be any long and thin structure. Hence, fiber tracking is a general term that can be used in any field that reconstructs fibrous structures, such as white matter axon fibers, muscle fibers, prostate fibers and even celery fibers (Numano et al., <xref rid="B66" ref-type="bibr">2006</xref>). <italic>Fiber bundles</italic> denote groups of fibers usually with an anatomical or functional meaning. These can be major tracts in the brain. Examples of major tracts are the arcuate fasciculus, which connects parts of the posterior temporal lobe with the frontal lobe; and the fornix (see Figure <xref ref-type="fig" rid="F1">1</xref>), which connects the medial temporal lobe with sub-cortical structures, such as the hypothalamus and amygdala. A fiber bundle in brain anatomy is synonymous to a tract, also often called fiber tract. The term tract can be misleading when talking for example about the corticospinal tract, because the corticospinal tract is in fact not a single tract but a group of tracts (including corticobulbar projections, the pyramidal tract, etc.).</p>
    <p><italic>Tractography</italic> is the computational process through which the fibers are detected and delineated. Tractography relies on the assumption that diffusion of water, as reflected in the dMRI measurement, occurs more freely along the axis of an axon, than across the membranes of the axon. Tractography is therefore usually done by finding the directions of diffusion in each voxel (see section 6) and stepping through the brain volume along the most likely directions of diffusion estimated in each location. This process generates so-called <italic>streamlines</italic>, which are imaginary lines that approximate the underlying fibers. Streamlines are also sometimes referred to as <italic>tracks</italic>. These are not to be confused with <italic>tracts</italic>: while a tract is a physical object, a track is a computational construct that only approximates the underlying fascicle or bundle of fibers. Confusingly enough <italic>streamline bundles</italic>, or simply <italic>bundles</italic> are often used to refer to a group of streamlines with similar shape and spatial characteristics (see section 8.1). These do not necessarily correspond to individual physical fiber bundles but are instead computational constructs that approximate the underlying anatomy.</p>
  </sec>
  <sec>
    <title>4. General design aspects</title>
    <p>Dipy is built on the Scipy tool stack, which includes packages such as Numpy (numerical arrays and array computation), Scipy (scientific libraries, e.g., optimization, triangulation, special functions, and more), and Cython (an optimized Python to C compiler, used to achieve C-level code performance). Furthermore, Dipy is one of the major components of the Nipy (Neuroimaging in Python) ecosystem of medical imaging software (see Figure <xref ref-type="fig" rid="F2">2</xref>). Dipy also interacts effortlessly with other Nipy projects. For example, Nipype (Gorgolewski et al., <xref rid="B46" ref-type="bibr">2011</xref>) has Dipy interfaces which allow building scalable dMRI workflows.</p>
    <fig id="F2" position="float">
      <label>Figure 2</label>
      <caption>
        <p><bold>Dipy is one of the main projects of the Nipy community and depends strongly on Numpy, Scipy, and Cython.</bold> This diagram further shows the major Dipy sub-modules.</p>
      </caption>
      <graphic xlink:href="fninf-08-00008-g0002"/>
    </fig>
    <p>Dipy's API is designed to be intuitive, simple to use, and well documented. This allows researchers to build fairly simple Python analysis scripts that can build complex computational experiments while still being easy to read. In addition, since the code is entirely free and open, Dipy is ideally suited to facilitate reproducible research (Donoho, <xref rid="B34" ref-type="bibr">2010</xref>).</p>
    <p>Like many modern open source projects, Dipy is hosted on GitHub—an online repository that hosts open-source software, using the Git source-code management system to perform revision control. Any contributor with a (free) GitHub account can propose changes via a Pull Request (PR). These PRs have an interface that allows all interested coders to discuss the code and iterate on it before being we make the final decision to include the code in dipy. The discussions also allow for line-by-line comments; these can be useful for sharing improvements in the code or documentation, and learning new techniques from more experienced developers.</p>
    <p>To assist developers, Dipy uses the Travis continuous integration system. Any time a new PR is proposed, Travis receives an automated signal to commission a new virtual machine to run the tests. A file in the Dipy repository tells Travis how to install the necessary dependencies, build a clean copy of Dipy, and run Dipy's test suite against the new changes. Travis integrates with GitHub to post the results back to the PR interface. This means that we can check any new code for errors, and make sure that code included into Dipy passes all the tests. After the code reaches the main development branch of Dipy, we run more comprehensive tests on all our supported platforms using a <monospace>buildbot</monospace><xref ref-type="fn" rid="fn0012"><sup>12</sup></xref> system hosted at <ext-link ext-link-type="uri" xlink:href="http://nipy.bic.berkeley.edu">nipy.bic.berkeley.edu</ext-link>. This gives us early warning of any problems on platforms such as Windows or OSX. Dipy also follows a test-driven development philosophy, whereby all code should be accompanied by a suite of tests to exercise all corner cases (Maximilien and Williams, <xref rid="B59" ref-type="bibr">2013</xref>).</p>
    <p>Dipy uses Sphinx to build the project documentation. Sphinx is the documentation system used by the main Python language project and many other Python projects, including all the neuroimaging projects. It takes plain-text ReStructuredText as input and converts it to either HTML, LaTeX or PDF formats. Sphinx takes API documentation directly from the docstrings in the source code, so that the API documentation does not get out of date with the code.</p>
    <p>Dipy's main sub-modules (see Figure <xref ref-type="fig" rid="F2">2</xref>) are <italic>core</italic>, <italic>reconst, tracking, viz, io, align, data, sims</italic> and <italic>segment</italic>. <italic>Core</italic> contains general functions that can be used in any other sub-module. <italic>Reconst</italic> contains classes for estimating diffusion metrics in individual voxels. <italic>Tracking</italic> holds classes for fiber tracking and streamline processing. <italic>Viz</italic> is used for 3D visualization and interaction. <italic>Io</italic> offers input/output utilities when they are not available in Nibabel. <italic>Align</italic> provides tools for alignment and reslicing of volumes or streamlines. <italic>Sims</italic> is focused on creating synthetic simulations. <italic>Data</italic> is used for downloading public datasets. <italic>Segment</italic> concentrates on segmentation of images and clustering of streamlines.</p>
    <p>In this paper we use code listings to illustrate the use of Dipy. For example, the following code snippet shows how to find your current version of Dipy.</p>
    <p>
      <graphic xlink:href="fninf-08-00008-i0001.jpg" position="float"/>
    </p>
  </sec>
  <sec>
    <title>5. Pre-processing</title>
    <sec>
      <title>5.1. Load/save data</title>
      <p>The most basic operation that we perform in neuroimaging is to load files containing data that have been generated from an MRI scanner. Surprisingly this is often a difficult task as different scanners and software read/write the data in different ways. Fortunately Nibabel, a library for reading medical imaging formats, provides support for ANALYZE (plain, SPM99, SPM2), GIFTI, NIfTI1, MINC, MGH, ECAT, PAR/REC, Freesurfer (geometry, morphometry files), and with a growing support for DICOM.</p>
      <p>The most common file format used in dMRI is the NIfTI1 format. Assuming that we have a file with our 4D raw diffusion data we can load it in the following way:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0002.jpg" position="float"/>
      </p>
      <p>Where <monospace>fimg</monospace> holds the filename for the 4D NIfTI1 file, <monospace>nib</monospace> is a shortcut for the Nibabel module, <monospace>img</monospace> is an object that Nibabel creates which contains all the information from the file e.g., the header, the data and the affine. We can obtain all these using <monospace>getter</monospace> methods:</p>
      <preformat>
data = img.get_data()
affine = img.get_affine()
header = img.get_header()
voxel_size = header.get_zooms()[:3]
</preformat>
      <p>Here <monospace>data</monospace> is a Numpy array which contains the actual 4D image (a collection of 3D volumes). Using <monospace>data.shape</monospace> we can obtain the dimensions of the image. In this example, the dimensions are (81, 106, 76, 160). We can think of this 4D image as a sequence of 160 sequential 3D volumes, each containing (81, 106, 76) voxels. The variable <monospace>affine</monospace> provides a 4 × 4 matrix which contains the transformation matrix which maps 3D voxel image coordinates to world mm coordinates. This matrix can be useful when registering, saving or visualizing images. The <monospace>voxel_size</monospace> is a tuple with three values. In this example the <monospace>voxel_size</monospace> is (2, 2, 2), corresponding to a volume of 8 mm<sup>3</sup>.</p>
      <p>Supposing that we want to extract and save from the 4D data only the first volume (usually this is the volume containing the non-diffusion-weighted data, also denoted as <monospace>S0</monospace>). We can do that very easily using the following code.</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0003.jpg" position="float"/>
      </p>
      <p>As we said previously <monospace>data</monospace> is a Numpy array. Numpy arrays provide simple ways to extract information from N-dimensional datasets, an operation known as slicing. For example, <monospace>data[10:20, 15:25, 20:30, 30:50]</monospace> returns a new sub-array with <monospace>shape</monospace> (10, 10, 10, 20) starting at (10, 15, 20). When a colon on its own (:) is used that means that all points in this dimension are used. The only delicate point here is that in order to save this new array we will need to update the affine by adding the sub-array's starting vector to the original offset vector. This is possible in the following way:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0004.jpg" position="float"/>
      </p>
    </sec>
    <sec>
      <title>5.2. Background removal</title>
      <p>In order to remove the background and keep only the parts that are in the brain we can use a function called <monospace>median_otsu</monospace> (see Figure <xref ref-type="fig" rid="F3">3</xref>).</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Showing an axial slice in the center of <monospace>S0</monospace> before (left) and after brain extraction (right) using <monospace>median_otsu</monospace></bold>.</p>
        </caption>
        <graphic xlink:href="fninf-08-00008-g0003"/>
      </fig>
      <p>
        <graphic xlink:href="fninf-08-00008-i0005.jpg" position="float"/>
      </p>
      <p><monospace>median_otsu</monospace> uses first a median filter to smooth the <monospace>S0</monospace> and then Otsu's method, an automated histogram method (Otsu, <xref rid="B67" ref-type="bibr">1979</xref>) to separate the brain (foreground) from its background. It returns two arrays, the <monospace>mask</monospace>, a 3D array with 1s for the foreground and 0s for the background and the masked <monospace>S0</monospace>, <monospace>S0_mask</monospace> a 3D array with the actual <monospace>S0</monospace> values in the foreground and 0s in the background.</p>
    </sec>
    <sec>
      <title>5.3. Gradient table</title>
      <p>The <italic>b</italic>-value <italic>b</italic> or <italic>diffusion weighting</italic> is a function of the amplitude, duration, temporal spacing and timing parameters of the specific paradigm. In the case of the classical Stejskal-Tanner pulsed gradient spin-echo (PGSE) sequence, the signal at the time of readout is given by:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>G</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>
γ is the gyromagnetic ratio, δ denotes the pulse width, <italic>G</italic> is the gradient amplitude and Δ is the center to center spacing. γ is a constant which depends on the type of nucleus and on the strength of the static magnetic field of the MRI machine, but we can control the <italic>b</italic>-value by changing the other three parameters. By changing the <italic>b</italic>-value along different gradient directions MR researchers can alter the quality and duration of the dMRI experiment. The gradient unit directions are often referred as <italic>b</italic>-vectors. We need to know the <italic>b</italic>-values and <italic>b</italic>-vectors for each 3D volume in order to analyze the diffusion data. These can usually be read from one or two different files. Here is an example:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0006.jpg" position="float"/>
      </p>
      <p>The <italic>b</italic>-value and <italic>b</italic>-vector parameters are stored in a utility class, created by the <monospace>gradient_table</monospace> function:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0007.jpg" position="float"/>
      </p>
      <p>Here, <monospace>gtab</monospace> is an instance of a <monospace>GradientTable</monospace> object. This object checks the input values and provides the <italic>b</italic>-values and <italic>b</italic>-vectors in a form that Dipy knows how to use. For example, the <monospace>shape</monospace> of <monospace>gtab.bvals</monospace> and <monospace>gtab.bvecs</monospace> should always return <italic>N</italic> and <italic>N</italic> × 3, respectively, where N is equal to the size of the last dimension of <monospace>data</monospace>. Often, it is useful to know the number and position of <italic>b</italic>-values with value 0 (the b0 volumes); there is an utility method for this purpose—<monospace>gtab.b0s_mask</monospace>.</p>
      <p>The <monospace>GradientTable</monospace> object can also store other acquisition parameters like time between volumes (Time-to-repeat, TR) and echo time (TE). These are Δ and δ, respectively in Equation (1). The <monospace>GradientTable</monospace> is therefore an abstract representation of the acquisition parameters.</p>
    </sec>
  </sec>
  <sec>
    <title>6. Reconstruction</title>
    <p>In diffusion MRI, the motion of water molecules is probed in a spatial- and direction-specific manner. That is, in every spatial location in the brain (typically sampled in voxels each covering a volume of approximately 2 × 2 × 2 mm<sup>3</sup>), the diffusion in several different directions is probed through the application of directional magnetic gradients. This motion due to diffusion takes place at a microscopic level, therefore, if we want to describe how the molecules diffuse we have to study this phenomenon from a statistical point of view. When a molecule is at position <bold>x</bold><sub>0</sub>, we cannot read exactly where it will be after time <italic>t</italic>, we can only model a distribution of possible locations i.e., a probability displacement distribution. This is also known as the diffusion propagator <italic>P</italic>. This motion is described by the propagator <italic>P</italic>(<bold>x</bold>; <bold>x</bold><sub>0</sub>, <italic>t</italic>) which defines the probability of being in <bold>x</bold> after a time <italic>t</italic>, starting at <bold>x</bold><sub>0</sub>. Callaghan (<xref rid="B16" ref-type="bibr">1991</xref>) showed that the spin echo magnitude <italic>S</italic>(<bold>q</bold>, <italic>t</italic>) from a pulsed gradient spin echo (PGSE) experiment is directly related to the diffusion propagator by the following (inverse) Fourier relation
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>q</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mi>P</mml:mi></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>r</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>q</mml:mi></mml:mstyle><mml:mo>·</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>r</mml:mi></mml:mstyle></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>r</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula>
where <italic>S</italic><sub>0</sub> is the signal in the absence of the applied magnetic diffusion gradient <bold>g</bold>, <bold>r</bold> is the relative spin displacement <bold>x</bold> − <bold>x</bold><sub>0</sub> at diffusion time <italic>t</italic> and <bold>q</bold> is the spin displacement wave vector. <bold>q</bold> is parallel with the applied magnetic gradient <bold>g</bold> which in turn are directly related with the <italic>b</italic>-vectors and <italic>b</italic>-values as discussed in section 5.3. In theory, if we apply the Fourier transform in Equation (2) we can get back to the probability displacement distribution (PDF) for every voxel. In practice, the first methods to calculate the PDF were q-space imaging (QSI) (Callaghan et al., <xref rid="B15" ref-type="bibr">1988</xref>) and the most recent diffusion spectrum imaging (DSI) (Wedeen et al., <xref rid="B95" ref-type="bibr">2005</xref>) (see section 6.2). DSI needs long acquisition time although recent techniques based on Compressed Sensing ideas (Menzel et al., <xref rid="B61" ref-type="bibr">2011</xref>; Bilgic et al., <xref rid="B14" ref-type="bibr">2012</xref>; Gramfort et al., <xref rid="B47" ref-type="bibr">2013</xref>), and multi-slice imaging (Setsompop et al., <xref rid="B75" ref-type="bibr">2012</xref>) have considerably accelerated the DSI acquisition. An alternative is to work on reconstructing only an angular projection of the 3D PDF. This reconstruction is often called the orientation distribution function (ODF). Another alternative is to make assumptions about the distribution of the PDF such as a Gaussian assumption, which leads to the popular diffusion tensor imaging (DTI) technique (Basser et al., <xref rid="B6" ref-type="bibr">1994</xref>).</p>
    <sec>
      <title>6.1. Diffusion tensor imaging</title>
      <p>Often people assume that DTI and dMRI are synonyms. This is not correct. In DTI, there is a crucial assumption that the diffusion propagator is described only by a single 3D Gaussian distribution. From Equation (2), we can thus write
<disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>r</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:mn>4</mml:mn><mml:mi>π</mml:mi><mml:msup><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>∣</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:mo>∣</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>r</mml:mi></mml:mstyle><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>D</mml:mi></mml:mstyle><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>r</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
where <bold>D</bold> is known as the diffusion tensor. This tensor is a 3 × 3 positive definite symmetric matrix that can be completely described by a centered ellipsoid with three principal axes and associated eigenvalues λ<sub>1</sub> ≥ λ<sub>2</sub> ≥ λ<sub>3</sub>.</p>
      <p>DTI was first proposed by Basser et al. (<xref rid="B6" ref-type="bibr">1994</xref>) and has since been very influential in demonstrating the utility of dMRI in characterizing properties of white matter tissue. The model relies on the assumption that diffusion is a Gaussian process, which can be captured by six parameters, describing the variance and covariance of the Gaussian diffusion along the three primary axes. From these parameters, several useful measures can be derived. The primary diffusion direction is the principal eigenvector of the tensor. It has eigenvalue λ<sub>1</sub> and is the direction in which variance in the diffusion distribution is largest. In some places in the brain (e.g., in the corpus callosum, the large commissural fiber bundle connecting left and right hemispheres), this corresponds to the direction of the white matter fibers in the voxel and can be used for streamline tracking (Conturo et al., <xref rid="B24" ref-type="bibr">1999</xref>; Mori et al., <xref rid="B63" ref-type="bibr">1999</xref>; Basser et al., <xref rid="B7" ref-type="bibr">2000</xref>). Other univariate measures can be estimated from the parameters of the tensor model to estimate the biophysical properties of the underlying tissue. The diffusivity along the primary direction (referred to as axial diffusivity, or AD) and along other directions (radial diffusivity, or RD), as well as the mean diffusivity (MD) are thought to index proportions of extra-cellular and intra-cellular water within the voxel. For example, MD is commonly used in the diagnosis of acute ischemic stroke, because these types of brain injury are characterized by cell-body swelling. The reduction in extracellular water fraction results in a decrease in MD in the affected regions (Maas and Mukherjee, <xref rid="B58" ref-type="bibr">2005</xref>).</p>
      <p>The fractional anisotropy (FA) is a normalized measure of the variation in diffusivity between different directions and was originally thought to index the organization of the tissue within the voxel (Basser and Pierpaoli, <xref rid="B8" ref-type="bibr">1996</xref>). Later studies in animal models demonstrated that FA decreases when demyelination occurs (Song et al., <xref rid="B78" ref-type="bibr">2002</xref>), because of increases in radial diffusivity. These studies showed that degree of myelination in the white matter is an important factor in limiting diffusion of water across cellular compartments. In addition, tissue density affects both the radial and the axial diffusivity, and loss of nerve fiber tissue also results in a decrease in FA (Beaulieu et al., <xref rid="B10" ref-type="bibr">1996</xref>; Beaulieu, <xref rid="B9" ref-type="bibr">2002</xref>). As a consequence of these studies, researchers now routinely refer to FA as a measure of <italic>tissue integrity</italic>. However, we strongly warn against this usage, because it is easy to show that although the density of the tissue and the density of the myelin wrapping the axons in the voxel may affect both MD and FA, changes in other factors, such as the distribution of directions of crossing of fiber populations through the voxel may also affect these measures (Basser and Pierpaoli, <xref rid="B8" ref-type="bibr">1996</xref>; Jones et al., <xref rid="B53" ref-type="bibr">2013</xref>; Wandell and Yeatman, <xref rid="B93" ref-type="bibr">2013</xref>). Therefore, interpretation of group differences in FA, or longitudinal changes in FA over time should be carefully handled and compared to the results from other modeling techniques, that better account for the distribution of fiber orientations in the voxel (see below).</p>
      <p>That said, the use of diffusion tensor-based univariate statistics is very popular among users of dMRI. Variance in a variety of behavioral (Ben-Shachar et al., <xref rid="B12" ref-type="bibr">2007</xref>) and clinical (Thomason and Thompson, <xref rid="B81" ref-type="bibr">2011</xref>) measures can be predicted based on these statistics, suggesting that they are reporting on meaningful variability in brain structure.</p>
      <p>It is straightforward to use Dipy to fit the tensor model and compute univariate statistics from it. In the following example, we show how to fit the tensor model to data and how to compute univariate measures.</p>
      <p>First, <monospace>data</monospace>, <monospace>mask</monospace> and <monospace>gtab</monospace> are created as we saw in section 5. Next, we can import the diffusion tensor model class and initialize a <monospace>TensorModel</monospace> class instance with the name <monospace>ten_model</monospace>:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0008.jpg" position="float"/>
      </p>
      <p>The code above sets up the analysis. Since the analysis of every voxel in the brain will rely on similar infra-structure, the <monospace>TensorModel</monospace> class instance only sets up the skeleton for the analysis. The same skeleton will be used for every voxel in the data here, but can also be used with new data in a similar fashion. To run the analysis, we pass the data to the fit method of the <monospace>tensor_model</monospace>. This returns a <monospace>TensorFit</monospace> class instance which relates to the specific data and mask:</p>
      <preformat>
ten_fit = ten_model.fit(data, mask)
</preformat>
      <p>The advantage of this separation of the model and the fit is that we can fit many different data with the same initialization parameters without duplicating code. Once a fit has been conducted, we can compute a variety of derived univariate measures, such as the fractional anisotropy (FA) (Basser and Pierpaoli, <xref rid="B8" ref-type="bibr">1996</xref>):</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0009.jpg" position="float"/>
      </p>
      <p>It is common to represent the primary diffusion direction using a red-green-blue (RGB) representation and create a DEC (Directionally Encoded Color) map (Pierpaoli et al., <xref rid="B73" ref-type="bibr">1996</xref>; Pajevic and Pierpaoli, <xref rid="B69" ref-type="bibr">1999</xref>) which is also known as color FA (see Figure <xref ref-type="fig" rid="F4">4</xref>):</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0010.jpg" position="float"/>
      </p>
      <p>Finally, a couple more points about the implementation of DTI. The first is that there is still ongoing research on fitting methods for the tensor model (Koay et al., <xref rid="B54" ref-type="bibr">2006</xref>). Several different methods have been implemented, including non-linear least-squares, ordinary least-squares, and weighted least-squares fitting (Chung et al., <xref rid="B22" ref-type="bibr">2006</xref>) as well as Riemannian modeling-based techniques that assure that the estimated tensor is positive definite (Arsigny et al., <xref rid="B4" ref-type="bibr">2006</xref>; Lenglet et al., <xref rid="B57" ref-type="bibr">2006</xref>). In addition, there is ongoing research on methods to robustly fit the tensor model, in the face of noisy data (Chang et al., <xref rid="B20" ref-type="bibr">2005</xref>, <xref rid="B21" ref-type="bibr">2012</xref>). For this purpose, an implementation of a robust tensor fitting algorithm (RESTORE) is also available in Dipy.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Diffusion Tensor based scalar maps created with Dipy</bold>.</p>
        </caption>
        <graphic xlink:href="fninf-08-00008-g0004"/>
      </fig>
      <p>Note also that Dipy implements many more univariate measures. Not only can users compute FA, MD, DEC, but also other statistics that have been proposed in the literature, such as the diffusion linearity, planarity and sphericity (Westin et al., <xref rid="B96" ref-type="bibr">1997</xref>), as well as the tensor mode, tensor norm (Ennis and Kindlmann, <xref rid="B35" ref-type="bibr">2006</xref>), radial and axial diffusivity. All these tensor-based metrics are available under the <monospace>dipy.reconst.dti</monospace> module. In Figure <xref ref-type="fig" rid="F4">4</xref> a few of the many available measures are shown.</p>
    </sec>
    <sec>
      <title>6.2. Diffusion spectrum imaging</title>
      <p>For those who have acquired DSI data, i.e., data with multiple <italic>b</italic>-values and gradients that span a Cartesian keyhole grid (Tuch, <xref rid="B89" ref-type="bibr">2002</xref>; Wedeen et al., <xref rid="B95" ref-type="bibr">2005</xref>; Garyfallidis, <xref rid="B41" ref-type="bibr">2012</xref>), Dipy currently provides three different models. The standard <monospace>DiffusionSpectrumModel</monospace> can be accessed using:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0011.jpg" position="float"/>
      </p>
      <p>Wedeen et al. (<xref rid="B95" ref-type="bibr">2005</xref>) showed that the dMRI signal is positive for any type of spin motion without net flux (i.e., spin displacements due to thermal molecular agitation) or other random fluxes such as intravoxel incoherent motion. Under this assumption we can replace the complex signal <italic>S</italic> with its modulus |<italic>S</italic>| in Equation (2) and apply the Fourier transform:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>r</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mstyle><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>q</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>q</mml:mi></mml:mstyle><mml:mo>·</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>r</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>q</mml:mi></mml:mstyle></mml:mrow></mml:math></disp-formula>
In DSI this 3D-integral is approximated in a discrete way and the PDF <italic>P</italic> for every single voxel is returned as a 3D array. We can obtain <italic>P</italic> using:</p>
      <preformat>
dsi_fit = dsi_model.fit(data)
dsi_pdf = dsi_fit.pdf()
</preformat>
      <p>However, we recommend this method only when the dimensions of data are very small. This is because the <monospace>dsi_pdf</monospace> is a 6D array with 3 dimensions for the voxel positions and 3 for the <bold>q</bold> positions. For a moderate data set of 150 × 150 × 90 where every PDF is 35 × 35 × 35 we would need about 600 GB of RAM. As a solution to this problem Dipy provides a method which can facilitate traversing through each voxel and calculating each voxel independently:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0012.jpg" position="float"/>
      </p>
      <p>With this method we do not need to store all the PDFs at once. If it is necessary to save all the PDFs then our advice is to create a Numpy memory-map which will store the PDF for each voxel as a binary file on disk while still appearing as an array in memory. Memory-mapped files are used for accessing small segments of large files on disk, without reading the entire file into memory.</p>
      <p>Recently, an alternative method for DSI was proposed by Canales-Rodríguez et al. (<xref rid="B17" ref-type="bibr">2010</xref>) using a deconvolution technique based on a Lucy–Richardson (LR) algorithm of the 3D PDF. The deconvolution technique accounts for the truncation of q-space by standard DSI and can thus achieve a higher angular resolution for resolving crossing fibers. This can be used in exactly the same way as the standard DSI method:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0013.jpg" position="float"/>
      </p>
      <p>In Figure <xref ref-type="fig" rid="F5">5</xref> we show noiseless volumetric renderings of the PDFs of a simulation of a 60° crossing with the two different methods. It is evident that the LR deconvolution reconstruction better represents the underlying structure.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Volumetric rendering of the 3D diffusion propagator of a 60° crossing with standard DSI (top-left) and DSI with deconvolution (top-right) with their corresponding ODFs (bottom)</bold>.</p>
        </caption>
        <graphic xlink:href="fninf-08-00008-g0005"/>
      </fig>
      <p>Since we are mainly interested in the angular structure of the underlying tissue, we further simplify the data by taking the weighted radial summation of <italic>P</italic>(<bold>r</bold>)
<disp-formula id="E5"><label>(5)</label><mml:math id="M5"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mtext>DSI</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>u</mml:mi></mml:mstyle><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mi>P</mml:mi></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mover accent="true"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>u</mml:mi></mml:mstyle><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>d</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:math></disp-formula>
This defines the orientation density function (ODF) for DSI which measures the quantity of diffusion in the direction of the unit vector <bold>û</bold> where <bold>r</bold> = <italic>r</italic><bold>û</bold>. ψ<sub><italic>DSI</italic></sub> is a function on a sphere. Therefore, in order to calculate it or even visualize it we will need a set of spherical coordinates. Here is how we can obtain this ODF:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0014.jpg" position="float"/>
      </p>
      <p>where <monospace>sphere</monospace> is an object holding the vertices and faces of the sphere. Here we used a symmetric sphere with 724 vertices. The <monospace>dsi_odf</monospace> is an array of the 724 ODF values corresponding to the vertices of the sphere. Note at this point that in order to find the ODF we have to first create the diffusion propagator (PDF) by applying the Fourier transform on the lattice (see Figure <xref ref-type="fig" rid="F5">5</xref>). Nonetheless, Dipy, for reasons explained before does not store the PDFs as it computes the ODF. Yeh et al. (<xref rid="B98" ref-type="bibr">2010</xref>) proposed a direct way (GQI) to calculate a slightly different ODF using the Cosine transform. GQI is available from <monospace>dipy.reconst.gqi.GeneralizedQSamplingModel</monospace>. The advantage of GQI is that it is much faster to calculate than DSI or DSI with deconvolution.</p>
    </sec>
    <sec>
      <title>6.3. Q-ball imaging</title>
      <p>To reduce the acquisition requirements of DSI, several techniques have been proposed to compute the ODF from Equation (5) using only a single <italic>b</italic>-value dMRI acquisition, often called <italic>single-shell</italic> high angular resolution diffusion imaging (HARDI) (Tuch et al., <xref rid="B88" ref-type="bibr">2002</xref>; Descoteaux et al., <xref rid="B32" ref-type="bibr">2011</xref>). Spherical harmonics (SH) are mathematical functions that provide a complete orthonormal basis for functions on the sphere. In practice, these can be used to approximate any spherical function (such as the ODF) up to a highest frequency (SH order). Due to their practical mathematical properties, there have been several proposals using spherical harmonics to describe the apparent diffusion coefficient (ADC) computed from HARDI, starting from the work of Frank (<xref rid="B38" ref-type="bibr">2001</xref>, <xref rid="B39" ref-type="bibr">2002</xref>) and Alexander et al. (<xref rid="B2" ref-type="bibr">2002</xref>) and Tuch et al. (<xref rid="B88" ref-type="bibr">2002</xref>). Then, Tuch showed that the Funk Radon Transform (FRT), used in a method he called <italic>q-ball imaging</italic> (QBI), reconstructs a smoothed version the ODF directly from a <italic>single-shell</italic> dMRI acquisition. This q-ball ODF ψ<sub><italic>QBI</italic></sub> can be obtained analytically from a SH estimation of the diffusion signal (Anderson, <xref rid="B3" ref-type="bibr">2005</xref>; Hess et al., <xref rid="B49" ref-type="bibr">2006</xref>; Descoteaux et al., <xref rid="B31" ref-type="bibr">2007</xref>):
<disp-formula id="E6"><label>(6)</label><mml:math id="M6"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mtext>QBI</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:munderover><mml:mn>2</mml:mn></mml:mstyle><mml:mi>π</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>P</italic><sub><italic>l</italic>(<italic>j</italic>)</sub> is the Legendre polynomial of order <italic>l</italic> corresponding to coefficient <italic>j</italic> and the coefficients have been normalized by the S0 (non-diffusion weighted) image. Hence, the q-ball ODF is a linear transformation of the SH coefficient, <italic>c</italic><sub><italic>j</italic></sub>. This technique is called analytical QBI (aQBI), in contrast to the original QBI solution, which performs the FRT numerically. It is important to note that these solutions are based on Equation (5), without the <italic>r</italic><sup>2</sup> term. So these ODFs are not properly normalized. Hence, Dipy also implements the Constant Solid Angle analytical solution more recently proposed by Aganj et al. (<xref rid="B1" ref-type="bibr">2010</xref>) and Tristan-Vega et al. (<xref rid="B86" ref-type="bibr">2009</xref>).</p>
      <p>The SH of order <italic>l</italic> and phase <italic>m</italic>, <italic>Y</italic><sup><italic>m</italic></sup><sub><italic>l</italic></sub>(θ, ϕ), arises from the angular solution to Laplace's equation in spherical coordinates and they form an orthonormal basis for complex functions defined on the unit sphere. However, in single-shell acquisitions, S is real and symmetric. Hence, it is common to define a real and symmetric modified orthonormal SH basis, <italic>Y</italic><sub><italic>j</italic></sub>, using only even order terms and real/imaginary parts of <italic>Y</italic><sup><italic>m</italic></sup><sub><italic>l</italic></sub>(θ, ϕ). Therefore, the measured signal S is estimated with a truncated SH series of order <italic>l</italic><sub>max</sub>, which has <italic>R</italic> = (<italic>l</italic><sub>max</sub> + 1)(<italic>l</italic><sub>max</sub> + 2)/2 terms. For example, for <italic>l</italic><sub>max</sub> = 4, 6, 8, and 16 SH series have <italic>R</italic> = 15, 28, 45, and 153 coefficients, respectively.</p>
      <p>In Dipy we have implemented three different Q-ball methods in the module <monospace>dipy.reconst.shm</monospace>: (a) Descoteaux et al. (<xref rid="B31" ref-type="bibr">2007</xref>), (b) Aganj et al. (<xref rid="B1" ref-type="bibr">2010</xref>), and (c) Tristan-Vega et al. (<xref rid="B86" ref-type="bibr">2009</xref>). For example (a) can be used in the following way:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0015.jpg" position="float"/>
      </p>
      <p>Important points to note are that SH order is set at 6 and the regularization parameter at 0.006, following the optimization recommendations of Descoteaux et al. (<xref rid="B30" ref-type="bibr">2006</xref>). Furthermore, because the analytical ODF method produces smoother ODFs it is useful for visualization purposes to use <italic>min-max</italic> normalization.</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0016.jpg" position="float"/>
      </p>
      <p>The SH coefficients are accessible using the attribute <monospace>qb_fit.shm_coeff</monospace>. Methods (b) and (c) can be used in a very similar way. For example, for the Constant Solid Angle (CSA) (Aganj et al., <xref rid="B1" ref-type="bibr">2010</xref>) method (b) we only need to remove the normalization function and reduce the SH order as the CSA method becomes considerably noisier in higher orders:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0017.jpg" position="float"/>
      </p>
      <p>As a side note: the term Constant Solid Angle derives from the fact that this method calculates the ODF taking account of radial distance as we see in Equation (5).</p>
    </sec>
    <sec>
      <title>6.4. Constrained spherical deconvolution</title>
      <p>QBI-based techniques reconstruct the <italic>diffusion ODF</italic> (dODF). To improve the angular resolution of the reconstruction, spherical deconvolution (SD) techniques have been introduced and reconstruct what is called the <italic>fiber ODF</italic> (fODF). SD was first introduced by Tournier et al. (<xref rid="B84" ref-type="bibr">2004</xref>). With this method, the signal measured on single spherical shell acquisitions can be expressed as the convolution over spherical coordinates of the response function with the fODF. The response function describes the signal intensity that would be measured as a function of orientation for a single fiber aligned along the <italic>z</italic>-axis. In the spherical harmonics (SH) framework, the convolution operation is performed as follows. For each harmonic order <italic>l</italic>, the SH coefficients of the signal profile <italic>S</italic>(θ, ϕ) and the fODF <italic>F</italic>(θ, ϕ) are written as vectors <bold>s</bold><sub><italic>l</italic></sub> and <bold>f</bold><sub><italic>l</italic></sub> of length 2<italic>l</italic> + 1, whereas the rotational harmonic coefficients of the convolution kernel <italic>R</italic> (the response function) are written as a matrix <bold>R</bold><sub><italic>l</italic></sub> of size (2<italic>l</italic> + 1) × (2<italic>l</italic> + 1). The convolution operation then simply consists of one matrix multiplication per harmonic order <italic>l</italic>: <bold>s</bold><sub><italic>l</italic></sub> = <bold>R</bold> · <bold>f</bold><sub><italic>l</italic></sub>. The spherical deconvolution operation can be performed by simple matrix inversion. However, the spherical deconvolution problem is ill-posed and thus severely affected by noise (Tournier et al., <xref rid="B84" ref-type="bibr">2004</xref>).</p>
      <p>Constrained super-resolved spherical deconvolution (CSD) Tournier et al. (<xref rid="B82" ref-type="bibr">2007</xref>) gives a robust solution to this problem by applying two major constraints on the fitting of the fODF. The first is that it applies a non-negativity constraint: fODF values that are smaller than 0 are non-physical and are precluded. The other is that CSD assumes that only a few of the fODF values will be large. Applying these two constraints allows fitting the SH basis up to very high orders, in essence fitting more parameters than the data allows. This super-resolved method can be accessed in Dipy using:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0018.jpg" position="float"/>
      </p>
      <p>The main choice to consider is the estimation of the single fiber response function. We assume that <italic>R</italic> is derived from a prolate tensor, where the single-tensor model is accurate. The eigenvalues of this tensor are estimated from the voxels with FA &gt; 0.7. The input parameter <monospace>response</monospace> is a tuple with two parameters: (a) the eigen-values of the tensor and (b) the estimated average S0 signal for those voxels. The response function is usually estimated from the corpus callosum areas. For further information on how to initialize the CSD please read our examples at <monospace>dipy.org</monospace>.</p>
      <p>Dipy also implements a second constrained spherical deconvolution method: the Spherical Deconvolution Transform (SDT) (Descoteaux et al., <xref rid="B33" ref-type="bibr">2009</xref>), which is a sharpening operation that can transform the smooth diffusion ODF into a sharper fiber ODF. The method is inspired by CSD (Tournier et al., <xref rid="B82" ref-type="bibr">2007</xref>) with the main difference that the CSD is applied directly to the initial signal and the SDT directly to the ODF (Descoteaux, <xref rid="B29" ref-type="bibr">2008</xref>; Descoteaux et al., <xref rid="B33" ref-type="bibr">2009</xref>).</p>
      <p>For the derivation and explanation of the formula see Descoteaux et al. (<xref rid="B33" ref-type="bibr">2009</xref>). You can use the SDT in the following way:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0019.jpg" position="float"/>
      </p>
      <p>Here the response function is provided as a scalar parameter <monospace>ratio</monospace>, which is the ratio of the smallest eigenvalue to the largest eigenvalue. Both spherical deconvolution methods perform similarly as shown in Descoteaux et al. (<xref rid="B33" ref-type="bibr">2009</xref>) and Garyfallidis et al. (<xref rid="B44" ref-type="bibr">2013</xref>).</p>
      <p>In Figure <xref ref-type="fig" rid="F6">6</xref> the ODFs of the <monospace>TensorModel</monospace>, <monospace>CsaOdfModel</monospace> and <monospace>CsdModel</monospace> of a region in the centrum semiovale show crossings between the corpus callosum, corticospinal tract and the superior longitudinal fasciculus.</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>(A)</bold> Tensor ellipsoids color-coded with a DEC map, <bold>(B)</bold> tensor ODFs, <bold>(C)</bold> constant solid angle ODFs, and <bold>(D)</bold> constrained spherical deconvolution ODFs in a region in the centrum semiovale showing crossings between the corpus callosum, corticospinal tract and the superior longitudinal fasciculus.</p>
        </caption>
        <graphic xlink:href="fninf-08-00008-g0006"/>
      </fig>
    </sec>
    <sec>
      <title>6.5. Peaks from models</title>
      <p>In the previous sections we showed that the reconstruction models have a uniform API and can be called in similar ways. For example, they all have an <monospace>odf()</monospace> method. This design gives us the opportunity to create utility functions where the model is one of the parameters. <monospace>peaks_from_model</monospace> is a multipurpose function which can be used to (a) find the maxima (peaks) of the ODFs, (b) find the directions of the maxima in the ODFs (which can be useful for tracking), (c) discretize those directions on the unit sphere for efficiency, (d) compress the ODFs as spherical harmonics to reduce memory usage, and (e) calculate many metrics simultaneously—e.g., generalized fractional anisotropy (GFA) (Tuch, <xref rid="B87" ref-type="bibr">2004</xref>)—without the need to create all ODFs at once. <monospace>peaks_from_model</monospace> can be called as:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0020.jpg" position="float"/>
      </p>
      <p>The model parameter can be set to any of the models discussed in the previous sections e.g., <monospace>dsi_model</monospace>. The <monospace>relative_peak_threshold</monospace> parameter specifies that only peaks greater than <monospace>relative_peak_threshold</monospace>∗<italic>m</italic> should be returned, where <italic>m</italic> is the value of the largest peak. <monospace>min_separation_angle</monospace> sets the threshold for the minimum angular distance in degrees between two peaks. If the peaks are closer than this threshold only the larger of the two is returned. These two parameters help to get robust fiber directions when the ODFs are noisy. <monospace>peaks_from_model</monospace> returns a <monospace>PeaksAndMetrics</monospace> object which holds all the different output arrays, <monospace>peak_values</monospace>, <monospace>peak_indices</monospace>, <monospace>gfa</monospace>, <monospace>qa</monospace> (Yeh et al., <xref rid="B98" ref-type="bibr">2010</xref>), <monospace>odf</monospace> and <monospace>shm_coeff</monospace>.</p>
      <p>If the parameter <monospace>return_sh</monospace> is set to True then the ODFs will be represented by their SH expansion. This reduces memory usage, as the SH coefficients need much less memory than the ODF represented on the sphere. If we want to calculate the ODF back from the SH coefficients we can use the function <monospace>sh_to_sf</monospace>:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0021.jpg" position="float"/>
      </p>
    </sec>
  </sec>
  <sec>
    <title>7. Fiber tracking</title>
    <p>One of the tantalizing prospects of dMRI is that combining information about local microstructure across different voxels may provide information about large-scale organization of the brain. In particular, researchers have been using various algorithms in attempts to track along the presumed fiber populations to make inferences about axonal connections between different parts of the gray matter (see Figure <xref ref-type="fig" rid="F1">1</xref>). The connection matrix that results from an exhaustive connectivity analysis of all parts of the cerebral cortex is sometimes referred to as a <italic>connectome</italic> (Sporns et al., <xref rid="B79" ref-type="bibr">2005</xref>) and understanding the structure and function of the connectome is a central goal of contemporary neuroscience. This premise has led to major investment in data-collection projects aimed at characterizing the connectome, based on dMRI, as well as functional MRI (fMRI) measurements (Van Essen et al., <xref rid="B92" ref-type="bibr">2013</xref>).</p>
    <p>Tracking algorithms used to infer these connections divide into two major classes. The first class is deterministic. Deterministic streamlines follow a predictable path through the data, by selecting at each point a single diffusion direction to follow. There may be several estimated directions at each point (such as a voxel center), but deterministic selects one of these estimated directions on some criterion such as closeness of match to the previous direction of the streamline. Some of the early deterministic algorithms used the primary diffusion direction of the diffusion tensor model as an indication of the direction of the major fiber population in every voxel and track along the streamlines that are implied by these principal diffusion directions (Conturo et al., <xref rid="B24" ref-type="bibr">1999</xref>; Mori et al., <xref rid="B63" ref-type="bibr">1999</xref>; Basser et al., <xref rid="B7" ref-type="bibr">2000</xref>). However, it is now widely recognized that in regions of crossing fibers, the primary diffusion direction may not coincide with the direction of any of the local fiber populations. More modern algorithms (see below) take this into account.</p>
    <p>The second major class of tractography algorithms is probabilistic. These methods consider the local information in each voxel to represent a distribution of possible directions in that location. In these algorithms, a trajectory of fibers in every location is randomly sampled from the local distribution. Any given streamline in a probabilistic tractography is therefore one random sample of many possible streamlines. The algorithm may therefore give different sets of streamlines on different realizations.</p>
    <p>Dipy implements both deterministic and probabilistic tracking algorithms, described in detail below.</p>
    <sec>
      <title>7.1. Deterministic</title>
      <p>Euler Delta Crossings (Garyfallidis, <xref rid="B41" ref-type="bibr">2012</xref>), or <italic>EuDX</italic> for short, was the first tracking method to be implemented in Dipy. We created an algorithm that has many similarities with the classical deterministic methods (Conturo et al., <xref rid="B24" ref-type="bibr">1999</xref>; Mori et al., <xref rid="B63" ref-type="bibr">1999</xref>; Basser et al., <xref rid="B7" ref-type="bibr">2000</xref>) and with more recent ones such as those described in Descoteaux et al. (<xref rid="B33" ref-type="bibr">2009</xref>) and Yeh et al. (<xref rid="B98" ref-type="bibr">2010</xref>). Our focus was on creating a simple deterministic algorithm which can be used with very different families of reconstruction models, work well in crossing areas and be efficient so that it can be used to quickly inspect the reconstruction results. EuDX is usually applied in native space image coordinates and it assumes that voxels are of equal size in all three image axes (isotropic voxel size). If the raw data does not have isotropic voxel size then a reslicing preprocessing step is required to make the data isotropic.</p>
      <p>In order to create streamlines, we initially need to provide one or more seed points <bold>s</bold>. The seed points are the points from which the streamlines will start growing. These can be chosen randomly or they can be specified explicitly. However, the seed points need to be constrained by the volume's dimensions. Every seed point <bold>p</bold><sub>0</sub> becomes the starting point for the track propagation. For the integration we solve for <bold>p</bold><sub><italic>t</italic></sub> = <bold>p</bold><sub>0</sub> + ∫<sup><italic>t</italic></sup><sub>0</sub>
<bold>v</bold>(<bold>p</bold>(<bold>s</bold>))<italic>d</italic><bold>s</bold> and we perform the integration numerically using Euler's method
<disp-formula id="E7"><label>(7)</label><mml:math id="M7"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>p</mml:mi></mml:mstyle><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>p</mml:mi></mml:mstyle><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>p</mml:mi></mml:mstyle><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>Δ</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:math></disp-formula>
where Δ<italic>s</italic> is the propagation step size (which should be no greater than the voxel size), and <bold>v</bold> is the propagation direction. EuDX uses trilinear interpolation for the calculation of the next direction, integrating directional information from the surrounding voxels.</p>
      <p>The first parameter of EuDX can be an array of dimensions <italic>X</italic> × <italic>Y</italic> × <italic>Z</italic> like FA or <italic>X</italic> × <italic>Y</italic> × <italic>Z</italic> × <italic>W</italic> like the ODF, or quantitative anisotropy (QA) (Yeh et al., <xref rid="B98" ref-type="bibr">2010</xref>). These arrays can be used for stopping the propagation if the value in the current voxel is lower than <monospace>a_low</monospace>. For efficiency, the peak directions are discretized on a unit sphere. For this purpose, the second parameter is another array of dimensions <italic>X</italic> × <italic>Y</italic> × <italic>Z</italic> or <italic>X</italic> × <italic>Y</italic> × <italic>Z</italic> × <italic>W</italic> but this time these are the indices of the directions approximated on the sphere. Here we give an example where we have used the <monospace>peak_indices</monospace> from CSD using <monospace>peaks_from_models</monospace> and the tensor FA for stopping criteria (with threshold 0.1):</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0022.jpg" position="float"/>
      </p>
      <p>The input parameter <monospace>seeds</monospace> can be given as an integer, this will generate random seeds in the entire volume, or it can be given as a <italic>N</italic> × 3 array of seed points. The latter explicit specification of seed points has the advantage that it allows us to seed from specific ROIs or from the gray matter—white matter boundary which has been shown to generate more robust tracking results (Côté et al., <xref rid="B26" ref-type="bibr">2013</xref>). The instance of EuDX returns an iterator. In every call of the iterator a new streamline is returned. This technique allows one to generate and save streamlines directly to disk without loading all streamlines in memory. In Figure <xref ref-type="fig" rid="F7">7</xref> a few thousand human brain streamlines are shown, approximating the brain's white matter connections, generated from EuDX. In contrast, in Figure <xref ref-type="fig" rid="F1">1</xref> only a specific anatomical bundle is approximated rather than the full brain.</p>
      <fig id="F7" position="float">
        <label>Figure 7</label>
        <caption>
          <p><bold>Left:</bold> An example of EuDX streamline tracking applied on a real human brain dataset and color-coded with a standard orientation colormap. <bold>Middle:</bold> Showing the QuickBundles centroids with random colors. <bold>Right:</bold> Showing the clusters color-coded with their corresponding centroid color.</p>
        </caption>
        <graphic xlink:href="fninf-08-00008-g0007"/>
      </fig>
    </sec>
    <sec>
      <title>7.2. Probabilistic</title>
      <p>Probabilistic fiber tracking describes a class of tractography algorithms that estimate multiple possible pathways though each point by taking into account the uncertainty in fiber direction at those points. The uncertainty in fiber direction can be estimated as an fODF, this distribution can be used along with a Monte Carlo sampling to generate streamlines (Morris et al., <xref rid="B65" ref-type="bibr">2008</xref>). Streamlines are generated using a Markov process which is similar to deterministic fiber tracking. Streamlines begin at a seed point and continue along a propagation direction which is randomly chosen from the fODF. The propagation direction is continually adjusted by sampling from the fODF at each new location along the path. This continues until some stopping criteria are met. Notice that this framework is equivalent to deterministic fiber tracking if the fODF at each point is a delta function of one fiber direction.</p>
      <p>Dipy has implemented two interfaces for probabilistic Markov fiber tracking. The first method allows the user to provide the distribution evaluated on a discrete set of possible tracking directions. For example the fiber orientation distribution function (fODF) obtained by fitting the CSD (constrained spherical deconvolution) model to diffusion data can be used as an estimate of the PDF, because it represents a fiber distribution associated with the measured diffusion signal (Jeurissen et al., <xref rid="B50" ref-type="bibr">2011</xref>). The user must also provide a set of seeds to track from, and set the stopping criteria. Currently a white matter mask and maximum turning angle are used as stopping criteria.</p>
      <p>The second interface for probabilistic tracking is meant to accommodate tracking methods where the fODF cannot be easily computed. It is often much easier and less computationally expensive to sample from a PDF than it is to evaluate the PDF. For example, residual bootstrap fiber tracking methods fall into this category (Berman et al., <xref rid="B13" ref-type="bibr">2008</xref>). In this case we combine a sampling method with the diffusion data and a diffusion Model, and pass this to the Markov tracking framework. Streamlines can now be generated as before without explicitly evaluating the orientation distribution at each point in the diffusion data. This framework is designed to be flexible and easily customizable so that a wide variety of tracking methods can be expressed.</p>
    </sec>
  </sec>
  <sec>
    <title>8. Fiber analysis and post-processing</title>
    <p>In the following sections we describe some of the tools available for processing streamlines after these have been created.</p>
    <sec>
      <title>8.1. Streamline clustering</title>
      <p>Depending on the initial number of seeds and other tracking parameters, fiber tracking algorithms can generate a great number of densely packed streamlines (often more than one million) which are difficult to interact with and interpret. As a solution to this problem Dipy implements a recent efficient clustering algorithm for streamlines called QuickBundles (QB) (Garyfallidis, <xref rid="B41" ref-type="bibr">2012</xref>; Garyfallidis et al., <xref rid="B43" ref-type="bibr">2012</xref>). QB can be used to simplify large datasets in a couple of minutes. When using QB we need first to instantiate the <monospace>QuickBundles</monospace> object with three parameters. The first parameter is the initial set of streamlines to be clustered, the second is the distance threshold that will determine the number of clusters and their sizes, and the third is the level of detail for each streamline. For example, in the code snippet below we use <monospace>pts=18</monospace> which means that before QB starts the clustering procedure the streamlines will be downsampled so that each one has the same number of points (here 18) and equal length segments. This preprocessing step is a prerequisite for QB.</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0023.jpg" position="float"/>
      </p>
      <p>After we have created the instance of the object, attributes like <monospace>qb.centroids</monospace> provide the clusters' centroids and methods like <monospace>qb.label2tracks()</monospace> can return the streamlines which belong to a specific cluster. Figure <xref ref-type="fig" rid="F7">7</xref> shows an example of QuickBundles applied on the human brain dataset described in Fortin et al. (<xref rid="B37" ref-type="bibr">2012</xref>), using the same parameters shown in the code listing above.</p>
    </sec>
    <sec>
      <title>8.2. ROIs and streamline intersections</title>
      <p>It is often useful in dMRI to filter, group or count streamlines based on their interactions with one or several ROIs (Côté et al., <xref rid="B26" ref-type="bibr">2013</xref>). There are a few functions in <monospace>dipy.tracking.utils</monospace> to make these kinds of operations easier. The first of these functions, <monospace>density_map</monospace>, counts the number of streamlines that pass though each voxel and returns the result as an image. In all the following examples <monospace>streamlines</monospace> is a sequence of streamlines and <monospace>affine</monospace> is a mapping from voxel coordinates to world coordinates. In all cases <monospace>affine</monospace> can be omitted if the streamlines are defined in voxel coordinate space.</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0024.jpg" position="float"/>
      </p>
      <p>In this example <monospace>shape</monospace> is the shape of the 3D image to be returned, and <monospace>track_density</monospace> is a 3D volume where the intensity of each voxel is the number of streamlines that pass though that voxel. Note that each streamline is counted once per voxel even if multiple points in the streamline lie in that voxel.</p>
      <p>Another useful function is <monospace>target</monospace>. This function filters a sequence of streamlines and keeps only those that pass through an ROI.</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0025.jpg" position="float"/>
      </p>
      <p>Here <monospace>roi</monospace> is a binary array, and <monospace>bundle</monospace> is generator of streamlines. Only the streamlines that pass though at least one of the voxels in <monospace>roi</monospace> that have value 1, will be in <monospace>bundle</monospace>.</p>
      <p><monospace>streamline_mapping</monospace> is a function related to <monospace>target</monospace>. This function produces a mapping from voxel indices to streamlines, much like targeting on every individual voxel, and returns a dictionary of those mappings.</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0026.jpg" position="float"/>
      </p>
      <p>Here <monospace>mapping</monospace> is a dictionary where the keys are voxel indices and the value associated with each key is a list of all the streamlines that pass though that voxel. For example to get all the streamlines that pass though voxel <monospace>(i, j, k)</monospace>, we would look up <monospace>mapping[i, j, k]</monospace>.</p>
      <p>The last function we want to mention in this section is <monospace>connectivity_matrix</monospace>. This function groups and counts streamlines based on their endpoints and a label volume which we call <monospace>labels</monospace>. This label volume should be an image where the intensities of the image map to anatomical structures. For example:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0027.jpg" position="float"/>
      </p>
      <p>Here because we have made the matrix symmetric, <monospace>M[i, j] = M[j, i]</monospace> is the number of streamlines that connect region <monospace>i</monospace> to <monospace>j</monospace> or <monospace>j</monospace> to <monospace>i</monospace>. Similarly because we have set <monospace>return_mapping=True</monospace>, we can get a list of all those streamlines by looking up <monospace>M_sl[i, j]</monospace>.</p>
      <p>While it is common to apply these kinds of operations in native voxel space of the diffusion MRI images used to create the streamlines, this is not required. It is often useful to interact with streamlines in the voxel space of a high resolution structural image of the same patient. This is possible as long as one can compute a linear transformation (<monospace>affine</monospace>) between the voxel coordinates and the streamline point coordinates.</p>
      <p>An example of using <monospace>target</monospace> and <monospace>connectivity_matrix</monospace> is shown in Figure <xref ref-type="fig" rid="F8">8</xref>. In the left panel we can see the streamlines found to intersect with the yellow mask in the corpus callosum (CC) using <monospace>target</monospace>. Then we used these streamlines to investigate which areas of the cortex are connected using a modified <monospace>aparc+aseg.mgz</monospace> label map created by FreeSurfer (Fischl, <xref rid="B36" ref-type="bibr">2012</xref>) of 89 regions. For a complete example of how you can create your own connectivity matrices we recommend reading the online tutorial on the topic from Dipy's website<xref ref-type="fn" rid="fn0013"><sup>13</sup></xref>.</p>
      <fig id="F8" position="float">
        <label>Figure 8</label>
        <caption>
          <p><bold>Left:</bold> Streamlines intersecting a mask in the corpus callosum (CC). <bold>Middle:</bold> Showing the streamlines with semi-transparency to make it easy to see the mask (yellow color). <bold>Right:</bold> Connectivity matrix of the CC streamlines that connect 89 cortical regions. A detailed tutorial which explains how it is possible to create similar connectivity matrices with your data is available at Dipy's website.</p>
        </caption>
        <graphic xlink:href="fninf-08-00008-g0008"/>
      </fig>
    </sec>
    <sec>
      <title>8.3. Streamline metrics and statistics</title>
      <p>In Dipy, we have implemented several metrics for streamlines. For example, perhaps someone may want to calculate the average length and standard deviation of the streamlines generated after the fiber tracking procedure. This can be achieved very easily using the <monospace>length</monospace> function which takes as input a single streamline. We can then iterate through all the streamlines in the following way:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0028.jpg" position="float"/>
      </p>
      <p>Many other metrics can be found in the metrics sub-module e.g., <monospace>spline</monospace> for spline interpolation, <monospace>centre_of_mass</monospace>, <monospace>mean_curvature</monospace>, <monospace>mean_orientation</monospace> and the <monospace>frenet_serret</monospace> framework for curvature and torsion calculations along a streamline.</p>
    </sec>
    <sec>
      <title>8.4. Visualization</title>
      <p>Figures <xref ref-type="fig" rid="F1">1</xref>, <xref ref-type="fig" rid="F4">4</xref>–<xref ref-type="fig" rid="F7">7</xref>, are generated by our own visualization tools which can be used for most parts of the diffusion analysis pipeline. We have developed a minimal and lightweight module called <monospace>fvtk</monospace> which is based on the Visualization Toolkit (VTK) (Schroeder et al., <xref rid="B74" ref-type="bibr">2001</xref>). The main idea is that a window can have one or more renderers. A renderer can have none, one or more actors. Examples of actors are a sphere, line, point or a complete set of streamlines. You can add actors in a renderer and in that way you can visualize the aforementioned objects e.g., sphere, line etc. The windows can be created by either the <monospace>show</monospace> function which creates a visible window or the <monospace>record</monospace> function which creates a temporary window only for the purpose of using it to render the objects and save the frames on disk. The renderer holds all the actors i.e., the visible objects. Here is a simple example where we visualize some streamlines with different colors:</p>
      <p>
        <graphic xlink:href="fninf-08-00008-i0029.jpg" position="float"/>
      </p>
      <p>The function <monospace>streamtube</monospace> was also the one we used to create Figures <xref ref-type="fig" rid="F1">1</xref>, <xref ref-type="fig" rid="F7">7</xref>. The most commonly used visualization functions are given in Table <xref ref-type="table" rid="T1">1</xref>.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p><bold>List of visualization functions</bold>.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">
                <bold>Name</bold>
              </th>
              <th align="left" rowspan="1" colspan="1">
                <bold>Usage</bold>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">ren</td>
              <td align="left" rowspan="1" colspan="1">Create renderer</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">add</td>
              <td align="left" rowspan="1" colspan="1">Add actor to renderer</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">rm</td>
              <td align="left" rowspan="1" colspan="1">Remove actor from renderer</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">rm_all</td>
              <td align="left" rowspan="1" colspan="1">Remove all actors from renderer</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">show</td>
              <td align="left" rowspan="1" colspan="1">Create window and show renderer</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">record</td>
              <td align="left" rowspan="1" colspan="1">Save frame or frames</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">line</td>
              <td align="left" rowspan="1" colspan="1">Creates an actor of one or more streamlines</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">streamtube</td>
              <td align="left" rowspan="1" colspan="1">Same as line but with streamtubes</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">point</td>
              <td align="left" rowspan="1" colspan="1">Creates actor of points as small spheres</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">tensor</td>
              <td align="left" rowspan="1" colspan="1">Actor for tensor ellipsoids visualization</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">sphere_funcs</td>
              <td align="left" rowspan="1" colspan="1">Actor for ODF visualization</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">volume</td>
              <td align="left" rowspan="1" colspan="1">3D volume rendering with raycasting</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">slicer</td>
              <td align="left" rowspan="1" colspan="1">Actor for showing volumetric slices</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>9. Discussion and conclusion</title>
    <p>We have outlined the structure and functionality of the Dipy library. Dipy provides a number of simple-to-use methods for the analysis of diffusion MRI data using the Python language. We demonstrated examples of pre-processing, reconstruction, tracking and post-processing, showing that Dipy, although a relatively new project, can fill many of the steps needed to do a complete dMRI analysis. We have illustrated the scope of the methods that have been implemented to date, and have demonstrated these capabilities of Dipy with sample scripts and visualizations.</p>
    <p>In the future, we are hoping to introduce new methods which are not currently implemented. Here are some hints about the areas that we are currently working on. For the pre-processing steps, we are currently implementing denoising and eddy-current correction of the raw dMRI data. For group analysis, we are creating novel warping algorithms. We have also started looking into tissue characterization in microstructure (Assaf et al., <xref rid="B5" ref-type="bibr">2008</xref>). For the reconstruction, we have already a first implementation of SHORE (Özarslan et al., <xref rid="B68" ref-type="bibr">2013</xref>) which we are currently enhancing with more features. For tracking, we are looking into building a more general and adaptive interface. For connectivity analysis, we are working with the Connectome Mapper (CM) (Daducci et al., <xref rid="B28" ref-type="bibr">2012</xref>) developers to further integrate Dipy into the CM pipeline.</p>
    <p>As the size of the datasets in laboratories and hospitals around the world keeps increasing it is very important to use parallel processing to reduce the duration of analysis. For this purpose we have already implemented a parallel execution for the reconstruction step which is usually a bottleneck of the overall dMRI analysis. This is enabled through <monospace>peaks_from_model</monospace> by setting the parameter <monospace>parallel=True</monospace>. Nonetheless, we are working on parallelizing other bottlenecks of the pipeline either by using multi-processing or OpenMP through Cython. Of course, for those who are interested in computing every subject in parallel e.g., in a cluster or in a multi-core computer this is very easy to do with Python and Dipy and there are many tools which can facilitate this e.g., IPython, Nipype, and others.</p>
    <p>Dipy is free and open source software and it is part of a larger community found at <ext-link ext-link-type="uri" xlink:href="http://nipy.org">nipy.org</ext-link>. This is a growing team of scientists and developers focusing on sharing code for different modalities of brain imaging. In common with the other Nipy projects, Dipy is being developed under the umbrella of a single GitHub organization<xref ref-type="fn" rid="fn0014"><sup>14</sup></xref> and the central Dipy GitHub repository is managed under this organization<xref ref-type="fn" rid="fn0015"><sup>15</sup></xref>. The community provides support for the use and development of these software tools through the project's mailing list<xref ref-type="fn" rid="fn0016"><sup>16</sup></xref>.</p>
    <p>Github is widely recognized as a factor in lowering the barriers on participation in open-source software development. In combination with the principles of the Nipy community, this has led to a vibrant and diverse developer community. In contrast to many other software projects in neuroimaging, Dipy is not based on the work of one lab, or one institution. Though many of the contributions are made by a few core contributors, there are many contributors to the code-base and the number of contributors has been growing dramatically after the release of Dipy 0.6 which took place on April 2013 (see Figure <xref ref-type="fig" rid="F9">9</xref>). Dipy contributors come from at least seven different academic institutions in five countries (Canada, UK, USA, Italy, and South Africa).</p>
    <fig id="F9" position="float">
      <label>Figure 9</label>
      <caption>
        <p><bold>Participation in the Dipy GitHub repository.</bold> The cumulative number of unique contributors has been extracted using the git log command and tallied. Many new contributors have joined the project after the 0.6 release.</p>
      </caption>
      <graphic xlink:href="fninf-08-00008-g0009"/>
    </fig>
    <p>In conclusion, we hope this paper inspires you to share our excitement in developing Dipy and encourages you to participate in the project. We strongly hope that more scientists will join Dipy by using the software and giving us feedback so that we can make it better. Stronger still is our hope that many will chose to share their code implementing new methods, and join the developer team. We are sure that a wide and open participation is absolutely necessary in order to solve the hard problems of brain mapping.</p>
    <sec>
      <title>Conflict of interest statement</title>
      <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <p>One major source of support for this community comes in the form of the Neurodebian distribution (Halchenko and Hanke, <xref rid="B48" ref-type="bibr">2012</xref>). Neurodebian is a platform for maintenance and deployment of software for the analysis of neuroscience data, based on free open source software (FOSS) practices.</p>
    <p>We are grateful to Amandine Pelletier and Gwenaelle Catheline from Université Bordeaux 2 who provided the fornix data of Figure <xref ref-type="fig" rid="F1">1</xref>.</p>
    <p>Ariel Rokem is funded by a National Research Service Award (NEI F32 EY022294). Eleftherios Garyfallidis is funded by NSERC-CREATE program in Medical Image Analysis and the Quebec Funds in Nature and Techologie (FQRNT).</p>
  </ack>
  <fn-group>
    <fn id="fn0001">
      <p>
        <sup>1</sup>
        <ext-link ext-link-type="uri" xlink:href="http://nipy.org">http://nipy.org</ext-link>
      </p>
    </fn>
    <fn id="fn0002">
      <p>
        <sup>2</sup>
        <ext-link ext-link-type="uri" xlink:href="http://numpy.org">http://numpy.org</ext-link>
      </p>
    </fn>
    <fn id="fn0003">
      <p>
        <sup>3</sup>
        <ext-link ext-link-type="uri" xlink:href="http://scipy.org">http://scipy.org</ext-link>
      </p>
    </fn>
    <fn id="fn0004">
      <p>
        <sup>4</sup>
        <ext-link ext-link-type="uri" xlink:href="http://cython.org">http://cython.org</ext-link>
      </p>
    </fn>
    <fn id="fn0005">
      <p>
        <sup>5</sup>
        <ext-link ext-link-type="uri" xlink:href="http://nipy.org/nibabel">http://nipy.org/nibabel</ext-link>
      </p>
    </fn>
    <fn id="fn0006">
      <p>
        <sup>6</sup>
        <ext-link ext-link-type="uri" xlink:href="http://matplotlib.org">http://matplotlib.org</ext-link>
      </p>
    </fn>
    <fn id="fn0007">
      <p>
        <sup>7</sup>
        <ext-link ext-link-type="uri" xlink:href="http://vtk.org">http://vtk.org</ext-link>
      </p>
    </fn>
    <fn id="fn0008">
      <p>
        <sup>8</sup>
        <ext-link ext-link-type="uri" xlink:href="http://nose.readthedocs.org/">http://nose.readthedocs.org/</ext-link>
      </p>
    </fn>
    <fn id="fn0009">
      <p>
        <sup>9</sup>
        <ext-link ext-link-type="uri" xlink:href="http://sphinx-doc.org/">http://sphinx-doc.org/</ext-link>
      </p>
    </fn>
    <fn id="fn0010">
      <p>
        <sup>10</sup>
        <ext-link ext-link-type="uri" xlink:href="http://ipython.org">http://ipython.org</ext-link>
      </p>
    </fn>
    <fn id="fn0011">
      <p>
        <sup>11</sup>
        <ext-link ext-link-type="uri" xlink:href="http://github.com/nipy/dipy">http://github.com/nipy/dipy</ext-link>
      </p>
    </fn>
    <fn id="fn0012">
      <p>
        <sup>12</sup>
        <ext-link ext-link-type="uri" xlink:href="http://buildbot.net">http://buildbot.net</ext-link>
      </p>
    </fn>
    <fn id="fn0013">
      <p>
        <sup>13</sup>
        <ext-link ext-link-type="uri" xlink:href="http://dipy.org/examples_index.html">http://dipy.org/examples_index.html</ext-link>
      </p>
    </fn>
    <fn id="fn0014">
      <p>
        <sup>14</sup>
        <ext-link ext-link-type="uri" xlink:href="http://github.com/nipy">http://github.com/nipy</ext-link>
      </p>
    </fn>
    <fn id="fn0015">
      <p>
        <sup>15</sup>
        <ext-link ext-link-type="uri" xlink:href="http://github.com/nipy/dipy">http://github.com/nipy/dipy</ext-link>
      </p>
    </fn>
    <fn id="fn0016">
      <p>
        <sup>16</sup>
        <ext-link ext-link-type="uri" xlink:href="http://dipy.org/subscribe.html">http://dipy.org/subscribe.html</ext-link>
      </p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aganj</surname><given-names>I.</given-names></name><name><surname>Lenglet</surname><given-names>C.</given-names></name><name><surname>Sapiro</surname><given-names>G.</given-names></name><name><surname>Yacoub</surname><given-names>E.</given-names></name><name><surname>Ugurbil</surname><given-names>K.</given-names></name><name><surname>Harel</surname><given-names>N.</given-names></name></person-group> (<year>2010</year>). <article-title>Reconstruction of the orientation distribution function in single- and multiple-shell q-ball imaging within constant solid angle</article-title>. <source>Magn. Reson. Med</source>. <volume>64</volume>, <fpage>554</fpage>–<lpage>556</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.22365</pub-id><?supplied-pmid 20535807?><pub-id pub-id-type="pmid">20535807</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Alexander</surname><given-names>D.</given-names></name><name><surname>Barker</surname><given-names>G.</given-names></name><name><surname>Arridge</surname><given-names>S.</given-names></name></person-group> (<year>2002</year>). <article-title>Detection and modeling of non-gaussian apparent diffusion coefficient profiles in human brain data</article-title>. <source>Magn. Reson. Med</source>. <volume>48</volume>, <fpage>331</fpage>–<lpage>340</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.10209</pub-id><?supplied-pmid 12210942?><pub-id pub-id-type="pmid">12210942</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anderson</surname><given-names>A.</given-names></name></person-group> (<year>2005</year>). <article-title>Measurements of fiber orientation distributions using high angular resolution diffusion imaging</article-title>. <source>Magnet. Reson. Med</source>. <volume>54</volume>, <fpage>1194</fpage>–<lpage>1206</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.20667</pub-id><?supplied-pmid 16161109?><pub-id pub-id-type="pmid">16161109</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Arsigny</surname><given-names>V.</given-names></name><name><surname>Fillard</surname><given-names>P.</given-names></name><name><surname>Pennec</surname><given-names>X.</given-names></name><name><surname>Ayache</surname><given-names>N.</given-names></name></person-group> (<year>2006</year>). <article-title>Log-euclidean metrics for fast and simple calculus on diffusion tensors</article-title>. <source>Magn. Reson. Med</source>. <volume>56</volume>, <fpage>411</fpage>–<lpage>421</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.20965</pub-id><?supplied-pmid 16788917?><pub-id pub-id-type="pmid">16788917</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Assaf</surname><given-names>Y.</given-names></name><name><surname>Blumenfeld-Katzir</surname><given-names>T.</given-names></name><name><surname>Yovel</surname><given-names>Y.</given-names></name><name><surname>Basser</surname><given-names>P. J.</given-names></name></person-group> (<year>2008</year>). <article-title>Axcaliber: a method for measuring axon diameter distribution from diffusion mri</article-title>. <source>Magn. Reson. Med</source>. <volume>59</volume>, <fpage>1347</fpage>–<lpage>1354</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.21577</pub-id><?supplied-pmid 18506799?><pub-id pub-id-type="pmid">18506799</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Basser</surname><given-names>P.</given-names></name><name><surname>Mattiello</surname><given-names>J.</given-names></name><name><surname>LeBihan</surname><given-names>D.</given-names></name></person-group> (<year>1994</year>). <article-title>MR diffusion tensor spectroscopy and imaging</article-title>. <source>Biophys. J</source>. <volume>66</volume>, <fpage>259</fpage>–<lpage>267</lpage>
<pub-id pub-id-type="doi">10.1016/S0006-3495(94)80775-1</pub-id><?supplied-pmid 8130344?><pub-id pub-id-type="pmid">8130344</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Basser</surname><given-names>P. J.</given-names></name><name><surname>Pajevic</surname><given-names>S.</given-names></name><name><surname>Pierpaoli</surname><given-names>C.</given-names></name><name><surname>Duda</surname><given-names>J.</given-names></name><name><surname>Aldroubi</surname><given-names>A.</given-names></name></person-group> (<year>2000</year>). <article-title><italic>In vivo</italic> fiber tractography using DT-MRI data</article-title>. <source>Magn. Reson. Med</source>. <volume>44</volume>, <fpage>625</fpage>–<lpage>632</lpage>
<pub-id pub-id-type="doi">10.1002/1522-2594(200010)44:4&lt;625::AID-MRM17&gt;3.0.CO;2-O</pub-id><?supplied-pmid 11025519?><pub-id pub-id-type="pmid">11025519</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Basser</surname><given-names>P. J.</given-names></name><name><surname>Pierpaoli</surname><given-names>C.</given-names></name></person-group> (<year>1996</year>). <article-title>Microstructural and physiological features of tissues elucidated by quantitative-diffusion-tensor MRI</article-title>. <source>J. Magn. Reson</source>. <volume>213</volume>, <fpage>560</fpage>–<lpage>570</lpage>
<pub-id pub-id-type="doi">10.1016/j.jmr.2011.09.022</pub-id><?supplied-pmid 22152371?><pub-id pub-id-type="pmid">22152371</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beaulieu</surname><given-names>C.</given-names></name></person-group> (<year>2002</year>). <article-title>The basis of anisotropic water diffusion in the nervous system - a technical review</article-title>. <source>NMR Biomed</source>. <volume>15</volume>, <fpage>435</fpage>–<lpage>455</lpage>
<pub-id pub-id-type="doi">10.1002/nbm.782</pub-id><?supplied-pmid 12489094?><pub-id pub-id-type="pmid">12489094</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Beaulieu</surname><given-names>C.</given-names></name><name><surname>Does</surname><given-names>M. D.</given-names></name><name><surname>Snyder</surname><given-names>R. E.</given-names></name><name><surname>Allen</surname><given-names>P. S.</given-names></name></person-group> (<year>1996</year>). <article-title>Changes in water diffusion due to Wallerian degeneration in peripheral nerve</article-title>. <source>Magn. Reson. Med</source>. <volume>36</volume>, <fpage>627</fpage>–<lpage>631</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.1910360419</pub-id><?supplied-pmid 8892217?><pub-id pub-id-type="pmid">8892217</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="book"><person-group person-group-type="editor"><name><surname>Behrens</surname><given-names>T.</given-names></name><name><surname>Johansen-Berg</surname><given-names>H.</given-names></name></person-group> (eds.). (<year>2009</year>). <source>Diffusion MRI</source>. <publisher-name>Elsevier</publisher-name></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ben-Shachar</surname><given-names>M.</given-names></name><name><surname>Dougherty</surname><given-names>R. F.</given-names></name><name><surname>Wandell</surname><given-names>B. A.</given-names></name></person-group> (<year>2007</year>). <article-title>White matter pathways in reading</article-title>. <source>Curr. Opin. Neurobiol</source>. <volume>17</volume>, <fpage>258</fpage>–<lpage>270</lpage>
<pub-id pub-id-type="doi">10.1016/j.conb.2007.03.006</pub-id><?supplied-pmid 17379499?><pub-id pub-id-type="pmid">17379499</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berman</surname><given-names>J.</given-names></name><name><surname>Chung</surname><given-names>S.</given-names></name><name><surname>Mukherjee</surname><given-names>P.</given-names></name><name><surname>Hess</surname><given-names>C.</given-names></name><name><surname>Han</surname><given-names>E.</given-names></name><name><surname>Henry</surname><given-names>R.</given-names></name></person-group> (<year>2008</year>). <article-title>Probabilistic streamline q-ball tractography using the residual bootstrap</article-title>. <source>Neuroimage</source>
<volume>39</volume>, <fpage>215</fpage>–<lpage>222</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2007.08.021</pub-id><?supplied-pmid 17911030?><pub-id pub-id-type="pmid">17911030</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bilgic</surname><given-names>B.</given-names></name><name><surname>Setsompop</surname><given-names>K.</given-names></name><name><surname>Cohen-Adad</surname><given-names>J.</given-names></name><name><surname>Yendiki</surname><given-names>A.</given-names></name><name><surname>Wald</surname><given-names>L.</given-names></name><name><surname>Adalsteinsson</surname><given-names>E.</given-names></name></person-group> (<year>2012</year>). <article-title>Accelerated diffusion spectrum imaging with compressed sensing using adaptive dictionaries</article-title>. <source>Magn. Reson. Med</source>. <volume>68</volume>, <fpage>1747</fpage>–<lpage>1754</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.24505</pub-id><?supplied-pmid 23008145?><pub-id pub-id-type="pmid">23008145</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Callaghan</surname><given-names>P.</given-names></name><name><surname>Eccles</surname><given-names>C.</given-names></name><name><surname>Xia</surname><given-names>Y.</given-names></name></person-group> (<year>1988</year>). <article-title>Rapid communication: NMR microscopy of dynamic displacements: k-space and q-space imaging</article-title>. <source>J. Phys. E Sci. Instrum</source>. <volume>21</volume>, <fpage>820</fpage>–<lpage>822</lpage>
<pub-id pub-id-type="doi">10.1088/0022-3735/21/8/017</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Callaghan</surname><given-names>P. T.</given-names></name></person-group> (<year>1991</year>). <source>Principles of Nuclear Magnetic Resonance Microscopy</source>. <publisher-loc>Oxford</publisher-loc>: <publisher-name>Oxford University Press</publisher-name></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Canales-Rodréiguez</surname><given-names>E. J.</given-names></name><name><surname>Iturria-Medina</surname><given-names>Y.</given-names></name><name><surname>Aleman-Gomez</surname><given-names>Y.</given-names></name><name><surname>Melie-Garcia</surname><given-names>L.</given-names></name></person-group> (<year>2010</year>). <article-title>Deconvolution in diffusion spectrum imaging</article-title>. <source>Neuroimage</source>
<volume>50</volume>, <fpage>136</fpage>–<lpage>149</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2009.11.066</pub-id><?supplied-pmid 19962440?><pub-id pub-id-type="pmid">19962440</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Caruyer</surname><given-names>E.</given-names></name><name><surname>Lenglet</surname><given-names>C.</given-names></name><name><surname>Sapiro</surname><given-names>G.</given-names></name><name><surname>Deriche</surname><given-names>R.</given-names></name></person-group> (<year>2013</year>). <article-title>Design of multishell sampling schemes with uniform coverage in diffusion MRI</article-title>. <source>Magn. Reson. Med</source>. <volume>69</volume>, <fpage>1534</fpage>–<lpage>1540</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.24736</pub-id><?supplied-pmid 23625329?><pub-id pub-id-type="pmid">23625329</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Chamberland</surname><given-names>M.</given-names></name><name><surname>Descoteaux</surname><given-names>M.</given-names></name></person-group> (<year>2013</year>). <article-title>Explore the brain white matter networks in real-time: multi-sticks fiber tracking</article-title>, in <source>The International Society for Magnetic Resonance in Medicine</source> (<publisher-loc>Sherbrooke</publisher-loc>).</mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>L.-C.</given-names></name><name><surname>Jones</surname><given-names>D. K.</given-names></name><name><surname>Pierpaoli</surname><given-names>C.</given-names></name></person-group> (<year>2005</year>). <article-title>RESTORE: robust estimation of tensors by outlier rejection</article-title>. <source>Magn. Reson. Med</source>. <volume>53</volume>, <fpage>1088</fpage>–<lpage>1095</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.20426</pub-id><?supplied-pmid 15844157?><pub-id pub-id-type="pmid">15844157</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>L.-C.</given-names></name><name><surname>Walker</surname><given-names>L.</given-names></name><name><surname>Pierpaoli</surname><given-names>C.</given-names></name></person-group> (<year>2012</year>). <article-title>Informed RESTORE: a method for robust estimation of diffusion tensor from low redundancy datasets in the presence of physiological noise artifacts</article-title>. <source>Magn. Reson. Med</source>. <volume>68</volume>, <fpage>1654</fpage>–<lpage>1663</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.24173</pub-id><?supplied-pmid 22287298?><pub-id pub-id-type="pmid">22287298</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chung</surname><given-names>S.</given-names></name><name><surname>Lu</surname><given-names>Y.</given-names></name><name><surname>Henry</surname><given-names>R. G.</given-names></name></person-group> (<year>2006</year>). <article-title>Comparison of bootstrap approaches for estimation of uncertainties of DTI parameters</article-title>. <source>Neuroimage</source>
<volume>33</volume>, <fpage>531</fpage>–<lpage>541</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2006.07.001</pub-id><?supplied-pmid 16938472?><pub-id pub-id-type="pmid">16938472</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Clayden</surname><given-names>J. D.</given-names></name><name><surname>Maniega</surname><given-names>S. M.</given-names></name><name><surname>Storkey</surname><given-names>A. J.</given-names></name><name><surname>King</surname><given-names>M. D.</given-names></name><name><surname>Bastin</surname><given-names>M. E.</given-names></name><name><surname>Clark</surname><given-names>C. A.</given-names></name></person-group> (<year>2011</year>). <article-title>TractoR: magnetic resonance imaging and tractography with R</article-title>. <source>J. Stat. Softw</source>. <volume>44</volume>, <fpage>1</fpage>–<lpage>18</lpage></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conturo</surname><given-names>T.</given-names></name><name><surname>Lori</surname><given-names>N.</given-names></name><name><surname>Cull</surname><given-names>T.</given-names></name><name><surname>Akbudak</surname><given-names>E.</given-names></name><name><surname>Snyder</surname><given-names>A.</given-names></name><name><surname>Shimony</surname><given-names>J.</given-names></name><etal/></person-group> (<year>1999</year>). <article-title>Tracking neuronal fiber pathways in the living human brain</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A</source>. <volume>96</volume>, <fpage>10422</fpage>–<lpage>10427</lpage>
<pub-id pub-id-type="doi">10.1073/pnas.96.18.10422</pub-id><?supplied-pmid 10468624?><pub-id pub-id-type="pmid">10468624</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cook</surname><given-names>P.</given-names></name><name><surname>Bai</surname><given-names>Y.</given-names></name><name><surname>Nedjati-Gilani</surname><given-names>S.</given-names></name><name><surname>Seunarine</surname><given-names>K.</given-names></name><name><surname>Hall</surname><given-names>M.</given-names></name><name><surname>Parker</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2006</year>). <article-title>Camino: open-source diffusion-MRI reconstruction and processing</article-title>. <source>Int. Soc. Magn. Reson. Med</source>. <volume>14</volume>, <fpage>2759</fpage></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Côté</surname><given-names>M.-A.</given-names></name><name><surname>Girard</surname><given-names>G.</given-names></name><name><surname>Boré</surname><given-names>A.</given-names></name><name><surname>Garyfallidis</surname><given-names>E.</given-names></name><name><surname>Houde</surname><given-names>J.-C.</given-names></name><name><surname>Descoteaux</surname><given-names>M.</given-names></name></person-group> (<year>2013</year>). <article-title>Tractometer: towards validation of tractography pipelines</article-title>. <source>Med. Image Anal</source>. <volume>17</volume>, <fpage>844</fpage>–<lpage>857</lpage>
<pub-id pub-id-type="doi">10.1016/j.media.2013.03.009</pub-id><?supplied-pmid 23706753?><pub-id pub-id-type="pmid">23706753</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cox</surname><given-names>R. W.</given-names></name></person-group> (<year>2012</year>). <article-title>AFNI: what a long strange trip it's been</article-title>. <source>Neuroimage</source>
<volume>62</volume>, <fpage>743</fpage>–<lpage>747</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2011.08.056</pub-id><?supplied-pmid 21889996?><pub-id pub-id-type="pmid">21889996</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Daducci</surname><given-names>A.</given-names></name><name><surname>Gerhard</surname><given-names>S.</given-names></name><name><surname>Griffa</surname><given-names>A.</given-names></name><name><surname>Lemkaddem</surname><given-names>A.</given-names></name><name><surname>Cammoun</surname><given-names>L.</given-names></name><name><surname>Gigandet</surname><given-names>X.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>The connectome mapper: an open-source processing pipeline to map connectomes with MRI</article-title>. <source>PLoS ONE</source>
<volume>7</volume>:<fpage>e48121</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0048121</pub-id><?supplied-pmid 23272041?><pub-id pub-id-type="pmid">23272041</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Descoteaux</surname><given-names>M.</given-names></name></person-group> (<year>2008</year>). <source>“High Angular Resolution Diffusion MRI: From Local Estimation to Segmentation and Tractography.”</source> Ph.D. thesis, <publisher-name>Université de Nice-Sophia Antipolis</publisher-name></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Descoteaux</surname><given-names>M.</given-names></name><name><surname>Angelino</surname><given-names>E.</given-names></name><name><surname>Fitzgibbons</surname><given-names>S.</given-names></name><name><surname>Deriche</surname><given-names>R.</given-names></name></person-group> (<year>2006</year>). <article-title>Apparent diffusion coefficients from high angular resolution diffusion imaging: estimation and applications</article-title>. <source>Magn. Reson. Med</source>. <volume>56</volume>, <fpage>395</fpage>–<lpage>410</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.20948</pub-id><?supplied-pmid 16802316?><pub-id pub-id-type="pmid">16802316</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Descoteaux</surname><given-names>M.</given-names></name><name><surname>Angelino</surname><given-names>E.</given-names></name><name><surname>Fitzgibbons</surname><given-names>S.</given-names></name><name><surname>Deriche</surname><given-names>R.</given-names></name></person-group> (<year>2007</year>). <article-title>Regularized, fast, and robust analytical q-ball imaging</article-title>. <source>Magn. Reson. Med</source>. <volume>58</volume>, <fpage>497</fpage>–<lpage>510</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.21277</pub-id><?supplied-pmid 17763358?><pub-id pub-id-type="pmid">17763358</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Descoteaux</surname><given-names>M.</given-names></name><name><surname>Deriche</surname><given-names>R.</given-names></name><name><surname>Bihan</surname><given-names>D. L.</given-names></name><name><surname>Mangin</surname><given-names>J.-F.</given-names></name><name><surname>Poupon</surname><given-names>C.</given-names></name></person-group> (<year>2011</year>). <article-title>Multiple q-shell diffusion propagator imaging</article-title>. <source>Med. Image Anal</source>. <volume>15</volume>, <fpage>603</fpage>–<lpage>621</lpage>
<pub-id pub-id-type="doi">10.1016/j.media.2010.07.001</pub-id><?supplied-pmid 20685153?><pub-id pub-id-type="pmid">20685153</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Descoteaux</surname><given-names>M.</given-names></name><name><surname>Deriche</surname><given-names>R.</given-names></name><name><surname>Knösche</surname><given-names>T. R.</given-names></name><name><surname>Anwander</surname><given-names>A.</given-names></name></person-group> (<year>2009</year>). <article-title>Deterministic and probabilistic tractography based on complex fibre orientation distributions</article-title>. <source>IEEE Trans. Med. Imaging</source>
<volume>28</volume>, <fpage>269</fpage>–<lpage>286</lpage>
<pub-id pub-id-type="doi">10.1109/TMI.2008.2004424</pub-id><?supplied-pmid 19188114?><pub-id pub-id-type="pmid">19188114</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donoho</surname><given-names>D. L.</given-names></name></person-group> (<year>2010</year>). <article-title>An invitation to reproducible computational research</article-title>. <source>Biostatistics</source>
<volume>11</volume>, <fpage>385</fpage>–<lpage>388</lpage>
<pub-id pub-id-type="doi">10.1093/biostatistics/kxq028</pub-id><?supplied-pmid 20538873?><pub-id pub-id-type="pmid">20538873</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ennis</surname><given-names>D. B.</given-names></name><name><surname>Kindlmann</surname><given-names>G.</given-names></name></person-group> (<year>2006</year>). <article-title>Orthogonal tensor invariants and the analysis of diffusion tensor magnetic resonance images</article-title>. <source>Magn. Reson. Med</source>. <volume>55</volume>, <fpage>136</fpage>–<lpage>146</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.20741</pub-id><?supplied-pmid 16342267?><pub-id pub-id-type="pmid">16342267</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fischl</surname><given-names>B.</given-names></name></person-group> (<year>2012</year>). <article-title>Freesurfer</article-title>. <source>Neuroimage</source>
<volume>62</volume>, <fpage>774</fpage>–<lpage>781</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.01.021</pub-id><?supplied-pmid 22248573?><pub-id pub-id-type="pmid">22248573</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fortin</surname><given-names>D.</given-names></name><name><surname>Aubin-lemay</surname><given-names>C.</given-names></name><name><surname>Boré</surname><given-names>A.</given-names></name><name><surname>Girard</surname><given-names>G.</given-names></name><name><surname>Houde</surname><given-names>J.-C.</given-names></name><name><surname>Whittingstall</surname><given-names>K.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>Tractography in the study of the human brain: a neurosurgical perspective</article-title>. <source>Can. J. Neurol. Sci</source>. <volume>39</volume>, <fpage>747</fpage>–<lpage>756</lpage>
<?supplied-pmid 23230612?><pub-id pub-id-type="pmid">23230612</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>L. R.</given-names></name></person-group> (<year>2001</year>). <article-title>Anisotropy in high angular resolution diffusion-weighted MRI</article-title>. <source>Magn. Reson. Med</source>. <volume>45</volume>, <fpage>935</fpage>–<lpage>939</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.1125</pub-id><?supplied-pmid 11378869?><pub-id pub-id-type="pmid">11378869</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frank</surname><given-names>L. R.</given-names></name></person-group> (<year>2002</year>). <article-title>Characterization of anisotropy in high angular resolution diffusion-weighted MRI</article-title>. <source>Magn. Reson. Med</source>. <volume>47</volume>, <fpage>1083</fpage>–<lpage>1099</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.10156</pub-id><?supplied-pmid 12111955?><pub-id pub-id-type="pmid">12111955</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fritzsche</surname><given-names>K.</given-names></name><name><surname>Neher</surname><given-names>P.</given-names></name><name><surname>Reicht</surname><given-names>I.</given-names></name><name><surname>van Bruggen</surname><given-names>T.</given-names></name><name><surname>Goch</surname><given-names>C.</given-names></name><name><surname>Reisert</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>MITK diffusion imaging</article-title>. <source>Methods Inform. Med</source>. <volume>51</volume>, <fpage>441</fpage>
<pub-id pub-id-type="doi">10.3414/ME11-02-0031</pub-id><?supplied-pmid 23038239?><pub-id pub-id-type="pmid">23038239</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Garyfallidis</surname><given-names>E.</given-names></name></person-group> (<year>2012</year>). <source>Towards an Accurate Brain Tractography</source>. Ph.D. thesis, <publisher-name>University of Cambridge</publisher-name>, <publisher-loc>Cambridge</publisher-loc></mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Garyfallidis</surname><given-names>E.</given-names></name><name><surname>Brett</surname><given-names>M.</given-names></name><name><surname>Amirbekian</surname><given-names>B.</given-names></name><name><surname>Nguyen</surname><given-names>C.</given-names></name><name><surname>Yeh</surname><given-names>F.</given-names></name><name><surname>Halchenko</surname><given-names>Y.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>Dipy - a novel software library for diffusion MR and tractography</article-title>, in <source>17th Annual Meeting of the Organization for Human Brain Mapping</source> (<publisher-loc>Cambridge</publisher-loc>).</mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Garyfallidis</surname><given-names>E.</given-names></name><name><surname>Brett</surname><given-names>M.</given-names></name><name><surname>Correia</surname><given-names>M. M.</given-names></name><name><surname>Williams</surname><given-names>G. B.</given-names></name><name><surname>Nimmo-Smith</surname><given-names>I.</given-names></name></person-group> (<year>2012</year>). <article-title>QuickBundles, a method for tractography simplification</article-title>. <source>Front. Neurosci</source>. <volume>6</volume>:<issue>175</issue>
<pub-id pub-id-type="doi">10.3389/fnins.2012.00175</pub-id><?supplied-pmid 23248578?><pub-id pub-id-type="pmid">23248578</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Garyfallidis</surname><given-names>E.</given-names></name><name><surname>St-Jean</surname><given-names>S.</given-names></name><name><surname>Paquette</surname><given-names>M.</given-names></name><name><surname>Coupé</surname><given-names>P.</given-names></name><name><surname>Descoteaux</surname><given-names>M.</given-names></name></person-group> (<year>2013</year>). <article-title>Constrained spherical deconvolution on signal and ODF values</article-title>, in <source>ISBI HARDI reconstruction challenge 2013</source> (<publisher-loc>San Francisco, CA</publisher-loc>).</mixed-citation>
    </ref>
    <ref id="B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goebel</surname><given-names>R.</given-names></name></person-group> (<year>2012</year>). <article-title>Brainvoyager past, present, future</article-title>. <source>Neuroimage</source>
<volume>62</volume>, <fpage>748</fpage>–<lpage>756</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.01.083</pub-id><?supplied-pmid 22289803?><pub-id pub-id-type="pmid">22289803</pub-id></mixed-citation>
    </ref>
    <ref id="B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gorgolewski</surname><given-names>K.</given-names></name><name><surname>Burns</surname><given-names>C.</given-names></name><name><surname>Madison</surname><given-names>C.</given-names></name><name><surname>Clark</surname><given-names>D.</given-names></name><name><surname>Halchenko</surname><given-names>Y.</given-names></name><name><surname>Waskom</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>Nipype: a flexible, lightweight and extensible neuroimaging data processing framework in python</article-title>. <source>Front. Neuroinform</source>. <volume>5</volume>:<issue>13</issue>
<pub-id pub-id-type="doi">10.3389/fninf.2011.00013</pub-id><?supplied-pmid 21897815?><pub-id pub-id-type="pmid">21897815</pub-id></mixed-citation>
    </ref>
    <ref id="B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gramfort</surname><given-names>A.</given-names></name><name><surname>Poupon</surname><given-names>C.</given-names></name><name><surname>Descoteaux</surname><given-names>M.</given-names></name></person-group> (<year>2013</year>). <article-title>Denoising and fast diffusion imaging with physically constrained sparse dictionary learning</article-title>. <source>Med. Image Anal</source>. <volume>18</volume>, <fpage>36-49</fpage>
<pub-id pub-id-type="doi">10.1016/j.media.2013.08.006</pub-id><?supplied-pmid 24084469?><pub-id pub-id-type="pmid">24084469</pub-id></mixed-citation>
    </ref>
    <ref id="B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Halchenko</surname><given-names>Y. O.</given-names></name><name><surname>Hanke</surname><given-names>M.</given-names></name></person-group> (<year>2012</year>). <article-title>Open is not enough. letŠs take the next step: an integrated, community-driven computing platform for neuroscience</article-title>. <source>Front. Neuroinform</source>. <volume>6</volume>:<issue>22</issue>
<pub-id pub-id-type="doi">10.3389/fninf.2012.00022</pub-id><?supplied-pmid 23055966?><pub-id pub-id-type="pmid">23055966</pub-id></mixed-citation>
    </ref>
    <ref id="B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hess</surname><given-names>C.</given-names></name><name><surname>Mukherjee</surname><given-names>P.</given-names></name><name><surname>Han</surname><given-names>E.</given-names></name><name><surname>Xu</surname><given-names>D.</given-names></name><name><surname>Vigneron</surname><given-names>D.</given-names></name></person-group> (<year>2006</year>). <article-title>Q-ball reconstruction of multimodal fiber orientations using the spherical harmonic basis</article-title>. <source>Magn. Reson. Med</source>. <volume>56</volume>, <fpage>104</fpage>–<lpage>117</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.20931</pub-id><?supplied-pmid 16755539?><pub-id pub-id-type="pmid">16755539</pub-id></mixed-citation>
    </ref>
    <ref id="B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeurissen</surname><given-names>B.</given-names></name><name><surname>Leemans</surname><given-names>A.</given-names></name><name><surname>Jones</surname><given-names>D. K.</given-names></name><name><surname>Tournier</surname><given-names>J.-D.</given-names></name><name><surname>Sijbers</surname><given-names>J.</given-names></name></person-group> (<year>2011</year>). <article-title>Probabilistic fiber tracking using the residual bootstrap with constrained spherical deconvolution</article-title>. <source>Hum. Brain Mapp</source>. <volume>32</volume>, <fpage>461</fpage>–<lpage>479</lpage>
<pub-id pub-id-type="doi">10.1002/hbm.21032</pub-id><?supplied-pmid 21319270?><pub-id pub-id-type="pmid">21319270</pub-id></mixed-citation>
    </ref>
    <ref id="B51">
      <mixed-citation publication-type="book"><person-group person-group-type="editor"><name><surname>Jones</surname><given-names>D.</given-names></name></person-group> (ed.). (<year>2010</year>). <source>Diffusion MRI: Theory, Methods And Applications</source>. <publisher-loc>Oxford, NY</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>
<pub-id pub-id-type="doi">10.1093/med/9780195369779.001.0001</pub-id></mixed-citation>
    </ref>
    <ref id="B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>D. K.</given-names></name><name><surname>Horsfield</surname><given-names>M. A.</given-names></name><name><surname>Simmons</surname><given-names>A.</given-names></name></person-group> (<year>1999</year>). <article-title>Optimal strategies for measuring diffusion in anisotropic systems by magnetic resonance imaging</article-title>. <source>Magn. Reson. Med</source>. <volume>42</volume>, <fpage>515</fpage>–<lpage>525</lpage>
<pub-id pub-id-type="doi">10.1002/(SICI)1522-2594(199909)42:3&lt;515::AID-MRM14&gt;3.3.CO;2-H</pub-id><?supplied-pmid 10467296?><pub-id pub-id-type="pmid">10467296</pub-id></mixed-citation>
    </ref>
    <ref id="B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jones</surname><given-names>D. K.</given-names></name><name><surname>Knösche</surname><given-names>T. R.</given-names></name><name><surname>Turner</surname><given-names>R.</given-names></name></person-group> (<year>2013</year>). <article-title>White matter integrity, fiber count, and other fallacies: the do's and don'ts of diffusion MRI</article-title>. <source>Neuroimage</source>
<volume>73</volume>, <fpage>239</fpage>–<lpage>254</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.06.081</pub-id><?supplied-pmid 22846632?><pub-id pub-id-type="pmid">22846632</pub-id></mixed-citation>
    </ref>
    <ref id="B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koay</surname><given-names>C. G.</given-names></name><name><surname>Chang</surname><given-names>L.-C.</given-names></name><name><surname>Carew</surname><given-names>J. D.</given-names></name><name><surname>Pierpaoli</surname><given-names>C.</given-names></name><name><surname>Basser</surname><given-names>P. J.</given-names></name></person-group> (<year>2006</year>). <article-title>A unifying theoretical and algorithmic framework for least squares methods of estimation in diffusion tensor imaging</article-title>. <source>J. Magn. Reson</source>. <volume>182</volume>, <fpage>115</fpage>–<lpage>125</lpage>
<pub-id pub-id-type="doi">10.1016/j.jmr.2006.06.020</pub-id><?supplied-pmid 16828568?><pub-id pub-id-type="pmid">16828568</pub-id></mixed-citation>
    </ref>
    <ref id="B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>LeBihan</surname><given-names>D.</given-names></name><name><surname>Breton</surname><given-names>E.</given-names></name></person-group> (<year>1985</year>). <article-title>Imagerie de diffusion <italic>in vivo</italic> par résonance magnétique nucléaire</article-title>. <source>C. R. Acad. Sci. Paris</source>
<volume>301</volume>, <fpage>1109</fpage>–<lpage>1112</lpage></mixed-citation>
    </ref>
    <ref id="B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leemans</surname><given-names>A.</given-names></name><name><surname>Jeurissen</surname><given-names>B.</given-names></name><name><surname>Sijbers</surname><given-names>J.</given-names></name><name><surname>Jones</surname><given-names>D.</given-names></name></person-group> (<year>2009</year>). <article-title>ExploreDTI: a graphical toolbox for processing, analyzing, and visualizing diffusion MR data</article-title>. <source>Proc. Int. Soc. Magn. Reson. Med</source>. <volume>17</volume>, <fpage>3537</fpage></mixed-citation>
    </ref>
    <ref id="B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lenglet</surname><given-names>C.</given-names></name><name><surname>Rousson</surname><given-names>M.</given-names></name><name><surname>Deriche</surname><given-names>R.</given-names></name><name><surname>Faugeras</surname><given-names>O.</given-names></name></person-group> (<year>2006</year>). <article-title>Statistics on the manifold of multivariate normal distributions: theory and application to diffusion tensor mri processing</article-title>. <source>J. Math. Imaging Vis</source>. <volume>25</volume>, <fpage>423</fpage>–<lpage>444</lpage>
<pub-id pub-id-type="doi">10.1007/s10851-006-6897-z</pub-id></mixed-citation>
    </ref>
    <ref id="B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Maas</surname><given-names>L. C.</given-names></name><name><surname>Mukherjee</surname><given-names>P.</given-names></name></person-group> (<year>2005</year>). <article-title>Diffusion MRI: overview and clinical applications in neuroradiology</article-title>. <source>Appl. Radiol</source>. <volume>34</volume>, <fpage>44</fpage>–<lpage>60</lpage>
<?supplied-pmid 16649199?><pub-id pub-id-type="pmid">16649199</pub-id></mixed-citation>
    </ref>
    <ref id="B59">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Maximilien</surname><given-names>E. M.</given-names></name><name><surname>Williams</surname><given-names>L.</given-names></name></person-group> (<year>2013</year>). <article-title>Assessing test-driven development at IBM</article-title>, in <source>Proceedings of the 25th International Conference on Software Engineering, 2003</source>, <volume>Vol. 6</volume> (<publisher-loc>Washington, DC</publisher-loc>). <pub-id pub-id-type="doi">10.1109/ICSE.2003.1201238</pub-id></mixed-citation>
    </ref>
    <ref id="B60">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>McKinney</surname><given-names>W.</given-names></name></person-group> (<year>2012</year>). <source>Python for Data Analysis</source>. <publisher-loc>Sebastopol, CA</publisher-loc>: <publisher-name>O'Reilly Media, Incorporated</publisher-name></mixed-citation>
    </ref>
    <ref id="B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Menzel</surname><given-names>M.</given-names></name><name><surname>Tan</surname><given-names>E.</given-names></name><name><surname>Khare</surname><given-names>K.</given-names></name><name><surname>Sperl</surname><given-names>J.</given-names></name><name><surname>King</surname><given-names>K.</given-names></name><name><surname>Tao</surname><given-names>X.</given-names></name><etal/></person-group> (<year>2011</year>). <article-title>Accelerated diffusion spectrum imaging in the human brain using compressed sensing</article-title>. <source>Magn. Reson. Med</source>. <volume>66</volume>, <fpage>1226</fpage>–<lpage>1233</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.23064</pub-id><?supplied-pmid 22012686?><pub-id pub-id-type="pmid">22012686</pub-id></mixed-citation>
    </ref>
    <ref id="B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Merboldt</surname><given-names>K.</given-names></name><name><surname>Hanicke</surname><given-names>W.</given-names></name><name><surname>Frahm</surname><given-names>J.</given-names></name></person-group> (<year>1985</year>). <article-title>Self-diffusion NMR imaging using stimulated echoes</article-title>. <source>J. Magn. Reson</source>. <volume>64</volume>, <fpage>479</fpage>–<lpage>486</lpage></mixed-citation>
    </ref>
    <ref id="B63">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mori</surname><given-names>S.</given-names></name><name><surname>Crain</surname><given-names>B. J.</given-names></name><name><surname>Chacko</surname><given-names>V. P.</given-names></name><name><surname>Van Zijl</surname><given-names>P. C. M.</given-names></name></person-group> (<year>1999</year>). <article-title>Three-dimensional tracking of axonal projections in the brain by magnetic resonance imaging</article-title>. <source>Annal. Neurol</source>. <volume>45</volume>, <fpage>265</fpage>–<lpage>269</lpage>
<pub-id pub-id-type="doi">10.1002/1531-8249(199902)45:2&lt;265::AID-ANA21&gt;3.0.CO;2-3</pub-id><?supplied-pmid 9989633?><pub-id pub-id-type="pmid">9989633</pub-id></mixed-citation>
    </ref>
    <ref id="B64">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Mori</surname><given-names>S.</given-names></name><name><surname>Wakana</surname><given-names>S.</given-names></name><name><surname>Nagae-Poetscher</surname><given-names>L. M.</given-names></name><name><surname>van Zijl</surname><given-names>P. C. M.</given-names></name></person-group> (<year>2005</year>). <source>MRI Atlas of Human White Matter</source>. <publisher-loc>Amsterdam</publisher-loc>: <publisher-name>Elsevier</publisher-name></mixed-citation>
    </ref>
    <ref id="B65">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morris</surname><given-names>D. M.</given-names></name><name><surname>Embleton</surname><given-names>K. V.</given-names></name><name><surname>Parker</surname><given-names>G. J.</given-names></name></person-group> (<year>2008</year>). <article-title>Probabilistic fibre tracking: differentiation of connections from chance events</article-title>. <source>Neuroimage</source>
<volume>42</volume>, <fpage>1329</fpage>–<lpage>1339</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2008.06.012</pub-id><?supplied-pmid 18619548?><pub-id pub-id-type="pmid">18619548</pub-id></mixed-citation>
    </ref>
    <ref id="B66">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Numano</surname><given-names>T.</given-names></name><name><surname>Homma</surname><given-names>K.</given-names></name><name><surname>Iwasaki</surname><given-names>N.</given-names></name><name><surname>Hyodo</surname><given-names>K.</given-names></name><name><surname>Nitta</surname><given-names>N.</given-names></name><name><surname>Hirose</surname><given-names>T.</given-names></name></person-group> (<year>2006</year>). <article-title><italic>In vivo</italic> isotropic 3d diffusion tensor mapping of the rat brain using diffusion-weighted 3d mp-rage MRI</article-title>. <source>Magn. Reson. Imaging</source>
<volume>24</volume>, <fpage>287</fpage>–<lpage>293</lpage>
<pub-id pub-id-type="doi">10.1016/j.mri.2005.12.011</pub-id><?supplied-pmid 16563958?><pub-id pub-id-type="pmid">16563958</pub-id></mixed-citation>
    </ref>
    <ref id="B67">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Otsu</surname><given-names>N.</given-names></name></person-group> (<year>1979</year>). <article-title>Threshold selection method from gray-level histograms</article-title>. <source>IEEE Trans. Syst. Man Cybern</source>. SMC-9, <fpage>62</fpage>–<lpage>66</lpage>
<pub-id pub-id-type="doi">10.1109/TSMC.1979.4310076</pub-id></mixed-citation>
    </ref>
    <ref id="B68">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Özarslan</surname><given-names>E.</given-names></name><name><surname>Koay</surname><given-names>C. G.</given-names></name><name><surname>Shepherd</surname><given-names>T. M.</given-names></name><name><surname>Komlosh</surname><given-names>M. E.</given-names></name><name><surname>İrfanoğlu</surname><given-names>M. O.</given-names></name><name><surname>Pierpaoli</surname><given-names>C.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>Mean apparent propagator (map) mri: a novel diffusion imaging method for mapping tissue microstructure</article-title>. <source>Neuroimage</source>
<volume>78</volume>, <fpage>16</fpage>–<lpage>32</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.04.016</pub-id><?supplied-pmid 23587694?><pub-id pub-id-type="pmid">23587694</pub-id></mixed-citation>
    </ref>
    <ref id="B69">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pajevic</surname><given-names>S.</given-names></name><name><surname>Pierpaoli</surname><given-names>C.</given-names></name></person-group> (<year>1999</year>). <article-title>Color schemes to represent the orientation of anisotropic tissues from diffusion tensor data: application to white matter fiber tract mapping in the human brain</article-title>. <source>Magn. Reson. Med</source>. <volume>42</volume>, <fpage>526</fpage>–<lpage>540</lpage>
<pub-id pub-id-type="doi">10.1002/(SICI)1522-2594(199909)42:3&lt;526::AID-MRM15&gt;3.3.CO;2-A</pub-id><?supplied-pmid 10467297?><pub-id pub-id-type="pmid">10467297</pub-id></mixed-citation>
    </ref>
    <ref id="B70">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pérez</surname><given-names>F.</given-names></name><name><surname>Granger</surname><given-names>B. E.</given-names></name></person-group> (<year>2007</year>). <article-title>Ipython: a system for interactive scientific computing</article-title>. <source>Comput. Sci. Eng</source>. <volume>9</volume>, <fpage>21</fpage>–<lpage>29</lpage>
<pub-id pub-id-type="doi">10.1109/MCSE.2007.53</pub-id></mixed-citation>
    </ref>
    <ref id="B71">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pérez</surname><given-names>F.</given-names></name><name><surname>Granger</surname><given-names>B. E.</given-names></name><name><surname>Hunter</surname><given-names>J. D.</given-names></name></person-group> (<year>2011</year>). <article-title>Python: an ecosystem for scientific computing</article-title>. <source>Comput. Sci. Eng</source>. <volume>13</volume>, <fpage>13</fpage>–<lpage>21</lpage>
<pub-id pub-id-type="doi">10.1109/MCSE.2010.119</pub-id></mixed-citation>
    </ref>
    <ref id="B72">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pieper</surname><given-names>S.</given-names></name><name><surname>Lorensen</surname><given-names>B.</given-names></name><name><surname>Schroeder</surname><given-names>W.</given-names></name><name><surname>Kikinis</surname><given-names>R.</given-names></name></person-group> (<year>2006</year>). <article-title>The NA-MIC Kit: ITK, VTK, pipelines, grids and 3D slicer as an open platform for the medical image computing community</article-title>, in <source>3rd IEEE International Symposium on Biomedical Imaging: Nano to Macro, 2006</source> (<publisher-loc>Arlington, VA</publisher-loc>: <publisher-name>IEEE</publisher-name>), <fpage>698</fpage>–<lpage>701</lpage>
<pub-id pub-id-type="doi">10.1109/ISBI.2006.1625012</pub-id></mixed-citation>
    </ref>
    <ref id="B73">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pierpaoli</surname><given-names>C.</given-names></name><name><surname>Jezzard</surname><given-names>P.</given-names></name><name><surname>Basser</surname><given-names>P.</given-names></name><name><surname>Barnett</surname><given-names>A.</given-names></name><name><surname>Chiro</surname><given-names>G. D.</given-names></name></person-group> (<year>1996</year>). <article-title>Diffusion Tensor MR imaging of human brain</article-title>. <source>Radiology</source>
<volume>201</volume>, <fpage>637</fpage>–<lpage>648</lpage>
<?supplied-pmid 8939209?><pub-id pub-id-type="pmid">8939209</pub-id></mixed-citation>
    </ref>
    <ref id="B74">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schroeder</surname><given-names>W. J.</given-names></name><name><surname>Avila</surname><given-names>L. S.</given-names></name><name><surname>Martin</surname><given-names>K. M.</given-names></name><name><surname>Hoffman</surname><given-names>W. A.</given-names></name><name><surname>Law</surname><given-names>C. C.</given-names></name></person-group> (<year>2001</year>). <source>The Visualization Toolkit-User's Guide</source>. <publisher-loc>Clifton Park, NY</publisher-loc>: <publisher-name>Kitware, Inc</publisher-name></mixed-citation>
    </ref>
    <ref id="B75">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Setsompop</surname><given-names>K.</given-names></name><name><surname>Cohen-Adad</surname><given-names>J.</given-names></name><name><surname>Gagoski</surname><given-names>B.</given-names></name><name><surname>Raij</surname><given-names>T.</given-names></name><name><surname>Yendiki</surname><given-names>A.</given-names></name><name><surname>Keil</surname><given-names>B.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>Improving diffusion mri using simultaneous multi-slice echo planar imaging</article-title>. <source>Neuroimage</source>
<volume>63</volume>, <fpage>569</fpage>–<lpage>580</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.06.033</pub-id><?supplied-pmid 22732564?><pub-id pub-id-type="pmid">22732564</pub-id></mixed-citation>
    </ref>
    <ref id="B76">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sherbondy</surname><given-names>A.</given-names></name><name><surname>Akers</surname><given-names>D.</given-names></name><name><surname>Mackenzie</surname><given-names>R.</given-names></name><name><surname>Dougherty</surname><given-names>R.</given-names></name><name><surname>Wandell</surname><given-names>B.</given-names></name></person-group> (<year>2005</year>). <article-title>Exploring connectivity of the brain's white matter with dynamic queries</article-title>. <source>IEEE Trans. Vis. Comput. Graph</source>. <volume>11</volume>, <fpage>419</fpage>–<lpage>430</lpage>
<pub-id pub-id-type="doi">10.1109/TVCG.2005.59</pub-id><?supplied-pmid 16138552?><pub-id pub-id-type="pmid">16138552</pub-id></mixed-citation>
    </ref>
    <ref id="B77">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Smith</surname><given-names>S. M.</given-names></name><name><surname>Jenkinson</surname><given-names>M.</given-names></name><name><surname>Woolrich</surname><given-names>M. W.</given-names></name><name><surname>Beckmann</surname><given-names>C. F.</given-names></name><name><surname>Behrens</surname><given-names>T.</given-names></name><name><surname>Johansen-Berg</surname><given-names>H.</given-names></name><etal/></person-group> (<year>2004</year>). <article-title>Advances in functional and structural MR image analysis and implementation as FSL</article-title>. <source>Neuroimage</source>
<volume>23</volume>, <fpage>S208</fpage>–<lpage>S219</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2004.07.051</pub-id><?supplied-pmid 15501092?><pub-id pub-id-type="pmid">15501092</pub-id></mixed-citation>
    </ref>
    <ref id="B78">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>S.-K.</given-names></name><name><surname>Sun</surname><given-names>S.-W.</given-names></name><name><surname>Ramsbottom</surname><given-names>M. J.</given-names></name><name><surname>Chang</surname><given-names>C.</given-names></name><name><surname>Russell</surname><given-names>J.</given-names></name><name><surname>Cross</surname><given-names>A. H.</given-names></name></person-group> (<year>2002</year>). <article-title>Dysmyelination revealed through MRI as increased radial (but unchanged axial) diffusion of water</article-title>. <source>Neuroimage</source>
<volume>17</volume>, <fpage>1429</fpage>–<lpage>1436</lpage>
<pub-id pub-id-type="doi">10.1006/nimg.2002.1267</pub-id><?supplied-pmid 12414282?><pub-id pub-id-type="pmid">12414282</pub-id></mixed-citation>
    </ref>
    <ref id="B79">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sporns</surname><given-names>O.</given-names></name><name><surname>Tononi</surname><given-names>G.</given-names></name><name><surname>Kötter</surname><given-names>R.</given-names></name></person-group> (<year>2005</year>). <article-title>The human connectome: a structural description of the human brain</article-title>. <source>PLoS Comput. Biol</source>. <volume>1</volume>:<fpage>e42</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pcbi.0010042</pub-id><?supplied-pmid 16201007?><pub-id pub-id-type="pmid">16201007</pub-id></mixed-citation>
    </ref>
    <ref id="B80">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Taylor</surname><given-names>D.</given-names></name><name><surname>Bushell</surname><given-names>M.</given-names></name></person-group> (<year>1985</year>). <article-title>The spatial mapping of translational diffusion coefficients by the nmr imaging technique</article-title>. <source>Phys. Med. Biol</source>. <volume>30</volume>, <fpage>345</fpage>–<lpage>349</lpage>
<pub-id pub-id-type="doi">10.1088/0031-9155/30/4/009</pub-id><?supplied-pmid 4001161?><pub-id pub-id-type="pmid">4001161</pub-id></mixed-citation>
    </ref>
    <ref id="B81">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Thomason</surname><given-names>M. E.</given-names></name><name><surname>Thompson</surname><given-names>P. M.</given-names></name></person-group> (<year>2011</year>). <article-title>Diffusion imaging, white matter, and psychopathology</article-title>. <source>Annu. Rev. Clin. Psychol</source>. <volume>7</volume>, <fpage>63</fpage>–<lpage>85</lpage>
<pub-id pub-id-type="doi">10.1146/annurev-clinpsy-032210-104507</pub-id><?supplied-pmid 21219189?><pub-id pub-id-type="pmid">21219189</pub-id></mixed-citation>
    </ref>
    <ref id="B82">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tournier</surname><given-names>J.-D.</given-names></name><name><surname>Calamante</surname><given-names>F.</given-names></name><name><surname>Connelly</surname><given-names>A.</given-names></name></person-group> (<year>2007</year>). <article-title>Robust determination of the fibre orientation distribution in diffusion mri: non-negativity constrained super-resolved spherical deconvolution</article-title>. <source>Neuroimage</source>
<volume>35</volume>, <fpage>1459</fpage>–<lpage>1472</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2007.02.016</pub-id><?supplied-pmid 17379540?><pub-id pub-id-type="pmid">17379540</pub-id></mixed-citation>
    </ref>
    <ref id="B83">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tournier</surname><given-names>J.-D.</given-names></name><name><surname>Calamante</surname><given-names>F.</given-names></name><name><surname>Connelly</surname><given-names>A.</given-names></name></person-group> (<year>2012</year>). <article-title>MRtrix: diffusion tractography in crossing fiber regions</article-title>. <source>Int. J. Imaging Syst. Technol</source>. <volume>22</volume>, <fpage>53</fpage>–<lpage>66</lpage>
<pub-id pub-id-type="doi">10.1002/ima.22005</pub-id><?supplied-pmid 21182970?><pub-id pub-id-type="pmid">21182970</pub-id></mixed-citation>
    </ref>
    <ref id="B84">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tournier</surname><given-names>J.-D.</given-names></name><name><surname>Calamante</surname><given-names>F.</given-names></name><name><surname>Gadian</surname><given-names>D.</given-names></name><name><surname>Connelly</surname><given-names>A.</given-names></name></person-group> (<year>2004</year>). <article-title>Direct estimation of the fiber orientation density function from diffusion-weighted MRI data using spherical deconvolution</article-title>. <source>Neuroimage</source>
<volume>23</volume>, <fpage>1176</fpage>–<lpage>1185</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2004.07.037</pub-id><?supplied-pmid 15528117?><pub-id pub-id-type="pmid">15528117</pub-id></mixed-citation>
    </ref>
    <ref id="B85">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Toussaint</surname><given-names>N.</given-names></name><name><surname>Souplet</surname><given-names>J.</given-names></name><name><surname>Fillard</surname><given-names>P.</given-names></name></person-group> (<year>2007</year>). <article-title>MedINRIA: medical image navigation and research tool by INRIA</article-title>, in <source>MICCAI'07 Workshop on Interaction in medical image analysis and visualization</source> (<publisher-loc>Brisbane, Australia</publisher-loc>).</mixed-citation>
    </ref>
    <ref id="B86">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tristan-Vega</surname><given-names>A.</given-names></name><name><surname>Westin</surname><given-names>C.-F.</given-names></name><name><surname>Aja-Fernandez</surname><given-names>S.</given-names></name></person-group> (<year>2009</year>). <article-title>Estimation of fiber orientation probability density functions in high angular resolution diffusion imaging</article-title>. <source>Neuroimage</source>
<volume>47</volume>, <fpage>638</fpage>–<lpage>650</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2009.04.049</pub-id><?supplied-pmid 19393321?><pub-id pub-id-type="pmid">19393321</pub-id></mixed-citation>
    </ref>
    <ref id="B87">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tuch</surname><given-names>D.</given-names></name></person-group> (<year>2004</year>). <article-title>Q-ball imaging</article-title>. <source>Magn. Reson. Med</source>. <volume>52</volume>, <fpage>1358</fpage>–<lpage>1372</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.20279</pub-id><?supplied-pmid 15562495?><pub-id pub-id-type="pmid">15562495</pub-id></mixed-citation>
    </ref>
    <ref id="B88">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tuch</surname><given-names>D.</given-names></name><name><surname>Reese</surname><given-names>T.</given-names></name><name><surname>Wiegell</surname><given-names>M.</given-names></name><name><surname>Makris</surname><given-names>N.</given-names></name><name><surname>Belliveau</surname><given-names>J.</given-names></name><name><surname>Wedeen</surname><given-names>V.</given-names></name></person-group> (<year>2002</year>). <article-title>High angular resolution diffusion imaging reveals intravoxel white matter fiber heterogeneity</article-title>. <source>Magn. Reson. Med</source>. <volume>48</volume>, <fpage>577</fpage>–<lpage>582</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.10268</pub-id><?supplied-pmid 12353272?><pub-id pub-id-type="pmid">12353272</pub-id></mixed-citation>
    </ref>
    <ref id="B89">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Tuch</surname><given-names>D. S.</given-names></name></person-group> (<year>2002</year>). <source>Diffusion MRI of Complex Tissue Structure</source>. Ph.D. thesis, <publisher-name>Harvard University and Massachusetts Institute of Technology</publisher-name></mixed-citation>
    </ref>
    <ref id="B90">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Vaillancourt</surname><given-names>O.</given-names></name><name><surname>Boré</surname><given-names>A.</given-names></name><name><surname>Girard</surname><given-names>G.</given-names></name><name><surname>Descoteaux</surname><given-names>M.</given-names></name></person-group> (<year>2011</year>). <article-title>A fiber navigator for neurosurgical planning</article-title>, in <source>Organization for Human Brain Mapping</source> (<publisher-loc>Sherbrooke, QC</publisher-loc>).</mixed-citation>
    </ref>
    <ref id="B91">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van der Walt</surname><given-names>S.</given-names></name><name><surname>Colbert</surname><given-names>S. C.</given-names></name><name><surname>Varoquaux</surname><given-names>G.</given-names></name></person-group> (<year>2011</year>). <article-title>The NumPy array: a structure for efficient numerical computation</article-title>. <source>Comput. Sci. Eng</source>. <volume>13</volume>, <fpage>22</fpage>–<lpage>30</lpage>
<pub-id pub-id-type="doi">10.1109/MCSE.2011.37</pub-id></mixed-citation>
    </ref>
    <ref id="B92">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Essen</surname><given-names>D. C.</given-names></name><name><surname>Smith</surname><given-names>S. M.</given-names></name><name><surname>Barch</surname><given-names>D. M.</given-names></name><name><surname>Behrens</surname><given-names>T. E. J.</given-names></name><name><surname>Yacoub</surname><given-names>E.</given-names></name><name><surname>Ugurbil</surname><given-names>K.</given-names></name></person-group> (<year>2013</year>). <article-title>The WU-Minn human connectome project: an overview</article-title>. <source>Neuroimage</source>
<volume>80</volume>, <fpage>62</fpage>–<lpage>79</lpage>
<pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.05.041</pub-id><?supplied-pmid 23684880?><pub-id pub-id-type="pmid">23684880</pub-id></mixed-citation>
    </ref>
    <ref id="B93">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wandell</surname><given-names>B. A.</given-names></name><name><surname>Yeatman</surname><given-names>J. D.</given-names></name></person-group> (<year>2013</year>). <article-title>Biological development of reading circuits</article-title>. <source>Curr. Opin. Neurobiol</source>. <volume>23</volume>, <fpage>261</fpage>–<lpage>268</lpage>
<pub-id pub-id-type="doi">10.1016/j.conb.2012.12.005</pub-id><?supplied-pmid 23312307?><pub-id pub-id-type="pmid">23312307</pub-id></mixed-citation>
    </ref>
    <ref id="B94">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>R.</given-names></name><name><surname>Benner</surname><given-names>T.</given-names></name><name><surname>Sorensen</surname><given-names>A.</given-names></name><name><surname>Wedeen</surname><given-names>V.</given-names></name></person-group> (<year>2007</year>). <article-title>Diffusion toolkit: a software package for diffusion imaging data processing and tractography</article-title>. <source>Proc. Int. Soc. Magn. Reson. Med</source>. <volume>15</volume>, <fpage>3720</fpage></mixed-citation>
    </ref>
    <ref id="B95">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wedeen</surname><given-names>V. J.</given-names></name><name><surname>Hagmann</surname><given-names>P.</given-names></name><name><surname>Tseng</surname><given-names>W.-Y. I.</given-names></name><name><surname>Reese</surname><given-names>T. G.</given-names></name><name><surname>Weisskoff</surname><given-names>R. M.</given-names></name></person-group> (<year>2005</year>). <article-title>Mapping complex tissue architecture with diffusion spectrum magnetic resonance imaging</article-title>. <source>Magn. Reson. Med</source>. <volume>54</volume>, <fpage>1377</fpage>–<lpage>1386</lpage>
<pub-id pub-id-type="doi">10.1002/mrm.20642</pub-id><?supplied-pmid 16247738?><pub-id pub-id-type="pmid">16247738</pub-id></mixed-citation>
    </ref>
    <ref id="B96">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Westin</surname><given-names>C.-F.</given-names></name><name><surname>Peled</surname><given-names>S.</given-names></name><name><surname>Gudbjartsson</surname><given-names>H.</given-names></name><name><surname>Kikinis</surname><given-names>R.</given-names></name><name><surname>Jolesz</surname><given-names>F. A.</given-names></name></person-group> (<year>1997</year>). <article-title>Geometrical diffusion measures for MRI from tensor basis analysis</article-title>. <source>Proc. ISMRM</source>
<volume>97</volume>, <fpage>1742</fpage></mixed-citation>
    </ref>
    <ref id="B97">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeatman</surname><given-names>J. D.</given-names></name><name><surname>Dougherty</surname><given-names>R. F.</given-names></name><name><surname>Myall</surname><given-names>N. J.</given-names></name><name><surname>Wandell</surname><given-names>B. A.</given-names></name><name><surname>Feldman</surname><given-names>H. M.</given-names></name></person-group> (<year>2012</year>). <article-title>Tract profiles of white matter properties: automating fiber-tract quantification</article-title>. <source>PLoS ONE</source>
<volume>7</volume>:<fpage>e49790</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0049790</pub-id><?supplied-pmid 23166771?><pub-id pub-id-type="pmid">23166771</pub-id></mixed-citation>
    </ref>
    <ref id="B98">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yeh</surname><given-names>F.</given-names></name><name><surname>Wedeen</surname><given-names>V.</given-names></name><name><surname>Tseng</surname><given-names>W.</given-names></name></person-group> (<year>2010</year>). <article-title>Generalized Q-sampling imaging</article-title>. <source>IEEE Trans. Med. Imaging</source>
<volume>29</volume>, <fpage>1626</fpage>–<lpage>1635</lpage>
<pub-id pub-id-type="doi">10.1109/TMI.2010.2045126</pub-id><?supplied-pmid 20304721?><pub-id pub-id-type="pmid">20304721</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
