<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6198852</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty405</article-id>
    <article-id pub-id-type="publisher-id">bty405</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Databases and Ontologies</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SoS Notebook: an interactive multi-language data analysis environment</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Peng</surname>
          <given-names>Bo</given-names>
        </name>
        <xref ref-type="aff" rid="bty405-aff1">1</xref>
        <xref ref-type="corresp" rid="bty405-cor1"/>
        <!--<email>bpeng@mdanderson.org</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Gao</given-names>
        </name>
        <xref ref-type="aff" rid="bty405-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jun</given-names>
        </name>
        <xref ref-type="aff" rid="bty405-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Leong</surname>
          <given-names>Man Chong</given-names>
        </name>
        <xref ref-type="aff" rid="bty405-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wakefield</surname>
          <given-names>Chris</given-names>
        </name>
        <xref ref-type="aff" rid="bty405-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-9052-2328</contrib-id>
        <name>
          <surname>Melott</surname>
          <given-names>James</given-names>
        </name>
        <xref ref-type="aff" rid="bty405-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chiu</surname>
          <given-names>Yulun</given-names>
        </name>
        <xref ref-type="aff" rid="bty405-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8851-8466</contrib-id>
        <name>
          <surname>Du</surname>
          <given-names>Di</given-names>
        </name>
        <xref ref-type="aff" rid="bty405-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weinstein</surname>
          <given-names>John N</given-names>
        </name>
        <xref ref-type="aff" rid="bty405-aff1">1</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty405-aff1"><label>1</label>Department of Bioinformatics and Computational Biology, The University of Texas, MD Anderson Cancer Center, Houston, TX, USA </aff>
    <aff id="bty405-aff2"><label>2</label>Department of Human Genetics, The University of Chicago, Chicago, IL, USA</aff>
    <aff id="bty405-aff3"><label>3</label>Department of Statistics, Rice University, Houston, TX, USA</aff>
    <author-notes>
      <corresp id="bty405-cor1">To whom correspondence should be addressed. E-mail: <email>bpeng@mdanderson.org</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>11</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-05-22">
      <day>22</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>21</issue>
    <fpage>3768</fpage>
    <lpage>3770</lpage>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>8</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>24</day>
        <month>4</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>5</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty405.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Complex bioinformatic data analysis workflows involving multiple scripts in different languages can be difficult to consolidate, share and reproduce. An environment that streamlines the entire processes of data collection, analysis, visualization and reporting of such multi-language analyses is currently lacking.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed Script of Scripts (SoS) Notebook, a web-based notebook environment that allows the use of multiple scripting language in a single notebook, with data flowing freely within and across languages. SoS Notebook enables researchers to perform sophisticated bioinformatic analysis using the most suitable tools for different parts of the workflow, without the limitations of a particular language or complications of cross-language communications.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>SoS Notebook is hosted at <ext-link ext-link-type="uri" xlink:href="http://vatlab.github.io/SoS/">http://vatlab.github.io/SoS/</ext-link> and is distributed under a BSD license.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">NHGRI</named-content>
          <named-content content-type="funder-identifier">10.13039/100000051</named-content>
        </funding-source>
        <award-id>R01HG008972</award-id>
        <award-id>1R01HG005859</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Cancer Institute</named-content>
          <named-content content-type="funder-identifier">10.13039/100000054</named-content>
        </funding-source>
        <award-id>CA143883</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Cancer Prevention &amp; Research Institute of Texas</named-content>
        </funding-source>
        <award-id>RP130397</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Gordon and Betty Moore Foundation GBMF</named-content>
        </funding-source>
        <award-id>#4559</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Mary K. Chapman Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039/100001538</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Michael &amp; Susan Dell Foundation</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">NIH</named-content>
          <named-content content-type="funder-identifier">10.13039/100000002</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">NCI</named-content>
          <named-content content-type="funder-identifier">10.13039/100000054</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">MDACC Cancer Center Support</named-content>
        </funding-source>
        <award-id>P30CA016672</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Due to complications and limitations of cross-language interfaces (e.g. the R and MATLAB interfaces for Python), most bioinformaticians write separate scripts when tools in different languages are needed for parts of the analysis. Adding to all of the difficulties in interfacing between languages and producing reports from multiple scripts, it is challenging to keep track of separate script files, share fragmented workflows with colleagues, and archive the workflows properly for future reference.</p>
    <p>A multi-language data analysis environment provides a unified platform on which workflows composed in mixed languages can be easily executed, shared and reproduced. A few such environments under active development include RStudio Notebook, Apache Zeppelin and Beaker Notebook (now BeakerX). RStudio has a clear root in R with limited support for other languages; Zeppelin is designed for data analytics and visualization in large-scale data exploration; Beaker Notebook has now been replaced by BeakerX which supports only Java-based languages. None of those environments support SAS or MATLAB, and that limits their applications in the bioinformatics and biostatistics community. With the goal of developing a versatile environment for daily bioinformatic data analysis, we developed a multi-language notebook environment powered by a Python3-based workflow engine entitled Script of Scripts (SoS), hence its name SoS Notebook.</p>
  </sec>
  <sec>
    <title>2 Features</title>
    <p>SoS Notebook consists of a new kernel and a number of front-end extensions of the Jupyter Notebook platform (<xref rid="bty405-B1" ref-type="bibr">Kluyver <italic>et al.</italic>, 2016</xref>). The SoS kernel acts as a proxy to the SoS workflow engine and a hub between Jupyter and more than 60 existing Jupyter kernels. It executes scripts in multiple languages and coordinates data exchange among the kernels. The SoS front-end extends the single-kernel notebook interface of Jupyter to a multi-language notebook interface with global and cell-level language selectors and a multi-purpose side panel. Using a set of ‘magics’ (special commands prefixed with <monospace>%</monospace>) and keyboard shortcuts, SoS Notebook provides an interactive notebook environment with explicit and automatic kernel switch and data exchange, line-by-line code execution, and other useful features such as preview of variables and files.</p>
    <p>An SoS notebook consists of markdown cells and code cells with content executed by either SoS (based on Python 3) or one of the subkernels. Cell kernels can be changed either interactively or using magics <monospace>%with</monospace> and <monospace>%use</monospace>. Magic <monospace>%expand</monospace> interpolates cell contents with variables in the SoS kernel, allowing the composition of scripts in different languages using shared notebook variables (e.g. filenames, parameters). Magic <monospace>%capture</monospace> captures cell outputs as SoS variables so results from one kernel can be passed to and used by other kernels. Along with the main notebook, a side panel is provided to perform a variety of nonpermanent actions, such as executing scripts that will not be saved with the main notebook and showing results of line-by-line execution (<xref ref-type="fig" rid="bty405-F1">Fig. 1</xref>).
</p>
    <fig id="bty405-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>An example SoS notebook that uses SoS (Python) to read data from an excel file, preview it in the side panel as a searchable and sortable table, transfer data to R to annotate ensembl gene id with HGNC names using the Bioconductor package biomaRt, then plot the annotated data in Julia</p>
      </caption>
      <graphic xlink:href="bty405f1"/>
    </fig>
    <p>A more powerful data exchange method is provided to exchange variables among kernels for supported languages (Bash, JavaScript, Julia, MATLAB, Octave, Python2 and 3, R, SAS and TypeScript). Because of large differences in datatypes among scripting languages, SoS transfers variables through the creation of independent homonymous variables of the most similar datatypes in the destination language. For example, although <monospace>3</monospace> and <monospace>c(3, 5)</monospace> are both numeric arrays in R, they are transferred to Python as integer 3 and numpy <monospace>array([3, 5])</monospace> respectively. Similarly, Julia’s <monospace>Char</monospace> and <monospace>str</monospace> types are both converted to and from Python as <monospace>str</monospace>, while Python pandas <monospace>DataFrame</monospace> is converted to <monospace>data.frame</monospace> in R, dataset in SAS, <monospace>table</monospace> in MATLAB, <monospace>dataframe</monospace> in Octave and nested dictionaries in JavaScript. Data exchanges are performed automatically for variables with names starting with <monospace>sos</monospace> and explicitly with magics such as <monospace>%put</monospace> and <monospace>%get</monospace>. Interestingly, magic ‘%<monospace>with language –in v1 –out v2</monospace>’ evaluates the contents of a cell in another language with input and output variables as if calling a function in the current kernel.</p>
    <p>SoS magics provide functions for smooth, interactive data analysis. Of particular interest is a <monospace>%preview</monospace> magic that previews variables and expressions from any kernel, and local or remote files in many different formats. The preview magic could be triggered explicitly or automatically (e.g. during line-by-line execution) and can preview dataframes in scrollable, sortable and searchable tabular format, or in interactive scatterplots with tooltips. In addition, magic <monospace>%render</monospace> renders headers, tables and figures from texts produced by any kernel, allowing the generation of a single report from results obtained using multiple languages.</p>
    <p>SoS Notebook facilitates the generation of reports from multi-language data analysis by providing magics to capture and render results from multiple kernels, and tags, shortcuts, and templates to generate reports in HTML format. For example, the <monospace>sos_report</monospace> template allows generation of HTML reports that display only selected material. A reader can therefore focus immediately on the core messages of a report and display more details if needed. Output from the <monospace>%preview</monospace> magic can be included to report large datasets as dynamic tables and plots.</p>
  </sec>
  <sec>
    <title>3 Discussions</title>
    <p>SoS Notebook provides an interactive working environment in which users can apply the most suitable languages and tools for different parts of a data analysis. Resulting notebooks contain detailed descriptions, complete source codes and results. They can be readily shared with others and re-executed to reproduce prior analyses. SoS Notebook also serves as an execution and management console for the SoS workflow system, as described in a companion report (in preparation). This unique combination of interactive environment and workflow engine makes it easy to convert scripts developed for interactive data analysis to a workflow for non-interactive use in high-performance computing environments, further distinguishing SoS Notebook from other multi-language environments. Although SoS currently focuses on commonly-used languages for bioinformatic applications under a Jupyter front end, we are working with the open source community, especially the JupyterLab (successor of Jupyter) team, to support more languages and to port SoS Notebook to JupyterLab.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We appreciate feedback and support from members of the Department of Bioinformatics and Computational Biology at UT MD Anderson Cancer Center. We also appreciate reviewers and users of SoS Notebook for their very helpful feedback.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported in part by U.S. NHGRI grants R01HG008972 and 1R01HG005859, National Cancer Institute grants CA143883, Cancer Prevention &amp; Research Institute of Texas grant RP130397, the Gordon and Betty Moore Foundation GBMF #4559, the Mary K. Chapman Foundation, the Michael &amp; Susan Dell Foundation (honoring Lorraine Dell) and the NIH/NCI MDACC Cancer Center Support Grant under award number P30CA016672.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>Reference</title>
    <ref id="bty405-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Kluyver</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) Jupyter Notebooks – a publishing format for reproducible computational workflows. doi: 10.3233/978-1-61499-649-1-87.</mixed-citation>
    </ref>
  </ref-list>
</back>
