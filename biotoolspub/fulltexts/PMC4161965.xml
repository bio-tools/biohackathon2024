<?DTDIdentifier.IdentifierValue -//NPG//DTD XML Article//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName NPG_XML_Article.dtd?>
<?SourceDTD.Version 2.7.10?>
<?ConverterInfo.XSLTName nature2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Sci Rep</journal-id>
    <journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id>
    <journal-title-group>
      <journal-title>Scientific Reports</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2045-2322</issn>
    <publisher>
      <publisher-name>Nature Publishing Group</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4161965</article-id>
    <article-id pub-id-type="pii">srep06347</article-id>
    <article-id pub-id-type="doi">10.1038/srep06347</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GSAASeqSP: A Toolset for Gene Set Association Analysis of RNA-Seq Data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Xiong</surname>
          <given-names>Qing</given-names>
        </name>
        <xref ref-type="corresp" rid="c1">a</xref>
        <xref ref-type="aff" rid="a1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mukherjee</surname>
          <given-names>Sayan</given-names>
        </name>
        <xref ref-type="aff" rid="a2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Furey</surname>
          <given-names>Terrence S.</given-names>
        </name>
        <xref ref-type="corresp" rid="c2">b</xref>
        <xref ref-type="aff" rid="a3">3</xref>
      </contrib>
      <aff id="a1"><label>1</label><institution>Department of Computer Science and Technology, Department of Statistics, Southwest University</institution>, Chongqing 400715, <country>China</country></aff>
      <aff id="a2"><label>2</label><institution>Department of Statistical Science, Department of Computer Science, and Department of Mathematics, Duke University</institution>, Durham, NC 27708, <country>USA</country></aff>
      <aff id="a3"><label>3</label><institution>Department of Genetics, Department of Biology, Lineberger Comprehensive Cancer Center, and Carolina Center for Genomics and Society, The University of North Carolina at Chapel Hill</institution>, Chapel Hill, NC 27599, <country>USA</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="c1">
        <label>a</label>
        <email>qingx@swu.edu.cn</email>
      </corresp>
      <corresp id="c2">
        <label>b</label>
        <email>tsfurey@email.unc.edu</email>
      </corresp>
    </author-notes>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>09</month>
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <volume>4</volume>
    <elocation-id>6347</elocation-id>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>05</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>08</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2014, Macmillan Publishers Limited. All rights reserved</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Macmillan Publishers Limited. All rights reserved</copyright-holder>
      <license xmlns:xlink="http://www.w3.org/1999/xlink" license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <!--author-paid-->
        <license-p>This work is licensed under a Creative Commons Attribution 4.0 International License. The images or other third party material in this article are included in the article's Creative Commons license, unless indicated otherwise in the credit line; if the material is not included under the Creative Commons license, users will need to obtain permission from the license holder in order to reproduce the material. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link></license-p>
      </license>
    </permissions>
    <abstract>
      <p>RNA-Seq is quickly becoming the preferred method for comprehensively characterizing whole transcriptome activity, and the analysis of count data from RNA-Seq requires new computational tools. We developed GSAASeqSP, a novel toolset for genome-wide gene set association analysis of sequence count data. This toolset offers a variety of statistical procedures via combinations of multiple gene-level and gene set-level statistics, each having their own strengths under different sample and experimental conditions. These methods can be employed independently, or results generated from multiple or all methods can be integrated to determine more robust profiles of significantly altered biological pathways. Using simulations, we demonstrate the ability of these methods to identify association signals and to measure the strength of the association. We show that GSAASeqSP analyses of RNA-Seq data from diverse tissue samples provide meaningful insights into the biological mechanisms that differentiate these samples. GSAASeqSP is a powerful platform for investigating molecular underpinnings of complex traits and diseases arising from differential activity within the biological pathways. GSAASeqSP is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://gsaa.unc.edu">http://gsaa.unc.edu</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <p>Cellular processes are regulated by complex networks of functionally interacting genes. Differential activity of genes in these networks largely determines the state of the cell and cellular phenotypes. Identifying biological pathways with differential activity between phenotypically distinct samples is a powerful way to uncover molecular mechanisms underlying complex traits, diseases, and diverse cell types. Towards this end, we previously developed GSAA<xref ref-type="bibr" rid="b1">1</xref> (Gene Set Association Analysis) that identifies differentially expressed pathways through the integration of microarray gene expression and single nucleotide polymorphism (SNP) data. In addition, a variety of alternative statistical and computational methods have been developed as well such as GSEA<xref ref-type="bibr" rid="b2">2</xref>, SAM-GS<xref ref-type="bibr" rid="b3">3</xref>, PAGE<xref ref-type="bibr" rid="b4">4</xref>, GAGE<xref ref-type="bibr" rid="b5">5</xref>, T-profiler<xref ref-type="bibr" rid="b6">6</xref>, GT<xref ref-type="bibr" rid="b7">7</xref>, AGT<xref ref-type="bibr" rid="b8">8</xref>, and GLAPA<xref ref-type="bibr" rid="b9">9</xref>. However, these programs, including GSAA, can only evaluate differential activity of pathways using real-valued data from microarrays, but not count data from RNA-seq.</p>
  <p>RNA-Seq performs transcriptome profiling using high-throughput sequencing technologies. Compared to microarrays, RNA-Seq offers several advantages including: 1) better quantification of very high and very low expressed genes; 2) detection of all transcripts without pre-existing knowledge of their sequence or location; and 3) higher levels of reproducibility<xref ref-type="bibr" rid="b10">10</xref>. Analysis of count-based data from RNA-Seq requires the development of new methods and tools. Three existing methods have been developed for gene set analysis (GSA) of RNA-Seq data<xref ref-type="bibr" rid="b11">11</xref><xref ref-type="bibr" rid="b12">12</xref><xref ref-type="bibr" rid="b13">13</xref><xref ref-type="bibr" rid="b14">14</xref>: (1) SeqGSEA<xref ref-type="bibr" rid="b11">11</xref><xref ref-type="bibr" rid="b12">12</xref> performs GSA using differential expression and splicing information, either independently or together, based on a weighted Kolmogorov-Smirnov (KS) statistic; (2) A GSA method proposed by Fridley et al. uses the Gamma Method with a soft truncation threshold<xref ref-type="bibr" rid="b13">13</xref>; and (3) GSVA (Gene Set Variation Analysis) calculates pathway-based variation within a sample population<xref ref-type="bibr" rid="b14">14</xref>. We found, however, that SeqGSEA is computationally intensive and only offers the single gene set-level statistic; the GSA method from Fridley et al. is not available as a public software tool; and GSVA is not designed for gene set-based differential expression analysis between two phenotypically distinct sample groups. Therefore, computational tools that assess the associations between phenotypes and differential expression of pathways for RNA-Seq data are still very much needed.</p>
  <p>Here, we describe a novel toolset, Gene Set Association Analysis for RNA-Seq with Sample Permutation (GSAASeqSP) that efficiently performs gene set association analysis using RNA-seq count data for studies of phenotypically distinct samples. In addition to the weighted KS statistic used in SeqGSEA<xref ref-type="bibr" rid="b11">11</xref><xref ref-type="bibr" rid="b12">12</xref>, we adapt seven other statistics for these analyses and compare their performance within the same simulation framework demonstrating strengths and weaknesses of each statistic under differing conditions. We demonstrate the effectiveness of GSAASeqSP by using it to discover pathway differences between kidney and liver, and subtypes of breast cancer. Our toolset offers alternative options for gene set association analysis of RNA-Seq data. It will greatly assist in elucidating the molecular mechanisms underlying complex traits or human diseases. GSAASeqSP is being released as a module within our GSAA software suite that is publically available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://gsaa.unc.edu">http://gsaa.unc.edu</ext-link>. GSAA 1.2 now includes four functionally independent modules: GSAASeqSP, GSAASeqGP, GSAA<xref ref-type="bibr" rid="b1">1</xref>, and GSAA-SNP. These modules include different sets of analytical methods and allow for the analysis of different types of transcriptomics data and genomics data (see <xref ref-type="supplementary-material" rid="s1">Supplementary Table S1</xref> for a description of each).</p>
  <sec disp-level="1" sec-type="results">
    <title>Results</title>
    <sec disp-level="2">
      <title>Overview of gene set association analysis in GSAASeqSP</title>
      <p>GSAASeqSP takes as input RNA-seq data from multiple samples classified into two distinct phenotypic groups. Using pre-defined sets of functionally related genes, such as those in a biological pathway, GSAASeqSP identifies gene sets whose activity, as measured by gene expression, is significantly different between the two groups. To do this, GSAASeqSP employs a multi-layer statistical framework that consists of two key steps, illustrated in <xref ref-type="fig" rid="f1">Figure 1</xref>: (1) differential expression analysis of individual genes between two phenotypic groups; and (2) gene set association analysis based on differential gene activity. Each step can be implemented using a variety of statistical methods. We have evaluated three gene-level statistics for differential expression analysis: Signal2Noise, log2Ratio, and Signal2Noise_log2Ratio, and ten gene set-level statistics for gene set association analysis: Weighted_KS, L2Norm, Mean, WeightedSigRatio, SigRatio, GeometricMean, TruncatedProduct, FisherMethod, MinP, and RankSum (see Methods and <xref ref-type="supplementary-material" rid="s1">Supplementary Material</xref> for definitions of these statistics). Among these, one gene-level statistic (Signal2Noise_log2Ratio) and two gene set-level statistics (WeightedSigRatio, SigRatio) are proposed for the first time. The remaining statistics have been used for gene set analysis of microarray data, but the performance of these statistics, except for Weighted_KS in SeqGSEA, have not yet been evaluated using RNA-Seq data. Significance of associations is determined using sample permutation tests, and p-values, false discovery rates (FDRs), and family-wise error rates (FWERs) are reported.</p>
    </sec>
    <sec disp-level="2">
      <title>Simulation studies</title>
      <p>A comprehensive simulation study was conducted to evaluate the performance of gene-level and gene set-level statistics under varying magnitudes and presence of signals. More specifically, we sought to determine how well each of the statistics recovered a “causal gene set” given different numbers of contributing genes in the gene set and varying effect sizes of the differentially expressed genes with respect to the association with phenotype. We designed six scenarios. In each scenario, we simulated 200 sequence count data sets each containing 1000 genes and 400 samples – 200 for each phenotype class. We simulated 100 gene sets for each data set with the first gene set being the causal gene set. The causal gene set contained sixteen genes of which a varying subset was differentially expressed. The remaining 99 gene sets were composed of a random subset of 984 non-causal genes generated from a null model. A non-causal gene may be assigned to multiple gene sets by this design. The six scenarios are distinguished by the number and magnitudes of signals embedded in the genes constituting the causal gene set:</p>
      <p>    S1: Eight of the sixteen genes are differentially expressed, the effect size of differential expression is drawn from U[0.8, 1];</p>
      <p>    S2: Eight of the sixteen genes are differentially expressed, the effect size of differential expression is drawn from U[1, 3];</p>
      <p>    S3: Eight of the sixteen genes are differentially expressed, the effect size of differential expression is drawn from U[2, 4];</p>
      <p>    S4: Twelve of the sixteen genes are differentially expressed, the effect size of differential expression is drawn from U[0.8, 1];</p>
      <p>    S5: Twelve of the sixteen genes are differentially expressed, the effect size of differential expression is drawn from U[1, 3];</p>
      <p>    S6: Twelve of the sixteen genes are differentially expressed, the effect size of differential expression is drawn from U[2, 4];</p>
      <p>See Methods and <xref ref-type="supplementary-material" rid="s1">Supplementary Material</xref> for more details on our simulation study design.</p>
      <p>We evaluated all combinations of the three gene-level statistics and ten gene set-level statistics. The results are shown in <xref ref-type="supplementary-material" rid="s1">Supplementary Table S2</xref>. For each combination, we calculated the recognition rate (RR), defined as the proportion of replicates for which the causal gene set was the top-ranked gene set among the 100 gene sets, where gene sets are ranked by FDR. The average p-value, FDR and FWER for the causal gene set over 200 replicates and the power of each method in each scenario are reported as well. The p-value, FDR and FWER were calculated based on 2000 permutations of sample phenotype labels. Power was calculated as the proportion of replicates for which the p-value for the causal gene set was less than 0.05. Comparisons of RR and FDR among all gene-level and gene set-level statistical combinations are shown in <xref ref-type="fig" rid="f2">Figures 2</xref> and <xref ref-type="fig" rid="f3">3</xref>, respectively.</p>
      <p>Overall, most combinations of gene-level statistics and gene set-level statistics can identify association signals embedded in simulated causal gene sets and distinguish the signal intensity effectively. Unsurprisingly, as the signal intensity increased, the RR and power increased while p-value, FDR, and FWER decreased. We also noticed that most combinations performed substantially better when the causal gene sets contained 12 causal genes (S4–S6) compared to those scenarios with 8 causal genes (S1–S3), as would be expected.</p>
      <p>With respect to the recognition rate, our results show that the combination Signal2Noise (gene-level) and L2Norm (gene set-level) performed better than all other combinations (<xref ref-type="fig" rid="f2">Figure 2</xref>). It achieved recognition rates of 0.80, 0.95, 0.98, 0.99, 1, and 1, respectively, for the six simulation scenarios, the highest among all combinations. Surprisingly, by including a sample based permutation procedure, several simple gene set-level statistics, such as Mean and GeometricMean, could recognize association signals effectively. Interestingly, the three combinations using MinP for the gene set association analysis performed poorly under all conditions we simulated, so we excluded these combinations from other comparisons and analyses in this simulation study. Overall, FDRs and FWERs when using TruncatedProduct as the gene set-level statistic were consistently smaller than other combinations; however the TruncatedProduct statistic showed a moderate bias towards larger gene sets in the analyses of tissue data (see <xref ref-type="supplementary-material" rid="s1">Supplementary Table S3</xref>). The ranks of gene sets from this statistic were negatively correlated with gene set sizes, possibly due to the TruncatedProduct statistic only considering the significant proportion of genes in the gene set. The Signal2Noise:L2Norm gene:gene set-level statistic combination has the best overall performance based on FDR and FWER when excluding the three TruncatedProduct based combinations from the comparison.</p>
      <p>From these simulations, we note some general characteristics of different statistics at the gene or gene set level. At the gene-level, our results show: (1) when using Weighted_KS as the gene set-level statistic, Signal2Noise performed better when there were only eight causal genes in the causal set (S1–S3) while Signal2Noise_log2Ratio was superior if there were twelve causal genes (S4–S6); (2) Signal2Noise performed the best in nearly all simulated scenarios when combined with either the L2Norm or Mean gene set-level statistic; (3) Signal2Noise_log2Ratio had the highest RR and lowest FDR and FWER in all scenarios when combined with the WeightedSigRatio gene set-level statistic; (4) All three gene-level statistics performed similarly over all simulated scenarios when the gene set-level statistic was SigRatio, GeometricMean, Truncated Product, FisherMethod, or RankSum.</p>
      <p>The gene set-level statistics can be divided into those that take as input scores from the differential expression analysis of individual genes (Weighted_KS, L2Norm, Mean, WeightedSigRatio, SigRatio), those that take as input p-values (GeometricMean, TruncatedProduct, FisherMethod, MinP), and those that take as input ranks (RankSum). Considering the ten gene set-level statistics, our results show: (1) the L2Norm statistic performed better than all other score based statistics, and when combined with Signal2Noise or Signal2Noise_log2Ratio gene-level statistics, it had the highest RR and lowest FDR and FWER in nearly all simulated scenarios; (2) the GeometricMean statistic had the highest RR among p-value based statistics.</p>
      <p>We implemented all of the three gene-level statistics and eight of the gene set-level statistics in our GSAASeqSP platform. The MinP and TruncatedProduct statistics were not included because MinP performed poorly in the simulations and TruncatedProduct had a size bias in the analysis of the tissue data. Our simulation study shows that different combinations perform better or worse based on characteristics of causal gene sets (proportion of differentially expressed genes, strength of association). Therefore, we do not recommend a specific combination but suggest using multiple combinations. We hypothesize that associations are more likely to be biologically meaningful if they are detected using multiple analytical methods.</p>
    </sec>
    <sec disp-level="2">
      <title>Analyses of tissue and breast cancer data</title>
      <p>To further assess the power of GSAASeqSP to detect relevant gene sets differentiating phenotypically distinct samples, we analyzed two tissue data sets, one to explore pathway-based differences between kidney and liver tissue, and a second to identify differences between breast cancer subtypes. Our analyses of these tissue samples aimed to answer two important questions: (1) does GSAASeqSP provide biologically meaningful insights into mechanisms underlying the phenotypic distinction; and (2) were the results reproducible over multiple analytical methods. For these analyses, we used canonical pathway gene sets from the Molecular Signatures Database v4.0 (C2:CP collection, MSigDB, <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://www.broadinstitute.org/gsea/msigdb/index.jsp">http://www.broadinstitute.org/gsea/msigdb/index.jsp</ext-link>). Pathways for which gene expression data were available for less than 15 genes or more than 100 genes in a study were filtered to avoid overly narrow or broad functional categories. This resulted in 910 and 948 canonical pathways for the kidney-liver analysis and breast cancer subtype analysis, respectively. The statistical significance of association scores for gene sets was assessed using 5000 permutations of phenotypic class labels. Signal2Noise was chosen as the gene-level statistic for differential expression analysis of individual genes since this statistic had better overall performance in our simulations. All ten gene set-level statistics were evaluated.</p>
    </sec>
    <sec disp-level="2">
      <title>Case study 1: kidney vs. liver tissue data</title>
      <p>RNA-Seq data from kidney and liver tissue samples were generated by Marioni, et al<xref ref-type="bibr" rid="b15">15</xref> consisting of 7 technical replicates from each tissue. The results of GSAASeqSP analyses for each of the ten gene set-level statistics paired with the Signal2Noise gene-level statistic are shown in <xref ref-type="supplementary-material" rid="s1">Supplementary Tables S4–S13</xref>. In each table, pathways were sorted first by FDR, and then by the normalized association score (NAS). Results from the MinP and TruncatedProduct gene set-level statistics were excluded from all of the subsequent tissue data analyses because MinP performed poorly in simulations and TruncatedProduct was found to have a gene set size bias in these analyses. In order to find top-ranked pathways identified by multiple methods, the top 30 pathways from each of eight methods were extracted and the occurrences and ranks of each pathway were calculated, as shown in <xref ref-type="supplementary-material" rid="s1">Supplementary Table S14</xref>. A “0” indicates the gene set was not ranked in the top 30 for that method. We only chose those pathways ranked in top 30 by at least four methods, and then ranked those by their average rank across those methods in which it was one of the top 30. The top ten pathways with smallest average ranks are shown in <xref ref-type="table" rid="t1">Table 1</xref>. We used the average rank for the subsequent tissue data analyses as well. While we adopted this metric for the results presented here, users should determine whether using gene sets identified as significant by all methods, by a subset of methods, or just one method provide the best results for their purposes.</p>
      <p>We expected that biological pathways associated with kidney-specific or liver-specific functions would be identified. We found that the top 10 pathways represent several signaling cascades and metabolic processes active only or predominantly in the liver. Two pathways, BIOCARTA AMI PATHWAY (G1) and BIOCARTA INTRINSIC PATHWAY (G4), are related to the activation of the prothrombin, which is synthesized in the liver and is necessary for the coagulation of blood<xref ref-type="bibr" rid="b16">16</xref>. The coagulation cascade plays a critical role in myocardial infarction since most myocardial infarctions result from the formation of a blood clot<xref ref-type="bibr" rid="b17">17</xref>. The second-ranked pathway, REACTOME XENOBIOTICS (G2), which operates to deactivate and excrete xenobiotics, is active primarily in the liver<xref ref-type="bibr" rid="b18">18</xref>. Three pathways including REACTOME COMPLEMENT CASCADE (G3), BIOCARTA COMP PATHWAY (G5) and KEGG COMPLEMENT AND COAGULATION CASCADES (G8) represent the complement cascades and interactions between complement and coagulation systems. The complement system consists of a number of small proteins that are synthesized by the liver and is an important contributor to both innate and adaptive immune responses<xref ref-type="bibr" rid="b19">19</xref>. KEGG PRIMARY BILE ACID BIOSYNTHESIS (G6), REACTOME BILE ACID AND BILE SALT METABOLISM (G9), and REACTOME SYNTHESIS OF BILE ACIDS AND BILE SALTS (G10) are three pathways responsible for the synthesis and metabolism of bile acids and bile salts. The primary bile acids, cholic acid and chenodeoxycholic acid, are synthesized in the liver from cholesterol<xref ref-type="bibr" rid="b20">20</xref>. Bile salts are ionized bile acids– a more active form. Bile acids and bile salts are critical for digestion and absorption of lipids in the small intestine. KEGG RETINOL METABOLISM (G7) is ranked seventh. Retinol is one of the animal forms of vitamin A and the liver is a particularly rich source of vitamin A<xref ref-type="bibr" rid="b21">21</xref>.</p>
    </sec>
    <sec disp-level="2">
      <title>Case study 2: breast cancer subtype data</title>
      <p>Breast cancer is a heterogeneous disease with different molecular subtypes that are diverse in their natural history and in their responsiveness to treatments<xref ref-type="bibr" rid="b22">22</xref>. RNA-Seq data from breast cancer patients were downloaded from the data portal of The Cancer Genome Atlas (TCGA). For this data set, we sought to identify pathways linked with estrogen receptor (ER) and progesterone receptor (PGR) activity in breast cancer. These data consist of 69 ER-negative, PGR-negative tumor samples and 162 ER-positive, PGR-positive tumor samples, all from the Stage IIA pathologic group.</p>
      <p>The results of RNA-Seq data analyses using the ten gene set-level statistics and with the Signal2Noise gene-level statistic are shown in <xref ref-type="supplementary-material" rid="s1">Supplementary Tables S15–S24</xref>. The occurrences and ranks of top 30 pathways over the eight methods are shown in <xref ref-type="supplementary-material" rid="s1">Supplementary Table S25</xref>. The top ten pathways with smallest average ranks are listed in <xref ref-type="table" rid="t2">Table 2</xref>.</p>
      <p>Among the top 10 pathways with smallest average ranks, eight pathways, REACTOME DNA STRAND ELONGATION (G1), REACTOME ACTIVATION OF THE PRE REPLICATIVE COMPLEX (G2), REACTOME G1 S SPECIFIC TRANSCRIPTION (G5), REACTOME G1 PHASE (G6), PID ATR PATHWAY (G7), KEGG DNA REPLICATION (G8), REACTOME G2 M CHECKPOINTS (G9), and REACTOME CYCLIN A B1 ASSOCIATED EVENTS DURING G2 M TRANSITION (G10) are related to cell cycle regulation and proliferation. These are well-known pathways altered in cancers. We found that most genes in these pathways are up-regulated in the ER-negative, PGR-negative samples compared to the ER-positive, PGR-positive samples. These results clearly predict that ER-negative, PGR-negative tumors are a more aggressive form of the disease, which is consistent with experimental results that show almost all ER-negative tumors are characterized by increased proliferation<xref ref-type="bibr" rid="b23">23</xref>. The remaining two pathways, PID FOXM1PATHWAY (G3) and PID AURORA B PATHWAY (G4), are closely related to ER function. The forehead transcription factor (FOXM1) is transcriptionally regulated by ER-alpha and has critical roles in the initiation, progression and drug sensitivity of breast cancer<xref ref-type="bibr" rid="b24">24</xref><xref ref-type="bibr" rid="b25">25</xref><xref ref-type="bibr" rid="b26">26</xref><xref ref-type="bibr" rid="b27">27</xref><xref ref-type="bibr" rid="b28">28</xref>. Overexpression of aurora kinase A (AURKA) and aurora kinase B (AURKB) has been observed in many types of cancers<xref ref-type="bibr" rid="b29">29</xref>. Aurora kinases have vital roles in mitosis, and the deregulation of these mitotic kinases may represent an important mechanism driving tumorigenesis<xref ref-type="bibr" rid="b30">30</xref><xref ref-type="bibr" rid="b31">31</xref><xref ref-type="bibr" rid="b32">32</xref>. Our analyses suggest that the deregulation of FOXM1 and AURKB pathways may contribute to the progression from hormone-dependent to hormone-independent growth of breast cancer since our results show that the activity of both pathways is higher in ER-negative, PGR-negative breast cancer.</p>
      <p>To better understand the relationships between these top pathways, we examined protein-protein interactions (PPIs) between protein products of all genes in the top three pathways based on two types of evidence from the STRING database<xref ref-type="bibr" rid="b33">33</xref> (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="http://string-db.org/">http://string-db.org/</ext-link>): experimental (protein-protein interaction databases) and text-mining (abstracts of scientific literature). The PPI network is shown in <xref ref-type="fig" rid="f4">Figure 4</xref>. Our results indicate that the majority of proteins in the top three pathways are interconnected, which is not unexpected in this case as so many are similarly involved in aspects of the cell cycle. This could explain both how the deregulation of key “hub” genes may affect multiple top pathways, and also how deregulation of distinct genes in multiple samples may have the same phenotypic effect if they act on a similar set of genes in key pathways.</p>
      <p>In summary, our results show: (1) analyses of diverse tissue samples not only identified well-known trait-associated pathways but also provided potentially novel insights into the molecular mechanisms of complex traits and human disease; (2) results were highly reproducible over multiple analytical methods for the two data sets we analyzed.</p>
    </sec>
    <sec disp-level="2">
      <title>Comparison to existing tools</title>
      <p>Recently, several tools have been developed for differential expression analysis of individual genes for RNA-Seq data, for example DESeq<xref ref-type="bibr" rid="b34">34</xref>, edgeR<xref ref-type="bibr" rid="b35">35</xref>, NOISeq<xref ref-type="bibr" rid="b36">36</xref>, and Cuffdiff<xref ref-type="bibr" rid="b37">37</xref>. These tools generate a list of scores or p-values indicating the correlation of each gene with a phenotype difference. Any suitable gene set-level metric can then be used to study the associations between gene sets and phenotype based on this list. However, the sample permutation strategy is not applicable to methods that take as input a list of scores or p-values generated using other tools. Therefore, list-based approaches usually assess statistical significance of association signals by gene permutation - shuffling gene labels. It is common for genes in a pathway to have correlated expression profiles. Sample permutation preserves these correlation structures within gene sets, and so likely provides a more accurate background model than gene permutation. We believe this enables GSAASeqSP to generate more accurate null distributions for gene-level and gene set-level statistics in expression-based gene set analysis since it uses sample permutation to preserve correlation information during randomization.</p>
      <p>To our knowledge, the pipeline for DE-only analysis in SeqGSEA<xref ref-type="bibr" rid="b12">12</xref> is so far the only published tool for sample permutation-based gene set association analysis for RNA-Seq gene expression data. SeqGSEA uses the Weighted_KS statistic as gene set-level statistic, which we evaluated in our simulation study as it is also implemented in GSAASeqSP. The DE-only analysis in SeqGSEA uses DESeq<xref ref-type="bibr" rid="b34">34</xref> for gene-level differential expression analysis. DESeq and edgeR<xref ref-type="bibr" rid="b35">35</xref> are two popular Bioconductor packages that test for gene-level differential expression in RNA-Seq based on the negative binomial (NB) distribution. We have explored using these tools in another toolset for gene set association analysis of RNA-Seq data, Gene Set Association Analysis for RNA-Seq with Gene Permutation (GSAASeqGP). GSAASeqGP contains the gene-level differential expression metrics proposed by edgeR and DESeq and uses the Weighted_KS statistic as gene set-level statistic (<xref ref-type="supplementary-material" rid="s1">Supplementary Table S1</xref>). Currently, GSAASeqGP uses the gene permutation strategy. However, we also implemented this with sample permutation (called “GSAASeqSPNB”). We found that the run time for GSAASeqSPNB is unacceptable, as we describe in more detail below. In addition, we have implemented the gene permutation strategy for each analytical method in GSEASeqSP (called “GSAASeqSPGP”).</p>
      <p>We carried out comparisons between the two NB-based metrics, DESeq and edgeR, in GSAASeqGP and the Signal2Noise metric in GSAASeqSP using the gene permutation strategy. Here, we chose the S5 simulation scenario to evaluate these since it effectively measures the ability of methods to detect association signals. We chose Signal2Noise as the gene-level statistic due to its superior performance in the simulation studies. The results of these tests are shown in <xref ref-type="supplementary-material" rid="s1">Supplementary Tables S26–S27</xref>, which include the average run time, RR, p-value, FDR, FWER, and power over 200 replicates. For the comparison of run times, we also included a predicted run time for DESeq/edgeR-based GSAASeqSPNB, which was based on the time of running a single gene-level analysis. Let <italic>T</italic>(<italic>GSAASeqGP</italic>) be the total time for running DESeq-based GSAASeqGP with <italic>N</italic> permutations and <italic>T</italic>(<italic>DESeq</italic>) be the time for running a single DESeq analysis, then the total run time for running DESeq-based GSAASeqSPNB, <italic>T</italic>(<italic>GSAASeqSPNB</italic>), can be calculated as <italic>T</italic>(<italic>GSAASeqSPNB</italic>) = (<italic>T</italic>(<italic>DESeq</italic>) * <italic>N</italic>) + (<italic>T</italic>(<italic>GSAASeqGP</italic>) − <italic>T</italic>(<italic>DESeq</italic>)). For gene permutations, we just need to run DESeq one time while for sample permutation, we have to run DESeq <italic>N</italic> times. We set <italic>N</italic> to 2000 in our simulation study. In addition, we also included the results from GSAASeqSP with Signal2Noise as gene-level statistic - see <xref ref-type="supplementary-material" rid="s1">Supplementary Tables S26–S27</xref> for details.</p>
      <p>Based on a comparison of run times (<xref ref-type="supplementary-material" rid="s1">Supplementary Table S26</xref>), our results show: (1) using the gene permutation strategy, methods in GSAASeqSPGP are faster than methods in GSAASeqGP; and (2) using the sample permutation strategy, methods in GSAASeqSP are much faster than methods in GSAASeqSPNB. The DE-only analysis in SeqGSEA is very similar to DESeq-based GSAASeqSPNB (called GSAASeqSPNB_DESeq:Weighted_KS), as both use DESeq for differential gene expression analysis, Weighted_KS for gene set analysis, and a sample permutation strategy. We predict that the run times of SeqGSEA and GSAASeqSPNB_DESeq:Weighted_KS will be similar. Based on our calculations (<xref ref-type="supplementary-material" rid="s1">Supplementary Table S26</xref>), GSAASeqSPNB_DESeq:Weighted_KS (3531661 secs) is approximately 75142 times slower than GSAASeqSP with Signal2Noise and Weighted_KS as gene-level and gene set-level statistics (called GSAASeqSP_Signal2Noise:Weighted_KS) (47 secs) when using 2000 permutations to generate null distributions. Namely, GSAASeqSP_Signal2Noise:Weighted_KS takes approximately 16 hours to finish running on all of our simulated datasets while GSAASeqSPNB_DESeq:Weighted_KS would need approximately 134 years. These analyses imply that DESeq may be more suited for gene permutation-based gene set analysis.</p>
      <p>Overall, our performance comparisons (<xref ref-type="supplementary-material" rid="s1">Supplementary Table S27</xref>) indicate: (1) when using Weighted_KS as the gene set-level statistic and employing the gene permutation strategy, Signal2Noise performed slightly better than DESeq with respect to RRs while DESeq is slightly better than Signal2Noise with respect to FDRs. The RRs and FDRs for GSAASeqSPGP_Signal2Noise:Weighted_KS, GSAASeqGP_DESeq:Weighted_KS, and GSAASeqGP_edgeR:Weighted_KS are 0.98, 0.96, 0.93 and 0.030236, 0.027124, 0.066553, respectively; (2) sample permutation performed better than or the same as gene permutation for all combinations of Signal2Noise gene-level statistic and eight gene set-level statistics in GSAASeqSP with respect to RRs and FDRs.</p>
    </sec>
  </sec>
  <sec disp-level="1" sec-type="discussion">
    <title>Discussion</title>
    <p>In this study, we describe GSAASeqSP, a novel toolset that we developed for gene set association analysis of sequence count data. This toolset contains a comprehensive set of analytical methods through combinations of multiple gene-level statistics and multiple gene set-level statistics. We rigorously evaluated the ability of these methods to identify association signals using both simulated and real data. In this paper, our results focused on pathways robustly identified as top pathways by at least four methods. Most pathways identified through this strategy have well-established roles in the relevant complex trait. In addition, results from each method alone may also generate meaningful biological insights. For instance, the PID PLK1 PATHWAY was ranked fourth by the combined Signal2Noise (gene-level):Weighted_KS (gene set-level) method. In this pathway, many genes, such as polo-like kinase 1 (PLK1), are up-regulated in ER-negative, PGR-negative breast cancer. PLK1 is a potential therapeutic target for the treatment of the poor prognosis-associated triple-negative breast cancer (TNBC) since it was found to be significantly overexpressed in TNBC compared with the other breast cancer subtypes<xref ref-type="bibr" rid="b38">38</xref><xref ref-type="bibr" rid="b39">39</xref>.</p>
    <p>GSAASeqSP currently includes three statistics for gene differential expression analysis and eight statistics for gene set analysis. Among these statistics, some have not been previously used in gene set analyses, while the majority has been used in conjunction with microarray data. However, except for Weighted_KS adopted by SeqGSEA<xref ref-type="bibr" rid="b11">11</xref><xref ref-type="bibr" rid="b12">12</xref>, the performance of these statistics on RNA-Seq data had not been evaluated. Microarray data is approximately normally distributed while RNA-Seq data follows a NB distribution, so a statistic that works well for microarray data analysis may fail to identify signals in RNA-Seq data - the MinP statistic is an example. Using simulations, we have comprehensively evaluated the performance of different analytical methods under various scenarios. Our results show that most methods captured signals embedded in the simulated count data effectively. Since each method has its own advantages and disadvantages, we suggest that users evaluate multiple methods when analyzing their data. We provide many options for solving the same problem in order that users can compare and determine which one(s) are best for their specific purposes. In addition, in the simulation study we presented results for all combinations of gene-level statistics and gene set-level statistics, but we are aware that a few of combinations may not be statistically sound. However, these types of combinations generally performed poorly so they can be ignored in practice. Our simulation results provide guidance on the selection of appropriate combinations.</p>
    <p>The advantages of GSAASeqSP from the point of view of computation include: 1) it is computationally efficient; GSAASeqSP took approximately 0.3, 0.8, 2.8, 2.5, 2.7, 1.1, 1.0 and 1.5 hrs for Weighted_KS, L2Norm, Mean, WeigtedSigRatio, SigRatio, GeometricMean, FisherMethod, RankSum, respectively, in the analysis of breast cancer data using one computational node (Intel(R) Xeon(R) CPU X5650 @ 2.67 GHz) on a Linux cluster; 2) GSAASeqSP can be run from both the command line and the graphical user interface (GUI) making it is user-friendly; and 3) GSAASeqSP is implemented using a flexible modular structure allowing it to be easily extended to include new statistics in the future.</p>
  </sec>
  <sec disp-level="1" sec-type="methods">
    <title>Methods</title>
    <p>GSAASeqSP takes as input raw count data from multiple samples, <italic>a priori</italic> defined gene sets, and phenotype labels of samples. Its workflow includes 1) normalization of raw count data; 2) differential expression analysis of individual genes; 3) gene set association analysis; 4) assessment of statistical significance of associations (<xref ref-type="fig" rid="f1">Figure 1</xref>). The details of each step are described below:</p>
    <sec disp-level="2">
      <title>Normalization of raw count data</title>
      <p>Normalization is very important for gene expression analysis as studies have shown that gene set analysis can be affected by both systematic biases and technical biases inherent to RNA-Seq technology, such as between-sample differences (i.e. library size)<xref ref-type="bibr" rid="b40">40</xref> and within-sample gene-specific effects (i.e. gene length)<xref ref-type="bibr" rid="b41">41</xref>. Normalization enables accurate comparisons of expression levels between and within samples by adjusting for these biases. There are several methods available for normalizing RNA-Seq data. In GSAASeqSP, we normalize raw counts using the same method implemented in the DESeq Bioconductor package<xref ref-type="bibr" rid="b34">34</xref>. Dillies et al.<xref ref-type="bibr" rid="b40">40</xref> comprehensively evaluated a series of normalization methods and their results show that the DESeq normalization and Trimmed Mean of M values (TMM) implemented in the edgeR Bioconductor package<xref ref-type="bibr" rid="b35">35</xref> outperformed the other methods compared. To avoid zero counts, we added 1 to all counts in the data set before normalization.</p>
    </sec>
    <sec disp-level="2">
      <title>Differential expression analysis</title>
      <p>Three statistics were evaluated for differential expression analysis of individual genes: Signal2Noise, log2Ratio, and Signal2Noise_log2Ratio. Signal2Noise is the primary gene-level statistic used by GSEA<xref ref-type="bibr" rid="b2">2</xref>, one of the most popular tools for gene set enrichment analysis of microarray data. Log2Ratio is a commonly used metric for differential expression analysis of microarray data as well. In addition, we developed a new statistic, Signal2Noise_log2Ratio, by modifying an existing statistic introduced by NOISeq<xref ref-type="bibr" rid="b36">36</xref>, software designed to perform differential expression analysis of individual genes for RNA-Seq data. A detailed description of these statistics is available in the <xref ref-type="supplementary-material" rid="s1">Supplementary Material</xref>. GSAASeqSP employs a sample-based permutation procedure to assess the statistical significance of associations, and this is achieved by shuffling the phenotype labels of samples and recalculating the test statistics many times. Compared with methods that instead permute the genes, sample permutation-based approaches generate more accurate null distributions for gene-level and gene set-level statistics in expression-based gene set analysis since the expression profiles of genes in biological pathways are usually correlated. The sample permutation preserves the gene-gene correlation structures during the randomization, thus, phenotypic associations can be examined more accurately. In this step, a differential expression score and a p-value are computed for each gene for both the observed data and permutations.</p>
    </sec>
    <sec disp-level="2">
      <title>Gene set association analysis</title>
      <sec disp-level="3">
        <title>Computation of gene set association scores</title>
        <p>Ten statistics were evaluated for gene set association analysis: Weighted_KS, L2Norm, Mean, WeightedSigRatio, SigRatio, GeometricMean, TruncatedProduct, FisherMethod, MinP, and RankSum. A detailed description of these statistics is available in the <xref ref-type="supplementary-material" rid="s1">Supplementary Material</xref>. These statistics can be divided into three categories: score based (Weighted_KS, L2Norm, Mean, WeightedSigRatio, SigRatio), p-value based (GeometricMean, TruncatedProduct, FisherMethod, MinP), and rank based (RankSum). Among these statistics, Weighted_KS, L2Norm, Mean, GeometricMean, TruncatedProduct, FisherMethod, MinP, and RankSum have already been used for gene set analysis of microarray data. Here we adapted these statistics for and evaluated their performance for the first time on RNA-Seq count-based data. WeightedSigRatio and SigRatio are novel and have not been previously applied to gene set analysis. In this step, a gene set association score (AS) is computed for each gene set for both the observed data and permutations based on any of the ten gene set-level statistics. The differential expression scores or p-values of individual genes can be computed by any of the three gene-level statistics: Signal2Noise, log2Ratio, or Signal2Noise_log2Ratio.</p>
      </sec>
      <sec disp-level="3">
        <title>Normalization of gene set association scores</title>
        <p>To correct for possible heterogeneity of information at each gene set, for example differences in the number of genes in the gene set or correlation structure, we normalize the AS by the mean of its null distribution generated by permutations. For a particular gene set <italic>S</italic>, given its actual AS <italic>AS</italic><sub>0 </sub>and ASs calculated from permutations <italic>π</italic> = 1,…,<italic>N</italic> {<italic>AS</italic><sub>1</sub>,…,<italic>AS<sub>N</sub></italic>}, the normalized association score (NAS) is computed as <disp-formula id="m1"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e519" xlink:href="srep06347-m1.jpg"/></disp-formula>This normalization method was originally introduced by GSEA<xref ref-type="bibr" rid="b2">2</xref>.</p>
      </sec>
    </sec>
    <sec disp-level="2">
      <title>Assessment of statistical significance and adjustment for multiple hypothesis testing</title>
      <p>Statistical significance refers to the probability that a difference observed between groups occurs by chance. We assess the statistical significance of the AS and adjust for multiple hypothesis testing based on a sample-based permutation procedure. The null distribution of the AS for a particular gene set is generated by shuffling the phenotypic class labels and recalculating the AS many times. This procedure effectively preserves the correlation structure in the gene set. Consider a particular gene set <italic>S</italic>, suppose <italic>AS</italic><sub>0</sub> is the actual AS and {<italic>AS</italic><sub>1</sub>,…,<italic>AS<sub>N</sub></italic>} are the ASs for permutations <italic>π</italic> = 1,…,<italic>N</italic>, the p-value for the gene set <italic>S</italic> from the Weighted_KS, L2Norm, Mean, WeightedSigRatio, SigRatio, or FisherMethod test is computed as <disp-formula id="m2"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e557" xlink:href="srep06347-m2.jpg"/></disp-formula>while the p-value for GeometricMean, TruncatedProduct, MinP, or RankSum is computed as <disp-formula id="m3"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e560" xlink:href="srep06347-m3.jpg"/></disp-formula>Where the indicator variables <italic>I</italic>(<italic>AS<sub>i</sub></italic> ≥ <italic>AS</italic><sub>0</sub>) and <italic>I</italic>(<italic>AS<sub>i</sub></italic> ≤ <italic>AS</italic><sub>0</sub>) equal 1 if <italic>AS<sub>i</sub></italic> ≥ <italic>AS</italic><sub>0 </sub>and <italic>AS<sub>i</sub></italic> ≤ <italic>AS</italic><sub>0 </sub>respectively otherwise they are 0. Smaller p-values indicate higher probability that a gene set is associated with the phenotype.</p>
      <p>We use the false discovery rate (FDR) and the family-wise error rate (FWER) based on NAS to correct for multiple hypothesis testing and to control the proportion of false positives below a certain threshold. Given <italic>m</italic> gene sets {<italic>S</italic><sub>1</sub>,…,<italic>S<sub>m</sub></italic>} and label permutations <italic>π</italic> = 1,…,<italic>N</italic>, the FDR for the gene set <italic>S<sub>i</sub></italic>from the Weighted_KS, L2Norm, Mean, WeightedSigRatio, SigRatio, or FisherMethod test is computed as <disp-formula id="m4"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e640" xlink:href="srep06347-m4.jpg"/></disp-formula>The FDR for GeometricMean, TruncatedProduct, MinP, or RankSum is computed as <disp-formula id="m5"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e643" xlink:href="srep06347-m5.jpg"/></disp-formula>Where <italic>NAS</italic>(<italic>S<sub>j</sub></italic>,<italic>π</italic>) is the <italic>NAS</italic> for gene set <italic>j</italic> with label permutation <italic>π</italic>. <italic>NAS</italic>(<italic>S<sub>j</sub></italic>) is the <italic>NAS</italic> for gene set <italic>j</italic>. The indicator variables <italic>I</italic>(<italic>NAS</italic>(<italic>S<sub>j</sub></italic>,<italic>π</italic>) ≥ <italic>NAS</italic>(<italic>S<sub>i</sub></italic>)), <italic>I</italic>(<italic>NAS</italic>(<italic>S<sub>j</sub></italic>) ≥ <italic>NAS</italic>(<italic>S<sub>i</sub></italic>)), <italic>I</italic>(<italic>NAS</italic>(<italic>S<sub>j</sub></italic>,<italic>π</italic>) ≤ <italic>NAS</italic>(<italic>S<sub>i</sub></italic>)), and <italic>I</italic>(<italic>NAS</italic>(<italic>S<sub>j</sub></italic>) ≤ <italic>NAS</italic>(<italic>S<sub>i</sub></italic>)) equal 1 if <italic>NAS</italic>(<italic>S<sub>j</sub></italic>,<italic>π</italic>) ≥ <italic>NAS</italic>(<italic>S<sub>i</sub></italic>), <italic>NAS</italic>(<italic>S<sub>j</sub></italic>) ≥ <italic>NAS</italic>(<italic>S<sub>i</sub></italic>), <italic>NAS</italic>(<italic>S<sub>j</sub></italic>,<italic>π</italic>) ≤ <italic>NAS</italic>(<italic>S<sub>i</sub></italic>), and <italic>NAS</italic>(<italic>S<sub>j</sub></italic>) ≤ <italic>NAS</italic>(<italic>S<sub>i</sub></italic>) respectively otherwise they are 0.</p>
      <p>The FWER for the gene set <italic>S<sub>i</sub></italic>from the Weighted_KS, L2Norm, Mean, WeightedSigRatio, SigRatio, or FisherMethod test is computed as <disp-formula id="m6"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e849" xlink:href="srep06347-m6.jpg"/></disp-formula>The FWER for GeometricMean, TruncatedProduct, MinP, or RankSum is computed as <disp-formula id="m7"><inline-graphic xmlns:xlink="http://www.w3.org/1999/xlink" id="d33e852" xlink:href="srep06347-m7.jpg"/></disp-formula>Where the indicator variables <italic>I</italic>(max<italic><sub>j</sub></italic><sub> = 1,…,<italic>m</italic></sub><italic>NAS</italic>(<italic>S<sub>j</sub></italic>,<italic>π</italic>) ≥ <italic>NAS</italic>(<italic>S<sub>i</sub></italic>)) and <italic>I</italic>(max<italic><sub>j</sub></italic><sub> = 1,…,<italic>m</italic></sub><italic>NAS</italic>(<italic>S<sub>j</sub></italic>,<italic>π</italic>) ≤ <italic>NAS</italic>(<italic>S<sub>i</sub></italic>)) are 1 if max<italic><sub>j</sub></italic><sub> = 1,…,<italic>m</italic></sub><italic>NAS</italic>(<italic>S<sub>j</sub></italic>,<italic>π</italic>) ≥ <italic>NAS</italic>(<italic>S<sub>i</sub></italic>) and max<italic><sub>j</sub></italic><sub> = 1,…,<italic>m</italic></sub><italic>NAS</italic>(<italic>S<sub>j</sub></italic>,<italic>π</italic>) ≤ <italic>NAS</italic>(<italic>S<sub>i</sub></italic>) respectively otherwise they are 0.</p>
    </sec>
    <sec disp-level="2">
      <title>Generation of simulated data</title>
      <p>To evaluate the effectiveness of different gene-level and gene set-level statistics, we conducted a comprehensive simulation study. We designed 6 scenarios of differential expression. For each scenario, 200 data sets were independently generated from the same statistical model. In each data set, we simulated 200 samples corresponding to one phenotype and 200 samples corresponding to a second phenotype. For each sample, we simulated RNA-seq read counts for 1000 genes. In our simulations, we assume that the expression differences observed between the two phenotypes result from genotypic differences. Based on this assumption, we first simulated the genetic association between gene sets and phenotype then simulated the differential expression corresponding to the genetic association. Simulating gene expression variation based on genetic variation makes simulated data closer to the real data than simulating gene expression variation independently, since genetic variants are one of the major causes of differential gene expression<xref ref-type="bibr" rid="b42">42</xref><xref ref-type="bibr" rid="b43">43</xref>. For further details on generating these data, please see the <xref ref-type="supplementary-material" rid="s1">Supplementary Material</xref>.</p>
    </sec>
  </sec>
  <sec disp-level="1">
    <title>Author Contributions</title>
    <p>Q.X., S.M. and T.S.F. conceived the study; Q.X. designed the method, wrote the software, performed experiments; Q.X., S.M. and T.S.F. analyzed results and wrote the manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s1">
    <title>Supplementary Material</title>
    <supplementary-material id="d33e30" content-type="local-data">
      <caption>
        <title>Supplementary Information</title>
        <p>Supplementary Material</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep06347-s1.pdf"/>
    </supplementary-material>
    <supplementary-material id="d33e36" content-type="local-data">
      <caption>
        <title>Supplementary Information</title>
        <p>Supplementary Tables S2-S27</p>
      </caption>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep06347-s2.xls"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank the two anonymous reviewers for their constructive comments, which helped us to improve the manuscript. We thank the GSEA team (Broad Institute) for providing the GSEA software, code and documentation, and The Cancer Genome Atlas (TCGA) for granting access to the RNA-Seq data of breast cancer and prostate cancer. This work was supported by Key Discipline Fund of National 211 Project (SWU:TR201208-3) (Q.X.), The Open Fund of State Key Laboratory of Silkworm Genome Biology (sklsgb2013005) (Q.X.), NIH grant 1RC1CA146849 (T.S.F.), University Cancer Research Fund at UNC-CH (T.S.F.), CA123175-01A1(S.M.), NIH Systems Biology Center Grant (S.M.), NSF grant DMS-0732260 (S.M.), NSF grant CCF-1049290 (S.M.), and R01 CA125618-01 (S.M.).</p>
  </ack>
  <ref-list>
    <ref id="b1">
      <mixed-citation publication-type="journal"><name><surname>Xiong</surname><given-names>Q.</given-names></name>, <name><surname>Ancona</surname><given-names>N.</given-names></name>, <name><surname>Hauser</surname><given-names>E. R.</given-names></name>, <name><surname>Mukherjee</surname><given-names>S.</given-names></name> &amp; <name><surname>Furey</surname><given-names>T. S.</given-names></name>
<article-title>Integrating genetic and gene expression evidence into genome-wide association analysis of gene sets</article-title>. <source>Genome Res</source>
<volume>22</volume>, <fpage>386</fpage>–<lpage>397</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">21940837</pub-id></mixed-citation>
    </ref>
    <ref id="b2">
      <mixed-citation publication-type="journal"><name><surname>Subramanian</surname><given-names>A.</given-names></name><italic>et al.</italic><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc Natl Acad Sci U S A</source><volume>102</volume>, <fpage>15545</fpage>–<lpage>15550</lpage> (<year>2005</year>).<pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="b3">
      <mixed-citation publication-type="journal"><name><surname>Dinu</surname><given-names>I.</given-names></name><italic>et al.</italic><article-title>Improving gene set analysis of microarray data by SAM-GS</article-title>. <source>BMC Bioinformatics</source><volume>8</volume>, <fpage>242</fpage> (<year>2007</year>).<pub-id pub-id-type="pmid">17612399</pub-id></mixed-citation>
    </ref>
    <ref id="b4">
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>S. Y.</given-names></name> &amp; <name><surname>Volsky</surname><given-names>D. J.</given-names></name>
<article-title>PAGE: parametric analysis of gene set enrichment</article-title>. <source>BMC Bioinformatics</source>
<volume>6</volume>, <fpage>144</fpage> (<year>2005</year>).<pub-id pub-id-type="pmid">15941488</pub-id></mixed-citation>
    </ref>
    <ref id="b5">
      <mixed-citation publication-type="journal"><name><surname>Luo</surname><given-names>W.</given-names></name>, <name><surname>Friedman</surname><given-names>M. S.</given-names></name>, <name><surname>Shedden</surname><given-names>K.</given-names></name>, <name><surname>Hankenson</surname><given-names>K. D.</given-names></name> &amp; <name><surname>Woolf</surname><given-names>P. J.</given-names></name>
<article-title>GAGE: generally applicable gene set enrichment for pathway analysis</article-title>. <source>BMC Bioinformatics</source>
<volume>10</volume>, <fpage>161</fpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19473525</pub-id></mixed-citation>
    </ref>
    <ref id="b6">
      <mixed-citation publication-type="journal"><name><surname>Boorsma</surname><given-names>A.</given-names></name>, <name><surname>Foat</surname><given-names>B. C.</given-names></name>, <name><surname>Vis</surname><given-names>D.</given-names></name>, <name><surname>Klis</surname><given-names>F.</given-names></name> &amp; <name><surname>Bussemaker</surname><given-names>H. J.</given-names></name>
<article-title>T-profiler: scoring the activity of predefined groups of genes using gene expression data</article-title>. <source>Nucleic Acids Res</source>
<volume>33</volume>, <fpage>W592</fpage>–<lpage>595</lpage> (<year>2005</year>).<pub-id pub-id-type="pmid">15980543</pub-id></mixed-citation>
    </ref>
    <ref id="b7">
      <mixed-citation publication-type="journal"><name><surname>Goeman</surname><given-names>J. J.</given-names></name>, <name><surname>van de Geer</surname><given-names>S. A.</given-names></name>, <name><surname>de Kort</surname><given-names>F.</given-names></name> &amp; <name><surname>van Houwelingen</surname><given-names>H. C.</given-names></name>
<article-title>A global test for groups of genes: testing association with a clinical outcome</article-title>. <source>Bioinformatics</source>
<volume>20</volume>, <fpage>93</fpage>–<lpage>99</lpage> (<year>2004</year>).<pub-id pub-id-type="pmid">14693814</pub-id></mixed-citation>
    </ref>
    <ref id="b8">
      <mixed-citation publication-type="journal"><name><surname>Mansmann</surname><given-names>U.</given-names></name> &amp; <name><surname>Meister</surname><given-names>R.</given-names></name>
<article-title>Testing differential gene expression in functional groups. Goeman's global test versus an ANCOVA approach</article-title>. <source>Methods Inf Med</source>
<volume>44</volume>, <fpage>449</fpage>–<lpage>453</lpage> (<year>2005</year>).<pub-id pub-id-type="pmid">16113772</pub-id></mixed-citation>
    </ref>
    <ref id="b9">
      <mixed-citation publication-type="journal"><name><surname>Maglietta</surname><given-names>R.</given-names></name><italic>et al.</italic><article-title>Statistical assessment of functional categories of genes deregulated in pathological conditions by using microarray data</article-title>. <source>Bioinformatics</source><volume>23</volume>, <fpage>2063</fpage>–<lpage>2072</lpage> (<year>2007</year>).<pub-id pub-id-type="pmid">17540679</pub-id></mixed-citation>
    </ref>
    <ref id="b10">
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Z.</given-names></name>, <name><surname>Gerstein</surname><given-names>M.</given-names></name> &amp; <name><surname>Snyder</surname><given-names>M.</given-names></name>
<article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>. <source>Nat Rev Genet</source>
<volume>10</volume>, <fpage>57</fpage>–<lpage>63</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19015660</pub-id></mixed-citation>
    </ref>
    <ref id="b11">
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>X.</given-names></name> &amp; <name><surname>Cairns</surname><given-names>M. J.</given-names></name>
<article-title>Gene set enrichment analysis of RNA-Seq data: integrating differential expression and splicing</article-title>. <source>BMC Bioinformatics</source>
<volume>14 Suppl 5</volume>, <fpage>S16</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23734663</pub-id></mixed-citation>
    </ref>
    <ref id="b12">
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>X.</given-names></name> &amp; <name><surname>Cairns</surname><given-names>M. J.</given-names></name>
<article-title>SeqGSEA: a Bioconductor package for gene set enrichment analysis of RNA-Seq data integrating differential expression and splicing</article-title>. <source>Bioinformatics</source>
<volume>30</volume>, <fpage>1777</fpage>–<lpage>1779</lpage> (<year>2014</year>).<pub-id pub-id-type="pmid">24535097</pub-id></mixed-citation>
    </ref>
    <ref id="b13">
      <mixed-citation publication-type="journal"><name><surname>Fridley</surname><given-names>B. L.</given-names></name><italic>et al.</italic><article-title>Soft truncation thresholding for gene set analysis of RNA-seq data: Application to a vaccine study</article-title>. <source>Sci Rep</source><volume>3</volume>, <fpage>2898</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">24104466</pub-id></mixed-citation>
    </ref>
    <ref id="b14">
      <mixed-citation publication-type="journal"><name><surname>Hanzelmann</surname><given-names>S.</given-names></name>, <name><surname>Castelo</surname><given-names>R.</given-names></name> &amp; <name><surname>Guinney</surname><given-names>J.</given-names></name>
<article-title>GSVA: gene set variation analysis for microarray and RNA-seq data</article-title>. <source>BMC Bioinformatics</source>
<volume>14</volume>, <fpage>7</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23323831</pub-id></mixed-citation>
    </ref>
    <ref id="b15">
      <mixed-citation publication-type="journal"><name><surname>Marioni</surname><given-names>J. C.</given-names></name>, <name><surname>Mason</surname><given-names>C. E.</given-names></name>, <name><surname>Mane</surname><given-names>S. M.</given-names></name>, <name><surname>Stephens</surname><given-names>M.</given-names></name> &amp; <name><surname>Gilad</surname><given-names>Y.</given-names></name>
<article-title>RNA-seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>. <source>Genome Res</source>
<volume>18</volume>, <fpage>1509</fpage>–<lpage>1517</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18550803</pub-id></mixed-citation>
    </ref>
    <ref id="b16">
      <mixed-citation publication-type="journal"><name><surname>Bristol</surname><given-names>J. A.</given-names></name><italic>et al.</italic><article-title>Biosynthesis of prothrombin: intracellular localization of the vitamin K-dependent carboxylase and the sites of gamma-carboxylation</article-title>. <source>Blood</source><volume>88</volume>, <fpage>2585</fpage>–<lpage>2593</lpage> (<year>1996</year>).<pub-id pub-id-type="pmid">8839851</pub-id></mixed-citation>
    </ref>
    <ref id="b17">
      <mixed-citation publication-type="journal"><name><surname>Doggen</surname><given-names>C. J.</given-names></name>, <name><surname>Rosendaal</surname><given-names>F. R.</given-names></name> &amp; <name><surname>Meijers</surname><given-names>J. C.</given-names></name>
<article-title>Levels of intrinsic coagulation factors and the risk of myocardial infarction among men: Opposite and synergistic effects of factors XI and XII</article-title>. <source>Blood</source>
<volume>108</volume>, <fpage>4045</fpage>–<lpage>4051</lpage> (<year>2006</year>).<pub-id pub-id-type="pmid">16931632</pub-id></mixed-citation>
    </ref>
    <ref id="b18">
      <mixed-citation publication-type="journal"><name><surname>Lerapetritou</surname><given-names>M. G.</given-names></name>, <name><surname>Georgopoulos</surname><given-names>P. G.</given-names></name>, <name><surname>Roth</surname><given-names>C. M.</given-names></name> &amp; <name><surname>Androulakis</surname><given-names>L. P.</given-names></name>
<article-title>Tissue-level modeling of xenobiotic metabolism in liver: An emerging tool for enabling clinical translational research</article-title>. <source>Clin Transl Sci</source>
<volume>2</volume>, <fpage>228</fpage>–<lpage>237</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">20443896</pub-id></mixed-citation>
    </ref>
    <ref id="b19">
      <mixed-citation publication-type="journal"><name><surname>Qin</surname><given-names>X.</given-names></name> &amp; <name><surname>Gao</surname><given-names>B.</given-names></name>
<article-title>The complement system in liver diseases</article-title>. <source>Cell Mol Immunol</source>
<volume>3</volume>, <fpage>333</fpage>–<lpage>340</lpage> (<year>2006</year>).<pub-id pub-id-type="pmid">17092430</pub-id></mixed-citation>
    </ref>
    <ref id="b20">
      <mixed-citation publication-type="journal"><name><surname>Thomas</surname><given-names>C.</given-names></name>, <name><surname>Pellicciari</surname><given-names>R.</given-names></name>, <name><surname>Pruzanski</surname><given-names>M.</given-names></name>, <name><surname>Auwerx</surname><given-names>J.</given-names></name> &amp; <name><surname>Schoonjans</surname><given-names>K.</given-names></name>
<article-title>Targeting bile-acid signalling for metabolic diseases</article-title>. <source>Nat Rev Drug Discov</source>
<volume>7</volume>, <fpage>678</fpage>–<lpage>693</lpage> (<year>2008</year>).<pub-id pub-id-type="pmid">18670431</pub-id></mixed-citation>
    </ref>
    <ref id="b21">
      <mixed-citation publication-type="journal"><name><surname>Goodman</surname><given-names>D. S.</given-names></name><article-title>Overview of current knowledge of metabolism of vitamin A and carotenoids</article-title>. <source>J Natl Cancer Inst</source><volume>73</volume>, <fpage>1375</fpage>–<lpage>1379</lpage> (<year>1984</year>).<pub-id pub-id-type="pmid">6096622</pub-id></mixed-citation>
    </ref>
    <ref id="b22">
      <mixed-citation publication-type="journal"><name><surname>Perou</surname><given-names>C. M.</given-names></name><italic>et al.</italic><article-title>Molecular portraits of human breast tumours</article-title>. <source>Nature</source><volume>406</volume>, <fpage>747</fpage>–<lpage>752</lpage> (<year>2000</year>).<pub-id pub-id-type="pmid">10963602</pub-id></mixed-citation>
    </ref>
    <ref id="b23">
      <mixed-citation publication-type="journal"><name><surname>Schmidt</surname><given-names>M.</given-names></name>, <name><surname>Hengstler</surname><given-names>J. G.</given-names></name>, <name><surname>von Torne</surname><given-names>C.</given-names></name>, <name><surname>Koelbl</surname><given-names>H.</given-names></name> &amp; <name><surname>Gehrmann</surname><given-names>M. C.</given-names></name>
<article-title>Coordinates in the universe of node-negative breast cancer revisited</article-title>. <source>Cancer Res</source>
<volume>69</volume>, <fpage>2695</fpage>–<lpage>2698</lpage> (<year>2009</year>).<pub-id pub-id-type="pmid">19318558</pub-id></mixed-citation>
    </ref>
    <ref id="b24">
      <mixed-citation publication-type="journal"><name><surname>Millour</surname><given-names>J.</given-names></name><italic>et al.</italic><article-title>FOXM1 is a transcriptional target of ERalpha and has a critical role in breast cancer endocrine sensitivity and resistance</article-title>. <source>Oncogene</source><volume>29</volume>, <fpage>2983</fpage>–<lpage>2995</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20208560</pub-id></mixed-citation>
    </ref>
    <ref id="b25">
      <mixed-citation publication-type="journal"><name><surname>Sanders</surname><given-names>D. A.</given-names></name>, <name><surname>Ross-Innes</surname><given-names>C. S.</given-names></name>, <name><surname>Beraldi</surname><given-names>D.</given-names></name>, <name><surname>Carroll</surname><given-names>J. S.</given-names></name> &amp; <name><surname>Balasubramanian</surname><given-names>S.</given-names></name>
<article-title>Genome-wide mapping of FOXM1 binding reveals co-binding with estrogen receptor alpha in breast cancer cells</article-title>. <source>Genome Biol</source>
<volume>14</volume>, <fpage>R6</fpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23347430</pub-id></mixed-citation>
    </ref>
    <ref id="b26">
      <mixed-citation publication-type="journal"><name><surname>Myatt</surname><given-names>S. S.</given-names></name> &amp; <name><surname>Lam</surname><given-names>E. W.</given-names></name>
<article-title>The emerging roles of forkhead box (Fox) proteins in cancer</article-title>. <source>Nat Rev Cancer</source>
<volume>7</volume>, <fpage>847</fpage>–<lpage>859</lpage> (<year>2007</year>).<pub-id pub-id-type="pmid">17943136</pub-id></mixed-citation>
    </ref>
    <ref id="b27">
      <mixed-citation publication-type="journal"><name><surname>Koo</surname><given-names>C. Y.</given-names></name>, <name><surname>Muir</surname><given-names>K. W.</given-names></name> &amp; <name><surname>Lam</surname><given-names>E. W.</given-names></name>
<article-title>FOXM1: From cancer initiation to progression and treatment</article-title>. <source>Biochim Biophys Acta</source>
<volume>1819</volume>, <fpage>28</fpage>–<lpage>37</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">21978825</pub-id></mixed-citation>
    </ref>
    <ref id="b28">
      <mixed-citation publication-type="journal"><name><surname>Raychaudhuri</surname><given-names>P.</given-names></name> &amp; <name><surname>Park</surname><given-names>H. J.</given-names></name>
<article-title>FoxM1: a master regulator of tumor metastasis</article-title>. <source>Cancer Res</source>
<volume>71</volume>, <fpage>4329</fpage>–<lpage>4333</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21712406</pub-id></mixed-citation>
    </ref>
    <ref id="b29">
      <mixed-citation publication-type="journal"><name><surname>Fu</surname><given-names>J.</given-names></name>, <name><surname>Bian</surname><given-names>M.</given-names></name>, <name><surname>Jiang</surname><given-names>Q.</given-names></name> &amp; <name><surname>Zhang</surname><given-names>C.</given-names></name>
<article-title>Roles of Aurora kinases in mitosis and tumorigenesis</article-title>. <source>Mol Cancer Res</source>
<volume>5</volume>, <fpage>1</fpage>–<lpage>10</lpage> (<year>2007</year>).<pub-id pub-id-type="pmid">17259342</pub-id></mixed-citation>
    </ref>
    <ref id="b30">
      <mixed-citation publication-type="journal"><name><surname>Hontz</surname><given-names>A. E.</given-names></name><italic>et al.</italic><article-title>Aurora a and B overexpression and centrosome amplification in early estrogen-induced tumor foci in the Syrian hamster kidney: implications for chromosomal instability, aneuploidy, and neoplasia</article-title>. <source>Cancer Res</source><volume>67</volume>, <fpage>2957</fpage>–<lpage>2963</lpage> (<year>2007</year>).<pub-id pub-id-type="pmid">17409401</pub-id></mixed-citation>
    </ref>
    <ref id="b31">
      <mixed-citation publication-type="journal"><name><surname>Gully</surname><given-names>C. P.</given-names></name><italic>et al.</italic><article-title>Aurora B kinase phosphorylates and instigates degradation of p53</article-title>. <source>Proc Natl Acad Sci U S A</source><volume>109</volume>, <fpage>E1513</fpage>–<lpage>1522</lpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22611192</pub-id></mixed-citation>
    </ref>
    <ref id="b32">
      <mixed-citation publication-type="journal"><name><surname>Gully</surname><given-names>C. P.</given-names></name><italic>et al.</italic><article-title>Antineoplastic effects of an Aurora B kinase inhibitor in breast cancer</article-title>. <source>Mol Cancer</source><volume>9</volume>, <fpage>42</fpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20175926</pub-id></mixed-citation>
    </ref>
    <ref id="b33">
      <mixed-citation publication-type="journal"><name><surname>Franceschini</surname><given-names>A.</given-names></name><italic>et al.</italic><article-title>STRING v9.1: protein-protein interaction networks, with increased coverage and integration</article-title>. <source>Nucleic Acids Res</source><volume>41</volume>, <fpage>D808</fpage>–<lpage>815</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23203871</pub-id></mixed-citation>
    </ref>
    <ref id="b34">
      <mixed-citation publication-type="journal"><name><surname>Anders</surname><given-names>S.</given-names></name> &amp; <name><surname>Huber</surname><given-names>W.</given-names></name>
<article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol</source>
<volume>11</volume>, <fpage>R106</fpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="b35">
      <mixed-citation publication-type="journal"><name><surname>Robinson</surname><given-names>M. D.</given-names></name>, <name><surname>McCarthy</surname><given-names>D. J.</given-names></name> &amp; <name><surname>Smyth</surname><given-names>G. K.</given-names></name>
<article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>
<volume>26</volume>, <fpage>139</fpage>–<lpage>140</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="b36">
      <mixed-citation publication-type="journal"><name><surname>Tarazona</surname><given-names>S.</given-names></name>, <name><surname>Garcia-Alcalde</surname><given-names>F.</given-names></name>, <name><surname>Dopazo</surname><given-names>J.</given-names></name>, <name><surname>Ferrer</surname><given-names>A.</given-names></name> &amp; <name><surname>Conesa</surname><given-names>A.</given-names></name>
<article-title>Differential expression in RNA-seq: a matter of depth</article-title>. <source>Genome Res</source>
<volume>21</volume>, <fpage>2213</fpage>–<lpage>2223</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21903743</pub-id></mixed-citation>
    </ref>
    <ref id="b37">
      <mixed-citation publication-type="journal"><name><surname>Trapnell</surname><given-names>C.</given-names></name><italic>et al.</italic><article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>. <source>Nat Biotechnol</source><volume>28</volume>, <fpage>511</fpage>–<lpage>515</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20436464</pub-id></mixed-citation>
    </ref>
    <ref id="b38">
      <mixed-citation publication-type="journal"><name><surname>Maire</surname><given-names>V.</given-names></name><italic>et al.</italic><article-title>Polo-like kinase 1: a potential therapeutic option in combination with conventional chemotherapy for the management of patients with triple-negative breast cancer</article-title>. <source>Cancer Res</source><volume>73</volume>, <fpage>813</fpage>–<lpage>823</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23144294</pub-id></mixed-citation>
    </ref>
    <ref id="b39">
      <mixed-citation publication-type="journal"><name><surname>Wierer</surname><given-names>M.</given-names></name><italic>et al.</italic><article-title>PLK1 signaling in breast cancer cells cooperates with estrogen receptor-dependent gene transcription</article-title>. <source>Cell Rep</source><volume>3</volume>, <fpage>2021</fpage>–<lpage>2032</lpage> (<year>2013</year>).<pub-id pub-id-type="pmid">23770244</pub-id></mixed-citation>
    </ref>
    <ref id="b40">
      <mixed-citation publication-type="journal"><name><surname>Dillies</surname><given-names>M. A.</given-names></name><italic>et al.</italic><article-title>A comprehensive evaluation of normalization methods for Illumina high-throughput RNA sequencing data analysis</article-title>. <source>Brief Bioinform</source> (<year>2012</year>).</mixed-citation>
    </ref>
    <ref id="b41">
      <mixed-citation publication-type="journal"><name><surname>Gao</surname><given-names>L.</given-names></name>, <name><surname>Fang</surname><given-names>Z.</given-names></name>, <name><surname>Zhang</surname><given-names>K.</given-names></name>, <name><surname>Zhi</surname><given-names>D.</given-names></name> &amp; <name><surname>Cui</surname><given-names>X.</given-names></name>
<article-title>Length bias correction for RNA-seq data in gene set analyses</article-title>. <source>Bioinformatics</source>
<volume>27</volume>, <fpage>662</fpage>–<lpage>669</lpage> (<year>2011</year>).<pub-id pub-id-type="pmid">21252076</pub-id></mixed-citation>
    </ref>
    <ref id="b42">
      <mixed-citation publication-type="journal"><name><surname>Fu</surname><given-names>J.</given-names></name><italic>et al.</italic><article-title>Unraveling the regulatory mechanisms underlying tissue-dependent genetic variation of gene expression</article-title>. <source>PLoS Genet</source><volume>8</volume>, <fpage>e1002431</fpage> (<year>2012</year>).<pub-id pub-id-type="pmid">22275870</pub-id></mixed-citation>
    </ref>
    <ref id="b43">
      <mixed-citation publication-type="journal"><name><surname>Pickrell</surname><given-names>J. K.</given-names></name><italic>et al.</italic><article-title>Understanding mechanisms underlying human gene expression variation with RNA sequencing</article-title>. <source>Nature</source><volume>464</volume>, <fpage>768</fpage>–<lpage>772</lpage> (<year>2010</year>).<pub-id pub-id-type="pmid">20220758</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="f1">
    <label>Figure 1</label>
    <caption>
      <title>Schematic flow diagram of GSAASeqSP.</title>
      <p>(A): GSAASeqSP takes as input an experimental count dataset and <italic>a</italic>
<italic>priori</italic> defined gene sets, and first generates permuted datasets based on the experimental dataset; (B): Data is normalized and extremely small and large gene sets are filtered; (C): Differential expression analysis is performed using one of: Signal2Noise, log2Ratio, and Signal2Noise_log2Ratio; (D): Gene set association analysis is performed using one of: Weighted_KS, L2Norm, Mean, WeightedSigRatio, SigRatio, GeometricMean, FisherMethod, and RankSum; (E): Outputs include 1) ranked summary gene set association table with the name of the gene set, the number of genes (SIZE), association score (AS), normalized association score (NAS), P-VALUE, FDR, and FWER; 2) a link to gene set annotation in MSigDB (where applicable); 3) a heat map of the gene expression data for each gene set; and 4) the null distribution of the AS.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep06347-f1"/>
  </fig>
  <fig id="f2">
    <label>Figure 2</label>
    <caption>
      <title>Recognition rates for all combinations of gene-level and gene set-level statistics applied to simulation scenarios 1–6.</title>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep06347-f2"/>
  </fig>
  <fig id="f3">
    <label>Figure 3</label>
    <caption>
      <title>FDRs for all combinations of gene-level and gene set-level statistics applied to simulation scenarios 1–6.</title>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep06347-f3"/>
  </fig>
  <fig id="f4">
    <label>Figure 4</label>
    <caption>
      <title>The predicted protein-protein interaction network of protein products of genes in the top three differential pathways associated with breast cancer subtypes (confidence: 0.90).</title>
      <p>The nodes represent proteins; the edges represent the predicted functional associations. The associations were inferred from two types of evidence from the STRING database: the presence of experimental evidence (purple line) and text-mining evidence (yellow line). Experimental evidence was obtained from protein-protein interaction databases and text-mining evidence from abstracts of scientific literature.</p>
    </caption>
    <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="srep06347-f4"/>
  </fig>
  <table-wrap position="float" id="t1">
    <label>Table 1</label>
    <caption>
      <title>The occurrences and ranks of the top pathways across eight methods associated with differences between kidney and liver tissue</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="justify" valign="top" charoff="50">Index</th>
          <th align="center" valign="top" charoff="50">Pathway</th>
          <th align="center" valign="top" charoff="50">NOC</th>
          <th align="center" valign="top" charoff="50">Rank 1</th>
          <th align="center" valign="top" charoff="50">Rank 2</th>
          <th align="center" valign="top" charoff="50">Rank 3</th>
          <th align="center" valign="top" charoff="50">Rank 4</th>
          <th align="center" valign="top" charoff="50">Rank 5</th>
          <th align="center" valign="top" charoff="50">Rank 6</th>
          <th align="center" valign="top" charoff="50">Rank 7</th>
          <th align="center" valign="top" charoff="50">Rank 8</th>
          <th align="center" valign="top" charoff="50">Avg</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="justify" valign="top" charoff="50">G1</td>
          <td align="justify" valign="top" charoff="50">BIOCARTA AMI PATHWAY</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">1</td>
          <td align="char" valign="top" char="." charoff="50">2</td>
          <td align="char" valign="top" char="." charoff="50">7</td>
          <td align="char" valign="top" char="." charoff="50">1</td>
          <td align="char" valign="top" char="." charoff="50">15</td>
          <td align="char" valign="top" char="." charoff="50">1</td>
          <td align="char" valign="top" char="." charoff="50">1</td>
          <td align="char" valign="top" char="." charoff="50">2</td>
          <td align="char" valign="top" char="." charoff="50">3.75</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G2</td>
          <td align="justify" valign="top" charoff="50">REACTOME XENOBIOTICS</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">3</td>
          <td align="char" valign="top" char="." charoff="50">1</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">3</td>
          <td align="char" valign="top" char="." charoff="50">23</td>
          <td align="char" valign="top" char="." charoff="50">2</td>
          <td align="char" valign="top" char="." charoff="50">2</td>
          <td align="char" valign="top" char="." charoff="50">1</td>
          <td align="char" valign="top" char="." charoff="50">5.13</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G3</td>
          <td align="justify" valign="top" charoff="50">REACTOME COMPLEMENT CASCADE</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">4</td>
          <td align="char" valign="top" char="." charoff="50">9</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">4</td>
          <td align="char" valign="top" char="." charoff="50">9</td>
          <td align="char" valign="top" char="." charoff="50">4</td>
          <td align="char" valign="top" char="." charoff="50">6.00</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G4</td>
          <td align="justify" valign="top" charoff="50">BIOCARTA INTRINSIC PATHWAY</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">2</td>
          <td align="char" valign="top" char="." charoff="50">3</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">2</td>
          <td align="char" valign="top" char="." charoff="50">26</td>
          <td align="char" valign="top" char="." charoff="50">3</td>
          <td align="char" valign="top" char="." charoff="50">3</td>
          <td align="char" valign="top" char="." charoff="50">3</td>
          <td align="char" valign="top" char="." charoff="50">6.25</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G5</td>
          <td align="justify" valign="top" charoff="50">BIOCARTA COMP PATHWAY</td>
          <td align="char" valign="top" char="." charoff="50">5</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">10</td>
          <td align="char" valign="top" char="." charoff="50">1</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">6.60</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G6</td>
          <td align="justify" valign="top" charoff="50">KEGG PRIMARY BILE ACID BIOSYNTHESIS</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">4</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">12</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">10</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">7</td>
          <td align="char" valign="top" char="." charoff="50">7.83</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G7</td>
          <td align="justify" valign="top" charoff="50">KEGG RETINOL METABOLISM</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">11</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">13</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">4</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">8.00</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G8</td>
          <td align="justify" valign="top" charoff="50">KEGG COMPLEMENT AND COAGULATION CASCADES</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">12</td>
          <td align="char" valign="top" char="." charoff="50">11</td>
          <td align="char" valign="top" char="." charoff="50">10</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">9</td>
          <td align="char" valign="top" char="." charoff="50">7</td>
          <td align="char" valign="top" char="." charoff="50">5</td>
          <td align="char" valign="top" char="." charoff="50">9.00</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G9</td>
          <td align="justify" valign="top" charoff="50">REACTOME BILE ACID AND BILE SALT METABOLISM</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">9</td>
          <td align="char" valign="top" char="." charoff="50">11</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">10</td>
          <td align="char" valign="top" char="." charoff="50">5</td>
          <td align="char" valign="top" char="." charoff="50">10</td>
          <td align="char" valign="top" char="." charoff="50">9</td>
          <td align="char" valign="top" char="." charoff="50">9.00</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G10</td>
          <td align="justify" valign="top" charoff="50">REACTOME SYNTHESIS OF BILE ACIDS AND BILE SALTS</td>
          <td align="char" valign="top" char="." charoff="50">7</td>
          <td align="char" valign="top" char="." charoff="50">9</td>
          <td align="char" valign="top" char="." charoff="50">5</td>
          <td align="char" valign="top" char="." charoff="50">14</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">18</td>
          <td align="char" valign="top" char="." charoff="50">7</td>
          <td align="char" valign="top" char="." charoff="50">5</td>
          <td align="char" valign="top" char="." charoff="50">15</td>
          <td align="char" valign="top" char="." charoff="50">10.43</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn id="t1-fn1">
        <p>NOC: number of occurrences; 1: Weighted_KS; 2: L2Norm; 3: Mean; 4: WeigtedSigRatio; 5: SigRatio; 6: GeometricMean; 7: FisherMethod; 8: RankSum; Avg: the average rank.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap position="float" id="t2">
    <label>Table 2</label>
    <caption>
      <title>The occurrences and ranks of top pathways across eight methods associated with differences in breast cancer subtypes</title>
    </caption>
    <table frame="hsides" rules="groups" border="1">
      <colgroup>
        <col align="left"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
        <col align="center"/>
      </colgroup>
      <thead valign="bottom">
        <tr>
          <th align="justify" valign="top" charoff="50">Index</th>
          <th align="center" valign="top" charoff="50">Pathway</th>
          <th align="center" valign="top" charoff="50">NOC</th>
          <th align="center" valign="top" charoff="50">Rank 1</th>
          <th align="center" valign="top" charoff="50">Rank 2</th>
          <th align="center" valign="top" charoff="50">Rank 3</th>
          <th align="center" valign="top" charoff="50">Rank 4</th>
          <th align="center" valign="top" charoff="50">Rank 5</th>
          <th align="center" valign="top" charoff="50">Rank 6</th>
          <th align="center" valign="top" charoff="50">Rank 7</th>
          <th align="center" valign="top" charoff="50">Rank 8</th>
          <th align="center" valign="top" charoff="50">Avg</th>
        </tr>
      </thead>
      <tbody valign="top">
        <tr>
          <td align="justify" valign="top" charoff="50">G1</td>
          <td align="justify" valign="top" charoff="50">REACTOME DNA STRAND ELONGATION</td>
          <td align="char" valign="top" char="." charoff="50">7</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">5</td>
          <td align="char" valign="top" char="." charoff="50">4</td>
          <td align="char" valign="top" char="." charoff="50">2</td>
          <td align="char" valign="top" char="." charoff="50">4</td>
          <td align="char" valign="top" char="." charoff="50">1</td>
          <td align="char" valign="top" char="." charoff="50">1</td>
          <td align="char" valign="top" char="." charoff="50">2</td>
          <td align="char" valign="top" char="." charoff="50">2.71</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G2</td>
          <td align="justify" valign="top" charoff="50">REACTOME ACTIVATION OF THE PRE REPLICATIVE COMPLEX</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">2</td>
          <td align="char" valign="top" char="." charoff="50">9</td>
          <td align="char" valign="top" char="." charoff="50">2</td>
          <td align="char" valign="top" char="." charoff="50">4</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">3</td>
          <td align="char" valign="top" char="." charoff="50">3</td>
          <td align="char" valign="top" char="." charoff="50">19</td>
          <td align="char" valign="top" char="." charoff="50">6.00</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G3</td>
          <td align="justify" valign="top" charoff="50">PID FOXM1PATHWAY</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">1</td>
          <td align="char" valign="top" char="." charoff="50">2</td>
          <td align="char" valign="top" char="." charoff="50">3</td>
          <td align="char" valign="top" char="." charoff="50">10</td>
          <td align="char" valign="top" char="." charoff="50">20</td>
          <td align="char" valign="top" char="." charoff="50">5</td>
          <td align="char" valign="top" char="." charoff="50">4</td>
          <td align="char" valign="top" char="." charoff="50">5</td>
          <td align="char" valign="top" char="." charoff="50">6.25</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G4</td>
          <td align="justify" valign="top" charoff="50">PID AURORA B PATHWAY</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">3</td>
          <td align="char" valign="top" char="." charoff="50">4</td>
          <td align="char" valign="top" char="." charoff="50">11</td>
          <td align="char" valign="top" char="." charoff="50">1</td>
          <td align="char" valign="top" char="." charoff="50">13</td>
          <td align="char" valign="top" char="." charoff="50">4</td>
          <td align="char" valign="top" char="." charoff="50">5</td>
          <td align="char" valign="top" char="." charoff="50">25</td>
          <td align="char" valign="top" char="." charoff="50">8.25</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G5</td>
          <td align="justify" valign="top" charoff="50">REACTOME G1 S SPECIFIC TRANSCRIPTION</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">9</td>
          <td align="char" valign="top" char="." charoff="50">7</td>
          <td align="char" valign="top" char="." charoff="50">1</td>
          <td align="char" valign="top" char="." charoff="50">18</td>
          <td align="char" valign="top" char="." charoff="50">12</td>
          <td align="char" valign="top" char="." charoff="50">2</td>
          <td align="char" valign="top" char="." charoff="50">2</td>
          <td align="char" valign="top" char="." charoff="50">16</td>
          <td align="char" valign="top" char="." charoff="50">8.38</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G6</td>
          <td align="justify" valign="top" charoff="50">REACTOME G1 PHASE</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">11</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">15</td>
          <td align="char" valign="top" char="." charoff="50">21</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">7</td>
          <td align="char" valign="top" char="." charoff="50">4</td>
          <td align="char" valign="top" char="." charoff="50">10.00</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G7</td>
          <td align="justify" valign="top" charoff="50">PID ATR PATHWAY</td>
          <td align="char" valign="top" char="." charoff="50">7</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">19</td>
          <td align="char" valign="top" char="." charoff="50">14</td>
          <td align="char" valign="top" char="." charoff="50">3</td>
          <td align="char" valign="top" char="." charoff="50">5</td>
          <td align="char" valign="top" char="." charoff="50">9</td>
          <td align="char" valign="top" char="." charoff="50">11</td>
          <td align="char" valign="top" char="." charoff="50">13</td>
          <td align="char" valign="top" char="." charoff="50">10.57</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G8</td>
          <td align="justify" valign="top" charoff="50">KEGG DNA REPLICATION</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">16</td>
          <td align="char" valign="top" char="." charoff="50">10</td>
          <td align="char" valign="top" char="." charoff="50">5</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">11</td>
          <td align="char" valign="top" char="." charoff="50">10</td>
          <td align="char" valign="top" char="." charoff="50">18</td>
          <td align="char" valign="top" char="." charoff="50">10.75</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G9</td>
          <td align="justify" valign="top" charoff="50">REACTOME G2 M CHECKPOINTS</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">18</td>
          <td align="char" valign="top" char="." charoff="50">8</td>
          <td align="char" valign="top" char="." charoff="50">5</td>
          <td align="char" valign="top" char="." charoff="50">25</td>
          <td align="char" valign="top" char="." charoff="50">1</td>
          <td align="char" valign="top" char="." charoff="50">13</td>
          <td align="char" valign="top" char="." charoff="50">9</td>
          <td align="char" valign="top" char="." charoff="50">7</td>
          <td align="char" valign="top" char="." charoff="50">10.75</td>
        </tr>
        <tr>
          <td align="justify" valign="top" charoff="50">G10</td>
          <td align="justify" valign="top" charoff="50">REACTOME CYCLIN A B1 ASSOCIATED EVENTS DURING G2 M TRANSITION</td>
          <td align="char" valign="top" char="." charoff="50">7</td>
          <td align="char" valign="top" char="." charoff="50">10</td>
          <td align="char" valign="top" char="." charoff="50">1</td>
          <td align="char" valign="top" char="." charoff="50">12</td>
          <td align="char" valign="top" char="." charoff="50">16</td>
          <td align="char" valign="top" char="." charoff="50">0</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">6</td>
          <td align="char" valign="top" char="." charoff="50">29</td>
          <td align="char" valign="top" char="." charoff="50">11.43</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</floats-group>
