<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <?epub October-4-2007?>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2238840</article-id>
    <article-id pub-id-type="pmid">17916571</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkm797</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Articles</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>4D<italic>Xpress</italic>: a database for cross-species expression pattern comparisons</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Haudry</surname>
          <given-names>Yannick</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Berube</surname>
          <given-names>Hugo</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Letunic</surname>
          <given-names>Ivica</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weeber</surname>
          <given-names>Paul-Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gagneur</surname>
          <given-names>Julien</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Girardot</surname>
          <given-names>Charles</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kapushesky</surname>
          <given-names>Misha</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arendt</surname>
          <given-names>Detlev</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bork</surname>
          <given-names>Peer</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brazma</surname>
          <given-names>Alvis</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Furlong</surname>
          <given-names>Eileen E. M.</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wittbrodt</surname>
          <given-names>Joachim</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Henrich</surname>
          <given-names>Thorsten</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup>European Molecular Biology Laboratory EMBL, Meyerhofstrasse 1, 69117 Heidelberg, Germany and <sup>2</sup>European Bioinformatics Institute, EMBL-EBI Wellcome Trust Genome Campus Hinxton, Cambridge, CB10 1SD, UK</aff>
    <author-notes>
      <corresp id="COR1">*To whom correspondence should be addressed.<phone>+49 6221 387 516</phone><fax>+49 6221 387 166</fax><email>henrich@embl.de</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>1</month>
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>4</day>
      <month>10</month>
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>4</day>
      <month>10</month>
      <year>2007</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>Database issue</issue>
    <issue-title>Database issue</issue-title>
    <fpage>D847</fpage>
    <lpage>D853</lpage>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>8</month>
        <year>2007</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>9</month>
        <year>2007</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>9</month>
        <year>2007</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2007 The Author(s)</copyright-statement>
      <copyright-year>2007</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>In the major animal model species like mouse, fish or fly, detailed spatial information on gene expression over time can be acquired through whole mount <italic>in situ</italic> hybridization experiments. In these species, expression patterns of many genes have been studied and data has been integrated into dedicated model organism databases like ZFIN for zebrafish, MEPD for medaka, BDGP for <italic>Drosophila</italic> or GXD for mouse. However, a central repository that allows users to query and compare gene expression patterns across different species has not yet been established. Therefore, we have integrated expression patterns for zebrafish, <italic>Drosophila</italic>, medaka and mouse into a central public repository called 4D<italic>Xpress</italic> (expression database in four dimensions). Users can query anatomy ontology-based expression annotations across species and quickly jump from one gene to the orthologues in other species. Genes are linked to public microarray data in ArrayExpress. We have mapped developmental stages between the species to be able to compare developmental time phases. We store the largest collection of gene expression patterns available to date in an individual resource, reflecting 16 505 annotated genes. 4D<italic>Xpress</italic> will be an invaluable tool for developmental as well as for computational biologists interested in gene regulation and evolution. 4D<italic>Xpress</italic> is available at <ext-link ext-link-type="uri" xlink:href="http://ani.embl.de/4DXpress">http://ani.embl.de/4DXpress</ext-link>.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>Precise spatio-temporal gene expression is crucial during the development of an organism. Combinations of transcription factors give distinct identities to embryonic structures, tissues and cell types and trigger complex developmental processes like embryonic patterning, morphogenesis and differentiation. To know the exact time and location of gene transcripts is essential when studying the functions of genes involved in developmental processes as well as for trying to decipher the code of <italic>cis</italic>-regulatory modules. Therefore expression localization data has been gathered by the dedicated model species databases like ZFIN for zebrafish (<xref ref-type="bibr" rid="B1">1</xref>), BDGP (<xref ref-type="bibr" rid="B2">2</xref>) and FlyBase (<xref ref-type="bibr" rid="B3">3</xref>) for <italic>Drosophila</italic>, MEPD (<xref ref-type="bibr" rid="B4">4</xref>) for medaka, Aniseed for ciona, XDB3 for <italic>Xenopus</italic> or GXD (<xref ref-type="bibr" rid="B5">5</xref>) and EMAGE (<xref ref-type="bibr" rid="B6">6</xref>) for mouse. A central platform, which allows users to compare gene expression in different species, however, has not yet been established. Such a resource would be invaluable not only to complement lacking expression information in one species by annotations done in other species, but also to study the evolutionary origin of embryonic structures.</p>
    <p>Here we provide a platform for a cross-species expression pattern resource. 4D<italic>Xpress</italic> (expression database in four dimension) stores images, which lets biologists see and judge expression patterns together with an organized annotation. It allows users to query the data and makes data accessible to computational analysis. Our vision is that in a few years time the exact localization of each single transcript will be known for the major model species. We hope that our resource will help to store them in an organized way, to compare different species expression patterns and to provide tools to analyse this data.</p>
  </sec>
  <sec>
    <title>DATA INTEGRATION</title>
    <p>Data integration is a major challenge of the project. Besides the differences of the model organism themselves, databases provide gene expression data in different formats (flat files, sql-dumps, direct database access) and annotation has been done differently (screens, literature, curators).</p>
    <sec>
      <title>Expression data</title>
      <p>So far we have integrated expression data for zebrafish (<xref ref-type="bibr" rid="B1">1</xref>), <italic>Drosophila</italic> (<xref ref-type="bibr" rid="B2">2</xref>), medaka (<xref ref-type="bibr" rid="B4">4</xref>) and mouse (<xref ref-type="bibr" rid="B5">5</xref>). <xref ref-type="table" rid="T1">Table 1</xref> gives an overview on the expression pattern annotations that have been integrated for 4D<italic>Xpress</italic>. The best-annotated model species at the moment are <italic>Drosophila</italic> and zebrafish with almost 6000 annotated genes each. Mouse follows with 3893 annotated genes; some annotations were done using a 3D virtual embryo (<xref ref-type="bibr" rid="B6">6</xref>).
<table-wrap id="T1" position="float"><label>Table 1.</label><caption><p>Content of 4D<italic>Xpress</italic>. Annotation status of gene expression patterns at present time</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Source</th><th rowspan="1" colspan="1">Genes</th><th rowspan="1" colspan="1">Stages</th><th rowspan="1" colspan="1">Stages per gene</th><th rowspan="1" colspan="1">Anatomy terms</th><th rowspan="1" colspan="1">Anatomy terms per gene</th><th rowspan="1" colspan="1">Anatomy terms per stage</th><th rowspan="1" colspan="1">Distinct anatomy terms</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1"><italic>Drosophila</italic></td><td rowspan="1" colspan="1">bdgp</td><td rowspan="1" colspan="1">5951</td><td rowspan="1" colspan="1">21 048</td><td rowspan="1" colspan="1">3.54</td><td rowspan="1" colspan="1">29 867</td><td rowspan="1" colspan="1">5.02</td><td rowspan="1" colspan="1">1.42</td><td rowspan="1" colspan="1">288</td></tr><tr><td rowspan="1" colspan="1">Medaka</td><td rowspan="1" colspan="1">mepd</td><td rowspan="1" colspan="1">882</td><td rowspan="1" colspan="1">27 46</td><td rowspan="1" colspan="1">3.11</td><td rowspan="1" colspan="1">5047</td><td rowspan="1" colspan="1">5.72</td><td rowspan="1" colspan="1">1.84</td><td rowspan="1" colspan="1">338</td></tr><tr><td rowspan="1" colspan="1">Zebrafish</td><td rowspan="1" colspan="1">zfin</td><td rowspan="1" colspan="1">5779</td><td rowspan="1" colspan="1">102 671</td><td rowspan="1" colspan="1">17.77</td><td rowspan="1" colspan="1">178 851</td><td rowspan="1" colspan="1">30.95</td><td rowspan="1" colspan="1">1.74</td><td rowspan="1" colspan="1">694</td></tr><tr><td rowspan="1" colspan="1">Mouse</td><td rowspan="1" colspan="1">mgi</td><td rowspan="1" colspan="1">3893</td><td rowspan="1" colspan="1">127 99</td><td rowspan="1" colspan="1">3.29</td><td rowspan="1" colspan="1">17 291</td><td rowspan="1" colspan="1">4.44</td><td rowspan="1" colspan="1">1.35</td><td rowspan="1" colspan="1">1661</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">16 505</td><td rowspan="1" colspan="1">139 264</td><td rowspan="1" colspan="1">8.44</td><td rowspan="1" colspan="1">231 056</td><td rowspan="1" colspan="1">14.00</td><td rowspan="1" colspan="1">1.66</td><td rowspan="1" colspan="1">2981</td></tr></tbody></table></table-wrap></p>
      <p>Also expression data has been gathered differently. For medaka and <italic>Drosophila</italic> the major annotation results from a screen. Expression has been analysed at distinct time points and cover between 3 and 4 stages per gene on average (<xref ref-type="table" rid="T1">Table 1</xref>, stages per gene), whereas zebrafish expression patterns are additionally annotated from literature by a team of database curators. Annotation is done for continuous developmental stages.</p>
      <p>Anatomy ontologies are often very rich, however only a limited fraction of the terms is actually used for expression annotation (<xref ref-type="table" rid="T1">Table 1</xref>, distinct annotations). Again, ZFIN uses a rich vocabulary with almost 700 distinct terms. The values for mouse and medaka need to be treated with care, as the ontologies used for annotation here are the cross product of anatomy and stage ontologies and therefore overestimates vocabulary richness.</p>
      <p>Our database schema can store all information required by the MISFISHIE standard (minimum information specification for <italic>in situ</italic> hybridization and immunohistochemistry experiments) (<xref ref-type="bibr" rid="B7">7</xref>). This will allow us to efficiently adapt other model species as well as developing a data exchange format to keep up to date with other resources.</p>
    </sec>
    <sec>
      <title>Cross-species relationships</title>
      <p>One of the major goals of our project is to be able to compare gene expression patterns between the different model species. For doing so, relationships need to be established between genes (orthology), between time windows (developmental stages) and most challenging between anatomical structures (homologue/analogue).</p>
      <sec>
        <title>Orthology mapping</title>
        <p>EnsEMBL compara (<xref ref-type="bibr" rid="B8">8</xref>) provides a reliable source of sequence homology relationships, which was computed using a tree-based approach. We have chosen to use this and update regularly upon new EnsEMBL releases. We assigned each gene to a cluster of orthologues using the EnsEMBL notification: one2one-, one2many- and many2many-orthology relationships. Through the web interface (described below), these clusters are visualized as a network and homology relationships are used to sort the gene list retrieved from a query as well as for allowing quick links from one gene to the orthologues in other species.</p>
      </sec>
      <sec>
        <title>Developmental stage mapping</title>
        <p>It is very difficult to identify corresponding developmental stages in two species, even when comparing two closely related fish species like medaka and zebrafish. For instance in medaka, the head and brain develop faster, whereas the tail and somites develop slower than in zebrafish. So a matching zebrafish stage regarding the number of somites (which is a very popular staging feature) would correspond to an earlier stage than a matching zebrafish stage based on head features.</p>
        <p>However there are key events in development, which allow researchers to define a list of eight stages that is described in all developmental biology text books and is common to all bilaterian animals: zygote, cleavage, blastula, gastrula, neurula, organogenesis, juvenile and adult. By mapping each of the species stages onto one of the bilaterian stages the link between species stages can be done and combinatorial explosion can be prevented. A new species will only need to be mapped to the common stages (<xref ref-type="fig" rid="F1">Figure 1</xref>, top right) and not against all stages of all other species (<xref ref-type="fig" rid="F1">Figure 1</xref>, top left).
<fig id="F1" position="float"><label>Figure 1.</label><caption><p>Mapping of developmental species was done via a list of stages common to all bilaterian animals.</p></caption><graphic xlink:href="gkm797f1"/></fig></p>
        <p>Obviously temporal resolution is lost when mapping a list of 40 developmental stages onto a list of only eight common stages, but the eight stages seem to be the largest set shared by all bilaterian species and they represent the key events in the development of an organism. The original species-specific stage annotation is not replaced by the stage mapping terms to keep high temporal resolution. However, the stage mapping establishes temporal relationships that can be used for cross-species queries.</p>
      </sec>
      <sec>
        <title>Anatomy mapping</title>
        <p>The anatomy mapping will be an ongoing process the same as it is also an ongoing debate in the scientific community about which structures can be defined as being homologous. We have not yet carried out a complete anatomy mapping, but we have set up the resources and tools for doing so. Evidence from different analyses will need to be integrated for approaching this problem. One can use lexical, anatomy structure and co-expression cues to establish relationships between the anatomical terms. The first two cues can be used by just comparing the anatomy ontologies available for the model species (<xref ref-type="bibr" rid="B9">9</xref>). For the inclusion of co-expression we are currently examining conserved network patterns in species-specific co-expression networks via orthology relationships. The user can exploit lexical cues already, using the term-based expression search (described below).</p>
        <p>The common anatomy reference ontology (CARO) is being developed to facilitate interoperability between existing anatomy ontologies for different species. It aims to provide a template for building new anatomy ontologies. We think CARO could serve as a template to build an anatomy ontology shared by all bilaterians. Similar to the stage mapping we then want to map species-specific anatomy terms onto this common ontology.</p>
      </sec>
    </sec>
    <sec>
      <title>4D ArrayExpress data warehouse</title>
      <p>Expression data acquired through <italic>in situ</italic> hybridization, antibody or transgenic expression can be complemented through microarray data. The first methods provide high-resolution data in both space and time, which microarray data cannot provide; microarray experiments however can quickly give a quantitative overview on the overall expression of all genes in a genome. Especially useful are time series that provide insight in expression changes during development. That is why we have set up a complementary project at ArrayExpress (<xref ref-type="bibr" rid="B10">10</xref>), which stores corresponding microarray data. The project is called 4D ArrayExpress data warehouse (4DDW) and is accessible at: <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/microarray-as/4DDW_EMBL/">http://www.ebi.ac.uk/microarray-as/4DDW_EMBL/</ext-link>. The 4DDW will be described in detail elsewhere.</p>
      <p>So far we have established 4737 reciprocal links for mouse, <italic>Drosophila</italic> and zebrafish. When querying microarray data at the 4DDW users can quickly go to 4D<italic>Xpress</italic> and vice versa. The close linkage of these two resources allows researchers for example to quickly examine the gene expression patterns of a list of genes that cluster together in a microarray experiment.</p>
    </sec>
    <sec>
      <title>Expression similarity</title>
      <p>Expression patterns within a species can easily be compared when representing the expression annotation as a binary vector (1 for expressed, 0 for not expressed). Different methods to calculate the similarity between these vectors can be applied.</p>
      <p>We have chosen the Jaccard coefficient as a similarity measure for a start, which is simple to calculate and has been used in the first BDGP release (<xref ref-type="bibr" rid="B2">2</xref>) for the same purpose.</p>
      <p>The Jaccard distance has been calculated between the expression vectors of gene pairs. The expression binary vector was compiled considering stage and anatomy. If a gene is expressed (has positive annotation) at a given stage in a given anatomical structure the vector value is set to true, otherwise to false.</p>
      <p>The Jaccard similarity coefficient is defined as the size of the intersection divided by the size of the union of the sample vectors:
<disp-formula><graphic xlink:href="gkm797um1"/></disp-formula></p>
      <p>The Jaccard distance is supposed to estimate how different expression patterns are. However this value depends on the extent and quality of the expression annotation. Thus, in the cases where annotations are incomplete or have been done inconsistently, this measure might be misleading. Also, this method treats all anatomical structures equally. Relations defined in the anatomy ontology are not taken into account. In future we will provide additional similarity measures e.g. the semantic similarity, which accounts for that.</p>
      <p>Still, the Jaccard distance provides a quick and easy way for identifying similarly annotated genes. The values are stored in the database and helps users to find genes within the species with similar expression patterns. This measure can also be used to cluster genes with similar gene expression pattern annotations as shown for <italic>Drosophila</italic> (<xref ref-type="bibr" rid="B2">2</xref>). We use these similarity relationships to generate co-expression networks and plan to search for conserved network patterns across species using orthology relationships.</p>
    </sec>
  </sec>
  <sec>
    <title>CROSS-SPECIES OVERLAP</title>
    <p>Model species differ; they differ in morphology and function; they differ in accessibility by molecular methods; they differ in the genomic and computational resources and in the size of the scientific community working on them. This is reflected in the number of genes annotated for each model species throughout development (<xref ref-type="fig" rid="F2">Figure 2</xref>). Whereas mouse has a large scientific community behind, it is not producing similar amounts of offspring as egg laying fish and <italic>Drosophila</italic>. Embryos are developing internally resulting in a smaller number of annotated genes; however, with high quality annotation. Zebrafish and <italic>Drosophila</italic> are the most complete data sets. There are huge differences in how they were compiled. Whereas the <italic>Drosophila</italic> data was only acquired in a single screen with only a few annotators, the zebrafish data was collected from several large-scale screens and annotated expression patterns from the literature.
<fig id="F2" position="float"><label>Figure 2.</label><caption><p>Comparison of the number of genes annotated at species-specific developmental stages in zebrafish, <italic>Drosophila</italic>, mouse and medaka. Corresponding developmental stages have the same colour. Colour legend for all panels is shown in the mouse panel.</p></caption><graphic xlink:href="gkm797f2"/></fig></p>
    <p>When comparing expression data, it is important to examine the data overlap between the species. For example: How many genes are annotated at corresponding developmental stages? And: How many orthologues have expression annotation?</p>
    <p>In <xref ref-type="fig" rid="F2">Figure 2</xref>, we have marked corresponding developmental stages with the same colour (stage mapping as described above).</p>
    <p>Zebrafish is spanning most developmental stages and largest temporal overlap exists with <italic>Drosophila</italic> (from cleavage till organogenesis). Neurula and organogenesis stages are the best-annotated stages in all four species and therefore most promising to be compared to each other.</p>
    <p>Besides temporal overlap we need orthology overlap to be able to compare expression patterns across species. The overlap we have between annotated genes in the different species combinations is shown in <xref ref-type="table" rid="T2">Table 2</xref>.
<table-wrap id="T2" position="float"><label>Table 2.</label><caption><p>Number of orthologous groups with genes that are annotated in more than one species</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Number of species</th><th rowspan="1" colspan="1">COGs</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Two species</td><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">    Zebrafish, <italic>Drosophila</italic></td><td rowspan="1" colspan="1">964</td></tr><tr><td rowspan="1" colspan="1">    Mouse, Zebrafish</td><td rowspan="1" colspan="1">913</td></tr><tr><td rowspan="1" colspan="1">    Mouse, <italic>Drosophila</italic></td><td rowspan="1" colspan="1">764</td></tr><tr><td rowspan="1" colspan="1"><italic> Drosophila</italic>, Medaka</td><td rowspan="1" colspan="1">341</td></tr><tr><td rowspan="1" colspan="1">    Zebrafish, Medaka</td><td rowspan="1" colspan="1">329</td></tr><tr><td rowspan="1" colspan="1">    Mouse, Medaka</td><td rowspan="1" colspan="1">260</td></tr><tr><td rowspan="1" colspan="1">Three species</td><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">    Mouse, Zebrafish, <italic>Drosophila</italic></td><td rowspan="1" colspan="1">336</td></tr><tr><td rowspan="1" colspan="1">    Zebrafish, <italic>Drosophila</italic>, Medaka</td><td rowspan="1" colspan="1">156</td></tr><tr><td rowspan="1" colspan="1">    Mouse, Zebrafish, Medaka</td><td rowspan="1" colspan="1">135</td></tr><tr><td rowspan="1" colspan="1">    Medaka, Mouse, <italic>Drosophila</italic></td><td rowspan="1" colspan="1">124</td></tr><tr><td rowspan="1" colspan="1">Four species</td><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">    Mouse, Zebrafish, <italic>Drosophila</italic>, Medaka</td><td rowspan="1" colspan="1">68</td></tr></tbody></table></table-wrap></p>
    <p>The numbers in <xref ref-type="table" rid="T2">Table 2</xref> are getting particularly important when doing global computational analyses. When focusing on two species comparisons, zebrafish and <italic>Drosophila</italic> annotations will yield the largest overlap of 964 annotated orthologous groups, when going for three species mouse should be taken into account.</p>
  </sec>
  <sec>
    <title>WEB INTERFACE</title>
    <p>4D<italic>Xpress</italic> is a JAVA-based application with a web-based front-end powered by the servlet container TOMCAT and data are stored in a PostgreSQL relational database. The web application is based on a model-view-controller (MVC) architecture using the Struts Framework, and enhanced with applets, JavaScript and AJAX (Asynchronous JavaScript and XML) technologies to build a powerful, interactive, user-friendly interface. 4D<italic>Xpress</italic> is available at <ext-link ext-link-type="uri" xlink:href="http://ani.embl.de/4DXpress">http://ani.embl.de/4DXpress</ext-link>.</p>
    <p>It is also possible to link to 4D<italic>Xpress</italic> gene entry pages from other projects using the following link <ext-link ext-link-type="uri" xlink:href="http://ani.embl.de/4DXpress/reg/all/search/bquery.do?id">http://ani.embl.de/4DXpress/reg/all/search/bquery.do?id</ext-link> = with a gene identifier as the ID value that can be either an EnsEMBL ID, gene symbol or primary identifier from other public resources (e.g. FlyBase IDs, MGI IDs or ZFIN IDs).</p>
    <sec>
      <title>Query genes</title>
      <p>Genes can be searched either by a range of external identifiers, symbols, names or by their expression pattern annotation. Using the ontology-based form, by selecting a species, the corresponding stage and anatomy ontologies are loaded and information is provided on how many genes are annotated with the listed terms. The term-based form allows more complex queries and cross-species queries can be preformed by selecting ‘Bilateria’. Then, a list of search terms can be entered manually or guided by auto-completion of terms, which have been used for annotation. The fact that corresponding structures often have similar names in the different species allows meaningful cross-species queries using this tool.</p>
      <p>Upon sending the query a gene list is returned, which provides the user with a summary overview. By default this list is ordered by orthologous groups, which facilitates the comparison of orthologous genes in the different species.</p>
      <p>When picking an individual gene entry the full information on that gene is displayed: external identifiers, gene description, expression pattern annotation using stage and anatomy ontologies, images of stained embryos and orthology relationships (visualized as a network). From the gene view a list of orthologues can be selected and their expression annotation and images can be compared to each other on a single page. A cropped screenshot comparing medaka Six3 and its <italic>Drosophila</italic> orthologue Optix is shown in <xref ref-type="fig" rid="F3">Figure 3</xref>.
<fig id="F3" position="float"><label>Figure 3.</label><caption><p>The comparative view shows expression patterns of a list of selected genes (medaka Six3 and its <italic>Drosophila</italic> orthologue Optix). Expression annotation and images can be easily compared between the genes on a single page.</p></caption><graphic xlink:href="gkm797f3"/></fig></p>
      <p>Also, a list of similarly expressed genes within the same species is provided, which was calculated using the Jaccard coefficient (see above). Users can select some of them and compare them like shown in <xref ref-type="fig" rid="F3">Figure 3</xref>.</p>
    </sec>
    <sec>
      <title>Ontology browser</title>
      <p>Ontologies are becoming widely used to annotate units of information by providing controlled vocabularies and structured knowledge. Therefore, anatomy ontologies are useful to enforce standard terminology for gene expression annotation as well as for making this information accessible to computational analysis, but at the same time database usage becomes more complex to non-expert users. We provide a tree-based tool to help users to browse ontologies that were used for expression pattern annotation. It allows users to query terms and expand or collapse individual nodes.</p>
      <p>Developmental stage ontologies can be browsed by species and external links provide more information on stage definitions. Species-specific stage ontologies were mapped onto a common stage list (<xref ref-type="fig" rid="F1">Figure 1</xref>) and thereby temporal relationships were established, which can be accessed via web interface.</p>
    </sec>
    <sec>
      <title>Annotation tool</title>
      <p>Our annotation tool allows users to annotate gene expression patterns resulting from any of the three types of experiments: whole mount <italic>in situ</italic> hybridization, transgenic reporter gene expression or antibody staining. The same tool can be used for all supported species (for now: zebrafish, mouse, medaka, <italic>Drosophila</italic>, platynereis). Species-specific ontologies for developmental stages and anatomies can be loaded and users can customize a list of favorite terms to be used.</p>
    </sec>
  </sec>
  <sec>
    <title>CONCLUSIONS AND FUTURE DIRECTIONS</title>
    <p>We have integrated expression data on 16 505 genes in the four important developmental model species: mouse, zebrafish, <italic>Drosophila</italic> and medaka. We developed a stable database schema and a powerful web interface to access this data. With the interface cross-species queries can be done, facilitated by a stage mapping. An expression similarity measure is implemented to find genes with similar expression patterns and links to all original data sources are provided.</p>
    <p>With these tools in place we aim to integrate more species, which are available in the public domain like <italic>Xenopus laevis</italic> with 17.000 images, Ciona and <italic>Caenorhabditis elegans</italic>. We have set up the infrastructure to analyse and compare the data. We will analyse the features of <italic>in situ</italic> co-expression networks and compare them between the species and to co-expression networks derived from microarray data. We will use conserved network patterns to assess mapping of anatomical structures.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>This work was carried out in the Centre for Computational Biology at EMBL. We are grateful to the model organism database crews for providing us their expression pattern data. In particular we thank Martin Ringwald and Susan McClatchy to give us direct access to the MGI database; thanks to Monte Westerfield and Judy Sprague for helping us with the ZFIN data reports; we thank Pavel Tomancak for helping us to understand the BDGP mySQL schema.</p>
    <p>We thank Mirana Ramialison for extending the medaka annotation and Francois Spitz for mouse <italic>in situ</italic> images. We are grateful to the MISFISHIE team for initiating an expression pattern data exchange format. Funding to pay the Open Access publication charges for this article was provided by EMBL.</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sprague</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bayraktaroglu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Clements</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Conlin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fashena</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Frazer</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Haendel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Howe</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Mani</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The zebrafish information network: the zebrafish model organism database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>D581</fpage>
        <lpage>D585</lpage>
        <pub-id pub-id-type="pmid">16381936</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomancak</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Berman</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Beaton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Weiszmann</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kwan</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hartenstein</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Celniker</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Global analysis of patterns of gene expression during <italic>Drosophila</italic> embryogenesis</article-title>
        <source>Genome Biol.</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>R145</fpage>
        <pub-id pub-id-type="pmid">17645804</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grumbling</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Strelets</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>FlyBase: anatomical data, images and queries</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>D484</fpage>
        <lpage>D488</lpage>
        <pub-id pub-id-type="pmid">16381917</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Henrich</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ramialison</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wittbrodt</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Assouline</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bourrat</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Himmelbauer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sasaki</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shimizu</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MEPD: a resource for medaka gene expression patterns</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3195</fpage>
        <lpage>3197</lpage>
        <pub-id pub-id-type="pmid">15879458</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Finger</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Hayamizu</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>McCright</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>Eppig</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Kadin</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Ringwald</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The mouse gene expression database (GXD): 2007 update</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>D618</fpage>
        <lpage>D623</lpage>
        <pub-id pub-id-type="pmid">17130151</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christiansen</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Venkataraman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stevenson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Burton</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Baldock</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Davidson</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>EMAGE: a spatial database of gene expression patterns during mouse embryo development</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>D637</fpage>
        <lpage>D641</lpage>
        <pub-id pub-id-type="pmid">16381949</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deutsch</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Ball</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Bova</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Brazma</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bumgarner</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Causton</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Christiansen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Davidson</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Development of the minimum information specification for in situ hybridization and immunohistochemistry experiments (MISFISHIE)</article-title>
        <source>Omics</source>
        <year>2006</year>
        <volume>10</volume>
        <fpage>205</fpage>
        <lpage>208</lpage>
        <pub-id pub-id-type="pmid">16901227</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubbard</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Aken</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Beal</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ballester</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Caccamo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Coates</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cunningham</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Ensembl 2007</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>D610</fpage>
        <lpage>D617</lpage>
        <pub-id pub-id-type="pmid">17148474</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bodenreider</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Aligning representations of anatomy using lexical and structural methods</article-title>
        <source>AMIA Annu. Symp. Proc.</source>
        <year>2003</year>
        <volume>00</volume>
        <fpage>753</fpage>
        <lpage>757</lpage>
        <pub-id pub-id-type="pmid">14728274</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Parkinson</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kapushesky</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shojatalab</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Abeygunawardena</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Coulson</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Farne</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Holloway</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kolesnykov</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lilja</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ArrayExpress – a public database of microarray experiments and gene expression profiles</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2007</year>
        <volume>35</volume>
        <fpage>D747</fpage>
        <lpage>D750</lpage>
        <pub-id pub-id-type="pmid">17132828</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
