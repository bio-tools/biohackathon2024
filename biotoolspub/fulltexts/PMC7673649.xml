<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nature</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nature</journal-id>
    <journal-title-group>
      <journal-title>Nature</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0028-0836</issn>
    <issn pub-type="epub">1476-4687</issn>
    <publisher>
      <publisher-name>Nature Publishing Group UK</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7673649</article-id>
    <article-id pub-id-type="pmid">33177663</article-id>
    <article-id pub-id-type="publisher-id">2871</article-id>
    <article-id pub-id-type="doi">10.1038/s41586-020-2871-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Progressive Cactus is a multiple-genome aligner for the thousand-genome era</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2077-4671</contrib-id>
        <name>
          <surname>Armstrong</surname>
          <given-names>Joel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hickey</surname>
          <given-names>Glenn</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0430-0989</contrib-id>
        <name>
          <surname>Diekhans</surname>
          <given-names>Mark</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fiddes</surname>
          <given-names>Ian T.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5828-047X</contrib-id>
        <name>
          <surname>Novak</surname>
          <given-names>Adam M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Deran</surname>
          <given-names>Alden</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9181-8689</contrib-id>
        <name>
          <surname>Fang</surname>
          <given-names>Qi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7010-3601</contrib-id>
        <name>
          <surname>Xie</surname>
          <given-names>Duo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2462-7348</contrib-id>
        <name>
          <surname>Feng</surname>
          <given-names>Shaohong</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6009-9581</contrib-id>
        <name>
          <surname>Stiller</surname>
          <given-names>Josefin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Genereux</surname>
          <given-names>Diane</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Johnson</surname>
          <given-names>Jeremy</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Marinescu</surname>
          <given-names>Voichita Dana</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Alföldi</surname>
          <given-names>Jessica</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Harris</surname>
          <given-names>Robert S.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lindblad-Toh</surname>
          <given-names>Kerstin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1533-4575</contrib-id>
        <name>
          <surname>Haussler</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4343-3776</contrib-id>
        <name>
          <surname>Karlsson</surname>
          <given-names>Elinor</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff10">10</xref>
        <xref ref-type="aff" rid="Aff11">11</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jarvis</surname>
          <given-names>Erich D.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff9">9</xref>
        <xref ref-type="aff" rid="Aff12">12</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6860-1521</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Guojie</given-names>
        </name>
        <address>
          <email>guojie.zhang@bio.ku.dk</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff13">13</xref>
        <xref ref-type="aff" rid="Aff14">14</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8863-3539</contrib-id>
        <name>
          <surname>Paten</surname>
          <given-names>Benedict</given-names>
        </name>
        <address>
          <email>bpaten@ucsc.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0740 6917</institution-id><institution-id institution-id-type="GRID">grid.205975.c</institution-id><institution>UC Santa Cruz Genomics Institute, UC Santa Cruz, </institution></institution-wrap>Santa Cruz, CA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2034 1839</institution-id><institution-id institution-id-type="GRID">grid.21155.32</institution-id><institution>BGI-Shenzhen, Beishan Industrial Zone, </institution></institution-wrap>Shenzhen, China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0674 042X</institution-id><institution-id institution-id-type="GRID">grid.5254.6</institution-id><institution>Section for Ecology and Evolution, Department of Biology, </institution><institution>University of Copenhagen, </institution></institution-wrap>Copenhagen, Denmark </aff>
      <aff id="Aff4"><label>4</label>BGI Education Center, University of Chinese Academy of Sciences, Shenzhen, China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1792 7072</institution-id><institution-id institution-id-type="GRID">grid.419010.d</institution-id><institution>State Key Laboratory of Genetic Resources and Evolution, </institution><institution>Kunming Institute of Zoology, Chinese Academy of Sciences, </institution></institution-wrap>Kunming, China </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.66859.34</institution-id><institution>Broad Institute of Harvard and Massachusetts Institute of Technology (MIT), </institution></institution-wrap>Cambridge, MA USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 9457</institution-id><institution-id institution-id-type="GRID">grid.8993.b</institution-id><institution>Science for Life Laboratory, Department of Medical Biochemistry and Microbiology, </institution><institution>Uppsala University, </institution></institution-wrap>Uppsala, Sweden </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2097 4281</institution-id><institution-id institution-id-type="GRID">grid.29857.31</institution-id><institution>Department of Biology, </institution><institution>The Pennsylvania State University, </institution></institution-wrap>University Park, PA USA </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2167 1581</institution-id><institution-id institution-id-type="GRID">grid.413575.1</institution-id><institution>Howard Hughes Medical Institute, </institution></institution-wrap>Chevy Chase, MD USA </aff>
      <aff id="Aff10"><label>10</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0742 0364</institution-id><institution-id institution-id-type="GRID">grid.168645.8</institution-id><institution>Program in Molecular Medicine, </institution><institution>University of Massachusetts Medical School, </institution></institution-wrap>Worcester, MA USA </aff>
      <aff id="Aff11"><label>11</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0742 0364</institution-id><institution-id institution-id-type="GRID">grid.168645.8</institution-id><institution>Bioinformatics and Integrative Biology, </institution><institution>University of Massachusetts Medical School, </institution></institution-wrap>Worcester, MA USA </aff>
      <aff id="Aff12"><label>12</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2166 1519</institution-id><institution-id institution-id-type="GRID">grid.134907.8</institution-id><institution>Laboratory of Neurogenetics of Language, </institution><institution>The Rockefeller University, </institution></institution-wrap>New York, NY USA </aff>
      <aff id="Aff13"><label>13</label><institution-wrap><institution-id institution-id-type="ISNI">0000000119573309</institution-id><institution-id institution-id-type="GRID">grid.9227.e</institution-id><institution>Center for Excellence in Animal Evolution and Genetics, </institution><institution>Chinese Academy of Sciences, </institution></institution-wrap>Kunming, China </aff>
      <aff id="Aff14"><label>14</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2034 1839</institution-id><institution-id institution-id-type="GRID">grid.21155.32</institution-id><institution>China National GeneBank, BGI-Shenzhen, </institution></institution-wrap>Shenzhen, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <year>2020</year>
    </pub-date>
    <volume>587</volume>
    <issue>7833</issue>
    <fpage>246</fpage>
    <lpage>251</lpage>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>8</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>7</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">New genome assemblies have been arriving at a rapidly increasing pace, thanks to decreases in sequencing costs and improvements in third-generation sequencing technologies<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref></sup>. For example, the number of vertebrate genome assemblies currently in the NCBI (National Center for Biotechnology Information) database<sup><xref ref-type="bibr" rid="CR4">4</xref></sup> increased by more than 50% to 1,485 assemblies in the year from July 2018 to July 2019. In addition to this influx of assemblies from different species, new human de novo assemblies<sup><xref ref-type="bibr" rid="CR5">5</xref></sup> are being produced, which enable the analysis of not only small polymorphisms, but also complex, large-scale structural differences between human individuals and haplotypes. This coming era and its unprecedented amount of data offer the opportunity to uncover many insights into genome evolution but also present challenges in how to adapt current analysis methods to meet the increased scale. Cactus<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>, a reference-free multiple genome alignment program, has been shown to be highly accurate, but the existing implementation scales poorly with increasing numbers of genomes, and struggles in regions of highly duplicated sequences. Here we describe progressive extensions to Cactus to create Progressive Cactus, which enables the reference-free alignment of tens to thousands of large vertebrate genomes while maintaining high alignment quality. We describe results from an alignment of more than 600 amniote genomes, which is to our knowledge the largest multiple vertebrate genome alignment created so far.</p>
    </abstract>
    <abstract id="Abs2" abstract-type="web-summary">
      <p id="Par2">The Progressive Cactus program can create reference-free alignments of hundreds of large vertebrate genomes efficiently, and is used for the alignment of more than 600 amniote genomes.</p>
    </abstract>
    <kwd-group kwd-group-type="npg-subject">
      <title>Subject terms</title>
      <kwd>Genome informatics</kwd>
      <kwd>Phylogeny</kwd>
      <kwd>Software</kwd>
      <kwd>Comparative genomics</kwd>
    </kwd-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s), under exclusive licence to Springer Nature Limited 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Main</title>
    <p id="Par3">Comparative genomics analyses, including species-tree inference<sup><xref ref-type="bibr" rid="CR7">7</xref>,<xref ref-type="bibr" rid="CR8">8</xref></sup>, comparative annotation<sup><xref ref-type="bibr" rid="CR9">9</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup>, and selection detection<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup>, require genome alignments. Multi-species genome alignment involves creating a mapping from each region of each genome to a corresponding region in each other genome, taking into account the possibility of complex rearrangements and copy number changes<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. Genome aligners are one of the most fundamental tools used in comparative genomics, but because the problem is difficult, different aligners frequently give different results<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, and many intentionally limit the alignments they produce to simplify the problem. Two of the most common limitations are ‘reference bias’, the result of constraining a multiple alignment to only regions present in a single reference genome, and restricting the alignment to be ‘single-copy’, which allows only a single alignment in any column in any given genome, causing the alignment to miss multiple-orthology relationships created by lineage-specific duplications. Cactus<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> is a genome alignment program that has neither of these restrictions; it can generate a reference-free multiple alignment that allows the detection of multiple-orthology relationships.</p>
    <p id="Par4">The version of Cactus available in 2012 performed very well in the Alignathon<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>, an evaluation of genome aligners. However, the runtime of that initial iteration of Cactus scaled quadratically with the total number of bases in the alignment problem, making alignment of more than about ten vertebrate genomes completely impractical. To address these difficulties, we present fundamental changes to the Cactus process that incorporate a progressive alignment strategy<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>, which changes the runtime of the alignment to scale linearly with the number of genomes. We show that the result, which we call Progressive Cactus, is an aligner that retains state-of-the-art accuracy, and continues to lack reference bias, but which is tractable to use on hundreds to thousands of large, vertebrate-sized input genomes. Progressive Cactus has been developed over several years, and has already been successfully used as an integral component of high-profile comparative genomics projects<sup><xref ref-type="bibr" rid="CR16">16</xref>–<xref ref-type="bibr" rid="CR20">20</xref></sup>.</p>
  </sec>
  <sec id="Sec2">
    <title>Progressive Cactus</title>
    <p id="Par5">The new Progressive Cactus pipeline is freely available and open source. The only inputs needed are a guide tree and a FASTA file for each genome assembly.</p>
    <p id="Par6">The key innovation of Progressive Cactus is to adapt the classic ‘progressive’ strategy (used in collinear multiple alignment for decades) to a whole-genome alignment setting. Progressive aligners use a ‘guide tree’ to recursively break a multiple alignment problem into many smaller sub-alignments, each of which is solved independently; the resulting sub-alignments are themselves aligned together according to the tree structure to create the final alignment. Progressive alignment has been successfully applied to whole-genome alignment before—for example, by progressiveMauve<sup><xref ref-type="bibr" rid="CR21">21</xref></sup> and TBA/MULTIZ<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. Cactus now follows a similar strategy, with the key innovation being that Progressive Cactus implements a progressive-alignment strategy for whole-genome alignment using reconstructed ancestral assemblies as the method for combining sub-alignments. This strategy (analogous to the MAVID<sup><xref ref-type="bibr" rid="CR23">23</xref></sup> strategy of using ancestral reconstruction in collinear multiple alignment) not only results in a much faster alignment runtime but also produces ancestral reconstructions.</p>
    <p id="Par7">Figure <xref rid="Fig1" ref-type="fig">1a</xref> shows the overall organization of the Progressive Cactus process. The guide tree, which need not be fully resolved (binary), is used to recursively split a large alignment problem (comparing every genome to every other genome) into many small subproblems, each of which compares only a small number (usually 2–5) of genomes against one another. The purpose of each subproblem is to reconstruct an ancestral assembly at each internal node in the guide tree, as well as to generate alignments between that internal node’s children and its ancestral reconstruction. The ancestral assemblies are then used as input genomes in subproblems further up the tree, and the parent–child alignments are later combined to produce the full alignment. Two sets of genomes are considered: the children of the internal node (which we call the ‘ingroup genomes’), and a set of non-descendants of that node (the ‘outgroup genomes’). The ingroup genomes form the core alignment relationship being established at this node. The outgroup genomes serve to answer the question of what sequence from the ingroups is also present in the ancestor (whether an indel among the ingroups is likely to be a deletion rather than an insertion), and in how many copies (whether a duplication predates or postdates the speciation event the node represents). The outgroups also provide information for guiding the ancestral assembly by providing order-and-orientation information, as well as base-level information when generating ancestral sequences. These genome sets are used as the input to the main subproblem workflow (Fig. <xref rid="Fig1" ref-type="fig">1b</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><title>The alignment process within Progressive Cactus.</title><p><bold>a</bold>, A large alignment problem is split into many smaller subproblems using an input guide tree. Each subproblem compares a set of ingroup genomes (the children of the internal node to be reconstructed) against each other as well as a sample of outgroup genomes (non-descendants of the internal node in question). <bold>b</bold>, Flowchart represents the phases in which the overall alignment, as well as each subproblem alignment, proceeds through. The end result is a new genome assembly that represents the Progressive Cactus reconstruction of the ancestral genome, and an alignment between this ancestral genome and its children. After all subproblems have been completed, the parent–child alignments are combined to create the full reference-free alignment in the HAL<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> format.</p></caption><graphic xlink:href="41586_2020_2871_Fig1_HTML" id="d33e498"/></fig></p>
    <p id="Par8">Each individual subproblem follows a similar procedure to the original Cactus process. The subproblem procedure begins with a set of pairwise local alignments generated via the sensitive pairwise local-alignment program LASTZ<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. These pairwise alignments are then filtered and combined into a cactus graph representing an initial multiple alignment using the previously described CAF algorithm<sup><xref ref-type="bibr" rid="CR6">6</xref></sup>—although we note important changes to the filtering in Methods and Extended Data Fig. <xref rid="Fig5" ref-type="fig">1</xref>—to attempt to recover the homologies that date to the most recent common ancestor of the ingroup genomes. The initial alignment is refined using the previously described BAR algorithm<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> to create a more complete alignment. The ancestral assembly is then created by ordering the blocks in this final alignment and establishing a most-likely base call for each column in each block. The resulting ancestral sequence is then fed into later subproblems (unless the root of the guide tree has been reached, which ends the alignment process).</p>
    <p id="Par9">As a practical matter, Progressive Cactus uses the Toil<sup><xref ref-type="bibr" rid="CR25">25</xref></sup> workflow framework to organize and distribute its computational tasks. Although genome alignment is a computationally intensive task, using Toil, we can break up the problem into small pieces that can work in heterogeneous compute environments, playing to the advantages of both cheap CPU-rich machines and more expensive memory-rich machines. Because it runs on Toil and supports container execution via Docker and Singularity<sup><xref ref-type="bibr" rid="CR26">26</xref></sup>, Progressive Cactus can be run on many different environments: single machines (for small alignments), conventional clusters, and commercial clouds.</p>
    <p id="Par10">Given the rate of arrival of new assembly versions and newly sequenced genomes, adding new information to an alignment without recomputing it from scratch is valuable, especially for large alignments in which recomputing the entire alignment is often cost-prohibitive. Progressive Cactus, combined with special functionality in the HAL toolkit<sup><xref ref-type="bibr" rid="CR27">27</xref></sup>, therefore supports the addition and removal of genomes from the alignment by taking advantage of the tree structure of the progressive alignments it produces (Methods, Extended Data Fig. <xref rid="Fig6" ref-type="fig">2</xref>, Extended Data Table <xref rid="Tab2" ref-type="table">1</xref>).</p>
  </sec>
  <sec id="Sec3">
    <title>Evaluation on simulated data</title>
    <p id="Par11">The Alignathon simulated datasets<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> have been aligned with many competing genome aligners and have a known truth set, providing a way to compare Progressive Cactus against other genome aligners. Progressive Cactus produces alignments with higher accuracy for both simulated primate (<italic>F</italic><sub>1</sub> score of 0.989) and mammal (<italic>F</italic><sub>1</sub> score of 0.795) clades than any aligner that participated in the Alignathon (Supplementary Tables <xref rid="MOESM1" ref-type="media">1</xref>, <xref rid="MOESM1" ref-type="media">2</xref>), including the original version of Cactus.</p>
    <p id="Par12">To evaluate the improvements in quality and runtime of the alignments produced using the new progressive alignment strategy, we simulated the evolution of twenty 30-megabase genomes using Evolver (<ext-link ext-link-type="uri" xlink:href="https://www.drive5.com/evolver">https://www.drive5.com/evolver</ext-link>) along a tree of catarrhines. We ran two alignment strategies—one using a fully resolved binary guide tree (which takes full advantage of the new progressive mode), and one using a fully unresolved star guide tree (which is similar to the originally published version of Cactus)—across variously sized subsets of genomes roughly evenly spaced throughout the catarrhine tree. The alignments using the progressive strategy finished more quickly, with the speed improvement growing larger with the increasing number of species (for example, a 15% reduction in runtime for 10 species and 48% for 20 species), owing to its linear runtime scaling, as opposed to the quadratic scaling of the star-tree (Fig. <xref rid="Fig2" ref-type="fig">2a</xref>). The progressive strategy is also more accurate than the star strategy (Fig. <xref rid="Fig2" ref-type="fig">2b</xref>) and maintains accuracy as the number of species (and therefore nodes in the tree) increases.<fig id="Fig2"><label>Fig. 2</label><caption><title>Comparing alignments of varying numbers of simulated genomes using Progressive Cactus.</title><p><bold>a</bold>, The progressive mode of Progressive Cactus is shown, versus the mode without progressive decomposition that is similar to that previously described<sup><xref ref-type="bibr" rid="CR6">6</xref></sup> (‘star’). The average total runtime of the two alignment methods across three runs is shown. Data are mean and s.d. The runtime is identical when aligning two genomes as the alignment problem is not further decomposed, but the linear scaling of the progressive mode means it is much faster with large numbers of genomes than the quadratic scaling required without progressive alignment. <bold>b</bold>, The precision, recall and <italic>F</italic><sub>1</sub> score (harmonic mean of precision and recall) of aligned pairs for each alignment compared with pairs from the true alignment produced by the simulation.</p><p><xref rid="MOESM5" ref-type="media">Source data</xref></p></caption><graphic xlink:href="41586_2020_2871_Fig2_HTML" id="d33e597"/></fig></p>
  </sec>
  <sec id="Sec4">
    <title>Effect of the guide tree</title>
    <p id="Par13">Because Progressive Cactus uses an input guide tree to decompose the alignment problem, the guide tree can potentially impact the resulting alignment. This could be problematic when the exact species tree relating the input set of genomes is unknown or controversial. However, we reduce any effect of the guide tree by including a great deal of outgroup information, including multiple outgroups when possible. To quantify the effect of the guide tree on a large alignment with an uncertain species tree, we created four alignments of a set of 48 avian species (Supplementary Table <xref rid="MOESM1" ref-type="media">3</xref>), which we subset down to a single chromosome (chromosome 1). The avian species tree is still being actively debated<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup> and there are different plausible hypotheses, making birds an excellent test case with no single clearly correct guide tree. We aligned these birds using four different guide trees: two trees that represent two different hypotheses about the avian species tree<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup>, one consensus tree between the former two trees, and one tree that was randomly permuted from one of the previously published trees<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> (Methods, Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>). The four alignments were highly similar, with an average of 98.5% of aligned pairs identical between any two different alignments (Extended Data Table <xref rid="Tab3" ref-type="table">2</xref>).</p>
    <p id="Par14">We further examined whether these small differences in the guide tree affect some species more than others. For any pair of these 48 species, the <italic>F</italic><sub>1</sub> score for aligned pairs between the previously published<sup><xref ref-type="bibr" rid="CR28">28</xref>,<xref ref-type="bibr" rid="CR29">29</xref></sup> alignments was at least 0.955 (Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref>). As an example, the phylogenetic relationship between the species <italic>Cuculus canorus</italic>, <italic>Chlamydotis macqueenii</italic> and <italic>Tauraco erythrolophus</italic> is different in the guide tree based on Prum et al.<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> than that based on Jarvis et al.<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>). The <italic>F</italic><sub>1</sub> score for aligned pairs within this clade between the two alignments was 0.972, lower but comparable to the score for a similar clade that had an identical phylogenetic relationship in both trees, 0.982 (for <italic>Merops nubicus</italic>, <italic>Picoides pubescens</italic> and <italic>Buceros rhinoceros</italic>).</p>
  </sec>
  <sec id="Sec5">
    <title>Effect of assembly quality on alignment</title>
    <p id="Par15">Our progressive approach means that the alignment between two genomes distant in the guide tree is informed by the reconstructions of the ancestral genomes along the path, which is in turn formed using data from other genomes in the tree. To evaluate the practical effect of differing quality of input assemblies, we created two alignments of 11 boreoeutherian mammal species, 7 of which represented either high-quality assemblies in one alignment (using modern assemblers and often long-read data) or lower quality assemblies in the other alignment (usually using much older shorter-read technologies) (Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>). The remaining four assemblies were held constant to facilitate a comparison between the two alignments. Despite alignment differences between the long-read and short-read assemblies (Supplementary Table <xref rid="MOESM1" ref-type="media">5</xref>), the alignment between these four assemblies was similar in both datasets (for example, 0.855 Jaccard similarity between induced pairwise human–dog alignments) (Supplementary Fig. <xref rid="MOESM1" ref-type="media">4</xref>), a level of similarity higher than seen between alignment strategies, indicating that the progressive alignment strategy can tolerate poor assemblies. Reinforcing this, comparing the induced pairwise alignments of human–dog to direct pairwise alignments computed using the established chains and nets pipeline<sup><xref ref-type="bibr" rid="CR30">30</xref></sup>, we find the same level of Jaccard similarity for both the high- and low-quality assembly alignments (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>). Of the aligned pairs in the induced pairwise Progressive Cactus alignments, 82% were found in the chains and nets alignment, and, vice versa, 78% of pairs in the chains and nets alignment were found in each Progressive Cactus alignment. Concordant results were found comparing human–mouse pairwise alignments (Supplementary Fig. <xref rid="MOESM1" ref-type="media">5</xref>).</p>
  </sec>
  <sec id="Sec6">
    <title>600-way amniote alignment</title>
    <p id="Par16">To demonstrate Progressive Cactus, we present results from an alignment of 605 amniote genomes, relating in a reference-free manner to more than 1 trillion bases of DNA across hundreds of millions of years of genome evolution (an estimated 35.4 neutral substitutions per site). The amniote-wide alignment combines two smaller alignments: one created for the initial release of the Zoonomia project<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, which includes 242 placental mammals representing most eutherian mammal families, and one for the Bird 10,000 genomes (B10K) project<sup><xref ref-type="bibr" rid="CR32">32</xref></sup>, which includes 363 avians, also representing most bird families. The overall topology is shown in Fig. <xref rid="Fig3" ref-type="fig">3a</xref>. To our knowledge, this represents the largest whole-genome alignment created so far. Table <xref rid="Tab1" ref-type="table">1</xref> contains aggregate statistics on this alignment.<fig id="Fig3"><label>Fig. 3</label><caption><title>Analysing the 600-way amniote alignment.</title><p><bold>a</bold>, The species tree relating the 600 genomes. Branches are coloured by clades as in <bold>b</bold> and <bold>c</bold>. <bold>b</bold>, Percentage coverage on human within the eutherian mammals, grouped by clade from highest to lowest coverage. <bold>c</bold>, As in <bold>b</bold>, but for coverage on chicken within the avian alignment. <bold>d</bold>, Percentage of various regions within the human genome mappable to each ancestral genome reconstructed along the path leading from human to the root. The positions of selected ancestors are labelled by dotted lines to indicate useful taxonomic reference points as context. UTR, untranslated region. <bold>e</bold>, As in <bold>d</bold>, but for the path of reconstructed ancestors between chicken and the root.</p><p><xref rid="MOESM6" ref-type="media">Source data</xref></p></caption><graphic xlink:href="41586_2020_2871_Fig3_HTML" id="d33e761"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Aggregate statistics for the 600-way alignment</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Alignment</th><th>No. of genomes</th><th>Total bases</th><th>Instance-hours</th><th>Core-hours</th><th>Common ancestor size</th></tr></thead><tbody><tr><td>Zoonomia</td><td>242</td><td>669 billion</td><td>68,166</td><td>1.9 million</td><td>1.73 Gb</td></tr><tr><td>B10K</td><td>363</td><td>400 billion</td><td>5,302</td><td>0.2 million</td><td>1.13 Gb</td></tr><tr><td>Combined</td><td>605</td><td>1.07 trillion</td><td>73,692</td><td>2.1 million</td><td>181 Mb</td></tr></tbody></table><table-wrap-foot><p>The increase in computational work for the mammal alignment compared with the bird alignment is largely caused by the increase in the pairwise alignment phase runtime because it scales quadratically with the size of the genomes being aligned.</p></table-wrap-foot></table-wrap></p>
    <p id="Par17">Coverage within the 600-way alignment closely tracks phylogenetic distance and genome size; for example, a median coverage on human of 2.3 gigabases (Gb) from Euarchonta mammalian species, versus 1.2 Gb and 1.0 Gb from more distant Laurasiatheria and Glires mammalian species, respectively (Fig. <xref rid="Fig3" ref-type="fig">3b, c</xref>). The ancestral reconstructions within the 600-way alignment are highly complete, especially for functional sequence: 86% of human coding bases are represented in our reconstruction of the ancestor of all placental mammals, whereas 95% of chicken coding bases are represented in our reconstruction of the common ancestor of avians (Fig. <xref rid="Fig3" ref-type="fig">3d, e</xref>). Owing to the long branch length (approximately 0.7 substitutions-per-site divergence between the two clades), the amniote (human–chicken) ancestral assembly has a much lower proportion of reconstructed sequence than its immediate children, the avian and eutherian mammal ancestors, for example, retaining 16.3% of chicken intron bases versus 84.4% in the avian ancestor, and 7.2% of human intron bases versus 56.5% in the eutherian ancestor. However, coding bases are still well retained (86.8% from chicken and 58.7% from human). The ancestral assemblies consistently contain a relatively higher proportion of sequence for avians than for mammals even across similar phylogenetic distances, consistent with a more conservative mode of genome evolution in avians that is influenced by lower repeat counts and denser gene content<sup><xref ref-type="bibr" rid="CR33">33</xref></sup>.</p>
    <p id="Par18">The ancestral reconstructions provide a history of substitution, indel and rearrangement events. Although this history is by its nature only a hypothetical reconstruction of the true history of genome evolution along the tree, it is accurate enough to be useful. To demonstrate the utility of the indel history, we examined rates of small (less than or equal to 20 base pairs (bp)) insertion and deletion events in the 600-way alignment. As expected from previous studies<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR34">34</xref></sup>, the rate of small indels in any given branch was correlated with the rate of nucleotide substitution (an <italic>R</italic><sup>2</sup> value of 0.69 for insertions and 0.80 for deletions in avians, and 0.39 and 0.40, respectively, for eutherians), although the relative rates remained lower for insertions (1.2% of the substitution rate for both clades) and for deletions (2.4% and 1.2% of the substitution rate for avians and eutherians, respectively). Notably, we observe similar rates of deletions between eutherian and avian lineages, but evidence of a slightly increased rate of insertions in avians (Extended Data Fig. <xref rid="Fig7" ref-type="fig">3a</xref>). The ancestral assemblies also represent even difficult-to-align regions such as transposable elements. We ran RepeatMasker<sup><xref ref-type="bibr" rid="CR35">35</xref></sup> on several human ancestors, focusing on the recently-emerged L1PA6 family of L1 retrotransposons. When ascending the primate tree, approaching the origin of modern L1PA6 elements above the human–rhesus ancestor, L1PA6 elements appear increasingly similar to their consensus sequence (Extended Data Fig. <xref rid="Fig7" ref-type="fig">3b</xref>, Supplementary Fig. <xref rid="MOESM1" ref-type="media">6</xref>).</p>
    <p id="Par19">Despite its scale, sub-alignments of the 600-way are similar to smaller alignments of the same species. Within the 7.1 billion aligned base pairs involving human, mouse, rat or dog within the 600-way, 76.49% were present in an alignment with less than a tenth the number of species (Supplementary Fig. <xref rid="MOESM1" ref-type="media">7</xref>)—this similarity is in line with that observed between different alignments of these same species<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. As expected, the alignments more strongly agree in functional regions, such as coding exons, than for the genome as a whole (Supplementary Fig. <xref rid="MOESM1" ref-type="media">8</xref>). The size and fraction of functional elements reconstructed in ancestors shared between the 600-way and smaller alignments of mammals and, separately, avians were also highly similar (Supplementary Figs. <xref rid="MOESM1" ref-type="media">9</xref>, <xref rid="MOESM1" ref-type="media">10</xref>).</p>
    <p id="Par20">To evaluate the relative accuracy of the progressive alignment process back to the amniote ancestor, human protein-coding transcripts and genes were mapped to the chicken genome using translated BLAT<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>, translated BLAST<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>, LASTZ<sup><xref ref-type="bibr" rid="CR24">24</xref></sup> and the 600-way alignment. Of 84,001 transcripts, BLAT mapped 70%, BLAST mapped 80%, LASTZ mapped 67%, and Progressive Cactus mapped 74%. Both Progressive Cactus and LASTZ had much lower levels of multi-mapping (2–3% of transcripts) than either translated method (16–51%) (Supplementary Tables <xref rid="MOESM1" ref-type="media">6</xref>–<xref rid="MOESM1" ref-type="media">8</xref>). Comparison of Cactus and LASTZ coding sequence mappings to the union of the translated alignments, both in terms of individual gene counts and coding and mRNA bases, showed that Cactus has a marginally higher fraction of shared elements with the translated alignments than LASTZ (Supplementary Table <xref rid="MOESM1" ref-type="media">9</xref>). Supporting this result, comparing the median per-transcript and per-gene base-level Jaccard similarity of these mappings to chicken, while Progressive Cactus and LASTZ were most similar, Progressive Cactus was more similar to translated BLAT and Blast than LASTZ was (Supplementary Figs. <xref rid="MOESM1" ref-type="media">11</xref>, <xref rid="MOESM1" ref-type="media">12</xref>, Supplementary Table <xref rid="MOESM1" ref-type="media">10</xref>). Both Progressive Cactus and LASTZ have higher base-level similarity with existing chicken annotations than either translated alignment method (Supplementary Table <xref rid="MOESM1" ref-type="media">11</xref>).</p>
    <p id="Par21">The B10K species were also separately aligned with MULTIZ<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> using the chicken genome as the reference, allowing us to make a comparison between the two resulting alignments. Progressive Cactus aligned more total bases to chicken (covering an average of 69.4% of the chicken genome from the other species) than MULTIZ (64.9%), for an average increase of 47 Mb. Because, unlike Progressive Cactus, MULTIZ is reference-biased, the difference is starker when looking at the number of bases aligned to a genome not used as the MULTIZ reference (an average of 79% of the zebra finch covered versus 49.2%, for an average increase of 367 Mb) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><title>Comparing Cactus and MULTIZ alignment coverage.</title><p>A comparison of coverage in the Progressive Cactus avian alignment compared to a chicken-referenced MULTIZ<sup><xref ref-type="bibr" rid="CR22">22</xref></sup> alignment of the same genomes. Coverage of both alignments on chicken and zebra finch is shown to illustrate the effects of reference bias on the completeness of the MULTIZ alignment. The diagonal dotted line indicates a slope of 1 (that is, if the coverage of MULTIZ and Progressive Cactus were equal).</p><p><xref rid="MOESM7" ref-type="media">Source data</xref></p></caption><graphic xlink:href="41586_2020_2871_Fig4_HTML" id="d33e947"/></fig></p>
  </sec>
  <sec id="Sec7" sec-type="discussion">
    <title>Discussion</title>
    <p id="Par22">The Vertebrate Genomes Project<sup><xref ref-type="bibr" rid="CR38">38</xref></sup> led by the Genome 10K<sup><xref ref-type="bibr" rid="CR39">39</xref></sup> and the Earth BioGenome Project<sup><xref ref-type="bibr" rid="CR40">40</xref></sup>, among others, aim to release thousands of new, high-quality genome assemblies over the next decade. These projects will give us incredible insight into natural history, but will need massive genome alignments. We have shown that Progressive Cactus can create reference-free alignments of hundreds of vertebrate genomes efficiently. The B10K<sup><xref ref-type="bibr" rid="CR32">32</xref></sup> and Zoonomia<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> consortia are using this alignment for comparative analysis, for example, analysing patterns of selection in unprecedented detail.</p>
    <p id="Par23">We focus on creating a reference-free alignment and ancestral reconstruction, allowing analysis of genome evolution throughout the entire tree rather than in comparison to one anointed reference. As the average assembly becomes ever more complete and accurate<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>, the value of such a reference-free approach grows. Similarly driven by technology improvements, sequencing efforts will increasingly produce multiple, phased de novo assemblies from different individuals in a population<sup><xref ref-type="bibr" rid="CR41">41</xref></sup>. Progressive Cactus has already proved useful for comparison between assemblies of the same species<sup><xref ref-type="bibr" rid="CR20">20</xref></sup>. Alignments of such assemblies are essential for annotation<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> and variant characterization<sup><xref ref-type="bibr" rid="CR42">42</xref></sup> and should prove useful for reference-free pangenome construction of the variation present in a population<sup><xref ref-type="bibr" rid="CR43">43</xref></sup>.</p>
  </sec>
  <sec id="Sec8" sec-type="materials|methods">
    <title>Methods</title>
    <sec id="Sec9">
      <title>Data reporting</title>
      <p id="Par24">Sample selection was made according to the needs of the Zoonomia and B10K projects. The experiments were not randomized, and there was no blinding.</p>
    </sec>
    <sec id="Sec10">
      <title>Evaluation on simulated data</title>
      <p id="Par25">Twenty primate genomes were simulated using Evolver, managed using the evolverSimControl (<ext-link ext-link-type="uri" xlink:href="https://github.com/dentearl/evolverSimControl">https://github.com/dentearl/evolverSimControl</ext-link>, commit b3236deb) pipeline. The root genome used was derived from 30 megabases selected from the hg19 genome, and is available at <ext-link ext-link-type="uri" xlink:href="http://courtyard.gi.ucsc.edu/%7ejcarmstr/datastore/progressiveCactusEvolverSim.tar.gz">http://courtyard.gi.ucsc.edu/~jcarmstr/datastore/progressiveCactusEvolverSim.tar.gz</ext-link> along with the Evolver configuration files that were used. The species tree used for the simulation was obtained from a catarrhine subtree of the 100-way alignment tree available on the UCSC browser.</p>
      <p id="Par26">The tree used was, in Newick format:</p>
      <p id="Par27">
        <code>(((((((Human:0.00655,Chimp:0.00684)anc0e:0.00122,Bonobo: 0.00784)anc1e:0.003,Gorilla:0.008964)anc2e:0.009693,Orangutan:0.01894)anc3e:0.003471,Gibbon:0.02227)anc4e:0.01204,(((((Rhesus:0.004991,Crab_eating_macaque:0.005991)anc5e:0.001,Sooty_mangabey:0.001)anc6e:0.005,Baboon:0.003042)anc7e:0.01061,(Green_monkey:0.027,Drill:0.03)anc8e:0.002)anc9e:0.003,((Proboscis_monkey:0.0007,Angolan_colobus:0.0008)anc10e:0.005,(Golden_snub-nosed_monkey:0.0007,Black_snub_nosed_monkey:0.0008)anc11e:0.004)anc12e:0.009)anc13e:0.02)anc14e:0.02183,(((Marmoset:0.03,Squirrel_monkey:0.01035)anc15e:0.01065,White-faced_sapajou:0.009)anc16e:0.01,Nancy_Mas_night_monkey:0.01)anc17e:0.01)anc18e;</code>
      </p>
      <p id="Par28">The alignments were generated using Progressive Cactus commit 51eb980b. The input files (the simulated genomes, input files and Progressive Cactus configuration file) are available at <ext-link ext-link-type="uri" xlink:href="http://courtyard.gi.ucsc.edu/%7ejcarmstr/datastore/progressiveCactus.EvolverSim.CactusInput.EvenlySpread.tar.gz">http://courtyard.gi.ucsc.edu/~jcarmstr/datastore/progressiveCactus.EvolverSim.CactusInput.EvenlySpread.tar.gz</ext-link>. A non-default configuration (included in the dataset) was used to change the alignment filtering in both runs to better support the high degree of polytomy in the star-tree runs. Four sets of 2, 6, 10 and 20 genomes were used, each of which were run three times to generate runtime estimates. The sets are as follows: 2 species: rhesus and marmoset; 6 species: rhesus, marmoset, gorilla, drill and black snub-nosed monkey, white-faced sapajou; 10 species: species from 6-species alignment and human, sooty mangabey, proboscis Monkey and Nancy Ma’s night monkey; 20 species: all species.</p>
      <p id="Par29">The runtime statistics were gathered using the toil stats command (the overall clock time was used, which represents central processing unit (CPU) time spent across all jobs). To generate the recall and precision statistics, multiple alignment format files (MAFs) were exported for each run (using hal2maf from the HAL<sup><xref ref-type="bibr" rid="CR27">27</xref></sup> package (<ext-link ext-link-type="uri" xlink:href="https://github.com/ComparativeGenomicsToolkit/hal">https://github.com/ComparativeGenomicsToolkit/hal</ext-link>, commit 68db41d) with the --onlyOrthologs option using the rhesus genome as a reference) and compared with the Evolver MAF using mafComparator (<ext-link ext-link-type="uri" xlink:href="https://github.com/dentearl/mafTools">https://github.com/dentearl/mafTools</ext-link>, commit 82077ac3).</p>
    </sec>
    <sec id="Sec11">
      <title>Comparison using Alignathon data</title>
      <p id="Par30">For comparison against other genome alignment methods, we aligned data (both the simulated ‘primates’ and ‘mammals’ datasets) used in the Alignathon using Progressive Cactus. For comparison, we downloaded all the original Alignathon entries in MAF format. We used the original Alignathon analysis workflow (<ext-link ext-link-type="uri" xlink:href="https://github.com/dentearl/mwgAlignAnalysis">https://github.com/dentearl/mwgAlignAnalysis</ext-link>, commit df98753) to reanalyse the MAFs, with the output of the newest Progressive Cactus version added, to generate the precision/recall statistics (which we extracted from the comparison against the most recent common ancestor (MRCA) truth set). The simulated-mammal results are shown in Supplementary Table <xref rid="MOESM1" ref-type="media">1</xref>, and the simulated-primates results are shown in Supplementary Table <xref rid="MOESM1" ref-type="media">2</xref>.</p>
    </sec>
    <sec id="Sec12">
      <title>Evaluation of the effect of the guide tree</title>
      <p id="Par31">The guide-tree analysis was performed on a set of 48 bird genomes previously published<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>. To reduce the amount of alignment work required, we subset these genomes down to the size of only a single chromosome, chicken chromosome 1 (by removing any contig or scaffold that had less than 20% of its sequence alignable to chicken chromosome 1). We used Progressive Cactus commit 36304707 for all alignments in this analysis.</p>
      <p id="Par32">The Prum and Jarvis topologies were adapted from Prum et al.<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> and Jarvis et al.<sup><xref ref-type="bibr" rid="CR29">29</xref></sup>, respectively. The ‘permuted’ topology was generated starting from the Jarvis topology, via three randomly chosen subtree-prune-regraft operations followed by three random nearest-neighbour-interchange operations. Each of these three topologies had branch-length estimates performed using phyloFit from the PHAST package (<ext-link ext-link-type="uri" xlink:href="https://github.com/CshlSiepelLab/phast">https://github.com/CshlSiepelLab/phast</ext-link>, commit 52e8de9) based on fourfold-degenerate sites of BUSCO orthologues. Finally, the ‘consensus’ tree was produced as a strict consensus of the Jarvis and Prum trees (collapsing all groupings that were not the same in both trees) using the ape::consensus method from the APE R package<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. The branch-lengths for this tree were generated from the fitted branch lengths for the two input trees, using the consensus.edges function of the phytools R package<sup><xref ref-type="bibr" rid="CR45">45</xref></sup>. The four final trees that were used in the four Progressive Cactus alignments are shown in Supplementary Fig. <xref rid="MOESM1" ref-type="media">1</xref>, and available in supplementary data in Newick format.</p>
      <p id="Par33">We further focused on the alignments with guide trees based on Jarvis<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> and Prum<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">3</xref>) to establish what alignment differences resulted from different phylogenetic hypotheses. Supplementary Fig. <xref rid="MOESM1" ref-type="media">2</xref> shows a refinement of the overall alignment-to-alignment <italic>F</italic><sub>1</sub> scores shown in Extended Data Table <xref rid="Tab3" ref-type="table">2</xref>, showing the <italic>F</italic><sub>1</sub> scores for each species pair between the Jarvis- and Prum-based alignments. Each pair of species has an <italic>F</italic><sub>1</sub> score between Jarvis- and Prum-based alignments of at least 0.955.</p>
    </sec>
    <sec id="Sec13">
      <title>Effect of assembly quality on alignment quality</title>
      <p id="Par34">We aligned two sets of 11 boreoeutherian genomes: one in which 7 of the species were represented by relatively low-quality assemblies, and another in which the same 7 species were represented by higher-quality assemblies; the assemblies used are listed in Supplementary Table <xref rid="MOESM1" ref-type="media">4</xref>. The remaining four genomes had the same assemblies in both alignments to facilitate comparison (human, hg38; mouse, mm10; rat, rn6; and dog, canFam3). We used Progressive Cactus commit 36304707 for all alignments in this analysis.</p>
    </sec>
    <sec id="Sec14">
      <title>Generation of the 600-way alignment</title>
      <p id="Par35">The Zoonomia alignment was composed of two sets of mammalian genomes: newly assembled DISCOVAR assemblies and GenBank assemblies. The DISCOVAR genomes were masked with RepeatMasker commit 2d947604, using Repbase<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> version 20170127 as the repeat library and CrossMatch as the alignment engine. The pipeline used is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/joelarmstrong/repeatMaskerPipeline">https://github.com/joelarmstrong/repeatMaskerPipeline</ext-link>, commit a6ad966. The guide-tree topology was taken from the TimeTree database<sup><xref ref-type="bibr" rid="CR47">47</xref></sup> (using release current in October 2018), and the branch lengths were estimated using the least-squares-fit mode of PHYLIP (<ext-link ext-link-type="uri" xlink:href="http://evolution.genetics.washington.edu/phylip/getme-new1.html">http://evolution.genetics.washington.edu/phylip/getme-new1.html</ext-link>, version 3.695)<sup><xref ref-type="bibr" rid="CR48">48</xref></sup>. The distance matrix used was largely based on distances from the 4d site trees from the UCSC browser<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>. To add those species not present in the UCSC tree, approximate distances estimated by Mash (<ext-link ext-link-type="uri" xlink:href="https://github.com/marbl/Mash">https://github.com/marbl/Mash</ext-link>, commit 541971b)<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> to the closest UCSC species were added to the distance between the two closest UCSC species. We used the hal package to process the HAL file (<ext-link ext-link-type="uri" xlink:href="https://github.com/ComparativeGenomicsToolkit/hal">https://github.com/ComparativeGenomicsToolkit/hal</ext-link>, commit 68db41d).</p>
      <p id="Par36">The final guide tree is embedded in the HAL file, and available using the halStats --tree command. The 363 assemblies in the B10K alignment comprised four sets: 236 newly sequenced species for the ‘family’ phase of the project, assembled using SOAPdenovo2 and AllpathsLG, 42 assemblies already sequenced from the ‘order’ phase of the project, 36 assemblies taken from GenBank, and 49 assemblies contributed by other research groups. For the avian guide-tree, we used a tree that the B10K consortium derived as preliminary data from ultraconserved elements.</p>
      <p id="Par37">Both alignments were run on the AWS cloud over the course of 3 weeks for the avians and 2 months for the mammals, using a maximum of 240 c3.8xlarge instances and 20 r3.8xlarge instances. Because Toil’s autoscaling mode was used, this capacity was only fully used during the initial phase of the alignment, when the potential for parallelism was at its highest.</p>
      <p id="Par38">The 600-way alignment was formed by aligning the two roots of the B10K and Zoonomia alignments, using the xenTro9 (frog), latCha1 (coelacanth), and danRer11 (zebrafish) assemblies as outgroups. This created a ‘linker’ alignment connecting the roots of the two alignments. The B10K and Zoonomia alignments were then added to this linker alignment using the halAppendSubtree command.</p>
    </sec>
    <sec id="Sec15">
      <title>Micro-indel events within the 600-way</title>
      <p id="Par39">We extracted all insertion and deletion events by running the halBranchMutations (<ext-link ext-link-type="uri" xlink:href="https://github.com/ComparativeGenomicsToolkit/hal">https://github.com/ComparativeGenomicsToolkit/hal</ext-link>, commit 68db41d) tool on every branch in the 600-way alignment. The ungapped insertion and deletion calls (represented by ‘I’ and ‘D’, respectively, within the output file) were filtered so that only calls spanning less than 20 bp (in the child for insertions, and the parent for deletions) were counted. The rate for each branch was then obtained by dividing the count of these micro-indel events by the total amount of sequence present in the child.</p>
    </sec>
    <sec id="Sec16">
      <title>Repetitive elements within ancestral sequences</title>
      <p id="Par40">We ran RepeatMasker (<ext-link ext-link-type="uri" xlink:href="https://github.com/rmhubley/RepeatMasker">https://github.com/rmhubley/RepeatMasker</ext-link>, commit 2d947604) on all ancestral assemblies of human within the 600-way alignment (using RepBase<sup><xref ref-type="bibr" rid="CR46">46</xref></sup> version 20170127, selecting the ‘primate’ repeat library and choosing CrossMatch as the alignment engine). We also ran the same pipeline against human (as existing annotations used the ‘Homo_sapiens’ repeat library). All ancestors up to human-rhesus had over 78% of the human complement of L1PA6 elements (Supplementary Fig. <xref rid="MOESM1" ref-type="media">10</xref>).</p>
    </sec>
    <sec id="Sec17">
      <title>Human/chicken transcript alignment protocols</title>
      <p id="Par41">Protein-coding transcript annotations were obtained from the UCSC Genome browser<sup><xref ref-type="bibr" rid="CR48">48</xref></sup> tables. Human annotations are GENCODE V34 on hg38 (GRCh38/GCA_000001405.27) and chicken annotations are Ensembl 85 on galGal4 (GCA_000002315.2). Predicted RNA sequences for each protein-coding transcript are extracted from the genome. Only gene annotations on the primary assemblies were used, those on alternate loci, patches, and assembled sequences were dropped. This results in 84,001 transcripts in 19,695 genes for human and 15,328 transcripts in 14,499 genes for chicken. The human transcripts were then mapped from the human genome to the chicken genome. The steps for each method are outlined below, although the actual execution was done by partitioning the data and using a cluster. Command-line tools from the UCSC Genome Browser group and programs used came from: <ext-link ext-link-type="uri" xlink:href="https://github.com/ucscGenomeBrowser/kent">https://github.com/ucscGenomeBrowser/kent</ext-link>, commit 8a8d921, <ext-link ext-link-type="uri" xlink:href="https://github.com/ComparativeGenomicsToolkit/hal">https://github.com/ComparativeGenomicsToolkit/hal</ext-link>, commit 68db41d, ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/2.10.0/, version tblastn: 2.10.0, and <ext-link ext-link-type="uri" xlink:href="https://github.com/lastz/lastz">https://github.com/lastz/lastz</ext-link>, version 1.03.54.</p>
    </sec>
    <sec id="Sec18">
      <title>BLATX transcript alignment protocol</title>
      <p id="Par42">The BLATX alignments were created using protein-translated mode to align the mRNAs to the target genome with BLAT version 36x5. They were then filtered following the same protocol the UCSC Genome Browser uses for creating the other species RefSeq alignments:</p>
      <p id="Par43">
        <code>blat -noHead -q=rnax -t=dnax -mask=lower &lt;dest-genome.2bit&gt; \</code>
      </p>
      <p id="Par44">
        <code>&lt;src-rna.fa&gt; &lt;dest-rna-raw.psl&gt;</code>
      </p>
      <p id="Par45">We then filter to get near-best in genome. Alignment to chicken uses near best filter of -localNearBest = 0.010 while to human it uses -globalNearBest = 0.010:</p>
      <p id="Par46">
        <code>faPolyASizes &lt;src-rna.fa&gt; &lt;src-rna.polya&gt;</code>
      </p>
      <p id="Par47">
        <code>pslCDnaFilter &lt;nearBestOption&gt; -minId=0.35 -minCover=0.15 -minQSize=20 \</code>
      </p>
      <p id="Par48">
        <code>-ignoreIntrons -repsAsMatch -ignoreNs -bestOverlap \</code>
      </p>
      <p id="Par49">
        <code>-polyASizes=&lt;src-rna.polya&gt; &lt;dest-rna-raw.psl&gt; &lt;dest-rna-mapped.psl&gt;</code>
      </p>
      <p id="Par50">The transMapPslToGenePred command is then used to project the original coding sequence (CDS) onto the alignment.</p>
    </sec>
    <sec id="Sec19">
      <title>TBLASTX transcript alignment protocol</title>
      <p id="Par51">The TBLASTX alignments were created using the protein-translated ‘tblastx’ program to align the mRNAs to the target genome with BLAST+ version 2.10.0+.</p>
      <p id="Par52">The database is created using the repeat masking from the UCSC Genome Browser genomes to match what is used within the BLATX methodology above:</p>
      <p id="Par53">
        <code>convert2blastmask -in &lt;dest-genome.fa&gt; -masking_algorithm repeat \</code>
      </p>
      <p id="Par54">
        <code>-masking_options “repeatmasker, default” -outfmt maskinfo_asn1_bin \</code>
      </p>
      <p id="Par55">
        <code>-out &lt;dest-genome.mask&gt;</code>
      </p>
      <p id="Par56">
        <code>makeblastdb -dbtype nucl -in &lt;dest-genome.fa&gt; -mask_data &lt;dest-genome.mask&gt;</code>
      </p>
      <p id="Par57">The mRNAs are aligned and the resulting XML converted to PSL format, filtering to an e-value threshold of 0.01. These are then chained using a program the UCSC group developed for chaining BLAST alignments:</p>
      <p id="Par58">
        <code>tblastx -db &lt;dest-genome.fa&gt; -db_soft_mask 40 -outfmt 5 -query &lt;src-rna.fa&gt; \</code>
      </p>
      <p id="Par59">
        <code>-out &lt;dest-rna-raw.xml&gt;</code>
      </p>
      <p id="Par60">
        <code>blastXmlToPsl -eVal=0.01 &lt;dest-rna-raw.xml&gt; &lt;dest-rna-raw.psl&gt;</code>
      </p>
      <p id="Par61">
        <code>simpleChain -outPsl -maxGap=75000 &lt;dest-rna-raw.psl&gt; &lt;dest-rna-chained.psl&gt;</code>
      </p>
      <p id="Par62">The alignments produced are then filtered in the same manner as the BLATX alignments.</p>
    </sec>
    <sec id="Sec20">
      <title>LASTZ transcript alignment protocol</title>
      <p id="Par63">Both the LASTZ and Cactus transcript mappings use the ‘TransMap’<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> projection alignment algorithm to project transcript annotation between genomes. The LASTZ alignment chains and nets<sup><xref ref-type="bibr" rid="CR50">50</xref>–<xref ref-type="bibr" rid="CR52">52</xref></sup> were obtained from the UCSC Genome Browser downloads. These were then filtered to produce a set of syntenic mapping chains using these steps:</p>
      <p id="Par64">
        <code>netFilter -syn &lt;genomes.net&gt; &lt;syntenic.net&gt;</code>
      </p>
      <p id="Par65">
        <code>netChainSubset -wholeChains &lt;syntenic.net&gt; &lt;genome.chain&gt; &lt;mapping.chain&gt;</code>
      </p>
    </sec>
    <sec id="Sec21">
      <title>Cactus transcript alignment protocol</title>
      <p id="Par66">The Cactus alignments are extracted for all primary chromosomes from the HAL file and chained using the same chaining algorithm as the LASTZ chains, with the –noDupes option having a similar effect as the syntenic net filtering:</p>
      <p id="Par67">
        <code>halLiftover --outPSL --noDupes 600way.hal &lt;srcOrganism&gt; \</code>
      </p>
      <p id="Par68">
        <code>&lt;srcChroms.bed&gt; &lt;destOrganism&gt; &lt;src-dest.psl&gt; &lt;genome.psl&gt;</code>
      </p>
      <p id="Par69">
        <code>axtChain -psl -linearGap=loose -scoreScheme=HoxD55.q &lt;genome.psl&gt; &lt;mapping.chain&gt;</code>
      </p>
      <p id="Par70">The ‘TransMap’ protocol is used for both the LASTZ and Cactus mapping chains to produce alignments of the transcripts to the other genomes. This used the ‘pslMap’ command to do the mapping and ‘pslRecalcMatch’ to update the statistic in the alignments:</p>
      <p id="Par71">
        <code>pslMap -chainMapFile &lt;src-rna.psl&gt; &lt;mapping.chains&gt; &lt;dest-rna-over.psl&gt;</code>
      </p>
      <p id="Par72">
        <code>pslRecalcMatch &lt;dest-rna-over.psl&gt; &lt;dest-genome.2bit&gt; &lt;src-rna.fa&gt; &lt;dest-rna-raw.psl&gt;</code>
      </p>
      <p id="Par73">The alignments produced are then filtered in the same manner as the LASTZ alignments.</p>
    </sec>
    <sec id="Sec22">
      <title>Transcript and gene alignment subsets and comparison</title>
      <p id="Par74">To facilitate the comparative analysis of the alignment methods, we created reduced sets of the alignments using two different approaches. Although both BLATX and TBLASTX will align UTR, the strength of protein-translated methods is in recognizing distant coding sequence relationships. Alignment projection-mapping methods were previously shown<sup><xref ref-type="bibr" rid="CR53">53</xref></sup> to align more UTR bases than translated methods. To facilitate comparisons, CDS alignments from each method were created by trimming the RNA alignments to contain only the CDS regions as defined by the human annotation set.</p>
      <p id="Par75">Although mapping all transcripts is useful, particularly for understanding the utility of the methods in assisting genome annotation, individual transcripts overlap, biasing assessment of transcribed mappings to genes with larger transcript numbers. To remove most of this base multiplicity from comparisons, in addition to showing full transcript results, subsets of the alignments are created using only one representative transcript per gene. For the full RNA alignments, the longest RNA for each gene was chosen, with the CDS alignments choosing the transcript with the longest CDS. The biology of overlapping gene structures and the ambiguities in defining genes cause around 4% of genomic bases to appear in more than one gene in the RNA, and 3% in the CDS gene sets owing to overlap.</p>
      <p id="Par76">Individual pairwise alignments were compared at the base-level, consistent with the earlier comparisons reported. In brief, alignment similarity is computed by comparing the set of shared aligned pairs. That is, a pairwise alignment can be viewed as a set of aligned base pairs, each a coordinate from the source (human) and target (chicken) genome. The Jaccard index is, in this context, the number of aligned pairs identical between the two alignments divided by the union of all aligned pairs in the two alignments. It is worth noting that translated alignments are encoded for comparison using their induced base-level alignments. Transcripts or genes that are not aligned by either of the aligners being compared are assigned Jaccard indices of zero.</p>
      <p id="Par77">To account for human bases that map to multiple bases in chicken (which occurs frequently for the translated alignment methods that include very distant, fragmented, paralogous alignments, but much less often for the non-translated methods), when comparing the alignments of an mRNA or CDS between two methods, if either or both methods produces multiple alignments, we pick the pair of mappings (one from each method) with highest shared similarity to report. This generally has the effect of removing distant paralogues from the comparison.</p>
    </sec>
    <sec id="Sec23">
      <title>Progressive Cactus methods</title>
      <p id="Par78">Progressive Cactus builds upon the original Cactus program, in particular the CAF and BAR algorithms, which are described in detail in the original publication. In overview, the CAF algorithm (short for Cactus Alignment Filter) is an algorithm designed to construct a sequence graph from an input set of local alignments (in the Progressive Cactus pipeline computed using LASTZ). We omit a complete definition here, but a sequence graph represents the alignment of a set of nucleotide strings. It can formally be represented using a bi-directed or bi-edged graph<sup><xref ref-type="bibr" rid="CR54">54</xref>–<xref ref-type="bibr" rid="CR56">56</xref></sup> (Supplementary Fig. <xref rid="MOESM1" ref-type="media">13a</xref>). Larger nucleotide strings are encoded as walks through sequence graphs (Supplementary Fig. <xref rid="MOESM1" ref-type="media">13b</xref>); in the bi-edged representation an alignment between two or more substrings is represented by both strings visiting a common sequence edge; in Progressive Cactus each sequence edge represents an alignment ‘block’, a set of oriented substrings in the set of input strings which are considered to be gaplessly aligned. A key property of alignments represented by sequence graphs is that the alignments they represent are equivalence relations: that is, alignments are transitive, reflexive and symmetric. The core challenge the CAF algorithm addresses is sub-selecting which local alignments from the input set to include in the sequence graph, because typically a collection of local alignments computed with a tool like LASTZ will contain numerous transitive inconsistencies which when combined will create implausible, high degree alignment blocks in the sequence graph. The CAF algorithm uses the 3-edge connected components of a sequence graph to define a restricted form of cactus graph such that there exists a homomorphism from the alignment blocks in the sequence graph onto the resulting cactus graph (Supplementary Fig. <xref rid="MOESM1" ref-type="media">13c</xref>). In the constructed cactus graph each edge is a member of exactly one simple cycle. These simple cycles correspond to ‘chains’ of alignment blocks, maximal sequences of blocks whose aligned substrings appear in the same order and orientation in the input strings. The CAF algorithm iteratively filters the input set of alignments to remove local alignments that create short simple cycles in the cactus graph, this is achieved by deleting alignment blocks from the sequence graph involved with these short cycles. The result of the CAF algorithm is a filtered set of local alignments represented using a sequence graph. To add to the output sequence graph of the CAF algorithm the BAR algorithm constructs a detailed alignment by extending gapped alignments from the ends of each alignment block, using a greedy approach to force consistency between the alignments constructed starting from connected alignment blocks. In Progressive Cactus the CAF and BAR algorithms are applied to create an alignment of the corresponding set of in-group and out-group species for each internal node of a guide tree.</p>
      <p id="Par79">Below we provide updates on the changes made to Cactus to create Progressive Cactus.</p>
    </sec>
    <sec id="Sec24">
      <title>Preliminary repeat-masking</title>
      <p id="Par80">Progressive Cactus requires input genomes to be soft-masked, but often repetitive sequence goes unmasked due to poor masking or incomplete repeat libraries for newly-sequenced species. This can negatively affect alignment runtimes (as alignments need to be enumerated to and from all copies of a repetitive sequence) and impact quality. For this reason, we mask overabundant sequence before alignment, using a strategy not based on alignment to repeat consensus libraries, but on over-representation of alignments. We first divide each genome into small, mutually overlapping chunks. For each chunk, we align it to itself and a configurable amount of other randomly sampled chunks (currently 20% of the total pool). To avoid combinatorial explosion due to unmasked repetitive sequence, we use a special mode of LASTZ which stops exploring alignments from any region early if a maximum depth is reached (using the flag --queryhsplimit=keep,nowarn:1500, which stops after a high-scoring-pair depth of 1,500). We then soft-mask any region covered by more than a configurable number of these alignments (currently set to 50). Further details can be found in the src/cactus/preprocessor section of the Progressive Cactus codebase. Although the preprocessing step is automatically run as part of the pipeline, we also provide a cactus_preprocessor utility to run only the preprocessor without producing a full genome alignment.</p>
    </sec>
    <sec id="Sec25">
      <title>Local alignment and outgroup selection</title>
      <p id="Par81">The alignment process for each subproblem begins with a series of local alignments generated using LASTZ. The local alignments fall into two sets: a set of all-against-all alignments among the ingroup genomes, and a set of alignments from ingroup genomes to outgroup genomes. We have found outgroup selection to be absolutely crucial in creating an acceptable ancestral reconstruction: any missing data or misassembly in the outgroup that causes a true deletion in one of the ingroups to be misinterpreted as an insertion in others will mean that the ancestor contains less sequence than it ought to. This missing sequence in turn impacts the alignment between the entire subtree below the reconstructed ancestor and the entire supertree above it: the missing sequence will never be aligned between the subtree and supertree. To avoid this we attempt to use multiple outgroup genomes in each subproblem (by default, the three nearest outgroup genomes, as measured by branch-length). Naively aligning each ingroup against multiple outgroups would significantly increase the computation time; to avoid this we note that in general any region already containing an outgroup alignment benefits very little from aligning an additional outgroup. Therefore, we iteratively align each ingroup against one outgroup at a time, pruning away any ingroup sequence already covered by the previous outgroup alignments. In this way, the computational cost is reduced to be far less than naively aligning against the entire outgroup set, while still retaining nearly all of the benefit. In addition, we allow the user to designate certain genomes in the input as being of particularly high quality; these are chosen as outgroups if possible to avoid problems with missing data in regions such as mitochondrial or sex chromosomes that are often missing from some assemblies but not others.</p>
    </sec>
    <sec id="Sec26">
      <title>Paralogy resolution</title>
      <p id="Par82">Users of a genome alignment are often interested in ‘orthology’ relationships, rather than all ‘homology’ relationships, between a set of sequences. For example, when comparing human and chimpanzee <italic>KZNF</italic> genes, providing an alignment from each gene to the over-400<sup><xref ref-type="bibr" rid="CR56">56</xref></sup> homologous <italic>KZNF</italic> genes in the other genome is nigh-useless; the user is likely interested in only the orthologous copy or copies (in the case of a lineage-specific duplication) in the other genome. For this reason, Progressive Cactus alignments are capable of representing complex orthology/paralogy relationships, with an ability to display the alignment(s) labelled as orthologous, but also the option for a user to request alignments to paralogues at a customizable divergence-time threshold. This is achieved by implicitly producing a gene tree as the alignment is built, albeit with some restrictions, namely that a duplication event is represented by multiple regions in the child(ren) aligned to a single region in the parent species. This forbids the representation of gene-tree-species-tree discordance as would occur in incomplete lineage-sorting or horizontal transfer, as well as the exact ordering of multiple duplication events along a single branch. The restricted problem we solve at each subproblem step is that each alignment block should represent all regions orthologous to a single region of the ancestral sequence, possibly multiple per species; we make no attempt to fully resolve the gene tree when multiple duplications take place along a single branch. However, this still requires resolving the timing of all duplication events to the lineages of the tree: duplicated sequences whose coalescence precedes the speciation event represented in the subproblem should be split, while those following the speciation event should be kept together.</p>
      <p id="Par83">To achieve the desired alignment blocks in each subproblem, in constructing the initial sequence graph during the CAF algorithm Progressive Cactus greedily chooses which pairwise alignments to include in an effort to prevent paralogous alignments between the ingroup species. We developed two algorithms. Both are greedy algorithms designed to rank the pairwise local alignments and then iteratively add the alignments to the graph, at each step choosing to accept or reject the addition of alignments to the graph. Each added alignment ‘glues’ together two alignment blocks, splitting existing alignment blocks as necessary and merging the resulting two alignment blocks into one new block in the graph (Supplementary Fig. <xref rid="MOESM1" ref-type="media">14</xref>).</p>
      <p id="Par84">The first algorithm, which was used in previous, beta versions of Progressive Cactus, relied on an outgroup-based heuristic to resolve duplication timing. This heuristic, which we term ‘single-copy outgroup filtering’, first sorts all the LASTZ alignments by their score in descending order. Then, starting from the highest-scoring alignment, it iteratively adds one alignment at a time to the sequence graph, rejecting the gluing of any two blocks if the resulting alignment block would contain two or more substrings from the same outgroup genome. In this way the heuristic refuses to glue blocks when the resulting block would contain homologies that imply duplications in the outgroups. These self-homologies within the outgroup would necessarily involve duplication events that occurred above or outside of the subtree rooted at the MRCA of the ingroup genomes. Since the goal at each progressive step is to determine (the transitive closure of) orthology relationships within this subtree, refusing these outgroup self-homologies proves useful for assigning orthology between ingroups. Unfortunately, this method is very sensitive to incomplete outgroup assemblies (containing an incorrect number of copies of a duplicated region) or variation in the similarity between closely related paralogues, causing assignment to the wrong copy. As seen in Extended Data Fig. <xref rid="Fig5" ref-type="fig">1</xref>, this filtering method tended to resolve duplications far too early, often causing paralogues to be called orthologues.</p>
      <p id="Par85">To remedy this problem, we developed an improved duplication-timing method, which we term ‘best-hit filtering’. The method preprocesses the local alignments to define for every base in every input genome a ranking by score of the local alignments that overlap it. The sequence graph is then built by first including the highest-scoring alignment for each base in each genome. We refer to this highest-scoring set as the set of ‘primary’ alignments and the remaining alignments the ‘secondary’ alignments. Note this definition is asymmetric: a pairwise alignment may be primary for one of the substrings it aligns and secondary for the other. All primary alignments are added to the initial graph unconditionally because they represent the most likely orthologue relationship (or in the case of multiple orthology, probably a random orthologue) (Supplementary Fig. <xref rid="MOESM1" ref-type="media">15</xref>). The set of primary alignments represents a conservative set of alignment relationships that should include nearly no alignments to ancient paralogues. However, in regions that have undergone many rounds of lineage-specific duplications (which should all be aligned together in the restricted duplication-timing problem we described above), the set of primary alignments will often by chance not align all copies together. For this reason, after adding the primary alignments we iteratively add secondary alignments, going in descending order of score, rejecting any secondary alignment that would glue together any two existing blocks that both contain sequences from the same outgroup species (similar to the ‘single-copy outgroup filtering’ method)—this allows lineage-specific duplications of ingroup genomes to correctly land in the same block, while avoiding merging blocks from likely-paralogous alignments.</p>
      <p id="Par86">Of the two methods, the newer best-hit filtering removes many more probably paralogous alignments, especially to closely related genomes, while leaving approximately the same amount of sequence covered by at least one alignment. For example, we ran two versions of Progressive Cactus, one using the best-hit filtering and one using the outgroup filtering (commits 450da74 [best-hit filtering] and aca859f [outgroup filtering]), using the following tree:</p>
      <p id="Par87">
        <code>(((((Human:0.006969,Chimp:0.009727):0.025291,Rhesus:0.044568):0.07,Tree_shrew:0.19):0.03,(Kangaroo_rat:0.17,(Mouse:0.072818,Rat:0.081244):0.11):0.150342):0.02326,((Dog:0.07,Cat:0.07):0.087381,((Pig:0.06,Cow:0.06):0.104728,Horse:0.05):0.05):0.04);</code>
      </p>
      <p id="Par88">Comparing the best-hit filtering alignment and the one using the single copy outgroup filtering, the amount of human sequence mapping to two or more places in the chimpanzee genome was reduced from 6.1% to 2.6%, while the total amount of human covered by chimpanzee actually increased owing to the removal of ancient homologues, simplifying the initial alignment relationships (see Extended Data Fig. <xref rid="Fig5" ref-type="fig">1a, b</xref> for an example visualization and Extended Data Fig. <xref rid="Fig5" ref-type="fig">1c</xref> for aggregate statistics).</p>
      <p id="Par89">The alignment files are accessible in the URLs listed at Supplementary Table <xref rid="MOESM1" ref-type="media">12</xref>, and the assemblies used are listed in Supplementary Table <xref rid="MOESM1" ref-type="media">13</xref>. Coverage statistics from the resulting alignments were obtained using the halCoverage tool (<ext-link ext-link-type="uri" xlink:href="https://github.com/ComparativeGenomicsToolkit/hal">https://github.com/ComparativeGenomicsToolkit/hal</ext-link>, commit 68db41d). To confirm that these improvements were likely caused by the removal of paralogous rather than orthologous alignments, we compared phylogenetic trees implicit in the columns of HAL alignments to independently re-estimated approximately maximum likelihood (ML) trees produced by FastTree (<ext-link ext-link-type="uri" xlink:href="http://www.microbesonline.org/fasttree/">http://www.microbesonline.org/fasttree/</ext-link>, version 2.1.11)<sup><xref ref-type="bibr" rid="CR57">57</xref></sup> for the same regions. The duplication-timing evaluation was performed using a custom pipeline (<ext-link ext-link-type="uri" xlink:href="https://github.com/joelarmstrong/treeBuildingEvaluation">https://github.com/joelarmstrong/treeBuildingEvaluation</ext-link>) designed to sample columns from a HAL file and evaluate their trees against an independently re-estimated tree of the same region. For this analysis we used the two 12-boreoeutherian alignments described above, sampling 10,000 columns from the human genome. The comparison trees were built from a context of 1,000 bases around the entries in each sampled column using FastTree 2.1.10 and the -gtr -nt options. Only duplicated columns were counted in the final output (columns containing no duplications did not count in the results). The coalescence pairs were evaluated using the --onlySelf option, meaning that only pairs that included the sampled site were counted in the results. To avoid weighting columns with a high number of copies per genome more than columns with a low number of copies per genome, only a single coalescence was randomly sampled per column.</p>
      <p id="Par90">Because HAL does not produce a fully binarized history of duplication events, we compared the MRCA of randomly selected pairs of sites from genomes containing a duplication within the column. If the MRCA species in the HAL tree is a descendant of the MRCA species within the reconciled ML tree, that implies that there are paralogues represented as orthologues within the HAL tree (since a duplication event must have been resolved too early). Similarly, if the MRCA species within the HAL tree is an ancestor of that within the reconciled ML tree, a duplication event must have been resolved too late in the HAL tree, indicating additional false loss or deletion events. The number of paralogous alignments (represented by the coalescence time between duplicated sequences being too ‘early’ in the HAL tree relative to the ML tree) in the alignment of the 12 boreoeutherian genomes was clearly reduced (46% in the outgroup filtering versus 26% in the best-hit filtering) (Extended Data Fig. <xref rid="Fig5" ref-type="fig">1d</xref>).</p>
      <p id="Par91">We separately ran the Comparative Annotation Toolkit (CAT; <ext-link ext-link-type="uri" xlink:href="https://github.com/ComparativeGenomicsToolkit/hal">https://github.com/ComparativeGenomicsToolkit/hal</ext-link>, commit 68db41d)<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> on identical human, chimpanzee and gorilla assemblies (hg38, panTro6, and gorGor5 assemblies) in two alignments using the outgroup and best-hit filtering methods. We ran using the GENCODE V30 gene set<sup><xref ref-type="bibr" rid="CR58">58</xref></sup>. We projected the transcripts solely via transMap without the use of the AUGUSTUS modes. Multiple-mapping statistics and the gene composition of the final gene set were taken from the filter_tm_metrics.json file in the CAT output.</p>
      <p id="Par92">Not only was CAT less likely to identify a human gene in multiple chimp loci using the best-hit filtering (for example, 6.5% versus 9.8% multiple-mappings across all genes in chimp, and 5.9% versus 13.8% for the recently-duplicated KRAB zinc-finger gene family) (Extended Data Fig. <xref rid="Fig5" ref-type="fig">1e</xref>), but as a result orthologues for 104 more human genes were identified in the output gene set for chimp (182 in gorilla) (Supplementary Table <xref rid="MOESM1" ref-type="media">14</xref>). This is probably because tens of thousands of fewer paralogous transcripts were filtered out in the initial filtering phase of CAT (Supplementary Table <xref rid="MOESM1" ref-type="media">15</xref>), reducing confusion about which transcript projection to put into the gene set.</p>
    </sec>
    <sec id="Sec27">
      <title>Removing recoverable chains</title>
      <p id="Par93">The original CAF algorithm was focused on removing small rearrangements while retaining as much of the original alignment relationships as possible in the filtered cactus graph. However, because the input local alignments are insensitive, the original alignment relationships are likely to have missed certain homologies. This can result in what we term ‘incomplete blocks’: blocks that contain some alignment relationships but are missing others, that is, are proper subsets of the corresponding ‘true’ alignment block. In our anchor-and-extend process, once a block becomes an anchor it can never be modified. As a result, these incomplete blocks will remain incomplete: they prevent the true alignment relationship from being found, even if an adjacent syntenic anchor block is complete and contains all desired alignment relationships. These problematic incomplete blocks become more prevalent at longer evolutionary distances: the local aligner will miss more true homologies at increasing distances, causing more incomplete blocks and in turn a far worse alignment.</p>
      <p id="Par94">To remove these incomplete blocks, Progressive Cactus originally relied on a heuristic that identified blocks that were ‘likely’ to be incomplete, removing blocks that did not have alignment relationships between all ingroups. However, this heuristic performed poorly in the presence of deletions or missing data: any large deletion in one ingroup could cause huge stretches of the other ingroup(s) to be left unaligned. To remedy this, we have developed a new alteration to the CAF algorithm, one that now focuses on maximizing the potential size of the alignment graph ‘after’ extension as opposed to ‘before’ extension. We call this addition ‘removing recoverable chains’ because it identifies chains in the cactus graph that represent alignments that could be recovered by the BAR algorithm extension process.</p>
      <p id="Par95">The algorithm is applied as a post-processing step after the CAF process, which proceeds as normal. After the cactus graph is created and filtered, the algorithm identifies ‘recoverable blocks’. Each block is composed of segments, each of which represents a non-overlapping region of a sequence and which strand is being aligned; we briefly review the necessary terminology, but see<sup><xref ref-type="bibr" rid="CR59">59</xref></sup> for additional context. We call a segment ‘<italic>a</italic> left-adjacent’ to another segment ‘<italic>b</italic>’ if ‘<italic>a</italic>’ represents the positive strand and ‘<italic>b</italic>’ comes before ‘<italic>a</italic>’ in their sequence and there is no other segment between them. Similarly, we call a left-adjacent to <italic>b</italic> if <italic>a</italic> is on the negative strand and a comes before b in their sequence ordering with no other intervening segment. If <italic>a</italic> is left-adjacent to <italic>b</italic>, then <italic>b</italic> is right-adjacent to <italic>a</italic>.</p>
      <p id="Par96">A block is called ‘recoverable’ if, in the case that the block was removed, all its regions would be contained entirely within a single end alignment in the BAR extension phase. The end alignments are identified by looking at all unaligned sequences between the adjacent segments of a single ‘end’ of a block: in short, two end alignments are created for every block, one for all sequences between each segment and its left-adjacent segment, and similarly for the right-adjacent segments. In practice, this means that for some block <italic>A</italic>, it is recoverable if all its segments are all left- or right-adjacent to segments from the same block <italic>B</italic> ≠ <italic>A</italic>.</p>
      <p id="Par97">Whether a block is recoverable depends only on its immediate neighbouring blocks. However, it is interesting to consider the maximum set of recoverable blocks, and, by contrast, of unrecoverable blocks—these unrecoverable blocks represent a minimal set of anchors that can be extended from to recover the alignment relationships from the original sequence graph as well as potential additional alignment relationships.</p>
      <p id="Par98">Because the chains and nets within the cactus graph represent a hierarchy of the rearrangements implicit in the alignment, they are helpful for finding a smaller set of anchors to extend from. We consider what anchors could provide recoverability to a block: if a block <italic>A</italic>’s segments would lie within the end alignment of <italic>B</italic> if all the recoverable blocks between <italic>B</italic> and <italic>A</italic>, including <italic>A</italic>, were destroyed, we call <italic>A</italic> recoverable given <italic>B</italic>. The relationship is transitive: if block <italic>A</italic> is recoverable given block <italic>B</italic>, and <italic>B</italic> is recoverable given <italic>C</italic>, then <italic>A</italic> is recoverable given <italic>C</italic>. All blocks in a chain are recoverable given each other, since all blocks in a chain are collinear with each other, potentially with intervening rearrangements located further down the chain/net hierarchy. Similarly, if any block in a chain is recoverable given another block above the chain in the chain/net hierarchy, the entire chain is recoverable given that block. Owing to this fact, to determine the recoverability status of all blocks, we only have to examine the blocks at the ends of chains and their immediate neighbours, rather than every block.</p>
      <p id="Par99">Although in principle we would need to keep only one block within even unrecoverable chains (since all other blocks within the chain would be recoverable given that single block), to save computational effort in realignment we only destroy or keep entire chains as a unit. In the same spirit, to avoid spending needless effort when the chain is recoverable but very likely is not incomplete, we apply a heuristic and do not remove chains that contain the same number of copies in all ingroups and outgroups.</p>
      <p id="Par100">After identifying and removing all recoverable blocks, some blocks previously marked unrecoverable may become recoverable (because adjacent blocks were removed). For this reason, we run the process of identifying and removing recoverable chains multiple times in a loop, until either no recoverable chains are identified or a limit on the number of cycles is reached. The structure of the cactus graph may change after removing recoverable blocks, so we recompute the cactus graph after every removal step. The process that is followed is described in pseudocode as follows:</p>
      <p id="Par101">
        <code><bold>function</bold> RemoveRecoverableChains(<italic>G</italic>, <italic>n</italic>)</code>
      </p>
      <p id="Par102">
        <code><bold>for</bold> 1 ... n <bold>do</bold></code>
      </p>
      <p id="Par103">
        <code><italic>cactusGraph</italic> ← CreateCactusGraph(<italic>G</italic>)</code>
      </p>
      <p id="Par104"><italic>RecoverableChains ←</italic> ∅</p>
      <p id="Par105">
        <code><bold>for</bold> chain <italic>C</italic> in <italic>cactusGraph</italic><bold>do</bold></code>
      </p>
      <p id="Par106">
        <code>
          <bold>if</bold>
        </code>
      </p>
      <p id="Par107">⊳ A single adjacent end offers the potential for recoverability</p>
      <p id="Par108">
        <code>(|<italic>C</italic>.leftAdjacencies| = 1 <bold>or</bold> |<italic>C</italic>.rightAdjacencies| = 1)</code>
      </p>
      <p id="Par109">⊳ Shared adjacencies indicate a non-recoverable rearrangement</p>
      <p id="Par110"><bold><italic>and C.leftAdjacencies ∩ C.rightAdjacencies = </italic></bold>∅</p>
      <p id="Par111">⊳ Links between chain ends indicate a non-recoverable duplication</p>
      <p id="Par112">
        <code><bold>and</bold><italic>C</italic>.leftEnd ∉ <italic>C</italic>.rightAdjacencies <bold>then</bold></code>
      </p>
      <p id="Par113">
        <code><italic>RecoverableChains</italic> ← <italic>RecoverableChains</italic> ∪ {C}</code>
      </p>
      <p id="Par114">
        <code>end if</code>
      </p>
      <p id="Par115">
        <code>end for</code>
      </p>
      <p id="Par116">
        <code><bold>if</bold> |RecoverableChains| = 0 <bold>then</bold></code>
      </p>
      <p id="Par117">
        <code>break</code>
      </p>
      <p id="Par118">
        <code>else</code>
      </p>
      <p id="Par119">
        <code>Destroy each chain in <italic>RecoverableChains</italic></code>
      </p>
      <p id="Par120">
        <code>
          <bold>end if</bold>
        </code>
      </p>
      <p id="Par121">
        <code>
          <bold>end for</bold>
        </code>
      </p>
      <p id="Par122">
        <code>
          <bold>end function</bold>
        </code>
      </p>
    </sec>
    <sec id="Sec28">
      <title>Improvements from removing recoverable sequence</title>
      <p id="Par123">To quantify the effect that the process of removing recoverable chains (described above) had on real alignments, we ran alignments on a set of nine Euarchontoglires genomes with the feature turned on and off. The tree used was:</p>
      <p id="Par124">
        <code>(((((((human:0.00877,gorilla:0.008964):0.009693,orang:0.01894):0.015511,rhesus:</code>
        <code>0.037601):0.07392,tarsier:0.1114):0.034014,tree_shrew:0.19114):0.002,(kangaroo_rat:0.171759,(chinese_hamster:0.14,mouse:0.132282):0.11015):0.114051)euarchontoglires:0.020593,(cow:0.18908,dog:0.13303):0.032898);</code>
      </p>
      <p id="Par126">We used Progressive Cactus commit 56874bde, with the --root euarchontoglires option so that cow and dog were used only as outgroups. Coverage on human increased for all genomes when recoverable chains were removed, especially for those most distant from human (Supplementary Fig. <xref rid="MOESM1" ref-type="media">16</xref>). This probably reflects the fact that though the losses caused by not removing recoverable chains in any single subproblem are relatively small, they can compound to be quite considerable in large alignments since many subproblems are involved in creating the alignment between distant species (such as human and mouse, which are separated by seven internal nodes in this tree).</p>
    </sec>
    <sec id="Sec29">
      <title>Ancestral genome reconstruction</title>
      <p id="Par127">The core of what makes the progressive alignment algorithm possible is the ancestral reconstruction generated in each subproblem. This assembly serves as a summary of each subproblem alignment; the alignable sequence between the genomes in the subtree below the ancestor, as well as that alignable between the subtree and the supertree above the ancestor, is all present in the ancestral reconstruction. The ancestral sequence contains a base for each column in all blocks which contain an alignment between two ingroups and/or an ingroup and an outgroup—any alignment purely between outgroups is discarded. The order and orientation of the blocks relative to one another is chosen via a previously published algorithm for ordering a pangenome<sup><xref ref-type="bibr" rid="CR60">60</xref></sup>.</p>
      <p id="Par128">The identity of the ancestral bases is inferred via maximum-likelihood on a Jukes-Cantor model<sup><xref ref-type="bibr" rid="CR61">61</xref></sup> of evolution using Felsenstein’s pruning algorithm<sup><xref ref-type="bibr" rid="CR62">62</xref></sup> on the subtree of the guide tree induced by the genomes in the subproblem. These base-calls are generated as the alignment is being made, so they necessarily take only a part of the alignment information into account and may be different than the ideal base-calls would be if taking into account information across the entire alignment. However, we provide a tool, ancestorsML, distributed as part of the HAL toolkit, that re-estimates ancestral base-calls after completion of the alignment if desired.</p>
    </sec>
    <sec id="Sec30">
      <title>Adding a new genome to an existing alignment</title>
      <p id="Par129">Progressive Cactus supports adding a new genome to an existing alignment by taking advantage of the tree structure of the progressive alignments it produces. There are three ways that a new genome can be added to an alignment, depending on its phylogenetic position relative to the existing genomes: (1) as outgroup to all the existing genomes in the alignment; (2) by being added as a new child of an existing ancestral genome in the alignment; or (3) by splitting a branch in the existing alignment, creating a new internal node and two new branches (Extended Data Fig. <xref rid="Fig6" ref-type="fig">2</xref>). Progressive Cactus allows adding a new genome in any of these ways, though the details differ (as described below). Assemblies can be replaced with new versions by simply deleting them and adding the new assembly in as a leaf. Adding multiple genomes is possible, either iteratively or (if the new genomes are monophyletic) by aligning together the new genomes and adding in the ancestral clade root.</p>
      <p id="Par130">Adding a genome as an outgroup is straightforward because it follows the normal progressive process: the root of the existing alignment and the new genome can be aligned together into a supertree alignment in which the existing subtree alignment can be appended to. A genome can be added as a new child of an existing internal node by simply aligning the new child, its siblings, and its parent together, without inferring a new ancestral genome. Adding a genome by splitting an existing branch is the least straightforward, but is key if the topology of the alignment or the accuracy of the ancestral genomes is important. To add a genome to an existing alignment, two subproblems are required: one relating the new genome and its new sibling in the target tree, constructing the ancestral genome that will split the existing branch, and one relating this new ancestral genome, its sibling, and its parent.</p>
      <p id="Par131">After the addition of a new genome as an ingroup (by adding it to a node or a branch), at most a single ancestral sequence is re-inferred. This prevents any information from the new genome from propagating to the rest of the tree. Although this saves considerable effort in recomputing other parts of the alignment, it also means that, occasionally, rare stretches of sequence in a newly added genome would not be properly aligned to distant outgroups because they were deleted or missing in the new genome’s close relatives. Re-inferring the ancestral genomes on the path from newly added genomes to the root should address this issue if it appears.</p>
      <p id="Par132">We tested the effect of adding a new genome to an existing alignment using the same set of simulated catarrhine genomes as described above. To replicate the use-case of an end-user wanting to add a genome to a previously-created alignment, we generated an alignment holding out one of the 20 genomes (the crab-eating macaque), and added that genome back into the alignment by both splitting an existing branch (resulting in the same topology as a full alignment would), and by adding the macaque as a new child of an existing ancestor (creating a trifurcation which did not exist in the original tree. All alignments for this analysis were generated using Progressive Cactus commit 49e80082 and we used tools from the hal package (<ext-link ext-link-type="uri" xlink:href="https://github.com/ComparativeGenomicsToolkit/hal">https://github.com/ComparativeGenomicsToolkit/hal</ext-link>, commit 68db41d).</p>
      <p id="Par133">To add the crab-eating macaque back in as the child of an existing node (the add-to-node strategy), we ran a single new alignment with the tree (Rhesus:0.006, Crab_eating_macaque:0.007, Sooty_mangabey:0.001)anc6e;. The anc6e genome from the original, held-out alignment was used as an unreconstructed ancestral input sequence. We set the ‘runMapQFiltering’ option in the config file to ‘0’ and the ‘alignmentFilter’ option to ‘singleCopyOutgroup’, because these options produce a better alignment of polytomies. We merged the resulting HAL file into a new copy of the existing alignment via the command:</p>
      <p id="Par134">
        <code>halReplaceGenome &lt;copy of held-out alignment&gt; anc6e \</code>
      </p>
      <p id="Par135">
        <code>--topAlignmentFile &lt;held-out alignment&gt; \</code>
      </p>
      <p id="Par136">
        <code>--bottomAlignmentFile &lt;add-to-node alignment&gt;.</code>
      </p>
      <p id="Par137">To add the macaque by splitting a branch (the add-to-branch strategy), we ran two separate alignments. We ran the first with the tree (((Rhesus:0.004991, Crab_eating_macaque:0.005991) anc5e:0.001, Sooty_mangabey:0.001)anc6e:0.005, Baboon:0.003042)anc7e; (with the --root anc5e option so that only a single subproblem was run), generating a newly reconstructed anc5e ancestor. We then ran a second alignment with the tree (anc5e:0.001, Sooty_mangabey:0.001)anc6e;, again providing the anc6e assembly from the original alignment rather than inferring a new reconstruction. (We note that these two subproblems could have been run in a single alignment invocation, resulting in the same amount of alignment work but a slightly more complicated merging process.) To merge these two add-to-branch intermediate alignments into a full alignment, we first removed the Rhesus genome from a new copy of the held-out alignment. We then ran  halAddToBranch &lt;held-out alignment&gt; &lt;first add-to-branch alignment&gt; &lt;second add-to-branch alignment&gt; anc6e anc5e  Rhesus Crab_eating_macaque 0.001 0.006.</p>
      <p id="Par138">Both methods resulted in alignments that had accuracy deviating less than 0.1% from the full alignment that included the macaque from the start: both addition methods, as well as the full alignment, achieved an <italic>F</italic><sub>1</sub> score of 0.926 (Extended Data Table <xref rid="Tab2" ref-type="table">1</xref>). We evaluated the performance of these new alignments using mafComparator in the same way as described above. In the interest of narrowly determining the accuracy of alignments involving the newly added genome, we counted only aligned pairs involving the Crab_eating_macaque genome when calculating precision, recall, and <italic>F</italic><sub>1</sub> scores.</p>
    </sec>
    <sec id="Sec31">
      <title>Reporting summary</title>
      <p id="Par139">Further information on research design is available in the <xref rid="MOESM2" ref-type="media">Nature Research Reporting Summary</xref> linked to this paper.</p>
    </sec>
  </sec>
  <sec id="Sec32" sec-type="materials|methods">
    <title>Online content</title>
    <p id="Par140">Any methods, additional references, Nature Research reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at 10.1038/s41586-020-2871-y.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec34">
      <title>Supplementary information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="41586_2020_2871_MOESM1_ESM.pdf">
            <label>Supplementary Information</label>
            <caption>
              <p>A merged PDF containing the individually numbered supplementary figures and supplementary tables referenced in the main text and methods. There are sixteen supplementary figures and fifteen supplementary tables. These supplementary items provide supporting information about the individual experiments described.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="41586_2020_2871_MOESM2_ESM.pdf">
            <caption>
              <p>Reporting Summary</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="41586_2020_2871_MOESM3_ESM.xlsx">
            <label>Supplementary Data</label>
            <caption>
              <p>Excel spreadsheet of mammalian genome assemblies used in the 600-way alignment.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="41586_2020_2871_MOESM4_ESM.xlsx">
            <label>Supplementary Data</label>
            <caption>
              <p>Excel spreadsheet of avian genome assemblies used in the 600-way alignment.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
    <sec id="Sec35">
      <title>Source data</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="41586_2020_2871_MOESM5_ESM.xlsx">
            <caption>
              <p>Source Data Fig. 2</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="41586_2020_2871_MOESM6_ESM.xlsx">
            <caption>
              <p>Source Data Fig. 3</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="41586_2020_2871_MOESM7_ESM.xlsx">
            <caption>
              <p>Source Data Fig. 4</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <app-group>
    <app id="App1">
      <sec id="Sec33">
        <title>Extended data figures and tables</title>
        <p id="Par142">
          <fig id="Fig5">
            <label>Extended Data Fig. 1</label>
            <caption>
              <title>Results from improved paralogue filtering.</title>
              <p><bold>a</bold>, <bold>b</bold>, A sample snake track<sup><xref ref-type="bibr" rid="CR64">64</xref></sup> within a recently duplicated region before (<bold>a</bold>) and after (<bold>b</bold>) the filtering change. Nucleotide substitutions are shown as red bars, and insertions are shown as thin orange bars. <bold>c</bold>, Coverage results from two alignments of identical assemblies using the outgroup and best-hit filtering methods. Multiple-mappings: sites that map to two or more sites on the target genome. <bold>d</bold>, Results from comparing phylogenetic trees implicit in the HAL alignment to ML re-estimated trees of the same regions. ‘Early’ coalescences indicate that too many duplication events have been created in the reconciled trees, and ‘late’ indicates that too many loss events have been created. <bold>e</bold>, Percentage of human genes that map more than once to the chimp/gorilla genomes in two CAT<sup><xref ref-type="bibr" rid="CR9">9</xref></sup> annotations using alignments created with the outgroup and best-hit filtering methods. KZNF, KRAB zinc-finger genes.</p>
            </caption>
            <graphic position="anchor" xlink:href="41586_2020_2871_Fig5_ESM" id="d33e2093"/>
          </fig>
        </p>
        <p id="Par143">
          <fig id="Fig6">
            <label>Extended Data Fig. 2</label>
            <caption>
              <title>Methods of adding a genome to a Progressive Cactus alignment.</title>
              <p>The top row shows the different ways of adding a new genome given its phylogenetic position, and the bottom row shows what subproblems would need to be computed for the new genome to be properly merged into the existing alignment. Green circles represent a new genome, and red circles represent newly reconstructed genomes.</p>
            </caption>
            <graphic position="anchor" xlink:href="41586_2020_2871_Fig6_ESM" id="d33e2104"/>
          </fig>
        </p>
        <p id="Par144">
          <fig id="Fig7">
            <label>Extended Data Fig. 3</label>
            <caption>
              <title>Analysing insertions, deletions and L1PA6 repeats in the 600-way alignment.</title>
              <p><bold>a</bold>, Rates of micro-insertions and -deletions (micro-indels) along each branch within the 600-way alignment, compared to conventional substitutions/site branch length. The data from avian and eutherian branches are separated. Lines show a best-fit linear model for each category. <bold>b</bold>, Violin plot showing the increasing similarity to consensus of L1PA6 elements within reconstructed ancestral genomes along the path to the emergence of modern L1PA6 elements (in the human-rhesus ancestor). Horizontal lines indicate the median values.</p>
            </caption>
            <graphic position="anchor" xlink:href="41586_2020_2871_Fig7_ESM" id="d33e2121"/>
          </fig>
        </p>
        <p id="Par145">
          <table-wrap id="Tab2">
            <label>Extended Data Table 1</label>
            <caption>
              <p>Adding a new genome to an alignment of simulated genomes</p>
            </caption>
            <graphic position="anchor" xlink:href="41586_2020_2871_Tab1_ESM" id="d33e2131">
              <caption>
                <p>Adding a new genome to an alignment of simulated genomes</p>
              </caption>
            </graphic>
            <table-wrap-foot>
              <p>Precision, recall and <italic>F</italic><sub>1</sub> score statistics are all of the aligned pairs that contain a base of the added genome. An alignment in which the genome was included initially is shown for comparison.</p>
            </table-wrap-foot>
          </table-wrap>
        </p>
        <p id="Par146">
          <table-wrap id="Tab3">
            <label>Extended Data Table 2</label>
            <caption>
              <p>Alignment similarity between four alignments of the same 48 avian genomes with different guide trees</p>
            </caption>
            <graphic position="anchor" xlink:href="41586_2020_2871_Tab2_ESM" id="d33e2151">
              <caption>
                <p>Alignment similarity between four alignments of the same 48 avian genomes with different guide trees</p>
              </caption>
            </graphic>
            <table-wrap-foot>
              <p>The similarity between each pair of alignments is represented by the <italic>F</italic><sub>1</sub> score of aligned-pair relationships in the two alignments.</p>
            </table-wrap-foot>
          </table-wrap>
        </p>
      </sec>
    </app>
  </app-group>
  <fn-group>
    <fn>
      <p><bold>Peer review information</bold><italic>Nature</italic> thanks Thomas Keane, Javier Herrero and the other, anonymous, reviewer(s) for their contribution to the peer review of this work.</p>
    </fn>
    <fn>
      <p><bold>Publisher’s note</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Extended data</title>
    <p>is available for this paper at 10.1038/s41586-020-2871-y.</p>
  </sec>
  <sec>
    <title>Supplementary information</title>
    <p>is available for this paper at 10.1038/s41586-020-2871-y.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The research reported in this publication was supported by the National Institutes of Health (NIH) under award numbers U01HG010961, U41HG010972, R01HG010485, 2U41HG007234, 5U54HG007990, 5T32HG008345-04 and U01HL137183. The content is solely the responsibility of the authors and does not necessarily represent the official views of the NIH. Parts of this work and its text were also included in J.A.’s PhD thesis<sup><xref ref-type="bibr" rid="CR63">63</xref></sup>.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>J.A., G.H., D.H., M.D., A.M.N., I.T.F., A.D., R.S.H. and B.P. developed Progressive Cactus and key software upon which it depends. J.A., Q.F., D.X., S.F. and G.S. created and analysed the avian sub-alignment. J.A., D.G., J.J. and V.D.M. created and analysed the mammalian sub-alignment. D.H., K.L., E.K., E.J., G.Z. and B.P. directed and developed the work. M.D. and J.A. performed the human–chicken alignment comparisons. J.A. performed the remaining analyses. J.A. and B.P. wrote the manuscript and all authors edited it.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Data availability</title>
    <p>The 600-way genome alignment is composed of data gathered for the Zoonomia mammalian genomes project and data from the B10K project. All genomes have been archived in GenBank, spreadsheets containing all the accession numbers of the assemblies is provided in the <xref rid="MOESM1" ref-type="media">Supplementary Information</xref>. The 600-way alignment is available in HAL format from <ext-link ext-link-type="uri" xlink:href="https://cglgenomics.ucsc.edu/data/cactus/">https://cglgenomics.ucsc.edu/data/cactus/</ext-link>. At the same location we also provide the subset of the alignment containing the Zoonomia genomes, the subset of the alignment containing the B10K genomes, and a visualization of the alignments and associated data as an assembly hub for the UCSC Browser<sup><xref ref-type="bibr" rid="CR49">49</xref></sup>. Note that the B10K consortium is organizing phylogenomic and other analyses with the avian alignment and sequencing data. We encourage people to contact us for collaboration if they are interested in using these data for phylogenetic analyses. <xref ref-type="sec" rid="Sec35">Source data</xref> are provided with this paper.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Code availability</title>
    <p>The Progressive Cactus pipeline is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ComparativeGenomicsToolkit/cactus">https://github.com/ComparativeGenomicsToolkit/cactus</ext-link> under the MIT license, version 1.0 is archived here: 10.5281/zenodo.3873410. The exact version of Progressive Cactus used for each of the analyses described above varies; for the commit used in each analysis, see the appropriate section of the Methods.</p>
  </notes>
  <notes id="FPar1" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par141">The authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eid</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Real-time DNA sequencing from single polymerase molecules</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>323</volume>
        <fpage>133</fpage>
        <lpage>138</lpage>
        <?supplied-pmid 19023044?>
        <pub-id pub-id-type="pmid">19023044</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weisenfeld</surname>
            <given-names>NI</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Direct determination of diploid genome sequences</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>757</fpage>
        <lpage>767</lpage>
        <?supplied-pmid 5411770?>
        <pub-id pub-id-type="pmid">28381613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Olsen</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Akeson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The Oxford Nanopore MinION: delivery of nanopore sequencing to the genomics community</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>239</fpage>
        <?supplied-pmid 27887629?>
        <pub-id pub-id-type="pmid">27887629</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kitts</surname>
            <given-names>PA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembly: a resource for assembled genomes at NCBI</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>D73</fpage>
        <lpage>D80</lpage>
        <?supplied-pmid 26578580?>
        <pub-id pub-id-type="pmid">26578580</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jain</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and assembly of a human genome with ultra-long reads</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <fpage>338</fpage>
        <lpage>345</lpage>
        <?supplied-pmid 5889714?>
        <pub-id pub-id-type="pmid">29431738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cactus: algorithms for genome multiple sequence alignment</article-title>
        <source>Genome Res.</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>1512</fpage>
        <lpage>1528</lpage>
        <?supplied-pmid 21665927?>
        <pub-id pub-id-type="pmid">21665927</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>SV</given-names>
          </name>
        </person-group>
        <article-title>A maximum pseudo-likelihood approach for estimating species trees under the coalescent model</article-title>
        <source>BMC Evol. Biol.</source>
        <year>2010</year>
        <volume>10</volume>
        <fpage>302</fpage>
        <?supplied-pmid 20937096?>
        <pub-id pub-id-type="pmid">20937096</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rabiee</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sayyari</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mirarab</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>ASTRAL-III: polynomial time species tree reconstruction from partially resolved gene trees</article-title>
        <source>BMC Bioinformatics</source>
        <year>2018</year>
        <volume>19</volume>
        <fpage>153</fpage>
        <?supplied-pmid 29745866?>
        <pub-id pub-id-type="pmid">29745866</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fiddes</surname>
            <given-names>IT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative annotation toolkit (CAT)-simultaneous clade and personal genome annotation</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>28</volume>
        <fpage>1029</fpage>
        <lpage>1038</lpage>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>König</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Romoth</surname>
            <given-names>LW</given-names>
          </name>
          <name>
            <surname>Gerischer</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stanke</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous gene finding in multiple genomes</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>3388</fpage>
        <lpage>3395</lpage>
        <?supplied-pmid 27466621?>
        <pub-id pub-id-type="pmid">27466621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubisz</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Pollard</surname>
            <given-names>KS</given-names>
          </name>
          <name>
            <surname>Siepel</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>PHAST and RPHAST: phylogenetic analysis with space/time models</article-title>
        <source>Brief. Bioinform.</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>41</fpage>
        <lpage>51</lpage>
        <?supplied-pmid 21278375?>
        <pub-id pub-id-type="pmid">21278375</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garber</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identifying novel constrained elements by exploiting biased substitution patterns</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>i54</fpage>
        <lpage>i62</lpage>
        <?supplied-pmid 19478016?>
        <pub-id pub-id-type="pmid">19478016</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Armstrong</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fiddes</surname>
            <given-names>IT</given-names>
          </name>
          <name>
            <surname>Diekhans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Whole-genome alignment and comparative annotation</article-title>
        <source>Annu. Rev. Anim. Biosci.</source>
        <year>2018</year>
        <volume>7</volume>
        <fpage>41</fpage>
        <lpage>64</lpage>
        <?supplied-pmid 30379572?>
        <pub-id pub-id-type="pmid">30379572</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Earl</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Alignathon: a competitive assessment of whole-genome alignment methods</article-title>
        <source>Genome Res.</source>
        <year>2014</year>
        <volume>24</volume>
        <fpage>2077</fpage>
        <lpage>2089</lpage>
        <?supplied-pmid 25273068?>
        <pub-id pub-id-type="pmid">25273068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feng</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Doolittle</surname>
            <given-names>RF</given-names>
          </name>
        </person-group>
        <article-title>Progressive sequence alignment as a prerequisite to correct phylogenetic trees</article-title>
        <source>J. Mol. Evol.</source>
        <year>1987</year>
        <volume>25</volume>
        <fpage>351</fpage>
        <lpage>360</lpage>
        <?supplied-pmid 3118049?>
        <pub-id pub-id-type="pmid">3118049</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Green</surname>
            <given-names>RE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Three crocodilian genomes reveal ancestral patterns of evolution among archosaurs</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>346</volume>
        <fpage>1254449</fpage>
        <?supplied-pmid 25504731?>
        <pub-id pub-id-type="pmid">25504731</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dobrynin</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genomic legacy of the African cheetah, Acinonyx jubatus</article-title>
        <source>Genome Biol.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>277</fpage>
        <?supplied-pmid 26653294?>
        <pub-id pub-id-type="pmid">26653294</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gordon</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Long-read sequence assembly of the gorilla genome</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>352</volume>
        <fpage>aae0344</fpage>
        <?supplied-pmid 27034376?>
        <pub-id pub-id-type="pmid">27034376</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lilue</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sixteen diverse laboratory mouse reference genomes define strain-specific haplotypes and novel functional loci</article-title>
        <source>Nat. Genet.</source>
        <year>2018</year>
        <volume>50</volume>
        <fpage>1574</fpage>
        <lpage>1583</lpage>
        <?supplied-pmid 30275530?>
        <pub-id pub-id-type="pmid">30275530</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kronenberg</surname>
            <given-names>ZN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-resolution comparative analysis of great ape genomes</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>360</volume>
        <fpage>360</fpage>
        <pub-id pub-id-type="pmid">29700240</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darling</surname>
            <given-names>AE</given-names>
          </name>
          <name>
            <surname>Mau</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Perna</surname>
            <given-names>NT</given-names>
          </name>
        </person-group>
        <article-title>progressiveMauve: multiple genome alignment with gene gain, loss and rearrangement</article-title>
        <source>PLoS One</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>e11147</fpage>
        <?supplied-pmid 20593022?>
        <pub-id pub-id-type="pmid">20593022</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blanchette</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Aligning multiple genomic sequences with the threaded blockset aligner</article-title>
        <source>Genome Res.</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>708</fpage>
        <lpage>715</lpage>
        <?supplied-pmid 15060014?>
        <pub-id pub-id-type="pmid">15060014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bray</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>MAVID: constrained ancestral alignment of multiple sequences</article-title>
        <source>Genome Res.</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>693</fpage>
        <lpage>699</lpage>
        <?supplied-pmid 15060012?>
        <pub-id pub-id-type="pmid">15060012</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Harris, R. <italic>Improved Pairwise Alignment of Genomic DNA.</italic> PhD thesis, Pennsylvania State Univ. (2007).</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vivian</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Toil enables reproducible, open source, big biomedical data analyses</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2017</year>
        <volume>35</volume>
        <fpage>314</fpage>
        <lpage>316</lpage>
        <?supplied-pmid 28398314?>
        <pub-id pub-id-type="pmid">28398314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kurtzer</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Sochat</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bauer</surname>
            <given-names>MW</given-names>
          </name>
        </person-group>
        <article-title>Singularity: scientific containers for mobility of compute</article-title>
        <source>PLoS One</source>
        <year>2017</year>
        <volume>12</volume>
        <fpage>e0177459</fpage>
        <?supplied-pmid 28494014?>
        <pub-id pub-id-type="pmid">28494014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hickey</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Earl</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zerbino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>HAL: a hierarchical format for storing and analyzing multiple genome alignments</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>1341</fpage>
        <lpage>1342</lpage>
        <?supplied-pmid 23505295?>
        <pub-id pub-id-type="pmid">23505295</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prum</surname>
            <given-names>RO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comprehensive phylogeny of birds (Aves) using targeted next-generation DNA sequencing</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>526</volume>
        <fpage>569</fpage>
        <lpage>573</lpage>
        <?supplied-pmid 26444237?>
        <pub-id pub-id-type="pmid">26444237</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jarvis</surname>
            <given-names>ED</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Whole-genome analyses resolve early branches in the tree of life of modern birds</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>346</volume>
        <fpage>1320</fpage>
        <lpage>1331</lpage>
        <?supplied-pmid 25504713?>
        <pub-id pub-id-type="pmid">25504713</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Baertsch</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hinrichs</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Evolution’s cauldron: duplication, deletion, and rearrangement in the mouse and human genomes</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>11484</fpage>
        <lpage>11489</lpage>
        <?supplied-pmid 14500911?>
        <pub-id pub-id-type="pmid">14500911</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Zoonomia Consortium. A comparative genomics multitool for scientific discovery and conservation. <italic>Nature</italic>10.1038/s41586-020-2876-6 (2020).</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Feng, S. et al. Dense sampling of bird diversity increases power of comparative genomics. <italic>Nature</italic>10.1038/s41586-020-2873-9 (2020).</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative genomics reveals insights into avian genome evolution and adaptation</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>346</volume>
        <fpage>1311</fpage>
        <lpage>1320</lpage>
        <?supplied-pmid 25504712?>
        <pub-id pub-id-type="pmid">25504712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>J-Q</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Variation in the ratio of nucleotide substitution and indel rates across genomes in mammals and bacteria</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2009</year>
        <volume>26</volume>
        <fpage>1523</fpage>
        <lpage>1531</lpage>
        <?supplied-pmid 19329651?>
        <pub-id pub-id-type="pmid">19329651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Smit, A. F. A., Hubley, R. &amp; Green, P. RepeatMasker Open-4.0 <ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org">http://www.repeatmasker.org</ext-link> (2013–2015).</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>BLAT—the BLAST-like alignment tool</article-title>
        <source>Genome Res.</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <?supplied-pmid 11932250?>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Camacho</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Blast+: architecture and applications</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>421</fpage>
        <?supplied-pmid 20003500?>
        <pub-id pub-id-type="pmid">20003500</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Rhie, A. et al. Towards complete and error-free genome assemblies of all vertebrate species. Preprint at 10.1101/2020.05.22.110833 (2020).</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koepfli</surname>
            <given-names>K-P</given-names>
          </name>
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>the Genome 10K Community of Scientists &amp; O’Brien, S. J. The Genome 10K Project: a way forward</article-title>
        <source>Ann. Rev. Animal Biosci.</source>
        <year>2015</year>
        <volume>3</volume>
        <fpage>57</fpage>
        <lpage>111</lpage>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lewin</surname>
            <given-names>HA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Earth BioGenome Project: Sequencing life for the future of life</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2018</year>
        <volume>115</volume>
        <fpage>4325</fpage>
        <lpage>4333</lpage>
        <?supplied-pmid 29686065?>
        <pub-id pub-id-type="pmid">29686065</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shafin</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Nanopore sequencing and the Shasta toolkit enable efficient de novo assembly of eleven human genomes</article-title>
        <source>Nat. Biotechnol.</source>
        <year>2020</year>
        <volume>38</volume>
        <fpage>1044</fpage>
        <lpage>1053</lpage>
        <?supplied-pmid 32686750?>
        <pub-id pub-id-type="pmid">32686750</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hickey</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genotyping structural variants in pangenome graphs using the vg toolkit</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>35</fpage>
        <?supplied-pmid 32051000?>
        <pub-id pub-id-type="pmid">32051000</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sherman</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assembly of a pan-genome from deep sequencing of 910 humans of African descent</article-title>
        <source>Nat. Genet.</source>
        <year>2019</year>
        <volume>51</volume>
        <fpage>30</fpage>
        <lpage>35</lpage>
        <?supplied-pmid 30455414?>
        <pub-id pub-id-type="pmid">30455414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paradis</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Claude</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Strimmer</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>APE: analyses of phylogenetics and evolution in R language</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>289</fpage>
        <lpage>290</lpage>
        <?supplied-pmid 14734327?>
        <pub-id pub-id-type="pmid">14734327</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Revell</surname>
            <given-names>LJ</given-names>
          </name>
        </person-group>
        <article-title>phytools: an R package for phylogenetic comparative biology (and other things)</article-title>
        <source>Methods Ecol. Evol.</source>
        <year>2012</year>
        <volume>3</volume>
        <fpage>217</fpage>
        <lpage>223</lpage>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Kojima</surname>
            <given-names>KK</given-names>
          </name>
          <name>
            <surname>Kohany</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Repbase Update, a database of repetitive elements in eukaryotic genomes</article-title>
        <source>Mob. DNA</source>
        <year>2015</year>
        <volume>6</volume>
        <fpage>11</fpage>
        <?supplied-pmid 26045719?>
        <pub-id pub-id-type="pmid">26045719</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stecher</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Suleski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hedges</surname>
            <given-names>SB</given-names>
          </name>
        </person-group>
        <article-title>TimeTree: a resource for timelines, timetrees, and divergence times</article-title>
        <source>Mol. Biol. Evolution</source>
        <year>2017</year>
        <volume>34</volume>
        <fpage>1812</fpage>
        <lpage>1819</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>PHYLIP: phylogeny inference package (version 3.2)</article-title>
        <source>Cladistics</source>
        <year>1989</year>
        <volume>5</volume>
        <fpage>164</fpage>
        <lpage>166</lpage>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haeussler</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UCSC Genome Browser database: 2019 update</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D853</fpage>
        <lpage>D858</lpage>
        <?supplied-pmid 30407534?>
        <pub-id pub-id-type="pmid">30407534</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Zhu, J. et al. Comparative genomics search for losses of long-established genes on the human lineage. <italic>PLoS Computational Biol</italic>. <bold>3</bold>, 10.1371/journal.pcbi.0030247 (2007).</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chiaromonte</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Yap</surname>
            <given-names>VB</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Scoring pairwise genomic sequence alignments</article-title>
        <source>Pac. Symp. Biocomput.</source>
        <year>2001</year>
        <volume>2002</volume>
        <fpage>115</fpage>
        <lpage>126</lpage>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Human-mouse alignments with blastz</article-title>
        <source>Genome Res.</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>103</fpage>
        <lpage>107</lpage>
        <?supplied-pmid 12529312?>
        <pub-id pub-id-type="pmid">12529312</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ondov</surname>
            <given-names>BD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>132</fpage>
        <?supplied-pmid 27323842?>
        <pub-id pub-id-type="pmid">27323842</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pevzner</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>De novo repeat classification and fragment assembly</article-title>
        <source>Genome Res.</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>1786</fpage>
        <lpage>1796</lpage>
        <?supplied-pmid 15342561?>
        <pub-id pub-id-type="pmid">15342561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Medvedev</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Brudno</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood genome assembly</article-title>
        <source>J. Comput. Biol.</source>
        <year>2009</year>
        <volume>16</volume>
        <fpage>1101</fpage>
        <lpage>1116</lpage>
        <?supplied-pmid 19645596?>
        <pub-id pub-id-type="pmid">19645596</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Superbubbles, ultrabubbles, and cacti</article-title>
        <source>J. Comput. Biol.</source>
        <year>2018</year>
        <volume>25</volume>
        <fpage>649</fpage>
        <lpage>663</lpage>
        <?supplied-pmid 29461862?>
        <pub-id pub-id-type="pmid">29461862</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Dehal</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Arkin</surname>
            <given-names>AP</given-names>
          </name>
        </person-group>
        <article-title>FastTree 2—approximately maximum-likelihood trees for large alignments</article-title>
        <source>PLoS One</source>
        <year>2010</year>
        <volume>5</volume>
        <fpage>e9490</fpage>
        <?supplied-pmid 20224823?>
        <pub-id pub-id-type="pmid">20224823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frankish</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GENCODE reference annotation for the human and mouse genomes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2019</year>
        <volume>47</volume>
        <fpage>D766</fpage>
        <lpage>D773</lpage>
        <?supplied-pmid 30357393?>
        <pub-id pub-id-type="pmid">30357393</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paten</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cactus graphs for genome comparisons</article-title>
        <source>J. Comput. Biol.</source>
        <year>2011</year>
        <volume>18</volume>
        <fpage>469</fpage>
        <lpage>481</lpage>
        <?supplied-pmid 21385048?>
        <pub-id pub-id-type="pmid">21385048</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Building a pan-genome reference for a population</article-title>
        <source>J. Comput. Biol.</source>
        <year>2015</year>
        <volume>22</volume>
        <fpage>387</fpage>
        <lpage>401</lpage>
        <?supplied-pmid 25565268?>
        <pub-id pub-id-type="pmid">25565268</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jukes</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Cantor</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <article-title>Evolution of protein molecules</article-title>
        <source>Mammalian Protein Metabol.</source>
        <year>1969</year>
        <volume>III</volume>
        <fpage>21</fpage>
        <lpage>132</lpage>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood and minimum-steps methods for estimating evolutionary trees from data on discrete characters</article-title>
        <source>Systematic Zool.</source>
        <year>1973</year>
        <volume>22</volume>
        <fpage>240</fpage>
        <lpage>249</lpage>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <mixed-citation publication-type="other">Armstrong, J. <italic>Enabling Comparative Genomics at the Scale of Hundreds of Species.</italic> PhD thesis, Univ. California Santa Cruz (2019).</mixed-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparative assembly hubs: web-accessible browsers for comparative genomics</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>3293</fpage>
        <lpage>3301</lpage>
        <?supplied-pmid 25138168?>
        <pub-id pub-id-type="pmid">25138168</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
