<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10182851</article-id>
    <article-id pub-id-type="pmid">37140544</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad279</article-id>
    <article-id pub-id-type="publisher-id">btad279</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Kimma: flexible linear mixed effects modeling with kinship covariance for RNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1481-7065</contrib-id>
        <name>
          <surname>Dill-McFarland</surname>
          <given-names>Kimberly A</given-names>
        </name>
        <aff><institution>Division of Allergy and Infectious Diseases, Department of Medicine, University of Washington, 750 Republican St</institution>, Seattle, WA 98109, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mitchell</surname>
          <given-names>Kiana</given-names>
        </name>
        <aff><institution>Division of Allergy and Infectious Diseases, Department of Medicine, University of Washington, 750 Republican St</institution>, Seattle, WA 98109, <country country="US">United States</country></aff>
        <aff><institution>Department of Biology, University of California San Diego, 9500 Gilman Dr</institution>, La Jolla, CA 92093, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Batchu</surname>
          <given-names>Sashank</given-names>
        </name>
        <aff><institution>Division of Allergy and Infectious Diseases, Department of Medicine, University of Washington, 750 Republican St</institution>, Seattle, WA 98109, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Segnitz</surname>
          <given-names>Richard Max</given-names>
        </name>
        <aff><institution>Division of Allergy and Infectious Diseases, Department of Medicine, University of Washington, 750 Republican St</institution>, Seattle, WA 98109, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Benson</surname>
          <given-names>Basilin</given-names>
        </name>
        <aff><institution>Systems Immunology Division, Benaroya Research Institute, 1201 Ninth Avenue</institution>, Seattle, CA 98101, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Janczyk</surname>
          <given-names>Tomasz</given-names>
        </name>
        <aff><institution>Systems Immunology Division, Benaroya Research Institute, 1201 Ninth Avenue</institution>, Seattle, CA 98101, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cox</surname>
          <given-names>Madison S</given-names>
        </name>
        <aff><institution>Division of Allergy and Infectious Diseases, Department of Medicine, University of Washington, 750 Republican St</institution>, Seattle, WA 98109, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mayanja-Kizza</surname>
          <given-names>Harriet</given-names>
        </name>
        <aff><institution>Department of Medicine, School of Medicine, Makerere University</institution>, PO Box 7072, Kampala, <country country="UG">Uganda</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boom</surname>
          <given-names>William Henry</given-names>
        </name>
        <aff><institution>Department of Medicine, Case Western Reserve University, 10900 Euclid Ave</institution>, Cleveland, OH 44106, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Benchek</surname>
          <given-names>Penelope</given-names>
        </name>
        <aff><institution>Department of Population &amp; Quantitative Health Sciences, Case Western Reserve University, 10900 Euclid Ave</institution>, Cleveland, OH 44106, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stein</surname>
          <given-names>Catherine M</given-names>
        </name>
        <aff><institution>Department of Population &amp; Quantitative Health Sciences, Case Western Reserve University, 10900 Euclid Ave</institution>, Cleveland, OH 44106, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hawn</surname>
          <given-names>Thomas R</given-names>
        </name>
        <aff><institution>Division of Allergy and Infectious Diseases, Department of Medicine, University of Washington, 750 Republican St</institution>, Seattle, WA 98109, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Altman</surname>
          <given-names>Matthew C</given-names>
        </name>
        <aff><institution>Division of Allergy and Infectious Diseases, Department of Medicine, University of Washington, 750 Republican St</institution>, Seattle, WA 98109, <country country="US">United States</country></aff>
        <aff><institution>Systems Immunology Division, Benaroya Research Institute, 1201 Ninth Avenue</institution>, Seattle, CA 98101, <country country="US">United States</country></aff>
        <xref rid="btad279-cor1" ref-type="corresp"/>
        <!--maltman@benaroyaresearch.org-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad279-cor1">Corresponding author. Systems Immunology Program, Benaroya Research Institute, Seattle, WA 98101, USA. E-mail: <email>maltman@benaroyaresearch.org</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-05-04">
      <day>04</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>5</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>5</issue>
    <elocation-id>btad279</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>04</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>06</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>13</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad279.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The identification of differentially expressed genes (DEGs) from transcriptomic datasets is a major avenue of research across diverse disciplines. However, current bioinformatic tools do not support covariance matrices in DEG modeling. Here, we introduce kimma (Kinship In Mixed Model Analysis), an open-source R package for flexible linear mixed effects modeling including covariates, weights, random effects, covariance matrices, and fit metrics.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>In simulated datasets, kimma detects DEGs with similar specificity, sensitivity, and computational time as limma unpaired and dream paired models. Unlike other software, kimma supports covariance matrices as well as fit metrics like Akaike information criterion (AIC). Utilizing genetic kinship covariance, kimma revealed that kinship impacts model fit and DEG detection in a related cohort. Thus, kimma equals or outcompetes current DEG pipelines in sensitivity, computational time, and model complexity.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Kimma is freely available on GitHub <ext-link xlink:href="https://github.com/BIGslu/kimma" ext-link-type="uri">https://github.com/BIGslu/kimma</ext-link> with an instructional vignette at <ext-link xlink:href="http://rId11" ext-link-type="uri">https://bigslu.github.io/kimma_vignette/kimma_vignette.html</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Bill and Melinda Gates Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000865</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>OPP1151836</award-id>
        <award-id>National Institutes of Health</award-id>
        <award-id>R01AI124348</award-id>
        <award-id>U01AI115642</award-id>
        <award-id>U19AI162583</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Transcriptomics provide a powerful method to capture genome-wide RNA expression at relatively low costs. Methods such as microarray and RNA-seq allow for in-depth assessment across populations and time scales relevant to research in human health, disease, ecology, and others. Transcriptomics studies tend to have experimental designs with many more measures (e.g. genes) than observations (e.g. subjects or libraries). Thus, subsequent analyses require multiple comparison correction, which can obscure true biological results in an effort to reduce Type I error (<xref rid="btad279-B12" ref-type="bibr">Korthauer et al. 2019</xref>). In addition, numerous or complex covariates can be necessary to correct for diverse populations, and designs can include repeated measures, paired sampling, or blocking. Together, these features require diverse statistical methods and robust model fit assessments to achieve accurate transcriptomic results.</p>
    <p>Presently, there are a variety of analysis pipelines for the identification of differentially expressed genes (DEGs) in bulk transcriptomic datasets (<xref rid="btad279-B6" ref-type="bibr">Conesa et al. 2016</xref>). DEGs represent one of the major results from RNA-seq experiments and drive discoveries in this space. While current DEG analysis tools can accommodate a range of models, none support the inclusion of complex random effects like covariance matrices. These matrices consist of more than one measure per observation, such as pairwise comparisons, and thus, cannot be modeled as fixed or simple random effects in current software. In addition, covariance random effects are distinct from the challenges of covariance within transcriptomic data which have been explored in several recent studies using coexpressed genes (<xref rid="btad279-B11" ref-type="bibr">Kochan et al. 2021</xref>) or gene sets (<xref rid="btad279-B3" ref-type="bibr">Chang et al. 2017</xref>; <xref rid="btad279-B20" ref-type="bibr">Qayed and Han 2021</xref>).</p>
    <p>Among current parametric DEG pipelines, limma (<xref rid="btad279-B22" ref-type="bibr">Ritchie et al. 2015</xref>), DESeq2 (<xref rid="btad279-B15" ref-type="bibr">Love et al. 2014</xref>), and edgeR (<xref rid="btad279-B23" ref-type="bibr">Robinson et al. 2010</xref>) are the most popular, each with well over 10 000 citations since their publication. Limma utilizes simple linear regression and empirical Bayes statistics to assess differential gene expression. This R package also supports gene-specific weights to account for library quality (<xref rid="btad279-B13" ref-type="bibr">Law et al. 2014</xref>) and a pseudorandom effect to account for paired sample designs or repeated measures. Others have expanded on the limma framework with dream in the VariancePartition R package to incorporate true random effects to account for paired designs more accurately as well as support multiple blocking variables in complex mixed effects designs (<xref rid="btad279-B10" ref-type="bibr">Hoffman and Roussos, 2021</xref>). In contrast, DESeq2 and edgeR employ negative binomial regression to assess differential expression. This statistical framework does not require gene-level weights but also does not support random effects or paired designs. Overall, these methods support many RNA-seq study designs but fail to incorporate those with potential covariance effects. Moreover, current software provides minimal fit metrics for assessment of a “best fit” model.</p>
    <p>One potential covariance effect of interest in transcriptomic research is kinship, a summative measure of genetic relatedness that estimates recent family structure while correcting for long-term population structure (<xref rid="btad279-B16" ref-type="bibr">Manichaikul et al. 2010</xref>). Previous transcriptomic studies have estimated relatedness through coarse measures such as family groups; however, more granular relatedness measures are needed since only a subset of single nucleotide polymorphisms (SNPs) correlate with gene expression and heritability varies across the genome (<xref rid="btad279-B19" ref-type="bibr">Price et al. 2011</xref>). Moreover, pedagogies assume perfect Mendelian genetics and are subject to errors as a result of incorrect or incomplete family histories. Kinship determined from genetic sequencing provides a better estimate of relatedness as it is directly measurable and not reliant on historical memory. Moreover, kinship has been shown to describe recent population relatedness beyond immediate family groups more accurately than social constructs like race and ethnicity (<xref rid="btad279-B5" ref-type="bibr">Collins et al. 2003</xref>). Thus, kinship may improve DEG analyses in both related and unrelated cohorts by correcting for underlying genetic differences that confound true signals of interest.</p>
    <p>Here, we present kimma for kinship in mixed model analysis to support DEG analyses including covariance random effects. Kimma is an open-source R package that provides flexible linear mixed effects modeling for bulk RNA-seq data including univariate, multivariate, random, and covariance random effects as well as gene-level weights. Building on well-tested statistical packages in R such as stats (<xref rid="btad279-B21" ref-type="bibr">R Core Team 2022</xref>) and lme4 (<xref rid="btad279-B1" ref-type="bibr">Bates et al. 2015</xref>), kimma utilizes a single function, kmFit, for modeling, ensuring consistent syntax, inputs, and outputs. Moreover, kimma provides <italic toggle="yes">post hoc</italic> pairwise tests, model fit metrics like Akaike information criterion (AIC), and fit warnings on a per gene basis. Kimma’s outputs can also be integrated into our sister R packages in the BIGverse for visualization of results as well as gene set analyses.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Data acquisition and generation</title>
      <sec>
        <title>2.1.1 Tuberculosis dataset</title>
        <p>Study recruitment (<xref rid="btad279-B26" ref-type="bibr">Stein et al. 2019</xref>) and RNA-seq experiments (<xref rid="btad279-B24" ref-type="bibr">Simmons et al. 2018</xref>, <xref rid="btad279-B25" ref-type="bibr">2022</xref>) were previously described. Briefly, household contacts of individuals with active pulmonary tuberculosis were followed for 8–10 years and classified as persistently TST-/IGRA- resisters (RSTR) or latent tuberculosis infection (LTBI). Monocytes were extracted from whole blood and cultured without stimulation (media) or with <italic toggle="yes">Mycobacterium tuberculosis</italic> strain H37Rv (Mtb; MOI 1.0, 6 h). Bulk RNA sequencing was performed using Illumina 50 bp paired-end sequencing, and sequences were aligned to GRCh38 with STAR (<xref rid="btad279-B7" ref-type="bibr">Dobin et al. 2013</xref>). Low abundance genes were removed if they did not reach at least 1 count per million (CPM) in 5% of samples in the original dataset. Genetic kinship was determined from Illumina MEGAEX array data and methods as described in <xref rid="btad279-B17" ref-type="bibr">McHenry et al. (2021)</xref>. Briefly, 63 812 high-quality SNPs were obtained from the subset of the Ugandan cohort used in this study (minor allele frequency &gt; 5%, Hardy–Weinberg disequilibrium <italic toggle="yes">P</italic> &lt; 1E−6, call rate &gt; 95%, linkage disequilibrium <italic toggle="yes">R</italic><sup>2</sup> &lt; .1). Kinship was calculated from SNPs using the robust KING method corrected for two population principal components.</p>
      </sec>
      <sec>
        <title>2.1.2 Simulated data generation</title>
        <p>In order to maintain the paired sample design, 100 simulated DEGs datasets were created from the uninfected, media samples from the RSTR/LTBI tuberculosis dataset. In total, 1000 random genes were selected and copied for simulated samples. Then, 50 DEGs were created at each fold change of 1%, 5%, 10%, 50%, and 100%, and random error of ±5% was introduced to all genes.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Statistical models</title>
      <sec>
        <title>2.2.1 Limma and dream models</title>
        <p>Gene expression was modeled as trimmed mean of means (TMM) normalized log<sub>2</sub> CPM. For limma (v3.50.3; <xref rid="btad279-B22" ref-type="bibr">Ritchie et al. 2015</xref>), linear models were fit, and <italic toggle="yes">P</italic>-values were estimated using the empirical Bayes method. Pseudo-paired sample design was estimated using mean correlation of expression between paired samples across all genes (duplicateCorrelation). For dream (variancePartition v1.24.0; <xref rid="btad279-B10" ref-type="bibr">Hoffman and Roussos 2021</xref>), only paired sample designs were run as its unpaired designs are equivalent to limma. Linear mixed effects models were fit blocked by donor, and <italic toggle="yes">P</italic>-values were estimated using the empirical Bayes method. Where specified, gene-level quality weights were calculated using voomWithQualityWeights for limma or dreamWithQualityWeights for dream and incorporated in the models.</p>
      </sec>
      <sec>
        <title>2.2.2 DESeq2 and edgeR models</title>
        <p>Gene expression was modeled as unnormalized counts as recommended by the software. For DESeq2 (1.34.0; <xref rid="btad279-B15" ref-type="bibr">Love et al. 2014</xref>), negative binomial general linear models including total library size and estimated dispersion were fit, and <italic toggle="yes">P</italic>-values were estimated using the Wald test. For edgeR (3.38.4; <xref rid="btad279-B23" ref-type="bibr">Robinson et al. 2010</xref>), quasi-likelihood negative binomial general linear models including total library size and estimated dispersion were fit, and <italic toggle="yes">P</italic>-values were estimated using the <italic toggle="yes">F</italic>-test. For both, pseudo-paired sample design was estimated by including donor as the first main effect term. DESeq2 and edgeR do not support gene-level quality weights.</p>
      </sec>
      <sec>
        <title>2.2.3 Kimma models</title>
        <p>Gene expression was modeled as TMM normalized log<sub>2</sub> CPM. For kimma (v1.2.0), linear models were fit, and <italic toggle="yes">P</italic>-values were estimated using restricted maximum likelihood. Simple linear regression was performed with base R stats::lm (<xref rid="btad279-B21" ref-type="bibr">R Core Team 2022</xref>), mixed effects for paired sample designs with lme4::lmer (<xref rid="btad279-B1" ref-type="bibr">Bates et al. 2015</xref>), and mixed effects for paired sample designs with kinship with lme4qtl::relmatLmer (<xref rid="btad279-B27" ref-type="bibr">Ziyatdinov et al. 2018</xref>). As with limma, gene-level quality weights calculated using voomWithQualityWeights were incorporated for some models. Though not applicable in these analyses, kimma can also fit pairwise contrasts within main model terms using estimated marginal means in the emmeans package (<xref rid="btad279-B14" ref-type="bibr">Lenth 2022</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Data analysis</title>
      <sec>
        <title>2.3.1 Simulated data analysis</title>
        <p>Simulated DEGs were modeled against their corresponding media samples. Within each of 100 simulated datasets, sensitivity was defined as true positive/(true positive + false negative) and specificity as true negative/(true negative + false positive). Area under the curve (AUC) was calculated for 1 − specificity by sensitivity at <italic toggle="yes">P</italic>-value cutoffs in increments of 0.001 from 0 to 0.01 plus increments of 0.01 from 0.01 to 1. Time trials were run on Amazon Web Services (48 vCPU, 192 GB RAM) with one or six processors as appropriate and nothing else running.</p>
      </sec>
      <sec>
        <title>2.3.2 Tuberculosis data analysis</title>
        <p>In total, 13 972 pass-filter genes (see <xref rid="btad279-B25" ref-type="bibr">Simmons et al. 2022</xref>) were modeled for media versus Mtb-infected in paired LTBI samples (<italic toggle="yes">n</italic> = 92) as well as RSTR versus LTBI in unpaired Mtb-infected samples (<italic toggle="yes">n</italic> = 98). Analyses were completed on the entire dataset as well as subsets of unrelated (kinship &lt; 0.125, <italic toggle="yes">n</italic> = 55, 62) and related samples (at least one kinship &gt; 0.125, <italic toggle="yes">n</italic> = 37, 36). Genes found to be significant for Mtb versus media in the related subset with kinship correction were extracted from genetic data with SNPs found on both the MEGAEX and Omni chip (<xref rid="btad279-B17" ref-type="bibr">McHenry et al. 2021</xref>). In total, 3382 of these 8525 DEGs had at least 1 pass-filter SNP within the gene transcript region (<italic toggle="yes">cis</italic>) to yield 10 020 unique SNP–DEG pairs. Each SNP–DEG pair was modeled as an expression quantitative loci (eQTL) using the interaction of Mtb infection and genotype. Significant genes and eQTLs were defined at false discovery rate [FDR] &lt; 0.05. Model fit was measured by AIC.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>The kimma R package provides flexible linear modeling of RNA-seq data with a single function, kmFit. This package is open-source and freely available on GitHub (<ext-link xlink:href="https://github.com/BIGslu/kimma" ext-link-type="uri">https://github.com/BIGslu/kimma</ext-link>). Kimma fits linear and/or linear mixed effects models incorporating gene-level weights, covariates, and/or random effects. In addition, kimma provides easy comparison of model fits with metrics such as AIC, BIC, and <italic toggle="yes">R</italic><sup>2</sup> as well as downstream analyses including summary tables and eQTL. The kimma outputs feed directly into our related packages such as plotting in BIGpicture and gene set analysis in SEARchways. Collectively, these R packages work together in the meta-package BIGverse (<xref rid="btad279-F1" ref-type="fig">Fig. 1</xref>).</p>
    <fig position="float" id="btad279-F1">
      <label>Figure 1.</label>
      <caption>
        <p>BIGverse workflow. Log2 normalized CPM gene expression is input into the BIGverse pipeline. Prior to modeling, variables of interest can be explored by PCA using BIGpicture. Gene expression is then modeled in kimma with kmFit using simple linear (lm), linear mixed effects (lme), and/or lme with kinship relatedness (lmerel). Each model results in up to four data frames: estimates and significance, goodness of fit metrics, pairwise contrasts, and errors for genes that failed fitting. Model fit is assessed by metrics, such as AIC, which can be plotted in BIGpicture. Significant genes are summarized in kimma and plotted using Venn diagrams in BIGpicture. The SEARchways package is used for pathway analyses such as gene set enrichment analysis (GSEA) with kmFit model estimates of fold change and hypergeometric pathway enrichment of significant genes. Significant pathways are visualized as well as annotated to specific genes in STRING networks using BIGpicture. In addition, kimma provides functionality to import limma results for use in parallel analyses and visualization.</p>
      </caption>
      <graphic xlink:href="btad279f1" position="float"/>
    </fig>
    <sec>
      <title>3.1 Benchmarking kimma using simulated data</title>
      <sec>
        <title>3.1.1 Kimma performs as well as current methods for DEG analysis without kinship</title>
        <p>To test kimma’s performance, we constructed simulated test datasets from previously published RNA-seq data which included two groups [resister (RSTR) and LTBI] and two conditions [media and Mtb infection] in a household-based cohort of individuals with varying degrees of relatedness (<xref rid="btad279-B24" ref-type="bibr">Simmons et al. 2018</xref>, <xref rid="btad279-B25" ref-type="bibr">2022</xref>). Modeling was performed in kimma, limma, dream, DESeq2, and edgeR using 100 simulated datasets of 250 DEGs with fold changes from 1% to 100% and 750 non-DEGs (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1A</xref>). In unpaired model designs, kimma and limma resulted in similar sensitivity and specificity (mean AUC 0.93; <xref rid="btad279-F2" ref-type="fig">Fig. 2</xref>). DESeq2 and edgeR’s negative binomial models performed significantly worse than all unpaired kimma or limma models (mean AUC 0.57, 0.51, FDR &lt; 0.05). In paired designs, kimma’s random effect and dream’s repeated measures (mean AUC 0.98) slightly outperformed limma’s duplicateCorrelation pseudorandom effect (mean AUC 0.95) and greatly outperformed DESeq2 and edgeR’s fixed effect for donor (mean AUC 0.47, 0.45, FDR &lt; 0.05). Within a model type and software, gene-level weights had no effect on DEG detection.</p>
        <fig position="float" id="btad279-F2">
          <label>Figure 2.</label>
          <caption>
            <p>DEGs detected across linear models and software. AUC was calculated from curves of 1 − specificity to sensitivity for <italic toggle="yes">P</italic>-value cutoffs from 0 to 1 in 100 simulated datasets. When available, models were corrected for gene-level weights (kimma, limma, dream) and/or paired design (kimma, limma, dream, DESeq2, edgeR) as indicated by panel headers. Black squares indicate means with standard deviation bars. Across all panels, letters indicate statistically different groups, Tukey FDR &lt; 0.05, in order from highest AUC (a) to lowest (g). Points are colored by software package.</p>
          </caption>
          <graphic xlink:href="btad279f2" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>3.1.2 Kimma’s multiprocessor functions achieve runtimes similar to limma</title>
        <p>Multiple processor functionalities in kimma, dream, and DESeq2 were compared across simulated datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1A</xref>) on six processors as this is a reasonable load for standard 8-core laptops. In paired model designs, kimma runtime linearly decreased from 72 s on one processor to 12 s on six processors (<xref rid="btad279-F3" ref-type="fig">Fig. 3B</xref>). Kimma’s six-processor speed was as fast or slightly faster than all other software in paired designs (FDR &lt; 0.05). In contrast, dream was slower and did not reduce time linearly, taking 55 s on one processor and 26 s on six processors. DESeq2 and edgeR were the slowest software for paired designs on one processor, though these methods use donor as a fixed effect, thus increasing model complexity compared with other methods. In contrast, limma outperformed all other software with edgeR as a close second for speed in unpaired designs (<xref rid="btad279-F3" ref-type="fig">Fig. 3A</xref>).</p>
        <fig position="float" id="btad279-F3">
          <label>Figure 3.</label>
          <caption>
            <p>Runtime to analyze simulated RNA-seq data across linear models and software. (A) Unpaired models without random effects. Time in seconds. (B) Paired models with donor as a random effect. Time in minutes. Models were run for 100 simulated datasets of 92 samples and 1000 genes. When available, models were corrected for gene-level weights (kimma, limma, dream) and/or paired design (kimma, limma, dream, DESeq2, edgeR) as indicated by panel headers. Multiprocessor usage is shown for kimma, dream, and DESeq2 at one (blue) or six processors (orange). Limma and edgeR do not have this option. Black squares indicate means with standard deviation bars. Within (A) or (B) separately, letters indicate statistically different groups, Tukey HSD FDR &lt; 0.05, in order from shortest time (a) to longest (e or h).</p>
          </caption>
          <graphic xlink:href="btad279f3" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>3.2 Benchmarking kimma using real-world data</title>
      <sec>
        <title>3.2.1 Kimma provides additional functionalities at no cost to computational time</title>
        <p>We next used full-size data analysis to test whether kimma can incorporate multiple model types and other features while keeping computational time low. In a dataset of 13 972 protein-coding genes and 98 samples, model fitting and significance estimation takes &lt;90 s (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). The addition of fit metric calculation, gene-level weights, covariates, or interaction terms has no effect on total processing time. Adding pairwise contrasts between multilevel variables or interaction terms, paired sample design as a random effect, or kinship as a covariance random effect increases computational time to between 3 and 4 min for this dataset. Combining kimma’s features increases processing time almost linearly as a model with all seven features increased time by a factor of six and running three models at once takes roughly the sum of time for the three models run separately.</p>
      </sec>
      <sec>
        <title>3.2.2 Kimma detects more DEGs in real-world paired model designs</title>
        <p>We next compared DEG detection in real-world data. In a dataset of Mtb infected versus media controls in LTBI and RSTR donors (<xref rid="btad279-B25" ref-type="bibr">Simmons et al. 2022</xref>), DEGs were modeled using the best performing methods based on simulated data analyses (<xref rid="btad279-F2" ref-type="fig">Fig. 2</xref>). Thus, kimma and dream were compared for paired designs (<xref rid="btad279-F2" ref-type="fig">Fig. 2</xref>, Group a) while kimma and limma were compared for unpaired designs (<xref rid="btad279-F2" ref-type="fig">Fig. 2</xref>, Group c).</p>
        <p>For paired Mtb infected and media samples (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1B</xref>), the majority of DEGs were detected by all models, and gene-level weights resulted in the largest addition of 209 DEGs regardless of software (FDR &lt; 0.05; <xref rid="btad279-F4" ref-type="fig">Fig. 4</xref>). Overall, kimma with weights resulted in the most DEGs with 95 more DEGs than dream with weights, of which 50 were specific to only the kimma with weights method. At an FDR of 0.05, simulated data analysis showed kimma to have minimally but consistently higher sensitivity (max delta sensitivity 0.02) when compared with dream (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). This supports the detection of more true-positive DEGs by kimma in the Mtb analysis compared with dream. In contrast, an unpaired analysis of LTBI versus RSTR (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1C</xref>) resulted in six DEGs identified by all models and software (FDR &lt; 0.05). This is further supported by the unpaired simulated analysis where differences in sensitivity were very low and did not always support the same model (max delta sensitivity 0.008, <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
        <fig position="float" id="btad279-F4">
          <label>Figure 4.</label>
          <caption>
            <p>Real-world RNA-seq data analysis across paired models and software. Using the best performing models from simulated data, real-world data was assessed for the impacts of Mtb infection in paired designs (<xref rid="btad279-F2" ref-type="fig">Fig. 2</xref>, Group a). Venn diagrams show total DEGs.</p>
          </caption>
          <graphic xlink:href="btad279f4" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>3.3 Novel kimma models and features</title>
      <sec>
        <title>3.3.1 Kinship improves model fit and DEG detection in paired, genetically related datasets</title>
        <p>Unlike other RNA-seq analysis packages, kimma allows incorporation of a covariance random effect such as pairwise genetic kinship. Here, the Mtb versus media and RSTR versus LTBI data were split into unrelated (kinship &lt; 0.125) and related subsets (at least one kinship &gt; 0.125) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1B and C</xref>) to assess the impacts of kinship in linear mixed effects models. In the paired Mtb infected versus media model, the addition of kinship among unrelated individuals did not impact model fit (<xref rid="btad279-F5" ref-type="fig">Fig. 5A</xref>) with only two genes reaching an absolute delta AIC &gt; 2 (max delta AIC = 2.4). This corresponded with minimal changes in DEG detection as both models identified 99.9% of the same genes at FDR &lt; 0.05 (<xref rid="btad279-F5" ref-type="fig">Fig. 5B</xref>).</p>
        <fig position="float" id="btad279-F5">
          <label>Figure 5.</label>
          <caption>
            <p>Paired design model fit and DEGs in genetically unrelated and related datasets. LTBI individuals were subset into unrelated and related subsets at a kinship cutoff of 0.125. Subsets were modeled for Mtb-infected versus media expression. (A) Model fit was assessed by AIC. Change in AIC was calculated per gene for the model without kinship minus the model with kinship. Black squares indicate means. Dashed lines indicate minimal change in AIC (<italic toggle="yes">y</italic> = −2 or 2). DEGs were defined at FDR &lt; 0.05 in the (B) unrelated and (C) related subsets. (D) Expression of the top Mtb: SNP cis eQTL from kinship DEGs in the related subset.</p>
          </caption>
          <graphic xlink:href="btad279f5" position="float"/>
        </fig>
        <p>In contrast, Mtb model fit of related individuals was impacted by kinship (<xref rid="btad279-F5" ref-type="fig">Fig. 5A</xref>) with 1247 genes better fit by &gt;2 AIC with kinship (max delta AIC = 6.6) and 518 better fit without kinship (max delta AIC = 6.8). This resulted in changes in DEG detection with 25 new DEGs detected in the kinship model (<xref rid="btad279-F5" ref-type="fig">Fig. 5C</xref>). Importantly, 91 of the 147 DEGs only detected without kinship were better fit by the model with kinship according to AIC. Thus, the addition of kinship appears to reduce Type I error by improving fit for a subset of genes.</p>
        <p>In the unpaired RSTR versus LTBI design, kinship did not improve model fit with the majority of genes (98%) better fit without kinship in the model for both unrelated and related subsets (max delta AIC = 23; <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3A</xref>). While more DEGs were detected with kinship in the unpaired, related subset, the majority of these genes (369 of 376) were better fit by AIC without kinship in the model. Thus, the inclusion of kinship in unpaired designs with minimal relatedness may result in higher Type I error due to a poorer fitting unpaired model.</p>
      </sec>
      <sec>
        <title>3.3.2 Kimma extends to other applications such as eQTL analysis</title>
        <p>Downstream analysis of RNA-seq data often includes expression quantitative trait loci (eQTL), where SNPs are associated with gene expression. Kimma’s kmFit_eQTL function provides the means to test eQTLs with the same flexible modeling and fit assessment features as kmFit. As a test case, we utilized genome-wide SNP data from the same cohort to determine eQTL for DEGs identified in the Mtb-related kinship model. Among the kinship model DEGs (<italic toggle="yes">n</italic> = 8525; <xref rid="btad279-F5" ref-type="fig">Fig. 5C</xref>), we identified 10 020 potential within-gene <italic toggle="yes">cis</italic> eQTL in 3382 unique genes. In total, 289 eQTL in 253 unique genes were significant for the interaction of SNP and Mtb infection (FDR &lt; 0.05). The top hit was genotype rs12071446 which was associated with Mtb-induced expression of the CHRM3 gene (FDR = 2.2E−7; <xref rid="btad279-F5" ref-type="fig">Fig. 5D</xref>). This analysis framework can be readily applied to any gene(s) of interest to determine genetic regulation of gene expression using the same robust models as DEG detection.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Transcriptomics is utilized in many fields to address diverse scientific questions. Identification of DEGs remains a cornerstone of analysis of these data, and current bioinformatic tools support a range of study designs. Here, we introduce kimma, an open-source R package that expands supported parametric designs to include covariance random effects. In addition, kimma provides robust model fit assessment and integrates with several downstream analysis and visualization functions for a more streamlined RNA-seq analysis pipeline.</p>
    <p>Kimma does not present new statistical methods but instead, builds on well-tested linear modeling methods in R. Simple linear models use base R’s lm (<xref rid="btad279-B21" ref-type="bibr">R Core Team 2022</xref>) and linear mixed effects models use lme4’s lmer (<xref rid="btad279-B1" ref-type="bibr">Bates et al. 2015</xref>). Both are widely used and have been available in R for nearly 20 years. Models with covariance matrices are a new addition and utilize lme4qtl’s relmatLmer (<xref rid="btad279-B27" ref-type="bibr">Ziyatdinov et al. 2018</xref>), which builds on the foundation of lme4. While there are several R-based methods for modeling with covariance matrices, lme4qtl allows seamless integration with and comparisons to models from lm and lme4. Kimma then brings these methods together to efficiently run thousands of statistical tests while codifying similar parameters such as gene-level weights and resulting in consistent, organized outputs. These results then easily flow into the BIGverse RNA-seq analysis pipeline including data visualization in BIGpicture, gene set analyses in SEARchways, and eQTL analysis in kimma.</p>
    <p>In simulated paired study designs, kimma performs as well as or better than limma (<xref rid="btad279-B13" ref-type="bibr">Law et al. 2014</xref>; <xref rid="btad279-B22" ref-type="bibr">Ritchie et al. 2015</xref>), dream (<xref rid="btad279-B10" ref-type="bibr">Hoffman and Roussos 2021</xref>), DESeq2 (<xref rid="btad279-B15" ref-type="bibr">Love et al. 2014</xref>), and edgeR (<xref rid="btad279-B23" ref-type="bibr">Robinson et al. 2010</xref>). Kimma’s true mixed effects modeling results in comparable sensitivity and specificity to dream, both of which outperform limma’s pseudorandom effect with duplicateCorrelation. Kimma outperforms dream with shorter computational time on multiple processors. In fact, kimma’s multiprocessor functionality affords runtimes on the order of minutes for full-size RNA-seq data (∼14 000 genes, 100 samples) even when multiple additional features or models are requested. These results translate to real-world paired analyses where kimma detects more DEGs than comparable models in dream. Our results suggest these are true positives as kimma also resulted in slightly higher sensitivity in simulated DEG detection.</p>
    <p>In predefined unpaired study designs, limma remained the preferred software because while limma and kimma had similar simulated DEG detection, limma achieved faster runtimes. However, limma does not support model fit assessment through metrics such as AIC and requires multiple models to run pairwise contrasts. In addition, kimma out-performed DESeq2 and edgeR with significantly better DEG detection. Thus, kimma results in equivalent or better DEG detection along with additional functionalities in unpaired analyses where model selection is on-going or multi-level variables such as interaction terms are of interest.</p>
    <p>Kimma also allows for the use of covariance matrix random effects in linear modeling; these random effects are not supported by any other current method. Here, we use pairwise genetic kinship as an example, but any covariance matrix may be used. In paired study designs, kinship improved model fit and reduced Type I error in DEG detection in genetically related individuals. This effect was apparent even though the current dataset contains only sparse relatedness with 1.4% of pairs achieving third degree relatedness or higher. Model fit was not significantly impacted by kinship in unrelated individuals. In addition, kinship did not improve model fit and appeared to increase Type I error in unpaired designs. Thus, paired designs benefit from kinship inclusion and are not negatively impacted when kinship is nonsignificant. Together, these analyses highlight the advantages of kimma’s model fit assessment in RNA-seq analyses as other workflows may have readily accepted more false positive DEGs even if the model was not best fit for the data. Poor model fit can lead to nonreproducible results and wasted resources on downstream experiments pursuing what were originally false positives.</p>
    <p>Kimma’s flexible model design can be extended for targeted eQTL analysis. Using a simple model of genotype:Mtb infection corrected for kinship, we identified 289 eQTL among Mtb DEG in related individuals. The purpose of this analysis was not to identify novel Mtb eQTL as a full genetic analysis likely requires further covariate assessment such as population principal components, sex, etc. Instead, this showcases kimma’s ability to model more than just RNA-seq differential expression. Given kimma’s computational time, tools such as GENESIS (<xref rid="btad279-B9" ref-type="bibr">Gogarten et al. 2019</xref>) or GMMAT (<xref rid="btad279-B4" ref-type="bibr">Chen et al. 2019</xref>) are preferred for genome-wide eQTL analyses. However, kimma provides robust targeted analysis with the same underlying model as differential gene expression as well as yields fit metrics useful in determining covariate usage on a subset of genes prior to genome-wide GENESIS or GMMAT analyses.</p>
    <p>While kimma represents an advance in parametric DEG detection, this remains only one facet of transcriptomic data cleaning and analysis. Though outside the scope of this study, it is also worth noting recent work in nonparametric DEG analysis (<xref rid="btad279-B8" ref-type="bibr">Gauthier et al. 2020</xref>) as well as advances in transcript-level alignment (<xref rid="btad279-B18" ref-type="bibr">Pimentel et al. 2017</xref>) which may complement kimma analysis in the future. In addition due to the limited availability of open-source RNA-seq data from paired designs with accompanying covariance matrix random effects like kinship, kimma was applied to only one real-world dataset in these analyses. While simulated datasets provided measurable sensitivity and specificity, other real-world data should be explored to better elucidate the impacts of genetic kinship or other covariances on DEG detection. We expect the use of kinship with transcriptomic data to increase, in particular, as methods to extract genotype information directly from RNA-seq data become more routinely used, thereby not requiring additional biological material or monetary cost (<xref rid="btad279-B2" ref-type="bibr">Blay et al. 2019</xref>). In addition, while kimma was applied to RNA-seq data in these examples, the package itself is not RNA-seq specific. Any dataset with multiple measures can be coerced into a similar format and modeled using the appropriate parameters. The user need only ensure that the data meet the requirements of the linear model being applied.</p>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>Overall, kimma provides a user-friendly, single function workflow for linear model analysis of RNA-seq data. It further provides model fit and downstream analyses relevant to DEGs identified by these linear models. Users can explore kimma and its sister packages for results visualization and downstream gene set analyses in the BIGverse through open-source vignettes available at <ext-link xlink:href="http://rId58" ext-link-type="uri">https://bigslu.github.io/kimma_vignette/</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad279_Supplementary_Data</label>
      <media xlink:href="btad279_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>We thank the individual study subjects and their families. We also thank LaShaunda Malone, Keith Chervenak, and Marla Manning for database and program management of the Uganda study as well as the clinical and research staff including Dr Alphonse Okwera, Dr Moses Joloba, Hussein Kisingo, Sophie Nalukwago, Dorcas Lamunu, Deborah Nsamba, Annet Kawuma, Saidah Menya, Joan Nassuna, Joy Beseke, Michael Odie, Henry Kawoya, Shannon Pavsek, and Bonnie Thiel.</p>
  </ack>
  <sec>
    <title>Ethics approval and consent to participate</title>
    <p>The study protocol was reviewed and approved by the National AIDS Research Committee, The Uganda National Council on Science and Technology, and the institutional review board at University Hospitals Cleveland Medical Center. Written informed consent was obtained from all participants.</p>
  </sec>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> is available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Bill and Melinda Gates Foundation [grant number OPP1151836] and the National Institutes of Health [grant numbers R01AI124348, U01AI115642, U19AI162583 to H.M.K., W.H.B., C.M.S., and T.R.H.]. In addition, support came from the American Academy of Allergy, Asthma, and Immunology Foundation Faculty Development Award to M.C.A. The funders had no role in the experimental design or analysis.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>Access to raw transcriptomic data is available through the NCBI database of Genotypes and Phenotypes (dbGaP) accession phs002445.v1.p1 (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/projects/gapprev/gap/cgi-bin/preview1.cgi?GAP_phs_code=C0TPIcCeWtsG6oqY" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/projects/gapprev/gap/cgi-bin/preview1.cgi?GAP_phs_code=C0TPIcCeWtsG6oqY</ext-link>). Access must be approved by the study’s data access committee (see <xref rid="btad279-B25" ref-type="bibr">Simmons et al. 2022</xref>). All scripts and code for this manuscript are available at: <ext-link xlink:href="https://github.com/BIGslu/kimma_MS_public" ext-link-type="uri">https://github.com/BIGslu/kimma_MS_public</ext-link>. The kimma software is available at: <ext-link xlink:href="https://github.com/BIGslu/kimma" ext-link-type="uri">https://github.com/BIGslu/kimma</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad279-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bates</surname><given-names>D</given-names></string-name>, <string-name><surname>Mächler</surname><given-names>M</given-names></string-name>, <string-name><surname>Bolker</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>Fitting linear Mixed-Effects models using lme4</article-title>. <source>J Stat Softw</source><year>2015</year>;<volume>67</volume>:<fpage>1</fpage>–<lpage>48</lpage>.</mixed-citation>
    </ref>
    <ref id="btad279-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blay</surname><given-names>N</given-names></string-name>, <string-name><surname>Casas</surname><given-names>E</given-names></string-name>, <string-name><surname>Galván-Femenía</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>Assessment of kinship detection using RNA-seq data</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>e136</fpage>.<pub-id pub-id-type="pmid">31501877</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>J</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>W</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>W-X</given-names></string-name></person-group><etal>et al</etal><article-title>Comparing large covariance matrices under weak conditions on the dependence structure and its application to gene clustering</article-title>. <source>Biometrics</source><year>2017</year>;<volume>73</volume>:<fpage>31</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">27377648</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>H</given-names></string-name>, <string-name><surname>Huffman</surname><given-names>JE</given-names></string-name>, <string-name><surname>Brody</surname><given-names>JA</given-names></string-name></person-group><etal>et al</etal>; <collab>TOPMed Hematology and Hemostasis Working Group</collab>. <article-title>Efficient variant set mixed model association tests for continuous and binary traits in large-scale whole-genome sequencing studies</article-title>. <source>Am J Hum Genet</source><year>2019</year>;<volume>104</volume>:<fpage>260</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">30639324</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Collins</surname><given-names>FS</given-names></string-name>, <string-name><surname>Morgan</surname><given-names>M</given-names></string-name>, <string-name><surname>Patrinos</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>The human genome project: lessons from large-scale biology</article-title>. <source>Science</source><year>2003</year>;<volume>300</volume>:<fpage>286</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">12690187</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Conesa</surname><given-names>A</given-names></string-name>, <string-name><surname>Madrigal</surname><given-names>P</given-names></string-name>, <string-name><surname>Tarazona</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>A survey of best practices for RNA-seq data analysis</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>13</fpage>.<pub-id pub-id-type="pmid">26813401</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dobin</surname><given-names>A</given-names></string-name>, <string-name><surname>Davis</surname><given-names>CA</given-names></string-name>, <string-name><surname>Schlesinger</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>STAR: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source><year>2013</year>;<volume>29</volume>:<fpage>15</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">23104886</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gauthier</surname><given-names>M</given-names></string-name>, <string-name><surname>Agniel</surname><given-names>D</given-names></string-name>, <string-name><surname>Thiébaut</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Dearseq: a variance component score test for RNA-seq differential analysis that effectively controls the false discovery rate</article-title>. <source>NAR Genom Bioinform</source><year>2020</year>;<volume>2</volume>:<fpage>lqaa093</fpage>.<pub-id pub-id-type="pmid">33575637</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gogarten</surname><given-names>SM</given-names></string-name>, <string-name><surname>Sofer</surname><given-names>T</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>Genetic association testing using the GENESIS R/bioconductor package</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>5346</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">31329242</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoffman</surname><given-names>GE</given-names></string-name>, <string-name><surname>Roussos</surname><given-names>P.</given-names></string-name></person-group><article-title>Dream: powerful differential expression analysis for repeated measures designs</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>192</fpage>–<lpage>201</lpage>.<pub-id pub-id-type="pmid">32730587</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kochan</surname><given-names>N</given-names></string-name>, <string-name><surname>Yazgı Tütüncü</surname><given-names>G</given-names></string-name>, <string-name><surname>Giner</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>A new local covariance matrix estimation for the classification of gene expression profiles in high dimensional RNA-Seq data</article-title>. <source>Expert Syst Appl</source><year>2021</year>;<volume>167</volume>:<fpage>114200</fpage>.</mixed-citation>
    </ref>
    <ref id="btad279-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korthauer</surname><given-names>K</given-names></string-name>, <string-name><surname>Kimes</surname><given-names>PK</given-names></string-name>, <string-name><surname>Duvallet</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>A practical guide to methods controlling false discoveries in computational biology</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>118</fpage>.<pub-id pub-id-type="pmid">31164141</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Law</surname><given-names>CW</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y</given-names></string-name>, <string-name><surname>Shi</surname><given-names>W</given-names></string-name></person-group><etal>et al</etal><article-title>Voom: precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>. <source>Genome Biol</source><year>2014</year>;<volume>15</volume>:<fpage>R29</fpage>.<pub-id pub-id-type="pmid">24485249</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B14">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lenth</surname><given-names>R.</given-names></string-name></person-group> emmeans: estimated marginal means, aka least-squares means. R package version 1.8.4. <year>2022</year>.</mixed-citation>
    </ref>
    <ref id="btad279-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Love</surname><given-names>MI</given-names></string-name>, <string-name><surname>Huber</surname><given-names>W</given-names></string-name>, <string-name><surname>Anders</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source><year>2014</year>;<volume>15</volume>:<fpage>550</fpage>.<pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Manichaikul</surname><given-names>A</given-names></string-name>, <string-name><surname>Mychaleckyj</surname><given-names>JC</given-names></string-name>, <string-name><surname>Rich</surname><given-names>SS</given-names></string-name></person-group><etal>et al</etal><article-title>Robust relationship inference in genome-wide association studies</article-title>. <source>Bioinformatics</source><year>2010</year>;<volume>26</volume>:<fpage>2867</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="pmid">20926424</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McHenry</surname><given-names>ML</given-names></string-name>, <string-name><surname>Benchek</surname><given-names>P</given-names></string-name>, <string-name><surname>Malone</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Resistance to TST/IGRA conversion in Uganda: heritability and Genome-Wide association study</article-title>. <source>EBioMedicine</source><year>2021</year>;<volume>74</volume>:<fpage>103727</fpage>.<pub-id pub-id-type="pmid">34871961</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pimentel</surname><given-names>H</given-names></string-name>, <string-name><surname>Bray</surname><given-names>NL</given-names></string-name>, <string-name><surname>Puente</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Differential analysis of RNA-seq incorporating quantification uncertainty</article-title>. <source>Nat Methods</source><year>2017</year>;<volume>14</volume>:<fpage>687</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">28581496</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Price</surname><given-names>AL</given-names></string-name>, <string-name><surname>Helgason</surname><given-names>A</given-names></string-name>, <string-name><surname>Thorleifsson</surname><given-names>G</given-names></string-name></person-group><etal>et al</etal><article-title>Single-tissue and cross-tissue heritability of gene expression via identity-by-descent in related or unrelated individuals</article-title>. <source>PLoS Genet</source><year>2011</year>;<volume>7</volume>:<fpage>e1001317</fpage>.<pub-id pub-id-type="pmid">21383966</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qayed</surname><given-names>A</given-names></string-name>, <string-name><surname>Han</surname><given-names>D.</given-names></string-name></person-group><article-title>High-dimensional covariance matrices tests for analyzing multi-tumor gene expression data</article-title>. <source>Stat Methods Med Res</source><year>2021</year>;<volume>30</volume>:<fpage>1904</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">34232835</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B21">
      <mixed-citation publication-type="other"><collab>R Core Team</collab>. <italic toggle="yes">R: A language and environment for statistical computing</italic>. Vienna, Austria: R Foundation for Statistical Computing, <year>2022</year>.</mixed-citation>
    </ref>
    <ref id="btad279-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ritchie</surname><given-names>ME</given-names></string-name>, <string-name><surname>Phipson</surname><given-names>B</given-names></string-name>, <string-name><surname>Wu</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Res</source><year>2015</year>;<volume>43</volume>:<fpage>e47</fpage>.<pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>MD</given-names></string-name>, <string-name><surname>McCarthy</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>GK</given-names></string-name></person-group><etal>et al</etal><article-title>edgeR: a bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source><year>2010</year>;<volume>26</volume>:<fpage>139</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Simmons</surname><given-names>JD</given-names></string-name>, <string-name><surname>Stein</surname><given-names>CM</given-names></string-name>, <string-name><surname>Seshadri</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Immunological mechanisms of human resistance to persistent <italic toggle="yes">Mycobacterium tuberculosis</italic> infection</article-title>. <source>Nat Rev Immunol</source><year>2018</year>;<volume>18</volume>:<fpage>575</fpage>–<lpage>89</lpage>.<pub-id pub-id-type="pmid">29895826</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Simmons</surname><given-names>JD</given-names></string-name>, <string-name><surname>Dill-McFarland</surname><given-names>KA</given-names></string-name>, <string-name><surname>Stein</surname><given-names>CM</given-names></string-name></person-group><etal>et al</etal><article-title>Monocyte transcriptional responses to <italic toggle="yes">Mycobacterium tuberculosis</italic> associate with resistance to tuberculin skin test and interferon gamma release assay conversion</article-title>. <source>mSphere</source><year>2022</year>;<volume>7</volume>:<fpage>e00159</fpage>-<lpage>22</lpage>.<pub-id pub-id-type="pmid">35695527</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stein</surname><given-names>CM</given-names></string-name>, <string-name><surname>Nsereko</surname><given-names>M</given-names></string-name>, <string-name><surname>Malone</surname><given-names>LL</given-names></string-name></person-group><etal>et al</etal><article-title>Long-term stability of resistance to latent <italic toggle="yes">Mycobacterium tuberculosis</italic> infection in highly exposed tuberculosis household contacts in Kampala, Uganda</article-title>. <source>Clin Infect Dis</source><year>2019</year>;<volume>68</volume>:<fpage>1705</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">30165605</pub-id></mixed-citation>
    </ref>
    <ref id="btad279-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ziyatdinov</surname><given-names>A</given-names></string-name>, <string-name><surname>Vázquez-Santiago</surname><given-names>M</given-names></string-name>, <string-name><surname>Brunel</surname><given-names>H</given-names></string-name></person-group><etal>et al</etal><article-title>lme4qtl: linear mixed models with flexible covariance structure for genetic studies of related individuals</article-title>. <source>BMC Bioinformatics</source><year>2018</year>;<volume>19</volume>:<fpage>68</fpage>.<pub-id pub-id-type="pmid">29486711</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
