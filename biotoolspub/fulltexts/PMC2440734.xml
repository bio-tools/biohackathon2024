<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Biol Direct</journal-id>
    <journal-title>Biology Direct</journal-title>
    <issn pub-type="epub">1745-6150</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2440734</article-id>
    <article-id pub-id-type="publisher-id">1745-6150-3-20</article-id>
    <article-id pub-id-type="pmid">18495041</article-id>
    <article-id pub-id-type="doi">10.1186/1745-6150-3-20</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Splign: algorithms for computing spliced alignments with identification of paralogs</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Kapustin</surname>
          <given-names>Yuri</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>kapustin@ncbi.nlm.nih.gov</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Souvorov</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>souvorov@ncbi.nlm.nih.gov</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Tatusova</surname>
          <given-names>Tatiana</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>tatiana@ncbi.nlm.nih.gov</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Lipman</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>lipman@ncbi.nlm.nih.gov</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>National Center for Biotechnology Information, National Library of Medicine, National Institutes of Health, Bethesda, MD 20814, USA</aff>
    <pub-date pub-type="collection">
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>5</month>
      <year>2008</year>
    </pub-date>
    <volume>3</volume>
    <fpage>20</fpage>
    <lpage>20</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biology-direct.com/content/3/1/20"/>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>5</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>5</month>
        <year>2008</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2008 Kapustin et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2008</copyright-year>
      <copyright-holder>Kapustin et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Kapustin
               Yuri
               
               kapustin@ncbi.nlm.nih.gov
            </dc:author><dc:title>
            Splign: algorithms for computing spliced alignments with identification of paralogs
         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>Biology Direct 3(1): 20-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1745-6150(2008)3:1&#x0003c;20&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1745-6150</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The computation of accurate alignments of cDNA sequences against a genome is at the foundation of modern genome annotation pipelines. Several factors such as presence of paralogs, small exons, non-consensus splice signals, sequencing errors and polymorphic sites pose recognized difficulties to existing spliced alignment algorithms.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We describe a set of algorithms behind a tool called Splign for computing cDNA-to-Genome alignments. The algorithms include a high-performance preliminary alignment, a compartment identification based on a formally defined model of adjacent duplicated regions, and a refined sequence alignment. In a series of tests, Splign has produced more accurate results than other tools commonly used to compute spliced alignments, in a reasonable amount of time.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>Splign's ability to deal with various issues complicating the spliced alignment problem makes it a helpful tool in eukaryotic genome annotation processes and alternative splicing studies. Its performance is enough to align the largest currently available pools of cDNA data such as the human EST set on a moderate-sized computing cluster in a matter of hours. The duplications identification (compartmentization) algorithm can be used independently in other areas such as the study of pseudogenes.</p>
      </sec>
      <sec>
        <title>Reviewers</title>
        <p>This article was reviewed by: Steven Salzberg, Arcady Mushegian and Andrey Mironov (nominated by Mikhail Gelfand).</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Spliced gene products available in the form of cDNA sequences provide an experimental level of support for gene models. It has been shown [<xref ref-type="bibr" rid="B1">1</xref>] that the availability of large numbers of such sequences greatly improves the quality of identification of gene structures, especially in UTR regions which are beyond the application scope of most <italic>ab initio </italic>gene-prediction methods. Accuracy of spliced alignments is crucial in such areas as studies of alternative splicing and regulatory elements.</p>
    <p>Over the last decade, significant attention has been given to development of tools to assist the spliced alignment problem. A useful overview of such tools has been given in [<xref ref-type="bibr" rid="B2">2</xref>]. Despite considerable progress in more recent tools, various types of alignment errors are still observed. Such errors include missing micro-exons, forced consensus splice signals and alignments stretching over several members of tandem gene clusters. Another critical issue is the performance of the algorithms.</p>
    <p>We developed a tool called Splign for accurate and fast alignment of spliced cDNA sequences against their genomic counterparts. The process (Figure <xref ref-type="fig" rid="F1">1</xref>) starts with computing local alignments between the input cDNA set and the genome. The local alignments are used to identify candidate locations on the genome for every cDNA. Every location is then refined using an optimal alignment algorithm specifically accounting for possible splice sites.</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p>The computation of spliced alignments with Splign.</p>
      </caption>
      <graphic xlink:href="1745-6150-3-20-1"/>
    </fig>
    <p>This general scheme has been exemplified in virtually every spliced alignment method capable of aligning a cDNA against a whole genomic assembly. Our approach is different in that it uses a formally defined model of same-strand duplications, which are found as a solution of an optimization problem. Splign is very conservative in its use of local alignments to seed the core splice refinement algorithm, which tends not to bind the final alignment with preliminary alignments delivering non-unique mappings. This also makes the algorithm more capable of finding small exons which are often missed by other methods. Finally, we explicitly list several important alignment alternatives and assign the elementary scores of the optimal alignment algorithm via a system of inequalities assuring preferable alignment outcomes.</p>
  </sec>
  <sec>
    <title>Results and Discussion</title>
    <p>To assess the quality of alignments reported by Splign, we compared it with five other spliced alignment programs: Sim4 [<xref ref-type="bibr" rid="B3">3</xref>], Spidey [<xref ref-type="bibr" rid="B4">4</xref>], BLAT [<xref ref-type="bibr" rid="B5">5</xref>], GMAP [<xref ref-type="bibr" rid="B2">2</xref>], and SPA [<xref ref-type="bibr" rid="B6">6</xref>] (Table <xref ref-type="table" rid="T1">1</xref>). We used each of the programs to produce alignments of 218 641 human mRNA sequences with the reference human genome (build 36.3). The alignments were then compared using different quality measures. In a separate test, we also aligned 1 683 827 EST sequences that were expected to have same splicing forms as selected RefSeq [<xref ref-type="bibr" rid="B7">7</xref>] mRNA sequences. The EST alignments were then compared to the alignments of the corresponding RefSeq mRNA sequences.</p>
    <table-wrap position="float" id="T1">
      <label>Table 1</label>
      <caption>
        <p>Programs used in the comparison</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td/>
            <td align="center">Sim4</td>
            <td align="center">Spidey</td>
            <td align="center">BLAT</td>
            <td align="center">GMAP</td>
            <td align="center">SPA</td>
            <td align="center">Splign</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">version</td>
            <td align="center">-</td>
            <td align="center">1.40</td>
            <td align="center">34</td>
            <td align="center">2007-06-04</td>
            <td align="center">-</td>
            <td align="center">1.29</td>
          </tr>
          <tr>
            <td align="left">source time stamp</td>
            <td align="center">09/2003</td>
            <td align="center">06/2006</td>
            <td align="center">04/2007</td>
            <td align="center">06/2007</td>
            <td align="center">07/2007</td>
            <td align="center">08/2007</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <sec>
      <title>Identity-based comparison</title>
      <p>Full-length mRNA sequences are high-quality transcripts each representing a splicing variant of a gene. To assess the quality of alignment of a cDNA against a genomic locus, we introduced the following measures. <italic>Overall identity </italic>is the number of matching residues, divided by length of the alignment excluding possible introns. For the purpose of this definition, cDNA bases that failed to align (except those of the poly(A) tail, if any) are counted as deletions. For example, if 62 out of the total of 100 bases of a cDNA aligned perfectly and the other 38 bases did not align, the overall identity is 62%.</p>
      <p>If information about the coding region is available, it is possible to introduce a measure accounting for frame shifts. Frame shifts in a coding region's alignment are caused by gaps whose length is not a multiple of three, and usually indicate either an error in a cDNA or genomic sequence, or incorrect alignment. <italic>In-frame identity </italic>is the number of matching nucleotide residues aligned without a frame shift, divided by the length of the coding region's alignment excluding possible introns.</p>
      <p>The presence of same-strand duplications often poses a problem for spliced alignment algorithms. With the possibility of a sequencing error or a polymorphic site on the genome, the alignment with the highest identity can stretch across multiple duplicated regions. Compactness of an alignment can be quantified with its <italic>span ratio</italic>, which is the span of the alignment on the genome divided by the length of the cDNA sequence.</p>
      <p>Throughout our tests, the genome was represented as a collection of chromosomes and unplaced scaffolds. Four of the programs (BLAT, GMAP, SPA and Splign) are able to align a cDNA against the whole genome. Sim4 and Spidey require externally specified genomic sequence. We found that running these two programs on full-length human chromosomes will often cause them to crash. Assuming that in practice users would most likely run these two programs against genomic scaffolds, for every cDNA we supplied Sim4 and Spidey with scaffolds where Splign reported at least partial alignment.</p>
      <p>Our set of mRNA sequences consisted of 218 641 human mRNA sequences available at GenBank at the time of the testing, with 24 273 of them being RefSeq mRNA sequences.</p>
      <p>After having computed the alignments, we found that it was not uncommon for the programs to report 3' exons consisting mostly or entirely of 'A' residues, often connected to the rest of the gene by a non-consensus intron (we call an intron consensus if it has one of the following donor/acceptor pairs: GT/AG, GC/AG, AT/AC). We suspect that in many cases such alignment segments are in fact poly(A) tails that should not have been aligned. Table <xref ref-type="table" rid="T2">2</xref> lists the numbers of mRNA sequences with alignments featuring A-content of 75% or higher in their 3' segments. The data shows that the approaches for recognizing and trimming possible poly(A) tails lead to varying results among the programs under comparison. When computing the alignment statistics the maximum tail of consecutive 'A' residues was checked to allow one or two non-'A' residues. If such a tail was found, the alignment was trimmed to the start of the first all-'A' substring of length five or longer. Any alignment beyond that point was then ignored.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>The number of best alignments with A-content of 75% or higher in the 3' exon. The numbers are based on the alignments with the highest overall identity.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">Sim4</td>
              <td align="center">Spidey</td>
              <td align="center">BLAT</td>
              <td align="center">GMAP</td>
              <td align="center">SPA</td>
              <td align="center">Splign</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">%% of all mRNAs</td>
              <td align="center">15.5</td>
              <td align="center">0.57</td>
              <td align="center">0.98</td>
              <td align="center">0.04</td>
              <td align="center">2.12</td>
              <td align="center">0.01</td>
            </tr>
            <tr>
              <td align="left">%% of RefSeq mRNAs</td>
              <td align="center">22.1</td>
              <td align="center">0.31</td>
              <td align="center">1.67</td>
              <td align="center">0.02</td>
              <td align="center">2.72</td>
              <td align="center">0.00</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Tables <xref ref-type="table" rid="T3">3</xref> and <xref ref-type="table" rid="T4">4</xref> compares the number of sequences aligned at various levels of the overall identity by Splign versus the other tools. The data shows that at the higher identity levels Splign was able to align more sequences than any other tool. Table <xref ref-type="table" rid="T5">5</xref> lists the total time it took for every program to compute the alignments for the full set of mRNA sequences.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>The number of the full set alignments at various levels of the overall identity. Fractions give the differences in the number of alignments by each method and Splign expressed as percentage of the total of sequences in the set.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">80%</td>
              <td align="center">85%</td>
              <td align="center">90%</td>
              <td align="center">95%</td>
              <td align="center">99%</td>
              <td align="center">99.5%</td>
              <td align="center">99.9%</td>
              <td align="center">100%</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Splign</td>
              <td align="center">212875</td>
              <td align="center">209895</td>
              <td align="center">203460</td>
              <td align="center">195939</td>
              <td align="center">182123</td>
              <td align="center">169058</td>
              <td align="center">107267</td>
              <td align="center">76542</td>
            </tr>
            <tr>
              <td align="left">Sim4</td>
              <td align="center">
                <underline>212533</underline>
              </td>
              <td align="center">
                <underline>208571</underline>
              </td>
              <td align="center">
                <underline>203016</underline>
              </td>
              <td align="center">195513</td>
              <td align="center">177784</td>
              <td align="center">162761</td>
              <td align="center">97812</td>
              <td align="center">69359</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.16</td>
              <td align="center">-0.61</td>
              <td align="center">-0.20</td>
              <td align="center">-0.19</td>
              <td align="center">-1.98</td>
              <td align="center">-2.88</td>
              <td align="center">-4.32</td>
              <td align="center">-3.29</td>
            </tr>
            <tr>
              <td align="left">Spidey</td>
              <td align="center">199870</td>
              <td align="center">195159</td>
              <td align="center">190753</td>
              <td align="center">186356</td>
              <td align="center">172385</td>
              <td align="center">159021</td>
              <td align="center">100338</td>
              <td align="center">72225</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-5.95</td>
              <td align="center">-6.74</td>
              <td align="center">-5.81</td>
              <td align="center">-4.38</td>
              <td align="center">-4.45</td>
              <td align="center">-4.59</td>
              <td align="center">-3.17</td>
              <td align="center">-1.97</td>
            </tr>
            <tr>
              <td align="left">BLAT</td>
              <td align="center">209899</td>
              <td align="center">206260</td>
              <td align="center">201207</td>
              <td align="center">194640</td>
              <td align="center">177345</td>
              <td align="center">163157</td>
              <td align="center">104338</td>
              <td align="center">74815</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-1.36</td>
              <td align="center">-1.66</td>
              <td align="center">-1.03</td>
              <td align="center">-0.59</td>
              <td align="center">-2.19</td>
              <td align="center">-2.70</td>
              <td align="center">-1.34</td>
              <td align="center">-0.79</td>
            </tr>
            <tr>
              <td align="left">GMAP</td>
              <td align="center">208849</td>
              <td align="center">205793</td>
              <td align="center">202732</td>
              <td align="center">
                <underline>196734</underline>
              </td>
              <td align="center">180048</td>
              <td align="center">166488</td>
              <td align="center">105452</td>
              <td align="center">
                <underline>74975</underline>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">-1.84</td>
              <td align="center">-1.88</td>
              <td align="center">-0.33</td>
              <td align="center">+0.36</td>
              <td align="center">-0.95</td>
              <td align="center">-1.18</td>
              <td align="center">-0.83</td>
              <td align="center">-0.72</td>
            </tr>
            <tr>
              <td align="left">SPA</td>
              <td align="center">203942</td>
              <td align="center">199548</td>
              <td align="center">195926</td>
              <td align="center">192595</td>
              <td align="center">
                <underline>180273</underline>
              </td>
              <td align="center">
                <underline>167815</underline>
              </td>
              <td align="center">
                <underline>105835</underline>
              </td>
              <td align="center">74911</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-4.09</td>
              <td align="center">-4.73</td>
              <td align="center">-3.45</td>
              <td align="center">-1.53</td>
              <td align="center">-0.85</td>
              <td align="center">-0.57</td>
              <td align="center">-0.65</td>
              <td align="center">-0.75</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="T4">
        <label>Table 4</label>
        <caption>
          <p>The number of RefSeq alignments at various levels of the overall identity. Fractions give the differences in the number of alignments by each method and Splign expressed as percentage of the total of sequences in the set.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">80%</td>
              <td align="center">85%</td>
              <td align="center">90%</td>
              <td align="center">95%</td>
              <td align="center">99%</td>
              <td align="center">99.5%</td>
              <td align="center">99.9%</td>
              <td align="center">100%</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Splign</td>
              <td align="center">24255</td>
              <td align="center">24254</td>
              <td align="center">24243</td>
              <td align="center">24218</td>
              <td align="center">23947</td>
              <td align="center">23420</td>
              <td align="center">19337</td>
              <td align="center">14898</td>
            </tr>
            <tr>
              <td align="left">Sim4</td>
              <td align="center">24242</td>
              <td align="center">24233</td>
              <td align="center">24201</td>
              <td align="center">24109</td>
              <td align="center">23566</td>
              <td align="center">22815</td>
              <td align="center">17774</td>
              <td align="center">12894</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.05</td>
              <td align="center">-0.09</td>
              <td align="center">-0.17</td>
              <td align="center">-0.45</td>
              <td align="center">-1.57</td>
              <td align="center">-2.49</td>
              <td align="center">-6.44</td>
              <td align="center">-8.26</td>
            </tr>
            <tr>
              <td align="left">Spidey</td>
              <td align="center">23648</td>
              <td align="center">23491</td>
              <td align="center">23270</td>
              <td align="center">22972</td>
              <td align="center">22408</td>
              <td align="center">21789</td>
              <td align="center">17782</td>
              <td align="center">13488</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-2.50</td>
              <td align="center">-3.14</td>
              <td align="center">-4.01</td>
              <td align="center">-5.13</td>
              <td align="center">-6.34</td>
              <td align="center">-6.72</td>
              <td align="center">-6.41</td>
              <td align="center">-5.81</td>
            </tr>
            <tr>
              <td align="left">BLAT</td>
              <td align="center">24240</td>
              <td align="center">24230</td>
              <td align="center">24201</td>
              <td align="center">24145</td>
              <td align="center">23701</td>
              <td align="center">23046</td>
              <td align="center">19043</td>
              <td align="center">14676</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.06</td>
              <td align="center">-0.10</td>
              <td align="center">-0.17</td>
              <td align="center">-0.30</td>
              <td align="center">-1.01</td>
              <td align="center">-1.54</td>
              <td align="center">-1.21</td>
              <td align="center">-0.91</td>
            </tr>
            <tr>
              <td align="left">GMAP</td>
              <td align="center">
                <underline>24249</underline>
              </td>
              <td align="center">
                <underline>24242</underline>
              </td>
              <td align="center">
                <underline>24225</underline>
              </td>
              <td align="center">
                <underline>24198</underline>
              </td>
              <td align="center">
                <underline>23876</underline>
              </td>
              <td align="center">23294</td>
              <td align="center">
                <underline>19217</underline>
              </td>
              <td align="center">14513</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.02</td>
              <td align="center">-0.05</td>
              <td align="center">-0.07</td>
              <td align="center">-0.08</td>
              <td align="center">-0.29</td>
              <td align="center">-0.52</td>
              <td align="center">-0.49</td>
              <td align="center">-1.59</td>
            </tr>
            <tr>
              <td align="left">SPA</td>
              <td align="center">24213</td>
              <td align="center">24202</td>
              <td align="center">24180</td>
              <td align="center">24148</td>
              <td align="center">23830</td>
              <td align="center">
                <underline>23303</underline>
              </td>
              <td align="center">19204</td>
              <td align="center">
                <underline>14698</underline>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.17</td>
              <td align="center">-0.21</td>
              <td align="center">-0.26</td>
              <td align="center">-0.29</td>
              <td align="center">-0.48</td>
              <td align="center">-0.48</td>
              <td align="center">-0.55</td>
              <td align="center">-0.82</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="T5">
        <label>Table 5</label>
        <caption>
          <p>Time to compute alignments for the full set of human mRNA sequences. The timing is based on a single instance running on Intel Xeon 2.33 GHz/8 GB Linux box.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">Sim4</td>
              <td align="center">Spidey</td>
              <td align="center">BLAT</td>
              <td align="center">GMAP</td>
              <td align="center">SPA</td>
              <td align="center">Splign</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">CPU hours</td>
              <td align="center">856</td>
              <td align="center">698</td>
              <td align="center">8</td>
              <td align="center">12</td>
              <td align="center">2448</td>
              <td align="center">49</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Although the full set of mRNA sequences is the most representative, one may argue that the comparison based on it could be biased. A fraction of mRNA sequences are deposited to GenBank as complemented strand. Splign can report both sense and anti-sense alignments for a single mRNA which may give it an advantage over the tools that report alignments in one direction, because an incorrectly directed alignment can have an identity higher than the one in the correct direction. For queries aligning to more than one place on the genome, strategies vary among the tools, with some reporting all alignments above certain quality threshold and others attempting to rank the alignments and report a fixed number of the top-ranking alignments. To minimize these differences, we restricted the full set of mRNAs using the following conditions:</p>
      <p>• single alignment with 80% or higher overall identity</p>
      <p>• sense maximal ORF is 900 bases or longer</p>
      <p>• anti-sense maximal ORF is at least two times smaller</p>
      <p>The conditions produced a subset consisting of 72 113 mRNA sequences and 13 883 RefSeq mRNA sequences ("Subset 1").</p>
      <p>Tables <xref ref-type="table" rid="T6">6</xref> and <xref ref-type="table" rid="T7">7</xref> present the comparison data based on the Subset 1 alignments. The data shows that at every identity level Splign was able to align more sequences than any other tool, most closely followed by SPA and GMAP.</p>
      <table-wrap position="float" id="T6">
        <label>Table 6</label>
        <caption>
          <p>The number of the Subset 1 alignments at various levels of the overall identity. Fractions give the differences in the number of alignments by each method and Splign expressed as percentage of the total of sequences in the set.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">85%</td>
              <td align="center">90%</td>
              <td align="center">95%</td>
              <td align="center">99%</td>
              <td align="center">99.5%</td>
              <td align="center">99.9%</td>
              <td align="center">100%</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Splign</td>
              <td align="center">72047</td>
              <td align="center">71922</td>
              <td align="center">71568</td>
              <td align="center">68890</td>
              <td align="center">65666</td>
              <td align="center">43046</td>
              <td align="center">25931</td>
            </tr>
            <tr>
              <td align="left">Sim4</td>
              <td align="center">
                <underline>72013</underline>
              </td>
              <td align="center">71830</td>
              <td align="center">71316</td>
              <td align="center">68055</td>
              <td align="center">63919</td>
              <td align="center">39272</td>
              <td align="center">23249</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.05</td>
              <td align="center">-0.13</td>
              <td align="center">-0.35</td>
              <td align="center">-1.16</td>
              <td align="center">-2.42</td>
              <td align="center">-5.23</td>
              <td align="center">-3.72</td>
            </tr>
            <tr>
              <td align="left">Spidey</td>
              <td align="center">71562</td>
              <td align="center">70833</td>
              <td align="center">69744</td>
              <td align="center">66128</td>
              <td align="center">62461</td>
              <td align="center">40456</td>
              <td align="center">24578</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.67</td>
              <td align="center">-1.51</td>
              <td align="center">-2.53</td>
              <td align="center">-3.83</td>
              <td align="center">-4.44</td>
              <td align="center">-3.59</td>
              <td align="center">-1.88</td>
            </tr>
            <tr>
              <td align="left">BLAT</td>
              <td align="center">72010</td>
              <td align="center">71842</td>
              <td align="center">71393</td>
              <td align="center">67508</td>
              <td align="center">63319</td>
              <td align="center">41693</td>
              <td align="center">25357</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.05</td>
              <td align="center">-0.11</td>
              <td align="center">-0.24</td>
              <td align="center">-1.92</td>
              <td align="center">-3.25</td>
              <td align="center">-1.88</td>
              <td align="center">-0.80</td>
            </tr>
            <tr>
              <td align="left">GMAP</td>
              <td align="center">72001</td>
              <td align="center">
                <underline>71843</underline>
              </td>
              <td align="center">
                <underline>71459</underline>
              </td>
              <td align="center">68446</td>
              <td align="center">64787</td>
              <td align="center">42263</td>
              <td align="center">25335</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.06</td>
              <td align="center">-0.11</td>
              <td align="center">-0.15</td>
              <td align="center">-0.62</td>
              <td align="center">-1.22</td>
              <td align="center">-1.09</td>
              <td align="center">-0.83</td>
            </tr>
            <tr>
              <td align="left">SPA</td>
              <td align="center">71993</td>
              <td align="center">71823</td>
              <td align="center">71406</td>
              <td align="center">
                <underline>68578</underline>
              </td>
              <td align="center">
                <underline>65368</underline>
              </td>
              <td align="center">
                <underline>43043</underline>
              </td>
              <td align="center">
                <underline>25736</underline>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.07</td>
              <td align="center">-0.14</td>
              <td align="center">-0.22</td>
              <td align="center">-0.43</td>
              <td align="center">-0.41</td>
              <td align="center">0.00</td>
              <td align="center">-0.27</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="T7">
        <label>Table 7</label>
        <caption>
          <p>The number of the Subset 1 RefSeq alignments at various levels of the overall identity. Fractions give the differences in the number of alignments by each method and Splign expressed as percentage of the total of sequences in the set.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">85%</td>
              <td align="center">90%</td>
              <td align="center">95%</td>
              <td align="center">99%</td>
              <td align="center">99.5%</td>
              <td align="center">99.9%</td>
              <td align="center">100%</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Splign</td>
              <td align="center">13883</td>
              <td align="center">13880</td>
              <td align="center">13870</td>
              <td align="center">13781</td>
              <td align="center">13540</td>
              <td align="center">11345</td>
              <td align="center">8276</td>
            </tr>
            <tr>
              <td align="left">Sim4</td>
              <td align="center">13880</td>
              <td align="center">13873</td>
              <td align="center">13832</td>
              <td align="center">13615</td>
              <td align="center">13287</td>
              <td align="center">10521</td>
              <td align="center">7151</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.02</td>
              <td align="center">-0.05</td>
              <td align="center">-0.27</td>
              <td align="center">-1.20</td>
              <td align="center">-1.82</td>
              <td align="center">-5.94</td>
              <td align="center">-8.10</td>
            </tr>
            <tr>
              <td align="left">Spidey</td>
              <td align="center">13765</td>
              <td align="center">13602</td>
              <td align="center">13379</td>
              <td align="center">13085</td>
              <td align="center">12802</td>
              <td align="center">10601</td>
              <td align="center">7587</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.85</td>
              <td align="center">-2.00</td>
              <td align="center">-3.54</td>
              <td align="center">-5.01</td>
              <td align="center">-5.32</td>
              <td align="center">-5.36</td>
              <td align="center">-4.96</td>
            </tr>
            <tr>
              <td align="left">BLAT</td>
              <td align="center">13878</td>
              <td align="center">13866</td>
              <td align="center">13843</td>
              <td align="center">13680</td>
              <td align="center">13355</td>
              <td align="center">11180</td>
              <td align="center">8167</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.04</td>
              <td align="center">-0.10</td>
              <td align="center">-0.19</td>
              <td align="center">-0.73</td>
              <td align="center">-1.33</td>
              <td align="center">-1.19</td>
              <td align="center">-0.79</td>
            </tr>
            <tr>
              <td align="left">GMAP</td>
              <td align="center">
                <underline>13879</underline>
              </td>
              <td align="center">
                <underline>13875</underline>
              </td>
              <td align="center">
                <underline>13864</underline>
              </td>
              <td align="center">
                <underline>13753</underline>
              </td>
              <td align="center">13481</td>
              <td align="center">
                <underline>11291</underline>
              </td>
              <td align="center">8066</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.03</td>
              <td align="center">-0.04</td>
              <td align="center">-0.04</td>
              <td align="center">-0.20</td>
              <td align="center">-0.42</td>
              <td align="center">-0.39</td>
              <td align="center">-1.51</td>
            </tr>
            <tr>
              <td align="left">SPA</td>
              <td align="center">13878</td>
              <td align="center">13868</td>
              <td align="center">13855</td>
              <td align="center">13738</td>
              <td align="center">
                <underline>13502</underline>
              </td>
              <td align="center">11290</td>
              <td align="center">
                <underline>8174</underline>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.04</td>
              <td align="center">-0.09</td>
              <td align="center">-0.11</td>
              <td align="center">-0.31</td>
              <td align="center">-0.27</td>
              <td align="center">-0.40</td>
              <td align="center">-0.73</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The data in Tables <xref ref-type="table" rid="T8">8</xref> and <xref ref-type="table" rid="T9">9</xref> use in-frame identity to compare the alignments produced by the methods for the Subset 1. The data shows that at every level of identity, Splign was able to align more sequences than the other tools. To eliminate a possible concern that the higher in-frame identity demonstrated by Splign alignments may be a result of excessive preference for non-consensus splices, we also counted the numbers of every splice type found in the alignments produced by each of the programs (Table <xref ref-type="table" rid="T10">10</xref>). The comparison reveals that Splign non-consensus splice frequency is the second lowest, and the consensus splice counts are very close to those produced by the two other recent tools.</p>
      <table-wrap position="float" id="T8">
        <label>Table 8</label>
        <caption>
          <p>The number of the Subset 1 alignments at various levels of the in-frame identity. Fractions give the differences in the number of alignments by each method and Splign expressed as percentage of the total of sequences in the set.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">80%</td>
              <td align="center">85%</td>
              <td align="center">90%</td>
              <td align="center">95%</td>
              <td align="center">99%</td>
              <td align="center">99.5%</td>
              <td align="center">99.9%</td>
              <td align="center">100%</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Splign</td>
              <td align="center">67342</td>
              <td align="center">67241</td>
              <td align="center">67105</td>
              <td align="center">66766</td>
              <td align="center">65767</td>
              <td align="center">64938</td>
              <td align="center">50968</td>
              <td align="center">35839</td>
            </tr>
            <tr>
              <td align="left">Sim4</td>
              <td align="center">63968</td>
              <td align="center">63723</td>
              <td align="center">63465</td>
              <td align="center">62986</td>
              <td align="center">61668</td>
              <td align="center">60622</td>
              <td align="center">47820</td>
              <td align="center">34033</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-4.68</td>
              <td align="center">-4.88</td>
              <td align="center">-5.05</td>
              <td align="center">-5.24</td>
              <td align="center">-5.68</td>
              <td align="center">-5.99</td>
              <td align="center">-4.37</td>
              <td align="center">-2.50</td>
            </tr>
            <tr>
              <td align="left">Spidey</td>
              <td align="center">65276</td>
              <td align="center">65182</td>
              <td align="center">65066</td>
              <td align="center">64766</td>
              <td align="center">63844</td>
              <td align="center">62867</td>
              <td align="center">48714</td>
              <td align="center">34451</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-2.86</td>
              <td align="center">-2.86</td>
              <td align="center">-2.83</td>
              <td align="center">-2.77</td>
              <td align="center">-2.67</td>
              <td align="center">-2.87</td>
              <td align="center">-3.13</td>
              <td align="center">-1.92</td>
            </tr>
            <tr>
              <td align="left">BLAT</td>
              <td align="center">64017</td>
              <td align="center">63932</td>
              <td align="center">63817</td>
              <td align="center">63545</td>
              <td align="center">62747</td>
              <td align="center">62115</td>
              <td align="center">49946</td>
              <td align="center">35632</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-4.61</td>
              <td align="center">-4.59</td>
              <td align="center">-4.56</td>
              <td align="center">-4.47</td>
              <td align="center">-4.19</td>
              <td align="center">-3.91</td>
              <td align="center">-1.42</td>
              <td align="center">-0.29</td>
            </tr>
            <tr>
              <td align="left">GMAP</td>
              <td align="center">66568</td>
              <td align="center">66463</td>
              <td align="center">66317</td>
              <td align="center">65956</td>
              <td align="center">64856</td>
              <td align="center">64058</td>
              <td align="center">50589</td>
              <td align="center">
                <underline>35680</underline>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">-1.07</td>
              <td align="center">-1.08</td>
              <td align="center">-1.09</td>
              <td align="center">-1.12</td>
              <td align="center">-1.26</td>
              <td align="center">-1.22</td>
              <td align="center">-0.53</td>
              <td align="center">-0.22</td>
            </tr>
            <tr>
              <td align="left">SPA</td>
              <td align="center">
                <underline>66777</underline>
              </td>
              <td align="center">
                <underline>66669</underline>
              </td>
              <td align="center">
                <underline>66516</underline>
              </td>
              <td align="center">
                <underline>66152</underline>
              </td>
              <td align="center">
                <underline>65042</underline>
              </td>
              <td align="center">
                <underline>64186</underline>
              </td>
              <td align="center">
                <underline>50669</underline>
              </td>
              <td align="center">35679</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.78</td>
              <td align="center">-0.79</td>
              <td align="center">-0.82</td>
              <td align="center">-0.85</td>
              <td align="center">-1.01</td>
              <td align="center">-1.04</td>
              <td align="center">-0.41</td>
              <td align="center">-0.22</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="T9">
        <label>Table 9</label>
        <caption>
          <p>The number of the Subset 1 RefSeq alignments at various levels of the in-frame identity. Fractions give the differences in the number of alignments by each method and Splign expressed as percentage of the total of sequences in the set.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">80%</td>
              <td align="center">85%</td>
              <td align="center">90%</td>
              <td align="center">95%</td>
              <td align="center">99%</td>
              <td align="center">99.5%</td>
              <td align="center">99.9%</td>
              <td align="center">100%</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Splign</td>
              <td align="center">13757</td>
              <td align="center">13747</td>
              <td align="center">13740</td>
              <td align="center">13733</td>
              <td align="center">13723</td>
              <td align="center">13688</td>
              <td align="center">12426</td>
              <td align="center">10323</td>
            </tr>
            <tr>
              <td align="left">Sim4</td>
              <td align="center">13214</td>
              <td align="center">13179</td>
              <td align="center">13145</td>
              <td align="center">13110</td>
              <td align="center">13044</td>
              <td align="center">12958</td>
              <td align="center">11662</td>
              <td align="center">9680</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-3.91</td>
              <td align="center">-4.09</td>
              <td align="center">-4.29</td>
              <td align="center">-4.49</td>
              <td align="center">-4.89</td>
              <td align="center">-5.26</td>
              <td align="center">-5.50</td>
              <td align="center">-4.63</td>
            </tr>
            <tr>
              <td align="left">Spidey</td>
              <td align="center">13185</td>
              <td align="center">13176</td>
              <td align="center">13169</td>
              <td align="center">13162</td>
              <td align="center">13146</td>
              <td align="center">13089</td>
              <td align="center">11720</td>
              <td align="center">9706</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-4.12</td>
              <td align="center">-4.11</td>
              <td align="center">-4.11</td>
              <td align="center">-4.11</td>
              <td align="center">-4.16</td>
              <td align="center">-4.31</td>
              <td align="center">-5.09</td>
              <td align="center">-4.44</td>
            </tr>
            <tr>
              <td align="left">BLAT</td>
              <td align="center">13507</td>
              <td align="center">13498</td>
              <td align="center">13491</td>
              <td align="center">13484</td>
              <td align="center">13473</td>
              <td align="center">13441</td>
              <td align="center">12271</td>
              <td align="center">10284</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-1.80</td>
              <td align="center">-1.79</td>
              <td align="center">-1.79</td>
              <td align="center">-1.79</td>
              <td align="center">-1.80</td>
              <td align="center">-1.78</td>
              <td align="center">-1.12</td>
              <td align="center">-0.28</td>
            </tr>
            <tr>
              <td align="left">GMAP</td>
              <td align="center">
                <underline>13744</underline>
              </td>
              <td align="center">
                <underline>13733</underline>
              </td>
              <td align="center">
                <underline>13726</underline>
              </td>
              <td align="center">
                <underline>13718</underline>
              </td>
              <td align="center">
                <underline>13706</underline>
              </td>
              <td align="center">
                <underline>13671</underline>
              </td>
              <td align="center">
                <underline>12408</underline>
              </td>
              <td align="center">
                <underline>10307</underline>
              </td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.09</td>
              <td align="center">-0.10</td>
              <td align="center">-0.10</td>
              <td align="center">-0.11</td>
              <td align="center">-0.12</td>
              <td align="center">-0.12</td>
              <td align="center">-0.13</td>
              <td align="center">-0.12</td>
            </tr>
            <tr>
              <td align="left">SPA</td>
              <td align="center">13715</td>
              <td align="center">13706</td>
              <td align="center">13698</td>
              <td align="center">13691</td>
              <td align="center">13676</td>
              <td align="center">13635</td>
              <td align="center">12373</td>
              <td align="center">10275</td>
            </tr>
            <tr>
              <td/>
              <td align="center">-0.30</td>
              <td align="center">-0.30</td>
              <td align="center">-0.30</td>
              <td align="center">-0.30</td>
              <td align="center">-0.34</td>
              <td align="center">-0.38</td>
              <td align="center">-0.38</td>
              <td align="center">-0.35</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="T10">
        <label>Table 10</label>
        <caption>
          <p>Frequencies of splice sites in Subset 1 alignments</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">GT/AG</td>
              <td align="center">GC/AG</td>
              <td align="center">AT/AC</td>
              <td align="center">non-consensus</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Sim4</td>
              <td align="center">96.21</td>
              <td align="center">0.78</td>
              <td align="center">0.06</td>
              <td align="center">2.96</td>
            </tr>
            <tr>
              <td align="left">Spidey</td>
              <td align="center">95.72</td>
              <td align="center">0.67</td>
              <td align="center">0.09</td>
              <td align="center">3.52</td>
            </tr>
            <tr>
              <td align="left">BLAT</td>
              <td align="center">97.87</td>
              <td align="center">0.74</td>
              <td align="center">0.10</td>
              <td align="center">1.29</td>
            </tr>
            <tr>
              <td align="left">GMAP</td>
              <td align="center">98.74</td>
              <td align="center">0.75</td>
              <td align="center">0.12</td>
              <td align="center">0.38</td>
            </tr>
            <tr>
              <td align="left">SPA</td>
              <td align="center">98.52</td>
              <td align="center">0.74</td>
              <td align="center">0.11</td>
              <td align="center">0.62</td>
            </tr>
            <tr>
              <td align="left">Splign</td>
              <td align="center">98.66</td>
              <td align="center">0.75</td>
              <td align="center">0.11</td>
              <td align="center">0.48</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>Compartment test</title>
      <p>An acknowledged difficulty for a spliced alignment tool is to properly localize an alignment in presence of nearby same-strand duplications. In order to test how well each tool handles the task, we created a set of mRNA sequences with each sequence covered at least 1.5 times by same strand Megablast hits to the same subject (a chromosome or an unplaced scaffold), and the highest-identity alignment subject to the following conditions.</p>
      <p>• same exon count among the methods</p>
      <p>• sense direction</p>
      <p>• at most one non-consensus splice</p>
      <p>• the identity is 90% or higher</p>
      <p>The conditions produced 9383 mRNA sequences ("Subset 2"). For every mRNA sequence in the set, its highest-identity alignment's span ratio has been compared among the methods. Table <xref ref-type="table" rid="T11">11</xref> shows that Splign has the smallest mean ratio and the second smallest median ratio. As with the identity-based tests, trailing 'A' residues that were part of alignments were trimmed prior to computing the statistics. Had this not been done, the ratios for the methods with higher fraction of alignments retaining Poly(A) tails would have gone up.</p>
      <table-wrap position="float" id="T11">
        <label>Table 11</label>
        <caption>
          <p>Span ratios of Subset 2 alignments</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">Sim4</td>
              <td align="center">Spidey</td>
              <td align="center">BLAT</td>
              <td align="center">GMAP</td>
              <td align="center">SPA</td>
              <td align="center">Splign</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">median</td>
              <td align="center">4.179</td>
              <td align="center">4.201</td>
              <td align="center">4.234</td>
              <td align="center">4.378</td>
              <td align="center">4.218</td>
              <td align="center">4.190</td>
            </tr>
            <tr>
              <td align="center">mean</td>
              <td align="center">11.242</td>
              <td align="center">8.534</td>
              <td align="center">9.134</td>
              <td align="center">10.102</td>
              <td align="center">8.671</td>
              <td align="center">8.420</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>Co-aligning EST test</title>
      <p>Alignment of EST sequences is often more difficult due to shorter sequence length and higher error rates. Yet for most organisms, the bulk of transcript evidence comes in the form of ESTs as they are less expensive to produce in a high-throughput manner than full-length mRNA sequences. Therefore, it is important for a spliced alignment program to be able to compute accurate alignments of cDNA sequences with higher sequencing error rates such as in ESTs. To measure how well different programs cope with the task, the following test has been conducted.</p>
      <p>We selected a subset of RefSeq mRNA sequences that align uniquely across the genome with an identity of 99% or higher, having at least two exons, and at least one co-aligning EST, which yielded 13975 sequences. For each sequence from this set, a list of EST sequences was compiled whose EST-to-mRNA alignment suggested the same splicing form. This selection was done by running Megablast [<xref ref-type="bibr" rid="B8">8</xref>] on query EST sequences against a database of the mRNA sequences and selecting ESTs with the number of unaligned bases less than ten, the maximum gap length less than four, and the overall alignment identity of 95% or higher. In such a way, the total of 1 683 827 ESTs were selected. Initially, we estimated using the EST-to-mRNA and (method-specific) mRNA-to-genomic alignments the number of introns expected in the EST-to-genomic alignments. Then every EST from the list was aligned on the genome using each of the methods, and the number of introns exactly matching those found in the mRNA alignments was collected.</p>
      <p>The results of this test are presented in Table <xref ref-type="table" rid="T12">12</xref>. The data shows that in terms of sensitivity, Splign produced a higher number than any other tool except SPA, whose fraction of identified introns was higher by 1.4%. However, the time it took to compute the EST alignments with Splign (37 CPU hours) was nearly twenty times smaller than that of SPA. The best specificity was demonstrated by GMAP with almost 99.5% of introns matching those found in the mRNA alignments, followed by Splign that correctly aligned 98.9% of introns. Sim4, which is one of the oldest programs, also demonstrated good specificity.</p>
      <table-wrap position="float" id="T12">
        <label>Table 12</label>
        <caption>
          <p>Co-aligning EST test. 'Implied' is the number of introns estimated from EST-to-mRNA and mRNA-to-genomic alignments. 'Identified' is the number of introns found in EST-to-genomic alignments. 'Matching' is the number of introns in EST-to-genomic alignment matching those found in the mRNA-to-genomic alignments.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">Sim4</td>
              <td align="center">Spidey</td>
              <td align="center">BLAT</td>
              <td align="center">GMAP</td>
              <td align="center">SPA</td>
              <td align="center">Splign</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Implied</td>
              <td align="center">3472173</td>
              <td align="center">3419307</td>
              <td align="center">3417203</td>
              <td align="center">3419975</td>
              <td align="center">3425734</td>
              <td align="center">3419138</td>
            </tr>
            <tr>
              <td align="left">Identified, as %% of Implied</td>
              <td align="center">3174725</td>
              <td align="center">3249426</td>
              <td align="center">3150040</td>
              <td align="center">3219665</td>
              <td align="center">3407890</td>
              <td align="center">3352628</td>
            </tr>
            <tr>
              <td/>
              <td align="center">91.4</td>
              <td align="center">95.0</td>
              <td align="center">92.2</td>
              <td align="center">94.1</td>
              <td align="center">99.5</td>
              <td align="center">98.1</td>
            </tr>
            <tr>
              <td align="left">Matching, as %% of Identified</td>
              <td align="center">3128325</td>
              <td align="center">2813461</td>
              <td align="center">2810059</td>
              <td align="center">3202121</td>
              <td align="center">3294548</td>
              <td align="center">3314074</td>
            </tr>
            <tr>
              <td/>
              <td align="center">98.5</td>
              <td align="center">86.6</td>
              <td align="center">89.2</td>
              <td align="center">99.5</td>
              <td align="center">96.7</td>
              <td align="center">98.9</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Although each mRNA sequence in this initial test was required to have a high-identity alignment, for a number of sequences different methods produced different alignments. To reduce the possibility that the initial EST test might have been affected by the alignment errors introduced by the methods in their mRNA alignments and repeated in the EST alignments, we repeated the test with an extra requirement that the set of introns must be the same in the mRNA alignments produced by every method. This brought down the number of mRNA sequences to 7 923, and the number of EST sequences to 915 111. The results of the test are presented in the second line of Table <xref ref-type="table" rid="T13">13</xref>, and are in line with the results from the initial test.</p>
      <table-wrap position="float" id="T13">
        <label>Table 13</label>
        <caption>
          <p>Co-aligning EST test, based on mRNA-to-genomic alignments matching across the methods</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">Sim4</td>
              <td align="center">Spidey</td>
              <td align="center">BLAT</td>
              <td align="center">GMAP</td>
              <td align="center">SPA</td>
              <td align="center">Splign</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Implied</td>
              <td align="center">1784663</td>
              <td align="center">1784663</td>
              <td align="center">1784663</td>
              <td align="center">1784663</td>
              <td align="center">1784663</td>
              <td align="center">1784663</td>
            </tr>
            <tr>
              <td align="left">Identified, as %% of Implied</td>
              <td align="center">1652062</td>
              <td align="center">1691136</td>
              <td align="center">1642759</td>
              <td align="center">1679932</td>
              <td align="center">1771713</td>
              <td align="center">1745535</td>
            </tr>
            <tr>
              <td/>
              <td align="center">92.6</td>
              <td align="center">94.8</td>
              <td align="center">92.0</td>
              <td align="center">94.1</td>
              <td align="center">99.3</td>
              <td align="center">97.8</td>
            </tr>
            <tr>
              <td align="left">Matching, as %% of Identified</td>
              <td align="center">1635634</td>
              <td align="center">1477759</td>
              <td align="center">1475183</td>
              <td align="center">1672383</td>
              <td align="center">1719549</td>
              <td align="center">1729834</td>
            </tr>
            <tr>
              <td/>
              <td align="center">99.0</td>
              <td align="center">87.4</td>
              <td align="center">89.8</td>
              <td align="center">99.6</td>
              <td align="center">97.1</td>
              <td align="center">99.1</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We developed a tool that is robust enough to produce accurate cDNA-to-genomic alignments in a matter of hours on a moderate-sized computing cluster for the largest available cDNA data volumes such as the human or mouse EST libraries. Splign has a powerful compartmentization algorithm to identify and separate nearby same-strand duplications. The program is tolerant to sequencing errors and polymorphic sites due to its use of the true optimal alignment algorithm and a conservative application of the preliminary local alignments.</p>
    <p>There are three aspects that are novel in Splign compared to other methods. First, we introduce a high-performance method using index-to-index comparison for computing preliminary local alignments. Second, a formally defined model of compartments discriminating between gene and exon duplication events is used to localize candidate genomic regions for every input cDNA. Finally, the scores used in the splice-aware optimal alignment algorithm are obtained as a solution of a linear programming problem reflecting selected types of target alignments. Although the resulting affine gap scoring model employed in Splign is less generic than probability-based scoring models such as [<xref ref-type="bibr" rid="B6">6</xref>], it allows the computation of alignments of comparable quality faster by an order of magnitude.</p>
    <p>Splign has been evolving over the past five years. It is routinely used at NCBI to facilitate annotation of eukaryotic genomes.</p>
    <p>The Splign web site [<xref ref-type="bibr" rid="B9">9</xref>] provides access to the source code in C++ and allows the download of pre-compiled Splign and Compart binaries for several major platforms. The site also has a job submission facility, where cDNA queries can be aligned online against a genomic sequence or a whole genome.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Preliminary sequence alignment</title>
      <p>In this section we describe the algorithm for the computation of elementary alignments between a set of input cDNA sequences and a genome from the same species (Figure <xref ref-type="fig" rid="F2">2</xref>). The goal was to make the algorithm both sensitive and fast when matching a large number of cDNA sequences against a whole genome.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p>Compart matching algorithm.</p>
        </caption>
        <graphic xlink:href="1745-6150-3-20-2"/>
      </fig>
      <p>High sensitivity of the algorithm is achieved by using a small word size and very light repeat filtering. During the compartmentization each alignment is evaluated in the context of compartments and kept only if found to be a member of the globally optimal chain of alignments. If some minimum level of query cDNA coverage by a compartment is employed, which is typical in practical applications, most spurious matches between a pair of sequences are discarded even before the compartmentization stage.</p>
      <p>On the performance side, the algorithm benefits from utilizing the information about the composition of the cDNA sequences at the indexing of the genome, reducing the size of the index. Indices produced by the algorithm are stored in disk files to free memory for accumulation and processing of matching words. The latter are found by a linear-time comparison of the cDNA and genomic indices, during which the indices are accessed sequentially. The algorithm performs ungapped extension of the alignments as it is sufficient for the compartmentization and gaps in the final alignments are discovered using the target function of the refinement stage.</p>
      <p>The algorithm starts with scanning the genomic sequence for repeats. Note that application of some form of repeat masking is necessary to keep a local alignment tool of choice from being overwhelmed with hits to repetitive genomic segments. On the other hand, accuracy of solutions produced by the compartmentization may suffer if the set of local alignment is incomplete. Since it is possible for a repeated sequence to be part of an exon, we apply a very light repeat filtering based on frequency counts of sparse words. We first collect the counts of 14-mers with relative positions 1, 2, 5 – 16 in 16-mers starting at every fourth position in the genome. Then we set elements of a repeat filtering bit vector (RFV) corresponding to 14-mers within the 99.5 percentile. For every 16-base word parsed during the cDNA indexing, the 14-base subsequence of the word is extracted and used to check the corresponding bit in the RFV to determine whether the word becomes a key in the index. The choice of 14 for the purpose of computing the number of word repetitions allows the entire repetition count vector to occupy only 256 megabytes. The repetition count vector is discarded as soon as the RFV is initialized, with the latter occupying even smaller space.</p>
      <p>The next step is the indexing of cDNA and genomic sequences. The sequences are concatenated and encoded using two bits per residue. The cDNA sequences are indexed first, with each word checked against RFV using the procedure described above. If the check is successful, the underlying 32-bit value (key) is written alongside its global coordinate. Such key/position pairs are accumulated unless indexing another sequence would top a pre-defined maximum index volume size. At that point the pairs are sorted by keys and the index volume is saved on the disk. The indexing continues until all sequences have been parsed.</p>
      <p>On the disk, the index is stored in two components. A position component lists global coordinates of the keys while the key component lists keys and offsets corresponding to them in the position component. Similar index representations have been used in a number of other applications [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B10">10</xref>].</p>
      <p>Different filtering vectors are used during the indexing of the cDNA and the genomic sequences. RFV derived from the genome is applied at the cDNA indexing to filter out words that are over-represented in the genome. Similarly, a participation vector (PV), which is a bit vector with bits indicating presence of the keys in the cDNA index, is applied at the indexing of the genome. The vector occupies 512 megabytes in memory and is used to admit into the genomic index only those keys that are found in the cDNA index. Genomic words are extracted at every other position of the genome. Combined with the continuous sampling of cDNA sequences, this assures that every pair of perfectly matching sequence segments of length seventeen or longer will be found.</p>
      <p>As both indices have been created, word matching is done very quickly through comparison of the key components of the indices. Indeed, since the key components are ordered by keys, finding each matching pair of keys is achieved by synchronous scanning of the components. For the same reason, the number of words corresponding to a matching key on the cDNA and the genome is found immediately. Matching words are recorded as pairs of global coordinates for every pair of the cDNA and genomic index volumes. Because of the way the index volumes are constructed (above), matching words for every pair of cDNA and genomic sequences are guaranteed to be confined to a unique pair of index volumes. This is essential for the compartmentization which must have all alignments between a pair of sequences available by the time it starts processing the pair. The matching words are merged along common diagonals and extended using the drop-off approach [<xref ref-type="bibr" rid="B11">11</xref>].</p>
      <p>We refer below to our elementary matching algorithm as <italic>Compart matching</italic>, because the implementation of the algorithm is embedded in the same software tool that does the compartmentization. In the rest of this sub-section we evaluate the repeat filtering step, the effect of using the PV in Compart matching, and compare the results of the compartmentization based on local alignments computed with different methods.</p>
      <p>Filtering of repeated DNA sequences has been a subject of much previous research. The most widely used repeat masking tool, RepeatMasker [<xref ref-type="bibr" rid="B12">12</xref>], relies on an external database of repetitive elements. A more recent tool, WindowMasker [<xref ref-type="bibr" rid="B13">13</xref>], masks repetitive DNA segments using only the genomic sequence itself. Having considered using either of these tools to mask genomic repeats, we eventually developed our own approach which proved to be better suited for the task of cDNA-to-genomic preliminary alignment. Our goal was to keep the level of repeat filtering moderate, because missing input local alignments can negatively impact accuracy of the compartmentization algorithm. We prefer to use the term <italic>repeat filtering </italic>when describing the algorithm in Compart because, unlike RM or WM, it effectively tags whole words rather than individual positions on the genome.</p>
      <p>We evaluated the intensity of repeat filtering by comparing the number of genomic words kept out of the index. To do so, we disabled the PV and counted the number of words with their corresponding bit set in RVF. In sequences masked with RM or WM, only words with all residues masked were counted. According to our tests (Table <xref ref-type="table" rid="T14">14</xref>), the repeat filtering in Compart resulted in significantly fewer words filtered out, the least number of words filtered out exclusively, and by far the best running time.</p>
      <table-wrap position="float" id="T14">
        <label>Table 14</label>
        <caption>
          <p>Filtering of genomic repeats by different methods. <italic>Q</italic><sub>1 </sub>is the fraction of masked words. <italic>Q</italic><sub>2 </sub>is the fraction of words masked exclusively by the method. In case of RM and WM, a word was considered masked if all its bases were masked. The timing in each test was obtained using a single instance running on Intel Xeon 2.33 GHz/8 GB Linux box.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td/>
              <td align="center">RepeatMasker</td>
              <td align="center">WindowMasker</td>
              <td align="center">Compart</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Human</td>
              <td align="left"><italic>Q</italic><sub>1</sub>(%)</td>
              <td align="center">46.79</td>
              <td align="center">28.81</td>
              <td align="center">17.68</td>
            </tr>
            <tr>
              <td/>
              <td align="left"><italic>Q</italic><sub>2</sub>(%)</td>
              <td align="center">31.03</td>
              <td align="center">12.23</td>
              <td align="center">5.41</td>
            </tr>
            <tr>
              <td/>
              <td align="left">time (min)</td>
              <td align="center">6077</td>
              <td align="center">131</td>
              <td align="center">7</td>
            </tr>
            <tr>
              <td align="left">Mouse</td>
              <td align="left"><italic>Q</italic><sub>1</sub>(%)</td>
              <td align="center">40.55</td>
              <td align="center">28.61</td>
              <td align="center">17.71</td>
            </tr>
            <tr>
              <td/>
              <td align="left"><italic>Q</italic><sub>2</sub>(%)</td>
              <td align="center">25.24</td>
              <td align="center">12.41</td>
              <td align="center">5.46</td>
            </tr>
            <tr>
              <td/>
              <td align="left">time (min)</td>
              <td align="center">5955</td>
              <td align="center">117</td>
              <td align="center">6</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Fewer repeated words filtered out may result in explosive growth of alignments in a general-purpose local alignment algorithm. In Compart, however, only alignments composing compartments are kept beyond the compartmentization step which is a small fraction of the alignments generated internally.</p>
      <p>The RFV is used at the indexing of the cDNA sequences, which also initializes the PV. Table <xref ref-type="table" rid="T15">15</xref> lists the size of the key component of the genomic index for human and mouse as a percentage of what that size would be if the PV was not used. A more compact genomic index has an impact on computing time. In our experiment where human mRNA sequences were aligned against the reference genome, the indexing (search) has slowed by a factor of three (eleven) when the PV was disabled. The bulk of search performance improvement comes from non-redundancy of the index components, which eliminates duplicate look-ups and dramatically improves CPU cache line coherence.</p>
      <table-wrap position="float" id="T15">
        <label>Table 15</label>
        <caption>
          <p>Impact of the PV on the size of the index. <italic>N </italic>is the number of full-length mRNA sequences. <italic>R </italic>is the number of genomic index keys as a percentage of the number of distinct words on the unmasked genome.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td/>
              <td align="center">Human 36.3</td>
              <td align="center">Mouse 37.1</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">mRNA</td>
              <td align="left">
                <italic>N</italic>
              </td>
              <td align="center">214 749</td>
              <td align="center">240 299</td>
            </tr>
            <tr>
              <td/>
              <td align="left"><italic>R </italic>(%)</td>
              <td align="center">8.4</td>
              <td align="center">10.2</td>
            </tr>
            <tr>
              <td align="left">EST</td>
              <td align="left">
                <italic>N</italic>
              </td>
              <td align="center">7 732 838</td>
              <td align="center">4 836 245</td>
            </tr>
            <tr>
              <td/>
              <td align="left"><italic>R </italic>(%)</td>
              <td align="center">38.6</td>
              <td align="center">27.2</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Table <xref ref-type="table" rid="T16">16</xref> reports a test where compartments were produced based on alignments computed with Compart and Megablast, with Megablast using the genomic sequence masked with RepeatMasker or WindowMasker. To have Megablast account for the masking, the genomic sequence was used as the query. The option allowing Megablast to extent alignments over masked regions has been selected. All other Megablast options, including the word size of 28, have been set to their defaults. The table presents various mRNA sequence counts and the time spent to compute local alignments and compartments. Use of Compart resulted in more sequences in each category. It could have been possible to improve sensitivity of Compart even further by performing the extension of elementary matches along adjacent diagonals, but we have not done so. Note that local alignments for some mRNA sequences do not form compartments with any of the genomic sequences, which explains why the number of aligned mRNA sequences (<italic>N</italic><sub>1 </sub>and <italic>N</italic><sub>2 </sub>in the table) is always smaller than the number of sequences with at least one compartment (<italic>N</italic><sub>3</sub>).</p>
      <table-wrap position="float" id="T16">
        <label>Table 16</label>
        <caption>
          <p>Compartmentization based on local alignments computed using different methods. <italic>N</italic><sub>1 </sub>is the number of mRNA sequences with 75% or higher coverage by alignments to any single chromosome or unplaced scaffold.<italic>N</italic><sub>2 </sub>is the number of mRNA sequences with 75% or higher coverage by high-identity alignments to any single chromosome or unplaced scaffold. <italic>N</italic><sub>3 </sub>is the number of sequences for which at least one compartment was identified with the minimum compartment identity of 75%. The computing time was collected on Intel Xeon 2.33 GHz/8 GB Linux box.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td/>
              <td align="center">MB/RM</td>
              <td align="center">MB/WM</td>
              <td align="center">Compart</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Human 36.3</td>
              <td align="left">
                <italic>N</italic>
                <sub>1</sub>
              </td>
              <td align="center">232342 (94.95%)</td>
              <td align="center">234565 (95.86%)</td>
              <td align="center">238851 (97.61%)</td>
            </tr>
            <tr>
              <td/>
              <td align="left">
                <italic>N</italic>
                <sub>2</sub>
              </td>
              <td align="center">224054 (91.56%)</td>
              <td align="center">226293 (92.48%)</td>
              <td align="center">229101 (93.63%)</td>
            </tr>
            <tr>
              <td/>
              <td align="left">
                <italic>N</italic>
                <sub>3</sub>
              </td>
              <td align="center">231939 (94.79%)</td>
              <td align="center">234207 (95.71%)</td>
              <td align="center">236928 (96.82%)</td>
            </tr>
            <tr>
              <td/>
              <td align="left">time (min)</td>
              <td align="center">179</td>
              <td align="center">70</td>
              <td align="center">32</td>
            </tr>
            <tr>
              <td align="left">Mouse 37.1</td>
              <td align="left">
                <italic>N</italic>
                <sub>1</sub>
              </td>
              <td align="center">227831 (98.44%)</td>
              <td align="center">228681 (95.17%)</td>
              <td align="center">232245 (96.65%)</td>
            </tr>
            <tr>
              <td/>
              <td align="left">
                <italic>N</italic>
                <sub>2</sub>
              </td>
              <td align="center">222746 (92.70%)</td>
              <td align="center">223704 (93.09%)</td>
              <td align="center">226107 (94.09%)</td>
            </tr>
            <tr>
              <td/>
              <td align="left">
                <italic>N</italic>
                <sub>3</sub>
              </td>
              <td align="center">226964 (94.45%)</td>
              <td align="center">227895 (94.84%)</td>
              <td align="center">230478 (95.91%)</td>
            </tr>
            <tr>
              <td/>
              <td align="left">time (min)</td>
              <td align="center">372</td>
              <td align="center">59</td>
              <td align="center">29</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>A shortcoming of Compart matching algorithm is its reliance on perfectly matching keys. As sequences get more diverged (e.g. in cross-species alignments) the algorithm becomes less sensitive. In those cases, tools not relying on perfectly matching words, such as Megablast in discontiguous mode, will tend to provide better input for the compartmentization step.</p>
    </sec>
    <sec>
      <title>Compartmentization</title>
      <p>For many cDNA sequences, their local alignments against the genome suggest more than one place from which these sequences (or their orthologous counterparts, in case of cross-species alignments) might have originated. The goal of the compartmentization step is to filter and partition the local alignments into subsets so that these subsets will pinpoint every candidate location on the genome. We use the term <italic>compartment </italic>to designate both the alignment subsets and the genomic locations. After a compartment is identified, a spliced alignment algorithm can step in to produce a more accurate alignment of the cDNA with the local genomic interval.</p>
      <p>Compartments located on different chromosomes or different strands are trivially separated. For others, the task can be more complex because of possible sequencing errors, polymorphic sites and exon duplications. Various approaches have been employed in other tools to identify candidate genomic locations. In Spidey, a greedy algorithm is used in which high-stringency Blast hits are sorted by score and then iterated, possibly more than once. On every iteration, each hit is either skipped or assigned to its genomic window, based on whether the hit's coordinates are linearly consistent with those of the other hits already in the window. GMAP scans the ends of a cDNA in an attempt to find pairs of highly-specific oligomers matching into approximately the same location on the genome. The latter is defined taking into the account factors such as the allowed genomic expansion for a given length of the cDNA sequence, concentration of matches and collinearity of cDNA and genomic coordinates. SPA relies on BLAT to perform the compartmentization step, however the relevant algorithm is not described in the BLAT paper.</p>
      <p>The compartmentization algorithm in Splign is based on a formally defined model of compartments. Consider a cDNA (<italic>query</italic>) sequence aligning in the sense direction with the plus strand of a genomic (<italic>subject</italic>) sequence. We call a <italic>high-scoring pair </italic>(HSP) a pair of intervals on the query and subject sequences revealing a certain level of similarity. Without a loss of generality, this exposition assumes that HSPs are ungapped and perfect.</p>
      <p>Consider two HSPs, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1745-6150-3-20-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula>, 0 ≤ <italic>l </italic>≤ <italic>L</italic><sub><italic>k</italic></sub>, where <italic>L</italic><sub><italic>k </italic></sub>are the lengths of the HSPs, <italic>k </italic>= <italic>i</italic>, <italic>j</italic>. We introduce a binary relation over the set of HSPs to reflect the order in which exons or their parts follow. Say that <italic>h</italic><sup>(<italic>i</italic>) </sup><italic>precedes h</italic><sup>(<italic>j</italic>) </sup>(<italic>h</italic><sup>(<italic>i</italic>) </sup>≺ <italic>h</italic><sup>(<italic>j</italic>)</sup>) if the following conditions hold:</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1745-6150-3-20-i2" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>h</mml:mi>
                          <mml:mi>α</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>&lt;</mml:mo>
                        <mml:msubsup>
                          <mml:mi>h</mml:mi>
                          <mml:mi>α</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>j</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>h</mml:mi>
                          <mml:mi>α</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>L</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>&lt;</mml:mo>
                        <mml:msubsup>
                          <mml:mi>h</mml:mi>
                          <mml:mi>α</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>j</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>L</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>,</mml:mo>
                        <mml:mi>α</mml:mi>
                        <mml:mo>∈</mml:mo>
                        <mml:mo>{</mml:mo>
                        <mml:mi>q</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>s</mml:mi>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>h</mml:mi>
                          <mml:mi>s</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>j</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msubsup>
                          <mml:mi>l</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                          <mml:mo>∗</mml:mo>
                        </mml:msubsup>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:msubsup>
                          <mml:mi>h</mml:mi>
                          <mml:mi>s</mml:mi>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>L</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>≤</mml:mo>
                        <mml:msub>
                          <mml:mi>I</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>a</mml:mi>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>I</italic><sub><italic>max </italic></sub>is the upper limit on the length of introns and</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1745-6150-3-20-i3" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>l</mml:mi>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                  <mml:mo>∗</mml:mo>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:munder>
                  <mml:mrow>
                    <mml:mi>max</mml:mi>
                    <mml:mo>⁡</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>α</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:mo>{</mml:mo>
                    <mml:mi>q</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>s</mml:mi>
                    <mml:mo>}</mml:mo>
                  </mml:mrow>
                </mml:munder>
                <mml:mi>arg</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:munder>
                  <mml:mrow>
                    <mml:mi>min</mml:mi>
                    <mml:mo>⁡</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>l</mml:mi>
                    <mml:mo>≥</mml:mo>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                </mml:munder>
                <mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>h</mml:mi>
                      <mml:mi>α</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>j</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>l</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:msubsup>
                      <mml:mi>h</mml:mi>
                      <mml:mi>α</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>L</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>is a diagonal coordinate from which <italic>h</italic><sup>(<italic>j</italic>) </sup>may extend <italic>h</italic><sup>(<italic>i</italic>) </sup>as a part of the same or a different exon. The definition allows overlapping of HSPs and accounts for a possible deletion from the query which can be a result of evolution or an artefact. Such introduced binary relation implies a strict partial ordering over the full set <italic>H </italic>of HSPs.</p>
      <p>For an arbitrary subset <italic>C </italic>= {<italic>h</italic><sup>(1)</sup>,...,<italic>h</italic><sup>(<italic>M</italic>)</sup>} of <italic>H</italic>, define its <italic>query coverage </italic>as the length of the part of the query covered by HSPs from C:</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1745-6150-3-20-i4" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>Q</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>C</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∪</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>M</mml:mi>
                      </mml:munderover>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>[</mml:mo>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>h</mml:mi>
                              <mml:mi>q</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mn>0</mml:mn>
                            <mml:mo stretchy="false">)</mml:mo>
                            <mml:mo>,</mml:mo>
                            <mml:msubsup>
                              <mml:mi>h</mml:mi>
                              <mml:mi>q</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msub>
                              <mml:mi>L</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mo>]</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>Let's call <italic>C </italic>a <italic>compartment </italic>if the above binary relation renders on <italic>C </italic>the structure of a totally ordered set:</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1745-6150-3-20-i5" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>i</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>≺</mml:mo>
                <mml:msup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>i</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>≺</mml:mo>
                <mml:mo>…</mml:mo>
                <mml:mo>≺</mml:mo>
                <mml:msup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>i</mml:mi>
                      <mml:mi>M</mml:mi>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>The key to formalizing the compartmentization problem is an observation that a proper organization of HSPs into compartments {<italic>C</italic><sub><italic>i</italic></sub>} will maximize the <italic>cumulative </italic>query coverage ∑<italic>Q</italic>(<italic>C</italic><sub><italic>i</italic></sub>), provided that each compartment maintains some minimal level of query coverage: <italic>Q</italic>(<italic>C</italic><sub><italic>i</italic></sub>) ≥ <italic>Q</italic><sub><italic>min</italic></sub>. Indeed, biologically compartments represent gene copies with every copy delivering its portion of the query coverage. While some exons may diverge significantly enough to escape being detected by a local alignment tool of choice, it may still be possible to identify a compartment accurately as long as its alignment delivers the query coverage above the threshold. In practice, we select <italic>Q</italic><sub><italic>min </italic></sub>as the minimum of some fraction of the query's length and a constant.</p>
      <p>The following relation is introduced to reflect our model's assumption that no two (same-strand) compartments corresponding to a query can overlap on the genome:</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1745-6150-3-20-i6" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>⊣</mml:mo>
                <mml:msup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>j</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>⇔</mml:mo>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mi>s</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>L</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>&lt;</mml:mo>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mi>s</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>j</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mn>0</mml:mn>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>Call a sequence of HSPs <italic>v </italic>= {<italic>h</italic><sup>(1)</sup>,...,<italic>h</italic><sup>(<italic>M</italic>)</sup>} <italic>valid </italic>if for every <italic>i </italic>&lt;<italic>j </italic>either <italic>h</italic><sup>(<italic>i</italic>) </sup>≺ <italic>h</italic><sup>(<italic>j</italic>)</sup>, or <italic>h</italic><sup>(<italic>i</italic>) </sup>⊣ <italic>h</italic><sup>(<italic>j</italic>)</sup>, or both are true. A valid sequence of HSPs can be viewed as a chain of non-overlapping compartments and assigned with a score:</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1745-6150-3-20-i7" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>S</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>v</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:munder>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mi>Q</mml:mi>
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>+</mml:mo>
                    <mml:mi>Q</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>C</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>The optimization target is then defined as</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1745-6150-3-20-i8" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>S</mml:mi>
                    <mml:mo>¯</mml:mo>
                  </mml:mover>
                  <mml:mi>H</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:munder>
                  <mml:mrow>
                    <mml:mi>max</mml:mi>
                    <mml:mo>⁡</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>v</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:msub>
                      <mml:mi>V</mml:mi>
                      <mml:mi>H</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:munder>
                <mml:mi>S</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>v</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>V</italic><sub><italic>H </italic></sub>is the set of all valid sequences over <italic>H</italic>. Let order HSPs in <italic>H </italic>so that</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1745-6150-3-20-i9" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mi>s</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>L</mml:mi>
                  <mml:mn>1</mml:mn>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>≤</mml:mo>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mi>s</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>L</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>≤</mml:mo>
                <mml:mo>…</mml:mo>
                <mml:mo>≤</mml:mo>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mi>s</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>L</mml:mi>
                  <mml:mi>N</mml:mi>
                </mml:msub>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>assuring that for every <italic>h</italic><sup>(<italic>i</italic>) </sup>and <italic>h</italic><sup>(<italic>i</italic>) </sup>such that <italic>h</italic><sup>(<italic>i</italic>) </sup>≺ <italic>h</italic><sup>(<italic>j</italic>) </sup>or <italic>h</italic><sup>(<italic>i</italic>) </sup>⊣ <italic>h</italic><sup>(<italic>j</italic>)</sup>, <italic>i </italic>is less than <italic>j</italic>. Let <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1745-6150-3-20-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>, is the set of valid sequences over <italic>H</italic><sub><italic>k </italic></sub>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1745-6150-3-20-i11" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> is its best score. Then the dynamic programming algorithm is described by the following recurrences.</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1745-6150-3-20-i12" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mtable>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mover accent="true">
                            <mml:mi>S</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mi>Q</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mi>h</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>s</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:msub>
                          <mml:mover accent="true">
                            <mml:mi>S</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mover accent="true">
                            <mml:mi>S</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:mi>max</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mover accent="true">
                            <mml:mi>S</mml:mi>
                            <mml:mo>¯</mml:mo>
                          </mml:mover>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>H</mml:mi>
                              <mml:mi>k</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mi>s</mml:mi>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mo>,</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mover accent="true">
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:mo>,</mml:mo>
                            <mml:mi>N</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mo stretchy="true">¯</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>s</mml:mi>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:mi>max</mml:mi>
                        <mml:mo>⁡</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mi>Q</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mi>h</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                        <mml:mo>,</mml:mo>
                        <mml:msubsup>
                          <mml:mi>S</mml:mi>
                          <mml:mrow>
                            <mml:mi>o</mml:mi>
                            <mml:mi>p</mml:mi>
                            <mml:mi>e</mml:mi>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo>,</mml:mo>
                        <mml:msubsup>
                          <mml:mi>S</mml:mi>
                          <mml:mrow>
                            <mml:mi>e</mml:mi>
                            <mml:mi>x</mml:mi>
                            <mml:mi>t</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>S</mml:mi>
                          <mml:mrow>
                            <mml:mi>o</mml:mi>
                            <mml:mi>p</mml:mi>
                            <mml:mi>e</mml:mi>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo>=</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:msub>
                          <mml:mi>Q</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:mo>|</mml:mo>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mi>h</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mo>|</mml:mo>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:munder>
                          <mml:mrow>
                            <mml:mi>max</mml:mi>
                            <mml:mo>⁡</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>:</mml:mo>
                            <mml:msub>
                              <mml:mi>h</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mo>⊣</mml:mo>
                            <mml:msub>
                              <mml:mi>h</mml:mi>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:munder>
                        <mml:msub>
                          <mml:mi>s</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>S</mml:mi>
                          <mml:mrow>
                            <mml:mi>e</mml:mi>
                            <mml:mi>x</mml:mi>
                            <mml:mi>t</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mo>=</mml:mo>
                        <mml:munder>
                          <mml:mrow>
                            <mml:mi>max</mml:mi>
                            <mml:mo>⁡</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>:</mml:mo>
                            <mml:msup>
                              <mml:mi>h</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo>≺</mml:mo>
                            <mml:msup>
                              <mml:mi>h</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>k</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                        </mml:munder>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msub>
                          <mml:mi>s</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>L</mml:mi>
                          <mml:mrow>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:msubsup>
                          <mml:mi>l</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>k</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mo>∗</mml:mo>
                        </mml:msubsup>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>As the target is evaluated, backtracking is used to restore the compartments contributing to <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1745-6150-3-20-i13" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>H</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>Refined sequence alignment</title>
      <p>Every compartment is further refined with a more accurate sequence alignment algorithm (SAA), which is a combination of the global and local alignment algorithms. The use of the compartment's local alignments is two-fold. First, they define an interval on the genomic sequence on which to perform the alignment. Second, some of the local alignments can be used to accelerate the algorithm by dividing its dynamic programming space. Note that one should be very conservative in choosing the alignments to be used as pivots for the SAA, in order to avoid forcing the final alignment through one of alternatives that were equally favorable during the compartmentization. In Splign, only high-identity diagonal alignments that provide a one-to-one mapping between the sequences are selected. The last condition is verified by checking for possible overlaps among all local alignments between the two sequences. Each pivotal alignment is trimmed at the ends to allow enough slack space for the SAA to locate proper splice sites.</p>
      <p>In the areas between the pivotal alignments, the global alignment algorithm is applied. At the areas stretching to the borders of the compartment, we use a variant of the local alignment algorithm in which one of the alignment's ends is fixed at the pivot. In all cases, the following scoring scheme is used:</p>
      <p>
        <disp-formula><italic>V</italic><sub><italic>ij </italic></sub>= max {<italic>G</italic><sub><italic>ij</italic></sub>, <italic>E</italic><sub><italic>ij</italic></sub>, <italic>F</italic><sub><italic>ij</italic></sub>, <italic>S</italic><sub><italic>ij</italic></sub>}</disp-formula>
      </p>
      <p>
        <disp-formula><italic>G</italic><sub><italic>ij </italic></sub>= <italic>V</italic><sub><italic>i</italic>-1,<italic>j</italic>-1 </sub>+ <italic>W</italic><sub><italic>diag</italic></sub>(<italic>i, j</italic>)</disp-formula>
      </p>
      <p>
        <disp-formula><italic>E</italic><sub><italic>ij </italic></sub>= <italic>W</italic><sub><italic>s </italic></sub>+ max {<italic>E</italic><sub><italic>i</italic>,<italic>j</italic>-1</sub>, <italic>V</italic><sub><italic>i</italic>,<italic>j</italic>-1 </sub>+ <italic>W</italic><sub><italic>g</italic></sub>}</disp-formula>
      </p>
      <p>
        <disp-formula><italic>F</italic><sub><italic>ij </italic></sub>= <italic>W</italic><sub><italic>s </italic></sub>+ max {<italic>F</italic><sub><italic>i</italic>,<italic>j</italic>-1</sub>, <italic>V</italic><sub><italic>i</italic>,<italic>j</italic>-1 </sub>+ <italic>W</italic><sub><italic>g</italic></sub>}</disp-formula>
      </p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1745-6150-3-20-i14" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>S</mml:mi>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:munder>
                  <mml:mrow>
                    <mml:mi>max</mml:mi>
                    <mml:mo>⁡</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>I</mml:mi>
                    <mml:mo>∈</mml:mo>
                    <mml:mo stretchy="false">[</mml:mo>
                    <mml:msub>
                      <mml:mi>I</mml:mi>
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>,</mml:mo>
                    <mml:msub>
                      <mml:mi>I</mml:mi>
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                        <mml:mi>a</mml:mi>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">]</mml:mo>
                  </mml:mrow>
                </mml:munder>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>V</mml:mi>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>j</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mi>I</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mi>W</mml:mi>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>n</mml:mi>
                    <mml:mi>t</mml:mi>
                    <mml:mi>r</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mi>I</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>W</italic><sub><italic>diag</italic></sub>(<italic>i, j</italic>) is the substitution score, <italic>W</italic><sub><italic>g </italic></sub>and <italic>W</italic><sub><italic>s </italic></sub>are the gap opening and extension scores, and <italic>W</italic><sub><italic>intr</italic></sub>(<italic>j </italic>- <italic>I, j</italic>) is the score of the intron starting at genomic position <italic>j </italic>- <italic>I </italic>+ 1 and ending at <italic>j</italic>. Assuming only two types of introns, consensus and non-consensus, we denote below their scores as <italic>W</italic><sub><italic>c </italic></sub>and <italic>W</italic><sub><italic>nc</italic></sub>.</p>
      <p>Scoring schemes with affine gap penalties have been used in many tools (e.g. [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B14">14</xref>,<xref ref-type="bibr" rid="B15">15</xref>]) and have the advantage that algorithms using them can run in time and space proportional to the product of the lengths of the sequences. An important question is the choice of scores, as any particular score assignment defines the algorithm's preferences in shaping various alignment details such splicing signals or micro-exons. Our approach to assigning the scores was to explicitly consider various types of alignment alternatives and subject the scores to conditions reflecting what is perceived as the most plausible choice in every alternative.</p>
      <p>A list of such alternatives and their respective scoring conditions is given in Table <xref ref-type="table" rid="T17">17</xref>. Every line in the table is a separate alternative with A and B being mutually exclusive choices. Provided that the scores satisfy the conditions specified, it is straightforward to verify the following statement. Let <italic>m</italic><sub><italic>A </italic></sub>and <italic>m</italic><sub><italic>B </italic></sub>be the number of mismatches in alignments <italic>A </italic>and <italic>B</italic>, and Δ is a constant. Then for every <italic>m</italic><sub><italic>A </italic></sub>and <italic>m</italic><sub><italic>B </italic></sub>such that <italic>m</italic><sub><italic>A </italic></sub>- <italic>m</italic><sub><italic>B </italic></sub>&lt; Δ (<italic>m</italic><sub><italic>A </italic></sub>- <italic>m</italic><sub><italic>B </italic></sub>≥ Δ), <italic>A </italic>will score higher (lower) than <italic>B</italic>.</p>
      <table-wrap position="float" id="T17">
        <label>Table 17</label>
        <caption>
          <p>Score selection. <italic>W</italic><sub><italic>m </italic></sub>(<italic>W</italic><sub><italic>ms</italic></sub>) is the score for matching (mismatching) bases. Other notations are given in the text.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">Alignment A</td>
              <td align="left">Alignment B</td>
              <td align="center">Conditions</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">a consensus intron and no indels</td>
              <td align="left">a non-consensus intron and no indels</td>
              <td align="center">
                <inline-formula>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1745-6150-3-20-i15" overflow="scroll">
                    <mml:semantics>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>Δ</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>&lt;</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>c</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mi>c</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>m</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>&lt;</mml:mo>
                        <mml:msub>
                          <mml:mi>Δ</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:semantics>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left">a consensus intron and an indel</td>
              <td align="left">a non-consensus intron and no indels</td>
              <td align="center">
                <inline-formula>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1745-6150-3-20-i16" overflow="scroll">
                    <mml:semantics>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>Δ</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>m</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>m</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>&lt;</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>c</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mi>c</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>g</mml:mi>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>s</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>m</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>&lt;</mml:mo>
                        <mml:msub>
                          <mml:mi>Δ</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:semantics>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left">two consensus introns and no indels</td>
              <td align="left">a non-consensus intron and no indels</td>
              <td align="center">
                <inline-formula>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1745-6150-3-20-i17" overflow="scroll">
                    <mml:semantics>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>Δ</mml:mi>
                          <mml:mn>3</mml:mn>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>&lt;</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>c</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mi>c</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>m</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>&lt;</mml:mo>
                        <mml:msub>
                          <mml:mi>Δ</mml:mi>
                          <mml:mn>3</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:semantics>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left">a consensus intron and no indels</td>
              <td align="left">two consensus introns and no indels</td>
              <td align="center">
                <inline-formula>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1745-6150-3-20-i18" overflow="scroll">
                    <mml:semantics>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>Δ</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>&lt;</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>c</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>m</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>&lt;</mml:mo>
                        <mml:msub>
                          <mml:mi>Δ</mml:mi>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:semantics>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left">two consensus introns and no indels</td>
              <td align="left">a non-consensus intron and an indel</td>
              <td align="center">
                <inline-formula>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1745-6150-3-20-i19" overflow="scroll">
                    <mml:semantics>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>Δ</mml:mi>
                          <mml:mn>5</mml:mn>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>&lt;</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>c</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                                <mml:mi>c</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>g</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>s</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>m</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>&lt;</mml:mo>
                        <mml:msub>
                          <mml:mi>Δ</mml:mi>
                          <mml:mn>5</mml:mn>
                        </mml:msub>
                        <mml:mo>−</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>m</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>m</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:semantics>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left">a consensus intron and no indels</td>
              <td align="left">two consensus introns and an indel</td>
              <td align="center">
                <inline-formula>
                  <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1745-6150-3-20-i20" overflow="scroll">
                    <mml:semantics>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>Δ</mml:mi>
                          <mml:mn>6</mml:mn>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>m</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>m</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>&lt;</mml:mo>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>g</mml:mi>
                            </mml:msub>
                            <mml:mo>+</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>s</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>c</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mi>m</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>W</mml:mi>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                                <mml:mi>s</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfrac>
                        <mml:mo>&lt;</mml:mo>
                        <mml:msub>
                          <mml:mi>Δ</mml:mi>
                          <mml:mn>6</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:semantics>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>In addition to the conditions in Table <xref ref-type="table" rid="T17">17</xref>, we required the scores to satisfy</p>
      <p>
        <disp-formula><italic>W</italic><sub><italic>g</italic></sub>, <italic>W</italic><sub><italic>s</italic></sub>, <italic>W</italic><sub><italic>c</italic></sub>, <italic>W</italic><sub><italic>nc </italic></sub>&lt; 0; <italic>W</italic><sub><italic>m </italic></sub>&gt; 0; <italic>W</italic><sub><italic>c </italic></sub>&gt; <italic>W</italic><sub><italic>nc</italic></sub></disp-formula>
      </p>
      <p>Since the termini are not fixed in the alignment, the following condition is used to control the minimum length of perfectly matching terminal exons <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1745-6150-3-20-i21" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>L</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula></p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1745-6150-3-20-i22" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>W</mml:mi>
                  <mml:mi>c</mml:mi>
                </mml:msub>
                <mml:mo>&gt;</mml:mo>
                <mml:mo>−</mml:mo>
                <mml:msub>
                  <mml:mi>W</mml:mi>
                  <mml:mi>m</mml:mi>
                </mml:msub>
                <mml:mo>×</mml:mo>
                <mml:msubsup>
                  <mml:mi>L</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>n</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mi>e</mml:mi>
                    <mml:mi>r</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>Finally, the following condition was applied to improve consistency between the intron and gap scores:</p>
      <p>
        <disp-formula>|<italic>W</italic><sub><italic>nc </italic></sub>- <italic>W</italic><sub><italic>g </italic></sub>- <italic>W</italic><sub><italic>s </italic></sub>× <italic>I</italic><sub><italic>min</italic></sub>| → 0</disp-formula>
      </p>
      <p>This concludes the linear programming problem that we used to compute the scores. Since quality of EST sequences is generally lower than that of full-length mRNA sequences, Splign scores for EST alignments are computed using higher Δ constants. Using higher Δ constants means that the identity around splice sites must be higher for the algorithm to introduce less frequent alignment features such as non-consensus splices and micro-exons.</p>
    </sec>
  </sec>
  <sec>
    <title>Reviewers' comments</title>
    <sec>
      <title>Reviewer's report I</title>
      <p>Dr Steven Salzberg, University of Maryland, College Park, MD, United States</p>
      <p>This paper describes the program splign, which aligns spliced transcripts (ESTs and cDNAs) to genomic DNA. The program is very accurate and relatively fast, though not the fastest available. The authors' experiments show that for several large data sets, its performance (measured as bases aligned, or % of transcripts aligned correctly) is usually superior to several of the best alternative programs out there. Overall Splign appears to be a robust program with excellent accuracy, and a very useful "splice site aware" alignment algorithm. It is already widely used and will no doubt continue to be.</p>
      <p>All my comments and suggestions have been addressed satisfactorily.</p>
    </sec>
    <sec>
      <title>Reviewer's report II</title>
      <p>Dr Arcady Mushegian, Stowers Institute, Kansas City, KS, United States</p>
      <p>"A small fraction of mRNA sequences are deposited to GenBank as complemented strand." – what is the evidence that this fraction is small, is it higher for EST projects than for full-length cDNA projects, and can the proportion of the wrong strands be estimated? On the other hand, what if both strands are transcribed, as recent Affymetrix studies seem to suggest – any evidence of this in the data, especially perhaps evidence of splicing in the non-protein-coding strand?</p>
      <sec>
        <title>Author response</title>
        <p><italic>Indeed, we did not investigate the precise number of such mRNA sequences and therefore shall remove 'small' from the sentence. It was clear though that such sequences do exist. Some of incorrectly oriented sequences can be detected by looking for alignments in the original direction having multiple non-consensus splices, that become all-consensus, high-identity alignments when reversed and complemented. We found 240 (0.1% of the total) sequences satisfying the above condition. The assertion that the presence of such sequences may bias the experiment is even more valid if their fraction is bigger</italic>.</p>
        <p><italic>The suggestion that both strands of an mRNA can be transcribed is very interesting and deserves a separate study. In our full set, we did notice nine mRNAs with perfect, complete and all-consensus alignment in both directions</italic>.</p>
        <p>"Compartment test" – Something is missing in the description of the assay: among 9383 mRNAs, how many corresponded to the known areas of segment duplications?</p>
      </sec>
      <sec>
        <title>Author response</title>
        <p><italic>It would have been possible to build a set of sequences for this test by collecting mRNAs aligning to known areas of segment duplications. In the test we chose a different approach, in which we collected all mRNAs that were likely to align (at least partially) at more than one place per subject per strand, based on their blast hit coverage</italic>.</p>
        <p><italic>The answer to the asked question will of course depend on a specific list of known segment duplications. For example, using a list of gene clusters available at NCBI, we extracted cluster gene-associated accessions and found that 3398 (36%) accessions from Subset 2 match the list. Using a list built with the compartmentization algorithm resulted in 8923 (95%) matching accessions. A third list, based on BLAT alignments, revealed 8215 (87%) accessions in common</italic>.</p>
      </sec>
    </sec>
    <sec>
      <title>Reviewer's report III</title>
      <p>Dr Andrey Mironov, Moscow State University, Moscow, Russian Federation</p>
      <p>The paper addresses an important problem, spliced alignment of mRNAs and ESTs to genomic sequence. The problem is of special interest in context of splicing analysis. The existing algorithms of nucleotide spliced alignment are not fast and accurate enough. The authors present a new spliced alignment algorithm that involves indexing words in the genome and mRNAs, repeats filtering, comparison of the indexes and creating compartments, refinement using a dynamic programming procedure.</p>
      <p>The "Subset 1" was created using a rather weak filter. Nevertheless this subset is noticeably smaller than the full set. What is the reason for this? What part of the filter provides the strongest reduction?</p>
      <sec>
        <title>Author response</title>
        <p><italic>The ORF-related restrictions accounted for about one third of the reduction. For each of the other excluded sequences at least one method reported more than one alignment with identity at or above the threshold</italic>.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>DL conceived the project, YK, AS, TT and DL designed the algorithms and conceived the tests, YK implemented the algorithms and the complementary software, conducted the tests and wrote the paper. All authors have read and approved the final manuscript.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>We thank the NCBI genome annotation pipeline team for productive and continuing involvement, Jean Thierry-Mieg for insightful comments, and the Splign user community for helpful feedback.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haas</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Volfovsky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Town</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Troukhan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Alexandrov</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Feldmann</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Flavell</surname>
            <given-names>RB</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>Full-length messenger RNA sequences greatly improve genome annotation</article-title>
        <source>Genome Biology</source>
        <year>2002</year>
        <volume>3</volume>
        <pub-id pub-id-type="pmid">12093376</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Watanabe</surname>
            <given-names>CK</given-names>
          </name>
        </person-group>
        <article-title>GMAP: a genomic mapping and alignment program for mRNA and EST sequences</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>1859</fpage>
        <lpage>1875</lpage>
        <pub-id pub-id-type="pmid">15728110</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti310</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Florea</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hartzell</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>A computer program for aligning a cDNA sequence with a genomic DNA sequence</article-title>
        <source>Genome Research</source>
        <year>1998</year>
        <volume>8</volume>
        <fpage>967</fpage>
        <lpage>974</lpage>
        <pub-id pub-id-type="pmid">9750195</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wheelan</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Ostell</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Spidey: A tool for mRNA-to-genomic alignments</article-title>
        <source>Genome Research</source>
        <year>2001</year>
        <volume>11</volume>
        <fpage>1952</fpage>
        <lpage>1957</lpage>
        <pub-id pub-id-type="pmid">11691860</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>BLAT – the BLAST-like alignment tool</article-title>
        <source>Genome Research</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="pmid">11932250</pub-id>
        <comment>10.1101/gr.229202. Article published online before March 2002</comment>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Nimwegen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Paul</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Sheridan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Zavolan</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>SPA: a probabilistic algorithm for spliced alignment</article-title>
        <source> PLoS Genet</source>
        <year>2006</year>
        <volume>2</volume>
        <fpage>e24</fpage>
        <pub-id pub-id-type="pmid">16683023</pub-id>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.0020024</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pruitt</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Tatusova</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Maglott</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>NCBI reference sequences (RefSeq): a curated non-redundant sequence database of genomes, transcripts and proteins</article-title>
        <source>Nucleic acids research</source>
        <year>2007</year>
        <volume>35</volume>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wagner</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>A greedy algorithm for aligning DNA sequences</article-title>
        <source>Journal of Computational Biology</source>
        <year>2000</year>
        <volume>7</volume>
        <fpage>203</fpage>
        <lpage>214</lpage>
        <pub-id pub-id-type="pmid">10890397</pub-id>
        <pub-id pub-id-type="doi">10.1089/10665270050081478</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Kapustin</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Splign web site</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/sutils/splign/"/>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ning</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Mullikin</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>SSAHA: a fast search method for large DNA databases</article-title>
        <source>Genome Research</source>
        <year>2001</year>
        <volume>11</volume>
        <fpage>1725</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">11591649</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.194201</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>Journal of Molecular Biology</source>
        <year>1990</year>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Smit</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hubley</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>RepeatMasker</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.repeatmasker.org"/>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Morgulis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gertz</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Schaeffer</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Agarwala</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>WindowMasker: window-based masker for sequenced genomes</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>134</fpage>
        <lpage>141</lpage>
        <pub-id pub-id-type="pmid">16287941</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti774</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mott</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>EST_GENOME: a program to align spliced DNA sequences to unspliced genomic DNA</article-title>
        <source>Computer Applications in the Biosciences</source>
        <year>1997</year>
        <volume>13</volume>
        <fpage>477</fpage>
        <lpage>478</lpage>
        <pub-id pub-id-type="pmid">9283765</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gelfand</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Mironov</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>A</surname>
            <given-names>PP</given-names>
          </name>
        </person-group>
        <article-title>Gene recognition via spliced sequence alignment</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1996</year>
        <volume>93</volume>
        <fpage>9061</fpage>
        <lpage>9066</lpage>
        <pub-id pub-id-type="pmid">8799154</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.93.17.9061</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
