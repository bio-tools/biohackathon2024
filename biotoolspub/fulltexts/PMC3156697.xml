<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3156697</article-id>
    <article-id pub-id-type="pmid">21857909</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-11-06742</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0021931</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Biophysics</subject>
          <subj-group>
            <subject>Biophysics Simulations</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Biological Data Management</subject>
            <subject>Biophysic Al Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Real-Time PyMOL Visualization for Rosetta and PyRosetta</article-title>
      <alt-title alt-title-type="running-head">Real-Time PyMOL Visualization for Rosetta</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Baugh</surname>
          <given-names>Evan H.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lyskov</surname>
          <given-names>Sergey</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weitzner</surname>
          <given-names>Brian D.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gray</surname>
          <given-names>Jeffrey J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Department of Chemical and Biomolecular Engineering, The Johns Hopkins University, Baltimore, Maryland, United States of America</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Program in Molecular Biophysics, The Johns Hopkins University, Baltimore, Maryland, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Uversky</surname>
          <given-names>Vladimir N.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">University of South Florida, United States of America</aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>pyrosetta@graylab.jhu.edu</email></corresp>
      <fn fn-type="con">
        <p>Wrote the paper: EHB SL BW JJG.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>8</month>
      <year>2011</year>
    </pub-date>
    <volume>6</volume>
    <issue>8</issue>
    <elocation-id>e21931</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>4</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>6</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Baugh et al.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Computational structure prediction and design of proteins and protein-protein complexes have long been inaccessible to those not directly involved in the field. A key missing component has been the ability to visualize the progress of calculations to better understand them. Rosetta is one simulation suite that would benefit from a robust real-time visualization solution. Several tools exist for the sole purpose of visualizing biomolecules; one of the most popular tools, PyMOL (Schrödinger), is a powerful, highly extensible, user friendly, and attractive package. Integrating Rosetta and PyMOL directly has many technical and logistical obstacles inhibiting usage. To circumvent these issues, we developed a novel solution based on transmitting biomolecular structure and energy information via UDP sockets. Rosetta and PyMOL run as separate processes, thereby avoiding many technical obstacles while visualizing information on-demand in real-time. When Rosetta detects changes in the structure of a protein, new coordinates are sent over a UDP network socket to a PyMOL instance running a UDP socket listener. PyMOL then interprets and displays the molecule. This implementation also allows remote execution of Rosetta. When combined with PyRosetta, this visualization solution provides an interactive environment for protein structure prediction and design.</p>
    </abstract>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>The Rosetta software suite, an object-oriented protein structure prediction tool <xref rid="pone.0021931-LeaverFay1" ref-type="bibr">[1]</xref>, can effectively perform protein structure prediction and design <xref rid="pone.0021931-Das1" ref-type="bibr">[2]</xref>
<xref rid="pone.0021931-Kaufmann1" ref-type="bibr">[3]</xref>. Common tasks such as design, docking, and folding produce text files containing the Cartesian coordinates of each atom of the protein. Molecular visualization tools are used later to interpret the output <xref rid="pone.0021931-ODonoghue1" ref-type="bibr">[4]</xref>. Thus, visualization is typically separated from Rosetta. Output structures could be viewed after a simulation, but not during a calculation or protocol. Real-time structural visualization would facilitate development of new methods and make Rosetta more accessible to new users.</p>
    <p>Rosetta protocols are useful to a broad range of scientists, but many protocols are complex. Scientists who are not trained in computation can become frustrated with Rosetta's steep learning curve. Two new interfaces to Rosetta were built to bridge this gap. PyRosetta <xref rid="pone.0021931-Chaudhury1" ref-type="bibr">[5]</xref> is a Python-based interface to Rosetta objects and protocols enabling users to easily develop custom algorithms and to explore Rosetta through the Python interpreter. RosettaScripts <xref rid="pone.0021931-Fleishman1" ref-type="bibr">[6]</xref> provides an XML-scriptable interface to Rosetta allowing users to design custom algorithms. PyRosetta and RosettaScripts have successfully lowered the barrier to learn Rosetta by providing an interactive and scriptable layer. To further improve access to Rosetta, the next step is to provide an intuitive way of observing protocols with elegant informative graphics.</p>
    <p>Several visualization tools have been previously employed which were ideal for some users, but lacked universal appeal. FoldIt <xref rid="pone.0021931-Cooper1" ref-type="bibr">[7]</xref> is a Rosetta-based interactive video game with rich graphics intended for end users to explore protein structures and energetics. It does not allow the loading of arbitrary proteins, lacks access to many Rosetta features, and removes the user from the underlying code, so it is not appropriate as a development environment. Rosetta graphics mode is an undocumented optional feature of Rosetta protocols used by the internal Rosetta community for error checking. Running a protocol in graphics mode produces an image of the manipulated structure, enabling the viewer to see changes, but not to interact with them. Using graphics mode requires knowledge of the Rosetta build system, limiting it to advanced users and developers. PyMOL <xref rid="pone.0021931-DeLano1" ref-type="bibr">[8]</xref> has a very large user base, is not restricted to the visualization of Rosetta output, and is maintained by Schrödinger, but viewing Rosetta structures in PyMOL requires outputting the atomic coordinates to a PDB file and then loading it into PyMOL. A new software plug-in called ePMV <xref rid="pone.0021931-Johnson1" ref-type="bibr">[9]</xref> unifies and visualizes molecular and cellular simulations including Rosetta.</p>
    <p>In this paper, we describe a new solution that allows real-time visualization of Rosetta via PyMOL using UDP network sockets. The versatile communication presents structural and energetic information on demand making Rosetta more accessible to all users.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <p>Since both PyRosetta and PyMOL are Python-based, a possible visualization solution is to run PyRosetta from within the PyMOL interpreter window. However, Python is notorious for compatibility issues between different versions, and thus technical obstacles prevent a robust implementation of this idea. We developed a completely different approach: use a network protocol to transfer data from PyRosetta to PyMOL (<xref ref-type="fig" rid="pone-0021931-g001">Figure 1</xref>). Both TCP/IP and UDP/IP implementations were viable. The latter was chosen because it does not require implicit “hand-shaking” and tolerates lost transmissions, making it more robust. Both programs can transmit, open or close, and even crash without dependence on the other. Accordingly, since the UDP protocol does not guarantee reliability, data must be validated for proper delivery. Restrictions on packet size also forces large packets to be split and sent separately.</p>
    <fig id="pone-0021931-g001" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0021931.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Rosetta-PyMOL network communication.</title>
        <p>Rosetta transmits data through the PyMOL_Mover's UDP/IP socket client to an IP address. Dotted arrows represent network communication and diamonds represent composition (e.g. the PyMOL Observer contains a PyMOL Mover and an [owning pointer to a] Pose). The PyMOL Observer monitors changes in a Pose and uses the PyMOL Mover to transmit this information to PyMOL. The UDP/IP socket server running in PyMOL listens for network traffic and translates appropriate packets. Once the data is translated, PyMOL displays biomolecular structures.</p>
      </caption>
      <graphic xlink:href="pone.0021931.g001"/>
    </fig>
    <p>A Python script running in PyMOL provides a server that listens for incoming UDP/IP traffic. Each packet (<xref ref-type="table" rid="pone-0021931-t001">Table 1</xref>) is recognized by this server, and specific actions, such as coloring or model construction, occur when the server receives a complete packet. Accumulated packets could be fragments of a large data transfer, and the desired action happens only once all pieces are assembled. Data from different PyRosetta instances and errors in network communication can confuse interpretation, so any incomplete information received is held in memory briefly and later, if necessary, released in the rare case that a message is aborted.</p>
    <table-wrap id="pone-0021931-t001" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0021931.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Packet structure.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0021931-t001-1" xlink:href="pone.0021931.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Size</td>
              <td align="left" rowspan="1" colspan="1">Description</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">(bytes)</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">16</td>
              <td align="left" rowspan="1" colspan="1">UUID of the sender</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">Unique packet id for this sender/packet</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">Sub-packet id</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">Total number of sub-packets</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">8</td>
              <td align="left" rowspan="1" colspan="1">Type of packet (8 byte string) e.g.: “PDB.bz2”, “Ener.bz2”, “PDB.gzip”, or “Ene.gzip”</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">Flag indicating whether PyMOL should load the PDB into the current state or the next state</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1+N</td>
              <td align="left" rowspan="1" colspan="1">Length of model name in bytes + name (N)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1+N</td>
              <td align="left" rowspan="1" colspan="1">Length of energy name in bytes + name (N)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">X</td>
              <td align="left" rowspan="1" colspan="1">Compressed packet data, a PDB file string or energy float array compressed with bz2 or gzip</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p>Rosetta's preexisting Mover architecture is suited to manage the communication because a Mover can accept a pose (Rosetta's container for a molecular object) and perform operations on the pose data. Using the Mover architecture is intuitive for Rosetta users and allows the PyMOL_Mover to interact with other Rosetta objects. The PyMOL_Mover is a simple network client which sends protein structure and energy information when its apply() method is invoked. Rosetta builds each data packet in a specific order (<xref ref-type="table" rid="pone-0021931-t001">Table 1</xref>) for recognition by the PyMOL listener. We considered sending Python commands directly to PyMOL, however, restricting communication to specific packets reduces security risks since PyMOL only understands and performs a small set of commands.</p>
    <sec id="s2a">
      <title>Software Availability</title>
      <p>The PyMOL script to interpret Rosetta results is included with Rosetta (/mini/src/python/bindings) and PyRosetta (root directory). Rosetta is available for download at <ext-link ext-link-type="uri" xlink:href="http://www.rosettacommons.org/">http://www.rosettacommons.org/</ext-link>. PyRosetta is available for download at <ext-link ext-link-type="uri" xlink:href="http://www.pyrosetta.org">http://www.pyrosetta.org</ext-link>. The PyMOL_Mover is contained in Rosetta beginning with release 3.2 (revision 37389). Both programs have free licenses for academic and nonprofit institutions. PyMOL mus be obtained from Schrödinger (the PyMOL_ Mover has been successfully tested with PyMOL versions 1.0, 1.2, and 1.3).</p>
    </sec>
    <sec id="s2b">
      <title>Protocol Capture</title>
      <p>Proper usage requires (1) a sender, Rosetta or PyRosetta, with the PyMOL_Mover; and (2) a listener, PyMOL, with the listener script. We first demonstrate how to setup the PyMOL server features. Then we present examples of PyMOL_Mover usage with PyRosetta. Finally, we explain how to incorporate the PyMOL_ Mover into Rosetta protocols.</p>
      <sec id="s2b1">
        <title>PyMOL Protocol</title>
        <p>After loading PyMOL, use the command line (e.g. Tk Window Upper Command Line) to run the script PyMOLPyRosettaServer.py to start the listener:</p>
        <disp-quote>
          <p>run /path/to/PyRosetta/PyMOLPyRosettaServer.py</p>
          <p>run/path/to/Rosetta/mini/src/python/bindings/PyMOLPyRosettaServer.py</p>
        </disp-quote>
        <p>If desired, Rosetta and PyMOL can run on different computers. In this case, PyMOL must link to a new IP address using the start_rosetta_server command with the desired IP address and port number as arguments. A single instance of PyMOL can listen to multiple IP addresses or ports by invoking start_rosetta_server multiple times with different arguments.</p>
        <disp-quote>
          <p>start_rosetta_server 125.1.3.37, 9001</p>
        </disp-quote>
      </sec>
      <sec id="s2b2">
        <title>PyRosetta Protocol</title>
        <p>In Rosetta and PyRosetta, a macromolecule (and information on a single conformation) is stored in a pose object. To explore the PyMOL_Mover, a user will start PyRosetta and create a pose object from a PDB file.</p>
        <disp-quote>
          <p>from rosetta import*</p>
          <p>init()</p>
          <p>pose = Pose() pose = pose_from_pdb(pose,“test_dock.pdb”)</p>
        </disp-quote>
        <p>When the PyMOL_Mover is applied to a pose, the pose coordinate data is sent to PyMOL rendering an image of the structure.</p>
        <disp-quote>
          <p>pymover = PyMOL_Mover()</p>
          <p>pymover.apply(pose)</p>
        </disp-quote>
        <p>The PyMOL_Mover can be applied repeatedly throughout a custom protocol to update coordinates in the PyMOL window. In this way, a user can view any intermediate step throughout a structure prediction or design protocol.</p>
        <p>To color the loaded structure based on the relative residue energies, a PyMOL_Mover.send_energy method is provided. The pose must have been scored before applying the PyMOL_Mover. Using the PDB file test_in.pdb (provided in <xref ref-type="supplementary-material" rid="pone.0021931.s001">File S1</xref>) with these commands demonstrates Rosetta's ability to recognize high-energy protein regions (<xref ref-type="fig" rid="pone-0021931-g002">Figure 2</xref>).</p>
        <fig id="pone-0021931-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0021931.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Example PyMOL structure.</title>
            <p>An example of the crystal structure in decoy test_in.pdb, available with Rosetta, as output by the PyMOL_Mover. The residues are colored based on their energy evaluation with the standard Rosetta score function ranging from red (high energy) to blue (low energy). One loop region scores noticeably higher than other residues in the protein.</p>
          </caption>
          <graphic xlink:href="pone.0021931.g002"/>
        </fig>
        <disp-quote>
          <p>scorefxn = create_score_function(“standard”)</p>
          <p>scorefxn(pose)</p>
          <p>pymover.apply(pose)</p>
          <p>pymover.send_energy(pose)</p>
        </disp-quote>
        <p>The default color spectrum spans from blue (low score/favorable energy) to red (high score/unfavorable energy). Rosetta scores are determined using a weighted sum of various score terms. The send_energy method can accept the name of any score term and color residues based on this term as long as it is used in the current score function (i.e. a non-zero weight). This example colors the residues based on the value of their (all-atom) Van der Waals attractive energy:</p>
        <disp-quote>
          <p>pymover.send_energy(pose,“fa_atr”)</p>
        </disp-quote>
        <p>The PyMOL_Mover can also automatically color residues by energy every time the coordinates are transmitted by setting the update_energy option to true.</p>
        <disp-quote>
          <p>pymover.update_energy = True</p>
          <p>pymover.apply(pose)</p>
        </disp-quote>
        <p>The PyMOL_Mover can transmit a specific score term with the coordinates during an apply() command if the energy_type option is set and update_energy is true. This example colors the residues based on the value of their (all-atom) solvation energy every time the PyMOL_Mover is applied:</p>
        <disp-quote>
          <p>pymover.update_energy = True</p>
          <p>pymover.energy_type = “fa_sol”</p>
          <p>pymover.apply(pose)</p>
        </disp-quote>
        <p>To send PyMOL_Mover output to a PyMOL instance on a different computer, the PyMOL_Mover.link options can be modified:</p>
        <disp-quote>
          <p>pymover.link.udp_ip = “125.1.3.37”</p>
          <p>pymover.link.udp_port = 9001</p>
        </disp-quote>
        <p>If the PyMOL_Mover's keep_history option is set true, PyMOL will load structures with the same name (pose.pdb_info().name()) into successive states.</p>
        <disp-quote>
          <p>pymover.keep_history = True</p>
          <p>pymover.apply(pose)</p>
          <p>other_mover.apply(pose)</p>
          <p>pymover.apply(pose)</p>
        </disp-quote>
        <p>In PyMOL, the object states can be viewed as a movie which reveals the Rosetta protocol actions. The output can easily be converted into a movie using PyMOL's frame and movie building features.</p>
        <p>In the previous examples, PyMOL updates have been manually transmitted using PyMOL_Mover.apply(). The PyMOL_Observer object automatically monitors a pose conformation and applies its own PyMOL_Mover every time the pose coordinates are changed. Since a PyMOL_Observer has a PyMOL_Mover, all of the PyMOL_Mover options are available.</p>
        <disp-quote>
          <p>pyobs = PyMOL_Observer()</p>
          <p>pyobs.add_observer(pose)</p>
          <p>pyobs.pymol.update_energy = True</p>
        </disp-quote>
        <p>A sample Python script demonstrating how to use the PyMOL_Mover for making movies is PyRosettaDock_Movie.py in <xref ref-type="supplementary-material" rid="pone.0021931.s001">File S1</xref>. <xref ref-type="supplementary-material" rid="pone.0021931.s001">File S1</xref> also includes a more in-depth tutorial script, PyMOL_demo.py, and a copy of the listener, PyMOLPyRosettaServer.py.</p>
      </sec>
      <sec id="s2b3">
        <title>Rosetta Protocols</title>
        <p>All PyRosetta features can also be accessed in the Rosetta C++ code by using appropriate C++ syntax and changes including the namespace.</p>
        <disp-quote>
          <p>#include &lt;protocols/moves/PyMOL_Mover.hh&gt;</p>
          <p>core::protocols::moves::AddPyMOLObserver(pose)</p>
        </disp-quote>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results and Discussion</title>
    <p>Rosetta output to PyMOL is now available on-demand and continuously. Two separate objects have been implemented with Rosetta's object-oriented framework. The PyMOL_Mover object sends data to PyMOL and allows the user to observe visual output on-demand. This implementation is ideal for interactive environments and allows instant feedback from custom processes. New users can now experiment with Rosetta structures and protocols while immediately viewing their changes.</p>
    <p>A second object, the PyMOL_Observer, can be attached to a Rosetta biomolecule (pose) to monitor all structural changes. When a coordinate is updated, the observer uses an embedded PyMOL_Mover to transmit the new structure to PyMOL. This implementation is ideal for elaborate scripts where manual management of output is prohibitive. Furthermore, the observer can be added to previously developed protocols, providing visual output with minimal modification. One limitation is that continuous PyMOL packet construction can slow Rosetta calculations. To mitigate this delay, a user can optionally output coordinates at particular time or coordinate-update intervals (see documentation).</p>
    <p>In addition to being a useful tool to display protein structures, PyMOL is well suited for the production of informative movies. Rosetta simulations are often presented visually to demonstrate or explain the principles underlying Rosetta algorithms. Previously, making movies of Rosetta protocols required significant work. When sending data to PyMOL, the user may simply retain output history to produce PyMOL movies. The history feature also allows the user to inspect protocols that are otherwise inaccessible.</p>
    <p>The PyMOL_Mover can also color residues allowing easy recognition of energetic features and design anomalies. Although only Rosetta score values are currently supported, any relevant data calculated in Rosetta may be sent to PyMOL using this interface. Additional features can be added easily for the visualization of other Rosetta data as long as these data packets carry specific tags for PyMOL to translate.</p>
    <p>The UDP/IP client utilization has several advantages. PyMOL can be customized to receive information from multiple instances of Rosetta. Communication is not limited by the operating environments of either the sender or the receiver. Data can be successfully interpreted between different operating systems (e.g. Linux to Windows), Python versions, and even buildings. A single Rosetta process can transmit data to multiple IP addresses or ports using multiple PyMOL_Movers, allowing visualization on multiple computers. This versatility reduces communication errors and allows users to share information easily. Running each program separately prevents either from losing focus; Rosetta performs simulations and calculations while PyMOL performs visualization.</p>
    <p>The ability to view processes in real-time can easily produce relevant examples for presentations and demonstrations. The UDP solution is inherently unrestricted and is potentially applicable to numerous other applications. Additional protein modeling software such as the SWISS-MODEL server <xref rid="pone.0021931-Schwede1" ref-type="bibr">[10]</xref>, CHARMM <xref rid="pone.0021931-Brooks1" ref-type="bibr">[11]</xref>, and NAMD <xref rid="pone.0021931-Wang1" ref-type="bibr">[12]</xref> could also output to PyMOL with socket export. Similarly, other graphical software such VMD <xref rid="pone.0021931-Humphrey1" ref-type="bibr">[13]</xref>, RasMol <xref rid="pone.0021931-Sayle1" ref-type="bibr">[14]</xref>, Deep View <xref rid="pone.0021931-Guex1" ref-type="bibr">[15]</xref>, Kinemage <xref rid="pone.0021931-Richardson1" ref-type="bibr">[16]</xref> could interpret and display data packets sent from Rosetta by listening to output from a socket. If such practices become widespread, communication using program independent packet structures could lead to a standardized macromolecular visualization markup language.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s4">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0021931.s001">
      <label>File S1</label>
      <caption>
        <p><bold>A summary of the supplemental files contained in the compressed directory <xref ref-type="supplementary-material" rid="pone.0021931.s001">File S1</xref>, including the PyMOL listener, sample scripts with their data files, and a representative movie of the script output.</bold> README: a brief tutorial to the PyMOL_Mover and these scripts. PyRosettaDock.mp4: a PyMOL movie of Rosetta's Docking Protocol. input_files/: PDB files used in the demo scripts. test_dock.pdb a modified 1ACB <xref rid="pone.0021931-Frigerioa1" ref-type="bibr">[17]</xref> PDB file used in PyRosettaDock_Movie.py. test_in.pdb the decoy file PDB used in PyMOL_demo.py. scripts/: sample PyRosetta syntax for using the PyMOL_Mover. PyMOLPyRosettaServer.py listener script for PyMOL. PyRosettaDock_Movie.py sample protocol to create a docking movie. PyMOL_demo.py numerous PyRosetta sample commands with the PyMOL_Mover.</p>
        <p>(TAR.BZ2)</p>
      </caption>
      <media xlink:href="pone.0021931.s001.tar.bz2">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We acknowledge the enabling efforts of the developers within RosettaCommons who have contributed the scientific research and software development to Rosetta and PyRosetta.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement">
      <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
    </fn>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding: </bold>Funding was provided by National Institutes of Health grant R01-GM073151 and a National Science Foundation CAREER grant to JJG (CBET 0846324). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="pone.0021931-LeaverFay1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leaver-Fay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tyka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lange</surname>
            <given-names>OF</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2011</year>
        <article-title>ROSETTA3: An objectoriented software suite for the simulation and design of macromolecules.</article-title>
        <source>Methods in Enzymology</source>
        <volume>487</volume>
        <fpage>548</fpage>
        <lpage>574</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Das1">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Macromolecular modeling with Rosetta.</article-title>
        <source>Biochemistry</source>
        <volume>77</volume>
        <fpage>363</fpage>
        <lpage>382</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Kaufmann1">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaufmann</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Lemmon</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>DeLuca</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Sheehan</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Meiler</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Practically useful: What the Rosetta protein modeling suite can do for you.</article-title>
        <source>Biochemistry</source>
        <volume>49</volume>
        <fpage>2987</fpage>
        <lpage>2998</lpage>
        <pub-id pub-id-type="pmid">20235548</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-ODonoghue1">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O'Donoghue</surname>
            <given-names>SI</given-names>
          </name>
          <name>
            <surname>Goodsell</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Frangakis</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Jossinet</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Laskowski</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Visualization of macromolecular structures.</article-title>
        <source>Nature Methods</source>
        <volume>7</volume>
        <fpage>S42</fpage>
        <lpage>S55</lpage>
        <pub-id pub-id-type="pmid">20195256</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Chaudhury1">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaudhury</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lyskov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>PyRosetta: a script-based interface for implementing molecular modeling algorithms using Rosetta.</article-title>
        <source>Bioinformatics</source>
        <volume>26</volume>
        <fpage>689</fpage>
        <lpage>691</lpage>
        <pub-id pub-id-type="pmid">20061306</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Fleishman1">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fleishman</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Leaver-Fay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Corn</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Khare</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Koga</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2011</year>
        <article-title>RosettaScripts: an XMLlike interface to the Rosetta macromolecular modeling suite.</article-title>
        <source>Plos ONE</source>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Cooper1">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cooper</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khatib</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Treuille</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Barbero</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Predicting protein structures with a multiplayer online game.</article-title>
        <source>Nature</source>
        <volume>466</volume>
        <fpage>756</fpage>
        <lpage>760</lpage>
        <pub-id pub-id-type="pmid">20686574</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-DeLano1">
      <label>8</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>DeLano</surname>
            <given-names>WL</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>PyMOL molecular graphics system.</article-title>
        <comment>Available at: <ext-link ext-link-type="uri" xlink:href="http://www.pymol.org">http://www.pymol.org</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Johnson1">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Autin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Goodsell</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Sanner</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>ePMV Embeds Molecular Modeling into Professional Animation Software Environments.</article-title>
        <source>Structure</source>
        <volume>19</volume>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Schwede1">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwede</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kopp</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Guex</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Peitsch</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>SWISS-MODEL: An automated protein homologymodeling server.</article-title>
        <source>Nucleic Acids Research</source>
        <volume>31</volume>
        <fpage>3381</fpage>
        <lpage>3385</lpage>
        <pub-id pub-id-type="pmid">12824332</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Brooks1">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brooks</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Bruccoleri</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Olafson</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>States</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Swaminathan</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <year>1983</year>
        <article-title>CHARMM: A program for macromolecular energy, minimization, and dynamics calculations.</article-title>
        <source>Computational Chemistry</source>
        <volume>4</volume>
        <fpage>187</fpage>
        <lpage>217</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Wang1">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Schulten</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>McCammon</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>Implementation of accelerated molecular dynamics in NAMD.</article-title>
        <source>Computational Science and Discovery</source>
        <volume>4</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Humphrey1">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Humphrey</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Dalke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schulten</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <year>1996</year>
        <article-title>VMD: Visual molecular dynamics.</article-title>
        <source>Molecular Graphics</source>
        <volume>14</volume>
        <fpage>33</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="pmid">8744570</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Sayle1">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sayle</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Milner-White</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <year>1995</year>
        <article-title>RasMol: Biomolecular graphics for all.</article-title>
        <source>Trends in Biochemical Sciences</source>
        <volume>20</volume>
        <fpage>374</fpage>
        <lpage>376</lpage>
        <pub-id pub-id-type="pmid">7482707</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Guex1">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guex</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Peitsch</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <year>1997</year>
        <article-title>SWISS-MODEL and the Swiss-PDB Viewer: An environment for comparative protein modeling.</article-title>
        <source>Electrophoresis</source>
        <volume>18</volume>
        <fpage>2714</fpage>
        <lpage>2723</lpage>
        <pub-id pub-id-type="pmid">9504803</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Richardson1">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richardson</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <year>1992</year>
        <article-title>The Kinemage: A tool for scientific communication.</article-title>
        <source>Protein Science</source>
        <volume>1</volume>
        <fpage>3</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">1304880</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Frigerioa1">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frigerioa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Codab</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Puglieseb</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lionettib</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Menegattic</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <year>1992</year>
        <article-title>Crystal and molecular structure of the bovine <italic>α</italic>-chymotrypsin-eglin c complex at 2.0 Å resolution.</article-title>
        <source>Journal of Molecular Biology</source>
        <volume>255</volume>
        <fpage>107</fpage>
        <lpage>123</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3156697</article-id>
    <article-id pub-id-type="pmid">21857909</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-11-06742</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0021931</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Biophysics</subject>
          <subj-group>
            <subject>Biophysics Simulations</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Biological Data Management</subject>
            <subject>Biophysic Al Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Real-Time PyMOL Visualization for Rosetta and PyRosetta</article-title>
      <alt-title alt-title-type="running-head">Real-Time PyMOL Visualization for Rosetta</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Baugh</surname>
          <given-names>Evan H.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lyskov</surname>
          <given-names>Sergey</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weitzner</surname>
          <given-names>Brian D.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gray</surname>
          <given-names>Jeffrey J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Department of Chemical and Biomolecular Engineering, The Johns Hopkins University, Baltimore, Maryland, United States of America</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Program in Molecular Biophysics, The Johns Hopkins University, Baltimore, Maryland, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Uversky</surname>
          <given-names>Vladimir N.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">University of South Florida, United States of America</aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>pyrosetta@graylab.jhu.edu</email></corresp>
      <fn fn-type="con">
        <p>Wrote the paper: EHB SL BW JJG.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>8</month>
      <year>2011</year>
    </pub-date>
    <volume>6</volume>
    <issue>8</issue>
    <elocation-id>e21931</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>4</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>6</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Baugh et al.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Computational structure prediction and design of proteins and protein-protein complexes have long been inaccessible to those not directly involved in the field. A key missing component has been the ability to visualize the progress of calculations to better understand them. Rosetta is one simulation suite that would benefit from a robust real-time visualization solution. Several tools exist for the sole purpose of visualizing biomolecules; one of the most popular tools, PyMOL (Schrödinger), is a powerful, highly extensible, user friendly, and attractive package. Integrating Rosetta and PyMOL directly has many technical and logistical obstacles inhibiting usage. To circumvent these issues, we developed a novel solution based on transmitting biomolecular structure and energy information via UDP sockets. Rosetta and PyMOL run as separate processes, thereby avoiding many technical obstacles while visualizing information on-demand in real-time. When Rosetta detects changes in the structure of a protein, new coordinates are sent over a UDP network socket to a PyMOL instance running a UDP socket listener. PyMOL then interprets and displays the molecule. This implementation also allows remote execution of Rosetta. When combined with PyRosetta, this visualization solution provides an interactive environment for protein structure prediction and design.</p>
    </abstract>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>The Rosetta software suite, an object-oriented protein structure prediction tool <xref rid="pone.0021931-LeaverFay1" ref-type="bibr">[1]</xref>, can effectively perform protein structure prediction and design <xref rid="pone.0021931-Das1" ref-type="bibr">[2]</xref>
<xref rid="pone.0021931-Kaufmann1" ref-type="bibr">[3]</xref>. Common tasks such as design, docking, and folding produce text files containing the Cartesian coordinates of each atom of the protein. Molecular visualization tools are used later to interpret the output <xref rid="pone.0021931-ODonoghue1" ref-type="bibr">[4]</xref>. Thus, visualization is typically separated from Rosetta. Output structures could be viewed after a simulation, but not during a calculation or protocol. Real-time structural visualization would facilitate development of new methods and make Rosetta more accessible to new users.</p>
    <p>Rosetta protocols are useful to a broad range of scientists, but many protocols are complex. Scientists who are not trained in computation can become frustrated with Rosetta's steep learning curve. Two new interfaces to Rosetta were built to bridge this gap. PyRosetta <xref rid="pone.0021931-Chaudhury1" ref-type="bibr">[5]</xref> is a Python-based interface to Rosetta objects and protocols enabling users to easily develop custom algorithms and to explore Rosetta through the Python interpreter. RosettaScripts <xref rid="pone.0021931-Fleishman1" ref-type="bibr">[6]</xref> provides an XML-scriptable interface to Rosetta allowing users to design custom algorithms. PyRosetta and RosettaScripts have successfully lowered the barrier to learn Rosetta by providing an interactive and scriptable layer. To further improve access to Rosetta, the next step is to provide an intuitive way of observing protocols with elegant informative graphics.</p>
    <p>Several visualization tools have been previously employed which were ideal for some users, but lacked universal appeal. FoldIt <xref rid="pone.0021931-Cooper1" ref-type="bibr">[7]</xref> is a Rosetta-based interactive video game with rich graphics intended for end users to explore protein structures and energetics. It does not allow the loading of arbitrary proteins, lacks access to many Rosetta features, and removes the user from the underlying code, so it is not appropriate as a development environment. Rosetta graphics mode is an undocumented optional feature of Rosetta protocols used by the internal Rosetta community for error checking. Running a protocol in graphics mode produces an image of the manipulated structure, enabling the viewer to see changes, but not to interact with them. Using graphics mode requires knowledge of the Rosetta build system, limiting it to advanced users and developers. PyMOL <xref rid="pone.0021931-DeLano1" ref-type="bibr">[8]</xref> has a very large user base, is not restricted to the visualization of Rosetta output, and is maintained by Schrödinger, but viewing Rosetta structures in PyMOL requires outputting the atomic coordinates to a PDB file and then loading it into PyMOL. A new software plug-in called ePMV <xref rid="pone.0021931-Johnson1" ref-type="bibr">[9]</xref> unifies and visualizes molecular and cellular simulations including Rosetta.</p>
    <p>In this paper, we describe a new solution that allows real-time visualization of Rosetta via PyMOL using UDP network sockets. The versatile communication presents structural and energetic information on demand making Rosetta more accessible to all users.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <p>Since both PyRosetta and PyMOL are Python-based, a possible visualization solution is to run PyRosetta from within the PyMOL interpreter window. However, Python is notorious for compatibility issues between different versions, and thus technical obstacles prevent a robust implementation of this idea. We developed a completely different approach: use a network protocol to transfer data from PyRosetta to PyMOL (<xref ref-type="fig" rid="pone-0021931-g001">Figure 1</xref>). Both TCP/IP and UDP/IP implementations were viable. The latter was chosen because it does not require implicit “hand-shaking” and tolerates lost transmissions, making it more robust. Both programs can transmit, open or close, and even crash without dependence on the other. Accordingly, since the UDP protocol does not guarantee reliability, data must be validated for proper delivery. Restrictions on packet size also forces large packets to be split and sent separately.</p>
    <fig id="pone-0021931-g001" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0021931.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Rosetta-PyMOL network communication.</title>
        <p>Rosetta transmits data through the PyMOL_Mover's UDP/IP socket client to an IP address. Dotted arrows represent network communication and diamonds represent composition (e.g. the PyMOL Observer contains a PyMOL Mover and an [owning pointer to a] Pose). The PyMOL Observer monitors changes in a Pose and uses the PyMOL Mover to transmit this information to PyMOL. The UDP/IP socket server running in PyMOL listens for network traffic and translates appropriate packets. Once the data is translated, PyMOL displays biomolecular structures.</p>
      </caption>
      <graphic xlink:href="pone.0021931.g001"/>
    </fig>
    <p>A Python script running in PyMOL provides a server that listens for incoming UDP/IP traffic. Each packet (<xref ref-type="table" rid="pone-0021931-t001">Table 1</xref>) is recognized by this server, and specific actions, such as coloring or model construction, occur when the server receives a complete packet. Accumulated packets could be fragments of a large data transfer, and the desired action happens only once all pieces are assembled. Data from different PyRosetta instances and errors in network communication can confuse interpretation, so any incomplete information received is held in memory briefly and later, if necessary, released in the rare case that a message is aborted.</p>
    <table-wrap id="pone-0021931-t001" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0021931.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Packet structure.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0021931-t001-1" xlink:href="pone.0021931.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Size</td>
              <td align="left" rowspan="1" colspan="1">Description</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">(bytes)</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">16</td>
              <td align="left" rowspan="1" colspan="1">UUID of the sender</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">Unique packet id for this sender/packet</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">Sub-packet id</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">Total number of sub-packets</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">8</td>
              <td align="left" rowspan="1" colspan="1">Type of packet (8 byte string) e.g.: “PDB.bz2”, “Ener.bz2”, “PDB.gzip”, or “Ene.gzip”</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">Flag indicating whether PyMOL should load the PDB into the current state or the next state</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1+N</td>
              <td align="left" rowspan="1" colspan="1">Length of model name in bytes + name (N)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1+N</td>
              <td align="left" rowspan="1" colspan="1">Length of energy name in bytes + name (N)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">X</td>
              <td align="left" rowspan="1" colspan="1">Compressed packet data, a PDB file string or energy float array compressed with bz2 or gzip</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p>Rosetta's preexisting Mover architecture is suited to manage the communication because a Mover can accept a pose (Rosetta's container for a molecular object) and perform operations on the pose data. Using the Mover architecture is intuitive for Rosetta users and allows the PyMOL_Mover to interact with other Rosetta objects. The PyMOL_Mover is a simple network client which sends protein structure and energy information when its apply() method is invoked. Rosetta builds each data packet in a specific order (<xref ref-type="table" rid="pone-0021931-t001">Table 1</xref>) for recognition by the PyMOL listener. We considered sending Python commands directly to PyMOL, however, restricting communication to specific packets reduces security risks since PyMOL only understands and performs a small set of commands.</p>
    <sec id="s2a">
      <title>Software Availability</title>
      <p>The PyMOL script to interpret Rosetta results is included with Rosetta (/mini/src/python/bindings) and PyRosetta (root directory). Rosetta is available for download at <ext-link ext-link-type="uri" xlink:href="http://www.rosettacommons.org/">http://www.rosettacommons.org/</ext-link>. PyRosetta is available for download at <ext-link ext-link-type="uri" xlink:href="http://www.pyrosetta.org">http://www.pyrosetta.org</ext-link>. The PyMOL_Mover is contained in Rosetta beginning with release 3.2 (revision 37389). Both programs have free licenses for academic and nonprofit institutions. PyMOL mus be obtained from Schrödinger (the PyMOL_ Mover has been successfully tested with PyMOL versions 1.0, 1.2, and 1.3).</p>
    </sec>
    <sec id="s2b">
      <title>Protocol Capture</title>
      <p>Proper usage requires (1) a sender, Rosetta or PyRosetta, with the PyMOL_Mover; and (2) a listener, PyMOL, with the listener script. We first demonstrate how to setup the PyMOL server features. Then we present examples of PyMOL_Mover usage with PyRosetta. Finally, we explain how to incorporate the PyMOL_ Mover into Rosetta protocols.</p>
      <sec id="s2b1">
        <title>PyMOL Protocol</title>
        <p>After loading PyMOL, use the command line (e.g. Tk Window Upper Command Line) to run the script PyMOLPyRosettaServer.py to start the listener:</p>
        <disp-quote>
          <p>run /path/to/PyRosetta/PyMOLPyRosettaServer.py</p>
          <p>run/path/to/Rosetta/mini/src/python/bindings/PyMOLPyRosettaServer.py</p>
        </disp-quote>
        <p>If desired, Rosetta and PyMOL can run on different computers. In this case, PyMOL must link to a new IP address using the start_rosetta_server command with the desired IP address and port number as arguments. A single instance of PyMOL can listen to multiple IP addresses or ports by invoking start_rosetta_server multiple times with different arguments.</p>
        <disp-quote>
          <p>start_rosetta_server 125.1.3.37, 9001</p>
        </disp-quote>
      </sec>
      <sec id="s2b2">
        <title>PyRosetta Protocol</title>
        <p>In Rosetta and PyRosetta, a macromolecule (and information on a single conformation) is stored in a pose object. To explore the PyMOL_Mover, a user will start PyRosetta and create a pose object from a PDB file.</p>
        <disp-quote>
          <p>from rosetta import*</p>
          <p>init()</p>
          <p>pose = Pose() pose = pose_from_pdb(pose,“test_dock.pdb”)</p>
        </disp-quote>
        <p>When the PyMOL_Mover is applied to a pose, the pose coordinate data is sent to PyMOL rendering an image of the structure.</p>
        <disp-quote>
          <p>pymover = PyMOL_Mover()</p>
          <p>pymover.apply(pose)</p>
        </disp-quote>
        <p>The PyMOL_Mover can be applied repeatedly throughout a custom protocol to update coordinates in the PyMOL window. In this way, a user can view any intermediate step throughout a structure prediction or design protocol.</p>
        <p>To color the loaded structure based on the relative residue energies, a PyMOL_Mover.send_energy method is provided. The pose must have been scored before applying the PyMOL_Mover. Using the PDB file test_in.pdb (provided in <xref ref-type="supplementary-material" rid="pone.0021931.s001">File S1</xref>) with these commands demonstrates Rosetta's ability to recognize high-energy protein regions (<xref ref-type="fig" rid="pone-0021931-g002">Figure 2</xref>).</p>
        <fig id="pone-0021931-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0021931.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Example PyMOL structure.</title>
            <p>An example of the crystal structure in decoy test_in.pdb, available with Rosetta, as output by the PyMOL_Mover. The residues are colored based on their energy evaluation with the standard Rosetta score function ranging from red (high energy) to blue (low energy). One loop region scores noticeably higher than other residues in the protein.</p>
          </caption>
          <graphic xlink:href="pone.0021931.g002"/>
        </fig>
        <disp-quote>
          <p>scorefxn = create_score_function(“standard”)</p>
          <p>scorefxn(pose)</p>
          <p>pymover.apply(pose)</p>
          <p>pymover.send_energy(pose)</p>
        </disp-quote>
        <p>The default color spectrum spans from blue (low score/favorable energy) to red (high score/unfavorable energy). Rosetta scores are determined using a weighted sum of various score terms. The send_energy method can accept the name of any score term and color residues based on this term as long as it is used in the current score function (i.e. a non-zero weight). This example colors the residues based on the value of their (all-atom) Van der Waals attractive energy:</p>
        <disp-quote>
          <p>pymover.send_energy(pose,“fa_atr”)</p>
        </disp-quote>
        <p>The PyMOL_Mover can also automatically color residues by energy every time the coordinates are transmitted by setting the update_energy option to true.</p>
        <disp-quote>
          <p>pymover.update_energy = True</p>
          <p>pymover.apply(pose)</p>
        </disp-quote>
        <p>The PyMOL_Mover can transmit a specific score term with the coordinates during an apply() command if the energy_type option is set and update_energy is true. This example colors the residues based on the value of their (all-atom) solvation energy every time the PyMOL_Mover is applied:</p>
        <disp-quote>
          <p>pymover.update_energy = True</p>
          <p>pymover.energy_type = “fa_sol”</p>
          <p>pymover.apply(pose)</p>
        </disp-quote>
        <p>To send PyMOL_Mover output to a PyMOL instance on a different computer, the PyMOL_Mover.link options can be modified:</p>
        <disp-quote>
          <p>pymover.link.udp_ip = “125.1.3.37”</p>
          <p>pymover.link.udp_port = 9001</p>
        </disp-quote>
        <p>If the PyMOL_Mover's keep_history option is set true, PyMOL will load structures with the same name (pose.pdb_info().name()) into successive states.</p>
        <disp-quote>
          <p>pymover.keep_history = True</p>
          <p>pymover.apply(pose)</p>
          <p>other_mover.apply(pose)</p>
          <p>pymover.apply(pose)</p>
        </disp-quote>
        <p>In PyMOL, the object states can be viewed as a movie which reveals the Rosetta protocol actions. The output can easily be converted into a movie using PyMOL's frame and movie building features.</p>
        <p>In the previous examples, PyMOL updates have been manually transmitted using PyMOL_Mover.apply(). The PyMOL_Observer object automatically monitors a pose conformation and applies its own PyMOL_Mover every time the pose coordinates are changed. Since a PyMOL_Observer has a PyMOL_Mover, all of the PyMOL_Mover options are available.</p>
        <disp-quote>
          <p>pyobs = PyMOL_Observer()</p>
          <p>pyobs.add_observer(pose)</p>
          <p>pyobs.pymol.update_energy = True</p>
        </disp-quote>
        <p>A sample Python script demonstrating how to use the PyMOL_Mover for making movies is PyRosettaDock_Movie.py in <xref ref-type="supplementary-material" rid="pone.0021931.s001">File S1</xref>. <xref ref-type="supplementary-material" rid="pone.0021931.s001">File S1</xref> also includes a more in-depth tutorial script, PyMOL_demo.py, and a copy of the listener, PyMOLPyRosettaServer.py.</p>
      </sec>
      <sec id="s2b3">
        <title>Rosetta Protocols</title>
        <p>All PyRosetta features can also be accessed in the Rosetta C++ code by using appropriate C++ syntax and changes including the namespace.</p>
        <disp-quote>
          <p>#include &lt;protocols/moves/PyMOL_Mover.hh&gt;</p>
          <p>core::protocols::moves::AddPyMOLObserver(pose)</p>
        </disp-quote>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results and Discussion</title>
    <p>Rosetta output to PyMOL is now available on-demand and continuously. Two separate objects have been implemented with Rosetta's object-oriented framework. The PyMOL_Mover object sends data to PyMOL and allows the user to observe visual output on-demand. This implementation is ideal for interactive environments and allows instant feedback from custom processes. New users can now experiment with Rosetta structures and protocols while immediately viewing their changes.</p>
    <p>A second object, the PyMOL_Observer, can be attached to a Rosetta biomolecule (pose) to monitor all structural changes. When a coordinate is updated, the observer uses an embedded PyMOL_Mover to transmit the new structure to PyMOL. This implementation is ideal for elaborate scripts where manual management of output is prohibitive. Furthermore, the observer can be added to previously developed protocols, providing visual output with minimal modification. One limitation is that continuous PyMOL packet construction can slow Rosetta calculations. To mitigate this delay, a user can optionally output coordinates at particular time or coordinate-update intervals (see documentation).</p>
    <p>In addition to being a useful tool to display protein structures, PyMOL is well suited for the production of informative movies. Rosetta simulations are often presented visually to demonstrate or explain the principles underlying Rosetta algorithms. Previously, making movies of Rosetta protocols required significant work. When sending data to PyMOL, the user may simply retain output history to produce PyMOL movies. The history feature also allows the user to inspect protocols that are otherwise inaccessible.</p>
    <p>The PyMOL_Mover can also color residues allowing easy recognition of energetic features and design anomalies. Although only Rosetta score values are currently supported, any relevant data calculated in Rosetta may be sent to PyMOL using this interface. Additional features can be added easily for the visualization of other Rosetta data as long as these data packets carry specific tags for PyMOL to translate.</p>
    <p>The UDP/IP client utilization has several advantages. PyMOL can be customized to receive information from multiple instances of Rosetta. Communication is not limited by the operating environments of either the sender or the receiver. Data can be successfully interpreted between different operating systems (e.g. Linux to Windows), Python versions, and even buildings. A single Rosetta process can transmit data to multiple IP addresses or ports using multiple PyMOL_Movers, allowing visualization on multiple computers. This versatility reduces communication errors and allows users to share information easily. Running each program separately prevents either from losing focus; Rosetta performs simulations and calculations while PyMOL performs visualization.</p>
    <p>The ability to view processes in real-time can easily produce relevant examples for presentations and demonstrations. The UDP solution is inherently unrestricted and is potentially applicable to numerous other applications. Additional protein modeling software such as the SWISS-MODEL server <xref rid="pone.0021931-Schwede1" ref-type="bibr">[10]</xref>, CHARMM <xref rid="pone.0021931-Brooks1" ref-type="bibr">[11]</xref>, and NAMD <xref rid="pone.0021931-Wang1" ref-type="bibr">[12]</xref> could also output to PyMOL with socket export. Similarly, other graphical software such VMD <xref rid="pone.0021931-Humphrey1" ref-type="bibr">[13]</xref>, RasMol <xref rid="pone.0021931-Sayle1" ref-type="bibr">[14]</xref>, Deep View <xref rid="pone.0021931-Guex1" ref-type="bibr">[15]</xref>, Kinemage <xref rid="pone.0021931-Richardson1" ref-type="bibr">[16]</xref> could interpret and display data packets sent from Rosetta by listening to output from a socket. If such practices become widespread, communication using program independent packet structures could lead to a standardized macromolecular visualization markup language.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s4">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0021931.s001">
      <label>File S1</label>
      <caption>
        <p><bold>A summary of the supplemental files contained in the compressed directory <xref ref-type="supplementary-material" rid="pone.0021931.s001">File S1</xref>, including the PyMOL listener, sample scripts with their data files, and a representative movie of the script output.</bold> README: a brief tutorial to the PyMOL_Mover and these scripts. PyRosettaDock.mp4: a PyMOL movie of Rosetta's Docking Protocol. input_files/: PDB files used in the demo scripts. test_dock.pdb a modified 1ACB <xref rid="pone.0021931-Frigerioa1" ref-type="bibr">[17]</xref> PDB file used in PyRosettaDock_Movie.py. test_in.pdb the decoy file PDB used in PyMOL_demo.py. scripts/: sample PyRosetta syntax for using the PyMOL_Mover. PyMOLPyRosettaServer.py listener script for PyMOL. PyRosettaDock_Movie.py sample protocol to create a docking movie. PyMOL_demo.py numerous PyRosetta sample commands with the PyMOL_Mover.</p>
        <p>(TAR.BZ2)</p>
      </caption>
      <media xlink:href="pone.0021931.s001.tar.bz2">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We acknowledge the enabling efforts of the developers within RosettaCommons who have contributed the scientific research and software development to Rosetta and PyRosetta.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement">
      <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
    </fn>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding: </bold>Funding was provided by National Institutes of Health grant R01-GM073151 and a National Science Foundation CAREER grant to JJG (CBET 0846324). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="pone.0021931-LeaverFay1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leaver-Fay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tyka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lange</surname>
            <given-names>OF</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2011</year>
        <article-title>ROSETTA3: An objectoriented software suite for the simulation and design of macromolecules.</article-title>
        <source>Methods in Enzymology</source>
        <volume>487</volume>
        <fpage>548</fpage>
        <lpage>574</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Das1">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Macromolecular modeling with Rosetta.</article-title>
        <source>Biochemistry</source>
        <volume>77</volume>
        <fpage>363</fpage>
        <lpage>382</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Kaufmann1">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaufmann</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Lemmon</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>DeLuca</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Sheehan</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Meiler</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Practically useful: What the Rosetta protein modeling suite can do for you.</article-title>
        <source>Biochemistry</source>
        <volume>49</volume>
        <fpage>2987</fpage>
        <lpage>2998</lpage>
        <pub-id pub-id-type="pmid">20235548</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-ODonoghue1">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O'Donoghue</surname>
            <given-names>SI</given-names>
          </name>
          <name>
            <surname>Goodsell</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Frangakis</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Jossinet</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Laskowski</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Visualization of macromolecular structures.</article-title>
        <source>Nature Methods</source>
        <volume>7</volume>
        <fpage>S42</fpage>
        <lpage>S55</lpage>
        <pub-id pub-id-type="pmid">20195256</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Chaudhury1">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaudhury</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lyskov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>PyRosetta: a script-based interface for implementing molecular modeling algorithms using Rosetta.</article-title>
        <source>Bioinformatics</source>
        <volume>26</volume>
        <fpage>689</fpage>
        <lpage>691</lpage>
        <pub-id pub-id-type="pmid">20061306</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Fleishman1">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fleishman</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Leaver-Fay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Corn</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Khare</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Koga</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2011</year>
        <article-title>RosettaScripts: an XMLlike interface to the Rosetta macromolecular modeling suite.</article-title>
        <source>Plos ONE</source>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Cooper1">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cooper</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khatib</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Treuille</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Barbero</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Predicting protein structures with a multiplayer online game.</article-title>
        <source>Nature</source>
        <volume>466</volume>
        <fpage>756</fpage>
        <lpage>760</lpage>
        <pub-id pub-id-type="pmid">20686574</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-DeLano1">
      <label>8</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>DeLano</surname>
            <given-names>WL</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>PyMOL molecular graphics system.</article-title>
        <comment>Available at: <ext-link ext-link-type="uri" xlink:href="http://www.pymol.org">http://www.pymol.org</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Johnson1">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Autin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Goodsell</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Sanner</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>ePMV Embeds Molecular Modeling into Professional Animation Software Environments.</article-title>
        <source>Structure</source>
        <volume>19</volume>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Schwede1">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwede</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kopp</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Guex</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Peitsch</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>SWISS-MODEL: An automated protein homologymodeling server.</article-title>
        <source>Nucleic Acids Research</source>
        <volume>31</volume>
        <fpage>3381</fpage>
        <lpage>3385</lpage>
        <pub-id pub-id-type="pmid">12824332</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Brooks1">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brooks</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Bruccoleri</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Olafson</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>States</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Swaminathan</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <year>1983</year>
        <article-title>CHARMM: A program for macromolecular energy, minimization, and dynamics calculations.</article-title>
        <source>Computational Chemistry</source>
        <volume>4</volume>
        <fpage>187</fpage>
        <lpage>217</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Wang1">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Schulten</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>McCammon</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>Implementation of accelerated molecular dynamics in NAMD.</article-title>
        <source>Computational Science and Discovery</source>
        <volume>4</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Humphrey1">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Humphrey</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Dalke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schulten</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <year>1996</year>
        <article-title>VMD: Visual molecular dynamics.</article-title>
        <source>Molecular Graphics</source>
        <volume>14</volume>
        <fpage>33</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="pmid">8744570</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Sayle1">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sayle</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Milner-White</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <year>1995</year>
        <article-title>RasMol: Biomolecular graphics for all.</article-title>
        <source>Trends in Biochemical Sciences</source>
        <volume>20</volume>
        <fpage>374</fpage>
        <lpage>376</lpage>
        <pub-id pub-id-type="pmid">7482707</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Guex1">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guex</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Peitsch</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <year>1997</year>
        <article-title>SWISS-MODEL and the Swiss-PDB Viewer: An environment for comparative protein modeling.</article-title>
        <source>Electrophoresis</source>
        <volume>18</volume>
        <fpage>2714</fpage>
        <lpage>2723</lpage>
        <pub-id pub-id-type="pmid">9504803</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Richardson1">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richardson</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <year>1992</year>
        <article-title>The Kinemage: A tool for scientific communication.</article-title>
        <source>Protein Science</source>
        <volume>1</volume>
        <fpage>3</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">1304880</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Frigerioa1">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frigerioa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Codab</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Puglieseb</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lionettib</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Menegattic</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <year>1992</year>
        <article-title>Crystal and molecular structure of the bovine <italic>α</italic>-chymotrypsin-eglin c complex at 2.0 Å resolution.</article-title>
        <source>Journal of Molecular Biology</source>
        <volume>255</volume>
        <fpage>107</fpage>
        <lpage>123</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20031101//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3156697</article-id>
    <article-id pub-id-type="pmid">21857909</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-11-06742</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0021931</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Biophysics</subject>
          <subj-group>
            <subject>Biophysics Simulations</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Biological Data Management</subject>
            <subject>Biophysic Al Simulations</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Real-Time PyMOL Visualization for Rosetta and PyRosetta</article-title>
      <alt-title alt-title-type="running-head">Real-Time PyMOL Visualization for Rosetta</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Baugh</surname>
          <given-names>Evan H.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lyskov</surname>
          <given-names>Sergey</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weitzner</surname>
          <given-names>Brian D.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gray</surname>
          <given-names>Jeffrey J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Department of Chemical and Biomolecular Engineering, The Johns Hopkins University, Baltimore, Maryland, United States of America</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Program in Molecular Biophysics, The Johns Hopkins University, Baltimore, Maryland, United States of America</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Uversky</surname>
          <given-names>Vladimir N.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">University of South Florida, United States of America</aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>pyrosetta@graylab.jhu.edu</email></corresp>
      <fn fn-type="con">
        <p>Wrote the paper: EHB SL BW JJG.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>8</month>
      <year>2011</year>
    </pub-date>
    <volume>6</volume>
    <issue>8</issue>
    <elocation-id>e21931</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>4</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>6</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Baugh et al.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Computational structure prediction and design of proteins and protein-protein complexes have long been inaccessible to those not directly involved in the field. A key missing component has been the ability to visualize the progress of calculations to better understand them. Rosetta is one simulation suite that would benefit from a robust real-time visualization solution. Several tools exist for the sole purpose of visualizing biomolecules; one of the most popular tools, PyMOL (Schrödinger), is a powerful, highly extensible, user friendly, and attractive package. Integrating Rosetta and PyMOL directly has many technical and logistical obstacles inhibiting usage. To circumvent these issues, we developed a novel solution based on transmitting biomolecular structure and energy information via UDP sockets. Rosetta and PyMOL run as separate processes, thereby avoiding many technical obstacles while visualizing information on-demand in real-time. When Rosetta detects changes in the structure of a protein, new coordinates are sent over a UDP network socket to a PyMOL instance running a UDP socket listener. PyMOL then interprets and displays the molecule. This implementation also allows remote execution of Rosetta. When combined with PyRosetta, this visualization solution provides an interactive environment for protein structure prediction and design.</p>
    </abstract>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>The Rosetta software suite, an object-oriented protein structure prediction tool <xref rid="pone.0021931-LeaverFay1" ref-type="bibr">[1]</xref>, can effectively perform protein structure prediction and design <xref rid="pone.0021931-Das1" ref-type="bibr">[2]</xref>
<xref rid="pone.0021931-Kaufmann1" ref-type="bibr">[3]</xref>. Common tasks such as design, docking, and folding produce text files containing the Cartesian coordinates of each atom of the protein. Molecular visualization tools are used later to interpret the output <xref rid="pone.0021931-ODonoghue1" ref-type="bibr">[4]</xref>. Thus, visualization is typically separated from Rosetta. Output structures could be viewed after a simulation, but not during a calculation or protocol. Real-time structural visualization would facilitate development of new methods and make Rosetta more accessible to new users.</p>
    <p>Rosetta protocols are useful to a broad range of scientists, but many protocols are complex. Scientists who are not trained in computation can become frustrated with Rosetta's steep learning curve. Two new interfaces to Rosetta were built to bridge this gap. PyRosetta <xref rid="pone.0021931-Chaudhury1" ref-type="bibr">[5]</xref> is a Python-based interface to Rosetta objects and protocols enabling users to easily develop custom algorithms and to explore Rosetta through the Python interpreter. RosettaScripts <xref rid="pone.0021931-Fleishman1" ref-type="bibr">[6]</xref> provides an XML-scriptable interface to Rosetta allowing users to design custom algorithms. PyRosetta and RosettaScripts have successfully lowered the barrier to learn Rosetta by providing an interactive and scriptable layer. To further improve access to Rosetta, the next step is to provide an intuitive way of observing protocols with elegant informative graphics.</p>
    <p>Several visualization tools have been previously employed which were ideal for some users, but lacked universal appeal. FoldIt <xref rid="pone.0021931-Cooper1" ref-type="bibr">[7]</xref> is a Rosetta-based interactive video game with rich graphics intended for end users to explore protein structures and energetics. It does not allow the loading of arbitrary proteins, lacks access to many Rosetta features, and removes the user from the underlying code, so it is not appropriate as a development environment. Rosetta graphics mode is an undocumented optional feature of Rosetta protocols used by the internal Rosetta community for error checking. Running a protocol in graphics mode produces an image of the manipulated structure, enabling the viewer to see changes, but not to interact with them. Using graphics mode requires knowledge of the Rosetta build system, limiting it to advanced users and developers. PyMOL <xref rid="pone.0021931-DeLano1" ref-type="bibr">[8]</xref> has a very large user base, is not restricted to the visualization of Rosetta output, and is maintained by Schrödinger, but viewing Rosetta structures in PyMOL requires outputting the atomic coordinates to a PDB file and then loading it into PyMOL. A new software plug-in called ePMV <xref rid="pone.0021931-Johnson1" ref-type="bibr">[9]</xref> unifies and visualizes molecular and cellular simulations including Rosetta.</p>
    <p>In this paper, we describe a new solution that allows real-time visualization of Rosetta via PyMOL using UDP network sockets. The versatile communication presents structural and energetic information on demand making Rosetta more accessible to all users.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <p>Since both PyRosetta and PyMOL are Python-based, a possible visualization solution is to run PyRosetta from within the PyMOL interpreter window. However, Python is notorious for compatibility issues between different versions, and thus technical obstacles prevent a robust implementation of this idea. We developed a completely different approach: use a network protocol to transfer data from PyRosetta to PyMOL (<xref ref-type="fig" rid="pone-0021931-g001">Figure 1</xref>). Both TCP/IP and UDP/IP implementations were viable. The latter was chosen because it does not require implicit “hand-shaking” and tolerates lost transmissions, making it more robust. Both programs can transmit, open or close, and even crash without dependence on the other. Accordingly, since the UDP protocol does not guarantee reliability, data must be validated for proper delivery. Restrictions on packet size also forces large packets to be split and sent separately.</p>
    <fig id="pone-0021931-g001" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0021931.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Rosetta-PyMOL network communication.</title>
        <p>Rosetta transmits data through the PyMOL_Mover's UDP/IP socket client to an IP address. Dotted arrows represent network communication and diamonds represent composition (e.g. the PyMOL Observer contains a PyMOL Mover and an [owning pointer to a] Pose). The PyMOL Observer monitors changes in a Pose and uses the PyMOL Mover to transmit this information to PyMOL. The UDP/IP socket server running in PyMOL listens for network traffic and translates appropriate packets. Once the data is translated, PyMOL displays biomolecular structures.</p>
      </caption>
      <graphic xlink:href="pone.0021931.g001"/>
    </fig>
    <p>A Python script running in PyMOL provides a server that listens for incoming UDP/IP traffic. Each packet (<xref ref-type="table" rid="pone-0021931-t001">Table 1</xref>) is recognized by this server, and specific actions, such as coloring or model construction, occur when the server receives a complete packet. Accumulated packets could be fragments of a large data transfer, and the desired action happens only once all pieces are assembled. Data from different PyRosetta instances and errors in network communication can confuse interpretation, so any incomplete information received is held in memory briefly and later, if necessary, released in the rare case that a message is aborted.</p>
    <table-wrap id="pone-0021931-t001" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0021931.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Packet structure.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0021931-t001-1" xlink:href="pone.0021931.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">Size</td>
              <td align="left" rowspan="1" colspan="1">Description</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">(bytes)</td>
              <td align="left" rowspan="1" colspan="1"/>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">16</td>
              <td align="left" rowspan="1" colspan="1">UUID of the sender</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">Unique packet id for this sender/packet</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">Sub-packet id</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">Total number of sub-packets</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">8</td>
              <td align="left" rowspan="1" colspan="1">Type of packet (8 byte string) e.g.: “PDB.bz2”, “Ener.bz2”, “PDB.gzip”, or “Ene.gzip”</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">Flag indicating whether PyMOL should load the PDB into the current state or the next state</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1+N</td>
              <td align="left" rowspan="1" colspan="1">Length of model name in bytes + name (N)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1+N</td>
              <td align="left" rowspan="1" colspan="1">Length of energy name in bytes + name (N)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">X</td>
              <td align="left" rowspan="1" colspan="1">Compressed packet data, a PDB file string or energy float array compressed with bz2 or gzip</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p>Rosetta's preexisting Mover architecture is suited to manage the communication because a Mover can accept a pose (Rosetta's container for a molecular object) and perform operations on the pose data. Using the Mover architecture is intuitive for Rosetta users and allows the PyMOL_Mover to interact with other Rosetta objects. The PyMOL_Mover is a simple network client which sends protein structure and energy information when its apply() method is invoked. Rosetta builds each data packet in a specific order (<xref ref-type="table" rid="pone-0021931-t001">Table 1</xref>) for recognition by the PyMOL listener. We considered sending Python commands directly to PyMOL, however, restricting communication to specific packets reduces security risks since PyMOL only understands and performs a small set of commands.</p>
    <sec id="s2a">
      <title>Software Availability</title>
      <p>The PyMOL script to interpret Rosetta results is included with Rosetta (/mini/src/python/bindings) and PyRosetta (root directory). Rosetta is available for download at <ext-link ext-link-type="uri" xlink:href="http://www.rosettacommons.org/">http://www.rosettacommons.org/</ext-link>. PyRosetta is available for download at <ext-link ext-link-type="uri" xlink:href="http://www.pyrosetta.org">http://www.pyrosetta.org</ext-link>. The PyMOL_Mover is contained in Rosetta beginning with release 3.2 (revision 37389). Both programs have free licenses for academic and nonprofit institutions. PyMOL mus be obtained from Schrödinger (the PyMOL_ Mover has been successfully tested with PyMOL versions 1.0, 1.2, and 1.3).</p>
    </sec>
    <sec id="s2b">
      <title>Protocol Capture</title>
      <p>Proper usage requires (1) a sender, Rosetta or PyRosetta, with the PyMOL_Mover; and (2) a listener, PyMOL, with the listener script. We first demonstrate how to setup the PyMOL server features. Then we present examples of PyMOL_Mover usage with PyRosetta. Finally, we explain how to incorporate the PyMOL_ Mover into Rosetta protocols.</p>
      <sec id="s2b1">
        <title>PyMOL Protocol</title>
        <p>After loading PyMOL, use the command line (e.g. Tk Window Upper Command Line) to run the script PyMOLPyRosettaServer.py to start the listener:</p>
        <disp-quote>
          <p>run /path/to/PyRosetta/PyMOLPyRosettaServer.py</p>
          <p>run/path/to/Rosetta/mini/src/python/bindings/PyMOLPyRosettaServer.py</p>
        </disp-quote>
        <p>If desired, Rosetta and PyMOL can run on different computers. In this case, PyMOL must link to a new IP address using the start_rosetta_server command with the desired IP address and port number as arguments. A single instance of PyMOL can listen to multiple IP addresses or ports by invoking start_rosetta_server multiple times with different arguments.</p>
        <disp-quote>
          <p>start_rosetta_server 125.1.3.37, 9001</p>
        </disp-quote>
      </sec>
      <sec id="s2b2">
        <title>PyRosetta Protocol</title>
        <p>In Rosetta and PyRosetta, a macromolecule (and information on a single conformation) is stored in a pose object. To explore the PyMOL_Mover, a user will start PyRosetta and create a pose object from a PDB file.</p>
        <disp-quote>
          <p>from rosetta import*</p>
          <p>init()</p>
          <p>pose = Pose() pose = pose_from_pdb(pose,“test_dock.pdb”)</p>
        </disp-quote>
        <p>When the PyMOL_Mover is applied to a pose, the pose coordinate data is sent to PyMOL rendering an image of the structure.</p>
        <disp-quote>
          <p>pymover = PyMOL_Mover()</p>
          <p>pymover.apply(pose)</p>
        </disp-quote>
        <p>The PyMOL_Mover can be applied repeatedly throughout a custom protocol to update coordinates in the PyMOL window. In this way, a user can view any intermediate step throughout a structure prediction or design protocol.</p>
        <p>To color the loaded structure based on the relative residue energies, a PyMOL_Mover.send_energy method is provided. The pose must have been scored before applying the PyMOL_Mover. Using the PDB file test_in.pdb (provided in <xref ref-type="supplementary-material" rid="pone.0021931.s001">File S1</xref>) with these commands demonstrates Rosetta's ability to recognize high-energy protein regions (<xref ref-type="fig" rid="pone-0021931-g002">Figure 2</xref>).</p>
        <fig id="pone-0021931-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pone.0021931.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Example PyMOL structure.</title>
            <p>An example of the crystal structure in decoy test_in.pdb, available with Rosetta, as output by the PyMOL_Mover. The residues are colored based on their energy evaluation with the standard Rosetta score function ranging from red (high energy) to blue (low energy). One loop region scores noticeably higher than other residues in the protein.</p>
          </caption>
          <graphic xlink:href="pone.0021931.g002"/>
        </fig>
        <disp-quote>
          <p>scorefxn = create_score_function(“standard”)</p>
          <p>scorefxn(pose)</p>
          <p>pymover.apply(pose)</p>
          <p>pymover.send_energy(pose)</p>
        </disp-quote>
        <p>The default color spectrum spans from blue (low score/favorable energy) to red (high score/unfavorable energy). Rosetta scores are determined using a weighted sum of various score terms. The send_energy method can accept the name of any score term and color residues based on this term as long as it is used in the current score function (i.e. a non-zero weight). This example colors the residues based on the value of their (all-atom) Van der Waals attractive energy:</p>
        <disp-quote>
          <p>pymover.send_energy(pose,“fa_atr”)</p>
        </disp-quote>
        <p>The PyMOL_Mover can also automatically color residues by energy every time the coordinates are transmitted by setting the update_energy option to true.</p>
        <disp-quote>
          <p>pymover.update_energy = True</p>
          <p>pymover.apply(pose)</p>
        </disp-quote>
        <p>The PyMOL_Mover can transmit a specific score term with the coordinates during an apply() command if the energy_type option is set and update_energy is true. This example colors the residues based on the value of their (all-atom) solvation energy every time the PyMOL_Mover is applied:</p>
        <disp-quote>
          <p>pymover.update_energy = True</p>
          <p>pymover.energy_type = “fa_sol”</p>
          <p>pymover.apply(pose)</p>
        </disp-quote>
        <p>To send PyMOL_Mover output to a PyMOL instance on a different computer, the PyMOL_Mover.link options can be modified:</p>
        <disp-quote>
          <p>pymover.link.udp_ip = “125.1.3.37”</p>
          <p>pymover.link.udp_port = 9001</p>
        </disp-quote>
        <p>If the PyMOL_Mover's keep_history option is set true, PyMOL will load structures with the same name (pose.pdb_info().name()) into successive states.</p>
        <disp-quote>
          <p>pymover.keep_history = True</p>
          <p>pymover.apply(pose)</p>
          <p>other_mover.apply(pose)</p>
          <p>pymover.apply(pose)</p>
        </disp-quote>
        <p>In PyMOL, the object states can be viewed as a movie which reveals the Rosetta protocol actions. The output can easily be converted into a movie using PyMOL's frame and movie building features.</p>
        <p>In the previous examples, PyMOL updates have been manually transmitted using PyMOL_Mover.apply(). The PyMOL_Observer object automatically monitors a pose conformation and applies its own PyMOL_Mover every time the pose coordinates are changed. Since a PyMOL_Observer has a PyMOL_Mover, all of the PyMOL_Mover options are available.</p>
        <disp-quote>
          <p>pyobs = PyMOL_Observer()</p>
          <p>pyobs.add_observer(pose)</p>
          <p>pyobs.pymol.update_energy = True</p>
        </disp-quote>
        <p>A sample Python script demonstrating how to use the PyMOL_Mover for making movies is PyRosettaDock_Movie.py in <xref ref-type="supplementary-material" rid="pone.0021931.s001">File S1</xref>. <xref ref-type="supplementary-material" rid="pone.0021931.s001">File S1</xref> also includes a more in-depth tutorial script, PyMOL_demo.py, and a copy of the listener, PyMOLPyRosettaServer.py.</p>
      </sec>
      <sec id="s2b3">
        <title>Rosetta Protocols</title>
        <p>All PyRosetta features can also be accessed in the Rosetta C++ code by using appropriate C++ syntax and changes including the namespace.</p>
        <disp-quote>
          <p>#include &lt;protocols/moves/PyMOL_Mover.hh&gt;</p>
          <p>core::protocols::moves::AddPyMOLObserver(pose)</p>
        </disp-quote>
      </sec>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results and Discussion</title>
    <p>Rosetta output to PyMOL is now available on-demand and continuously. Two separate objects have been implemented with Rosetta's object-oriented framework. The PyMOL_Mover object sends data to PyMOL and allows the user to observe visual output on-demand. This implementation is ideal for interactive environments and allows instant feedback from custom processes. New users can now experiment with Rosetta structures and protocols while immediately viewing their changes.</p>
    <p>A second object, the PyMOL_Observer, can be attached to a Rosetta biomolecule (pose) to monitor all structural changes. When a coordinate is updated, the observer uses an embedded PyMOL_Mover to transmit the new structure to PyMOL. This implementation is ideal for elaborate scripts where manual management of output is prohibitive. Furthermore, the observer can be added to previously developed protocols, providing visual output with minimal modification. One limitation is that continuous PyMOL packet construction can slow Rosetta calculations. To mitigate this delay, a user can optionally output coordinates at particular time or coordinate-update intervals (see documentation).</p>
    <p>In addition to being a useful tool to display protein structures, PyMOL is well suited for the production of informative movies. Rosetta simulations are often presented visually to demonstrate or explain the principles underlying Rosetta algorithms. Previously, making movies of Rosetta protocols required significant work. When sending data to PyMOL, the user may simply retain output history to produce PyMOL movies. The history feature also allows the user to inspect protocols that are otherwise inaccessible.</p>
    <p>The PyMOL_Mover can also color residues allowing easy recognition of energetic features and design anomalies. Although only Rosetta score values are currently supported, any relevant data calculated in Rosetta may be sent to PyMOL using this interface. Additional features can be added easily for the visualization of other Rosetta data as long as these data packets carry specific tags for PyMOL to translate.</p>
    <p>The UDP/IP client utilization has several advantages. PyMOL can be customized to receive information from multiple instances of Rosetta. Communication is not limited by the operating environments of either the sender or the receiver. Data can be successfully interpreted between different operating systems (e.g. Linux to Windows), Python versions, and even buildings. A single Rosetta process can transmit data to multiple IP addresses or ports using multiple PyMOL_Movers, allowing visualization on multiple computers. This versatility reduces communication errors and allows users to share information easily. Running each program separately prevents either from losing focus; Rosetta performs simulations and calculations while PyMOL performs visualization.</p>
    <p>The ability to view processes in real-time can easily produce relevant examples for presentations and demonstrations. The UDP solution is inherently unrestricted and is potentially applicable to numerous other applications. Additional protein modeling software such as the SWISS-MODEL server <xref rid="pone.0021931-Schwede1" ref-type="bibr">[10]</xref>, CHARMM <xref rid="pone.0021931-Brooks1" ref-type="bibr">[11]</xref>, and NAMD <xref rid="pone.0021931-Wang1" ref-type="bibr">[12]</xref> could also output to PyMOL with socket export. Similarly, other graphical software such VMD <xref rid="pone.0021931-Humphrey1" ref-type="bibr">[13]</xref>, RasMol <xref rid="pone.0021931-Sayle1" ref-type="bibr">[14]</xref>, Deep View <xref rid="pone.0021931-Guex1" ref-type="bibr">[15]</xref>, Kinemage <xref rid="pone.0021931-Richardson1" ref-type="bibr">[16]</xref> could interpret and display data packets sent from Rosetta by listening to output from a socket. If such practices become widespread, communication using program independent packet structures could lead to a standardized macromolecular visualization markup language.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s4">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0021931.s001">
      <label>File S1</label>
      <caption>
        <p><bold>A summary of the supplemental files contained in the compressed directory <xref ref-type="supplementary-material" rid="pone.0021931.s001">File S1</xref>, including the PyMOL listener, sample scripts with their data files, and a representative movie of the script output.</bold> README: a brief tutorial to the PyMOL_Mover and these scripts. PyRosettaDock.mp4: a PyMOL movie of Rosetta's Docking Protocol. input_files/: PDB files used in the demo scripts. test_dock.pdb a modified 1ACB <xref rid="pone.0021931-Frigerioa1" ref-type="bibr">[17]</xref> PDB file used in PyRosettaDock_Movie.py. test_in.pdb the decoy file PDB used in PyMOL_demo.py. scripts/: sample PyRosetta syntax for using the PyMOL_Mover. PyMOLPyRosettaServer.py listener script for PyMOL. PyRosettaDock_Movie.py sample protocol to create a docking movie. PyMOL_demo.py numerous PyRosetta sample commands with the PyMOL_Mover.</p>
        <p>(TAR.BZ2)</p>
      </caption>
      <media xlink:href="pone.0021931.s001.tar.bz2">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We acknowledge the enabling efforts of the developers within RosettaCommons who have contributed the scientific research and software development to Rosetta and PyRosetta.</p>
  </ack>
  <fn-group>
    <fn fn-type="COI-statement">
      <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
    </fn>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding: </bold>Funding was provided by National Institutes of Health grant R01-GM073151 and a National Science Foundation CAREER grant to JJG (CBET 0846324). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="pone.0021931-LeaverFay1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leaver-Fay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tyka</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Lange</surname>
            <given-names>OF</given-names>
          </name>
          <name>
            <surname>Thompson</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2011</year>
        <article-title>ROSETTA3: An objectoriented software suite for the simulation and design of macromolecules.</article-title>
        <source>Methods in Enzymology</source>
        <volume>487</volume>
        <fpage>548</fpage>
        <lpage>574</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Das1">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Das</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <year>2008</year>
        <article-title>Macromolecular modeling with Rosetta.</article-title>
        <source>Biochemistry</source>
        <volume>77</volume>
        <fpage>363</fpage>
        <lpage>382</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Kaufmann1">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kaufmann</surname>
            <given-names>KW</given-names>
          </name>
          <name>
            <surname>Lemmon</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>DeLuca</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Sheehan</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Meiler</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>Practically useful: What the Rosetta protein modeling suite can do for you.</article-title>
        <source>Biochemistry</source>
        <volume>49</volume>
        <fpage>2987</fpage>
        <lpage>2998</lpage>
        <pub-id pub-id-type="pmid">20235548</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-ODonoghue1">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O'Donoghue</surname>
            <given-names>SI</given-names>
          </name>
          <name>
            <surname>Goodsell</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Frangakis</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Jossinet</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Laskowski</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Visualization of macromolecular structures.</article-title>
        <source>Nature Methods</source>
        <volume>7</volume>
        <fpage>S42</fpage>
        <lpage>S55</lpage>
        <pub-id pub-id-type="pmid">20195256</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Chaudhury1">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaudhury</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lyskov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gray</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <year>2010</year>
        <article-title>PyRosetta: a script-based interface for implementing molecular modeling algorithms using Rosetta.</article-title>
        <source>Bioinformatics</source>
        <volume>26</volume>
        <fpage>689</fpage>
        <lpage>691</lpage>
        <pub-id pub-id-type="pmid">20061306</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Fleishman1">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fleishman</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Leaver-Fay</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Corn</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Khare</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Koga</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2011</year>
        <article-title>RosettaScripts: an XMLlike interface to the Rosetta macromolecular modeling suite.</article-title>
        <source>Plos ONE</source>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Cooper1">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cooper</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khatib</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Treuille</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Barbero</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <year>2010</year>
        <article-title>Predicting protein structures with a multiplayer online game.</article-title>
        <source>Nature</source>
        <volume>466</volume>
        <fpage>756</fpage>
        <lpage>760</lpage>
        <pub-id pub-id-type="pmid">20686574</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-DeLano1">
      <label>8</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>DeLano</surname>
            <given-names>WL</given-names>
          </name>
        </person-group>
        <year>2002</year>
        <article-title>PyMOL molecular graphics system.</article-title>
        <comment>Available at: <ext-link ext-link-type="uri" xlink:href="http://www.pymol.org">http://www.pymol.org</ext-link></comment>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Johnson1">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>GT</given-names>
          </name>
          <name>
            <surname>Autin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Goodsell</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Sanner</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>ePMV Embeds Molecular Modeling into Professional Animation Software Environments.</article-title>
        <source>Structure</source>
        <volume>19</volume>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Schwede1">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwede</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Kopp</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Guex</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Peitsch</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <year>2003</year>
        <article-title>SWISS-MODEL: An automated protein homologymodeling server.</article-title>
        <source>Nucleic Acids Research</source>
        <volume>31</volume>
        <fpage>3381</fpage>
        <lpage>3385</lpage>
        <pub-id pub-id-type="pmid">12824332</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Brooks1">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brooks</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Bruccoleri</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Olafson</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>States</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Swaminathan</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <year>1983</year>
        <article-title>CHARMM: A program for macromolecular energy, minimization, and dynamics calculations.</article-title>
        <source>Computational Chemistry</source>
        <volume>4</volume>
        <fpage>187</fpage>
        <lpage>217</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Wang1">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Harrison</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Schulten</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>McCammon</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <year>2011</year>
        <article-title>Implementation of accelerated molecular dynamics in NAMD.</article-title>
        <source>Computational Science and Discovery</source>
        <volume>4</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Humphrey1">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Humphrey</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Dalke</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Schulten</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <year>1996</year>
        <article-title>VMD: Visual molecular dynamics.</article-title>
        <source>Molecular Graphics</source>
        <volume>14</volume>
        <fpage>33</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="pmid">8744570</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Sayle1">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sayle</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Milner-White</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <year>1995</year>
        <article-title>RasMol: Biomolecular graphics for all.</article-title>
        <source>Trends in Biochemical Sciences</source>
        <volume>20</volume>
        <fpage>374</fpage>
        <lpage>376</lpage>
        <pub-id pub-id-type="pmid">7482707</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Guex1">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guex</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Peitsch</surname>
            <given-names>MC</given-names>
          </name>
        </person-group>
        <year>1997</year>
        <article-title>SWISS-MODEL and the Swiss-PDB Viewer: An environment for comparative protein modeling.</article-title>
        <source>Electrophoresis</source>
        <volume>18</volume>
        <fpage>2714</fpage>
        <lpage>2723</lpage>
        <pub-id pub-id-type="pmid">9504803</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Richardson1">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Richardson</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <year>1992</year>
        <article-title>The Kinemage: A tool for scientific communication.</article-title>
        <source>Protein Science</source>
        <volume>1</volume>
        <fpage>3</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">1304880</pub-id>
      </element-citation>
    </ref>
    <ref id="pone.0021931-Frigerioa1">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frigerioa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Codab</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Puglieseb</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lionettib</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Menegattic</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <year>1992</year>
        <article-title>Crystal and molecular structure of the bovine <italic>α</italic>-chymotrypsin-eglin c complex at 2.0 Å resolution.</article-title>
        <source>Journal of Molecular Biology</source>
        <volume>255</volume>
        <fpage>107</fpage>
        <lpage>123</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
