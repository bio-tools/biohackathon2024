<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5637252</article-id>
    <article-id pub-id-type="publisher-id">1853</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-017-1853-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>VDJPipe: a pipelined tool for pre-processing immune repertoire sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Christley</surname>
          <given-names>Scott</given-names>
        </name>
        <address>
          <email>scott.christley@utsouthwestern.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Levin</surname>
          <given-names>Mikhail K.</given-names>
        </name>
        <address>
          <email>mlevin@svarnetics.org</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Toby</surname>
          <given-names>Inimary T.</given-names>
        </name>
        <address>
          <email>inimary.toby@utsouthwestern.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fonner</surname>
          <given-names>John M.</given-names>
        </name>
        <address>
          <email>jfonner@tacc.utexas.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Monson</surname>
          <given-names>Nancy L.</given-names>
        </name>
        <address>
          <email>nancy.monson@utsouthwestern.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rounds</surname>
          <given-names>William H.</given-names>
        </name>
        <address>
          <email>rounds.william@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rubelt</surname>
          <given-names>Florian</given-names>
        </name>
        <address>
          <email>frubelt@stanford.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Scarborough</surname>
          <given-names>Walter</given-names>
        </name>
        <address>
          <email>walter.scarborough@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Scheuermann</surname>
          <given-names>Richard H.</given-names>
        </name>
        <address>
          <email>rscheuermann@jcvi.org</email>
        </address>
        <xref ref-type="aff" rid="Aff7">7</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Cowell</surname>
          <given-names>Lindsay G.</given-names>
        </name>
        <address>
          <email>lindsay.cowell@utsouthwestern.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9482 7121</institution-id><institution-id institution-id-type="GRID">grid.267313.2</institution-id><institution>Department of Clinical Sciences, </institution><institution>UT Southwestern Medical Center, </institution></institution-wrap>Dallas, TX 75390 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0373 6759</institution-id><institution-id institution-id-type="GRID">grid.467231.5</institution-id><institution>Bank of America Corporate Center, </institution></institution-wrap>Charlotte, NC 28202 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 9924</institution-id><institution-id institution-id-type="GRID">grid.89336.37</institution-id><institution>Texas Advanced Computing Center, </institution></institution-wrap>Austin, TX 78758-4497 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9482 7121</institution-id><institution-id institution-id-type="GRID">grid.267313.2</institution-id><institution>Department of Neurology and Neurotherapeutics, </institution><institution>UT Southwestern Medical Center, </institution></institution-wrap>Dallas, TX 75390 USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9482 7121</institution-id><institution-id institution-id-type="GRID">grid.267313.2</institution-id><institution>Department of Immunology, </institution><institution>UT Southwestern Medical Center, </institution></institution-wrap>Dallas, TX 75390 USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000000419368956</institution-id><institution-id institution-id-type="GRID">grid.168010.e</institution-id><institution>Department of Microbiology and Immunology, </institution><institution>Stanford University School of Medicine, </institution></institution-wrap>Stanford, CA 94305 USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.469946.0</institution-id><institution>J. Craig Venter Institute, </institution></institution-wrap>La Jolla, CA 92037 USA </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution>Department of Pathology, </institution><institution>University of California, </institution></institution-wrap>San Diego, CA 92093 USA </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0461 3162</institution-id><institution-id institution-id-type="GRID">grid.185006.a</institution-id><institution>La Jolla Institute for Allergy &amp; Immunology, </institution></institution-wrap>La Jolla, CA 92037 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>11</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>18</volume>
    <elocation-id>448</elocation-id>
    <history>
      <date date-type="received">
        <day>9</day>
        <month>3</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>10</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Pre-processing of high-throughput sequencing data for immune repertoire profiling is essential to insure high quality input for downstream analysis. VDJPipe is a flexible, high-performance tool that can perform multiple pre-processing tasks with just a single pass over the data files.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">Processing tasks provided by VDJPipe include base composition statistics calculation, read quality statistics calculation, quality filtering, homopolymer filtering, length and nucleotide filtering, paired-read merging, barcode demultiplexing, 5′ and 3′ PCR primer matching, and duplicate reads collapsing. VDJPipe utilizes a pipeline approach whereby multiple processing steps are performed in a sequential workflow, with the output of each step passed as input to the next step automatically. The workflow is flexible enough to handle the complex barcoding schemes used in many immunosequencing experiments. Because VDJPipe is designed for computational efficiency, we evaluated this by comparing execution times with those of pRESTO, a widely-used pre-processing tool for immune repertoire sequencing data. We found that VDJPipe requires &lt;10% of the run time required by pRESTO.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">VDJPipe is a high-performance tool that is optimized for pre-processing large immune repertoire sequencing data sets.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Rep-seq</kwd>
      <kwd>Immune repertoire analysis</kwd>
      <kwd>Bioinformatics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000060</institution-id>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>4R01AI097403-05</award-id>
        <principal-award-recipient>
          <name>
            <surname>Cowell</surname>
            <given-names>Lindsay G.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">The ability to mount an effective immune response and subsequently develop specific immunity relies on the presence of a diverse repertoire of antigen receptors. In jawed vertebrates, the genes encoding antibodies and antigen receptors are somatically generated in lymphocytes through a DNA recombination process, V(D)J recombination, which assembles variable (V), diversity (D), and joining (J) gene segments into genes. The diversity of gene sequences generated by V(D)J recombination is huge (estimated at &gt;10<sup>15</sup>) as a result of varying combinations of V, D, and J gene segments, as well as sequence modifications (e.g., exonucleolytic trimming and non-templated nucleotide addition) at the junctions of rearranged gene segments [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. In recent years, the increased sample coverage of next generation sequencing technologies has significantly enhanced our ability to obtain detailed characterizations of immune repertoires, as there can easily be more than 10<sup>6</sup> unique sequences for each receptor type [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>].</p>
    <p id="Par5">Analysis of immune repertoire sequencing data shares some pre-processing tasks with other next generation sequencing data [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], but it also has its own unique characteristics, including 5′ and 3′ PCR primer targeting, complex multi-level barcode demultiplexing, and duplicate sequence read collapsing. Table <xref rid="Tab1" ref-type="table">1</xref> provides a list of immune repertoire analysis tools with their pre-processing capabilities. The set of tools can be divided into three main categories: 1) those providing a workflow from raw data to V, D, and J assignment, 2) those specializing in specific pre-processing operations, and 3) those providing generic pre-processing operations. We excluded web analysis portals such as VDJServer and ARGalaxy, as they provide web-based access to other tools. We indicate each tool’s category (1, 2 or 3) in Table <xref rid="Tab1" ref-type="table">1</xref>. All of the tools in the first category provide some limited pre-processing capability, though this tends to be restricted to barcode demultiplexing and length and quality filtering. Category 2 tools specialize in processing unique molecular identifiers (UMI), which is a strategy to overcome PCR amplification bias and sequencing error [<xref ref-type="bibr" rid="CR7">7</xref>]. The tools in Category 3, which includes VDJPipe, provide the broadest capability.<table-wrap id="Tab1"><label>Table 1</label><caption><p>List of analysis tools providing pre-processing functions</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Tool</th><th>Category</th><th>Composition statistics calculation</th><th>Merging paired-end reads</th><th>Barcode demultiplexing</th><th>PCR primer removal</th><th>Length filtering</th><th>Quality filtering</th><th>Homopolymer filtering</th><th>UMI consensus determination</th><th>Collapsing duplicate reads</th></tr></thead><tbody><tr><td>AbStar [<xref ref-type="bibr" rid="CR16">16</xref>]</td><td>1</td><td>No</td><td>Yes</td><td>Yes</td><td>No</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>No</td></tr><tr><td>Decombinator [<xref ref-type="bibr" rid="CR17">17</xref>]</td><td>2</td><td>No</td><td>No</td><td>Yes</td><td>No</td><td>No</td><td>No</td><td>No</td><td>Yes</td><td>No</td></tr><tr><td>Ig-HTS cleaner [<xref ref-type="bibr" rid="CR18">18</xref>]</td><td>3</td><td>Yes</td><td>No</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>No</td></tr><tr><td>IgRepertoire constructor [<xref ref-type="bibr" rid="CR19">19</xref>]</td><td>1</td><td>No</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>No</td><td>No</td><td>Yes</td><td>No</td></tr><tr><td>ImmunediveRsity [<xref ref-type="bibr" rid="CR20">20</xref>]</td><td>1</td><td>No</td><td>No</td><td>No</td><td>No</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>No</td></tr><tr><td>iMonitor [<xref ref-type="bibr" rid="CR21">21</xref>]</td><td>1</td><td>No</td><td>Yes</td><td>No</td><td>No</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>No</td></tr><tr><td>IMSEQ [<xref ref-type="bibr" rid="CR22">22</xref>]</td><td>1</td><td>No</td><td>Yes</td><td>Yes</td><td>No</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>No</td></tr><tr><td>MIGEC [<xref ref-type="bibr" rid="CR7">7</xref>]</td><td>2</td><td>No</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>Yes</td><td>No</td><td>Yes</td><td>No</td></tr><tr><td>pRESTO [<xref ref-type="bibr" rid="CR13">13</xref>]</td><td>3</td><td>No</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>Yes</td><td>Yes</td></tr><tr><td>RTCR [<xref ref-type="bibr" rid="CR23">23</xref>]</td><td>1</td><td>No</td><td>No</td><td>Yes</td><td>No</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>No</td></tr><tr><td>VDJPipe</td><td>3</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>Yes</td></tr><tr><td>TCRklass [<xref ref-type="bibr" rid="CR24">24</xref>]</td><td>1</td><td>No</td><td>Yes</td><td>No</td><td>No</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>No</td></tr><tr><td>Abmining [<xref ref-type="bibr" rid="CR25">25</xref>]</td><td>3</td><td>No</td><td>Yes</td><td>Yes</td><td>No</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td></tr><tr><td>ClonoCalc [<xref ref-type="bibr" rid="CR26">26</xref>]</td><td>1</td><td>No</td><td>Yes</td><td>Yes</td><td>No</td><td>No</td><td>No</td><td>No</td><td>No</td><td>No</td></tr></tbody></table></table-wrap>
</p>
    <p id="Par6">VDJPipe is a flexible, high-performance tool for performing a variety of pre-processing operations on immune repertoire sequencing data. VDJPipe efficiently performs all of these pre-processing tasks within a user-defined pipeline that only requires a single pass over large sequencing data files. This has the advantage of significantly decreased processing times, as well as not creating large intermediate files between processing steps, unless desired by the user. VDJPipe is typically the first step in an immunosequencing analysis workflow followed by assignment of V, D, and J gene segments to each sequence with subsequent repertoire annotation and characterization, and it has been successfully applied to analyzing human immune receptor sequences from B and T cells [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>].</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par7">VDJPipe accepts as input a JSON-formatted configuration file that specifies the set of input sequencing data files and the sequence of processing tasks to be performed on those files. VDJPipe accepts both single-end and paired-end nucleotide sequence read files, and it requires quality scores that can be provided in either a FASTQ file or a FASTA/QUAL file pair. Input sequence files, compressed in gzip or bz2 format, can be read by VDJPipe without being decompressed. Paired-end reads can be initially merged into a single sequence based upon alignment of the overlapping nucleotides, but operations, such as quality filtering, can also be performed on each paired-end read file individually with reads being merged afterward. VDJPipe produces FASTA-formatted output files of processed reads for input into V(D)J assignment software, such as IgBlast.</p>
    <sec id="Sec3">
      <title>Sequence read filtering and statistics</title>
      <p id="Par8">VDJPipe provides many common operations, such as filtering based on nucleotide-level quality and average quality score, ambiguous base calls, homopolymer detection, and sequence length. Each operation has parameters to specify minimum, maximum, or window range values for applying the filter. VDJPipe can calculate various statistics at one or more steps along the processing pipeline. These statistics include nucleotide composition along the length of the read, GC-content histogram, sequence length histogram, average quality score histogram, and base call quality along the length of the read. Generating statistics at multiple points in the pipeline makes it easy to compare how the sequence read composition changes before and after each filtering operation.</p>
    </sec>
    <sec id="Sec4">
      <title>Barcode demultiplexing</title>
      <p id="Par9">It is a common practice with some next generation sequencing studies to multiplex multiple biological samples into a single sequencing run by attaching an identical set of short nucleotide barcodes to all sequences in a given sample. The barcode set is unique for each sample and can be used to demultiplex (split) the combined sequences produced in a single sequencing run back into individual sample files. VDJPipe supports any number of barcodes with its <italic>match</italic> operation, and barcode sequences with their sample identifier are specified in a separate FASTA file. Matching can be performed on the forward or reverse strand, can be limited to a specific search window, and can be a gapped or non-gapped alignment with either a minimal score or a maximum number of mismatches defining a successful match. The <italic>match</italic> operation uses the standard Smith-Waterman local alignment algorithm [<xref ref-type="bibr" rid="CR11">11</xref>] with a substitution matrix that scores matches and mismatches (+2 for match and −2 for mismatch, or 0 for match and +1 for mismatch if only counting mismatches). The matching barcode can be trimmed from the sequence if desired, sequences without a matching barcode can be excluded, and each sequence is tagged with its barcode identifier allowing it to be used in later operations. VDJPipe can handle multiple combinatorial barcodes, such as are used in single-cell sequencing protocols [<xref ref-type="bibr" rid="CR12">12</xref>], with multiple match operations or with the barcode combinations specified in a CSV file.</p>
    </sec>
    <sec id="Sec5">
      <title>5′ and 3′ primer matching</title>
      <p id="Par10">Immunosequencing typically uses a targeted PCR protocol with a panel of 5′ (V region) and 3′ (J or C region) primers to capture the genes of interest. Other protocols use 5′ RACE, which eliminates the 5′ primer. As with barcodes, VDJPipe’s <italic>match</italic> operation can be used to recognize the primer sequences, trim them from the sequence if desired, and tag each sequence with the primer identifier for use in later operations. Primer sequences are specified in a separate FASTA file.</p>
    </sec>
    <sec id="Sec6">
      <title>Duplicate reads</title>
      <p id="Par11">Adaptive immune cells can undergo clonal expansion which generates daughter cells with identical V(D)J recombination sequences (though some B cells also undergo somatic hypermutation that can alter the sequence). When sequencing a large number of immune cells, these clones appear as duplicate sequences within the data. Duplicates also appear as a consequence of PCR amplification during sample preparation. Collapsing duplicate reads greatly shrinks the data size and can speed up downstream analyses. However, duplicate read checking in standard tools focused on genome sequencing or RNA-seq assumes only a portion of the sequence needs to be identical in order for the read to be marked as a duplicate [<xref ref-type="bibr" rid="CR6">6</xref>], but this assumption is invalid for immune repertoire sequencing. Many V, D, and J gene segments are highly similar, and allelic variations present in individuals may only differ by a few nucleotides. Therefore, it is important that the complete read sequence be checked. The standard n-gram hash table approach cannot be used, however, because immune receptor read lengths are typically greater than 250 nucleotides. Thus, VDJPipe utilizes a suffix tree data structure to store the unique sequences found while processing the data. Furthermore, VDJPipe recognizes the sample barcode demultiplexing and collapses duplicate reads within each sample separately. A report of the duplicate count for each read is provided as part of the output.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results</title>
    <p id="Par12">We compare the performance of VDJPipe v0.1.7 with that of another software tool specialized for immunosequencing data, pRESTO v0.5.3 [<xref ref-type="bibr" rid="CR13">13</xref>]. pRESTO has an alternative design of providing a set of Python scripts, each of which performs one step in the pre-processing workflow. For comparison, we use two example data sets provided by pRESTO [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>] and publically available from SRA under accession ID: ERP003950 and SRX190717. The first data set is Illumina MiSeq 2 × 250 stranded paired-end reads from RNA isolated from antibody-secreting mouse cells with primers for the amplification of full-length IgG heavy chain variable regions [<xref ref-type="bibr" rid="CR14">14</xref>]. The second data set is Roche 454 reads from B-cell RNA isolated from PBMC for human patients across multiple time points before and after exposure to the influenza vaccine [<xref ref-type="bibr" rid="CR15">15</xref>]. For the first data set, processing steps include merging the paired-end reads into a single read sequence, quality filtering, 5′ and 3′ primer matching, and collapsing duplicate reads. For the second data set, processing steps include length, homopolymer and quality filtering, generating compositional statistics, barcode demultiplexing, 5′ and 3′ primer matching, and collapsing duplicate reads. Together, these two data sets test all the main functions provided by VDJPipe (Table <xref rid="Tab1" ref-type="table">1</xref>). We use the execution scripts provided by pRESTO for the examples but comment out the miscellaneous steps of parsing log files and compressing intermediate files at the end. The JSON input files used for VDJPipe are provided in the sample_data directory in the source code repository. Tests were run on a quad core Linux computer; VDJPipe only utilizes one processing core, while pRESTO is able to use all four cores.</p>
    <p id="Par13">Tables <xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref> show a comparison of execution times for both tools with different size input files for each data set, respectively. We find that VDJPipe is able to complete all processing steps in less than 10% the time required by pRESTO.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Execution times for the Greiff et al., [<xref ref-type="bibr" rid="CR14">14</xref>] data set</p></caption><table frame="hsides" rules="groups"><thead><tr><th>|Sequences|</th><th>VDJPipe (1 core)</th><th>pRESTO (4 cores)</th></tr></thead><tbody><tr><td>25,000</td><td>5.7 s (0.1 s)</td><td>1 m 43.2 s (2.5 s)</td></tr><tr><td>250,000</td><td>1 m 7.5 s (0.5 s)</td><td>17 m 35.1 s (15.6 s)</td></tr><tr><td>1,085,869</td><td>8 m 22.5 s (4.6 s)</td><td>89 m 14.9 s (2 m 18.5 s)</td></tr></tbody></table><table-wrap-foot><p>Execution times are the average of ten runs with the standard deviation in parentheses</p></table-wrap-foot></table-wrap>
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Execution times for the Jiang et al., [<xref ref-type="bibr" rid="CR15">15</xref>] data set</p></caption><table frame="hsides" rules="groups"><thead><tr><th>|Sequences|</th><th>VDJPipe (1 core)</th><th>pRESTO (4 cores)</th></tr></thead><tbody><tr><td>50,000</td><td>6.5 s (0.2 s)</td><td>1 m 30.5 s (1.2 s)</td></tr><tr><td>277,826</td><td>40.3 s (0.2 s)</td><td>15 m 5.1 s (4.9 s)</td></tr></tbody></table><table-wrap-foot><p>Execution times are the average of ten runs with the standard deviation in parentheses</p></table-wrap-foot></table-wrap>
</p>
  </sec>
  <sec id="Sec8">
    <title>Conclusion</title>
    <p id="Par14">VDJPipe is a flexible, high-performance tool for performing a variety of pre-processing operations on immune repertoire sequencing data. Written in C++ and utilizing a pipelined design, VDJPipe can efficiently perform all its operations with just a single pass over the input data file. This results in significantly decreased processing times. This has the additional benefit of not creating large intermediate files (unless desired by the user) between each processing step. Future enhancements include support for multiprocessing and building consensus sequences from unique molecular identifiers.</p>
  </sec>
  <sec id="Sec9">
    <title>Availability and requirements</title>
    <p id="Par16"><bold>Project name:</bold> VDJPipe</p>
    <p>
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://vdjserver.org/vdjpipe/index.html">https://vdjserver.org/vdjpipe/index.html</ext-link>
    </p>
    <p>
      <bold>Source code repository:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/vdjserver/vdj_pipe">https://bitbucket.org/vdjserver/vdj_pipe</ext-link>
    </p>
    <p>
      <bold>Docker image:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/vdjserver/vdj_pipe">https://hub.docker.com/r/vdjserver/vdj_pipe</ext-link>
    </p>
    <p><bold>Operating system(s):</bold> Platform independent</p>
    <p><bold>Programming language:</bold> C++</p>
    <p><bold>License:</bold> GNU GPL</p>
    <p>Any restrictions on use by non-academics: no restrictions. The data sets analyzed in this study are publicly available and described in [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]. The VDJPipe input configuration files used for these two data sets are available in the source code repository in the sample_data directory.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>FR would like to thank Mark M. Davis for his advice on this project.</p>
    <sec id="FPar1">
      <title>Funding</title>
      <p id="Par15">This work was supported by an NIAID-funded R01 (AI097403) to LGC. FR was supported, in part, by the Bioinformatics Support Contract (BISC) HHSN272201200028C and the National Institutes of Health, specifically the National Institute of Allergy and Infectious Diseases grant U19A1057229. The funding body had no role in the design of the study or the collection, analysis, and interpretation of data or in writing the manuscript.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>SC wrote the manuscript and worked on the software. MKL initially designed and wrote the software. IT conducted the review of analysis tools. JF, NM, WHR, FR, WS, RHS, IT and LGC contributed data, tested the software, and provided feedback on the design. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="COI-statement">
    <sec id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par17">Not applicable.</p>
    </sec>
    <sec id="FPar4">
      <title>Consent for publication</title>
      <p id="Par18">Portions of the abstract were part of a poster abstract presented at Immunology 2016 and originally published in The Journal of Immunology (Copyright 2016 The American Association of Immunologists, Inc., included with permission of The American Association of Immunologists [<xref ref-type="bibr" rid="CR27">27</xref>]).</p>
    </sec>
    <sec id="FPar5">
      <title>Competing interests</title>
      <p id="Par19">The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar6">
      <title>Publisher’s Note</title>
      <p id="Par20">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murugan</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Statistical inference of the generation probability of T-cell receptors from sequence repertoires</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2012</year>
        <volume>109</volume>
        <issue>40</issue>
        <fpage>16161</fpage>
        <lpage>16166</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1212755109</pub-id>
        <?supplied-pmid 22988065?>
        <pub-id pub-id-type="pmid">22988065</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Casrouge</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Size estimate of the alpha beta TCR repertoire of naive mouse splenocytes</article-title>
        <source>Journal of immunology (Baltimore, Md : 1950)</source>
        <year>2000</year>
        <volume>164</volume>
        <issue>11</issue>
        <fpage>5782</fpage>
        <lpage>5787</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.164.11.5782</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Greiff</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioinformatic and Statistical Analysis of Adaptive Immune Repertoires</article-title>
        <source>Trends Immunol</source>
        <year>2015</year>
        <volume>36</volume>
        <issue>11</issue>
        <fpage>738</fpage>
        <lpage>749</lpage>
        <pub-id pub-id-type="doi">10.1016/j.it.2015.09.006</pub-id>
        <?supplied-pmid 26508293?>
        <pub-id pub-id-type="pmid">26508293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <mixed-citation publication-type="other">Yaari G, Kleinstein SH. Practical guidelines for B-cell receptor repertoire sequencing analysis. Genome Medicine. 2015:1–14.</mixed-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <mixed-citation publication-type="other">FastQC. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc">http://www.bioinformatics.babraham.ac.uk/projects/fastqc</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Aronesty, E. ea-utils: Command-line tools for processing biological sequencing data. 2011; Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/ExpressionAnalysis/ea-utils">https://github.com/ExpressionAnalysis/ea-utils</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shugay</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Towards error-free profiling of immune repertoires</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>6</issue>
        <fpage>653</fpage>
        <lpage>655</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2960</pub-id>
        <?supplied-pmid 24793455?>
        <pub-id pub-id-type="pmid">24793455</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rubelt</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Individual heritable differences result in unique cell lymphocyte receptor repertoires of naïve and antigen-experienced cells</article-title>
        <source>Nat Commun</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>11112</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms11112</pub-id>
        <?supplied-pmid 27005435?>
        <pub-id pub-id-type="pmid">27005435</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rounds</surname>
            <given-names>WH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MSPrecise: A molecular diagnostic test for multiple sclerosis using next generation sequencing</article-title>
        <source>Gene</source>
        <year>2015</year>
        <volume>572</volume>
        <issue>2</issue>
        <fpage>191</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gene.2015.07.011</pub-id>
        <?supplied-pmid 26172868?>
        <pub-id pub-id-type="pmid">26172868</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rounds</surname>
            <given-names>WH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The antibody genetics of multiple sclerosis: comparing next-generation sequencing to sanger sequencing</article-title>
        <source>Front Neurol</source>
        <year>2014</year>
        <volume>5</volume>
        <fpage>166</fpage>
        <pub-id pub-id-type="doi">10.3389/fneur.2014.00166</pub-id>
        <?supplied-pmid 25278930?>
        <pub-id pub-id-type="pmid">25278930</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Identification of common molecular subsequences</article-title>
        <source>J Mol Biol</source>
        <year>1981</year>
        <volume>147</volume>
        <issue>1</issue>
        <fpage>195</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-2836(81)90087-5</pub-id>
        <?supplied-pmid 7265238?>
        <pub-id pub-id-type="pmid">7265238</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Han</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Linking T-cell receptor sequence to functional phenotype at the single-cell level</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <issue>7</issue>
        <fpage>684</fpage>
        <lpage>692</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2938</pub-id>
        <?supplied-pmid 24952902?>
        <pub-id pub-id-type="pmid">24952902</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vander Heiden</surname>
            <given-names>JA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>pRESTO: a toolkit for processing high-throughput sequencing raw reads of lymphocyte receptor repertoires</article-title>
        <source>Bioinformatics (Oxford, England)</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>13</issue>
        <fpage>1930</fpage>
        <lpage>1932</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu138</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Greiff</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantitative assessment of the robustness of next-generation sequencing of antibody variable gene repertoires from immunized mice</article-title>
        <source>BMC Immunol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>40</fpage>
        <pub-id pub-id-type="doi">10.1186/s12865-014-0040-5</pub-id>
        <?supplied-pmid 25318652?>
        <pub-id pub-id-type="pmid">25318652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lineage structure of the human antibody repertoire in response to influenza vaccination</article-title>
        <source>Sci Transl Med</source>
        <year>2013</year>
        <volume>5</volume>
        <issue>171</issue>
        <fpage>171ra19</fpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.3004794</pub-id>
        <?supplied-pmid 23390249?>
        <pub-id pub-id-type="pmid">23390249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">AbStar. [Accessed: June 12, 2017]; Available from: <ext-link ext-link-type="uri" xlink:href="https://github.com/briney/abstar">https://github.com/briney/abstar</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Decombinator: a tool for fast, efficient gene assignment in T-cell receptor sequences using a finite state machine</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>5</issue>
        <fpage>542</fpage>
        <lpage>550</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt004</pub-id>
        <?supplied-pmid 23303508?>
        <pub-id pub-id-type="pmid">23303508</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Michaeli</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Automated cleaning and pre-processing of immunoglobulin gene sequences from high-throughput sequencing</article-title>
        <source>Front Immunol</source>
        <year>2012</year>
        <volume>3</volume>
        <fpage>386</fpage>
        <pub-id pub-id-type="doi">10.3389/fimmu.2012.00386</pub-id>
        <?supplied-pmid 23293637?>
        <pub-id pub-id-type="pmid">23293637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Safonova</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IgRepertoireConstructor: a novel algorithm for antibody repertoire construction and immunoproteogenomics analysis</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>12</issue>
        <fpage>i53</fpage>
        <lpage>i61</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv238</pub-id>
        <?supplied-pmid 26072509?>
        <pub-id pub-id-type="pmid">26072509</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cortina-Ceballos</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reconstructing and mining the B cell repertoire with ImmunediveRsity</article-title>
        <source>MAbs</source>
        <year>2015</year>
        <volume>7</volume>
        <issue>3</issue>
        <fpage>516</fpage>
        <lpage>524</lpage>
        <pub-id pub-id-type="doi">10.1080/19420862.2015.1026502</pub-id>
        <?supplied-pmid 25875140?>
        <pub-id pub-id-type="pmid">25875140</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IMonitor: A Robust Pipeline for TCR and BCR Repertoire Analysis</article-title>
        <source>Genetics</source>
        <year>2015</year>
        <volume>201</volume>
        <issue>2</issue>
        <fpage>459</fpage>
        <lpage>472</lpage>
        <pub-id pub-id-type="doi">10.1534/genetics.115.176735</pub-id>
        <?supplied-pmid 26297338?>
        <pub-id pub-id-type="pmid">26297338</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuchenbecker</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IMSEQ--a fast and error aware approach to immunogenetic sequence analysis</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>18</issue>
        <fpage>2963</fpage>
        <lpage>2971</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv309</pub-id>
        <?supplied-pmid 25987567?>
        <pub-id pub-id-type="pmid">25987567</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerritsen</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>RTCR: a pipeline for complete and accurate recovery of T cell repertoires from high throughput sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>20</issue>
        <fpage>3098</fpage>
        <lpage>3106</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw339</pub-id>
        <?supplied-pmid 27324198?>
        <pub-id pub-id-type="pmid">27324198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TCRklass: a new K-string-based algorithm for human and mouse TCR repertoire characterization</article-title>
        <source>J Immunol</source>
        <year>2015</year>
        <volume>194</volume>
        <issue>1</issue>
        <fpage>446</fpage>
        <lpage>454</lpage>
        <pub-id pub-id-type="doi">10.4049/jimmunol.1400711</pub-id>
        <?supplied-pmid 25404364?>
        <pub-id pub-id-type="pmid">25404364</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>D'Angelo</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The antibody mining toolbox: an open source tool for the rapid analysis of antibody repertoires</article-title>
        <source>MAbs</source>
        <year>2014</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>160</fpage>
        <lpage>172</lpage>
        <pub-id pub-id-type="doi">10.4161/mabs.27105</pub-id>
        <?supplied-pmid 24423623?>
        <pub-id pub-id-type="pmid">24423623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fahnrich</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ClonoCalc and ClonoPlot: immune repertoire analysis from raw files to publication figures with graphical user interface</article-title>
        <source>BMC Bioinformatics</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>164</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1575-2</pub-id>
        <?supplied-pmid 28284194?>
        <pub-id pub-id-type="pmid">28284194</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Christley S, et al. VDJPipe: a pre-processing pipeline for immune repertoire sequencing data. J Immunol. 2016;196(Suppl 1): p. 209.26.</mixed-citation>
    </ref>
  </ref-list>
</back>
