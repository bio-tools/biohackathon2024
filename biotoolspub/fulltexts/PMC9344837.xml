<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9344837</article-id>
    <article-id pub-id-type="pmid">35731204</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac401</article-id>
    <article-id pub-id-type="publisher-id">btac401</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>matOptimize: a parallel tree optimization method enables online phylogenetics for SARS-CoV-2</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ye</surname>
          <given-names>Cheng</given-names>
        </name>
        <aff><institution>Department of Electrical and Computer Engineering, University of California, San Diego</institution>, San Diego, CA 92093, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thornlow</surname>
          <given-names>Bryan</given-names>
        </name>
        <aff><institution>Department of Biomolecular Engineering, University of California, Santa Cruz</institution>, Santa Cruz, CA 95064, <country country="US">USA</country></aff>
        <aff><institution>Genomics Institute, University of California, Santa Cruz</institution>, Santa Cruz, CA 95064, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1697-1130</contrib-id>
        <name>
          <surname>Hinrichs</surname>
          <given-names>Angie</given-names>
        </name>
        <aff><institution>Genomics Institute, University of California, Santa Cruz</institution>, Santa Cruz, CA 95064, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kramer</surname>
          <given-names>Alexander</given-names>
        </name>
        <aff><institution>Department of Biomolecular Engineering, University of California, Santa Cruz</institution>, Santa Cruz, CA 95064, <country country="US">USA</country></aff>
        <aff><institution>Genomics Institute, University of California, Santa Cruz</institution>, Santa Cruz, CA 95064, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mirchandani</surname>
          <given-names>Cade</given-names>
        </name>
        <aff><institution>Department of Biomolecular Engineering, University of California, Santa Cruz</institution>, Santa Cruz, CA 95064, <country country="US">USA</country></aff>
        <aff><institution>Genomics Institute, University of California, Santa Cruz</institution>, Santa Cruz, CA 95064, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Torvi</surname>
          <given-names>Devika</given-names>
        </name>
        <aff><institution>Department of Bioengineering, University of California, San Diego</institution>, San Diego, CA 92093, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1140-2596</contrib-id>
        <name>
          <surname>Lanfear</surname>
          <given-names>Robert</given-names>
        </name>
        <aff><institution>Department of Ecology and Evolution, Research School of Biology, Australian National University, Canberra</institution>, ACT 2601, <country country="AU">Australia</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Corbett-Detig</surname>
          <given-names>Russell</given-names>
        </name>
        <aff><institution>Department of Biomolecular Engineering, University of California, Santa Cruz</institution>, Santa Cruz, CA 95064, <country country="US">USA</country></aff>
        <aff><institution>Genomics Institute, University of California, Santa Cruz</institution>, Santa Cruz, CA 95064, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5600-2900</contrib-id>
        <name>
          <surname>Turakhia</surname>
          <given-names>Yatish</given-names>
        </name>
        <xref rid="btac401-cor1" ref-type="corresp"/>
        <aff><institution>Department of Electrical and Computer Engineering, University of California, San Diego</institution>, San Diego, CA 92093, <country country="US">USA</country></aff>
        <!--yturakhia@ucsd.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac401-cor1">To whom correspondence should be addressed. <email>yturakhia@ucsd.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-06-22">
      <day>22</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>6</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>15</issue>
    <fpage>3734</fpage>
    <lpage>3740</lpage>
    <history>
      <date date-type="received">
        <day>06</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>21</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>09</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>29</day>
        <month>7</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac401.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Phylogenetic tree optimization is necessary for precise analysis of evolutionary and transmission dynamics, but existing tools are inadequate for handling the scale and pace of data produced during the coronavirus disease 2019 (COVID-19) pandemic. One transformative approach, online phylogenetics, aims to incrementally add samples to an ever-growing phylogeny, but there are no previously existing approaches that can efficiently optimize this vast phylogeny under the time constraints of the pandemic.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we present matOptimize, a fast and memory-efficient phylogenetic tree optimization tool based on parsimony that can be parallelized across multiple CPU threads and nodes, and provides orders of magnitude improvement in runtime and peak memory usage compared to existing state-of-the-art methods. We have developed this method particularly to address the pressing need during the COVID-19 pandemic for daily maintenance and optimization of a comprehensive SARS-CoV-2 phylogeny. matOptimize is currently helping refine on a daily basis possibly the largest-ever phylogenetic tree, containing millions of SARS-CoV-2 sequences.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The matOptimize code is freely available as part of the UShER package (<ext-link xlink:href="https://github.com/yatisht/usher" ext-link-type="uri">https://github.com/yatisht/usher</ext-link>) and can also be installed via bioconda (<ext-link xlink:href="https://bioconda.github.io/recipes/usher/README.html" ext-link-type="uri">https://bioconda.github.io/recipes/usher/README.html</ext-link>). All scripts we used to perform the experiments in this manuscript are available at <ext-link xlink:href="https://github.com/yceh/matOptimize-experiments" ext-link-type="uri">https://github.com/yceh/matOptimize-experiments</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Centers for Disease Control and Prevention BAA</institution>
          </institution-wrap>
        </funding-source>
        <award-id>200-2021-11554</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>T32HG008345</award-id>
        <award-id>F31HG010584</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Australian National University Futures</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Australian Research Council Discovery</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DP200103151</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Chan-Zuckerberg Initiative Grant for Essential Open Source Software for Science</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R35GM128932</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Eric and Wendy Schmidt Foundation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>With over 10 million genome sequences now available on online databases, SARS-CoV-2 is the most sequenced pathogen in history by far (<xref rid="btac401-B38" ref-type="bibr">Shu and McCauley, 2017</xref>). Phylogenetics has been a foundational tool in analyzing this vast volume of genomic data for a public health response during the coronavirus disease 2019 (COVID-19) pandemic (<xref rid="btac401-B19" ref-type="bibr">Hodcroft <italic toggle="yes">et al.</italic>, 2021</xref>). For example, phylogenetics has been instrumental in genomic surveillance, i.e. for identifying and naming its new variants (<xref rid="btac401-B34" ref-type="bibr">Rambaut <italic toggle="yes">et al.</italic>, 2020</xref>) and for tracking the different SARS-CoV-2 variants circulating in a given geographic region (<xref rid="btac401-B5" ref-type="bibr">da Silva Filipe <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac401-B6" ref-type="bibr">Deng <italic toggle="yes">et al.</italic>, 2020</xref>). Phylogenetic trees have also helped in establishing transmission links between infections (<xref rid="btac401-B25" ref-type="bibr">Lam-Hine, 2021</xref>), in disambiguating community transmission from outside introductions (<xref rid="btac401-B21" ref-type="bibr">Komissarov <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac401-B30" ref-type="bibr">McBroome <italic toggle="yes">et al.</italic>, 2022</xref>), in identifying the mutations that might have conferred increased transmissibility to the virus (<xref rid="btac401-B22" ref-type="bibr">Korber <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac401-B35" ref-type="bibr">Richard <italic toggle="yes">et al.</italic>, 2021</xref>), and for estimating the reproduction number (R0) of the virus and its variants (<xref rid="btac401-B24" ref-type="bibr">Lai <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac401-B43" ref-type="bibr">Volz <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
    <p>Many of these far-reaching applications benefit from having a comprehensive phylogenetic tree—one produced without subsampling the available sequences. For example, when all available SARS-CoV-2 sequences are not represented in a single phylogenetic tree, transmission links between isolates may be lost. Likewise, subsampled phylogenetic trees could omit important lineages or sublineages corresponding to different variants of the virus. This can have adverse consequences on the downstream evolutionary and epidemiological studies. A comprehensive and up-to-date phylogenetic tree is therefore an essential goal for the global health response to the SARS-CoV-2 pandemic.</p>
    <p>Online phylogenetics is a potentially transformative solution for the massive computational challenges imposed by continual genome sequence collection during the pandemic (<xref rid="btac401-B12" ref-type="bibr">Gill <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac401-B40" ref-type="bibr">Thornlow <italic toggle="yes">et al.</italic>, 2021</xref>). It involves incorporating new sequences as they become available onto an existing phylogeny and periodically refining the updated phylogeny. The recent development of UShER (<xref rid="btac401-B42" ref-type="bibr">Turakhia <italic toggle="yes">et al.</italic>, 2021b</xref>), which uses stepwise addition of new sequences onto an existing phylogenetic tree, helped overcome an important computational barrier for the maintenance of a comprehensive SARS-CoV-2 phylogenetic tree (<xref rid="btac401-B29" ref-type="bibr">McBroome <italic toggle="yes">et al.</italic>, 2021</xref>). For large SARS-CoV-2 phylogenies, UShER’s maximum parsimony (MP) approach has been demonstrated to perform well, even when compared to the far more computationally expensive maximum likelihood approaches available currently (<xref rid="btac401-B40" ref-type="bibr">Thornlow <italic toggle="yes">et al.</italic>, 2021</xref>). However, since UShER is based on the greedy approach of stepwise addition of new sequences, it sometimes places new sequences suboptimally in the tree (<xref rid="btac401-B42" ref-type="bibr">Turakhia <italic toggle="yes">et al.</italic>, 2021b</xref>; <xref rid="btac401-B39" ref-type="bibr">Takahashi and Nei, 2000</xref>). Tree optimization tools, which use tree rearrangement to find more optimal tree configurations, can help ameliorate this issue. However, in the recent 6 months (December 2021 to May 2022), the UShER-derived comprehensive SARS-CoV-2 phylogenetic tree size grew by 1.6-fold, with an average of approximately 21 000 additional sequences being incorporated each day. Approaches capable of daily tree optimization of the massive SARS-CoV-2 phylogeny are therefore an urgent necessity for emerging online phylogenetic toolkits.</p>
    <p>Phylogenetic tree optimization has been extensively studied in the context of MP, and tools such as TNT (<xref rid="btac401-B16" ref-type="bibr">Goloboff and Catalano, 2016</xref>), PAUP* (<xref rid="btac401-B44" ref-type="bibr">Swofford, 2003</xref>), MPBoot (<xref rid="btac401-B18" ref-type="bibr">Hoang <italic toggle="yes">et al.</italic>, 2018</xref>), PHYLIP (<xref rid="btac401-B8" ref-type="bibr">Felsenstein, 2005</xref>) and MEGA (<xref rid="btac401-B23" ref-type="bibr">Kumar <italic toggle="yes">et al.</italic>, 2018</xref>) are already available. Typically, tree optimization tools take as input an existing phylogenetic tree in the Newick format and the multiple sequence alignment (MSA) of the phylogenetic tips in FASTA format, then compute the parsimonious state assignments for every node of the tree for each alignment site, and then use tree rearrangement to find a more parsimonious tree. They also maintain multiple equally parsimonious candidate trees and sometimes use tree drifting (<xref rid="btac401-B16" ref-type="bibr">Goloboff and Catalano, 2016</xref>) during the optimization to avoid getting stuck in local optima. TNT also provides additional heuristics, such as sectorial search (<xref rid="btac401-B15" ref-type="bibr">Goloboff, 1999</xref>), to speed up tree search. Though these tools are remarkably efficient for the typical applications that they were developed for (such as for one-time species tree inference), they are inadequate for handling the scale and pace of the rapidly expanding SARS-CoV-2 data due to their prohibitive runtime and memory requirements.</p>
    <p>Here, we developed matOptimize, a novel MP-based tree optimization tool that uses several domain-specific optimization techniques to greatly speed up, and reduce the cost of, optimizing the comprehensive SARS-CoV-2 phylogeny. Compared to previous approaches, matOptimize uses novel memory-efficient data structures and algorithmic techniques to handle the vast scale of SARS-CoV-2 data, and it is more efficiently parallelized for multicore CPUs as well as high-performance computing (HPC) clusters. As a result, the resources allocated to matOptimize can be scaled to meet the computational requirements of the ever-expanding comprehensive SARS-CoV-2 phylogeny. matOptimize also effectively uses preprocessing and algorithmic strategies better suited for ‘online phylogenetics’, which for example enable it to achieve rapid improvements in parsimony score in early stages of the optimization. Our analysis on real data suggests that matOptimize indeed qualitatively improves the comprehensive SARS-CoV-2 phylogeny. Starting from an UShER-derived SARS-CoV-2 phylogeny, matOptimize provides roughly the same parsimony score improvement (used as a measure of tree quality) as the previous state-of-the-art for a moderately sized phylogeny, and is the only tool that meets the constraints of daily-optimization for the current scale of comprehensive SARS-CoV-2 phylogeny.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 matOptimize: algorithm description</title>
      <p>matOptimize is a parallel algorithm (<xref rid="btac401-F1" ref-type="fig">Fig. 1</xref>) for parsimony-based optimization of large SARS-CoV-2 phylogenies, where the parsimony score is derived based on characters in nucleotide space. matOptimize takes as input a starting phylogeny, such as the UShER-derived mutation-annotated tree [MAT; which is a file format that stores a phylogenetic tree in which the branches are annotated with the mutations that are inferred to have occurred on them (<xref rid="btac401-B42" ref-type="bibr">Turakhia <italic toggle="yes">et al.</italic>, 2021b</xref>)] or a Newick file, and an optional VCF file specifying the genotypes at the tips of the phylogeny. When a VCF input is provided, matOptimize uses a parallel implementation of the Fitch–Sankoff algorithm (<xref rid="btac401-B9" ref-type="bibr">Fitch, 1971</xref>; <xref rid="btac401-B37" ref-type="bibr">Sankoff, 1975</xref>) to infer the most parsimonious state for every VCF site at every branch of the tree. Otherwise, the algorithm accepts the states annotated in the MAT and skips to the next step. matOptimize allows the VCF file to specify ambiguous bases using the International Union of Pure and Applied Chemistry (IUPAC) format (<ext-link xlink:href="https://www.bioinformatics.org/sms/iupac.html" ext-link-type="uri">https://www.bioinformatics.org/sms/iupac.html</ext-link>). matOptimize uses an MAT format that has been modified to maintain ambiguous bases at tree leaves, entire Fitch sets at internal nodes and a few additional data fields to aid the optimization process (<xref rid="btac401-F1" ref-type="fig">Fig. 1C</xref>).</p>
      <fig position="float" id="btac401-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>An illustration of the matOptimize algorithm. (<bold>A</bold>) A flowchart of the different algorithmic stages in matOptimize. (<bold>B</bold>) An example of how matOptimize estimates the parsimony score improvement achievable from a single SPR move using a small number of steps without redoing the entire Fitch algorithm (<xref rid="btac401-B9" ref-type="bibr">Fitch, 1971</xref>). Each node of this tree has an integer label (1–12) and is annotated with its Fitch and boundary allele sets (Section 2). This example evaluates a move in which the subtree rooted at node 12 is pruned from node 9 and regrafted at node 4. For this move, the alleles in the Fitch set of node 12 (i.e. the single allele C) must be decremented at node 9 (during pruning) and incremented at node 4 (during regrafting). Since C is the only allele in the Fitch set of node 9, the alleles from the boundary allele set of node 9 get added to its Fitch set, resulting in an updated Fitch set {A, C}, with a lower major allele count. The change in Fitch set of node 9 is propagated upwards to its parent, i.e. to root node 1. During the pruning step, the decrement of the major allele count at node 9 has no effect on the parsimony score since it is offset by the decrement in the children count. During regrafting, since allele C, which is already present in the Fitch set of node 4, is incremented, its major allele count is now higher than the remaining alleles in the Fitch set, i.e. allele A, which is decremented. This change is propagated upwards, i.e. to parent node 2, but has no effect on it since allele A is not present in its Fitch set. Since the regrafting step also does not change the parsimony, the net parsimony score change of this move is 0. (<bold>C</bold>) Storage requirements for a mutation in the MAT data structure of matOptimize. This is a modified version of the original MAT proposed in UShER (<xref rid="btac401-B42" ref-type="bibr">Turakhia et al., 2021b</xref>) in order to maintain auxiliary information (such as Fitch and boundary allele sets) for performing optimization. Each mutation in matOptimize is stored compactly using only 8 bytes, which helps it maintain a small memory footprint overall. (<bold>D</bold>) An example phylogenetic tree (left) and its corresponding index tree (right). The index tree is used to speed up the search for promising destination nodes for SPR moves from a single source node via search space pruning (Section 2). Each node in the phylogenetic tree is annotated with (i) a pre-order traversal index, (ii) the depth of the node, (iii) the final allele assignment and (iv) the sensitive allele (Section 2). The index tree uses a B-Tree (<xref rid="btac401-B4" ref-type="bibr">Cormen, 2009</xref>; <xref rid="btac401-B20" ref-type="bibr">Knuth, 2011</xref>) to store the nodes at which the sensitive alleles are found (Section 2). Each node in the index tree corresponds to one node in the phylogenetic tree and stores the DFS index range of the subtree that the node covers and the minimum depth within the subtree at which a sensitive allele may be encountered. ‘N/A’ implies that the allele is not present in the subtree</p>
        </caption>
        <graphic xlink:href="btac401f1" position="float"/>
      </fig>
      <p>The matOptimize algorithm (<xref rid="btac401-F1" ref-type="fig">Fig. 1</xref>) performs several iterations of optimization consisting of two phases: (i) the parallel search phase, which searches for parsimony-reducing subtree pruning and regrafting (SPR) moves from multiple starting nodes in parallel while holding the starting tree constant and (ii) the non-conflicting moves application phase, in which a subset of the profitable moves that were discovered during the parallel search are applied to the starting tree. These phases are described in more detail below. The iterations continue until the percent parsimony score improvement in the last iteration is less than the user-specified threshold (δ in <xref rid="btac401-F1" ref-type="fig">Fig. 1A</xref>, default: 0.5%), or the wall-clock time limit specified by the user (default: unlimited) is exceeded (<xref rid="btac401-F1" ref-type="fig">Fig. 1A</xref>). Only one tree is maintained throughout the optimization in matOptimize. We use the following terminologies for the remaining description of the algorithm:
</p>
      <list list-type="bullet">
        <list-item>
          <p><italic toggle="yes">Child node:</italic> A direct descendant of a node in the tree.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Tree depth:</italic> The distance from root to a node.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Allele:</italic> The nucleotide found or inferred at a particular genomic position.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Fitch set:</italic> The most common allele(s) among the Fitch sets of the children of the current node. On leaf nodes, Fitch sets are observed alleles.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Least common ancestor (LCA) nodes:</italic> The node furthest from the root that is the ancestor of both source node and destination node.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">DFS:</italic> Pre-order depth first search.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Allele frequency:</italic> The number of children of the node that contains the allele in its Fitch set. On leaf nodes, zero for alleles not observed, 1 for observed alleles.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Major allele frequency:</italic> Allele frequency of an allele in the Fitch set (the same for all alleles in the Fitch set).</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Boundary allele set:</italic> Alleles whose frequency is exactly one less than the major allele frequency. This set is updated once before every parallel search phase in every iteration.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Final state:</italic> A single allele inside the major allele set obtained by arbitrary tie-breaking strategy among multiple equally parsimonious alleles.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">An allele is incremented:</italic> An allele is added to the Fitch set.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">An allele is decremented:</italic> An allele is removed from the Fitch set.</p>
        </list-item>
        <list-item>
          <p><italic toggle="yes">Sensitive allele:</italic> An allele that will improve the parsimony score of the tree when incremented alone, excluding parent alleles. Parent alleles are excluded because they do not contribute to parsimony scores.</p>
        </list-item>
      </list>
      <sec>
        <title>2.1.1 Parallel search phase</title>
        <p>In this phase, multiple nodes are searched in parallel for SPR moves within a fixed radius that may reduce the parsimony score. In the first iteration, all nodes in the tree are considered for SPR moves. In subsequent iterations, SPR moves starting from only those nodes that are within a fixed radius of nodes that were modified through pruning or regrafting of an SPR move in the previous iteration are considered. The SPR radius in the first iteration is limited to 2, and this limit doubles at the end of every iteration. To calculate the parsimony score change of a single move, matOptimize uses a modified version of Gladstein’s incremental update method (<xref rid="btac401-B13" ref-type="bibr">Gladstein, 1997</xref>) that can also handle polytomies. When sample genotypes are specified through an input VCF file, matOptimize first pre-processes the tree to calculate the Fitch set, boundary allele set and final state for every site at every node of the tree using a reverse breadth-first traversal.matOptimize calculates the change in parsimony score from a single move by tracking the change in major allele frequency as the effect of the move propagates toward the root (i.e. in a reverse pre-order traversal order). <xref rid="btac401-F1" ref-type="fig">Figure 1B</xref> illustrates this with an example SPR move. An allele can be incremented (i.e. added to the Fitch set from the boundary allele set) at a node if: (i) it is incremented in any of its children nodes (e.g. in <xref rid="btac401-F1" ref-type="fig">Fig. 1B</xref>, allele A is incremented at node 1 after an increment of A at its child node 9) or (ii) all alleles in the Fitch set are decremented in any of its children nodes (e.g. in <xref rid="btac401-F1" ref-type="fig">Fig. 1B</xref>, allele A is decremented at node 9 after a decrement of the single allele C in the Fitch set of its child node 12). Similarly, an allele is decremented when it has been decremented in any of its children nodes, or if some other alleles in the Fitch set have been incremented in any of its children nodes (e.g. in <xref rid="btac401-F1" ref-type="fig">Fig. 1B</xref>, allele A at node 4 is decremented from an increment of C at 12). Finally, the parsimony score is calculated as the sum of change in children count minus change in major allele count at each node on the path from source or destination node to root. The starting tree remains immutable and shared among all threads throughout the parallel search phase, so the memory consumption only increases negligibly with the number of threads.</p>
      </sec>
      <sec>
        <title>2.1.2 Parallelization of the parallel search phase</title>
        <p>In matOptimize, different source nodes are evaluated in parallel to find profitable SPR moves during the parallel search phase. Parallelism across different instances of a CPU cluster is achieved through multiprocessing that is implemented using the message passing interface (<xref rid="btac401-B17" ref-type="bibr">Gropp <italic toggle="yes">et al.</italic>, 1999</xref>). At the start of a new iteration, the main process broadcasts the intermediate MAT to all worker processes, assigns unique source nodes to each process to evaluate and collects the profitable moves found by worker processes. For load balancing, each worker process maintains its own running estimate of the throughput of the number of source nodes processed per minute and requests source nodes corresponding to a maximum of 1 min of workload from the main process at a time. matOptimize also parallelizes source node evaluation on multiple threads of a single instance using Intel’s TBB library (<ext-link xlink:href="https://github.com/oneapi-src/oneTBB" ext-link-type="uri">https://github.com/oneapi-src/oneTBB</ext-link>). Here, source nodes assigned to a process are uniformly partitioned on each available thread, which then evaluates all the SPR moves originating within the specified radius from its corresponding source node. By default, matOptimize not only creates CPU threads to utilize all available cores on a CPU instance but also allows the number of threads to be specified by the user as a command-line argument.</p>
      </sec>
      <sec>
        <title>2.1.3 Search space pruning</title>
        <p>To minimize the number of non-profitable moves explored from a source node in the parallel search phase, matOptimize quickly calculates a lower bound of parsimony score change of moving the pruned subtree to other nodes within a specified radius. It does this by first pre-computing the sensitive alleles for each site at each node using a dynamic programming algorithm. The sensitive allele sets are then organized into a B-Tree (<xref rid="btac401-B4" ref-type="bibr">Cormen, 2009</xref>; <xref rid="btac401-B20" ref-type="bibr">Knuth, 2011</xref>), called index tree (<xref rid="btac401-F1" ref-type="fig">Fig. 1D</xref>), using the DFS index of the nodes. The internal nodes of the index tree are also annotated with the minimum depth at which each allele will be encountered and corresponding the DFS indices of phylogenetic tree nodes it covers (<xref rid="btac401-F1" ref-type="fig">Fig. 1D</xref>). The parsimony score change lower bound is initialized with the parsimony score change that would result from removing the source node alone. Then, matOptimize queries the index tree for the minimum depth at which the allele that source node carries may be encountered. If it is larger than the maximum radius minus the distance between the source node and the node being examined, the lower bound of parsimony score change is incremented. In this step, the DFS index range in the index tree is queried to find the minimum depth of the node in the subtree of the currently examined node at which the sensitive allele may be encountered. All destination nodes in a subtree rooted at the node being examined are skipped if the parsimony score change lower bound at this node is higher than that of the most profitable move from the source node found so far (<xref rid="btac401-F1" ref-type="fig">Fig. 1D</xref>).</p>
      </sec>
      <sec>
        <title>2.1.4 Non-conflicting moves application phase</title>
        <p>Moves that share nodes on the paths from source nodes to destination nodes are defined to be conflicting as they cannot be simultaneously applied. Empirically, most profitable moves found in the parallel search phase have one or more conflicts. Among conflicting moves, matOptimize accepts the most profitable move and defers the remaining to the next iteration. Then, all non-conflicting moves are applied in a batch. matOptimize recomputes the Fitch and boundary allele sets of the altered nodes and their ancestors serially in post-order traversal order. If the parsimony score is found to increase during the application of a non-conflicting move, matOptimize terminates the current iteration and begins a new one. Sensitive alleles are recomputed from scratch at the beginning of every new iteration. Profitable source nodes in the last iteration are searched again, until there is no parsimony improvement, after which a new round of iterations is started with doubled SPR radius and all possible source nodes.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Tree evaluation</title>
      <p>To calculate the likelihood scores of our trees, we used IQ-TREE2 (<xref rid="btac401-B31" ref-type="bibr">Minh <italic toggle="yes">et al.</italic>, 2020</xref>) COVID-19 release 2.1.3, with Jukes-Cantor (JC) model and a minimum branch length of 1e-11. Trees were visualized with Taxonium (<ext-link xlink:href="https://cov2tree.org/" ext-link-type="uri">https://cov2tree.org/</ext-link>). Pango lineages for sequences were assigned using the Pangolin software (<xref rid="btac401-B33" ref-type="bibr">O’Toole <italic toggle="yes">et al.</italic>, 2021</xref>) and parsimony scores for the lineage assignments were computed using TNT (<xref rid="btac401-B16" ref-type="bibr">Goloboff and Catalano, 2016</xref>), taking clade assignment as binary characters.</p>
    </sec>
    <sec>
      <title>2.3 Datasets</title>
      <p>We collected SARS-CoV-2 genome sequence data from major online databases: GISAID (<xref rid="btac401-B38" ref-type="bibr">Shu and McCauley, 2017</xref>), COG-UK (<xref rid="btac401-B32" ref-type="bibr">Nicholls <italic toggle="yes">et al.</italic>, 2020</xref>), GenBank (<xref rid="btac401-B3" ref-type="bibr">Clark <italic toggle="yes">et al.</italic>, 2016</xref>) and CNCB (<ext-link xlink:href="https://bigd.big.ac.cn/ncov/release_genome" ext-link-type="uri">https://bigd.big.ac.cn/ncov/release_genome</ext-link>) until August 25, 2021 and used it to build a comprehensive SARS-CoV-2 phylogeny based on the methodology described in <xref rid="btac401-B29" ref-type="bibr">McBroome <italic toggle="yes">et al.</italic> (2021)</xref>. We used the GenBank MN908947.3 (RefSeq NC_045512.2) sequence as the reference for rooting the tree and used the sampling date metadata to derive from our comprehensive tree three subtrees containing the earliest 100K, 1M and 3M samples, referred to as 100K-sample tree, 1M-sample tree and 3M-sample tree, respectively. The GISAID Data Access Agreement prohibits the sharing of these datasets, but allows us to communicate it to GISAID members on request.</p>
      <p>To test generalizability of matOptimize, we also collected a <italic toggle="yes">Mycobacterium tuberculosis</italic> dataset consisting of 10 248 <italic toggle="yes">M.</italic><italic toggle="yes">tuberculosis</italic> samples from the NCBI Sequence Read Archive (<xref rid="btac401-B28" ref-type="bibr">Leinonen <italic toggle="yes">et al.</italic>, 2011</xref>) and generated a multisample VCF with a GATK-based pipeline (<ext-link xlink:href="https://github.com/cademirch/ccgp_workflow" ext-link-type="uri">https://github.com/cademirch/ccgp_workflow</ext-link>). The multisample VCF was then compressed with GENOZIP (<xref rid="btac401-B26" ref-type="bibr">Lan <italic toggle="yes">et al.</italic>, 2021</xref>) and is made available at <ext-link xlink:href="https://doi.org/10.6084/m9.figshare.19799374" ext-link-type="uri">https://doi.org/10.6084/m9.figshare.19799374</ext-link>. We then removed all samples for which fewer than 95% of polymorphic sites contained a genotype. The resulting multisample VCF was then used to infer a <italic toggle="yes">de novo</italic> phylogenetic tree using UShER (<xref rid="btac401-B42" ref-type="bibr">Turakhia <italic toggle="yes">et al.</italic>, 2021b</xref>). To do this, we seeded UShER with a “tree” that contained just the reference sequence and then we added each sample sequentially until each had been added and we saved the final mutation-annotated tree file.</p>
    </sec>
    <sec>
      <title>2.4 Baseline comparison</title>
      <sec>
        <title>2.4.1 Performance benchmarking</title>
        <p>Among the available tree optimization programs, we found TNT (<xref rid="btac401-B16" ref-type="bibr">Goloboff and Catalano, 2016</xref>) (June 2021 version) to be the only suitable baseline for comparison with matOptimize on large SARS-CoV-2 datasets. We could not compare with PAUP* (<xref rid="btac401-B44" ref-type="bibr">Swofford, 2003</xref>), as it limits the tree size to only 16K taxa. Similarly, we found that MPBoot (<xref rid="btac401-B18" ref-type="bibr">Hoang <italic toggle="yes">et al.</italic>, 2018</xref>) fails due to the prevalence of identical sequences in SARS-CoV-2 datasets. Other tools, such as PHYLIP (<xref rid="btac401-B8" ref-type="bibr">Felsenstein, 2005</xref>) and MEGA (<xref rid="btac401-B23" ref-type="bibr">Kumar <italic toggle="yes">et al.</italic>, 2018</xref>), infer a <italic toggle="yes">de novo</italic> tree from the input alignment on every run, and therefore cannot be used in the online phylogenetics framework.</p>
        <p>Given its high peak memory requirements, we used a single m1-ultramem-40 instance (40 vCPUs, 961 GB, $6.30/h) for TNT. For matOptimize, we used seven e2-highcpu-32 instances for matOptimize that cumulatively have an hourly cost ($5.54/h) comparable to the m1-ultramem-40 instance. The peak memory requirements were estimated by reading the resident set size of each process every 2 min. The parsimony scores were computed after rerooting the trees to GenBank MN908947.3 (RefSeq NC_045512.2).</p>
      </sec>
      <sec>
        <title>2.4.2 Parallelization of TNT</title>
        <p>TNT does not natively include a multithreaded optimization mode, so in order to parallelize it, we used multiple processes performing exclusive sectorial search (XSS), which had better performance compared to parsimony ratchet, tree drifting or direct branch swapping modes in TNT (<xref rid="btac401-B16" ref-type="bibr">Goloboff and Catalano, 2016</xref>). In the XSS mode, TNT splits the tree into non-overlapping sectors of roughly equal size and optimizes each sector separately using tree bisection and reconnection (TBR) moves. If the parsimony score improves within the sector, TNT uses it to replace the corresponding sector in the starting tree. We parallelized XSS by splitting the starting tree into 10 non-overlapping sectors, which offered the best runtime and parsimony score tradeoff. During global TBR moves, we let each TNT process optimize the entire tree independently and broadcast the tree to other processes. We parallelized TNT with the highest number of processes possible within the available memory of the instances. This corresponded to 40, 8 and 1 processes for 100K-sample, 1M-sample and 3M-sample SARS-CoV-2 trees, respectively.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 matOptimize rapidly and efficiently optimizes massive SARS-CoV-2 phylogenies</title>
      <p>We used the database of UShER-based SARS-CoV-2 trees (<xref rid="btac401-B29" ref-type="bibr">McBroome <italic toggle="yes">et al.</italic>, 2021</xref>) to pick phylogenies at three different time points, containing 100K, 1M and 3M samples, respectively. We used these as starting phylogenies to compare the performance of matOptimize with TNT (<xref rid="btac401-B16" ref-type="bibr">Goloboff and Catalano, 2016</xref>), the fastest and most efficient MP-based tree optimization tool currently available (<xref rid="btac401-F2" ref-type="fig">Fig. 2</xref>). Since TNT is not multithreaded, it had to be manually parallelized across multiple processes (Section 2). We also limited the optimization to 24 h to meet the constraints for enabling daily tree optimization which is required for comprehensive phylogenetics during the pandemic. Of the three trees we evaluated, TNT (<xref rid="btac401-B15" ref-type="bibr">Goloboff, 1999</xref>) completed its optimization for only one, i.e. the smallest 100K-sample tree, achieving a parsimony score improvement of 0.63% in 1.13 h. matOptimize completed this tree optimization 19× faster and with 37× lower peak memory (<xref rid="btac401-F2" ref-type="fig">Fig. 2A</xref>), achieving a comparable but slightly smaller parsimony improvement of 0.59%. The smaller parsimony score improvement of matOptimize could be explained by the fact that it searches from one starting tree and uses SPR moves only, which have a smaller search space than the TBR moves and the independent search of multiple trees used in TNT (<xref rid="btac401-B14" ref-type="bibr">Goloboff, 1996</xref>). matOptimize achieved 5× improvement over TNT on the 100K-sample tree even when executed on the same CPU instance as TNT with an identical number of threads (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
      <fig position="float" id="btac401-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Comparison of parsimony score improvement and peak memory requirement of matOptimize and TNT starting from an SARS-CoV-2-based UShER-derived (<bold>A</bold>) 100K-sample tree, (<bold>B</bold>) 1M-sample tree and (<bold>C</bold>) 3M-sample tree. For (C), the peak memory requirement is not shown since TNT did not begin the optimization phase by the time it was terminated after 24 h of execution</p>
        </caption>
        <graphic xlink:href="btac401f2" position="float"/>
      </fig>
      <p>The benefits of matOptimize become apparent when the tree size gets larger—it completed optimization for the 3M-sample tree in only 7.7 h (<xref rid="btac401-F2" ref-type="fig">Fig. 2C</xref>). On this tree, TNT did not even start applying profitable moves within the 24-h time limit. This is because, for the scale of this tree, TNT was still loading the input files and initializing its internal data structures when the 24-h cutoff was reached. Since matOptimize also uses SPR radius doubling at each iteration, and since smaller radii iterations are quick to complete, the largest improvements in parsimony score are achieved very quickly during optimization (<xref rid="btac401-F2" ref-type="fig">Fig. 2</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). Due to its memory-efficient internal data structures and parallel implementation of the Fitch–Sankoff algorithm during initialization (Sections 2 and 4), matOptimize starts optimizing the tree after a small delay, which is desirable for time-constrained optimization scenarios imposed by the COVID-19 pandemic. In contrast, TNT incurs a long startup delay followed by a slow improvement of parsimony. matOptimize is therefore especially well-suited for SARS-CoV-2 online phylogenetics (<xref rid="btac401-B40" ref-type="bibr">Thornlow <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
      <p>Detailed analysis of the resulting tree revealed that matOptimize indeed improves the tree quality. For example, on the 100K-sample tree, the 0.59% parsimony score improvement also translated into a 0.48% improvement in the log-likelihood score—from -919354.028 to -914925.186. For the TNT-optimized tree, the log-likelihood is even higher, -914592.653, i.e. 0.51% higher than the starting tree. This is consistent with our previous analyses (<xref rid="btac401-B40" ref-type="bibr">Thornlow <italic toggle="yes">et al.</italic>, 2021</xref>) in which we observed that parsimony and likelihood scores are strongly correlated for SARS-CoV-2 phylogenies. We also observed that in some cases, the PangoLEARN lineage assignments (<xref rid="btac401-B33" ref-type="bibr">O’Toole <italic toggle="yes">et al.</italic>, 2021</xref>) appeared a little less dispersed through the tree (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>), with the Pango lineage parsimony score decreasing from 17043 to 17014 post-optimization with matOpimize. Here, the small improvement through optimization reaffirms the observation that even the stepwise addition of samples through UShER has high accuracy for lineage assignments (<xref rid="btac401-B7" ref-type="bibr">Dudas <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac401-B29" ref-type="bibr">McBroome <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
    </sec>
    <sec>
      <title>3.2 matOptimize scales well in runtime and memory requirement with the number of available processors</title>
      <p>Efficient parallelism ensures that matOptimize can keep up with the increasing computational demands for optimizing SARS-CoV-2 phylogenies. We designed it to parallelize over all available virtual cores on a CPU (vCPUs), as well as a large number of CPUs available in an HPC cluster, which includes cloud platforms. <xref rid="btac401-F3" ref-type="fig">Figure 3A</xref> shows that matOptimize shows a high strong scaling efficiency. matOptimize requires 109 min to complete one round of optimization on the 1M-sample tree with 64 vCPUs over two CPU instances, which reduces to 11.5 min with 1024 vCPUs over 32 CPU instances (scaling efficiency of 59%, <xref rid="btac401-F3" ref-type="fig">Fig. 3A</xref>). In the latter, the parallel search for profitable moves required 7.5 min and the sequential step of applying the moves took 4 min. We therefore expect strong scaling efficiency to improve as the SARS-CoV-2 tree gets bigger, and the parallel search phase consumes a larger fraction of the total runtime.</p>
      <fig position="float" id="btac401-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Performance and memory scaling efficiency of matOptimize using the 1M-sample tree. (<bold>A</bold>) Strong multi-node scaling efficiency of matOptimize. Each node is a GCP instance e2-highcpu-32 consisting of 32 vCPUs and 32 GB memory. The number above each data point corresponds to the actual runtime in minutes: seconds format. (<bold>B</bold>) The peak memory requirement of matOptimize is small (below 10 GB) and remains roughly constant with the number of CPU threads. This allows matOptimize to exploit all available parallelism on a multicore CPU instance without being limited by the available memory. (<bold>C</bold>) In comparison, the peak memory requirement of TNT is large (&gt;500 GB) and increases linearly as the parallelism is increased. This limits the amount of parallelism that TNT can exploit—in the example shown, TNT could exploit only up to 8 available vCPUs out of the 40 available on the memory-optimized GCP instance m1-ultramem-40 before running out of memory</p>
        </caption>
        <graphic xlink:href="btac401f3" position="float"/>
      </fig>
      <p>A key reason why matOptimize scales efficiently is its low memory requirement. This is enabled through its compact MAT data structure derived from UShER, which we use in lieu of the traditional matrix representation of the MSA in existing frameworks (<xref rid="btac401-F1" ref-type="fig">Figs. 1C</xref> and <xref rid="btac401-F2" ref-type="fig">3B</xref>, <xref rid="btac401-F3" ref-type="fig">Section 2</xref>). When the number of CPU threads used by matOptimize is increased from 4 to 32, the memory requirement for the 1M-sample SARS-CoV-2 tree increases only marginally, from 9.38 to 9.84 GB (<xref rid="btac401-F3" ref-type="fig">Fig. 3B</xref>). In contrast, the large and linear memory requirement of TNT limits the amount of parallelism it can exploit (<xref rid="btac401-F3" ref-type="fig">Fig. 3C</xref>). For example, with the 1M-sample SARS-CoV-2 tree, we could only parallelize TNT to utilize 8 of the 40 available vCPUs on the m1-ultramem-40 instance that we used on the Google Cloud Platform (GCP), since eight TNT processes consumed nearly all of 961 GB available memory on this instance. It is therefore unlikely that TNT would scale to the much larger SARS-CoV-2 phylogenies anticipated in the future due to its prohibitive memory requirement.</p>
    </sec>
    <sec>
      <title>3.3 Larger SPR radii provide smaller, but measurable improvements in parsimony score</title>
      <p>We explored the contribution of different SPR radii to the improvement in parsimony score on the 100K-sample tree, 1M-sample tree and the 3M-sample tree (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). On the 100K-sample tree, a small SPR radius of 2 alone could achieve 70% of the total parsimony score improvement. For the 3M-sample tree, SPR moves of radius 2 could achieve only 20% of the total possible parsimony score improvement. However, even for larger trees, the parsimony score still improves most rapidly with small radii (<xref rid="btac401-F2" ref-type="fig">Fig. 2</xref>)—90% of parsimony improvement is achieved with less than 25% of the total runtime for both the 1M-sample and 3M-sample trees. Therefore, matOptimize doubles the search radius after each round in order to provide the largest parsimony improvement at the early stages of optimization. The difference between radius doubling and fixed large radius strategy is negligible (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). Combined with the small preprocessing time, this radius doubling strategy makes matOptimize particularly suitable for ‘online’ optimization of large SARS-CoV-2 phylogenies. The reason is that it may be necessary to halt optimization if the runtime exceeds the time allowed until additional sample additions are necessary.</p>
    </sec>
    <sec>
      <title>3.4 matOptimize also performs well on a <italic toggle="yes">M.tuberculosis</italic> dataset</title>
      <p>To investigate whether matOptimize generalizes well to other datasets for which online phylogenetics may be useful, we used matOptimize to optimize an UShER-derived starting tree of approximately 10K <italic toggle="yes">M.</italic><italic toggle="yes">tuberculosis</italic> genomes and compared it to TNT (Section 2). We found matOptimize to provide over an order of magnitude improvement in runtime (15×) and peak memory (51×) relative to TNT on this dataset as well (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). Notably, matOptimize completed the entire optimization in only 6 min, whereas it took TNT 1 h 22 min to even begin the optimization process and an additional 8 min to complete it. Though the parsimony improvement in the TNT tree was noticeably higher than matOptimize (0.61% versus 0.48%), the log-likelihood score of the two trees differed only by 0.012%. Our results seem to indicate that matOptimize may generalize well to large datasets beyond SARS-CoV-2.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Several evolutionary studies, such as inferring SARS-CoV-2 recombination (<xref rid="btac401-B41" ref-type="bibr">Turakhia <italic toggle="yes">et al.</italic>, 2021a</xref>) or characterizing the transmissibility of different mutations (<xref rid="btac401-B35" ref-type="bibr">Richard <italic toggle="yes">et al.</italic>, 2021</xref>), rely on, or can benefit from, the knowledge of a comprehensive SARS-CoV-2 phylogenetic tree. Currently, the UCSC Genome Browser uses a comprehensive SARS-CoV-2 phylogenetic tree which is updated daily through phylogenetic placements of new sequences performed by UShER (<xref rid="btac401-B27" ref-type="bibr">Lee <italic toggle="yes">et al.</italic>, 2022</xref>). This tree is being used widely by health officials and researchers worldwide through UShER’s command line (<ext-link xlink:href="https://github.com/yatisht/usher" ext-link-type="uri">https://github.com/yatisht/usher</ext-link>) and web interface (<ext-link xlink:href="https://genome.ucsc.edu/cgi-bin/hgPhyloPlace" ext-link-type="uri">https://genome.ucsc.edu/cgi-bin/hgPhyloPlace</ext-link>) to perform genomic surveillance (<xref rid="btac401-B1" ref-type="bibr">Abe and Arita, 2021</xref>; <xref rid="btac401-B7" ref-type="bibr">Dudas <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac401-B10" ref-type="bibr">Foster <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btac401-B11" ref-type="bibr">Garushyants <italic toggle="yes">et al.</italic>, 2021</xref>) and contact tracing (<xref rid="btac401-B25" ref-type="bibr">Lam-Hine, 2021</xref>) of the COVID-19 pathogen. This tree has also been applied for SARS-CoV-2 lineage assignment in the optional mode of Pangolin (<ext-link xlink:href="https://github.com/cov-lineages/pangolin/" ext-link-type="uri">https://github.com/cov-lineages/pangolin/</ext-link><underline>),</underline> the most widely used scientific nomenclature system for SARS-CoV-2 lineages (<xref rid="btac401-B34" ref-type="bibr">Rambaut <italic toggle="yes">et al.</italic>, 2020</xref>), as well as in several recently developed phylogenetic toolkits (<xref rid="btac401-B2" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac401-B30" ref-type="bibr">McBroome <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btac401-B36" ref-type="bibr">Sanderson, 2021</xref>). GISAID’s Audacity tree (<xref rid="btac401-B38" ref-type="bibr">Shu and McCauley, 2017</xref>) is also based on the UShER package. Maintaining a high-quality comprehensive SARS-CoV-2 phylogeny consisting of all available SARS-CoV-2 sequences has emerged as a problem of utmost importance during the COVID-19 pandemic.</p>
    <p>Currently, matOptimize appears to be the only viable tree optimization tool for SARS-CoV-2 online phylogenetics. matOptimize’s performance is the result of several optimization and parallelization techniques that it incorporates. For example, matOptimize benefits from the recently developed, space-efficient data structure of an MAT—an uncompressed MAT file of 3 million SARS-CoV-2 sequence requires only 136 MB to encode basically the same information that is contained in an 88 GB MSA FASTA file. By using a modified MAT, matOptimize can compactly store all the information necessary for optimization and avoid the high cost of maintaining the entire alignment in memory. Widely used phylogenetic programs, such as TNT (<xref rid="btac401-B16" ref-type="bibr">Goloboff and Catalano, 2016</xref>), MPBoot (<xref rid="btac401-B18" ref-type="bibr">Hoang <italic toggle="yes">et al.</italic>, 2018</xref>) and MEGA (<xref rid="btac401-B23" ref-type="bibr">Kumar <italic toggle="yes">et al.</italic>, 2018</xref>), use strategies for parsimony score optimization that are far too expensive at SARS-CoV-2-scale. As a result of its scale up (more vCPUs per node) and scale out (more CPU nodes) capability, matOptimize is the only parsimony-based tree optimization software that is currently able to meet the computational demands for optimizing the ever-increasing SARS-CoV-2 phylogeny. Overall, matOptimize is 1–2 orders of magnitude more cost and memory efficient than the state-of-the-art, and we expect that matOptimize would help maintain a high-quality comprehensive SARS-CoV-2 phylogeny for several months to come. It also appears to generalize well to large datasets beyond SARS-CoV-2 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>) and could be applicable to other densely sampled pathogens in the future.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac401_Supplementary_Data</label>
      <media xlink:href="btac401_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the Willi Hennig Society for the TNT software. We thank Bui Quang Minh and Diep Thi Hoang for helpful discussions about MPBoot.</p>
    <sec>
      <title>Funding</title>
      <p>C.Y., A.K. and Y.T. were supported by the Centers for Disease Control and Prevention BAA 200-2021-11554. B.T. was supported by the National Institutes of Health grants T32HG008345 and F31HG010584. R.L. is supported by an Australian National University Futures Grant, an Australian Research Council Discovery Grant [DP200103151] and a Chan-Zuckerberg Initiative Grant for Essential Open Source Software for Science. R.C.-D was supported by the National Institutes of Health grant R35GM128932. This work was also supported by the generous donations by the Eric and Wendy Schmidt Foundation.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
    <sec sec-type="data-availability">
      <title>Data availability</title>
      <p>The 100K and 1M-sample SARS-CoV-2 trees used in this study are made available at <ext-link xlink:href="https://academic.oup.com/journals/pages/open_access/funder_policies/chorus/standard_publication_model" ext-link-type="uri">https://github.com/yceh/matOptimize-experiments</ext-link>. The larger 3M-sample SARS-CoV-2 dataset relies on GISAID data and its access agreement prohibits sharing it publicly but it will be shared with GISAID members on request to the corresponding author. The multisample VCF used for the <italic toggle="yes">Mycobacterium tuberculosis</italic> dataset is made available at <ext-link xlink:href="https://doi.org/10.6084/m9.figshare.19799374" ext-link-type="uri">https://doi.org/10.6084/m9.figshare.19799374</ext-link>.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac401-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Abe</surname><given-names>T.</given-names></string-name>, <string-name><surname>Arita</surname><given-names>M.</given-names></string-name></person-group> (<year>2021</year>) <source>Genomic surveillance in Japan of AY.29—a new sub-lineage of SARS-CoV-2 delta variant with C5239T and T5514C mutations</source>. medRxiv, <pub-id pub-id-type="doi">10.1101/2021.09.20.21263869</pub-id>.</mixed-citation>
    </ref>
    <ref id="btac401-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) CoV-spectrum: analysis of globally shared SARS-CoV-2 data to identify and characterize new variants. <italic toggle="yes">Bioinformatics</italic>, <volume>38</volume>, <fpage>1735</fpage>–<lpage>1737</lpage>.</mixed-citation>
    </ref>
    <ref id="btac401-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Clark</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>GenBank</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>D67</fpage>–<lpage>D72</lpage>.<pub-id pub-id-type="pmid">26590407</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B4">
      <mixed-citation publication-type="book"><person-group person-group-type="editor"><string-name><surname>Cormen</surname><given-names>T.H.</given-names></string-name></person-group>, ed. (<year>2009</year>) <source>Introduction to Algorithms</source>. <edition>3rd edn</edition>. <publisher-name>MIT Press</publisher-name>, <publisher-loc>Cambridge, MA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btac401-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>da Silva Filipe</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal>; COVID-19 Genomics UK (COG-UK) Consortium. (<year>2021</year>) <article-title>Genomic epidemiology reveals multiple introductions of SARS-CoV-2 from mainland Europe into Scotland</article-title>. <source>Nat. Microbiol</source>., <volume>6</volume>, <fpage>112</fpage>–<lpage>122</lpage>.<pub-id pub-id-type="pmid">33349681</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deng</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Genomic surveillance reveals multiple introductions of SARS-CoV-2 into Northern California</article-title>. <source>Science</source>, <volume>369</volume>, <fpage>582</fpage>–<lpage>587</lpage>.<pub-id pub-id-type="pmid">32513865</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dudas</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Emergence and spread of SARS-CoV-2 lineage B.1.620 with variant of concern-like mutations and deletions</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>5769</fpage>.<pub-id pub-id-type="pmid">34599175</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B8">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Felsenstein</surname><given-names>J.</given-names></string-name></person-group> (<year>2005</year>) <source>PHYLIP (Phylogeny Inference Package) Department of Genome Sciences</source>. <publisher-name>University of Washington</publisher-name>, <publisher-loc>Seattle, WA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btac401-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fitch</surname><given-names>W.M.</given-names></string-name></person-group> (<year>1971</year>) <article-title>Toward defining the course of evolution: minimum change for a specific tree topology</article-title>. <source>Syst. Biol</source>., <volume>20</volume>, <fpage>406</fpage>–<lpage>416</lpage>.</mixed-citation>
    </ref>
    <ref id="btac401-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Foster</surname><given-names>C.S.P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2022</year>) <article-title>Assessment of inter-laboratory differences in SARS-CoV-2 consensus genome assemblies between public health laboratories in Australia</article-title>. <source>Viruses</source>, <volume>14</volume>, <fpage>185</fpage>.<pub-id pub-id-type="pmid">35215779</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Garushyants</surname><given-names>S.K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <source>Insertions in SARS-CoV-2 genome caused by template switch and duplications give rise to new variants that merit monitoring</source>. <pub-id pub-id-type="doi">10.1101/2021.04.23.441209</pub-id>.</mixed-citation>
    </ref>
    <ref id="btac401-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gill</surname><given-names>M.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Online Bayesian phylodynamic inference in BEAST with application to epidemic reconstruction</article-title>. <source>Mol. Biol. Evol</source>., <volume>37</volume>, <fpage>1832</fpage>–<lpage>1842</lpage>.<pub-id pub-id-type="pmid">32101295</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gladstein</surname><given-names>D.S.</given-names></string-name></person-group> (<year>1997</year>) <article-title>Efficient incremental character optimization</article-title>. <source>Cladistics</source>, <volume>13</volume>, <fpage>21</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">34920632</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goloboff</surname><given-names>P.A.</given-names></string-name></person-group> (<year>1996</year>) <article-title>Methods for faster parsimony analysis</article-title>. <source>Cladistics</source>, <volume>12</volume>, <fpage>199</fpage>–<lpage>220</lpage>.<pub-id pub-id-type="pmid">34920624</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goloboff</surname><given-names>P.A.</given-names></string-name></person-group> (<year>1999</year>) <article-title>Analyzing large data sets in reasonable times: solutions for composite optima</article-title>. <source>Cladistics</source>, <volume>15</volume>, <fpage>415</fpage>–<lpage>428</lpage>.<pub-id pub-id-type="pmid">34902941</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goloboff</surname><given-names>P.A.</given-names></string-name>, <string-name><surname>Catalano</surname><given-names>S.A.</given-names></string-name></person-group> (<year>2016</year>) <article-title>TNT version 1.5, including a full implementation of phylogenetic morphometrics</article-title>. <source>Cladistics</source>, <volume>32</volume>, <fpage>221</fpage>–<lpage>238</lpage>.<pub-id pub-id-type="pmid">34727670</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B17">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Gropp</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1999</year>) <source>Using MPI: Portable Parallel Programming with the Message-Passing Interface</source>. <edition>2nd edn</edition>. <publisher-name>MIT Press</publisher-name>, <publisher-loc>Cambridge, MA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btac401-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoang</surname><given-names>D.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>MPBoot: fast phylogenetic maximum parsimony tree inference and bootstrap approximation</article-title>. <source>BMC Evol. Biol</source>., <volume>18</volume>, <fpage>11</fpage>.<pub-id pub-id-type="pmid">29390973</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hodcroft</surname><given-names>E.B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Want to track pandemic variants faster? Fix the bioinformatics bottleneck</article-title>. <source>Nature</source>, <volume>591</volume>, <fpage>30</fpage>–<lpage>33</lpage>.<pub-id pub-id-type="pmid">33649511</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B20">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Knuth</surname><given-names>D.E.</given-names></string-name></person-group> (<year>2011</year>) <source>The Art of Computer Programming</source>. <edition>3rd edn</edition>. <publisher-name>Addison-Wesley</publisher-name>, <publisher-loc>Amsterdam</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btac401-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Komissarov</surname><given-names>A.B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Genomic epidemiology of the early stages of the SARS-CoV-2 outbreak in Russia</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>649</fpage>.<pub-id pub-id-type="pmid">33510171</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korber</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal>; Sheffield COVID-19 Genomics Group. (<year>2020</year>) <article-title>Tracking changes in SARS-CoV-2 spike: evidence that D614G increases infectivity of the COVID-19 virus</article-title>. <source>Cell</source>, <volume>182</volume>, <fpage>812</fpage>–<lpage>827.e19</lpage>.<pub-id pub-id-type="pmid">32697968</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumar</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>MEGA X: molecular evolutionary genetics analysis across computing platforms</article-title>. <source>Mol. Biol. Evol</source>., <volume>35</volume>, <fpage>1547</fpage>–<lpage>1549</lpage>.<pub-id pub-id-type="pmid">29722887</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lai</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Early phylogenetic estimate of the effective reproduction number of SARS-CoV-2</article-title>. <source>J. Med. Virol</source>., <volume>92</volume>, <fpage>675</fpage>–<lpage>679</lpage>.<pub-id pub-id-type="pmid">32096566</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lam-Hine</surname><given-names>T.</given-names></string-name></person-group> (<year>2021</year>) <article-title>Outbreak associated with SARS-CoV-2 B.1.617.2 (delta) variant in an elementary school—Marin County, California, May–June 2021</article-title>. <source>MMWR Morb. Mortal Wkly. Rep</source>., <fpage>70</fpage>.</mixed-citation>
    </ref>
    <ref id="btac401-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lan</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Genozip: a universal extensible genomic data compressor</article-title>. <source>Bioinformatics</source>, <volume>37</volume>, <fpage>2225</fpage>–<lpage>2230</lpage>.<pub-id pub-id-type="pmid">33585897</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>B.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2022</year>) <article-title>The UCSC genome browser database: 2022 update</article-title>. <source>Nucleic Acids Res</source>., <volume>50</volume>, <fpage>D1115</fpage>–<lpage>D1122</lpage>.<pub-id pub-id-type="pmid">34718705</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leinonen</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal>; International Nucleotide Sequence Database Collaboration. (<year>2011</year>) <article-title>The sequence read archive</article-title>. <source>Nucleic Acids Res</source>., <volume>39</volume>, <fpage>D19</fpage>–<lpage>D21</lpage>.<pub-id pub-id-type="pmid">21062823</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B29">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>McBroome</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) A daily-updated database and tools for comprehensive SARS-CoV-2 mutation-annotated trees. <source>Mol. Biol. Evol.,</source>  <bold>38</bold>, 5819–5824.</mixed-citation>
    </ref>
    <ref id="btac401-B30">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>McBroome</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2022</year>) Identifying SARS-CoV-2 regional introductions and transmission clusters in real time. <italic toggle="yes">Virus Evol.</italic>, veac048.</mixed-citation>
    </ref>
    <ref id="btac401-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Minh</surname><given-names>B.Q.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title>. <source>Mol. Biol. Evol</source>., <volume>37</volume>, <fpage>1530</fpage>–<lpage>1534</lpage>.<pub-id pub-id-type="pmid">32011700</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B32">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Nicholls</surname><given-names>S.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <source>MAJORA: continuous integration supporting decentralised sequencing for SARS-CoV-2 genomic surveillance</source>. bioRxiv, <pub-id pub-id-type="doi">10.1101/2020.10.06.328328</pub-id>.</mixed-citation>
    </ref>
    <ref id="btac401-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Toole</surname><given-names>Á.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Assignment of epidemiological lineages in an emerging pandemic using the pangolin tool</article-title>. <source>Virus Evol</source>., <volume>7</volume>, <fpage>veab064</fpage>.<pub-id pub-id-type="pmid">34527285</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rambaut</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>A dynamic nomenclature proposal for SARS-CoV-2 lineages to assist genomic epidemiology</article-title>. <source>Nat. Microbiol</source>., <volume>5</volume>, <fpage>1403</fpage>–<lpage>1407</lpage>.<pub-id pub-id-type="pmid">32669681</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B35">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Richard</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <source>A phylogeny-based metric for estimating changes in transmissibility from recurrent mutations in SARS-CoV-2 genomics</source>, bioRxiv, 2021.05.06.442903.</mixed-citation>
    </ref>
    <ref id="btac401-B36">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Sanderson</surname><given-names>T.</given-names></string-name></person-group> (<year>2021</year>) Chronumental: time tree estimation from very large phylogenies. https://doi.org/10.1101/2021.10.27.465994.</mixed-citation>
    </ref>
    <ref id="btac401-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sankoff</surname><given-names>D.</given-names></string-name></person-group> (<year>1975</year>) <article-title>Minimal mutation trees of sequences</article-title>. <source>SIAM J. Appl. Math</source>., <volume>28</volume>, <fpage>35</fpage>–<lpage>42</lpage>.</mixed-citation>
    </ref>
    <ref id="btac401-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shu</surname><given-names>Y.</given-names></string-name>, <string-name><surname>McCauley</surname><given-names>J.</given-names></string-name></person-group> (<year>2017</year>) <article-title>GISAID: global initiative on sharing all influenza data—from vision to reality</article-title>. <source>Eurosurveillance</source>, <volume>22</volume>, <fpage>30494</fpage>.<pub-id pub-id-type="pmid">28382917</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Takahashi</surname><given-names>K.</given-names></string-name>, <string-name><surname>Nei</surname><given-names>M.</given-names></string-name></person-group> (<year>2000</year>) <article-title>Efficiencies of fast algorithms of phylogenetic inference under the criteria of maximum parsimony, minimum evolution, and maximum likelihood when a large number of sequences are used</article-title>. <source>Mol. Biol. Evol</source>., <volume>17</volume>, <fpage>1251</fpage>–<lpage>1258</lpage>.<pub-id pub-id-type="pmid">10908645</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B40">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Thornlow</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) Online phylogenetics using parsimony produces slightly better trees and is dramatically more efficient for large SARS-CoV-2 phylogenies than de novo and maximum-likelihood approaches.</mixed-citation>
    </ref>
    <ref id="btac401-B41">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Turakhia</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021a</year>) Pandemic-scale phylogenomics reveals elevated recombination rates in the SARS-CoV-2 spike region. https://doi.org/10.1101/2021.08.04.455157.</mixed-citation>
    </ref>
    <ref id="btac401-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Turakhia</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021b</year>) <article-title>Ultrafast sample placement on existing tRees (UShER) enables real-time phylogenetics for the SARS-CoV-2 pandemic</article-title>. <source>Nat. Genet</source>., <volume>53</volume>, <fpage>809</fpage>–<lpage>816</lpage>.<pub-id pub-id-type="pmid">33972780</pub-id></mixed-citation>
    </ref>
    <ref id="btac401-B43">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Volz</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <source>Transmission of SARS-CoV-2 lineage B.1.1.7 in England: insights from linking epidemiological and genetic data infectious diseases (except HIV/AIDS)</source>. <pub-id pub-id-type="doi">10.1101/2020.12.30.20249034</pub-id>.</mixed-citation>
    </ref>
    <ref id="btac401-B44">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Swofford</surname><given-names>D.L.</given-names></string-name></person-group> (<year>2003</year>) <source>PAUP. Phylogenetic Analysis Using Parsimony (and Other Methods)</source>.</mixed-citation>
    </ref>
  </ref-list>
</back>
