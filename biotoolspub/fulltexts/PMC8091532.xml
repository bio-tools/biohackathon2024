<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8091532</article-id>
    <article-id pub-id-type="publisher-id">4086</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04086-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Modern simulation utilities for genetic analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ji</surname>
          <given-names>Sarah S.</given-names>
        </name>
        <address>
          <email>smji@ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>German</surname>
          <given-names>Christopher A.</given-names>
        </name>
        <address>
          <email>germc3@ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lange</surname>
          <given-names>Kenneth</given-names>
        </name>
        <address>
          <email>klange@ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sinsheimer</surname>
          <given-names>Janet S.</given-names>
        </name>
        <address>
          <email>jsinshei@ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Hua</given-names>
        </name>
        <address>
          <email>huazhou@ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Jin</given-names>
        </name>
        <address>
          <email>jzhou@email.arizona.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1718-0031</contrib-id>
        <name>
          <surname>Sobel</surname>
          <given-names>Eric M.</given-names>
        </name>
        <address>
          <email>esobel@ucla.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label>Department of Biostatistics, University of California, Los Angeles, 90095 USA </aff>
      <aff id="Aff2"><label>2</label>Department of Computational Medicine, University of California, Los Angeles, 90095 USA </aff>
      <aff id="Aff3"><label>3</label>Department of Human Genetics, University of California, Los Angeles, 90095 USA </aff>
      <aff id="Aff4"><label>4</label>Departments of Epidemiology and Biostatistics, University of Arizona, Tucson, 85721 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>5</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>228</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>7</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Statistical geneticists employ simulation to estimate the power of proposed studies, test new analysis tools, and evaluate properties of causal models. Although there are existing trait simulators, there is ample room for modernization. For example, most phenotype simulators are limited to Gaussian traits or traits transformable to normality, while ignoring qualitative traits and realistic, non-normal trait distributions. Also, modern computer languages, such as Julia, that accommodate parallelization and cloud-based computing are now mainstream but rarely used in older applications. To meet the challenges of contemporary big studies, it is important for geneticists to adopt new computational tools.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present TraitSimulation, an open-source Julia package that makes it trivial to quickly simulate phenotypes under a variety of genetic architectures. This package is integrated into our OpenMendel suite for easy downstream analyses. Julia was purpose-built for scientific programming and provides tremendous speed and memory efficiency, easy access to multi-CPU and GPU hardware, and to distributed and cloud-based parallelization. TraitSimulation is designed to encourage flexible trait simulation, including via the standard devices of applied statistics, generalized linear models (GLMs) and generalized linear mixed models (GLMMs). TraitSimulation also accommodates many study designs: unrelateds, sibships, pedigrees, or a mixture of all three. (Of course, for data with pedigrees or cryptic relationships, the simulation process must include the genetic dependencies among the individuals.) We consider an assortment of trait models and study designs to illustrate integrated simulation and analysis pipelines. Step-by-step instructions for these analyses are available in our electronic Jupyter notebooks on Github. These interactive notebooks are ideal for reproducible research.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">The TraitSimulation package has three main advantages. (1) It leverages the computational efficiency and ease of use of Julia to provide extremely fast, straightforward simulation of even the most complex genetic models, including GLMs and GLMMs. (2) It can be operated entirely within, but is not limited to, the integrated analysis pipeline of OpenMendel. And finally (3), by allowing a wider range of more realistic phenotype models, TraitSimulation brings power calculations and diagnostic tools closer to what investigators might see in real-world analyses.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Trait simulation</kwd>
      <kwd>Realistic genetic models</kwd>
      <kwd>Power</kwd>
      <kwd>Statistical genetics</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01 GM053275</award-id>
        <award-id>R01 HG006139</award-id>
        <award-id>R01 HG009120</award-id>
        <award-id>T32 HG002536</award-id>
        <award-id>K01 DK106116</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ji</surname>
            <given-names>Sarah S.</given-names>
          </name>
          <name>
            <surname>Lange</surname>
            <given-names>Kenneth</given-names>
          </name>
          <name>
            <surname>Sinsheimer</surname>
            <given-names>Janet S.</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Jin</given-names>
          </name>
          <name>
            <surname>Sobel</surname>
            <given-names>Eric M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DMS 1264153</award-id>
        <principal-award-recipient>
          <name>
            <surname>Sinsheimer</surname>
            <given-names>Janet S.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par22">Modern genome-wide association studies (GWAS) confront researchers with new computational and analytic challenges. Genetic data sets are becoming bigger and more varied. (See for example the UK Biobank [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>].) The size and variety of modern data sets require proper handling to ensure a quality analysis. Before mounting a study, genetic epidemiologists almost invariably evaluate the adequacy of their study design. If they propose a frequentist analysis, they seek to determine beforehand its power, type 1 error rates, accuracy and precision of estimates, coverage, and robustness to model misspecification. Given the near impossibility of deriving these results mathematically, they must resort to simulation. The whole process is time consuming and error prone due to the abundance of data and the small expected effect sizes. A single misstep can lead to false optimism or false pessimism. Since genetic studies are expensive to mount and carry important public health consequences, it is imperative that simulation studies be done realistically, accurately, and quickly.</p>
    <p id="Par23">There are a variety of existing phenotype simulators, each with its unique virtues and implementation. Three prominent examples are [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. Some simulators suffer from computational limitations and bottlenecks imposed by their high-level programming language. Some simulators also require users to format, save, and then pass the simulated trait results to a separate analysis program or programs, usually written in low-level languages. Users who rely solely on these “assembly line” pipelines shoulder the growing responsibility of staying up-to-date with each program in the pipeline as it adapts to new advances in computer language, hardware, or analysis specification.</p>
    <p id="Par24">Fortunately, more recent computer languages are better suited to accommodate modern software engineering practices that protect users from common programming mistakes. Languages devised before the advent of ubiquitous parallelization and big data sets are struggling to stay relevant. On the other hand, most modern languages handle these opportunities with aplomb. Julia is a new, dynamic language that is purpose-built for high-performance computing (HPC) and widely adopted by leading computational statisticians [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par25">In this article we introduce TraitSimulation, an open-source Julia-based package integrated into the OpenMendel software suite [<xref ref-type="bibr" rid="CR8">8</xref>]. OpenMendel provides a modern, comprehensive, and user-friendly pipeline for genetic analysis. TraitSimulation’s strengths are the wide range of non-normal simulation models, the flexibility to modify existing or add new simulation models, and the use of standard input and output data formats, such as PLINK. Using standard input formats, the genetic and covariate data used for trait simulation can be real or themselves simulated. Using standard output formats makes the phenotype generated by TraitSimulation compatible with a range of downstream analytical tools.</p>
    <p id="Par26">Although phenotype simulation can play a vital role in many downstream applications, including power analyses, phenotype generation itself is rarely the most time-consuming step. Usually, most time is taken by the post-simulation analyses, which may or may not be performed within our OpenMendel suite. For this reason we do not focus here on speed benchmarking of the phenotype simulation itself. Rather, we are interested in providing researchers with a tool for more flexible and perhaps more realistic phenotype simulation, while leveraging the modern language features of Julia for efficiency and ease of programming.</p>
    <p id="Par27">To demonstrate how TraitSimulation may be used as an element in the OpenMendel toolkit, we present case studies that include application of our simulation software under settings that require the wide range of possible phenotype models unique to TraitSimulation. The unified nature of the OpenMendel environment makes it easy to craft code for simulating traits conditional on real or simulated genetic and covariate data for both unrelated individuals and multi-generational pedigrees. In common with other OpenMendel packages, TraitSimulation conveniently embraces modern computing architectures and encourages reliable and efficient programming practices.</p>
    <p id="Par28">In the sections below, we first explain the advantages of using Julia to develop the OpenMendel project and demonstrate some of its key language features. We then present OpenMendel’s efficient SNP data management tool SnpArrays. Finally, we outline the trait simulation procedure with example data and results in various case studies that critically employ the simulated phenotypes in downstream analyses. The realistic trait simulation models used in these case studies are not all available in any other simulation software that we are aware of. Users are not limited to the analysis options provided in OpenMendel or Julia. After simulating the desired trait, they can call other analysis program, including popular R, C++ or Python packages, while staying within the Julia or Jupyter notebook environments. Alternatively, they can output the simulated traits to files for more customizable downstream analyses.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par29">The Julia programming language provides an excellent computing environment for genetic association studies. Among Julia’s many features is its just-in-time compiler that allows the language to combine the speed and efficiencies of low-level languages such as C or C++ with the ease-of-use and understandable syntax of high-level languages such as R or Python. Julia’s speed is also enhanced by its automatic use of the tremendous parallelization built into modern CPUs. For example, Julia includes automatic instruction-level parallelism, vectorization (to carry out many mathematical operations simultaneously), and multi-threading (to have whole sections of code run in parallel); Julia even includes tools for distributed computing across massive computing clusters [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR11">11</xref>]. To make coding easier and more efficient, Julia also has automatic type checking (to ensure variable consistency) and multiple dispatch (in which a single function can be used with different types and amounts of data as input and still have optimal efficiency). In addition, Julia ships with a native package manager, which improves portability, ease of deployment, and reproducibility. Julia also allows users to easily maneuver between shared and distributed memory environments, including graphics processing units (GPUs). Julia’s efficiency and versatility solves the long-standing two-language problem, in which developers could quickly prototype software in higher-level languages such as R or Python but then must rewrite their prototype code in lower-level languages such as C or C++ to handle larger, real-world data sets. As genetic data evolves and grows, and more resource-intensive tools are required to perform analyses, these design features make Julia a compelling language for computational genetics.</p>
    <sec id="Sec3">
      <title>SNP data</title>
      <p id="Par30">Our Julia-based package SnpArrays [<xref ref-type="bibr" rid="CR12">12</xref>] is a versatile interface to SNP data for all of our OpenMendel modules, and potentially for other packages. Users can specify SNPs of interest by name, position, minor allele frequency (MAF), or other filtering criterion provided by SnpArrays. A remarkable feature is that after reading in compressed SNP data files, SnpArrays keeps all of the genotype data compressed during its computations, such as estimation of genetic relationship matrices (GRMs) and principal components (PCs). This feature reduces RAM requirements by orders of magnitude while maintaining extremely fast performance. This is all possible because Julia allows for operations such as matrix-matrix multiplication to be defined on BitArrays, which are arrays where each element is one or two bits. This permits real analysis of biobank-scale data on commodity-level computers, which was accomplished with our software in [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
    </sec>
    <sec id="Sec4">
      <title>Trait simulation</title>
      <p id="Par31">Our new TraitSimulation program provides the broad range of underlying models listed in Table <xref rid="Tab1" ref-type="table">1</xref>, including ordered multinomial models, generalized linear models (GLMs), and generalized linear mixed models (GLMM). TraitSimulation allows users to easily modify the models in Table <xref rid="Tab1" ref-type="table">1</xref> to fit their needs or to create entirely new simulation models. Table <xref rid="Tab2" ref-type="table">2</xref>, whose variables are defined below, conveys the basic syntax for model construction and running the simulation under that model. This flexibility allows users to relax strict distributional assumptions imposed by many existing packages and simulate traits that do not conform to normality restrictions. Greater fidelity to trait distributions is bound to improve analysis results. Users interested in studying the robustness of their model can assess the effects of model misspecification by simulating the trait data under the hypothesized model and then analyzing the data under different models. An explicit example of the use of our software for this purpose can be seen in [<xref ref-type="bibr" rid="CR13">13</xref>] where they found a decrease in power when analyzing ordered multinomial phenotypes under a linear or logistic regression model.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Simulation models included in TraitSimulation</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Simulation model</th><th align="left">Relatedness data</th><th align="left">Typical application</th></tr></thead><tbody><tr><td align="left">(1)</td><td align="left">Generalized linear models</td><td align="left">–</td><td align="left">Exponential-family traits</td></tr><tr><td align="left">(2)</td><td align="left">Case/control models</td><td align="left">–</td><td align="left">Disease status traits</td></tr><tr><td align="left">(3)</td><td align="left">Proportional hazards/odds models</td><td align="left">–</td><td align="left">Ordinal traits</td></tr><tr><td align="left">(4)</td><td align="left">Variance component models</td><td align="left">GRM</td><td align="left">Correlated normal traits</td></tr><tr><td align="left">(5)</td><td align="left">Generalized linear mixed models</td><td align="left">GRM</td><td align="left">Correlated non-normal traits</td></tr></tbody></table></table-wrap><table-wrap id="Tab2"><label>Table 2</label><caption><p>Syntax for model construction and for the simulate function (see text for variable definitions)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Simulation model in Table <xref rid="Tab1" ref-type="table">1</xref></th><th align="left">Model construction syntax</th></tr></thead><tbody><tr><td align="left">(1)</td><td align="left">Model = GLMTrait(<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X, \beta$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq1.gif"/></alternatives></inline-formula>, dist, link)</td></tr><tr><td align="left"/><td align="left">Model = GLMTrait(<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X, \beta , G, \gamma$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>γ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq2.gif"/></alternatives></inline-formula>, dist, link)</td></tr><tr><td align="left">(2, 3)</td><td align="left">Model = OrderedMultinomialTrait(<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X, \beta , \theta ,$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq3.gif"/></alternatives></inline-formula> link)</td></tr><tr><td align="left">(4)</td><td align="left">Model = VCMTrait(<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X, \beta , vc$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq4.gif"/></alternatives></inline-formula>)</td></tr><tr><td align="left"/><td align="left">Model = VCMTrait(formula, <italic>df</italic>, <italic>vc</italic>)</td></tr><tr><td align="left"/><td align="left">Model = VCMTrait(<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X, \beta , G, \gamma , \Sigma , V$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Σ</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq5.gif"/></alternatives></inline-formula>)</td></tr><tr><td align="left">(5)</td><td align="left">Model = GLMMTrait(<inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X, \beta , vc$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq6.gif"/></alternatives></inline-formula>, dist, link)</td></tr></tbody></table><table frame="hsides" rules="groups"><thead><tr><th align="left"> Simulation model in Table <xref rid="Tab1" ref-type="table">1</xref></th><th align="left">simulate Function syntax</th></tr></thead><tbody><tr><td align="left">(1, 3, 4, 5)</td><td align="left">simulate(model)</td></tr><tr><td align="left">(2)</td><td align="left">simulate(model, Logistic = true, cutoff = 2)</td></tr></tbody></table></table-wrap></p>
      <p id="Par32">To run our TraitSimulation package the typical five steps are: <list list-type="order"><list-item><p id="Par33">Load the required packages: SnpArrays and TraitSimulation.</p></list-item><list-item><p id="Par34">Read in PLINK data files via SnpArrays and estimate the GRM, if applicable.</p></list-item><list-item><p id="Par35">Construct the simulation model, including relevant parameters such as the genetic and non-genetic predictors, the variance components, etc.</p></list-item><list-item><p id="Par36">Call the simulation routine to sample from the constructed model.</p></list-item><list-item><p id="Par37">Output the simulated phenotypes to a file or pass them to other analyses.</p></list-item></list>The following Julia code snippet is an example of commands used to perform the above steps for model (4) in Table <xref rid="Tab1" ref-type="table">1</xref>, based on genotype data in an existing compressed file. Prospective users may interact with a comprehensive online tutorial with step-by-step instructions and sample code at [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
      <graphic position="anchor" xlink:href="12859_2021_4086_Figa_HTML" id="MO1"/>
      <p id="Par38">Here <italic>X</italic> is the matrix of predictors and <italic>B</italic> is the corresponding matrix of regression coefficients. The
<inline-graphic xlink:href="12859_2021_4086_Figb_HTML.gif" id="d32e961"/>
macro provides a convenient way to specify the variance components of the model. <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _A$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq7.gif"/></alternatives></inline-formula> is the additive genetic covariance matrix, <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _E$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq8.gif"/></alternatives></inline-formula> is the environmental covariance matrix, <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\otimes$$\end{document}</tex-math><mml:math id="M18"><mml:mo>⊗</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq9.gif"/></alternatives></inline-formula> denotes a Kronecker product and <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_n$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mi>I</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq10.gif"/></alternatives></inline-formula> is the <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \times n$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq11.gif"/></alternatives></inline-formula> identity matrix.</p>
      <p id="Par39">Table <xref rid="Tab2" ref-type="table">2</xref> uses the same variables definitions as the above code. For each model in Table <xref rid="Tab2" ref-type="table">2</xref> the simulation procedure is also similar to the above code. Julia implements multiple dispatch that allows our simulate function to run the appropriate simulation routine even when we specify dramatically different models.</p>
      <p id="Par40">More details on running TraitSimulation under various settings, and additional step-by-step instructions for model specification, can be found in our interactive Jupyter notebooks at [<xref ref-type="bibr" rid="CR14">14</xref>]. TraitSimulation provides users with a variety of different ways to specify the simulation model of choice. The following alternative commands to specify the genetic model may be more convenient.</p>
      <graphic position="anchor" xlink:href="12859_2021_4086_Figc_HTML" id="MO3"/>
      <p id="Par41">In this alternative specification, the regression coefficients in <italic>B</italic> are provided as a 2-element vector of formulas, one for each trait. The matrix of predictors is specified as a DataFrame with column names coordinated with those appearing in the formulas.</p>
      <p id="Par42">Another model specification mechanism provides greater flexibility for users who wish to include many SNPs without having to convert the model genotypes from the compressed SnpArray. Here, the genetic and non-genetic predictors (<italic>G</italic>, <italic>X</italic>) and the corresponding regression coefficients <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\gamma , B)$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>γ</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq12.gif"/></alternatives></inline-formula> are provided separately.</p>
      <graphic position="anchor" xlink:href="12859_2021_4086_Figd_HTML" id="MO4"/>
      <p id="Par43">Users with many variance components may choose not to use the
<inline-graphic xlink:href="12859_2021_4086_Figb_HTML.gif" id="d32e1092"/>
macro and instead provide a list of the variance components and variance/covariance matrices:</p>
      <graphic position="anchor" xlink:href="12859_2021_4086_Fige_HTML" id="MO6"/>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results</title>
    <p id="Par44">In the two case studies we present below, all the generative models for trait simulation that we employ, univariate and bivariate variance components models and an ordinal multinomial model, could not currently have been built into any other trait simulation package we know. As we describe in the case studies, these are clearly the correct models for simulation given the respective data sets. Thus, TraitSimulation’s flexible model specification permits analyses that would not otherwise be available. Step-by-step, interactive Jupyter notebooks that walk the user through these case studies are available at [<xref ref-type="bibr" rid="CR14">14</xref>]. Here, we begin by describing the statistics behind these power analysis studies and how TraitSimulation fits into the software pipeline in concert with other OpenMendel modules (see Fig. <xref rid="Fig1" ref-type="fig">1</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>Open mendel pipeline example. TraitSimulation fits within a software pipeline to assess the power of association analysis under the variance components model of Case Study 2</p></caption><graphic xlink:href="12859_2021_4086_Fig1_HTML" id="MO7"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p>Case study 1: power under an ordinal multinomial model. This example shows the power to detect a single causal SNP in UK Biobank data with four outcome categories for disease status. Using an ordinal multinomial simulation model and the OpenMendel module for ordinal trait regression [<xref ref-type="bibr" rid="CR13">13</xref>], we assume a single SNP as a fixed effect and control for sex and standardized age. The figure compares analysis results for three SNPs of varying MAF over 1000 simulation replicates each. For each SNP, the graph depicts the power to detect that SNP at significance level <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 5 \times 10^{-8}$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq13.gif"/></alternatives></inline-formula>. For each SNP, the effect size varies from 0 to 0.05 in increments of 0.001. On the x-axis, we exponentiate effect sizes to covert to odds ratios. See the text for a detailed description of the model</p></caption><graphic xlink:href="12859_2021_4086_Fig2_HTML" id="MO8"/></fig><fig id="Fig3"><label>Fig. 3</label><caption><p>Case study 2: power under univariate and bivariate variance components models. This example shows the power to detect a single causal SNP using both univariate and bivariate variance components simulation models and the OpenMendel module for variance components analysis [<xref ref-type="bibr" rid="CR8">8</xref>]. For each anlysis, each line in the graph depicts the power to detect a SNP with <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {MAF} = 0.23$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mtext>MAF</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.23</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq14.gif"/></alternatives></inline-formula> using 1000 simulations at significance level <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 5 \times 10^{-8}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq15.gif"/></alternatives></inline-formula>. The SNP effect size varies from 0 to 0.065 in increments of 0.002 in the center range (0.016–0.032) and increments of 0.005 in the two end ranges. On the x-axis, we convert the SNP MAF and effect sizes into the proportion of variation explained by the SNP. See the text for a detailed description of the model</p></caption><graphic xlink:href="12859_2021_4086_Fig3_HTML" id="MO9"/></fig></p>
    <sec id="Sec6">
      <title>Statistical power</title>
      <p id="Par45">For a trait <italic>Y</italic> with predictor matrix <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{X}$$\end{document}</tex-math><mml:math id="M32"><mml:mi mathvariant="bold">X</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq16.gif"/></alternatives></inline-formula> and genotype vector <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {G}}_{\mathbf {s}}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mi mathvariant="bold">s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq17.gif"/></alternatives></inline-formula>, we now illustrate how to estimate the power to detect an associated SNP with effect size <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M36"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq18.gif"/></alternatives></inline-formula> at the pre-specified significance level <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M38"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq19.gif"/></alternatives></inline-formula>. Specifically, we set <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 5 \times 10^{-8}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq20.gif"/></alternatives></inline-formula> and test the hypothesis<disp-formula id="Equ1"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathbf{H} _0: \gamma = 0 \quad \text {versus}\quad \mathbf{H} _A: \gamma \ne 0 \end{aligned}$$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mi>γ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="1em"/><mml:mtext>versus</mml:mtext><mml:mspace width="1em"/><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mi>γ</mml:mi><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4086_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>in our two subsequent case studies. The user also needs to specify the number of simulation replicates. In the examples presented in this article, we commence by simulating 1000 replicates of an <italic>n</italic>-vector of phenotypes <italic>Y</italic> with the specified SNP effect size <inline-formula id="IEq21"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M44"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq21.gif"/></alternatives></inline-formula>. For each simulated trait vector, we perform a likelihood ratio test of the above hypothesis test and reject the null when the p-value falls below <inline-formula id="IEq22"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M46"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq22.gif"/></alternatives></inline-formula>. The power for the model is estimated as the proportion of the 1000 tests rejecting the null.</p>
      <sec id="Sec7">
        <title>Case study 1: power analysis for an ordinal disease</title>
        <p id="Par46">When modeling complex diseases where a binary phenotype for disease status is suboptimal, an ordered multinomial model is a powerful alternative. Our group recently demonstrated the application of an ordinal multinomial model to assess markers for association to diabetes and hypertension in the UK Biobank data [<xref ref-type="bibr" rid="CR13">13</xref>]. Ordinal phenotypes were simulated and then fit using one of three analyses models, linear regression, logistic regression and ordered multinomial regression, to assess effects of model misspecification and show increased power under the ordered multinomial model. For the current case study, we determine the power to detect a SNP that influences an ordered categorical phenotype representing the stages of disease progression in the UK Biobank data with <italic>n</italic> = 185,565 subjects after data cleaning. Specifically, consider a trait <italic>y</italic> that takes ordered discrete values at one of <italic>J</italic> = 4 levels:<disp-formula id="Equ2"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} (1) \text { undiagnosed }&lt; (2) \text { mild }&lt; (3) \text { moderate } &lt; (4) \text { severe }. \end{aligned}$$\end{document}</tex-math><mml:math id="M48" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>undiagnosed</mml:mtext><mml:mspace width="0.333333em"/><mml:mo>&lt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>mild</mml:mtext><mml:mspace width="0.333333em"/><mml:mo>&lt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>moderate</mml:mtext><mml:mspace width="0.333333em"/><mml:mo>&lt;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.333333em"/><mml:mtext>severe</mml:mtext><mml:mspace width="0.333333em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4086_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>Under the GLM framework, the cumulative probabilities <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{ij}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq23.gif"/></alternatives></inline-formula> = <inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Pr (y_i \le j)$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mo>Pr</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq24.gif"/></alternatives></inline-formula> are linked to the linear predictors via the logit link <inline-formula id="IEq25"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g(\alpha _{ij}) = \eta = \log \left( \frac{\alpha _{ij}}{1 - \alpha _{ij}} \right)$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq25.gif"/></alternatives></inline-formula>. The link itself is determined by the formula<disp-formula id="Equ3"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} g(\alpha _{ij}) = \theta _j - ({\mathbf {X}}_i^T \varvec{\beta } + \gamma {\mathbf {G}}_s), \quad j = 1,\ldots , J-1, \end{aligned}$$\end{document}</tex-math><mml:math id="M56" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4086_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where the intercept parameters <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _1 \le \cdots \le \theta _{J-1}$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mo>⋯</mml:mo><mml:mo>≤</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>J</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq26.gif"/></alternatives></inline-formula> enforce the order between the categories and <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq27.gif"/></alternatives></inline-formula> reflects the effects of the linear predictors under the proportional hazards model. The effect sizes can be interpreted as the expected change of the response variable on an ordered log-odds scale for each unit increase in the predictor. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the resulting power curves for three SNPs with varying MAF.</p>
      </sec>
      <sec id="Sec8">
        <title>Case study 2: power analysis for multivariate continuous traits</title>
        <p id="Par47">In this case study we carry out heritability estimation on simulated data with two variance components, one for the additive genetic variance and one for the environmental variance. TraitSimulation allows users to simulate multiple traits and more than two variance components by changing a few pertinent commands. For multivariate traits, two theoretical covariance matrices must be substituted for the additive genetic and environmental variances. Here we demonstrate how power calculations for the mixed model scale on a subset of <italic>n</italic> = 20,000 individuals from the same UK Biobank data used in Case Study 1. For both the univariate model (<inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d=1$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq28.gif"/></alternatives></inline-formula>) and multivariate (<inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d &gt; 1$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>d</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq29.gif"/></alternatives></inline-formula>) mixed effect model (listed as model type (4) in Table <xref rid="Tab1" ref-type="table">1</xref>), we invoke SnpArrays to estimate the kinship matrix <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{{\varvec{\Phi }}}_{GRM}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">GRM</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq30.gif"/></alternatives></inline-formula> via the standard GRM formula<disp-formula id="Equ4"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \widehat{{\varvec{\Phi }}}_{GRMij} = \frac{1}{2S} \sum _{k=1}^S \frac{(G_{ik}-2p_k)(G_{jk}-2p_k)}{2p_k(1-p_k)}. \end{aligned}$$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">GRMij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>S</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">jk</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4086_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>Here <italic>i</italic> and <italic>j</italic> are two generic individuals, <italic>S</italic> is the number of typed SNPs in the data, <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_k$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq31.gif"/></alternatives></inline-formula> is the MAF of the <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k{\text {th}}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>k</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq32.gif"/></alternatives></inline-formula> SNP, and <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$G_{ik} \in \{0,1,2\}$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq33.gif"/></alternatives></inline-formula> is the number of copies of the minor allele at the <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k{\text {th}}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>k</mml:mi><mml:mtext>th</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq34.gif"/></alternatives></inline-formula> SNP of individual <italic>i</italic>. Missing genotypes are simplistically imputed on the fly as the most likely genotype given a SNP’s MAF. Finally, we make the common assumption that the residual covariance between two relatives is well approximated via the additive genetic variance times twice their kinship coefficient. The latter is taken as the corresponding entry of the GRM matrix.</p>
        <p id="Par48">Our univariate and bivariate power calculation results under the variance components model (VCM) framework appear in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. (We used the Julia Plots package to obtain all our graphs.) In the univariate model, <inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M78"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq35.gif"/></alternatives></inline-formula> and <inline-formula id="IEq36"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M80"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq36.gif"/></alternatives></inline-formula> represent the non-genetic and genetic regression coefficients, respectively. We assigned 20 different values to the effect size <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M82"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq37.gif"/></alternatives></inline-formula> of the associated SNP or SNPs during phenotype simulation. At each <inline-formula id="IEq38"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\gamma$$\end{document}</tex-math><mml:math id="M84"><mml:mi>γ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq38.gif"/></alternatives></inline-formula> value, for each of 1000 replications, we tested for association using a likelihood ratio test (LRT) with significance level <inline-formula id="IEq39"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha = 5 \times 10^{-8}$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq39.gif"/></alternatives></inline-formula>. Symbolically, the univariate and bivariate models are<disp-formula id="Equ5"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathbf {Y}}_{n \times 1}&amp;= {} {\mathbf {X}}\mathbf {\beta } + {\mathbf {G}}_s \gamma + {\mathbf {g}} + \mathbf {\epsilon }; \qquad\qquad \begin{array}{ll} {\mathbf {g}} \sim N({\mathbf {0}}, \sigma _A \times {\varvec{\Phi }}) \\ \mathbf {\epsilon } \sim N({\mathbf {0}}, \sigma _E \times {\mathbf {I}}_{\mathbf {n}}) \end{array}\\ vec({\mathbf {Y}}_{n \times d})&amp;= {} vec({\mathbf {X}}{\mathbf {B}} + {\mathbf {G}}_s {\varvec{\Gamma }}) + {\mathbf {g}} + \mathbf {\epsilon }; \quad \begin{array}{ll} {\mathbf {g}} \sim N({\mathbf {0}}, \Sigma _A \otimes {\varvec{\Phi }}) \\ \mathbf {\epsilon } \sim N({\mathbf {0}}, \Sigma _E \otimes {\mathbf {I}}_n) \end{array} \end{aligned}$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi mathvariant="bold">Y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow/><mml:mi mathvariant="bold">X</mml:mi><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">g</mml:mi><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>;</mml:mo><mml:mspace width="2em"/><mml:mspace width="2em"/><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="bold">g</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>ϵ</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mi mathvariant="bold">n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold">Y</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow/><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold">B</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">G</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mi mathvariant="bold">Γ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold">g</mml:mi><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>;</mml:mo><mml:mspace width="1em"/><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="bold">g</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>ϵ</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>E</mml:mi></mml:msub><mml:mo>⊗</mml:mo><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4086_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>Here <inline-formula id="IEq40"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _A$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mi>σ</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _A$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq41.gif"/></alternatives></inline-formula> are the additive genetic variance and matrix, <inline-formula id="IEq42"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _E$$\end{document}</tex-math><mml:math id="M94"><mml:msub><mml:mi>σ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq42.gif"/></alternatives></inline-formula> and <inline-formula id="IEq43"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Sigma _E$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq43.gif"/></alternatives></inline-formula> are the environmental variance and matrix, <inline-formula id="IEq44"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\Phi }}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq44.gif"/></alternatives></inline-formula> is the kinship matrix, and <inline-formula id="IEq45"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {I}}_{\mathbf {n}}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi mathvariant="bold">I</mml:mi><mml:mi mathvariant="bold">n</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq45.gif"/></alternatives></inline-formula> is the <inline-formula id="IEq46"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \times n$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq46.gif"/></alternatives></inline-formula> identity matrix. The multivariate trait model is presented in its vectorized form using the multivariate normal density, where <inline-formula id="IEq47"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbf {B}}$$\end{document}</tex-math><mml:math id="M104"><mml:mi mathvariant="bold">B</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq47.gif"/></alternatives></inline-formula> and <inline-formula id="IEq48"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\Gamma }}$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi mathvariant="bold">Γ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq48.gif"/></alternatives></inline-formula> are the matrix of regression coefficients for the non-genetic and genetic predictors, respectively. Kronecker products <inline-formula id="IEq49"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\otimes$$\end{document}</tex-math><mml:math id="M108"><mml:mo>⊗</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4086_Article_IEq49.gif"/></alternatives></inline-formula> are required as explained in [<xref ref-type="bibr" rid="CR15">15</xref>].<table-wrap id="Tab3"><label>Table 3</label><caption><p>For the ordered multinomial model, power calculation runtimes in seconds</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"><italic>n</italic> = 185,565</th></tr></thead><tbody><tr><td align="left"><italic>k</italic> = 1</td><td align="left">707.8</td></tr><tr><td align="left"><italic>k</italic> = 20</td><td align="left">14350.2</td></tr></tbody></table><table-wrap-foot><p>A total of 1000 replications were performed for each combination (<italic>k</italic>, <italic>n</italic>) of the number of causal SNPs and the sample size. This was repeated for several SNP effect sizes (see Fig. <xref rid="Fig2" ref-type="fig">2</xref>) and the median runtimes are recorded here</p></table-wrap-foot></table-wrap><table-wrap id="Tab4"><label>Table 4</label><caption><p>For the univariate and bivariate variance components model, power calculation runtimes in seconds</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left"><italic>n</italic> = 5,000</th><th align="left"><italic>n</italic> = 10,000</th><th align="left"><italic>n</italic> = 20,000</th></tr></thead><tbody><tr><td align="left">Univariate</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"><italic> k</italic> = 1</td><td align="left">72.4</td><td align="left">202.7</td><td align="left">815.4</td></tr><tr><td align="left"><italic> k</italic> = 20</td><td align="left">1422.6</td><td align="left">4122.1</td><td align="left">16018.4</td></tr><tr><td align="left">Bivariate</td><td align="left"/><td align="left"/><td align="left"/></tr><tr><td align="left"><italic> k</italic> = 1</td><td align="left">215.5</td><td align="left">354.7</td><td align="left">978.7</td></tr><tr><td align="left"><italic> k</italic> = 20</td><td align="left">4207.8</td><td align="left">7007.2</td><td align="left">19644.8</td></tr></tbody></table><table-wrap-foot><p>A total of 1000 replications were performed for each combination (<italic>k</italic>, <italic>n</italic>) of the number of causal SNPs and the sample size. This was repeated for several SNP effect sizes (see Fig. <xref rid="Fig3" ref-type="fig">3</xref>) and the median runtimes are recorded here</p></table-wrap-foot></table-wrap></p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>Benchmarks</title>
      <p id="Par49">Tables <xref rid="Tab3" ref-type="table">3</xref> and <xref rid="Tab4" ref-type="table">4</xref> record the median total runtimes in seconds over all 1000 replications across <italic>k</italic> specified SNP predictors for a sample size of <italic>n</italic> people, for Case Studies 1 and 2, respectively, as reported by the Julia BenchmarkTools package. All computer runs were performed on a standard 3.5 GHz Intel i9 CPU with 12 cores; they were run under Linux but we find the operating system has no appreciable effect on runtimes. As mentioned above, these power calculation runtimes are dominated by the post-simulation analyses. Thus, for variance component analyses, the runtimes scale linearly in <italic>k</italic>, but not in <italic>n</italic>, as is usual for a variance components statistical analysis. Of course, overall runtimes are linear in the number of replications chosen to perform. However, since each replication is an independent process and our programs can easily be distributed across multiple machines, using even extremely large numbers of replications, for example, for precise type 1 error estimation, is certainly feasible on a computational cluster or in the cloud.</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p id="Par50">Genetic epidemiology and computational statistics are inexorably linked. The increasing size and complexity of genetic data drive improvements in algorithm design, and statistical advances push new genetic analyses. To continue this progress, we have introduced TraitSimulation, a software package that employs the Julia language to achieve impressive computational efficiencies and easy coding for a broad range of trait simulation models, including many unavailable in other simulation packages.</p>
    <p id="Par51">Simulation is a vital step in estimating the power of a proposed study to map genetic influences. To obtain the best power estimates, one must exploit all available study subjects (unrelated, sibships, parent-offspring pairs, and extended pedigrees), impute realistic genotypes (based on ethnically correct MAF, linkage disequilibrium (LD), and possibly recombination events), incorporate pertinent non-genetic predictors, and critically, simulate realistic trait values.</p>
    <p id="Par52">For example, if one is planning a family-based study and wanted to do a power analysis before collecting any data, then one would start with a collection of pedigree structures, including possibly singletons, that mimicked to the best of one’s knowledge the potential sample collection. At the founders of each pedigree one would want to simulate the genetic data using ethnic-specific allelic frequencies based on the admixture of the target population. The correct LD structure should also be maintained within these founder genomes. One way to accomplish this is to find a real genotyping or sequencing study, for example, the International Genome Sample Resource (IGSR) [<xref ref-type="bibr" rid="CR16">16</xref>], that includes subjects in the specified ethnicities, and use the real genomes of unrelated individuals as the data for the founders of the pedigrees. Then use gene-dropping software, for example, from the OpenMendel suite, and the real human recombination map to mimic recombination events that would occur as genomes are passed from parent to child through the pedigrees. The result will be simulated but realistic genetic data for all individuals in all pedigrees, because the data reflects the appropriate allelic frequencies, LD patterns, recombination map, and relationship structure. Our TraitSimulation package can then use this data and whichever trait model you wish to study to repeatedly generate trait values. Finally, each set of simulated data would be subject to the statistical analyses that constitutes the power analysis.</p>
    <p id="Par53">The model generality, ease of use, and speed of TraitSimulation, and indeed OpenMendel as a whole, promote the agenda of modern epidemiology. TraitSimulation’s wide range of generating models improves model realism and therefore power estimation. This generality allows statistical analysis to escape the straitjacket of the Gaussian assumption by allowing case/control and ordinal disease models, and more profoundly, any GLM or GLMM structure. Our choice of the Julia computer language makes it straightforward to code software and for users to adapt existing code to fit their modeling needs. Julia enhances the speed, flexibility, and overall ease-of-use of TraitSimulation. Julia’s speed stems from its just-in-time compiler, thorough use of parallelization, and its promotion of bit-wise linear algebra operations.</p>
    <p id="Par54">TraitSimulation is part of the OpenMendel family of Julia packages [<xref ref-type="bibr" rid="CR8">8</xref>]. OpenMendel provides an integrated suite of genetic analysis tools that rely on the standard data structure provided by SnpArrays. TraitSimulation can access other downstream analysis packages in estimating parameters and the power of new statistical tests. However, such pipeline strategies introduce extra layers of complexity and ultimately hamper analysis reproducibility. All of OpenMendel’s packages are fast, memory efficient, and user- and developer-friendly. The open-source nature of OpenMendel encourages other statisticians to extend its code base. In adding TraitSimulation to the OpenMendel family, we enable trait simulation within an integrated robust analysis pipeline. In our view, OpenMendel represents a unique and unified state-of-the-art environment for statistical genetics. We ask for your feedback and the help of the entire genetics community in perfecting OpenMendel. It or something very similar will be necessary as we face ever more massive and complex modern data sets.</p>
  </sec>
  <sec id="Sec11">
    <title>Availability and requirements</title>
    <p id="Par55"><italic>Project name</italic> TraitSimulation</p>
    <p id="Par56">
      <italic>Project home page</italic>
      <ext-link ext-link-type="uri" xlink:href="https://github.com/OpenMendel/TraitSimulation.jl">https://github.com/OpenMendel/TraitSimulation.jl</ext-link>
    </p>
    <p id="Par57"><italic>Operating systems</italic> Linux, MacOS, Windows</p>
    <p id="Par58"><italic>Programming language</italic> Julia 1.0 or higher</p>
    <p id="Par59"><italic>Other requirements</italic> None</p>
    <p id="Par60"><italic>License</italic> MIT</p>
    <p id="Par61"><italic>Any restrictions to use by non-academics</italic> None</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CPU</term>
        <def>
          <p id="Par4">Central processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>GLM</term>
        <def>
          <p id="Par5">Generalized linear model</p>
        </def>
      </def-item>
      <def-item>
        <term>GLMM</term>
        <def>
          <p id="Par6">Generalized linear mixed model</p>
        </def>
      </def-item>
      <def-item>
        <term>GPU</term>
        <def>
          <p id="Par7">Graphics processing unit</p>
        </def>
      </def-item>
      <def-item>
        <term>GRM</term>
        <def>
          <p id="Par8">Genetic relationship matrix</p>
        </def>
      </def-item>
      <def-item>
        <term>GWAS</term>
        <def>
          <p id="Par9">Genome-wide association study</p>
        </def>
      </def-item>
      <def-item>
        <term>HPC</term>
        <def>
          <p id="Par10">High performance computing</p>
        </def>
      </def-item>
      <def-item>
        <term>IGSR</term>
        <def>
          <p id="Par11">International genome sample resource</p>
        </def>
      </def-item>
      <def-item>
        <term>LD</term>
        <def>
          <p id="Par12">Linkage disequilibrium</p>
        </def>
      </def-item>
      <def-item>
        <term>LMM</term>
        <def>
          <p id="Par13">Linear mixed model</p>
        </def>
      </def-item>
      <def-item>
        <term>LMM</term>
        <def>
          <p id="Par14">Linear mixed model</p>
        </def>
      </def-item>
      <def-item>
        <term>LRT</term>
        <def>
          <p id="Par15">Likelihood ratio test</p>
        </def>
      </def-item>
      <def-item>
        <term>MAF</term>
        <def>
          <p id="Par16">Minor allele frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>PC</term>
        <def>
          <p id="Par17">Principal component</p>
        </def>
      </def-item>
      <def-item>
        <term>RAM</term>
        <def>
          <p id="Par18">Random access memory</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par19">Single nucleotide polymorphism</p>
        </def>
      </def-item>
      <def-item>
        <term>UK</term>
        <def>
          <p id="Par20">United Kingdom</p>
        </def>
      </def-item>
      <def-item>
        <term>VCM</term>
        <def>
          <p id="Par21">Variance component model</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank the presenters from the 2020 Lange Symposium workshop held at UCLA on 2/22/2020. We also thank Benjamin B. Chu, Seyoon Ko, and Alfonso Landeros for their advice on the many features of Julia, particularly those pertaining to parallelization and GPU computing.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>KL conceived the study. CAG prepared the data. SSJ wrote TraitSimulation, analyzed the data, and interpreted the results. SSJ, JSS, and EMS wrote the manuscript. KL, JSS, EMS, JZ, and HZ contributed tools and materials. All authors contributed to the final manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>Research supported in part by NIH grants R01 GM053275 (KL,JSS,EMS,HZ), R01 HG006139 (KL,JSS,EMS,JZ,HZ), K01 DK106116 (JZ), R01 HG009120 (JSS) &amp; T32 HG002536 (SSJ) and NSF grant DMS 1264153 (JSS). The funding agencies played no role in the selection and design of the study, in the plan and coding of the software, in the choice and analyses of the data, nor in the preparation and submission of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The data used in the analysis examples in this manuscript are from the UK Biobank data repository and are publicly available, after approval by their review board, from [<xref ref-type="bibr" rid="CR2">2</xref>]. We retrieved the data under Project IDs 48152 and 15678. Guidelines on obtaining the data used in our analyses, and step by step commands to recapitulate the analyses are available at [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par62">Since all data used in this study were either simulated or anonymous, this is Not Applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par63">Since all data used in this study were either simulated or anonymous, this is Not Applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par64">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sudlow</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gallacher</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Beral</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Burton</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Danesh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Downey</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Elliott</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Landray</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Matthews</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ong</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pell</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Silman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sprosen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Peakman</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>UK Biobank: an open access resource for identifying the causes of a wide range of complex diseases of middle and old age</article-title>
        <source>PLoS Med</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>1001779</fpage>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">UK Biobank: UK biobank data repository. <ext-link ext-link-type="uri" xlink:href="https://www.ukbiobank.ac.uk">https://www.ukbiobank.ac.uk</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ding</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>GPOPSIM: a simulation tool for whole-genome genetic data</article-title>
        <source>BMC Genet</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>10</fpage>
        <pub-id pub-id-type="pmid">25652552</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O’Reilly</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Hoggart</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Pomyen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Calboli</surname>
            <given-names>FCF</given-names>
          </name>
          <name>
            <surname>Elliott</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jarvelin</surname>
            <given-names>M-R</given-names>
          </name>
          <name>
            <surname>Coin</surname>
            <given-names>LJM</given-names>
          </name>
        </person-group>
        <article-title>MultiPhen: joint model of multiple phenotypes can increase discovery in GWAS</article-title>
        <source>PLoS ONE</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>34861</fpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>HV</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>PhenotypeSimulator: a comprehensive framework for simulating multi-trait, multi-locus genotype to phenotype relationships</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>2951</fpage>
        <lpage>2956</lpage>
        <pub-id pub-id-type="pmid">29617944</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bezanson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Edelman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Karpinski</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>VB</given-names>
          </name>
        </person-group>
        <article-title>Julia: a fresh approach to numerical computing</article-title>
        <source>SIAM Rev</source>
        <year>2017</year>
        <volume>59</volume>
        <fpage>65</fpage>
        <lpage>98</lpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Ko S, Zhou H, Zhou J, Won J-H. High-performance statistical computing in the computing environments of the 2020s (preprint). 2020. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2001.01916">arxiv:2001.01916</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sinsheimer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>German</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Keys</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ko</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mosher</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Papp</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sobel</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lange</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>OPENMENDEL: a cooperative programming project for statistical genetics</article-title>
        <source>Hum Genet</source>
        <year>2020</year>
        <volume>139</volume>
        <fpage>61</fpage>
        <lpage>71</lpage>
        <pub-id pub-id-type="pmid">30915546</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">JuliaComputing: Parallel computing. <ext-link ext-link-type="uri" xlink:href="https://juliacomputing.com/industries/parallel-computing.html">https://juliacomputing.com/industries/parallel-computing.html</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">JuliaComputing: multi-threading. <ext-link ext-link-type="uri" xlink:href="https://docs.julialang.org/en/v1/base/multi-threading">https://docs.julialang.org/en/v1/base/multi-threading</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">JuliaComputing: distributed computing. <ext-link ext-link-type="uri" xlink:href="https://docs.julialang.org/en/v1/stdlib/Distributed">https://docs.julialang.org/en/v1/stdlib/Distributed</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Zhou H. SnpArrays.jl. <ext-link ext-link-type="uri" xlink:href="https://openmendel.github.io/SnpArrays.jl/stable/">https://openmendel.github.io/SnpArrays.jl/stable/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>German</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Sinsheimer</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Klimentidis</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>Ordered multinomial regression for genetic association analysis of ordinal phenotypes at Biobank scale</article-title>
        <source>Genet Epidemiol</source>
        <year>2020</year>
        <volume>44</volume>
        <fpage>248</fpage>
        <lpage>260</lpage>
        <pub-id pub-id-type="pmid">31879980</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">SarahJi: TraiSimulation.jl. <ext-link ext-link-type="uri" xlink:href="https://openmendel.github.io/TraitSimulation.jl/stable/">https://openmendel.github.io/TraitSimulation.jl/stable/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lange</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <source>Mathematical and statistical methods for genetic analysis</source>
        <year>2002</year>
        <edition>2</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">IGSR: international genome sample resource. <ext-link ext-link-type="uri" xlink:href="https://www.internationalgenome.org">https://www.internationalgenome.org</ext-link>.</mixed-citation>
    </ref>
  </ref-list>
</back>
