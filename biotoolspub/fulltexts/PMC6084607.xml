<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6084607</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty176</article-id>
    <article-id pub-id-type="publisher-id">bty176</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>iterClust: a statistical framework for iterative clustering analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Ding</surname>
          <given-names>Hongxu</given-names>
        </name>
        <xref ref-type="aff" rid="bty176-aff1">1</xref>
        <xref ref-type="aff" rid="bty176-aff2">2</xref>
        <xref ref-type="corresp" rid="bty176-cor1"/>
        <xref ref-type="author-notes" rid="bty176-FM2"/>
        <!--<email>hd2326@columbia.edu</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Wanxin</given-names>
        </name>
        <xref ref-type="aff" rid="bty176-aff3">3</xref>
        <xref ref-type="author-notes" rid="bty176-FM2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Califano</surname>
          <given-names>Andrea</given-names>
        </name>
        <xref ref-type="aff" rid="bty176-aff1">1</xref>
        <xref ref-type="aff" rid="bty176-aff4">4</xref>
        <xref ref-type="corresp" rid="bty176-cor1"/>
        <!--<email>andrea.califano@columbia.edu</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty176-aff1"><label>1</label>Department of Systems Biology, Columbia University, New York, NY, USA</aff>
    <aff id="bty176-aff2"><label>2</label>Department of Biological Sciences, Columbia University, New York, NY, USA</aff>
    <aff id="bty176-aff3"><label>3</label>Department of Bioengineering, Stanford University, Stanford, CA, USA</aff>
    <aff id="bty176-aff4"><label>4</label>Herbert Irving Comprehensive Cancer Center, J.P. Sulzberger Columbia Genome Center, Department of Biomedical Informatics, Department of Biochemistry and Molecular Biophysics, Columbia University, New York, NY, USA</aff>
    <author-notes>
      <fn id="bty176-FM2">
        <p>The authors wish it to be known that, in their opinion, Hongxu Ding and Wanxin Wang authors should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="bty176-cor1">To whom correspondence should be addressed. Email: <email>andrea.califano@columbia.edu</email> or <email>hd2326@columbia.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>8</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-03-22">
      <day>22</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>16</issue>
    <fpage>2865</fpage>
    <lpage>2866</lpage>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>12</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>3</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>3</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty176.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>In a scenario where populations A, B1 and B2 (subpopulations of B) exist, pronounced differences between A and B may mask subtle differences between B1 and B2.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here we present iterClust, an iterative clustering framework, which can separate more pronounced differences (e.g. A and B) in starting iterations, followed by relatively subtle differences (e.g. B1 and B2), providing a comprehensive clustering trajectory.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>iterClust is implemented as a Bioconductor R package.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Institutes of Health</named-content>
          <named-content content-type="funder-identifier">10.13039/100000002</named-content>
        </funding-source>
        <award-id>R35 CA197745-03</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Outstanding Investigator Award</named-content>
        </funding-source>
        <award-id>U54 CA209997</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Centers for Cancer Systems Therapeutics</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>In a scenario where two clusters may exist (A and B), with B further divided into two sub-clusters (B1 and B2), the more pronounced differences between A and B may prevent subtle differences between B1 and B2 from being revealed. To solve this problem and to better describe the sub-cluster hierarchy, we propose to perform cluster analysis iteratively, such that individual clusters may be subdivided into smaller ones until further subdivisions are no longer statistically significant. Thus, for example, differences between A and B would lead to identification of two clusters in the first iteration, while B1 and B2 would be further identified in iteration 2. Previous effort in iterative clustering analysis (<xref rid="bty176-B9" ref-type="bibr">Usoskin <italic>et al.</italic>, 2015</xref>) lacks systematic criteria in determining key clustering parameters, e.g. optimal number of clusters among iterations. The iterClust Bioconductor R package provides an unsupervised statistical framework for iterative clustering analysis that can be used, for instance, to discover biological heterogeneity, especially in single cell analyses of heterogeneous tissues, where cell lineages impose a relatively strong hierarchical structure, or solve general clustering problems.</p>
  </sec>
  <sec>
    <title>2 Results</title>
    <p>R function iterClust() performs iterative clustering analysis by organizing user-defined functions in the following workflow:
<list list-type="order"><list-item><p><bold>ith iteration start</bold></p></list-item><list-item><p><bold>featureSelect()</bold>, select clustering features in this iteration.</p></list-item><list-item><p><bold>clustHetero()</bold>, confirm observation sets to be splitted in this iteration are heterogeneous.</p></list-item><list-item><p><bold>coreClust()</bold>, for heterogeneous observation sets confirmed by clustHetero(), generate several clustering schemes.</p></list-item><list-item><p><bold>clustEval()</bold>, choose the optimal scheme given by coreClust().</p></list-item><list-item><p><bold>obsEval()</bold>, evaluate how each observation is clustered.</p></list-item><list-item><p><bold>obsOutlier()</bold>, poorly clustered observations are removed.</p></list-item><list-item><p><bold>ith iteration end</bold></p></list-item></list></p>
    <p>iterClust takes diverse feature selection methods (<xref rid="bty176-B8" ref-type="bibr">Saeys <italic>et al.</italic>, 2007</xref>); clustering algorithms, e.g. partition-based, hierarchy-based (<xref rid="bty176-B2" ref-type="bibr">Kaufman and Rousseeuw, 2009</xref>), density-based (<xref rid="bty176-B1" ref-type="bibr">Ester <italic>et al.</italic>, 1996</xref>) and graph-based (<xref rid="bty176-B5" ref-type="bibr">Newman and Girvan, 2004</xref>); and cluster/observation evaluation methods, e.g. sampling-based consensus score (<xref rid="bty176-B4" ref-type="bibr">Monti <italic>et al.</italic>, 2003</xref>) or regular silhouettes score (<xref rid="bty176-B7" ref-type="bibr">Rousseeuw, 1987</xref>). In addition, parameters for all user-defined functions can be set up as a function of the iteration, for instance, clustHetero() can be set up such that looser threshold parameters may be used as the iteration depth increases to deal with more and more subtle heterogeneity. In addition, featureSelect() can be used to select clustering features based on previous iterations. For instance this can help exclude features used to identify coarser clusters in prior iterations to unveil novel, more subtle heterogeneity at the current iteration. Taken together, these two functions make iterClust a highly flexible statistical framework for iterative cluster analysis. The results of iterClust are organized by iteration. Within a specific iteration, for each cluster, the corresponding observation names and clustering features are recorded, providing a comprehensive clustering trajectory.</p>
    <p>As a statistical framework, the running time, as well as influencing factors of iterClust is majorly dependent on the clustering algorithm in coreClust() function that is specified by the user. As an example, we benchmarked iterClust on a public human PBMC (Peripheral Blood Mononuclear Cell) scRNA-Seq dataset. The original dataset was subsampled into different sizes, and pam() function (Partition Around Medoids, in R package cluster) was used in coreClust() function. In this case, running time increases exponentially and linearly as number of cells and genes increases, respectively, agreeing with the property of pam() function (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>).</p>
    <p>We further tested the performance of iterClust in heterogeneity detection. As shown in <xref ref-type="fig" rid="bty176-F1">Figure 1</xref>, within the PBMC dataset, in the first iteration, iterClust identified T-cell and APC (Antigen Presenting Cell) clusters. In the second iteration, the algorithm further separated the original two clusters into additional sub-clusters, including monocyte and B-cells in the APC cluster (monocyte and B-cell are two major types of APC), as well as effector T-cell and naïve/memory T-cells in the T-cell cluster. Critically, all clusters identified by the analysis were characterized by well-established cell-type-specific gene expression markers (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>). The finer grain sub-division was not the optimal solution using single pass analysis (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>). Taken together, iterClust can correctly elucidate complex hierarchical substructures that contribute to tissue heterogeneity in PBMC single cell dataset, with more pronounced differences in starting iterations, followed by relatively subtle differences, providing a comprehensive clustering trajectory. We further confirmed these conclusions on independent scRNA-Seq datasets (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S4 and S5</xref>), as well as general benchmarking datasets for clustering analysis (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S6 and S7</xref>).
</p>
    <fig id="bty176-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Revealing cell types within human PBMC using iterClust. For illustration purpose, the data was projected on 2D-space with t-SNE plots (<xref rid="bty176-B3" ref-type="bibr">Maaten and Hinton, 2008</xref>), on which iterClust discovered clusters were colored. iterClust in first round (<bold>A</bold>) separated two major cell types, T-cell and APC (Antigen Presenting Cell) and second round (<bold>B</bold>) further dissected these clusters, separating monocyte and B-cell in APC cluster, as well as Effector T-cell and Naïve/Memory T-cell among T-cell cluster</p>
      </caption>
      <graphic xlink:href="bty176f1"/>
    </fig>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="bty176_supp.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Dr. Mariano J. Alvarez, Dr. Eugene F. Douglass and Dr. Pasquale Laise for discussion and comments on the work.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by US National Institutes of Health grants R35 CA197745-03 (Outstanding Investigator Award) and U54 CA209997 (Centers for Cancer Systems Therapeutics).</p>
      <p><italic>Conflict of Interest</italic>: Dr. Califano is founder and equity holder of DarwinHealth Inc., a company that has licensed some of the algorithm used in this manuscript from Columbia University. Columbia University is also an equity holder in DarwinHealth Inc.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bty176-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ester</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>1996</year>) 
<article-title>A density-based algorithm for discovering clusters in large spatial databases with noise</article-title>. <source>KDD</source>, <volume>96</volume>, <fpage>226</fpage>–<lpage>231</lpage>.</mixed-citation>
    </ref>
    <ref id="bty176-B2">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Kaufman</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Rousseeuw</surname><given-names>P.J.</given-names></name></person-group> (<year>2009</year>) <source>Finding Groups in Data: An Introduction to Cluster Analysis</source>. Vol. <volume>344</volume>
<publisher-loc>Hoboken, New Jersey</publisher-loc>, 
<publisher-name>John Wiley &amp; Sons</publisher-name>.</mixed-citation>
    </ref>
    <ref id="bty176-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Maaten</surname><given-names>L.V.D.</given-names></name>, <name name-style="western"><surname>Hinton</surname><given-names>G.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Visualizing data using t-SNE</article-title>. <source>J. Mach. Learn. Res</source>., <volume>9</volume>, <fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation>
    </ref>
    <ref id="bty176-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Monti</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2003</year>) 
<article-title>Consensus clustering: a resampling-based method for class discovery and visualization of gene expression microarray data</article-title>. <source>Mach. Learn</source>., <volume>52</volume>, <fpage>91</fpage>–<lpage>118</lpage>.</mixed-citation>
    </ref>
    <ref id="bty176-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Newman</surname><given-names>M.E.</given-names></name>, <name name-style="western"><surname>Girvan</surname><given-names>M.</given-names></name></person-group> (<year>2004</year>) 
<article-title>Finding and evaluating community structure in networks</article-title>. <source>Phys. Rev. E</source>, <volume>69</volume>, <fpage>026113</fpage>.</mixed-citation>
    </ref>
    <ref id="bty176-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rousseeuw</surname><given-names>P.J.</given-names></name></person-group> (<year>1987</year>) 
<article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>. <source>J. Comput. Appl. Math</source>., <volume>20</volume>, <fpage>53</fpage>–<lpage>65</lpage>.</mixed-citation>
    </ref>
    <ref id="bty176-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Saeys</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>A review of feature selection techniques in bioinformatics</article-title>. <source>Bioinformatics</source>, <volume>23</volume>, <fpage>2507</fpage>–<lpage>2517</lpage>.<pub-id pub-id-type="pmid">17720704</pub-id></mixed-citation>
    </ref>
    <ref id="bty176-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Usoskin</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Unbiased classification of sensory neuron types by large-scale single-cell RNA sequencing</article-title>. <source>Nat. Neurosci</source>., <volume>18</volume>, <fpage>145</fpage>.<pub-id pub-id-type="pmid">25420068</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
