<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8504631</article-id>
    <article-id pub-id-type="pmid">33904573</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab257</article-id>
    <article-id pub-id-type="publisher-id">btab257</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Identification of cell-type-specific marker genes from co-expression patterns in tissue samples</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0109-6692</contrib-id>
        <name>
          <surname>Qiu</surname>
          <given-names>Yixuan</given-names>
        </name>
        <aff><institution>Department of Statistics and Data Science, Carnegie Mellon University</institution>, Pittsburgh, PA 15213, <country country="US">USA</country></aff>
        <xref rid="btab257-cor2" ref-type="corresp"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3828-4400</contrib-id>
        <name>
          <surname>Wang</surname>
          <given-names>Jiebiao</given-names>
        </name>
        <aff><institution>Department of Biostatistics, University of Pittsburgh</institution>, Pittsburgh, PA 15261, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3104-9387</contrib-id>
        <name>
          <surname>Lei</surname>
          <given-names>Jing</given-names>
        </name>
        <aff><institution>Department of Statistics and Data Science, Carnegie Mellon University</institution>, Pittsburgh, PA 15213, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Roeder</surname>
          <given-names>Kathryn</given-names>
        </name>
        <xref rid="btab257-cor1" ref-type="corresp"/>
        <aff><institution>Department of Statistics and Data Science, Carnegie Mellon University</institution>, Pittsburgh, PA 15213, <country country="US">USA</country></aff>
        <aff><institution>Computational Biology Department, Carnegie Mellon University</institution>, Pittsburgh, PA 15213, <country country="US">USA</country></aff>
        <!--roeder@andrew.cmu.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Mathelier</surname>
          <given-names>Anthony</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab257-cor1">To whom correspondence should be addressed. <email>roeder@andrew.cmu.edu</email></corresp>
      <corresp id="btab257-cor2">Present address: School of Statistics and Management, Shanghai University of Finance and Economics, Shanghai 200433, China</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>10</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-04-27">
      <day>27</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>19</issue>
    <fpage>3228</fpage>
    <lpage>3234</lpage>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>11</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>15</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>13</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>4</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>19</day>
        <month>5</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab257.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Marker genes, defined as genes that are expressed primarily in a single-cell type, can be identified from the single-cell transcriptome; however, such data are not always available for the many uses of marker genes, such as deconvolution of bulk tissue. Marker genes for a cell type, however, are highly correlated in bulk data, because their expression levels depend primarily on the proportion of that cell type in the samples. Therefore, when many tissue samples are analyzed, it is possible to identify these marker genes from the correlation pattern.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>To capitalize on this pattern, we develop a new algorithm to detect marker genes by combining published information about likely marker genes with bulk transcriptome data in the form of a semi-supervised algorithm. The algorithm then exploits the correlation structure of the bulk data to refine the published marker genes by adding or removing genes from the list.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>We implement this method as an R package markerpen, hosted on CRAN (<ext-link xlink:href="https://CRAN.R-project.org/package=markerpen" ext-link-type="uri">https://CRAN.R-project.org/package=markerpen</ext-link>).</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01MH085542</award-id>
        <award-id>R01MH093725</award-id>
        <award-id>P50MH066392</award-id>
        <award-id>P50MH080405</award-id>
        <award-id>R01MH097276</award-id>
        <award-id>RO1-MH-075916</award-id>
        <award-id>P50M096891</award-id>
        <award-id>P50MH084053S1</award-id>
        <award-id>R37MH057881</award-id>
        <award-id>AG02219</award-id>
        <award-id>AG05138</award-id>
        <award-id>MH06692</award-id>
        <award-id>R01MH110921</award-id>
        <award-id>R01MH109677</award-id>
        <award-id>R01MH109897</award-id>
        <award-id>U01MH103392</award-id>
        <award-id>HHSN271201300031C</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIA</institution>
            <institution-id institution-id-type="DOI">10.13039/100000049</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>P30AG10161</award-id>
        <award-id>R01AG15819</award-id>
        <award-id>R01AG17917</award-id>
        <award-id>R01AG30146</award-id>
        <award-id>R01AG36042</award-id>
        <award-id>RC2AG036547</award-id>
        <award-id>R01AG36836</award-id>
        <award-id>R01AG48015</award-id>
        <award-id>RF1AG57473</award-id>
        <award-id>U01AG32984</award-id>
        <award-id>U01AG46152</award-id>
        <award-id>U01AG46161</award-id>
        <award-id>U01AG61356</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Illinois Department of Public Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100004888</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Translational Genomics Research Institute</institution>
            <institution-id institution-id-type="DOI">10.13039/100017803</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute of Mental Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000025</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01MH123184</award-id>
        <award-id>R37MH057881</award-id>
        <award-id>UO1NH122681</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>DMS-1553884</award-id>
        <award-id>DMS-2015492</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Cell-type-specific (CTS) genes, also known as marker genes, are genes that are highly expressed in one cell type, but lowly expressed in other types. These genes, which define cellular identity, are key to the analysis of RNA transcriptional data. Knowledge of marker genes gives insights into the core set of genes whose expression is shared among all cells of a given type, and will fill critical gaps in our understanding of cell biology and possibly the cellular origins of pathologies (<xref rid="btab257-B21" ref-type="bibr">Kelley <italic toggle="yes">et al.</italic>, 2018</xref>). Marker genes are used to annotate cell clusters (<xref rid="btab257-B22" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic>, 2017</xref>), to study cellular composition of bulk tissues (<xref rid="btab257-B21" ref-type="bibr">Kelley <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab257-B24" ref-type="bibr">Luecken and Theis, 2019</xref>; <xref rid="btab257-B30" ref-type="bibr">Oldham <italic toggle="yes">et al.</italic>, 2008</xref>; <xref rid="btab257-B38" ref-type="bibr">Xu <italic toggle="yes">et al</italic>., 2013</xref>), to estimate cell type fraction via deconvolution (<xref rid="btab257-B1" ref-type="bibr">Abbas <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btab257-B4" ref-type="bibr">Avila Cobos <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab257-B12" ref-type="bibr">Gaujoux and Seoighe, 2012</xref>; <xref rid="btab257-B28" ref-type="bibr">Newman <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab257-B40" ref-type="bibr">Zhong <italic toggle="yes">et al</italic>., 2013</xref>) and to estimate CTS expression directly from bulk tissue (<xref rid="btab257-B34" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2020</xref>, <xref rid="btab257-B35" ref-type="bibr">2021</xref>).</p>
    <p>Because marker genes are defined by their strong differential expression among cell types, a common approach to identifying them is to conduct statistical tests on CTS transcriptome data, typically single-cell RNA sequencing (RNA-seq). Genes that have significant expression differences between one specific cell type and all others are regarded as marker genes for this type (<xref rid="btab257-B22" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic>, 2017</xref>). Despite the obvious appeal of this direct approach, the availability of CTS transcriptome data is a great challenge for many studies. The cost for single-cell sequencing is generally high, and in some cases, viable cells are hard to obtain for tissues like human brain. Even if public datasets are available, they might not correspond well with the data in hand, being collected at a different developmental period or a different functional portion of the organ. Furthermore, there is a trade-off between sequencing depth and the number of cells that can be analyzed, and for this reason, the resulting single-cell transcriptome is quite noisy. An alternative way to obtain reference transcriptome data is to use single-cell RNA-seq data from another species (<xref rid="btab257-B39" ref-type="bibr">Zeisel <italic toggle="yes">et al</italic>., 2015</xref>); however, the quality of the obtained marker genes based on data from a different species is questionable. To this end, there is a need for a reliable statistical technique for detecting marker genes that does not require well matched single-cell RNA-seq data.</p>
    <p>The objective of this inquiry is to develop a method for identifying a set of marker genes that describe the expression of the cells that constitute a tissue sample directly from the bulk transcriptome. We will take advantage of the conjecture that marker genes identifying a common cell type are highly correlated in samples of bulk transcriptome data, because their expression levels depend primarily on the proportion of that cell class in each sample (<xref rid="btab257-B21" ref-type="bibr">Kelley <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab257-B30" ref-type="bibr">Oldham <italic toggle="yes">et al.</italic>, 2008</xref>). Motivated by this insight, we develop a new algorithm called MarkerPen, short for <bold>marker</bold> gene detection via <bold>pen</bold>alized principal component analysis, to detect marker genes by combining prior marker information with bulk transcriptome data. MarkerPen is a semi-supervised algorithm that requires two pieces of information: a list of potential marker genes, typically obtained from the literature, past experience or available single-cell RNA-seq data; and a bulk RNA-seq dataset, viewed as a mixture of pure cells. The algorithm then exploits the bulk data to refine the published marker genes by adding and removing genes from the list.</p>
    <p>In summary, MarkerPen is motivated by the following two key findings: (i) marker genes are statistically highly correlated under mild and sensible assumptions; (ii) highly correlated genes can be detected by estimating the leading eigenvectors of the correlation matrix. We formulate the MarkerPen algorithm as a modified sparse principal component analysis (sparse PCA, <xref rid="btab257-B19" ref-type="bibr">Jolliffe <italic toggle="yes">et al.</italic>, 2003</xref>; <xref rid="btab257-B41" ref-type="bibr">Zou <italic toggle="yes">et al</italic>., 2006</xref>; <xref rid="btab257-B42" ref-type="bibr">Zou and Xue, 2018</xref>), which simultaneously selects highly correlated genes and encodes prior information about markers into the model. Our simulation study and multiple data analyses of human brain transcriptomes demonstrate the superior performance of the proposed method.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Related work</title>
      <p>The MarkerPen algorithm follows the path of two pioneering publications (<xref rid="btab257-B21" ref-type="bibr">Kelley <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab257-B38" ref-type="bibr">Xu <italic toggle="yes">et al.</italic>, 2013</xref>), who noted that marker genes tend to be highly correlated in bulk tissue. MarkerPen solves the marker detection problem by making better use of bulk RNA-seq data. The motivation for these methods is straightforward: many tissues and subjects have been assessed for bulk tissue expression; the data tend to be of better quality; and collecting bulk data is less costly. Although bulk data alone do not provide CTS transcriptome information, they can be combined with prior knowledge of marker genes to improve the quality of published markers. For example, <xref rid="btab257-B38" ref-type="bibr">Xu <italic toggle="yes">et al.</italic> (2013)</xref> first obtained CTS genes in mouse brain as potential markers for human brain, and then performed co-expression network analysis on human brain bulk data to select highly correlated genes of each type as the refined marker genes. This method has shown good empirical results, but has the drawback that genes can only be removed from the candidate list, but not added from the complementary set. More recently, <xref rid="btab257-B21" ref-type="bibr">Kelley <italic toggle="yes">et al.</italic> (2018)</xref> applied a similar approach to the human brain transcriptome. They first built an unsupervised co-expression network for all genes, and then identified gene clusters that were maximally enriched with published markers. Each gene was then assigned a fidelity score for each cell type, as an indicator for the strength of association between the gene and the cell type. These scores, however, were based on the aggregation of multiple datasets, and hence the selected marker sets may be suboptimal for a specific study.</p>
      <p>Both methods described above assume that marker genes tend to be highly correlated, which is an intuitive assumption supported empirically in numerous species (<xref rid="btab257-B5" ref-type="bibr">Bakken <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab257-B10" ref-type="bibr">Fertuzinhos <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btab257-B14" ref-type="bibr">Hawrylycz <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab257-B16" ref-type="bibr">Hilliard <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btab257-B30" ref-type="bibr">Oldham <italic toggle="yes">et al.</italic>, 2008</xref>; <xref rid="btab257-B31" ref-type="bibr">Ponomarev <italic toggle="yes">et al.</italic>, 2010</xref>), but lacks rigorous statistical justification. To resolve this shortcoming, in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> (Supplementary Section S1) we explicitly study the statistical properties of marker genes, and show that under weak assumptions the marker genes for the same cell type are highly correlated in the bulk data. Given this fact, we are then able to utilize the correlation structure to detect marker genes via the MarkerPen algorithm.</p>
    </sec>
    <sec>
      <title>2.2 The MarkerPen algorithm</title>
      <p>Because high mutual correlation is a necessary condition for marker genes, the first step of marker gene selection is to find a subset from the whole genome such that genes in this set are highly correlated with each other. If the true correlation matrix Σ is available, then such a goal can be achieved by computing PCA on Σ, as the eigenvectors of Σ, also known as factor loadings, indicate the contribution of each gene to form a gene group. In the case of a marker gene group, the eigenvector contains a few strong signals and a large number of small values, where the large coefficients correspond to highly correlated genes (Supplementary Section S2, Supplementary Fig. S1).</p>
      <p>However, in practice, only the sample correlation matrix <italic toggle="yes">S</italic> is given, and <italic toggle="yes">S</italic> can be of very high dimension. Theoretical results show that conventional PCA may be inconsistent in high dimensions (<xref rid="btab257-B18" ref-type="bibr">Johnstone and Lu, 2009</xref>; <xref rid="btab257-B20" ref-type="bibr">Jung and Marron, 2009</xref>), leading to inaccurate factor loading estimates (Supplementary Section S2, Supplementary Fig. S2). In such cases, the sparse PCA method is preferred, which directly estimates a sparse eigenvector, meaning that most entries in this vector are zeros. Sparse PCA has many different variants, and in this article we consider the Fantope projection and selection algorithm (FPS, <xref rid="btab257-B33" ref-type="bibr">Vu <italic toggle="yes">et al.</italic>, 2013</xref>), because it solves a convex optimization problem that has a global convergence guarantee. Similar to ordinary PCA, FPS takes the sample covariance or correlation matrix <italic toggle="yes">S</italic> as the input, and outputs a <italic toggle="yes">p</italic> × <italic toggle="yes">d</italic> matrix Γ, where <italic toggle="yes">p</italic> is the number of genes, <italic toggle="yes">d</italic> is the number of principal components retrieved, and the <italic toggle="yes">i</italic>th column of Γ contains the factor loadings of the <italic toggle="yes">i</italic>th component. Unlike PCA, FPS solves an optimization problem of the for<italic toggle="yes"><sc>m</sc></italic>
 <disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:munder><mml:mi>max</mml:mi><mml:mi>X</mml:mi></mml:munder><mml:mo> </mml:mo><mml:mtext>tr</mml:mtext><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mi>X</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mo>λ</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mo>|</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="normal">s</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo>.</mml:mo><mml:mo> </mml:mo><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mo>⩽</mml:mo><mml:mi>X</mml:mi><mml:mo>⩽</mml:mo><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mtext>tr</mml:mtext><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <italic toggle="yes">X</italic> is a <italic toggle="yes">p</italic> × <italic toggle="yes">p</italic> symmetric matrix, <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mtext>tr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the trace of a matrix <italic toggle="yes">A</italic>, <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> is the sum of absolute values of the elements in <italic toggle="yes">X</italic>, <italic toggle="yes">λ</italic> is a tuning parameter that controls the sparsity of eigenvectors, and <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mn>0</mml:mn><mml:mo>⩽</mml:mo><mml:mi>X</mml:mi><mml:mo>⩽</mml:mo><mml:mn>1</mml:mn><mml:mo>⩽</mml:mo></mml:math></inline-formula> means all eigenvalues of <italic toggle="yes">X</italic> are between 0 and 1. Let <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> be the solution to (1), and then the Γ matrix is obtained by computing the first <italic toggle="yes">d</italic> eigenvectors of <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>. It is worth noting that when <italic toggle="yes">λ </italic>= 0, FPS is mathematically equivalent to the ordinary PCA.</p>
      <p>In practice, there is abundant prior information about the marker gene list in the literature, which provides useful knowledge about the relationship between cell types and genes; however, such information is not exploited by FPS, resulting in low utilization of the available information. To fix this issue, the proposed MarkerPen algorithm modifies the original FPS such that prior information about markers can be combined with the collected bulk data. For simplicity, we first consider the detection of marker genes for one cell type, in which case <italic toggle="yes">d</italic> = 1 and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mo>Γ</mml:mo><mml:mo>=</mml:mo><mml:mo>γ</mml:mo></mml:mrow></mml:math></inline-formula> is a single factor loading vector. Let <italic toggle="yes">G</italic> be the indices of published marker genes for a cell type <italic toggle="yes">C</italic>, and then we solv<italic toggle="yes"><sc>e</sc></italic>
 <disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:munder><mml:mi>max</mml:mi><mml:mi>X</mml:mi></mml:munder><mml:mo> </mml:mo><mml:mtext>tr</mml:mtext><mml:mo>(</mml:mo><mml:mi>S</mml:mi><mml:mi>X</mml:mi><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mo>λ</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="normal">s</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo>.</mml:mo><mml:mo> </mml:mo><mml:mn>0</mml:mn><mml:mo>⩽</mml:mo><mml:mi>X</mml:mi><mml:mo>⩽</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>X</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:mtext>tr</mml:mtext><mml:mo>(</mml:mo><mml:mi>X</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a penalty function defined as
<disp-formula id="E3"><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∉</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>∉</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>w</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mi>X</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> means all elements of <italic toggle="yes">X</italic> are non-negative. Same as FPS, the output <italic toggle="yes">γ</italic> is the eigenvector of the solution <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> associated with the largest eigenvalue.</p>
      <p>To see how MarkerPen modifies FPS to include prior information, note that (2) contains one additional constraint <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mi>X</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and the penalty term <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> reduces to <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> as in FPS if <italic toggle="yes">w</italic><bold> </bold>= 1. The added condition <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mi>X</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> is based on the fact that marker genes are positively correlated, implying <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mo>γ</mml:mo><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, and hence <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo>≈</mml:mo><mml:mo>γ</mml:mo><mml:msup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> also has non-negative entries. The extra tuning parameter <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mi>w</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is used to put larger sparsity penalty on genes that are not in the prior list <italic toggle="yes">G</italic>, so that genes outside <italic toggle="yes">G</italic> are less likely to be selected as marker genes, unless they show large signals. The optimization problem (2) can be solved via the proximal-proximal-gradient method (<xref rid="btab257-B32" ref-type="bibr">Ryu and Yin, 2017</xref>), with details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> (Supplementary Section S3).</p>
      <p>Since the factor loading vector <bold><sub><italic toggle="yes">γ</italic></sub></bold> quantifies the contribution of each gene to form the gene group, we select genes that have coefficients greater than some small threshold <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mo>ε</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, for example <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mo>ε</mml:mo><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, and treat them as marker genes for cell type <italic toggle="yes">C</italic>. In our implementation of the algorithm, <italic toggle="yes">w</italic> has a default value of 1.5, and <italic toggle="yes">λ</italic> is initialized to be <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msqrt><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">n</italic> is the sample size. The user can then adjust <italic toggle="yes">λ</italic> to achieve a desired output size of the marker gene set. For multiple cell types <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow></mml:math></inline-formula>, we repeatedly apply the algorithm above for each <italic toggle="yes">C<sub>i</sub></italic>, and compute all marker gene groups sequentially. Of course, the order of the cell type sequence in computing has an impact on the final marker gene list, but the impact is typically small if the cell types are well separated (Supplementary Section S4, Supplementary Fig. S3).</p>
      <p>Finally, we comment that an important advantage of MarkerPen, which is lacking in competing methods, is that it relies on a principled denoising approach for high-dimensional data. Specifically, most existing approaches rely directly on the pairwise <italic toggle="yes">sample</italic> correlation coefficients between genes, which are known to contain considerable noise in high dimensions. Instead, MarkerPen capitalizes on the expected sparsity of the marker gene set, and attempts to estimate the true correlation structure of genes. To this end, MarkerPen is able to automatically filter out most weak correlation coefficients, and as a result, the estimation of strong correlation coefficients between marker genes is more statistically sound.</p>
    </sec>
    <sec>
      <title>2.3 Data sources</title>
      <p>In the next section, we validate the performance of MarkerPen using a broad range of bulk and single-cell RNA-seq data, and here we provide some basic information of each dataset. Below are the bulk tissue data used in this article:
</p>
      <list list-type="order">
        <list-item>
          <p><bold>MSBB</bold> The Mount Sinai/JJ Peters VA Medical Center Brain Bank cohort (<xref rid="btab257-B36" ref-type="bibr">Wang <italic toggle="yes">et al</italic>., 2018</xref>) contains RNA-seq data from human temporal cortex, with 425 control samples and 425 samples from patients with Alzheimer’s disease (AD, Braak score <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></inline-formula>). Only the control samples are used.</p>
        </list-item>
        <list-item>
          <p><bold>ROSMAP</bold> The Religious Orders Study and the Rush Memory and Aging Project (<xref rid="btab257-B9" ref-type="bibr">De Jager <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab257-B27" ref-type="bibr">Mostafavi <italic toggle="yes">et al.</italic>, 2018</xref>) collects RNA-seq data from the human dorsolateral prefrontal cortex (DLPFC), with 288 control samples and 348 AD samples. Only the control samples are used.</p>
        </list-item>
        <list-item>
          <p><bold>Mayo RNAseq</bold> The Mayo Clinic RNA-seq dataset (<xref rid="btab257-B2" ref-type="bibr">Allen <italic toggle="yes">et al.</italic>, 2016</xref>, <xref rid="btab257-B3" ref-type="bibr">2018</xref>) contains human temporal cortex RNA-seq data with 28 control samples and 82 AD samples. Only the control samples are used.</p>
        </list-item>
        <list-item>
          <p><bold>BrainVar</bold> The BrainVar dataset (<xref rid="btab257-B37" ref-type="bibr">Werling <italic toggle="yes">et al</italic>., 2020</xref>) consists of 176 samples from the human DLPFC across development, from 6 post-conception weeks to young adulthood. To be comparable with other datasets we exclude pre-natal brains and focus on subjects that are at least 6 months old (epoch 3), finally with a sample size of 45.</p>
        </list-item>
        <list-item>
          <p><bold>CMC</bold> The human brain RNA-seq data collected by the CommonMind Consortium (<xref rid="btab257-B11" ref-type="bibr">Fromer <italic toggle="yes">et al.</italic>, 2016</xref>) contain 258 adult schizophrenia subjects and 279 adult control subjects, and only the control samples are used. As the original dataset spans a broad range of ages, we further split the control group into two subsets, resulting in groups with ages less than or equal to 70 (sample size 164) and greater than 70 (sample size 115).</p>
        </list-item>
      </list>
      <p>We also use single-cell and single-nucleus RNA-seq datasets:
</p>
      <list list-type="order">
        <list-item>
          <p><xref rid="btab257-B25" ref-type="bibr">Mathys <italic toggle="yes">et al.</italic> (2019)</xref> provides single-nucleus transcriptomes from DLPFC of 48 subjects with varying degrees of AD pathology. Only the data from 17 control subjects are used.</p>
        </list-item>
        <list-item>
          <p><xref rid="btab257-B8" ref-type="bibr">Darmanis <italic toggle="yes">et al.</italic> (2015)</xref> obtains single-cell RNA-seq data of human cortical tissues from eight adults and four embryonic samples. Only the adult data are used.</p>
        </list-item>
        <list-item>
          <p>Li <italic toggle="yes">et al.</italic> (2018) collects single-nucleus RNA-seq data from DLPFC of three adult brains.</p>
        </list-item>
        <list-item>
          <p><xref rid="btab257-B39" ref-type="bibr">Zeisel <italic toggle="yes">et al.</italic> (2015)</xref> provides mouse cerebral cortex single-cell RNA-seq data.</p>
        </list-item>
      </list>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Quality of selected markers</title>
      <p>In this section, we demonstrate the quality of marker genes selected by MarkerPen from three different angles.</p>
      <p>First, as explained in Section 2.1, we expect to see that marker genes for the same cell type are highly correlated in the bulk data. Therefore, the quality of selected marker genes can be visually examined by the correlation matrix. We study human brain bulk tissue RNA-seq data, and use the MSBB dataset for illustration. To apply the MarkerPen algorithm, the prior marker gene list is obtained from existing literature, including 184 marker genes for astrocytes, 130 genes for oligodendrocytes, 319 genes for neurons (all three from <xref rid="btab257-B7" ref-type="bibr">Cahoy <italic toggle="yes">et al.</italic>, 2008</xref>), 100 genes for microglia (<xref rid="btab257-B15" ref-type="bibr">Hickman <italic toggle="yes">et al.</italic>, 2013</xref>) and 237 genes for endothelial cells (<xref rid="btab257-B6" ref-type="bibr">Butler <italic toggle="yes">et al.</italic>, 2016</xref>). <xref rid="btab257-F1" ref-type="fig">Figure 1A</xref> shows the sample correlation matrix of the published marker genes in the MSBB bulk data. It can be seen that the correlation matrix roughly forms five blocks, but the boundary between the blocks is not very clear as much noise exists.</p>
      <fig position="float" id="btab257-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Correlation and expression patterns of published and MarkerPen-refined gene lists. (<bold>A</bold>) Sample correlation matrix of published marker genes in the MSBB bulk data highlights the weak correlation among cell-type marker genes. (<bold>B</bold>) Gene expression of single-nucleus reference data from <xref rid="btab257-B25" ref-type="bibr">Mathys <italic toggle="yes">et al.</italic> (2019)</xref> on published marker genes does not exhibit the expected pattern of marker genes. (<bold>C</bold>) Sample correlation matrix of refined marker genes output by MarkerPen highlights much tighter correlation among cell-type marker genes. (<bold>D</bold>) Expression of genes identified by MarkerPen using bulk data shows the expected pattern of marker genes in single-nucleus reference data</p>
        </caption>
        <graphic xlink:href="btab257f1" position="float"/>
      </fig>
      <p>Then we apply the MarkerPen algorithm to refine the given marker gene list. For each cell type, we restrict the search range to the union of the published marker genes and the top 500 genes that have the highest fidelity scores given by <xref rid="btab257-B21" ref-type="bibr">Kelley <italic toggle="yes">et al.</italic> (2018)</xref>. <xref rid="btab257-F1" ref-type="fig">Figure 1C</xref> demonstrates the sample correlation matrix of the refined genes, in which 50 genes are selected for each cell type for visualization purpose. The details of the marker gene refinement procedure are given in Supplementary Section S5 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>, Supplementary Figs S4, S5). It is clear that after the refinement, genes in the same block have much stronger mutual correlation, whereas genes in different blocks are only weakly correlated. Moreover, it is interesting to find that marker genes for microglia can be clearly detected, although microglia only account for a small proportion of all cells in the brain. This implies that the low abundance of a cell type in the samples does not harm the algorithm, as long as there exist genes that are highly expressed in that type and lowly expressed elsewhere. To summarize, genes refined by MarkerPen have a correlation structure that better fits the property of marker genes.</p>
      <p>Second, by definition, marker genes should be largely expressed in one cell type but weakly expressed in others. Therefore, it is helpful to examine the expression level of selected marker genes in purified single-cell data. We use the single-nucleus transcriptome data from <xref rid="btab257-B25" ref-type="bibr">Mathys <italic toggle="yes">et al.</italic> (2019)</xref> to demonstrate this idea. For each cell type, we randomly select 100 samples (50 for endothelial due to the limited number in the dataset), and plot the logarithm-scale expression matrix on published and refined marker genes in <xref rid="btab257-F1" ref-type="fig">Figure 1B and D</xref>, respectively. In <xref rid="btab257-F1" ref-type="fig">Figure 1B</xref>, we can observe that many genes in the published list behave like noise, as they show very low expression level in virtually all cell types. In contrast, this defect has been greatly reduced in <xref rid="btab257-F1" ref-type="fig">Figure 1D</xref>, where most noise genes have been removed by MarkerPen. Moreover, a statistical test is conducted to formally validate the improvement. For each cell, we compute the difference between the mean value of marker gene expressions and the mean value of non-marker gene expressions, both at logarithmic scales, and call this value the ‘marker strength’ for brevity. The marker strength for the published list in <xref rid="btab257-F1" ref-type="fig">Figure 1B</xref> has a median of 1.275, and that for the refined list in <xref rid="btab257-F1" ref-type="fig">Figure 1D</xref> has a median of 2.049. The paired Wilcoxon signed rank test rejects the null hypothesis that the distribution of marker strength has no change, with <italic toggle="yes">P</italic>-value <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>2.2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and a sample size of <italic toggle="yes">n</italic> = 450. These findings further justify the MarkerPen selection algorithm.</p>
      <p>Finally, considering that the transcriptome data from <xref rid="btab257-B25" ref-type="bibr">Mathys <italic toggle="yes">et al.</italic> (2019)</xref> and the MSBB bulk data may not fully match, it is more appropriate to study the purified cells from the same subjects as in the bulk data. However in practice, this is not always possible. Instead, we use the bMIND algorithm (<xref rid="btab257-B35" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2021</xref>) to estimate CTS gene expression for each subject in the bulk data. The output of bMIND can be viewed as the average of denoised single-cell data for the subjects in the bulk data. In <xref rid="btab257-F2" ref-type="fig">Figure 2</xref> we plot the estimated CTS gene expression matrix on three types of markers: the published marker genes, the markers selected by MarkerPen, and the bMIND markers that are directly selected from the estimated CTS gene expression. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7</xref> in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> shows that the bMIND markers are indeed meaningful, and the estimated CTS gene expression can be used as a good substitute to the ground truth when the latter is unavailable. Since the bMIND algorithm is independent of MarkerPen and utilizes richer information, in our evaluation we treat the bMIND markers as the reference and look to see if other markers match the good properties exhibited in the bMIND set.</p>
      <fig position="float" id="btab257-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>CTS gene expression of the MSBB, ROSMAP and Mayo RNAseq datasets for three types of marker genes: the published markers, the refined list selected by MarkerPen and the bMIND markers. The heatmaps show the relative expression level, defined by the ratio of estimated CTS gene expression to the gene-wise average gene expression, in the logarithmic scale. Within each heatmap, one column stands for one subject. Ast=astrocytes, Oli=oligodendrocytes, Mic=microglia and Neu=neurons. The MarkerPen markers mimic the desired block diagonal pattern observed for bMIND marker genes</p>
        </caption>
        <graphic xlink:href="btab257f2" position="float"/>
      </fig>
      <p>The first row of <xref rid="btab257-F2" ref-type="fig">Figure 2</xref> demonstrates the results for the MSBB dataset, from which we can find that published markers contain a lot of noise, whereas the MarkerPen output is very similar to that of bMIND. Also included in <xref rid="btab257-F2" ref-type="fig">Figure 2</xref> are the results for two additional bulk datasets, the ROSMAP and Mayo RNAseq data, both of which give similar results that validate the quality of MarkerPen genes. It is also worth noting that the three bulk datasets show very different correlation structures for a fixed set of genes (Supplementary Fig. S6), implying that it is preferable to adaptively select marker genes specific to each bulk dataset.</p>
    </sec>
    <sec>
      <title>3.2 Performance in downstream analysis</title>
      <p>As marker genes are essential tools for many downstream analyses such as cell type fraction deconvolution, in this section we use simulation experiments to evaluate the performance of our algorithm in such tasks. Cell type fraction deconvolution is a problem commonly seen in bulk RNA-seq data analysis. Because the deconvolution result depends on the selection of marker genes, the quality of the selected markers can be measured by the estimation error of cell type fractions. We design a simulation experiment to compare MarkerPen with two supervised marker gene selection algorithms, with experiment setting described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> (Supplementary Section S7, Supplementary Figs S8, S9, S10).</p>
      <p>In practice, deconvolution can be conducted with or without single-cell reference samples, and the quality of reference samples may also vary. To reflect these different scenarios, we design three models for simulating the observed data:
</p>
      <list list-type="order">
        <list-item>
          <p><bold>Matched reference case</bold> Reference samples and the bulk data are simulated from the same signature matrix.</p>
        </list-item>
        <list-item>
          <p><bold>Noisy reference case</bold> The bulk data use a perturbed version of the signature matrix: some percentage of the genes, ranging from 5% to 30%, are set to noise. This indicates that some genes may be markers in the reference data, but they play no role in the bulk data.</p>
        </list-item>
        <list-item>
          <p><bold>No reference case</bold> No reference samples are simulated.</p>
        </list-item>
      </list>
      <p>For model 1 and model 2, both the bulk data and the reference samples are available, and we use a supervised method, <bold>dtangle</bold> (<xref rid="btab257-B17" ref-type="bibr">Hunt <italic toggle="yes">et al.</italic>, 2019</xref>), to accomplish the deconvolution. For model 3, only the bulk data and the marker gene list are available, so we apply a semi-supervised algorithm for deconvolution, the digital sorting algorithm (<bold>DSA</bold>, <xref rid="btab257-B40" ref-type="bibr">Zhong <italic toggle="yes">et al.</italic>, 2013</xref>). The choice of deconvolution algorithms is beyond the scope of this article, as the main purpose of this section is to evaluate the effect of marker gene selection for a fixed deconvolution method. In practice any deconvolution algorithm that needs marker genes can be used in place of the methods investigated here.</p>
      <p>In our experiments, we use the mouse brain single-cell RNA-seq data from <xref rid="btab257-B39" ref-type="bibr">Zeisel <italic toggle="yes">et al.</italic> (2015)</xref> to generate simulation data. We select seven major cell types (astrocytes, oligodendrocytes, microglia, endothelial, interneurons, S1 pyramidal neurons and CA1 pyramidal neurons) from the whole single-cell data, and restrict to 2452 genes that are known to be associated with the cell types (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> of <xref rid="btab257-B39" ref-type="bibr">Zeisel <italic toggle="yes">et al.</italic>, 2015</xref>). Following the steps in Supplementary Section S7, we simulate the signature matrix, reference samples, fraction matrix and the bulk data according to a stochastic model. In each simulation run, the prior marker gene list is formed by randomly selecting 50 genes from each cell type block of the signature matrix. Of course, due to the possible perturbation of the signature matrix, some of the claimed marker genes will be noise in the bulk data, and hence provide little information about the cell type. This treatment is used to mimic the quality of marker genes in reality, and a selection method should be able to filter out the artificially noisy genes.</p>
      <p>We repeat the procedure above 30 times, so that in every simulation run, the generated data are different but follow the same stochastic model. We compute the deconvolution estimation errors in each simulation run, and summarize their distribution density curves in <xref rid="btab257-F3" ref-type="fig">Figure 3</xref>.</p>
      <fig position="float" id="btab257-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Impact of marker gene selection algorithm on deconvolution estimation error, displayed via density curves. The vertical axis displays different marker gene selection methods: MarkerPen, the proposed method; <italic toggle="yes">P</italic>-value and Ratio, selection methods based on reference samples and implemented in the <bold>dtangle</bold> R package; Published, using all published marker genes without selection. Panels display varying levels of reference data quality, from a perfect match to 30% contamination and finally no reference data at all</p>
        </caption>
        <graphic xlink:href="btab257f3" position="float"/>
      </fig>
      <p>In <xref rid="btab257-F3" ref-type="fig">Figure 3</xref>, each panel represents one model for the reference sample. It is clear that when the reference sample and bulk data are matched, all marker gene selection methods behave equally well, compared with the last row that stands for no selection. However, when the noise level increases, selection methods purely based on the reference sample become much worse, whereas the proposed MarkerPen is quite robust and accurate. When no reference sample is available, reference-based selection methods do not apply, but MarkerPen still shows improvement via semi-supervised marker gene selection. These findings highlight the power of MarkerPen in refining published marker genes.</p>
    </sec>
    <sec>
      <title>3.3 Robustness</title>
      <p>In Section 3.2, we have studied the accuracy of MarkerPen in downstream deconvolution tasks. Then a natural question is how robust MarkerPen is across different datasets. To answer this question, we experiment on the combination of four bulk datasets and three single-cell and single-nucleus reference datasets, and study the variation of their deconvolution results. Descriptions of these datasets are given in Section 2.3. The rationale of the experiment is that the proportions of cell types should not vary too much across datasets, so the most robust marker gene selection method should minimize the variations.</p>
      <p>For each pair of datasets, we estimate the cell type fractions for each observation, using three marker gene selection methods: the proposed MarkerPen, the supervised method based on single-cell or single-nucleus reference data, and a fixed set of marker genes given by the <bold>BRETIGEA</bold> R package (<xref rid="btab257-B26" ref-type="bibr">McKenzie <italic toggle="yes">et al.</italic>, 2018</xref>). <xref rid="btab257-F4" ref-type="fig">Figure 4A</xref> shows the estimated fractions averaged over all observations in the dataset. It is easy to see that the supervised algorithm and <bold>BRETIGEA</bold> generate significantly different results under three reference datasets, whereas MarkerPen is much more consistent and robust. We then compute a metric to measure the variation of estimated fractions across different reference datasets (fraction variation, Supplementary Section S8), and show the values in <xref rid="btab257-F4" ref-type="fig">Figure 4B</xref>. The first four panels give the comparison in each bulk dataset, and the last panel shows the result over all datasets. In all settings MarkerPen is much more robust to the choice of single-cell reference data compared with others.</p>
      <fig position="float" id="btab257-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Evaluation of the stability of deconvolution results using a variety of reference data. (<bold>A</bold>) Estimated cell type fractions on different bulk datasets using three single-cell/nucleus reference datasets and three marker gene selection methods. Deconvolution is conducted using the <bold>dtangle</bold> package. Neu=neurons, Ast=astrocytes, Oli=oligodendrocytes, Mic=microglia, End=endothelial. (<bold>B</bold>) Comparison of the variation in estimated fractions due to different reference data for three marker gene selection methods. This metric quantifies the variation of fraction estimates across different single-cell and single-nucleus reference data. Variation is minimized for MarkerPen and maximized for the supervised method, which relies heavily on the reference data. In both (A) and (B), bars represent mean values averaged over samples, and error bars show the 99% confidence intervals for the mean values</p>
        </caption>
        <graphic xlink:href="btab257f4" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion and discussion</title>
    <p>We have presented the MarkerPen algorithm for identifying cell-type-specific marker genes from bulk tissue data. Unlike most marker gene detection methods that heavily rely on single-cell reference samples, MarkerPen is a semi-supervised method that only requires the bulk data and a prior marker gene list. This feature makes the algorithm especially useful when tissue level data are not well matched with available single-cell data. More importantly, using well selected marker genes corrects the bias and error of downstream analyses of bulk tissue samples. Furthermore, MarkerPen interfaces nicely with other marker gene selection algorithms. For example, supervised methods applied to single-cell RNA-seq data can provide the prior gene list for MarkerPen.</p>
    <p>A promising application of MarkerPen is to study the evolution of marker genes over developmental stages. Preliminary studies of the CMC data reveal that some marker genes identified from younger subjects are less correlated in older brains (Supplementary Section S10, Supplementary Fig. S12). The BrainVar data, which include brains sampled over all developmental stages, would provide an ideal dataset to further investigate how marker genes change over time; however, it will be more challenging to compare marker genes of mature brains with those of fetal brains. We leave this topic for future explorations.</p>
    <p>The use of single-cell RNA-seq has increased. However, there are drawbacks to single-cell data, including its noisy nature and the limited number of subjects from whom cell are harvested for study. By contrast, bulk transcriptome data are less noisy, and they can readily be sampled from many subjects at a reasonable cost. With larger sample sizes, bulk tissue samples can be much more informative for downstream analyses, such as eQTL mapping. With the help of good marker genes, many deconvolution methods can provide accurate estimates of cell type fractions (<xref rid="btab257-B13" ref-type="bibr">Gaujoux and Seoighe, 2013</xref>; <xref rid="btab257-B17" ref-type="bibr">Hunt <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab257-B28" ref-type="bibr">Newman <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab257-B29" ref-type="bibr">2019</xref>; <xref rid="btab257-B40" ref-type="bibr">Zhong <italic toggle="yes">et al.</italic>, 2013</xref>). Furthermore, cell type fractions are input of methods such as MIND (<xref rid="btab257-B34" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2020</xref>) and bMIND (<xref rid="btab257-B35" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2021</xref>) to estimate CTS expression profiles from bulk tissue samples, permitting cell-type analysis for features such as eQTLs. The performance of these algorithms is highly dependent on the selection of good marker genes, hence MarkerPen can play a critical role in the analysis of CTS expression.</p>
    <p>There are two limitations to the current version of MarkerPen. First, although MarkerPen is based on the eigen decomposition of correlation matrices, its computational complexity is greater than ordinary principal component analysis. In practice, one might need to limit the search range of genes to a few thousand. Despite this restriction, the algorithm has been implemented in the <bold>markerpen</bold> R package with core part written in efficient C++ code. Another challenge for MarkerPen is to detect cell types that are similar, such as neuron subtypes. These subtypes do not induce a strict block structure in the correlation matrix, making it harder to identify subtype-level marker genes.</p>
    <p>MarkerPen can be extended in several directions. For instance, the current algorithm that selects marker genes performs the calculation on one cell type at a time. It may achieve better performance, however, by jointly selecting mutually exclusive marker genes for multiple cell types. Another promising direction would be to extend MarkerPen to analyzing unannotated single-cell RNA-seq data. It might be useful in selecting marker genes for clustering unlabeled cells.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab257_Supplementary_Data</label>
      <media xlink:href="btab257_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank the editor, the associate editor and three referees for their constructive comments, which have greatly helped us improve this article. They are indebted to Bernie Devlin for suggesting this topic of inquiry and Lu Xie for preliminary investigations of the idea several years ago. They benefited from comments on data analysis from Gabriel Hoffman, Michael Breen and Panos Roussos.</p>
    <sec>
      <title>Funding</title>
      <p>Data were generated as part of the CommonMind Consortium supported by funding from Takeda Pharmaceuticals Company Limited, F. Hoffman-La Roche Ltd and National Institutes of Health [R01MH085542, R01MH093725, P50MH066392, P50MH080405, R01MH097276, RO1-MH-075916, P50M096891, P50MH084053S1, R37MH057881, AG02219, AG05138, MH06692, R01MH110921, R01MH109677, R01MH109897, U01MH103392 and contract HHSN271201300031C] through IRP NIMH. Brain tissue for the study was obtained from the following brain bank collections: the Mount Sinai NIH Brain and Tissue Repository, the University of Pennsylvania Alzheimer’s Disease Core Center, the University of Pittsburgh NeuroBioBank and Brain and Tissue Repositories, and the NIMH Human Brain Collection Core. CMC Leadership: Panos Roussos, Joseph Buxbaum, Andrew Chess, Schahram Akbarian, Vahram Haroutunian (Icahn School of Medicine at Mount Sinai), Bernie Devlin, David Lewis (University of Pittsburgh), Raquel Gur, Chang-Gyu Hahn (University of Pennsylvania), Enrico Domenici (University of Trento), Mette A. Peters, Solveig Sieberts (Sage Bionetworks), Thomas Lehner, Stefano Marenco, Barbara K. Lipska (NIMH). The results published here are in part based on data obtained from the AD Knowledge Portal (<ext-link xlink:href="https://adknowledgeportal.synapse.org" ext-link-type="uri">https://adknowledgeportal.synapse.org</ext-link>). Study data were provided by the Rush Alzheimer’s Disease Center, Rush University Medical Center, Chicago. Data collection was supported through funding by NIA [P30AG10161 (ROS), R01AG15819 (ROSMAP; genomics and RNAseq), R01AG17917 (MAP), R01AG30146, R01AG36042 (5hC methylation, ATACseq), RC2AG036547 (H3K9Ac), R01AG36836 (RNAseq), R01AG48015 (monocyte RNAseq) RF1AG57473 (single nucleus RNAseq), U01AG32984 (genomic and whole exome sequencing), U01AG46152 (ROSMAP AMP-AD, targeted proteomics), U01AG46161(TMT proteomics), U01AG61356 (whole genome sequencing, targeted proteomics, ROSMAP AMP-AD)], the Illinois Department of Public Health (ROSMAP) and the Translational Genomics Research Institute (genomic). Additional phenotypic data can be requested at <ext-link xlink:href="http://www.radc.rush.edu" ext-link-type="uri">www.radc.rush.edu</ext-link>.</p>
      <p>This work was supported, in part, by the National Institute of Mental Health (NIMH) [R01MH123184, R37MH057881 and UO1NH122681]. J.L. research was partially supported by National Science Foundation [DMS-1553884 and DMS-2015492].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab257-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abbas</surname><given-names>A.R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>Deconvolution of blood microarray data identifies cellular activation patterns in systemic lupus erythematosus</article-title>. <source>PloS One</source>, <volume>4</volume>, <fpage>e6098</fpage>.<pub-id pub-id-type="pmid">19568420</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allen</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Human whole genome genotype and transcriptome data for Alzheimer’s and other neurodegenerative diseases</article-title>. <source>Sci. Data</source>, <volume>3</volume>, <fpage>160089</fpage>.<pub-id pub-id-type="pmid">27727239</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allen</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Conserved brain myelination networks are altered in Alzheimer’s and other neurodegenerative diseases</article-title>. <source>Alzheimer’s Dementia</source>, <volume>14</volume>, <fpage>352</fpage>–<lpage>366</lpage>.</mixed-citation>
    </ref>
    <ref id="btab257-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Avila Cobos</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Computational deconvolution of transcriptomics data from mixed cell populations</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>1969</fpage>–<lpage>1979</lpage>.<pub-id pub-id-type="pmid">29351586</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bakken</surname><given-names>T.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>A comprehensive transcriptional map of primate brain development</article-title>. <source>Nature</source>, <volume>535</volume>, <fpage>367</fpage>–<lpage>375</lpage>.<pub-id pub-id-type="pmid">27409810</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>L.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Analysis of body-wide unfractionated tissue data to identify a core human endothelial transcriptome</article-title>. <source>Cell Syst</source>., <volume>3</volume>, <fpage>287</fpage>–<lpage>301</lpage>.<pub-id pub-id-type="pmid">27641958</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cahoy</surname><given-names>J.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>A transcriptome database for astrocytes, neurons, and oligodendrocytes: a new resource for understanding brain development and function</article-title>. <source>J. Neurosci</source>., <volume>28</volume>, <fpage>264</fpage>–<lpage>278</lpage>.<pub-id pub-id-type="pmid">18171944</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Darmanis</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>A survey of human brain transcriptome diversity at the single cell level</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>112</volume>, <fpage>7285</fpage>–<lpage>7290</lpage>.<pub-id pub-id-type="pmid">26060301</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Jager</surname><given-names>P.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>A multi-omic atlas of the human frontal cortex for aging and Alzheimer’s disease research</article-title>. <source>Sci. Data</source>, <volume>5</volume>, <fpage>180142</fpage>.<pub-id pub-id-type="pmid">30084846</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fertuzinhos</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Laminar and temporal expression dynamics of coding and noncoding RNAs in the mouse neocortex</article-title>. <source>Cell Rep</source>., <volume>6</volume>, <fpage>938</fpage>–<lpage>950</lpage>.<pub-id pub-id-type="pmid">24561256</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fromer</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Gene expression elucidates functional impact of polygenic risk for schizophrenia</article-title>. <source>Nat. Neurosci</source>., <volume>19</volume>, <fpage>1442</fpage>–<lpage>1453</lpage>.<pub-id pub-id-type="pmid">27668389</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gaujoux</surname><given-names>R.</given-names></string-name>, <string-name><surname>Seoighe</surname><given-names>C.</given-names></string-name></person-group> (<year>2012</year>) <article-title>Semi-supervised nonnegative matrix factorization for gene expression deconvolution: a case study</article-title>. <source>Infect. Genet. Evol</source>., <volume>12</volume>, <fpage>913</fpage>–<lpage>921</lpage>.<pub-id pub-id-type="pmid">21930246</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gaujoux</surname><given-names>R.</given-names></string-name>, <string-name><surname>Seoighe</surname><given-names>C.</given-names></string-name></person-group> (<year>2013</year>) <article-title>Cellmix: a comprehensive toolbox for gene expression deconvolution</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>2211</fpage>–<lpage>2212</lpage>.<pub-id pub-id-type="pmid">23825367</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hawrylycz</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Canonical genetic signatures of the adult human brain</article-title>. <source>Nat. Neurosci</source>., <volume>18</volume>, <fpage>1832</fpage>–<lpage>1844</lpage>.<pub-id pub-id-type="pmid">26571460</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hickman</surname><given-names>S.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>The microglial sensome revealed by direct RNA sequencing</article-title>. <source>Nat. Neurosci</source>., <volume>16</volume>, <fpage>1896</fpage>–<lpage>1905</lpage>.<pub-id pub-id-type="pmid">24162652</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hilliard</surname><given-names>A.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>Molecular microcircuitry underlies functional specification in a basal ganglia circuit dedicated to vocal learning</article-title>. <source>Neuron</source>, <volume>73</volume>, <fpage>537</fpage>–<lpage>552</lpage>.<pub-id pub-id-type="pmid">22325205</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hunt</surname><given-names>G.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>dtangle: accurate and robust cell type deconvolution</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>2093</fpage>–<lpage>2099</lpage>.<pub-id pub-id-type="pmid">30407492</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Johnstone</surname><given-names>I.M.</given-names></string-name>, <string-name><surname>Lu</surname><given-names>A.Y.</given-names></string-name></person-group> (<year>2009</year>) <article-title>On consistency and sparsity for principal components analysis in high dimensions</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>104</volume>, <fpage>682</fpage>–<lpage>693</lpage>.<pub-id pub-id-type="pmid">20617121</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jolliffe</surname><given-names>I.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2003</year>) <article-title>A modified principal component technique based on the lasso</article-title>. <source>J. Comput. Graph. Stat</source>., <volume>12</volume>, <fpage>531</fpage>–<lpage>547</lpage>.</mixed-citation>
    </ref>
    <ref id="btab257-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jung</surname><given-names>S.</given-names></string-name>, <string-name><surname>Marron</surname><given-names>J.S.</given-names></string-name></person-group> (<year>2009</year>) <article-title>PCA consistency in high dimension, low sample size context</article-title>. <source>Ann. Stat</source>., <volume>37</volume>, <fpage>4104</fpage>–<lpage>4130</lpage>.</mixed-citation>
    </ref>
    <ref id="btab257-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kelley</surname><given-names>K.W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Variation among intact tissue samples reveals the core transcriptional features of human CNS cell classes</article-title>. <source>Nat. Neurosci</source>., <volume>21</volume>, <fpage>1171</fpage>–<lpage>1184</lpage>.<pub-id pub-id-type="pmid">30154505</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>V.Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Sc3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>483</fpage>–<lpage>486</lpage>.<pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal>; BrainSpan Consortium. (<year>2018</year>) <article-title>Integrative functional genomic analysis of human brain development and neuropsychiatric risks</article-title>. <source>Science</source>, <volume>362</volume>, <fpage>eaat7615</fpage>.<pub-id pub-id-type="pmid">30545854</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luecken</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Theis</surname><given-names>F.J.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Current best practices in single-cell RNA-seq analysis: a tutorial</article-title>. <source>Mol. Syst. Biol</source>., <volume>15</volume>, <fpage>e8746</fpage>.<pub-id pub-id-type="pmid">31217225</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mathys</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Single-cell transcriptomic analysis of Alzheimer’s disease</article-title>. <source>Nature</source>, <volume>570</volume>, <fpage>332</fpage>–<lpage>337</lpage>.<pub-id pub-id-type="pmid">31042697</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKenzie</surname><given-names>A.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Brain cell type specific gene expression and co-expression network architectures</article-title>. <source>Sci. Rep</source>., <volume>8</volume>, <fpage>1</fpage>–<lpage>19</lpage>.<pub-id pub-id-type="pmid">29311619</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mostafavi</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>A molecular network of the aging human brain provides insights into the pathology and cognitive decline of Alzheimer’s disease</article-title>. <source>Nat. Neurosci</source>., <volume>21</volume>, <fpage>811</fpage>–<lpage>819</lpage>.<pub-id pub-id-type="pmid">29802388</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Newman</surname><given-names>A.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>453</fpage>–<lpage>457</lpage>.<pub-id pub-id-type="pmid">25822800</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Newman</surname><given-names>A.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Determining cell type abundance and expression from bulk tissues with digital cytometry</article-title>. <source>Nat. Biotechnol</source>., <volume>37</volume>, <fpage>773</fpage>–<lpage>782</lpage>.<pub-id pub-id-type="pmid">31061481</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oldham</surname><given-names>M.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>Functional organization of the transcriptome in human brain</article-title>. <source>Nat. Neurosci</source>., <volume>11</volume>, <fpage>1271</fpage>–<lpage>1282</lpage>.<pub-id pub-id-type="pmid">18849986</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ponomarev</surname><given-names>I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Amygdala transcriptome and cellular mechanisms underlying stress-enhanced fear learning in a rat model of posttraumatic stress disorder</article-title>. <source>Neuropsychopharmacology</source>, <volume>35</volume>, <fpage>1402</fpage>–<lpage>1411</lpage>.<pub-id pub-id-type="pmid">20147889</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B32">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ryu</surname><given-names>E.K.</given-names></string-name>, <string-name><surname>Yin</surname><given-names>W.</given-names></string-name></person-group> (<year>2017</year>) Proximal-proximal-gradient method. <italic toggle="yes">arXiv preprint arXiv, 1708.06908</italic>.</mixed-citation>
    </ref>
    <ref id="btab257-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vu</surname><given-names>V.Q.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Fantope projection and selection: a near-optimal convex relaxation of sparse PCA</article-title>. <source>Adv. Neural Inf. Process. Syst</source>., <volume>26</volume>, <fpage>2670</fpage>–<lpage>2678</lpage>.</mixed-citation>
    </ref>
    <ref id="btab257-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Using multiple measurements of tissue to estimate subject-and cell-type-specific gene expression</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>782</fpage>–<lpage>788</lpage>.<pub-id pub-id-type="pmid">31400192</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Bayesian estimation of cell-type-specific gene expression per bulk sample with prior derived from single-cell data</article-title>. <source>Genome Res</source>.</mixed-citation>
    </ref>
    <ref id="btab257-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>The Mount Sinai cohort of large-scale genomic, transcriptomic and proteomic data in Alzheimer’s disease</article-title>. <source>Sci. Data</source>, <volume>5</volume>, <fpage>180185</fpage>.<pub-id pub-id-type="pmid">30204156</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Werling</surname><given-names>D.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Whole-genome and RNA sequencing reveal variation and transcriptomic coordination in the developing human prefrontal cortex</article-title>. <source>Cell Rep</source>., <volume>31</volume>, <fpage>107489</fpage>.<pub-id pub-id-type="pmid">32268104</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Cell type-specific analysis of human brain transcriptome data to predict alterations in cellular composition</article-title>. <source>Syst. Biomed</source>., <volume>1</volume>, <fpage>151</fpage>–<lpage>160</lpage>.</mixed-citation>
    </ref>
    <ref id="btab257-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeisel</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>. <source>Science</source>, <volume>347</volume>, <fpage>1138</fpage>–<lpage>1142</lpage>.<pub-id pub-id-type="pmid">25700174</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhong</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Digital sorting of complex tissues for cell type-specific gene expression profiles</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>, <fpage>89</fpage>.<pub-id pub-id-type="pmid">23497278</pub-id></mixed-citation>
    </ref>
    <ref id="btab257-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zou</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2006</year>) <article-title>Sparse principal component analysis</article-title>. <source>J. Comput. Graph. Stat</source>., <volume>15</volume>, <fpage>265</fpage>–<lpage>286</lpage>.</mixed-citation>
    </ref>
    <ref id="btab257-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zou</surname><given-names>H.</given-names></string-name>, <string-name><surname>Xue</surname><given-names>L.</given-names></string-name></person-group> (<year>2018</year>) <article-title>A selective overview of sparse principal component analysis</article-title>. <source>Proc. IEEE</source>, <volume>106</volume>, <fpage>1311</fpage>–<lpage>1320</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
