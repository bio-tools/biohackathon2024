<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10689673</article-id>
    <article-id pub-id-type="pmid">37982752</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad702</article-id>
    <article-id pub-id-type="publisher-id">btad702</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Snapper: high-sensitive detection of methylation motifs based on Oxford Nanopore reads</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1217-9234</contrib-id>
        <name>
          <surname>Konanov</surname>
          <given-names>Dmitry N</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
        <xref rid="btad702-cor1" ref-type="corresp"/>
        <!--konanovdmitriy@gmail.com-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Babenko</surname>
          <given-names>Vladislav V</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Belova</surname>
          <given-names>Aleksandra M</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Madan</surname>
          <given-names>Arina G</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
        <aff><institution>Department of Molecular and Translational Medicine, Moscow Institute of Physics and Technology, State University</institution>, Dolgoprudny 141700, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boldyreva</surname>
          <given-names>Daria I</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Glushenko</surname>
          <given-names>Oksana E</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Butenko</surname>
          <given-names>Ivan O</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fedorov</surname>
          <given-names>Dmitry E</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Manolov</surname>
          <given-names>Alexander I</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Krivonos</surname>
          <given-names>Danil V</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
        <aff><institution>Department of Molecular and Translational Medicine, Moscow Institute of Physics and Technology, State University</institution>, Dolgoprudny 141700, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lazarev</surname>
          <given-names>Vassilii N</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Govorun</surname>
          <given-names>Vadim M</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ilina</surname>
          <given-names>Elena N</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad702-cor1">Corresponding author. Laboratory of mathematical biology and bioinformatics, Research Institute for Systems Biology and Medicine, Nauchnyi Proezd, 18, Moscow 117246, Russia. E-mail: <email>konanovdmitriy@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-20">
      <day>20</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>11</issue>
    <elocation-id>btad702</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>14</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>30</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad702.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The Oxford Nanopore technology has a great potential for the analysis of methylated motifs in genomes, including whole-genome methylome profiling. However, we found that there are no methylation motifs detection algorithms, which would be sensitive enough and return deterministic results. Thus, the MEME suit does not extract all <italic toggle="yes">Helicobacter pylori</italic> methylation sites <italic toggle="yes">de novo</italic> even using the iterative approach implemented in the most up-to-date methylation analysis tool Nanodisco.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present Snapper, a new highly sensitive approach, to extract methylation motif sequences based on a greedy motif selection algorithm. Snapper does not require manual control during the enrichment process and has enrichment sensitivity higher than MEME coupled with Tombo or Nanodisco instruments that was demonstrated on <italic toggle="yes">H.pylori</italic> strain J99 studied earlier by the PacBio technology and on four external datasets representing different bacterial species. We used Snapper to characterize the total methylome of a new <italic toggle="yes">H.pylori</italic> strain A45. At least four methylation sites that have not been described for <italic toggle="yes">H.pylori</italic> earlier were revealed. We experimentally confirmed the presence of a new CCAG-specific methyltransferase and inferred a gene encoding a new CCAAK-specific methyltransferase.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Snapper is implemented using Python and is freely available as a pip package named “snapper-ont.” Also, Snapper and the demo dataset are available in Zenodo (10.5281/zenodo.10117651).</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Restriction-modification (R-M) systems are one of the essential mechanisms used by bacteria for protection from bacteriophage invasion. Generally, bacterial R-M systems are divided into four global groups (I, II, III, and IV) (<xref rid="btad702-B14" ref-type="bibr">Roberts <italic toggle="yes">et al.</italic> 2015</xref>) depending on the R-M complex structure. Despite their different architectures, all R-M systems share a common feature: the presence of site-specific DNA-binding domains that recognize specific short DNA sequence that should be methylated to prevent the restrictase activity.</p>
    <p>The Oxford Nanopore technology (ONT) is a long-read sequencing technology based on measuring electric current across the nanopore (<xref rid="btad702-B7" ref-type="bibr">Jain <italic toggle="yes">et al.</italic> 2016</xref>). The ONT makes it possible not only to detect the four canonical nucleotide bases, but also to additionally catch any of their modified forms that can significantly change the sequencing signal (<xref rid="btad702-B10" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2021</xref>). A number of tools aimed at accurate detection of methylated positions have already been developed (<xref rid="btad702-B17" ref-type="bibr">Stoiber <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btad702-B9" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad702-B12" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>). However, these tools have certain limitations in inferring methylation site sequences, especially when dealing with low-represented DNA motifs. We faced it when we were analyzing our <italic toggle="yes">Helicobacter pylori</italic> data. In general, these tools provide accurate detection of methylated positions in a considered genome (<xref rid="btad702-B17" ref-type="bibr">Stoiber <italic toggle="yes">et al.</italic> 2016</xref>) or prediction of methylation type (6mA, 5mC, and 4mC) in a chosen site (<xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>) but we found that the process of precise identification of methylation motif sequences is either not sensitive enough or requires a lot of manual control.</p>
    <p>Here, we present a novel tool called Snapper that performs high-sensitive identification of methylation motifs based on ONT sequencing data. The tool is mainly verified on <italic toggle="yes">H.pylori</italic> J99 sequencing data and compared with Tombo and Nanodisco, which are the most up-to-date instruments with similar functionality.</p>
    <p>We chose <italic toggle="yes">H.pylori</italic> species as the object of interest in this study firstly because it is a unique organism that is shown to bring up to 30 different R-M systems in its genome (<xref rid="btad702-B5" ref-type="bibr">Gorrell and Kwok 2017</xref>) and has methyltransferases (MTases) capable of methylation adenine as well as cytosine (<xref rid="btad702-B5" ref-type="bibr">Gorrell and Kwok 2017</xref>). Secondly, it is a naturally competent organism (<xref rid="btad702-B6" ref-type="bibr">Hofreuter <italic toggle="yes">et al.</italic> 2001</xref>) that can be quite easily modified to confirm new inferred MTases. Third, the <italic toggle="yes">H.pylori</italic> J99 strain has been characterized earlier using the PacBio sequencing technology (<xref rid="btad702-B8" ref-type="bibr">Krebes <italic toggle="yes">et al.</italic> 2014</xref>) that allows us to directly compare our results with competing technology. To additionally validate the method, a few external datasets were analyzed to ensure that Snapper is capable of detecting methylation sites in different bacterial taxa.</p>
    <p>To demonstrate the applicability of the developed tool, here, we use Snapper to characterize the methylome of a new <italic toggle="yes">H.pylori</italic> A45 strain. The method specificity is additionally demonstrated on A45-derived mutants disrupted in genes of MTases with known specificity.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Bacterial strains and culture manipulation</title>
      <p>The <italic toggle="yes">H.pylori</italic> A45 clinical isolate was obtained from a gastric mucosa biopsy sample of a patient with a gastric carcinoma (<xref rid="btad702-B11" ref-type="bibr">Momynaliev 2009</xref>). This isolate was used to obtain <italic toggle="yes">hpy</italic>, <italic toggle="yes">hp91/92</italic>, <italic toggle="yes">hp1352</italic>, <italic toggle="yes">hp8</italic>, and <italic toggle="yes">hp944</italic> derivatives defective in MTase genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). A targeted inactivation procedure was performed using the gene knockout method. The detailed description of <italic toggle="yes">H.pylori</italic> mutant strains construction is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S2</xref>.</p>
      <p><italic toggle="yes">Escherichia coli</italic> strain Top10 required for plasmid vectors assembly and production was cultivated at 37°C on solid Luria–Bertani medium or in liquid Luria–Bertani medium with aeration (150 rpm). The transformation procedure was carried out using the “heat shock” transformation protocol (<ext-link xlink:href="https://international.neb.com/protocols/2012/05/21/transformation-protocol" ext-link-type="uri">https://international.neb.com/protocols/2012/05/21/transformation-protocol</ext-link>). Chloramphenicol (8 µg/ml, Panreac, Spain) and kanamycin (15 µg/ml, Sigma, USA) were added to the medium for selection.</p>
      <p><italic toggle="yes">Helicobacter pylori</italic> strains were cultivated for 20–48 h at 37°C under microaerophilic conditions on Columbian agar solid medium (Becton Dickinson, USA) supplemented with 10% donor horse serum (PAA Labs, Austria). Chloramphenicol (8 µg/ml) and kanamycin (15 µg/ml) were added for the selection and passage of resistant mutant strains. Amplicon cell transformation was carried out as described in <xref rid="btad702-B4" ref-type="bibr">Belova <italic toggle="yes">et al.</italic> (2018)</xref>. Cells were cultivated for 24 h at 37°C under microaerophilic conditions on solid medium. The cell suspension (109 CFU) was moved on a new plate and cultivated for 4–5 h for undergrowth. Thereafter, sterile water suspension, containing 500 ng DNA fragments was applied dropwise onto the solid medium surface containing undergrowth cells. The dishes were then left agar side up in the CO<sub>2</sub> incubator for 17–20 h. The next day, cells were subsequently transferred to a selective medium containing corresponding antibiotics. Clones found on plates after 4–5 days were verified to be <italic toggle="yes">H.pylori</italic> and to contain the specific insertions by PCR using primer sets listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>. For any consequent assay all <italic toggle="yes">H.pylori</italic> strains were harvested from the plates after 2 days growth. Cells were washed with HBSS buffer, pH 7.5 (Hank’s Balanced Salt Solution, Thermo Fisher, USA) and precipitated by centrifugation at 3000 × <italic toggle="yes">g</italic> for 10 min for genomic DNA preparation as described earlier.</p>
    </sec>
    <sec>
      <title>2.2 DNA manipulation</title>
      <p>Vectors and mutant strains used in this study are listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. All standard methods of DNA manipulation, such as plasmid isolation by alkaline lysis, restriction endonuclease digestion, and ligation, were performed according to the protocols of <xref rid="btad702-B15" ref-type="bibr">Sambrook <italic toggle="yes">et al.</italic> (1989)</xref>. <italic toggle="yes">Helicobacter pylori</italic> genomic DNA was prepared using the diaGene kit for DNA extraction from cell cultures (diaGene, Russia). Single DNA fragments or PCR amplification products for cloning or sequencing purposes were purified from agarose gels using Cleanup Standard Kit (Evrogen, Russia). DNA restriction enzymes were obtained from Fermentas (Thermo Fisher Scientific, USA) and were used according to the directions of the manufacturers.</p>
    </sec>
    <sec>
      <title>2.3 Sequencing</title>
      <sec>
        <title>2.3.1 Whole-genome amplification</title>
        <p>The Qiagen REPLI-g Single Cell Kit was used to perform whole-genome amplification to exclude epigenetically modified bases. The method produced micrograms of DNA from 10 ng of input genomic DNA, following the manufacturer’s guidelines and 8 h of amplification time at 30°C followed by deactivation at 65°C for 3 min.</p>
      </sec>
      <sec>
        <title>2.3.2 Oxford Nanopore</title>
        <p>The DNA was isolated by using the Wizard DNA extraction kit (Promega Corporation, USA) and size selected with optimized solid phase reversible immobilization (SPRI) beads. The DNA concentration and quality were determined on a Qubit 4 Fluorometer and Nanodrop ND-1000 (Thermo Fisher Scientific). The long reads were generated with MinION sequencing (Oxford Nanopore Technologies, UK). The sequencing libraries were prepared using the ligation sequencing kit SQK-LSK109, native barcoding expansion kit EXP-NBD104 and run in a FLOMIN106 flow cell. Reads were basecalled using Guppy v3.6.1. using default parameters.</p>
      </sec>
      <sec>
        <title>2.3.3 Illumina</title>
        <p>A NEBNext Ultra DNA library prep kit (New England Biolabs, USA) was used to prepare fragment libraries for genome sequencing. Sequencing was performed on the HiSeq 2500 System (Illumina, USA) HiSeq Rapid SBS Kit V2 using a 2 × 250 bp run configuration.</p>
        <p><italic toggle="yes">De novo</italic> assembly was performed by hybrid assembler Unicycler (v0.4.8) (<xref rid="btad702-B19" ref-type="bibr">Wick <italic toggle="yes">et al.</italic> 2017</xref>) using default parameters. Identification of the protein-coding sequences and primary annotation were performed using PROKKA v1.14.6 (<xref rid="btad702-B16" ref-type="bibr">Seemann 2014</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Methylation analysis</title>
      <sec>
        <title>2.4.1 Tombo</title>
        <p>Raw signals from the fast5 files obtained for both native and WGS samples were mapped to corresponding reference genome positions using “tombo resquiggle” command (<xref rid="btad702-B17" ref-type="bibr">Stoiber <italic toggle="yes">et al.</italic> 2016</xref>). Next, modified positions were extracted using the “model sample compare” tombo mode. The resulting positions were used to construct all sequences that are likely to bring a methylation base, with the sequence length chosen to be 12, 18, and 22. These nucleotide contexts were processed by MEME (<xref rid="btad702-B2" ref-type="bibr">Bailey <italic toggle="yes">et al.</italic> 2015</xref>) with algorithm parameters recommended in the Tombo documentation and with customized parameters (-mod, -objfun, and -ng) in order to find the most sensitive approach. The motifs that were significantly over-represented in the selected contexts were considered as methylation sites.</p>
        <p>Tombo was used only to analyze <italic toggle="yes">H.pylori</italic> J99 and four external datasets and as a result was excluded from the analysis of <italic toggle="yes">H.pylori</italic> A45 since its sensitivity turned out to be not enough for the analysis of highly methylated genomes.</p>
      </sec>
      <sec>
        <title>2.4.2 Nanodisco</title>
        <p>For each strain, both sample and control fast5 files and the assembly file were processed according to the standard Nanodisco (v.1.0.3) pipeline described in the documentation (<ext-link xlink:href="https://nanodisco.readthedocs.io/en/latest/overview.html" ext-link-type="uri">https://nanodisco.readthedocs.io/en/latest/overview.html</ext-link>). While running motif extraction stage (“nanodisco motif”), we manually controlled each motif inference iteration observing the pdf files generated by the tool since the automated mode turned out to be prone to occasional motif collisions. For external datasets, we used the motifs discovered by the authors <italic toggle="yes">de novo</italic> (listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p>
      </sec>
      <sec>
        <title>2.4.3 Snapper</title>
        <p>Single-fast5 files obtained with “tombo resquiggle” were transformed to the multifast5 format to provide faster access to the sequencing raw signal data. These multifast5 files were processed using the python h5py library in order to collect signals for all <italic toggle="yes">k</italic>-mers presented in the considered genome for each strand independently. <italic toggle="yes">k</italic> was chosen to be 11 or higher (15 by default) in order to guarantee coverage of all 6-mers that cover an individual base (<xref rid="btad702-F1" ref-type="fig">Fig. 1A</xref>). Thus, at first the algorithm generates a hash-table, where all presented <italic toggle="yes">k</italic>-mers are used as keys and corresponding normalized signal levels as values.</p>
        <fig position="float" id="btad702-F1">
          <label>Figure 1.</label>
          <caption>
            <p>The principal scheme of the Snapper pipeline. In the first stage, for each <italic toggle="yes">k</italic>-mer in the reference genome (A and B), the algorithm collects normalized signal levels for this <italic toggle="yes">k</italic>-mer from multi-fast5 files for both native and WGA samples (here, <italic toggle="yes">k</italic> is chosen to be 11). Thereafter, for each <italic toggle="yes">k</italic>-mer presented in the genome, the algorithm directly compares the collected signal distributions (C) using the Kolmogorov–Smirnov test in order to select <italic toggle="yes">k</italic>-mers that most likely contain a modified base. The result of the first stage is an exhaustive set of all potentially modified <italic toggle="yes">k</italic>-mers (D). Next, the greedy motif enrichment algorithm implemented in Snapper iteratively extracts potential methylation motifs and calculates corresponding motif confidence levels (E). By default, motifs with confidence level &gt;5000 are considered as significant but the authors recommend manually verifying extracted motifs with confidence levels lower than 3000 especially while the observed signal shift is rather weak. The main recommendations on how to interpret the Snapper results are available in the user guide (<ext-link xlink:href="https://snapper-tutorial.readthedocs.io/en/latest/usercases.html#main-points" ext-link-type="uri">https://snapper-tutorial.readthedocs.io/en/latest/usercases.html#main-points</ext-link>)</p>
          </caption>
          <graphic xlink:href="btad702f1" position="float"/>
        </fig>
        <p>Next, for each <italic toggle="yes">k</italic>-mer in the hash-table, the Kolmogorov–Smirnov test is performed to compare signal level distributions between native and WGA samples (or, more generally, between any two samples passed as the input). Before the testing, the algorithm performs an artificial balancing of the sample sizes by random sampling (without replacement) of <italic toggle="yes">N</italic> values from each considered signal distribution to ensure the uniformity of the <italic toggle="yes">k</italic>-mers coverage (<italic toggle="yes">N</italic> was chosen to be 200). This balancing procedure is applied to make possible direct comparison of statistics values between <italic toggle="yes">k</italic>-mers, which are differently presented in the reference genome and to use the same statistics thresholds to infer modified positions along the genome. As a result, the algorithm returns the list of <italic toggle="yes">k</italic>-mers that are most likely to contain a modified base. In the further text, this list will be named <italic toggle="yes">seq_set</italic>. Simultaneously, the algorithm collects signal levels for long <italic toggle="yes">k</italic>-mers (with length of 29 by default). These long <italic toggle="yes">k</italic>-mers are used by the algorithm for additional motif refinement and enrichment of long motifs (mostly methylated by Type I R-M systems).</p>
        <p>The next step differs from the classical motif enrichment approaches like the tools included in the MEME Suit. We have implemented a highly sensitive greedy algorithm that is aimed to generate the minimal set of short supermotifs of length 4–8 that can explain most part of sequences in the <italic toggle="yes">seq_set</italic>, under the assumption that all sequences in the <italic toggle="yes">seq_set</italic> contain at least one modified base. The principal idea of the algorithm is iterative search for the most over-represented motif in the <italic toggle="yes">seq_set</italic> in comparison with a reference genome using the χ<sup>2</sup> statistics, extraction it as a potential modification motif, following procedure of motif adjustment, which additionally ensures the correctness and completeness of the extracted motif, and filtering the <italic toggle="yes">seq_set</italic> list by removing all sequences that contain the extracted motif variant. After the <italic toggle="yes">seq_set</italic> filtering, the search and extraction procedure repeats. The termination of the algorithm work is determined by the input parameters <italic toggle="yes">confidence</italic> and <italic toggle="yes">max_motifs</italic>, where the <italic toggle="yes">confidence</italic> parameter means the minimal value of χ<sup>2</sup> test statistic (the default value is 5000 to provide high sensitivity), and the <italic toggle="yes">max_motifs</italic> parameter means the maximum desired number of extracted modification motifs (the default value is 20). As a result, the algorithm returns a sorted list of all potential motifs with corresponding confidence levels (we observed that typical confidence values for known methylation motifs are higher than 3000). A more formal explanation of the motif enrichment algorithm is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S3</xref>.</p>
      </sec>
    </sec>
    <sec>
      <title>2.5 External data collection</title>
      <p>Raw FAST5-files for <italic toggle="yes">Thermacetogenium phaeum</italic> DSM 12270, <italic toggle="yes">Neisseria gonorrhoeae</italic> FA 1090, <italic toggle="yes">Methanospirillum hungatei</italic> JF-1, and <italic toggle="yes">Clostridium perfringens</italic> ATCC 13124 were downloaded from SRP219538.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Software description</title>
      <p>We have developed a novel high-sensitive algorithm for methylation motifs detecting based on Oxford Nanopore sequencing data. The algorithm has been implemented as a command-line tool called Snapper and is available as a pip package to install. To perform non-target methylome analysis, the tool requires native and control (obtained by WGA) DNA samples being sequenced and resquiggled using Tombo. Snapper uses a <italic toggle="yes">k</italic>-mer approach, with <italic toggle="yes">k</italic> chosen to be at least 11 to guarantee coverage of all 6-mers that cover one particular base (<xref rid="btad702-F1" ref-type="fig">Fig. 1A</xref>) under the assumption that, in general, ∼6 bases are located in the nanopore simultaneously (<xref rid="btad702-B20" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2021</xref>). By default, the <italic toggle="yes">k</italic> size is set to be 15 but can be tuned by the user. The raw signals data are extracted from the input fast5-files until the required minimal mean genome coverage depth is reached. The default value of the minimal coverage depth parameter was set to be 40×. This value was chosen since it showed a satisfactory convergence of the results on the external datasets, which will be described in detail below.</p>
      <p>The first stage of the Snapper pipeline is the extraction of nucleotide short <italic toggle="yes">k</italic>-mers (typical <italic toggle="yes">k</italic> = 11–15, must be odd), which are most likely to contain a modified base. The comparison of signal distributions <bold>(</bold><xref rid="btad702-F1" ref-type="fig">Fig. 1C</xref>) is performed using the Kolmogorov–Smirnov test statistics. Next, all the extracted <italic toggle="yes">k</italic>-mers (<xref rid="btad702-F1" ref-type="fig">Fig. 1D</xref>) are merged by a greedy algorithm, which generates the minimal set of potential modification motifs which can explain the most part of the selected <italic toggle="yes">k</italic>-mers (<xref rid="btad702-F1" ref-type="fig">Fig. 1E</xref>), under the assumption that all selected <italic toggle="yes">k</italic>-mers contain at least one modified base. Snapper uses negative background for enrichment, and χ<sup>2</sup> statistics is used to estimate a confidence level for the extracted motifs.</p>
      <p>We observed that the typical confidence level for known motifs is 3000 or greater. Actually, the lowest score for a methylation motif among all the datasets, we have analyzed was 2307 (GTGAC motif for <italic toggle="yes">H.pylori</italic> J99, will be described below). We decided to set 500 as the default threshold to ensure that the tool is sensitive enough even for detection of very low-represented methylation motifs. The authors understand that such a low-threshold value could result in false-positive inference, so in the cases when the confidence level is rather low (lower than 3000) the user is recommended to check the motif correctness using signal shift plots generated by the tool.</p>
      <p>The detailed algorithm explanation is available in Section 2 and <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S3</xref>. A short tool’s guideline is available on <ext-link xlink:href="https://snapper-tutorial.readthedocs.io" ext-link-type="uri">https://snapper-tutorial.readthedocs.io</ext-link>. All the source code is available on GitHub (<ext-link xlink:href="https://github.com/DNKonanov/Snapper" ext-link-type="uri">https://github.com/DNKonanov/Snapper</ext-link>).</p>
      <p>In order to verify the approach developed, firstly we performed the total methylome analysis of <italic toggle="yes">H.pylori</italic> J99 strain, which has been characterized earlier using competing long-read sequencing technology PacBio (<xref rid="btad702-B8" ref-type="bibr">Krebes <italic toggle="yes">et al.</italic> 2014</xref>). Additionally, we compared our method with instruments Tombo (<xref rid="btad702-B17" ref-type="bibr">Stoiber <italic toggle="yes">et al.</italic> 2016</xref>) and Nanodisco (<xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>), which are in our knowledge the most up-to-date tools capable of non-target methylation motifs profiling besides Snapper. To check the capability of Snapper to deal with species different from <italic toggle="yes">H.pylori</italic>, a few external datasets representing different bacterial taxa were analyzed.</p>
    </sec>
    <sec>
      <title>3.2 Total methylome analysis of <italic toggle="yes">H.pylori</italic> J99</title>
      <p>The genome of <italic toggle="yes">H.pylori</italic> J99 (genotype cagA+/vacA s1m1) encodes about 20 R-M systems of Types II and III (<xref rid="btad702-B1" ref-type="bibr">Alm <italic toggle="yes">et al.</italic> 1999</xref>). At least 14 out of them have been shown to be active earlier using the PacBio long-reads sequencing (<xref rid="btad702-B8" ref-type="bibr">Krebes <italic toggle="yes">et al.</italic> 2014</xref>). We performed the full Snapper pipeline (the minimum coverage depth parameter was set 100×, other parameters were set by default) and discovered the same set of motifs except TCNNGA (<xref rid="btad702-T1" ref-type="table">Table 1</xref>, ONT+Snapper column). We should note that in <xref rid="btad702-T1" ref-type="table">Table 1</xref>, we demonstrate just the Snapper’s raw output. You can see more details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S4</xref>. To verify the absence of TCNNGA motif, we manually observed a subset of genome contexts that contained this pattern and had a significant signal shift. We found that all such contexts contained other extracted motifs, such as GAGG, GATC, TCGA, and others. Thus, we concluded that despite the presence of TCNNGA in a number of methylated positions it is not an individual methylation motif in our J99 strain (more information about TCNNGA is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S5</xref>). In case of GTSAC and GWCAY motifs, we faced a certain ambiguity while motifs merging since GTCAC is a submotif for both these sites. Formally, such cases can be resolved only experimentally and it is the reason why we decided not to merge motifs automatically in the Snapper pipeline.</p>
      <table-wrap position="float" id="btad702-T1">
        <label>Table 1.</label>
        <caption>
          <p>Lists of J99 methylation motifs obtained using different methylation motif detection approaches.<xref rid="tblfn1" ref-type="table-fn"><sup>a</sup></xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">PacBio + MotifMaker</th>
              <th rowspan="1" colspan="1">ONT + Snapper (raw output)</th>
              <th rowspan="1" colspan="1">ONT + Tombo</th>
              <th rowspan="1" colspan="1">ONT + Nanodisco</th>
              <th rowspan="1" colspan="1">Total number in genome (±strand)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">GAGG</td>
              <td rowspan="1" colspan="1">GAGG</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GAGG</td>
              <td rowspan="1" colspan="1">2542/2462</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GTSAC</td>
              <td rowspan="1" colspan="1">GTCAC, GTGAC<xref rid="tblfn2" ref-type="table-fn"><sup>b</sup></xref></td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">104/104</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1">5499/5499</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">340/340</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CCGG</td>
              <td rowspan="1" colspan="1">CCGG</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CCGG</td>
              <td rowspan="1" colspan="1">1807/1807</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">426/426</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CCNNGG</td>
              <td rowspan="1" colspan="1">CCNNGG</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CCNNGG</td>
              <td rowspan="1" colspan="1">1193/1193</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GTAC</td>
              <td rowspan="1" colspan="1">GTAC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GTAC</td>
              <td rowspan="1" colspan="1">182/182</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CGWCG</td>
              <td rowspan="1" colspan="1">CGACG, CGTCG<xref rid="tblfn2" ref-type="table-fn"><sup>b</sup></xref></td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CGWCG</td>
              <td rowspan="1" colspan="1">264/264</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1">2756/2756</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">6104/6104</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">7567/7567</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GCCTA</td>
              <td rowspan="1" colspan="1">GCCTA</td>
              <td rowspan="1" colspan="1">GCCTA</td>
              <td rowspan="1" colspan="1">GCCTA</td>
              <td rowspan="1" colspan="1">1532/1532</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GWCAY</td>
              <td rowspan="1" colspan="1">GACAY, GTCAT, GTCAC<xref rid="tblfn2" ref-type="table-fn"><sup>b</sup></xref></td>
              <td rowspan="1" colspan="1">GACAC</td>
              <td rowspan="1" colspan="1">GWCAY</td>
              <td rowspan="1" colspan="1">2641/2464</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GGWCNA</td>
              <td rowspan="1" colspan="1">GGWCNA</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GGWCHA</td>
              <td rowspan="1" colspan="1">838/789</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">1949/1949</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <label>a</label>
            <p>It should be noted here that the column entitled Snapper contains just the raw Snapper output excluding few false-positive motifs that were removed after manual results observation. The raw Snapper output and the verification process of this particular case are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S1</xref>. The PacBio results for <italic toggle="yes">H.pylori</italic> J99 were taken from the work of <xref rid="btad702-B8" ref-type="bibr">Krebes <italic toggle="yes">et al.</italic> (2014)</xref> directly (with few changes since the authors considered not the wild J99 strain but the J99-3 mutant). For Tombo, the best results that we managed to obtain with MEME are shown. For Nanodisco, the manually curated results are shown since the results generated in the automated mode were drastically less accurate.</p>
          </fn>
          <fn id="tblfn2">
            <label>b</label>
            <p>These motifs were extracted as different because the algorithm is designed to be quite cautious in motifs merging to prevent occasional motif collisions.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Additionally, we analyzed <italic toggle="yes">H.pylori</italic> J99 ONT reads using Tombo and Nanodisco tools, which are mainly designed at methylated position profiling but have their own motif enrichment functionality as well. Tombo uses the default MEME motif enrichment algorithm (<xref rid="btad702-B2" ref-type="bibr">Bailey <italic toggle="yes">et al.</italic> 2015</xref>) to extract motifs, so it has demonstrated rather low sensitivity and has inferred only five motifs highly represented in the genome (<xref rid="btad702-T1" ref-type="table">Table 1</xref>, ONT+Tombo column). Nanodisco also performs motif enrichment with MEME but uses an iterative approach that allows to detect more methylation sites but requires manual control on each motif extraction iteration because as we found in the fully automated mode Nanodisco is strongly prone to excessive motif collisions and even the most-represented motifs, such as CATG and GCGC, are not correctly discovered automatically and merged to GCRYG. Manually curated Nanodisco results are quite close to the automated Snapper output and the PacBio results except GTSAC and TCGA motifs (<xref rid="btad702-T1" ref-type="table">Table 1</xref>, ONT+Nanodisco column). Both these motifs are rather rare in the J99 genome, so the MEME algorithm did not identify them being enriched even using an iterative approach since Nanodisco uses the default MEME objective function without negative background (according to the Nanodisco source code). In the reference article, the authors also emphasize that GTAC has not been discovered in <italic toggle="yes">de novo</italic> mode due to the same reason. In Snapper, a set of all possible <italic toggle="yes">k</italic>-mers presented in the considered genome is used as a negative background, which simplifies the identification of rare motifs.</p>
    </sec>
    <sec>
      <title>3.3 External FAST5 datasets analysis</title>
      <p>Actually, the only dataset, which was used during the development of the core Snapper logic was <italic toggle="yes">H.pylori</italic> J99. To ensure that Snapper is not “overfitted” on <italic toggle="yes">H.pylori</italic> data, we downloaded external pair datasets containing WGA and native reads in FAST5-format for four different bacteria with highest number of different methylation motifs available in SRP219538 (<xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>): <italic toggle="yes">T.phaeum</italic> DSM 12270 (8 motifs), <italic toggle="yes">N.gonorrhoeae</italic> FA 1090 (8 motifs), <italic toggle="yes">M.hungatei</italic> JF-1 (6 motifs), and <italic toggle="yes">C.perfringens</italic> ATCC 13124 (6 motifs). <italic toggle="yes">Helicobacter pylori</italic> JP26 was not downloaded since here, we intentionally checked how the method works with non-<italic toggle="yes">H.pylori</italic> data. The genome coverage depth for each sample is listed in <xref rid="btad702-T2" ref-type="table">Table 2</xref>.</p>
      <table-wrap position="float" id="btad702-T2">
        <label>Table 2.</label>
        <caption>
          <p>The genome coverage depth, used in the methylome analysis of the four bacteria from external datasets.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Dataset</th>
              <th rowspan="1" colspan="1">Native DNA coverage depth used</th>
              <th rowspan="1" colspan="1">WGA DNA coverage depth used</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">Thermacetogenium phaeum</italic> DSM 12270</td>
              <td rowspan="1" colspan="1">31×<xref rid="tblfn3" ref-type="table-fn"><sup>a</sup></xref></td>
              <td rowspan="1" colspan="1">43×</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">Neisseria gonorrhoeae</italic> FA 1090</td>
              <td rowspan="1" colspan="1">44×</td>
              <td rowspan="1" colspan="1">41×</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">Methanospirillum hungatei</italic> JF-1</td>
              <td rowspan="1" colspan="1">43×</td>
              <td rowspan="1" colspan="1">41×</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">Clostridium perfringens</italic> ATCC 13124</td>
              <td rowspan="1" colspan="1">42×</td>
              <td rowspan="1" colspan="1">41×</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <label>a</label>
            <p>All available reads were used.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>FAST5-files were resquiggled using Tombo and processed with Snapper with the default parameters. The results were almost identical to the reference REBASE motifs described for these strains except one long motif CACNNNNNRTAAA, which was inferred by Snapper as CACNNNNNATAAA (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). We manually checked the motif correctness and did not find significant signal shift for CACNNNNNGTAAA variant.</p>
      <p>Few inaccuracies in motif identification were caused by motif collisions. Thus, in <italic toggle="yes">M.hungatei</italic> JF-1, which actually has AGCT and GCYYGAT motifs, Snapper identified AGCT, GCCTGAT, GCCCGAT, BGCTCGAT, and BGCTTGAC motif sequences. Here, AGCT had been extracted earlier that led to omitting AGCTCGAT and AGCTTGAC variants, and GCYYGAT motif was extracted formally incomplete. Generally, the algorithm cannot resolve such collisions without additional information and does not try to merge them to prevent results ambiguity. The same problem appeared in <italic toggle="yes">N.gonorrhoeae</italic> FA 1090, where RGCGCY motif was extracted incompletely since its GGCGCC subvariant intersected with GGNNCC motif sequence extracted first, so the Snapper output included only GGNNCC, AGCGCC, AGCGCT, and GGCGCT sequences but not GGCGCC.</p>
      <p>Interestingly, Snapper inferred a few methylation sites that were not mentioned in the reference article (<xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>). Thus, we observed significant signal shift and quite high confidence level for CCAG and TGGCCA motifs in <italic toggle="yes">T.phaeum</italic> DSM 12270. Both these motifs were independently approved using Nanodisco software in manual mode using the “motif refine” command (motif refinement plots are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S6</xref>). The WGGCCW motif not mentioned in the reference article was found in <italic toggle="yes">C.perfringens</italic> ATCC 13124.</p>
      <p>Also, we analyzed the methylome of the four chosen bacteria with Tombo. Here, to detect methylated positions, all available data were used. We tried to use different parameters for both Tombo processing (the <italic toggle="yes">k</italic>-mer size, the number of extracted sequences) and MEME motif enrichment (the objective function, mode) but have managed to identify only two correct motifs for <italic toggle="yes">T.phaeum</italic> DSM 12270, and one correct motif for three other bacteria. The detected motifs are presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>. Probably, the iterative approach similar to implemented in Nanodisco would provide better results but we intentionally tried to follow only the instructions from the Tombo’s documentation.</p>
    </sec>
    <sec>
      <title>3.4 Total methylome analysis of <italic toggle="yes">H.pylori</italic> A45 and mutants</title>
      <p>The <italic toggle="yes">H.pylori</italic> A45 (genotype cagA-/vacA s2m2) clinical isolate was obtained previously from a gastric mucosa biopsy sample from a patient with a gastric carcinoma (<xref rid="btad702-B11" ref-type="bibr">Momynaliev 2009</xref>). In addition, the derivatives of the A45 strain of <italic toggle="yes">H.pylori</italic>, defective in MTase genes M.HpyAI (<italic toggle="yes">hpy</italic> mutant), M.HpyAIII (<italic toggle="yes">hp91/92</italic> mutant), and M.HpyAIV (<italic toggle="yes">hp1352</italic> mutant) were obtained (<xref rid="btad702-B11" ref-type="bibr">Momynaliev 2009</xref>). As well as for <italic toggle="yes">H.pylori</italic> J99, here, we set the minimal genome coverage parameter as 100×. For the native sample the tool collected raw signals with the coverage depth of 101× but the control sample had the mean coverage of 61× due to lower sequencing depth.</p>
      <p>The analysis of <italic toggle="yes">H.pylori</italic> A45 has revealed presence of 15 methylation sites belonging to R-M systems of types II and III: ATTAAT, GTNNAC, GGRGA, CCATC, CATG, CCAG, GCGC, GANTC, GATC, GGCC, GAAC, TGCA, TCGA, TCNGA, and TCNNGA (<xref rid="btad702-T3" ref-type="table">Table 3</xref>, wild-type column). Interestingly, opposite to the <italic toggle="yes">H.pylori</italic> J99 analysis, in this case, all the extracted motifs had quite high confidence levels &gt;3000 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Material S7</xref>). Despite that, we manually observed signal distributions for all suggested sites and their closest genome context to ensure that all motifs had been extracted correctly.</p>
      <table-wrap position="float" id="btad702-T3">
        <label>Table 3.</label>
        <caption>
          <p>Methylation motifs detected in the wild A45 and four mutants.<xref rid="tblfn4" ref-type="table-fn"><sup>a</sup></xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Wild-type</th>
              <th rowspan="1" colspan="1">Total number in genome (+/− strand)</th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">hpy</italic>
              </th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">hp1352</italic>
              </th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">hp91/92</italic>
              </th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">hp944</italic>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">441/441</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GTNNAC</td>
              <td rowspan="1" colspan="1">325/325</td>
              <td rowspan="1" colspan="1">GTNNAC</td>
              <td rowspan="1" colspan="1">GTNNAC</td>
              <td rowspan="1" colspan="1">GTNNAC</td>
              <td rowspan="1" colspan="1">GTNNAC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GGRGA</td>
              <td rowspan="1" colspan="1">1768/1790</td>
              <td rowspan="1" colspan="1">GGRGA</td>
              <td rowspan="1" colspan="1">GGRGA</td>
              <td rowspan="1" colspan="1">GGRGA</td>
              <td rowspan="1" colspan="1">GGRGA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CCATC</td>
              <td rowspan="1" colspan="1">1163/1115</td>
              <td rowspan="1" colspan="1">CCATC</td>
              <td rowspan="1" colspan="1">CCATC</td>
              <td rowspan="1" colspan="1">CCATC</td>
              <td rowspan="1" colspan="1">CCATC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">7246/7246</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CCAG</td>
              <td rowspan="1" colspan="1">2173/2271</td>
              <td rowspan="1" colspan="1">CCAG</td>
              <td rowspan="1" colspan="1">CCAG</td>
              <td rowspan="1" colspan="1">CCAG</td>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">5982/5982</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1">2625/2625</td>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1">GANTC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1">5113/5113</td>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GATC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GGCC</td>
              <td rowspan="1" colspan="1">1534/1534</td>
              <td rowspan="1" colspan="1">GGCC</td>
              <td rowspan="1" colspan="1">GGCC</td>
              <td rowspan="1" colspan="1">GGCC</td>
              <td rowspan="1" colspan="1">GGCC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GAAC</td>
              <td rowspan="1" colspan="1">2760/2700</td>
              <td rowspan="1" colspan="1">GAAC</td>
              <td rowspan="1" colspan="1">GAAC</td>
              <td rowspan="1" colspan="1">GAAC</td>
              <td rowspan="1" colspan="1">GAAC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TGCA</td>
              <td rowspan="1" colspan="1">5770/5770</td>
              <td rowspan="1" colspan="1">TGCA</td>
              <td rowspan="1" colspan="1">TGCA</td>
              <td rowspan="1" colspan="1">TGCA</td>
              <td rowspan="1" colspan="1">TGCA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">290/290</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">TCGA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCNGA</td>
              <td rowspan="1" colspan="1">1224/1224</td>
              <td rowspan="1" colspan="1">TCNGA</td>
              <td rowspan="1" colspan="1">TCNGA</td>
              <td rowspan="1" colspan="1">TCNGA</td>
              <td rowspan="1" colspan="1">TCNGA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1">1926/1926</td>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1">TCNNGA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">3403/3267</td>
              <td rowspan="1" colspan="1">CCAAK</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CCAAK</td>
              <td rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn4">
            <label>a</label>
            <p>Interestingly, in the <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic> mutants an additional CCAAK methylation motif is observed.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>To identify the MTases responsible for methylation of new sites CCAG, GGRGA, and GAAC not described earlier for <italic toggle="yes">H.pylori</italic>, which were presented in <italic toggle="yes">H.pylori</italic> A45 and absent in <italic toggle="yes">H.pylori</italic> J99, all candidate MTase genes were extracted from both genomes and used to construct a phylogenetic tree based on protein sequences similarity. Two proteins that were presented only in <italic toggle="yes">H.pylori</italic> A45 strain and did not have orthologous genes in <italic toggle="yes">H.pylori</italic> J99 were considered as potentially new MTases. Two new <italic toggle="yes">H.pylori</italic> A45 derived mutants (<italic toggle="yes">hp8</italic> and <italic toggle="yes">hp944</italic>) disrupted in corresponding genes hp0008 and hp0944 were obtained during this work. Their native DNA was analyzed using ONT and the sequencing data were processed using Snapper. The <italic toggle="yes">hp8</italic> mutant did not have any signal changes, but in the <italic toggle="yes">hp944</italic> mutant we observed a successful deactivation of CCAG-specific MTase (<xref rid="btad702-T3" ref-type="table">Table 3</xref>, <italic toggle="yes">hp944</italic> column). As we found later, the negative result for <italic toggle="yes">hp8</italic> was caused by a nonsense mutation in the MTase gene in the wild A45.</p>
      <p>Here, to estimate the method specificity, in addition to the wild-type, we analyzed three mutants of <italic toggle="yes">H.pylori</italic> A45 disrupted in three different genes encoding MTases with known specificity (<italic toggle="yes">hpy</italic>, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp91/92</italic> mutants disrupted in the genes of MTases specific to CATG, GANTC, and GATC motifs, respectively). Here, we used as a control not the WGA sample but the native A45 to check out how the algorithm works with a small number of motifs that differ by their signal level. We expected the algorithm to extract only one motif for each mutant, but two mutants had an additional motif that seemed to be modified. Firstly, in all three mutants Snapper successfully detected the absence of methylation of the corresponding motifs (<xref rid="btad702-T3" ref-type="table">Table 3</xref>, <italic toggle="yes">hpy</italic>, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp91/92</italic> columns, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). Secondly, the CCAAK site was detected as methylated in <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic> mutants while the native sample, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp944</italic> had CCAAK signal distributions identical to the WGA sample (<xref rid="btad702-F2" ref-type="fig">Fig. 2A</xref>).</p>
      <fig position="float" id="btad702-F2">
        <label>Figure 2.</label>
        <caption>
          <p>CCAAK-specific MTase inference. (A) Normalized signal distributions for the CCAAK methylation site. <italic toggle="yes">hp91/92</italic> and <italic toggle="yes">hpy</italic> mutants have a visible signal shift in comparison with the WGA sample while the wild A45 and the <italic toggle="yes">hp1352</italic> mutant have signal distributions identical to the WGA sample. (B) Wild A45 and the <italic toggle="yes">hp1352</italic> mutant have CCAAK-specific MTase gene broken because of a frame-shift insertion in a homopolymeric region in the gene. The reverse frame-shift mutation in the MTase gene restores the Type III R-M system activity in <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic></p>
        </caption>
        <graphic xlink:href="btad702f2" position="float"/>
      </fig>
      <p>To identify the MTase responsible for modification of CCAAK, we used non-target proteomics data that were obtained earlier for the wild A45 and <italic toggle="yes">hpy</italic>, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp91/92</italic> mutants (the procedure is described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S14</xref>). Five proteins that were significantly over-represented (LFC≥5) in <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic> mutants in comparison to the wild-type and <italic toggle="yes">hp1352</italic> were found and manually annotated using BLASTP (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S11 and S12</xref>). Proteins encoded by hp0008 and hp0009 genes were annotated as two fragments of one MTase gene, and gene hp0010 was annotated as a Type III R-M system endonuclease, so, these three genes encode a full Type III R-M system but with a broken MTase gene. The appearance of the CCAAK methylation site in <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic> was caused by a reverse frame-shift mutation in a homopolymeric region in hp0008 gene, which was confirmed by short Illumina reads (<xref rid="btad702-F2" ref-type="fig">Fig. 2B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>).</p>
      <p>Additionally, we checked the coverage depth required for extraction of two non-overlapped motifs (the <italic toggle="yes">hpy</italic> mutant, CATG and CCAAK motifs). The tool extracted these motifs correctly with mean coverage depth of 14× (∼20 000 reads per sample).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Oxford Nanopore sequencing has a great potential for the analysis of epigenetic modifications of the four canonical bases. Unfortunately, the current software designed for methylation site detection possesses certain drawbacks. Thus, both Tombo and Nanodisco provide high-quality profiling of methylated positions in a genome but the main problem here is to accurately generate a set of potential motifs that could explain all methylated bases. Technically, it is a classical motif enrichment task, but classical approaches have proven to be insufficiently sensitive for analyzing highly methylated genomes, such as the <italic toggle="yes">H.pylori</italic> genome. Thus, we found that the most widely used tool suit MEME is capable of detecting only highly represented motifs. An iterative approach implemented in Nanodisco is more sensitive but requires a lot of manual work while extracting motifs, which limits its applicability when more than few genomes are studied.</p>
    <p>We have developed a new greedy algorithm that is aimed at high-sensitive motif enrichment. This algorithm has been implemented as the command-line tool Snapper. Here, we have shown that, firstly, as a fully automated pipeline, Snapper outperforms both Tombo and Nanodisco coupled with the MEME tool and, secondly, Snapper is capable of detecting methylation site sequences with sensitivity equivalent to the PacBio technology and is slightly more sensitive than Nanodisco in the manual mode. In contrast to Nanodisco, Snapper provides a fully automated motif extraction algorithm and requires manual results verification only during adjustment of motifs with a low confidence level.</p>
    <p>We should note again that Snapper must not be considered as an alternative to MEME since MEME has been developed as a universal approach and can deal with any type of data, while Snapper uses special search heuristics aimed at finding methylation motifs specifically. These heuristics narrow the search space, and as a result, the algorithm can provide higher enrichment sensitivity.</p>
    <p>Another feature we should note is an intended algorithm cautiousness in motifs merging to avoid occasional motif collisions. Thus, the <italic toggle="yes">H.pylori J99</italic> analysis has shown the presence of motifs GTCAT, GTCAC, GACAY, and GTGAC as methylated. Actually, these submotifs are explained by GWCAY and GTSAC methylation sites but GWCAY+GTGAC variant is formally possible as well. Such cases can be resolved only experimentally so we decided not to merge controversial motifs in the Snapper motif extraction algorithm. A related problem with motif sequences resolving appeared in the <italic toggle="yes">M.hungatei</italic> JF-1 analysis results, which actually has AGCT and GCYYGAT methylation sites but Snapper’s output included AGCT, GCCCGAT, GCCTGAT, BGCTCGAT, and BGCTTGAC (“B” means “not A”). Indeed, the last two motif subvariants were inferred after AGCT had been inferred. Therefore, the algorithm had already explained AGCTCGAT and AGCTTGAC subvariants by the presence of AGCT. Thus, although the algorithm is formally fully automated, some cases should be considered manually.</p>
    <p>Since Snapper aims not at the methylated positions calling but methylation motif sequences, it is relatively less demanding on the input data compared with Nanodisco or Tombo. The genome coverage required for the analysis depends on the object of interest. Thus, while analyzing organisms that have very few different non-overlapped methylation sites, the method can work well even with a mean genome coverage of 15–20×. On the other hand, for organisms with higher number of different methylatinon sites Snapper requires higher sequencing coverage to more accurately resolve similar motif sequences. The authors suggest that, in most cases, coverage of 80–100× is absolutely enough for high-accurate methylation motifs detection. On the other hand, since Snapper is not aimed to detect modified positions and predict the modification type, the authors recommend using Nanodisco for these purposes after the target motif sequences have been identified.</p>
    <p>Using Snapper, we fully characterized the methylome of a new <italic toggle="yes">H.pylori</italic> strain A45. In this strain, we found three methylation sites that have not been described earlier for <italic toggle="yes">H.pylori</italic> (GGRGA, GAAC, and CCAG) and managed to experimentally confirm the MTase specific to CCAG. In addition, during the experiment, we observed a frame-shift-based phase variation in the gene encoding a new MTase specific to CCAAK methylation site. Thus, we did not observe this site being methylated in the wild A45 culture but it appeared after the disruption in CATG-specific MTase or GATC-specific MTase. In both cases, it was caused by the same reverse frame-shift mutation in a homopolymeric region in the gene encoding corresponding MTase. Such a behavior is quite typical for <italic toggle="yes">H.pylori</italic> and is often used to regulate activity of particular MTase genes (<xref rid="btad702-B3" ref-type="bibr">Beaulaurier <italic toggle="yes">et al.</italic> 2015</xref>).</p>
    <p>As an additional verification, we analyzed four external datasets representing different bacterial taxa. In all cases, Snapper discovered all methylation motif sequences that had been shown for these bacteria according to the REBASE database and few additional motifs, which has illustrated the versatility of the method. However, we observed few problems with motif sequences resolving (as the AGCT and GCYYGAT collision mentioned above), especially in highly methylated organisms, so we cannot declare that Snapper’s results can always be used as is and should be additionally curated by a user.</p>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>We have developed Snapper—a tool for high-sensitive methylation motifs identification. Snapper has been shown to be more sensitive than MEME coupled with the Tombo software. Snapper demonstrated slightly higher motif detection accuracy compared to Nanodisco and did not require extensive manual work during the motif extraction procedure, unlike Nanodisco. Snapper was tested in detail on data obtained in this study as well as on a few external datasets. Using Snapper, we characterized the methylation motifs in a new <italic toggle="yes">H.pylori</italic> A45 strain and discovered four motif sequences that have not been described for <italic toggle="yes">H.pylori</italic> earlier. We managed to experimentally confirm a gene encoding a new CCAG-specific MTase and inferred a gene encoding CCAAK-specific MTase.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad702_Supplementary_Data</label>
      <media xlink:href="btad702_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the Center for Precision Genome Editing and Genetic Technologies for Biomedicine, Federal Research and Clinical Center of Physical–Chemical Medicine of the Federal Medical Biological Agency for providing computational resources for this project. <italic toggle="yes">Helicobacter pylori</italic> J99 strain (No. 700824, cagA+/vacA s1m1 genotype) was kindly provided by Prof. M. Achtman (Max Planck Institute for Infection Biology, Germany). <italic toggle="yes">Helicobacter pylori</italic> A45 and <italic toggle="yes">hpy</italic>, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp91/92</italic> mutants were kindly provided by Dr K.T. Momynaliev.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>D.N.K. and V.V.B. led the project, wrote the manuscript text, and prepared all the figures and supplementary data; D.N.K. designed and implemented the main algorithms and performed <italic toggle="yes">Helicobacter pylori</italic> A45 and J99 methylome analysis; A.M.B. wrote the manuscript text, realized cell culture procedures, and prepared <italic toggle="yes">Helicobacter pylori hp8</italic> and <italic toggle="yes">hp944</italic> mutant strains; A.G.M. performed Nanodisco analysis; A.G.M. and D.V.K. helped with multiprocessing implementation; O.E.G. ran Tombo and helped with methylation analysis; I.O.B. performed proteomics experiments; D.E.F. and A.I.M. processed the proteomics data; A.I.M. and V.V.B. carried out genomic data analysis; V.V.B. and D.I.B. performed genome sequencing; V.N.L., V.M.G., and E.N.I. administered the project; and E.N.I. edited the manuscript.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work did not receive any financial support from commercial or non-commercial organizations.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All the source code is available on Github (<ext-link xlink:href="https://github.com/DNKonanov/Snapper" ext-link-type="uri">https://github.com/DNKonanov/Snapper</ext-link>). Fastq files are available in SRA (NCBI Bioproject accession number PRJNA175046). The mass spectrometry proteomics data have been deposited to the ProteomeXchange Consortium via the PRIDE (<xref rid="btad702-B13" ref-type="bibr">Perez-Riverol <italic toggle="yes">et al.</italic> 2019</xref>) partner repository with the dataset identifier PXD038899 (access for the reviewers: login reviewer <email>pxd038899@ebi.ac.uk</email>, password—xOuk64qK). All genome assemblies obtained during this study are available in GenBank (<italic toggle="yes">Helicobacter pylori</italic> A45 wild-type: GCA 000333835.2, <italic toggle="yes">hpy</italic>: GCA 013122115.1, <italic toggle="yes">hp1352</italic>: GCA 013122055.1, <italic toggle="yes">hp91/92</italic>: GCA 013122035.1). External fast5-files used in this study were downloaded from SRP219538. Additionally, we provide a small fast5 example dataset in order to demonstrate the tool capabilities. The demo-dataset includes 10 + 10 preprocessed multi-fast5 files containing 40 000 long reads for the hpy mutant and 40 000 reads for the wild A45 as a control (<ext-link xlink:href="http://download.ripcm.com/snapper_test" ext-link-type="uri">http://download.ripcm.com/snapper_test</ext-link>). Both Snapper tool and the demo dataset are available in Zenodo (10.5281/zenodo.10117651).</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad702-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alm</surname><given-names>RA</given-names></string-name>, <string-name><surname>Ling</surname><given-names>LS</given-names></string-name>, <string-name><surname>Moir</surname><given-names>DT</given-names></string-name></person-group><etal>et al</etal><article-title>Genomic-sequence comparison of two unrelated isolates of the human gastric pathogen <italic toggle="yes">Helicobacter pylori</italic></article-title>. <source>Nature</source><year>1999</year>;<volume>397</volume>:<fpage>176</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">9923682</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bailey</surname><given-names>TL</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>J</given-names></string-name>, <string-name><surname>Grant</surname><given-names>CE</given-names></string-name></person-group><etal>et al</etal><article-title>The meme suite</article-title>. <source>Nucleic Acids Res</source><year>2015</year>;<volume>43</volume>:<fpage>W39</fpage>–<lpage>49</lpage>.<pub-id pub-id-type="pmid">25953851</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beaulaurier</surname><given-names>J, Zhang X, Zhu S</given-names></string-name></person-group><etal>et al</etal><article-title>Single molecule-level detection and long read-based phasing of epigenetic variations in bacterial methylomes</article-title>. <source>Nat Commun</source><year>2015</year>;<volume>6</volume>:<fpage>7438</fpage>.<pub-id pub-id-type="pmid">26074426</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Belova</surname><given-names>AM</given-names></string-name>, <string-name><surname>Basmanov</surname><given-names>DV</given-names></string-name>, <string-name><surname>Prusakov</surname><given-names>KA</given-names></string-name></person-group><etal>et al</etal><article-title>A microfluidic platform for the development of a biosensor based on genetically modified <italic toggle="yes">Helicobacter pylori</italic> single cells</article-title>. <source>Biophysics</source><year>2018</year>;<volume>63</volume>:<fpage>735</fpage>–<lpage>42</lpage>.</mixed-citation>
    </ref>
    <ref id="btad702-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gorrell</surname><given-names>R</given-names></string-name>, <string-name><surname>Kwok</surname><given-names>T.</given-names></string-name></person-group><article-title>The <italic toggle="yes">Helicobacter pylori</italic> methylome: roles in gene regulation and virulence</article-title>. <source>Curr Top Microbiol Immunol</source><year>2017</year>;<volume>400</volume>:<fpage>105</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">28124151</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hofreuter</surname><given-names>D</given-names></string-name>, <string-name><surname>Odenbreit</surname><given-names>S</given-names></string-name>, <string-name><surname>Haas</surname><given-names>R.</given-names></string-name></person-group><article-title>Natural transformation competence in <italic toggle="yes">Helicobacter pylori</italic> is mediated by the basic components of a type IV secretion system</article-title>. <source>Mol Microbiol</source><year>2001</year>;<volume>41</volume>:<fpage>379</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">11489125</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jain</surname><given-names>M</given-names></string-name>, <string-name><surname>Olsen</surname><given-names>HE</given-names></string-name>, <string-name><surname>Paten</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>The Oxford Nanopore MinION: delivery of nanopore sequencing to the genomics community</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>239</fpage>.<pub-id pub-id-type="pmid">27887629</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krebes</surname><given-names>J</given-names></string-name>, <string-name><surname>Morgan</surname><given-names>RD</given-names></string-name>, <string-name><surname>Bunk</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>The complex methylome of the human gastric pathogen <italic toggle="yes">Helicobacter pylori</italic></article-title>. <source>Nucleic Acids Res</source><year>2014</year>;<volume>42</volume>:<fpage>2415</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">24302578</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Georgieva</surname><given-names>DC</given-names></string-name>, <string-name><surname>Egli</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>NanoMod: a computational tool to detect DNA modifications using Nanopore long-read sequencing data</article-title>. <source>BMC Genomics</source><year>2019</year>;<volume>20</volume>:<fpage>78</fpage>.<pub-id pub-id-type="pmid">30712508</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Rosikiewicz</surname><given-names>W</given-names></string-name>, <string-name><surname>Pan</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>DNA methylation-calling tools for Oxford Nanopore sequencing: a survey and human epigenome-wide evaluation</article-title>. <source>Genome Biol</source><year>2021</year>;<volume>22</volume>:<fpage>295</fpage>.<pub-id pub-id-type="pmid">34663425</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Momynaliev</surname><given-names>KT.</given-names></string-name></person-group> Genomno-proteomnaya Kharakteristika Variabelnosti <italic toggle="yes">Helicobacter Pylori</italic> [Genomic and proteomic characteristics of the <italic toggle="yes">Helicobacter pylori</italic> variability]. Ph.D. Thesis, Moscow, Russia, <year>2009</year>.</mixed-citation>
    </ref>
    <ref id="btad702-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ni</surname><given-names>P</given-names></string-name>, <string-name><surname>Huang</surname><given-names>N</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>DeepSignal: detecting DNA methylation state from Nanopore sequencing reads using deep-learning</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>4586</fpage>–<lpage>95</lpage>.<pub-id pub-id-type="pmid">30994904</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Perez-Riverol</surname><given-names>Y</given-names></string-name>, <string-name><surname>Csordas</surname><given-names>A</given-names></string-name>, <string-name><surname>Bai</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>The PRIDE database and related tools and resources in 2019: improving support for quantification data</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>D442</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">30395289</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roberts</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Vincze</surname><given-names>T</given-names></string-name>, <string-name><surname>Posfai</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>REBASE—a database for DNA restriction and modification: enzymes, genes and genomes</article-title>. <source>Nucleic Acids Res</source><year>2015</year>;<volume>43</volume>:<fpage>D298</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">25378308</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B15">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Sambrook</surname><given-names>J, Fritsch EF, Maniatis T.</given-names></string-name></person-group><source>Molecular Cloning: A Laboratory Manual</source>. <edition>2nd edn</edition>. <publisher-loc>New York</publisher-loc>: <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>, <year>1989</year>.</mixed-citation>
    </ref>
    <ref id="btad702-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Seemann</surname><given-names>T.</given-names></string-name></person-group><article-title>Prokka: rapid prokaryotic genome annotation</article-title>. <source>Bioinformatics</source><year>2014</year>;<volume>30</volume>:<fpage>2068</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24642063</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Stoiber</surname><given-names>M, Quick J, Egan R</given-names></string-name></person-group><etal>et al</etal> De novo identification of DNA modifications enabled by genome-guided nanopore signal processing. bioRxiv, 094672, <year>2016</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad702-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tourancheau</surname><given-names>A</given-names></string-name>, <string-name><surname>Mead</surname><given-names>EA</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>X-S</given-names></string-name></person-group><etal>et al</etal><article-title>Discovering multiple types of DNA methylation from bacteria and microbiome using nanopore sequencing</article-title>. <source>Nat Methods</source><year>2021</year>;<volume>18</volume>:<fpage>491</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">33820988</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wick</surname><given-names>RR</given-names></string-name>, <string-name><surname>Judd</surname><given-names>LM</given-names></string-name>, <string-name><surname>Gorrie</surname><given-names>CL</given-names></string-name></person-group><etal>et al</etal><article-title>Completing bacterial genome assemblies with multiplex MinION sequencing</article-title>. <source>Microb Genom</source><year>2017</year>;<volume>3</volume>:<fpage>e000132</fpage>.<pub-id pub-id-type="pmid">29177090</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>H</given-names></string-name>, <string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Jain</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Real-time mapping of nanopore raw signals</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>i477</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">34252938</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10689673</article-id>
    <article-id pub-id-type="pmid">37982752</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad702</article-id>
    <article-id pub-id-type="publisher-id">btad702</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Snapper: high-sensitive detection of methylation motifs based on Oxford Nanopore reads</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1217-9234</contrib-id>
        <name>
          <surname>Konanov</surname>
          <given-names>Dmitry N</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
        <xref rid="btad702-cor1" ref-type="corresp"/>
        <!--konanovdmitriy@gmail.com-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Babenko</surname>
          <given-names>Vladislav V</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Belova</surname>
          <given-names>Aleksandra M</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Madan</surname>
          <given-names>Arina G</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
        <aff><institution>Department of Molecular and Translational Medicine, Moscow Institute of Physics and Technology, State University</institution>, Dolgoprudny 141700, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boldyreva</surname>
          <given-names>Daria I</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Glushenko</surname>
          <given-names>Oksana E</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Butenko</surname>
          <given-names>Ivan O</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fedorov</surname>
          <given-names>Dmitry E</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Manolov</surname>
          <given-names>Alexander I</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Krivonos</surname>
          <given-names>Danil V</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
        <aff><institution>Department of Molecular and Translational Medicine, Moscow Institute of Physics and Technology, State University</institution>, Dolgoprudny 141700, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lazarev</surname>
          <given-names>Vassilii N</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Govorun</surname>
          <given-names>Vadim M</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ilina</surname>
          <given-names>Elena N</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad702-cor1">Corresponding author. Laboratory of mathematical biology and bioinformatics, Research Institute for Systems Biology and Medicine, Nauchnyi Proezd, 18, Moscow 117246, Russia. E-mail: <email>konanovdmitriy@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-20">
      <day>20</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>11</issue>
    <elocation-id>btad702</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>14</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>30</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad702.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The Oxford Nanopore technology has a great potential for the analysis of methylated motifs in genomes, including whole-genome methylome profiling. However, we found that there are no methylation motifs detection algorithms, which would be sensitive enough and return deterministic results. Thus, the MEME suit does not extract all <italic toggle="yes">Helicobacter pylori</italic> methylation sites <italic toggle="yes">de novo</italic> even using the iterative approach implemented in the most up-to-date methylation analysis tool Nanodisco.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present Snapper, a new highly sensitive approach, to extract methylation motif sequences based on a greedy motif selection algorithm. Snapper does not require manual control during the enrichment process and has enrichment sensitivity higher than MEME coupled with Tombo or Nanodisco instruments that was demonstrated on <italic toggle="yes">H.pylori</italic> strain J99 studied earlier by the PacBio technology and on four external datasets representing different bacterial species. We used Snapper to characterize the total methylome of a new <italic toggle="yes">H.pylori</italic> strain A45. At least four methylation sites that have not been described for <italic toggle="yes">H.pylori</italic> earlier were revealed. We experimentally confirmed the presence of a new CCAG-specific methyltransferase and inferred a gene encoding a new CCAAK-specific methyltransferase.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Snapper is implemented using Python and is freely available as a pip package named “snapper-ont.” Also, Snapper and the demo dataset are available in Zenodo (10.5281/zenodo.10117651).</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Restriction-modification (R-M) systems are one of the essential mechanisms used by bacteria for protection from bacteriophage invasion. Generally, bacterial R-M systems are divided into four global groups (I, II, III, and IV) (<xref rid="btad702-B14" ref-type="bibr">Roberts <italic toggle="yes">et al.</italic> 2015</xref>) depending on the R-M complex structure. Despite their different architectures, all R-M systems share a common feature: the presence of site-specific DNA-binding domains that recognize specific short DNA sequence that should be methylated to prevent the restrictase activity.</p>
    <p>The Oxford Nanopore technology (ONT) is a long-read sequencing technology based on measuring electric current across the nanopore (<xref rid="btad702-B7" ref-type="bibr">Jain <italic toggle="yes">et al.</italic> 2016</xref>). The ONT makes it possible not only to detect the four canonical nucleotide bases, but also to additionally catch any of their modified forms that can significantly change the sequencing signal (<xref rid="btad702-B10" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2021</xref>). A number of tools aimed at accurate detection of methylated positions have already been developed (<xref rid="btad702-B17" ref-type="bibr">Stoiber <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btad702-B9" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad702-B12" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>). However, these tools have certain limitations in inferring methylation site sequences, especially when dealing with low-represented DNA motifs. We faced it when we were analyzing our <italic toggle="yes">Helicobacter pylori</italic> data. In general, these tools provide accurate detection of methylated positions in a considered genome (<xref rid="btad702-B17" ref-type="bibr">Stoiber <italic toggle="yes">et al.</italic> 2016</xref>) or prediction of methylation type (6mA, 5mC, and 4mC) in a chosen site (<xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>) but we found that the process of precise identification of methylation motif sequences is either not sensitive enough or requires a lot of manual control.</p>
    <p>Here, we present a novel tool called Snapper that performs high-sensitive identification of methylation motifs based on ONT sequencing data. The tool is mainly verified on <italic toggle="yes">H.pylori</italic> J99 sequencing data and compared with Tombo and Nanodisco, which are the most up-to-date instruments with similar functionality.</p>
    <p>We chose <italic toggle="yes">H.pylori</italic> species as the object of interest in this study firstly because it is a unique organism that is shown to bring up to 30 different R-M systems in its genome (<xref rid="btad702-B5" ref-type="bibr">Gorrell and Kwok 2017</xref>) and has methyltransferases (MTases) capable of methylation adenine as well as cytosine (<xref rid="btad702-B5" ref-type="bibr">Gorrell and Kwok 2017</xref>). Secondly, it is a naturally competent organism (<xref rid="btad702-B6" ref-type="bibr">Hofreuter <italic toggle="yes">et al.</italic> 2001</xref>) that can be quite easily modified to confirm new inferred MTases. Third, the <italic toggle="yes">H.pylori</italic> J99 strain has been characterized earlier using the PacBio sequencing technology (<xref rid="btad702-B8" ref-type="bibr">Krebes <italic toggle="yes">et al.</italic> 2014</xref>) that allows us to directly compare our results with competing technology. To additionally validate the method, a few external datasets were analyzed to ensure that Snapper is capable of detecting methylation sites in different bacterial taxa.</p>
    <p>To demonstrate the applicability of the developed tool, here, we use Snapper to characterize the methylome of a new <italic toggle="yes">H.pylori</italic> A45 strain. The method specificity is additionally demonstrated on A45-derived mutants disrupted in genes of MTases with known specificity.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Bacterial strains and culture manipulation</title>
      <p>The <italic toggle="yes">H.pylori</italic> A45 clinical isolate was obtained from a gastric mucosa biopsy sample of a patient with a gastric carcinoma (<xref rid="btad702-B11" ref-type="bibr">Momynaliev 2009</xref>). This isolate was used to obtain <italic toggle="yes">hpy</italic>, <italic toggle="yes">hp91/92</italic>, <italic toggle="yes">hp1352</italic>, <italic toggle="yes">hp8</italic>, and <italic toggle="yes">hp944</italic> derivatives defective in MTase genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). A targeted inactivation procedure was performed using the gene knockout method. The detailed description of <italic toggle="yes">H.pylori</italic> mutant strains construction is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S2</xref>.</p>
      <p><italic toggle="yes">Escherichia coli</italic> strain Top10 required for plasmid vectors assembly and production was cultivated at 37°C on solid Luria–Bertani medium or in liquid Luria–Bertani medium with aeration (150 rpm). The transformation procedure was carried out using the “heat shock” transformation protocol (<ext-link xlink:href="https://international.neb.com/protocols/2012/05/21/transformation-protocol" ext-link-type="uri">https://international.neb.com/protocols/2012/05/21/transformation-protocol</ext-link>). Chloramphenicol (8 µg/ml, Panreac, Spain) and kanamycin (15 µg/ml, Sigma, USA) were added to the medium for selection.</p>
      <p><italic toggle="yes">Helicobacter pylori</italic> strains were cultivated for 20–48 h at 37°C under microaerophilic conditions on Columbian agar solid medium (Becton Dickinson, USA) supplemented with 10% donor horse serum (PAA Labs, Austria). Chloramphenicol (8 µg/ml) and kanamycin (15 µg/ml) were added for the selection and passage of resistant mutant strains. Amplicon cell transformation was carried out as described in <xref rid="btad702-B4" ref-type="bibr">Belova <italic toggle="yes">et al.</italic> (2018)</xref>. Cells were cultivated for 24 h at 37°C under microaerophilic conditions on solid medium. The cell suspension (109 CFU) was moved on a new plate and cultivated for 4–5 h for undergrowth. Thereafter, sterile water suspension, containing 500 ng DNA fragments was applied dropwise onto the solid medium surface containing undergrowth cells. The dishes were then left agar side up in the CO<sub>2</sub> incubator for 17–20 h. The next day, cells were subsequently transferred to a selective medium containing corresponding antibiotics. Clones found on plates after 4–5 days were verified to be <italic toggle="yes">H.pylori</italic> and to contain the specific insertions by PCR using primer sets listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>. For any consequent assay all <italic toggle="yes">H.pylori</italic> strains were harvested from the plates after 2 days growth. Cells were washed with HBSS buffer, pH 7.5 (Hank’s Balanced Salt Solution, Thermo Fisher, USA) and precipitated by centrifugation at 3000 × <italic toggle="yes">g</italic> for 10 min for genomic DNA preparation as described earlier.</p>
    </sec>
    <sec>
      <title>2.2 DNA manipulation</title>
      <p>Vectors and mutant strains used in this study are listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. All standard methods of DNA manipulation, such as plasmid isolation by alkaline lysis, restriction endonuclease digestion, and ligation, were performed according to the protocols of <xref rid="btad702-B15" ref-type="bibr">Sambrook <italic toggle="yes">et al.</italic> (1989)</xref>. <italic toggle="yes">Helicobacter pylori</italic> genomic DNA was prepared using the diaGene kit for DNA extraction from cell cultures (diaGene, Russia). Single DNA fragments or PCR amplification products for cloning or sequencing purposes were purified from agarose gels using Cleanup Standard Kit (Evrogen, Russia). DNA restriction enzymes were obtained from Fermentas (Thermo Fisher Scientific, USA) and were used according to the directions of the manufacturers.</p>
    </sec>
    <sec>
      <title>2.3 Sequencing</title>
      <sec>
        <title>2.3.1 Whole-genome amplification</title>
        <p>The Qiagen REPLI-g Single Cell Kit was used to perform whole-genome amplification to exclude epigenetically modified bases. The method produced micrograms of DNA from 10 ng of input genomic DNA, following the manufacturer’s guidelines and 8 h of amplification time at 30°C followed by deactivation at 65°C for 3 min.</p>
      </sec>
      <sec>
        <title>2.3.2 Oxford Nanopore</title>
        <p>The DNA was isolated by using the Wizard DNA extraction kit (Promega Corporation, USA) and size selected with optimized solid phase reversible immobilization (SPRI) beads. The DNA concentration and quality were determined on a Qubit 4 Fluorometer and Nanodrop ND-1000 (Thermo Fisher Scientific). The long reads were generated with MinION sequencing (Oxford Nanopore Technologies, UK). The sequencing libraries were prepared using the ligation sequencing kit SQK-LSK109, native barcoding expansion kit EXP-NBD104 and run in a FLOMIN106 flow cell. Reads were basecalled using Guppy v3.6.1. using default parameters.</p>
      </sec>
      <sec>
        <title>2.3.3 Illumina</title>
        <p>A NEBNext Ultra DNA library prep kit (New England Biolabs, USA) was used to prepare fragment libraries for genome sequencing. Sequencing was performed on the HiSeq 2500 System (Illumina, USA) HiSeq Rapid SBS Kit V2 using a 2 × 250 bp run configuration.</p>
        <p><italic toggle="yes">De novo</italic> assembly was performed by hybrid assembler Unicycler (v0.4.8) (<xref rid="btad702-B19" ref-type="bibr">Wick <italic toggle="yes">et al.</italic> 2017</xref>) using default parameters. Identification of the protein-coding sequences and primary annotation were performed using PROKKA v1.14.6 (<xref rid="btad702-B16" ref-type="bibr">Seemann 2014</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Methylation analysis</title>
      <sec>
        <title>2.4.1 Tombo</title>
        <p>Raw signals from the fast5 files obtained for both native and WGS samples were mapped to corresponding reference genome positions using “tombo resquiggle” command (<xref rid="btad702-B17" ref-type="bibr">Stoiber <italic toggle="yes">et al.</italic> 2016</xref>). Next, modified positions were extracted using the “model sample compare” tombo mode. The resulting positions were used to construct all sequences that are likely to bring a methylation base, with the sequence length chosen to be 12, 18, and 22. These nucleotide contexts were processed by MEME (<xref rid="btad702-B2" ref-type="bibr">Bailey <italic toggle="yes">et al.</italic> 2015</xref>) with algorithm parameters recommended in the Tombo documentation and with customized parameters (-mod, -objfun, and -ng) in order to find the most sensitive approach. The motifs that were significantly over-represented in the selected contexts were considered as methylation sites.</p>
        <p>Tombo was used only to analyze <italic toggle="yes">H.pylori</italic> J99 and four external datasets and as a result was excluded from the analysis of <italic toggle="yes">H.pylori</italic> A45 since its sensitivity turned out to be not enough for the analysis of highly methylated genomes.</p>
      </sec>
      <sec>
        <title>2.4.2 Nanodisco</title>
        <p>For each strain, both sample and control fast5 files and the assembly file were processed according to the standard Nanodisco (v.1.0.3) pipeline described in the documentation (<ext-link xlink:href="https://nanodisco.readthedocs.io/en/latest/overview.html" ext-link-type="uri">https://nanodisco.readthedocs.io/en/latest/overview.html</ext-link>). While running motif extraction stage (“nanodisco motif”), we manually controlled each motif inference iteration observing the pdf files generated by the tool since the automated mode turned out to be prone to occasional motif collisions. For external datasets, we used the motifs discovered by the authors <italic toggle="yes">de novo</italic> (listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p>
      </sec>
      <sec>
        <title>2.4.3 Snapper</title>
        <p>Single-fast5 files obtained with “tombo resquiggle” were transformed to the multifast5 format to provide faster access to the sequencing raw signal data. These multifast5 files were processed using the python h5py library in order to collect signals for all <italic toggle="yes">k</italic>-mers presented in the considered genome for each strand independently. <italic toggle="yes">k</italic> was chosen to be 11 or higher (15 by default) in order to guarantee coverage of all 6-mers that cover an individual base (<xref rid="btad702-F1" ref-type="fig">Fig. 1A</xref>). Thus, at first the algorithm generates a hash-table, where all presented <italic toggle="yes">k</italic>-mers are used as keys and corresponding normalized signal levels as values.</p>
        <fig position="float" id="btad702-F1">
          <label>Figure 1.</label>
          <caption>
            <p>The principal scheme of the Snapper pipeline. In the first stage, for each <italic toggle="yes">k</italic>-mer in the reference genome (A and B), the algorithm collects normalized signal levels for this <italic toggle="yes">k</italic>-mer from multi-fast5 files for both native and WGA samples (here, <italic toggle="yes">k</italic> is chosen to be 11). Thereafter, for each <italic toggle="yes">k</italic>-mer presented in the genome, the algorithm directly compares the collected signal distributions (C) using the Kolmogorov–Smirnov test in order to select <italic toggle="yes">k</italic>-mers that most likely contain a modified base. The result of the first stage is an exhaustive set of all potentially modified <italic toggle="yes">k</italic>-mers (D). Next, the greedy motif enrichment algorithm implemented in Snapper iteratively extracts potential methylation motifs and calculates corresponding motif confidence levels (E). By default, motifs with confidence level &gt;5000 are considered as significant but the authors recommend manually verifying extracted motifs with confidence levels lower than 3000 especially while the observed signal shift is rather weak. The main recommendations on how to interpret the Snapper results are available in the user guide (<ext-link xlink:href="https://snapper-tutorial.readthedocs.io/en/latest/usercases.html#main-points" ext-link-type="uri">https://snapper-tutorial.readthedocs.io/en/latest/usercases.html#main-points</ext-link>)</p>
          </caption>
          <graphic xlink:href="btad702f1" position="float"/>
        </fig>
        <p>Next, for each <italic toggle="yes">k</italic>-mer in the hash-table, the Kolmogorov–Smirnov test is performed to compare signal level distributions between native and WGA samples (or, more generally, between any two samples passed as the input). Before the testing, the algorithm performs an artificial balancing of the sample sizes by random sampling (without replacement) of <italic toggle="yes">N</italic> values from each considered signal distribution to ensure the uniformity of the <italic toggle="yes">k</italic>-mers coverage (<italic toggle="yes">N</italic> was chosen to be 200). This balancing procedure is applied to make possible direct comparison of statistics values between <italic toggle="yes">k</italic>-mers, which are differently presented in the reference genome and to use the same statistics thresholds to infer modified positions along the genome. As a result, the algorithm returns the list of <italic toggle="yes">k</italic>-mers that are most likely to contain a modified base. In the further text, this list will be named <italic toggle="yes">seq_set</italic>. Simultaneously, the algorithm collects signal levels for long <italic toggle="yes">k</italic>-mers (with length of 29 by default). These long <italic toggle="yes">k</italic>-mers are used by the algorithm for additional motif refinement and enrichment of long motifs (mostly methylated by Type I R-M systems).</p>
        <p>The next step differs from the classical motif enrichment approaches like the tools included in the MEME Suit. We have implemented a highly sensitive greedy algorithm that is aimed to generate the minimal set of short supermotifs of length 4–8 that can explain most part of sequences in the <italic toggle="yes">seq_set</italic>, under the assumption that all sequences in the <italic toggle="yes">seq_set</italic> contain at least one modified base. The principal idea of the algorithm is iterative search for the most over-represented motif in the <italic toggle="yes">seq_set</italic> in comparison with a reference genome using the χ<sup>2</sup> statistics, extraction it as a potential modification motif, following procedure of motif adjustment, which additionally ensures the correctness and completeness of the extracted motif, and filtering the <italic toggle="yes">seq_set</italic> list by removing all sequences that contain the extracted motif variant. After the <italic toggle="yes">seq_set</italic> filtering, the search and extraction procedure repeats. The termination of the algorithm work is determined by the input parameters <italic toggle="yes">confidence</italic> and <italic toggle="yes">max_motifs</italic>, where the <italic toggle="yes">confidence</italic> parameter means the minimal value of χ<sup>2</sup> test statistic (the default value is 5000 to provide high sensitivity), and the <italic toggle="yes">max_motifs</italic> parameter means the maximum desired number of extracted modification motifs (the default value is 20). As a result, the algorithm returns a sorted list of all potential motifs with corresponding confidence levels (we observed that typical confidence values for known methylation motifs are higher than 3000). A more formal explanation of the motif enrichment algorithm is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S3</xref>.</p>
      </sec>
    </sec>
    <sec>
      <title>2.5 External data collection</title>
      <p>Raw FAST5-files for <italic toggle="yes">Thermacetogenium phaeum</italic> DSM 12270, <italic toggle="yes">Neisseria gonorrhoeae</italic> FA 1090, <italic toggle="yes">Methanospirillum hungatei</italic> JF-1, and <italic toggle="yes">Clostridium perfringens</italic> ATCC 13124 were downloaded from SRP219538.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Software description</title>
      <p>We have developed a novel high-sensitive algorithm for methylation motifs detecting based on Oxford Nanopore sequencing data. The algorithm has been implemented as a command-line tool called Snapper and is available as a pip package to install. To perform non-target methylome analysis, the tool requires native and control (obtained by WGA) DNA samples being sequenced and resquiggled using Tombo. Snapper uses a <italic toggle="yes">k</italic>-mer approach, with <italic toggle="yes">k</italic> chosen to be at least 11 to guarantee coverage of all 6-mers that cover one particular base (<xref rid="btad702-F1" ref-type="fig">Fig. 1A</xref>) under the assumption that, in general, ∼6 bases are located in the nanopore simultaneously (<xref rid="btad702-B20" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2021</xref>). By default, the <italic toggle="yes">k</italic> size is set to be 15 but can be tuned by the user. The raw signals data are extracted from the input fast5-files until the required minimal mean genome coverage depth is reached. The default value of the minimal coverage depth parameter was set to be 40×. This value was chosen since it showed a satisfactory convergence of the results on the external datasets, which will be described in detail below.</p>
      <p>The first stage of the Snapper pipeline is the extraction of nucleotide short <italic toggle="yes">k</italic>-mers (typical <italic toggle="yes">k</italic> = 11–15, must be odd), which are most likely to contain a modified base. The comparison of signal distributions <bold>(</bold><xref rid="btad702-F1" ref-type="fig">Fig. 1C</xref>) is performed using the Kolmogorov–Smirnov test statistics. Next, all the extracted <italic toggle="yes">k</italic>-mers (<xref rid="btad702-F1" ref-type="fig">Fig. 1D</xref>) are merged by a greedy algorithm, which generates the minimal set of potential modification motifs which can explain the most part of the selected <italic toggle="yes">k</italic>-mers (<xref rid="btad702-F1" ref-type="fig">Fig. 1E</xref>), under the assumption that all selected <italic toggle="yes">k</italic>-mers contain at least one modified base. Snapper uses negative background for enrichment, and χ<sup>2</sup> statistics is used to estimate a confidence level for the extracted motifs.</p>
      <p>We observed that the typical confidence level for known motifs is 3000 or greater. Actually, the lowest score for a methylation motif among all the datasets, we have analyzed was 2307 (GTGAC motif for <italic toggle="yes">H.pylori</italic> J99, will be described below). We decided to set 500 as the default threshold to ensure that the tool is sensitive enough even for detection of very low-represented methylation motifs. The authors understand that such a low-threshold value could result in false-positive inference, so in the cases when the confidence level is rather low (lower than 3000) the user is recommended to check the motif correctness using signal shift plots generated by the tool.</p>
      <p>The detailed algorithm explanation is available in Section 2 and <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S3</xref>. A short tool’s guideline is available on <ext-link xlink:href="https://snapper-tutorial.readthedocs.io" ext-link-type="uri">https://snapper-tutorial.readthedocs.io</ext-link>. All the source code is available on GitHub (<ext-link xlink:href="https://github.com/DNKonanov/Snapper" ext-link-type="uri">https://github.com/DNKonanov/Snapper</ext-link>).</p>
      <p>In order to verify the approach developed, firstly we performed the total methylome analysis of <italic toggle="yes">H.pylori</italic> J99 strain, which has been characterized earlier using competing long-read sequencing technology PacBio (<xref rid="btad702-B8" ref-type="bibr">Krebes <italic toggle="yes">et al.</italic> 2014</xref>). Additionally, we compared our method with instruments Tombo (<xref rid="btad702-B17" ref-type="bibr">Stoiber <italic toggle="yes">et al.</italic> 2016</xref>) and Nanodisco (<xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>), which are in our knowledge the most up-to-date tools capable of non-target methylation motifs profiling besides Snapper. To check the capability of Snapper to deal with species different from <italic toggle="yes">H.pylori</italic>, a few external datasets representing different bacterial taxa were analyzed.</p>
    </sec>
    <sec>
      <title>3.2 Total methylome analysis of <italic toggle="yes">H.pylori</italic> J99</title>
      <p>The genome of <italic toggle="yes">H.pylori</italic> J99 (genotype cagA+/vacA s1m1) encodes about 20 R-M systems of Types II and III (<xref rid="btad702-B1" ref-type="bibr">Alm <italic toggle="yes">et al.</italic> 1999</xref>). At least 14 out of them have been shown to be active earlier using the PacBio long-reads sequencing (<xref rid="btad702-B8" ref-type="bibr">Krebes <italic toggle="yes">et al.</italic> 2014</xref>). We performed the full Snapper pipeline (the minimum coverage depth parameter was set 100×, other parameters were set by default) and discovered the same set of motifs except TCNNGA (<xref rid="btad702-T1" ref-type="table">Table 1</xref>, ONT+Snapper column). We should note that in <xref rid="btad702-T1" ref-type="table">Table 1</xref>, we demonstrate just the Snapper’s raw output. You can see more details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S4</xref>. To verify the absence of TCNNGA motif, we manually observed a subset of genome contexts that contained this pattern and had a significant signal shift. We found that all such contexts contained other extracted motifs, such as GAGG, GATC, TCGA, and others. Thus, we concluded that despite the presence of TCNNGA in a number of methylated positions it is not an individual methylation motif in our J99 strain (more information about TCNNGA is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S5</xref>). In case of GTSAC and GWCAY motifs, we faced a certain ambiguity while motifs merging since GTCAC is a submotif for both these sites. Formally, such cases can be resolved only experimentally and it is the reason why we decided not to merge motifs automatically in the Snapper pipeline.</p>
      <table-wrap position="float" id="btad702-T1">
        <label>Table 1.</label>
        <caption>
          <p>Lists of J99 methylation motifs obtained using different methylation motif detection approaches.<xref rid="tblfn1" ref-type="table-fn"><sup>a</sup></xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">PacBio + MotifMaker</th>
              <th rowspan="1" colspan="1">ONT + Snapper (raw output)</th>
              <th rowspan="1" colspan="1">ONT + Tombo</th>
              <th rowspan="1" colspan="1">ONT + Nanodisco</th>
              <th rowspan="1" colspan="1">Total number in genome (±strand)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">GAGG</td>
              <td rowspan="1" colspan="1">GAGG</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GAGG</td>
              <td rowspan="1" colspan="1">2542/2462</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GTSAC</td>
              <td rowspan="1" colspan="1">GTCAC, GTGAC<xref rid="tblfn2" ref-type="table-fn"><sup>b</sup></xref></td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">104/104</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1">5499/5499</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">340/340</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CCGG</td>
              <td rowspan="1" colspan="1">CCGG</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CCGG</td>
              <td rowspan="1" colspan="1">1807/1807</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">426/426</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CCNNGG</td>
              <td rowspan="1" colspan="1">CCNNGG</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CCNNGG</td>
              <td rowspan="1" colspan="1">1193/1193</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GTAC</td>
              <td rowspan="1" colspan="1">GTAC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GTAC</td>
              <td rowspan="1" colspan="1">182/182</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CGWCG</td>
              <td rowspan="1" colspan="1">CGACG, CGTCG<xref rid="tblfn2" ref-type="table-fn"><sup>b</sup></xref></td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CGWCG</td>
              <td rowspan="1" colspan="1">264/264</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1">2756/2756</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">6104/6104</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">7567/7567</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GCCTA</td>
              <td rowspan="1" colspan="1">GCCTA</td>
              <td rowspan="1" colspan="1">GCCTA</td>
              <td rowspan="1" colspan="1">GCCTA</td>
              <td rowspan="1" colspan="1">1532/1532</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GWCAY</td>
              <td rowspan="1" colspan="1">GACAY, GTCAT, GTCAC<xref rid="tblfn2" ref-type="table-fn"><sup>b</sup></xref></td>
              <td rowspan="1" colspan="1">GACAC</td>
              <td rowspan="1" colspan="1">GWCAY</td>
              <td rowspan="1" colspan="1">2641/2464</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GGWCNA</td>
              <td rowspan="1" colspan="1">GGWCNA</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GGWCHA</td>
              <td rowspan="1" colspan="1">838/789</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">1949/1949</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <label>a</label>
            <p>It should be noted here that the column entitled Snapper contains just the raw Snapper output excluding few false-positive motifs that were removed after manual results observation. The raw Snapper output and the verification process of this particular case are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S1</xref>. The PacBio results for <italic toggle="yes">H.pylori</italic> J99 were taken from the work of <xref rid="btad702-B8" ref-type="bibr">Krebes <italic toggle="yes">et al.</italic> (2014)</xref> directly (with few changes since the authors considered not the wild J99 strain but the J99-3 mutant). For Tombo, the best results that we managed to obtain with MEME are shown. For Nanodisco, the manually curated results are shown since the results generated in the automated mode were drastically less accurate.</p>
          </fn>
          <fn id="tblfn2">
            <label>b</label>
            <p>These motifs were extracted as different because the algorithm is designed to be quite cautious in motifs merging to prevent occasional motif collisions.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Additionally, we analyzed <italic toggle="yes">H.pylori</italic> J99 ONT reads using Tombo and Nanodisco tools, which are mainly designed at methylated position profiling but have their own motif enrichment functionality as well. Tombo uses the default MEME motif enrichment algorithm (<xref rid="btad702-B2" ref-type="bibr">Bailey <italic toggle="yes">et al.</italic> 2015</xref>) to extract motifs, so it has demonstrated rather low sensitivity and has inferred only five motifs highly represented in the genome (<xref rid="btad702-T1" ref-type="table">Table 1</xref>, ONT+Tombo column). Nanodisco also performs motif enrichment with MEME but uses an iterative approach that allows to detect more methylation sites but requires manual control on each motif extraction iteration because as we found in the fully automated mode Nanodisco is strongly prone to excessive motif collisions and even the most-represented motifs, such as CATG and GCGC, are not correctly discovered automatically and merged to GCRYG. Manually curated Nanodisco results are quite close to the automated Snapper output and the PacBio results except GTSAC and TCGA motifs (<xref rid="btad702-T1" ref-type="table">Table 1</xref>, ONT+Nanodisco column). Both these motifs are rather rare in the J99 genome, so the MEME algorithm did not identify them being enriched even using an iterative approach since Nanodisco uses the default MEME objective function without negative background (according to the Nanodisco source code). In the reference article, the authors also emphasize that GTAC has not been discovered in <italic toggle="yes">de novo</italic> mode due to the same reason. In Snapper, a set of all possible <italic toggle="yes">k</italic>-mers presented in the considered genome is used as a negative background, which simplifies the identification of rare motifs.</p>
    </sec>
    <sec>
      <title>3.3 External FAST5 datasets analysis</title>
      <p>Actually, the only dataset, which was used during the development of the core Snapper logic was <italic toggle="yes">H.pylori</italic> J99. To ensure that Snapper is not “overfitted” on <italic toggle="yes">H.pylori</italic> data, we downloaded external pair datasets containing WGA and native reads in FAST5-format for four different bacteria with highest number of different methylation motifs available in SRP219538 (<xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>): <italic toggle="yes">T.phaeum</italic> DSM 12270 (8 motifs), <italic toggle="yes">N.gonorrhoeae</italic> FA 1090 (8 motifs), <italic toggle="yes">M.hungatei</italic> JF-1 (6 motifs), and <italic toggle="yes">C.perfringens</italic> ATCC 13124 (6 motifs). <italic toggle="yes">Helicobacter pylori</italic> JP26 was not downloaded since here, we intentionally checked how the method works with non-<italic toggle="yes">H.pylori</italic> data. The genome coverage depth for each sample is listed in <xref rid="btad702-T2" ref-type="table">Table 2</xref>.</p>
      <table-wrap position="float" id="btad702-T2">
        <label>Table 2.</label>
        <caption>
          <p>The genome coverage depth, used in the methylome analysis of the four bacteria from external datasets.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Dataset</th>
              <th rowspan="1" colspan="1">Native DNA coverage depth used</th>
              <th rowspan="1" colspan="1">WGA DNA coverage depth used</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">Thermacetogenium phaeum</italic> DSM 12270</td>
              <td rowspan="1" colspan="1">31×<xref rid="tblfn3" ref-type="table-fn"><sup>a</sup></xref></td>
              <td rowspan="1" colspan="1">43×</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">Neisseria gonorrhoeae</italic> FA 1090</td>
              <td rowspan="1" colspan="1">44×</td>
              <td rowspan="1" colspan="1">41×</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">Methanospirillum hungatei</italic> JF-1</td>
              <td rowspan="1" colspan="1">43×</td>
              <td rowspan="1" colspan="1">41×</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">Clostridium perfringens</italic> ATCC 13124</td>
              <td rowspan="1" colspan="1">42×</td>
              <td rowspan="1" colspan="1">41×</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <label>a</label>
            <p>All available reads were used.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>FAST5-files were resquiggled using Tombo and processed with Snapper with the default parameters. The results were almost identical to the reference REBASE motifs described for these strains except one long motif CACNNNNNRTAAA, which was inferred by Snapper as CACNNNNNATAAA (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). We manually checked the motif correctness and did not find significant signal shift for CACNNNNNGTAAA variant.</p>
      <p>Few inaccuracies in motif identification were caused by motif collisions. Thus, in <italic toggle="yes">M.hungatei</italic> JF-1, which actually has AGCT and GCYYGAT motifs, Snapper identified AGCT, GCCTGAT, GCCCGAT, BGCTCGAT, and BGCTTGAC motif sequences. Here, AGCT had been extracted earlier that led to omitting AGCTCGAT and AGCTTGAC variants, and GCYYGAT motif was extracted formally incomplete. Generally, the algorithm cannot resolve such collisions without additional information and does not try to merge them to prevent results ambiguity. The same problem appeared in <italic toggle="yes">N.gonorrhoeae</italic> FA 1090, where RGCGCY motif was extracted incompletely since its GGCGCC subvariant intersected with GGNNCC motif sequence extracted first, so the Snapper output included only GGNNCC, AGCGCC, AGCGCT, and GGCGCT sequences but not GGCGCC.</p>
      <p>Interestingly, Snapper inferred a few methylation sites that were not mentioned in the reference article (<xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>). Thus, we observed significant signal shift and quite high confidence level for CCAG and TGGCCA motifs in <italic toggle="yes">T.phaeum</italic> DSM 12270. Both these motifs were independently approved using Nanodisco software in manual mode using the “motif refine” command (motif refinement plots are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S6</xref>). The WGGCCW motif not mentioned in the reference article was found in <italic toggle="yes">C.perfringens</italic> ATCC 13124.</p>
      <p>Also, we analyzed the methylome of the four chosen bacteria with Tombo. Here, to detect methylated positions, all available data were used. We tried to use different parameters for both Tombo processing (the <italic toggle="yes">k</italic>-mer size, the number of extracted sequences) and MEME motif enrichment (the objective function, mode) but have managed to identify only two correct motifs for <italic toggle="yes">T.phaeum</italic> DSM 12270, and one correct motif for three other bacteria. The detected motifs are presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>. Probably, the iterative approach similar to implemented in Nanodisco would provide better results but we intentionally tried to follow only the instructions from the Tombo’s documentation.</p>
    </sec>
    <sec>
      <title>3.4 Total methylome analysis of <italic toggle="yes">H.pylori</italic> A45 and mutants</title>
      <p>The <italic toggle="yes">H.pylori</italic> A45 (genotype cagA-/vacA s2m2) clinical isolate was obtained previously from a gastric mucosa biopsy sample from a patient with a gastric carcinoma (<xref rid="btad702-B11" ref-type="bibr">Momynaliev 2009</xref>). In addition, the derivatives of the A45 strain of <italic toggle="yes">H.pylori</italic>, defective in MTase genes M.HpyAI (<italic toggle="yes">hpy</italic> mutant), M.HpyAIII (<italic toggle="yes">hp91/92</italic> mutant), and M.HpyAIV (<italic toggle="yes">hp1352</italic> mutant) were obtained (<xref rid="btad702-B11" ref-type="bibr">Momynaliev 2009</xref>). As well as for <italic toggle="yes">H.pylori</italic> J99, here, we set the minimal genome coverage parameter as 100×. For the native sample the tool collected raw signals with the coverage depth of 101× but the control sample had the mean coverage of 61× due to lower sequencing depth.</p>
      <p>The analysis of <italic toggle="yes">H.pylori</italic> A45 has revealed presence of 15 methylation sites belonging to R-M systems of types II and III: ATTAAT, GTNNAC, GGRGA, CCATC, CATG, CCAG, GCGC, GANTC, GATC, GGCC, GAAC, TGCA, TCGA, TCNGA, and TCNNGA (<xref rid="btad702-T3" ref-type="table">Table 3</xref>, wild-type column). Interestingly, opposite to the <italic toggle="yes">H.pylori</italic> J99 analysis, in this case, all the extracted motifs had quite high confidence levels &gt;3000 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Material S7</xref>). Despite that, we manually observed signal distributions for all suggested sites and their closest genome context to ensure that all motifs had been extracted correctly.</p>
      <table-wrap position="float" id="btad702-T3">
        <label>Table 3.</label>
        <caption>
          <p>Methylation motifs detected in the wild A45 and four mutants.<xref rid="tblfn4" ref-type="table-fn"><sup>a</sup></xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Wild-type</th>
              <th rowspan="1" colspan="1">Total number in genome (+/− strand)</th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">hpy</italic>
              </th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">hp1352</italic>
              </th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">hp91/92</italic>
              </th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">hp944</italic>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">441/441</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GTNNAC</td>
              <td rowspan="1" colspan="1">325/325</td>
              <td rowspan="1" colspan="1">GTNNAC</td>
              <td rowspan="1" colspan="1">GTNNAC</td>
              <td rowspan="1" colspan="1">GTNNAC</td>
              <td rowspan="1" colspan="1">GTNNAC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GGRGA</td>
              <td rowspan="1" colspan="1">1768/1790</td>
              <td rowspan="1" colspan="1">GGRGA</td>
              <td rowspan="1" colspan="1">GGRGA</td>
              <td rowspan="1" colspan="1">GGRGA</td>
              <td rowspan="1" colspan="1">GGRGA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CCATC</td>
              <td rowspan="1" colspan="1">1163/1115</td>
              <td rowspan="1" colspan="1">CCATC</td>
              <td rowspan="1" colspan="1">CCATC</td>
              <td rowspan="1" colspan="1">CCATC</td>
              <td rowspan="1" colspan="1">CCATC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">7246/7246</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CCAG</td>
              <td rowspan="1" colspan="1">2173/2271</td>
              <td rowspan="1" colspan="1">CCAG</td>
              <td rowspan="1" colspan="1">CCAG</td>
              <td rowspan="1" colspan="1">CCAG</td>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">5982/5982</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1">2625/2625</td>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1">GANTC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1">5113/5113</td>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GATC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GGCC</td>
              <td rowspan="1" colspan="1">1534/1534</td>
              <td rowspan="1" colspan="1">GGCC</td>
              <td rowspan="1" colspan="1">GGCC</td>
              <td rowspan="1" colspan="1">GGCC</td>
              <td rowspan="1" colspan="1">GGCC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GAAC</td>
              <td rowspan="1" colspan="1">2760/2700</td>
              <td rowspan="1" colspan="1">GAAC</td>
              <td rowspan="1" colspan="1">GAAC</td>
              <td rowspan="1" colspan="1">GAAC</td>
              <td rowspan="1" colspan="1">GAAC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TGCA</td>
              <td rowspan="1" colspan="1">5770/5770</td>
              <td rowspan="1" colspan="1">TGCA</td>
              <td rowspan="1" colspan="1">TGCA</td>
              <td rowspan="1" colspan="1">TGCA</td>
              <td rowspan="1" colspan="1">TGCA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">290/290</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">TCGA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCNGA</td>
              <td rowspan="1" colspan="1">1224/1224</td>
              <td rowspan="1" colspan="1">TCNGA</td>
              <td rowspan="1" colspan="1">TCNGA</td>
              <td rowspan="1" colspan="1">TCNGA</td>
              <td rowspan="1" colspan="1">TCNGA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1">1926/1926</td>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1">TCNNGA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">3403/3267</td>
              <td rowspan="1" colspan="1">CCAAK</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CCAAK</td>
              <td rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn4">
            <label>a</label>
            <p>Interestingly, in the <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic> mutants an additional CCAAK methylation motif is observed.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>To identify the MTases responsible for methylation of new sites CCAG, GGRGA, and GAAC not described earlier for <italic toggle="yes">H.pylori</italic>, which were presented in <italic toggle="yes">H.pylori</italic> A45 and absent in <italic toggle="yes">H.pylori</italic> J99, all candidate MTase genes were extracted from both genomes and used to construct a phylogenetic tree based on protein sequences similarity. Two proteins that were presented only in <italic toggle="yes">H.pylori</italic> A45 strain and did not have orthologous genes in <italic toggle="yes">H.pylori</italic> J99 were considered as potentially new MTases. Two new <italic toggle="yes">H.pylori</italic> A45 derived mutants (<italic toggle="yes">hp8</italic> and <italic toggle="yes">hp944</italic>) disrupted in corresponding genes hp0008 and hp0944 were obtained during this work. Their native DNA was analyzed using ONT and the sequencing data were processed using Snapper. The <italic toggle="yes">hp8</italic> mutant did not have any signal changes, but in the <italic toggle="yes">hp944</italic> mutant we observed a successful deactivation of CCAG-specific MTase (<xref rid="btad702-T3" ref-type="table">Table 3</xref>, <italic toggle="yes">hp944</italic> column). As we found later, the negative result for <italic toggle="yes">hp8</italic> was caused by a nonsense mutation in the MTase gene in the wild A45.</p>
      <p>Here, to estimate the method specificity, in addition to the wild-type, we analyzed three mutants of <italic toggle="yes">H.pylori</italic> A45 disrupted in three different genes encoding MTases with known specificity (<italic toggle="yes">hpy</italic>, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp91/92</italic> mutants disrupted in the genes of MTases specific to CATG, GANTC, and GATC motifs, respectively). Here, we used as a control not the WGA sample but the native A45 to check out how the algorithm works with a small number of motifs that differ by their signal level. We expected the algorithm to extract only one motif for each mutant, but two mutants had an additional motif that seemed to be modified. Firstly, in all three mutants Snapper successfully detected the absence of methylation of the corresponding motifs (<xref rid="btad702-T3" ref-type="table">Table 3</xref>, <italic toggle="yes">hpy</italic>, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp91/92</italic> columns, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). Secondly, the CCAAK site was detected as methylated in <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic> mutants while the native sample, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp944</italic> had CCAAK signal distributions identical to the WGA sample (<xref rid="btad702-F2" ref-type="fig">Fig. 2A</xref>).</p>
      <fig position="float" id="btad702-F2">
        <label>Figure 2.</label>
        <caption>
          <p>CCAAK-specific MTase inference. (A) Normalized signal distributions for the CCAAK methylation site. <italic toggle="yes">hp91/92</italic> and <italic toggle="yes">hpy</italic> mutants have a visible signal shift in comparison with the WGA sample while the wild A45 and the <italic toggle="yes">hp1352</italic> mutant have signal distributions identical to the WGA sample. (B) Wild A45 and the <italic toggle="yes">hp1352</italic> mutant have CCAAK-specific MTase gene broken because of a frame-shift insertion in a homopolymeric region in the gene. The reverse frame-shift mutation in the MTase gene restores the Type III R-M system activity in <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic></p>
        </caption>
        <graphic xlink:href="btad702f2" position="float"/>
      </fig>
      <p>To identify the MTase responsible for modification of CCAAK, we used non-target proteomics data that were obtained earlier for the wild A45 and <italic toggle="yes">hpy</italic>, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp91/92</italic> mutants (the procedure is described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S14</xref>). Five proteins that were significantly over-represented (LFC≥5) in <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic> mutants in comparison to the wild-type and <italic toggle="yes">hp1352</italic> were found and manually annotated using BLASTP (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S11 and S12</xref>). Proteins encoded by hp0008 and hp0009 genes were annotated as two fragments of one MTase gene, and gene hp0010 was annotated as a Type III R-M system endonuclease, so, these three genes encode a full Type III R-M system but with a broken MTase gene. The appearance of the CCAAK methylation site in <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic> was caused by a reverse frame-shift mutation in a homopolymeric region in hp0008 gene, which was confirmed by short Illumina reads (<xref rid="btad702-F2" ref-type="fig">Fig. 2B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>).</p>
      <p>Additionally, we checked the coverage depth required for extraction of two non-overlapped motifs (the <italic toggle="yes">hpy</italic> mutant, CATG and CCAAK motifs). The tool extracted these motifs correctly with mean coverage depth of 14× (∼20 000 reads per sample).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Oxford Nanopore sequencing has a great potential for the analysis of epigenetic modifications of the four canonical bases. Unfortunately, the current software designed for methylation site detection possesses certain drawbacks. Thus, both Tombo and Nanodisco provide high-quality profiling of methylated positions in a genome but the main problem here is to accurately generate a set of potential motifs that could explain all methylated bases. Technically, it is a classical motif enrichment task, but classical approaches have proven to be insufficiently sensitive for analyzing highly methylated genomes, such as the <italic toggle="yes">H.pylori</italic> genome. Thus, we found that the most widely used tool suit MEME is capable of detecting only highly represented motifs. An iterative approach implemented in Nanodisco is more sensitive but requires a lot of manual work while extracting motifs, which limits its applicability when more than few genomes are studied.</p>
    <p>We have developed a new greedy algorithm that is aimed at high-sensitive motif enrichment. This algorithm has been implemented as the command-line tool Snapper. Here, we have shown that, firstly, as a fully automated pipeline, Snapper outperforms both Tombo and Nanodisco coupled with the MEME tool and, secondly, Snapper is capable of detecting methylation site sequences with sensitivity equivalent to the PacBio technology and is slightly more sensitive than Nanodisco in the manual mode. In contrast to Nanodisco, Snapper provides a fully automated motif extraction algorithm and requires manual results verification only during adjustment of motifs with a low confidence level.</p>
    <p>We should note again that Snapper must not be considered as an alternative to MEME since MEME has been developed as a universal approach and can deal with any type of data, while Snapper uses special search heuristics aimed at finding methylation motifs specifically. These heuristics narrow the search space, and as a result, the algorithm can provide higher enrichment sensitivity.</p>
    <p>Another feature we should note is an intended algorithm cautiousness in motifs merging to avoid occasional motif collisions. Thus, the <italic toggle="yes">H.pylori J99</italic> analysis has shown the presence of motifs GTCAT, GTCAC, GACAY, and GTGAC as methylated. Actually, these submotifs are explained by GWCAY and GTSAC methylation sites but GWCAY+GTGAC variant is formally possible as well. Such cases can be resolved only experimentally so we decided not to merge controversial motifs in the Snapper motif extraction algorithm. A related problem with motif sequences resolving appeared in the <italic toggle="yes">M.hungatei</italic> JF-1 analysis results, which actually has AGCT and GCYYGAT methylation sites but Snapper’s output included AGCT, GCCCGAT, GCCTGAT, BGCTCGAT, and BGCTTGAC (“B” means “not A”). Indeed, the last two motif subvariants were inferred after AGCT had been inferred. Therefore, the algorithm had already explained AGCTCGAT and AGCTTGAC subvariants by the presence of AGCT. Thus, although the algorithm is formally fully automated, some cases should be considered manually.</p>
    <p>Since Snapper aims not at the methylated positions calling but methylation motif sequences, it is relatively less demanding on the input data compared with Nanodisco or Tombo. The genome coverage required for the analysis depends on the object of interest. Thus, while analyzing organisms that have very few different non-overlapped methylation sites, the method can work well even with a mean genome coverage of 15–20×. On the other hand, for organisms with higher number of different methylatinon sites Snapper requires higher sequencing coverage to more accurately resolve similar motif sequences. The authors suggest that, in most cases, coverage of 80–100× is absolutely enough for high-accurate methylation motifs detection. On the other hand, since Snapper is not aimed to detect modified positions and predict the modification type, the authors recommend using Nanodisco for these purposes after the target motif sequences have been identified.</p>
    <p>Using Snapper, we fully characterized the methylome of a new <italic toggle="yes">H.pylori</italic> strain A45. In this strain, we found three methylation sites that have not been described earlier for <italic toggle="yes">H.pylori</italic> (GGRGA, GAAC, and CCAG) and managed to experimentally confirm the MTase specific to CCAG. In addition, during the experiment, we observed a frame-shift-based phase variation in the gene encoding a new MTase specific to CCAAK methylation site. Thus, we did not observe this site being methylated in the wild A45 culture but it appeared after the disruption in CATG-specific MTase or GATC-specific MTase. In both cases, it was caused by the same reverse frame-shift mutation in a homopolymeric region in the gene encoding corresponding MTase. Such a behavior is quite typical for <italic toggle="yes">H.pylori</italic> and is often used to regulate activity of particular MTase genes (<xref rid="btad702-B3" ref-type="bibr">Beaulaurier <italic toggle="yes">et al.</italic> 2015</xref>).</p>
    <p>As an additional verification, we analyzed four external datasets representing different bacterial taxa. In all cases, Snapper discovered all methylation motif sequences that had been shown for these bacteria according to the REBASE database and few additional motifs, which has illustrated the versatility of the method. However, we observed few problems with motif sequences resolving (as the AGCT and GCYYGAT collision mentioned above), especially in highly methylated organisms, so we cannot declare that Snapper’s results can always be used as is and should be additionally curated by a user.</p>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>We have developed Snapper—a tool for high-sensitive methylation motifs identification. Snapper has been shown to be more sensitive than MEME coupled with the Tombo software. Snapper demonstrated slightly higher motif detection accuracy compared to Nanodisco and did not require extensive manual work during the motif extraction procedure, unlike Nanodisco. Snapper was tested in detail on data obtained in this study as well as on a few external datasets. Using Snapper, we characterized the methylation motifs in a new <italic toggle="yes">H.pylori</italic> A45 strain and discovered four motif sequences that have not been described for <italic toggle="yes">H.pylori</italic> earlier. We managed to experimentally confirm a gene encoding a new CCAG-specific MTase and inferred a gene encoding CCAAK-specific MTase.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad702_Supplementary_Data</label>
      <media xlink:href="btad702_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the Center for Precision Genome Editing and Genetic Technologies for Biomedicine, Federal Research and Clinical Center of Physical–Chemical Medicine of the Federal Medical Biological Agency for providing computational resources for this project. <italic toggle="yes">Helicobacter pylori</italic> J99 strain (No. 700824, cagA+/vacA s1m1 genotype) was kindly provided by Prof. M. Achtman (Max Planck Institute for Infection Biology, Germany). <italic toggle="yes">Helicobacter pylori</italic> A45 and <italic toggle="yes">hpy</italic>, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp91/92</italic> mutants were kindly provided by Dr K.T. Momynaliev.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>D.N.K. and V.V.B. led the project, wrote the manuscript text, and prepared all the figures and supplementary data; D.N.K. designed and implemented the main algorithms and performed <italic toggle="yes">Helicobacter pylori</italic> A45 and J99 methylome analysis; A.M.B. wrote the manuscript text, realized cell culture procedures, and prepared <italic toggle="yes">Helicobacter pylori hp8</italic> and <italic toggle="yes">hp944</italic> mutant strains; A.G.M. performed Nanodisco analysis; A.G.M. and D.V.K. helped with multiprocessing implementation; O.E.G. ran Tombo and helped with methylation analysis; I.O.B. performed proteomics experiments; D.E.F. and A.I.M. processed the proteomics data; A.I.M. and V.V.B. carried out genomic data analysis; V.V.B. and D.I.B. performed genome sequencing; V.N.L., V.M.G., and E.N.I. administered the project; and E.N.I. edited the manuscript.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work did not receive any financial support from commercial or non-commercial organizations.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All the source code is available on Github (<ext-link xlink:href="https://github.com/DNKonanov/Snapper" ext-link-type="uri">https://github.com/DNKonanov/Snapper</ext-link>). Fastq files are available in SRA (NCBI Bioproject accession number PRJNA175046). The mass spectrometry proteomics data have been deposited to the ProteomeXchange Consortium via the PRIDE (<xref rid="btad702-B13" ref-type="bibr">Perez-Riverol <italic toggle="yes">et al.</italic> 2019</xref>) partner repository with the dataset identifier PXD038899 (access for the reviewers: login reviewer <email>pxd038899@ebi.ac.uk</email>, password—xOuk64qK). All genome assemblies obtained during this study are available in GenBank (<italic toggle="yes">Helicobacter pylori</italic> A45 wild-type: GCA 000333835.2, <italic toggle="yes">hpy</italic>: GCA 013122115.1, <italic toggle="yes">hp1352</italic>: GCA 013122055.1, <italic toggle="yes">hp91/92</italic>: GCA 013122035.1). External fast5-files used in this study were downloaded from SRP219538. Additionally, we provide a small fast5 example dataset in order to demonstrate the tool capabilities. The demo-dataset includes 10 + 10 preprocessed multi-fast5 files containing 40 000 long reads for the hpy mutant and 40 000 reads for the wild A45 as a control (<ext-link xlink:href="http://download.ripcm.com/snapper_test" ext-link-type="uri">http://download.ripcm.com/snapper_test</ext-link>). Both Snapper tool and the demo dataset are available in Zenodo (10.5281/zenodo.10117651).</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad702-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alm</surname><given-names>RA</given-names></string-name>, <string-name><surname>Ling</surname><given-names>LS</given-names></string-name>, <string-name><surname>Moir</surname><given-names>DT</given-names></string-name></person-group><etal>et al</etal><article-title>Genomic-sequence comparison of two unrelated isolates of the human gastric pathogen <italic toggle="yes">Helicobacter pylori</italic></article-title>. <source>Nature</source><year>1999</year>;<volume>397</volume>:<fpage>176</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">9923682</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bailey</surname><given-names>TL</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>J</given-names></string-name>, <string-name><surname>Grant</surname><given-names>CE</given-names></string-name></person-group><etal>et al</etal><article-title>The meme suite</article-title>. <source>Nucleic Acids Res</source><year>2015</year>;<volume>43</volume>:<fpage>W39</fpage>–<lpage>49</lpage>.<pub-id pub-id-type="pmid">25953851</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beaulaurier</surname><given-names>J, Zhang X, Zhu S</given-names></string-name></person-group><etal>et al</etal><article-title>Single molecule-level detection and long read-based phasing of epigenetic variations in bacterial methylomes</article-title>. <source>Nat Commun</source><year>2015</year>;<volume>6</volume>:<fpage>7438</fpage>.<pub-id pub-id-type="pmid">26074426</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Belova</surname><given-names>AM</given-names></string-name>, <string-name><surname>Basmanov</surname><given-names>DV</given-names></string-name>, <string-name><surname>Prusakov</surname><given-names>KA</given-names></string-name></person-group><etal>et al</etal><article-title>A microfluidic platform for the development of a biosensor based on genetically modified <italic toggle="yes">Helicobacter pylori</italic> single cells</article-title>. <source>Biophysics</source><year>2018</year>;<volume>63</volume>:<fpage>735</fpage>–<lpage>42</lpage>.</mixed-citation>
    </ref>
    <ref id="btad702-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gorrell</surname><given-names>R</given-names></string-name>, <string-name><surname>Kwok</surname><given-names>T.</given-names></string-name></person-group><article-title>The <italic toggle="yes">Helicobacter pylori</italic> methylome: roles in gene regulation and virulence</article-title>. <source>Curr Top Microbiol Immunol</source><year>2017</year>;<volume>400</volume>:<fpage>105</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">28124151</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hofreuter</surname><given-names>D</given-names></string-name>, <string-name><surname>Odenbreit</surname><given-names>S</given-names></string-name>, <string-name><surname>Haas</surname><given-names>R.</given-names></string-name></person-group><article-title>Natural transformation competence in <italic toggle="yes">Helicobacter pylori</italic> is mediated by the basic components of a type IV secretion system</article-title>. <source>Mol Microbiol</source><year>2001</year>;<volume>41</volume>:<fpage>379</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">11489125</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jain</surname><given-names>M</given-names></string-name>, <string-name><surname>Olsen</surname><given-names>HE</given-names></string-name>, <string-name><surname>Paten</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>The Oxford Nanopore MinION: delivery of nanopore sequencing to the genomics community</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>239</fpage>.<pub-id pub-id-type="pmid">27887629</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krebes</surname><given-names>J</given-names></string-name>, <string-name><surname>Morgan</surname><given-names>RD</given-names></string-name>, <string-name><surname>Bunk</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>The complex methylome of the human gastric pathogen <italic toggle="yes">Helicobacter pylori</italic></article-title>. <source>Nucleic Acids Res</source><year>2014</year>;<volume>42</volume>:<fpage>2415</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">24302578</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Georgieva</surname><given-names>DC</given-names></string-name>, <string-name><surname>Egli</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>NanoMod: a computational tool to detect DNA modifications using Nanopore long-read sequencing data</article-title>. <source>BMC Genomics</source><year>2019</year>;<volume>20</volume>:<fpage>78</fpage>.<pub-id pub-id-type="pmid">30712508</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Rosikiewicz</surname><given-names>W</given-names></string-name>, <string-name><surname>Pan</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>DNA methylation-calling tools for Oxford Nanopore sequencing: a survey and human epigenome-wide evaluation</article-title>. <source>Genome Biol</source><year>2021</year>;<volume>22</volume>:<fpage>295</fpage>.<pub-id pub-id-type="pmid">34663425</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Momynaliev</surname><given-names>KT.</given-names></string-name></person-group> Genomno-proteomnaya Kharakteristika Variabelnosti <italic toggle="yes">Helicobacter Pylori</italic> [Genomic and proteomic characteristics of the <italic toggle="yes">Helicobacter pylori</italic> variability]. Ph.D. Thesis, Moscow, Russia, <year>2009</year>.</mixed-citation>
    </ref>
    <ref id="btad702-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ni</surname><given-names>P</given-names></string-name>, <string-name><surname>Huang</surname><given-names>N</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>DeepSignal: detecting DNA methylation state from Nanopore sequencing reads using deep-learning</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>4586</fpage>–<lpage>95</lpage>.<pub-id pub-id-type="pmid">30994904</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Perez-Riverol</surname><given-names>Y</given-names></string-name>, <string-name><surname>Csordas</surname><given-names>A</given-names></string-name>, <string-name><surname>Bai</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>The PRIDE database and related tools and resources in 2019: improving support for quantification data</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>D442</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">30395289</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roberts</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Vincze</surname><given-names>T</given-names></string-name>, <string-name><surname>Posfai</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>REBASE—a database for DNA restriction and modification: enzymes, genes and genomes</article-title>. <source>Nucleic Acids Res</source><year>2015</year>;<volume>43</volume>:<fpage>D298</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">25378308</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B15">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Sambrook</surname><given-names>J, Fritsch EF, Maniatis T.</given-names></string-name></person-group><source>Molecular Cloning: A Laboratory Manual</source>. <edition>2nd edn</edition>. <publisher-loc>New York</publisher-loc>: <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>, <year>1989</year>.</mixed-citation>
    </ref>
    <ref id="btad702-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Seemann</surname><given-names>T.</given-names></string-name></person-group><article-title>Prokka: rapid prokaryotic genome annotation</article-title>. <source>Bioinformatics</source><year>2014</year>;<volume>30</volume>:<fpage>2068</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24642063</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Stoiber</surname><given-names>M, Quick J, Egan R</given-names></string-name></person-group><etal>et al</etal> De novo identification of DNA modifications enabled by genome-guided nanopore signal processing. bioRxiv, 094672, <year>2016</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad702-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tourancheau</surname><given-names>A</given-names></string-name>, <string-name><surname>Mead</surname><given-names>EA</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>X-S</given-names></string-name></person-group><etal>et al</etal><article-title>Discovering multiple types of DNA methylation from bacteria and microbiome using nanopore sequencing</article-title>. <source>Nat Methods</source><year>2021</year>;<volume>18</volume>:<fpage>491</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">33820988</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wick</surname><given-names>RR</given-names></string-name>, <string-name><surname>Judd</surname><given-names>LM</given-names></string-name>, <string-name><surname>Gorrie</surname><given-names>CL</given-names></string-name></person-group><etal>et al</etal><article-title>Completing bacterial genome assemblies with multiplex MinION sequencing</article-title>. <source>Microb Genom</source><year>2017</year>;<volume>3</volume>:<fpage>e000132</fpage>.<pub-id pub-id-type="pmid">29177090</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>H</given-names></string-name>, <string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Jain</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Real-time mapping of nanopore raw signals</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>i477</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">34252938</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10689673</article-id>
    <article-id pub-id-type="pmid">37982752</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad702</article-id>
    <article-id pub-id-type="publisher-id">btad702</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Snapper: high-sensitive detection of methylation motifs based on Oxford Nanopore reads</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1217-9234</contrib-id>
        <name>
          <surname>Konanov</surname>
          <given-names>Dmitry N</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
        <xref rid="btad702-cor1" ref-type="corresp"/>
        <!--konanovdmitriy@gmail.com-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Babenko</surname>
          <given-names>Vladislav V</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Belova</surname>
          <given-names>Aleksandra M</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Madan</surname>
          <given-names>Arina G</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
        <aff><institution>Department of Molecular and Translational Medicine, Moscow Institute of Physics and Technology, State University</institution>, Dolgoprudny 141700, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boldyreva</surname>
          <given-names>Daria I</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Glushenko</surname>
          <given-names>Oksana E</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Butenko</surname>
          <given-names>Ivan O</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fedorov</surname>
          <given-names>Dmitry E</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Manolov</surname>
          <given-names>Alexander I</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Krivonos</surname>
          <given-names>Danil V</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
        <aff><institution>Department of Molecular and Translational Medicine, Moscow Institute of Physics and Technology, State University</institution>, Dolgoprudny 141700, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lazarev</surname>
          <given-names>Vassilii N</given-names>
        </name>
        <aff><institution>Federal Research and Clinical Center of Physical-Chemical Medicine, Federal Medical Biological Agency</institution>, Moscow 119435, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Govorun</surname>
          <given-names>Vadim M</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ilina</surname>
          <given-names>Elena N</given-names>
        </name>
        <aff><institution>Research Institute for Systems Biology and Medicine</institution>, Moscow 117246, Russia</aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad702-cor1">Corresponding author. Laboratory of mathematical biology and bioinformatics, Research Institute for Systems Biology and Medicine, Nauchnyi Proezd, 18, Moscow 117246, Russia. E-mail: <email>konanovdmitriy@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-20">
      <day>20</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>11</issue>
    <elocation-id>btad702</elocation-id>
    <history>
      <date date-type="received">
        <day>24</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>14</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>30</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad702.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The Oxford Nanopore technology has a great potential for the analysis of methylated motifs in genomes, including whole-genome methylome profiling. However, we found that there are no methylation motifs detection algorithms, which would be sensitive enough and return deterministic results. Thus, the MEME suit does not extract all <italic toggle="yes">Helicobacter pylori</italic> methylation sites <italic toggle="yes">de novo</italic> even using the iterative approach implemented in the most up-to-date methylation analysis tool Nanodisco.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present Snapper, a new highly sensitive approach, to extract methylation motif sequences based on a greedy motif selection algorithm. Snapper does not require manual control during the enrichment process and has enrichment sensitivity higher than MEME coupled with Tombo or Nanodisco instruments that was demonstrated on <italic toggle="yes">H.pylori</italic> strain J99 studied earlier by the PacBio technology and on four external datasets representing different bacterial species. We used Snapper to characterize the total methylome of a new <italic toggle="yes">H.pylori</italic> strain A45. At least four methylation sites that have not been described for <italic toggle="yes">H.pylori</italic> earlier were revealed. We experimentally confirmed the presence of a new CCAG-specific methyltransferase and inferred a gene encoding a new CCAAK-specific methyltransferase.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Snapper is implemented using Python and is freely available as a pip package named “snapper-ont.” Also, Snapper and the demo dataset are available in Zenodo (10.5281/zenodo.10117651).</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Restriction-modification (R-M) systems are one of the essential mechanisms used by bacteria for protection from bacteriophage invasion. Generally, bacterial R-M systems are divided into four global groups (I, II, III, and IV) (<xref rid="btad702-B14" ref-type="bibr">Roberts <italic toggle="yes">et al.</italic> 2015</xref>) depending on the R-M complex structure. Despite their different architectures, all R-M systems share a common feature: the presence of site-specific DNA-binding domains that recognize specific short DNA sequence that should be methylated to prevent the restrictase activity.</p>
    <p>The Oxford Nanopore technology (ONT) is a long-read sequencing technology based on measuring electric current across the nanopore (<xref rid="btad702-B7" ref-type="bibr">Jain <italic toggle="yes">et al.</italic> 2016</xref>). The ONT makes it possible not only to detect the four canonical nucleotide bases, but also to additionally catch any of their modified forms that can significantly change the sequencing signal (<xref rid="btad702-B10" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2021</xref>). A number of tools aimed at accurate detection of methylated positions have already been developed (<xref rid="btad702-B17" ref-type="bibr">Stoiber <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btad702-B9" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad702-B12" ref-type="bibr">Ni <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>). However, these tools have certain limitations in inferring methylation site sequences, especially when dealing with low-represented DNA motifs. We faced it when we were analyzing our <italic toggle="yes">Helicobacter pylori</italic> data. In general, these tools provide accurate detection of methylated positions in a considered genome (<xref rid="btad702-B17" ref-type="bibr">Stoiber <italic toggle="yes">et al.</italic> 2016</xref>) or prediction of methylation type (6mA, 5mC, and 4mC) in a chosen site (<xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>) but we found that the process of precise identification of methylation motif sequences is either not sensitive enough or requires a lot of manual control.</p>
    <p>Here, we present a novel tool called Snapper that performs high-sensitive identification of methylation motifs based on ONT sequencing data. The tool is mainly verified on <italic toggle="yes">H.pylori</italic> J99 sequencing data and compared with Tombo and Nanodisco, which are the most up-to-date instruments with similar functionality.</p>
    <p>We chose <italic toggle="yes">H.pylori</italic> species as the object of interest in this study firstly because it is a unique organism that is shown to bring up to 30 different R-M systems in its genome (<xref rid="btad702-B5" ref-type="bibr">Gorrell and Kwok 2017</xref>) and has methyltransferases (MTases) capable of methylation adenine as well as cytosine (<xref rid="btad702-B5" ref-type="bibr">Gorrell and Kwok 2017</xref>). Secondly, it is a naturally competent organism (<xref rid="btad702-B6" ref-type="bibr">Hofreuter <italic toggle="yes">et al.</italic> 2001</xref>) that can be quite easily modified to confirm new inferred MTases. Third, the <italic toggle="yes">H.pylori</italic> J99 strain has been characterized earlier using the PacBio sequencing technology (<xref rid="btad702-B8" ref-type="bibr">Krebes <italic toggle="yes">et al.</italic> 2014</xref>) that allows us to directly compare our results with competing technology. To additionally validate the method, a few external datasets were analyzed to ensure that Snapper is capable of detecting methylation sites in different bacterial taxa.</p>
    <p>To demonstrate the applicability of the developed tool, here, we use Snapper to characterize the methylome of a new <italic toggle="yes">H.pylori</italic> A45 strain. The method specificity is additionally demonstrated on A45-derived mutants disrupted in genes of MTases with known specificity.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Bacterial strains and culture manipulation</title>
      <p>The <italic toggle="yes">H.pylori</italic> A45 clinical isolate was obtained from a gastric mucosa biopsy sample of a patient with a gastric carcinoma (<xref rid="btad702-B11" ref-type="bibr">Momynaliev 2009</xref>). This isolate was used to obtain <italic toggle="yes">hpy</italic>, <italic toggle="yes">hp91/92</italic>, <italic toggle="yes">hp1352</italic>, <italic toggle="yes">hp8</italic>, and <italic toggle="yes">hp944</italic> derivatives defective in MTase genes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). A targeted inactivation procedure was performed using the gene knockout method. The detailed description of <italic toggle="yes">H.pylori</italic> mutant strains construction is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S2</xref>.</p>
      <p><italic toggle="yes">Escherichia coli</italic> strain Top10 required for plasmid vectors assembly and production was cultivated at 37°C on solid Luria–Bertani medium or in liquid Luria–Bertani medium with aeration (150 rpm). The transformation procedure was carried out using the “heat shock” transformation protocol (<ext-link xlink:href="https://international.neb.com/protocols/2012/05/21/transformation-protocol" ext-link-type="uri">https://international.neb.com/protocols/2012/05/21/transformation-protocol</ext-link>). Chloramphenicol (8 µg/ml, Panreac, Spain) and kanamycin (15 µg/ml, Sigma, USA) were added to the medium for selection.</p>
      <p><italic toggle="yes">Helicobacter pylori</italic> strains were cultivated for 20–48 h at 37°C under microaerophilic conditions on Columbian agar solid medium (Becton Dickinson, USA) supplemented with 10% donor horse serum (PAA Labs, Austria). Chloramphenicol (8 µg/ml) and kanamycin (15 µg/ml) were added for the selection and passage of resistant mutant strains. Amplicon cell transformation was carried out as described in <xref rid="btad702-B4" ref-type="bibr">Belova <italic toggle="yes">et al.</italic> (2018)</xref>. Cells were cultivated for 24 h at 37°C under microaerophilic conditions on solid medium. The cell suspension (109 CFU) was moved on a new plate and cultivated for 4–5 h for undergrowth. Thereafter, sterile water suspension, containing 500 ng DNA fragments was applied dropwise onto the solid medium surface containing undergrowth cells. The dishes were then left agar side up in the CO<sub>2</sub> incubator for 17–20 h. The next day, cells were subsequently transferred to a selective medium containing corresponding antibiotics. Clones found on plates after 4–5 days were verified to be <italic toggle="yes">H.pylori</italic> and to contain the specific insertions by PCR using primer sets listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>. For any consequent assay all <italic toggle="yes">H.pylori</italic> strains were harvested from the plates after 2 days growth. Cells were washed with HBSS buffer, pH 7.5 (Hank’s Balanced Salt Solution, Thermo Fisher, USA) and precipitated by centrifugation at 3000 × <italic toggle="yes">g</italic> for 10 min for genomic DNA preparation as described earlier.</p>
    </sec>
    <sec>
      <title>2.2 DNA manipulation</title>
      <p>Vectors and mutant strains used in this study are listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. All standard methods of DNA manipulation, such as plasmid isolation by alkaline lysis, restriction endonuclease digestion, and ligation, were performed according to the protocols of <xref rid="btad702-B15" ref-type="bibr">Sambrook <italic toggle="yes">et al.</italic> (1989)</xref>. <italic toggle="yes">Helicobacter pylori</italic> genomic DNA was prepared using the diaGene kit for DNA extraction from cell cultures (diaGene, Russia). Single DNA fragments or PCR amplification products for cloning or sequencing purposes were purified from agarose gels using Cleanup Standard Kit (Evrogen, Russia). DNA restriction enzymes were obtained from Fermentas (Thermo Fisher Scientific, USA) and were used according to the directions of the manufacturers.</p>
    </sec>
    <sec>
      <title>2.3 Sequencing</title>
      <sec>
        <title>2.3.1 Whole-genome amplification</title>
        <p>The Qiagen REPLI-g Single Cell Kit was used to perform whole-genome amplification to exclude epigenetically modified bases. The method produced micrograms of DNA from 10 ng of input genomic DNA, following the manufacturer’s guidelines and 8 h of amplification time at 30°C followed by deactivation at 65°C for 3 min.</p>
      </sec>
      <sec>
        <title>2.3.2 Oxford Nanopore</title>
        <p>The DNA was isolated by using the Wizard DNA extraction kit (Promega Corporation, USA) and size selected with optimized solid phase reversible immobilization (SPRI) beads. The DNA concentration and quality were determined on a Qubit 4 Fluorometer and Nanodrop ND-1000 (Thermo Fisher Scientific). The long reads were generated with MinION sequencing (Oxford Nanopore Technologies, UK). The sequencing libraries were prepared using the ligation sequencing kit SQK-LSK109, native barcoding expansion kit EXP-NBD104 and run in a FLOMIN106 flow cell. Reads were basecalled using Guppy v3.6.1. using default parameters.</p>
      </sec>
      <sec>
        <title>2.3.3 Illumina</title>
        <p>A NEBNext Ultra DNA library prep kit (New England Biolabs, USA) was used to prepare fragment libraries for genome sequencing. Sequencing was performed on the HiSeq 2500 System (Illumina, USA) HiSeq Rapid SBS Kit V2 using a 2 × 250 bp run configuration.</p>
        <p><italic toggle="yes">De novo</italic> assembly was performed by hybrid assembler Unicycler (v0.4.8) (<xref rid="btad702-B19" ref-type="bibr">Wick <italic toggle="yes">et al.</italic> 2017</xref>) using default parameters. Identification of the protein-coding sequences and primary annotation were performed using PROKKA v1.14.6 (<xref rid="btad702-B16" ref-type="bibr">Seemann 2014</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Methylation analysis</title>
      <sec>
        <title>2.4.1 Tombo</title>
        <p>Raw signals from the fast5 files obtained for both native and WGS samples were mapped to corresponding reference genome positions using “tombo resquiggle” command (<xref rid="btad702-B17" ref-type="bibr">Stoiber <italic toggle="yes">et al.</italic> 2016</xref>). Next, modified positions were extracted using the “model sample compare” tombo mode. The resulting positions were used to construct all sequences that are likely to bring a methylation base, with the sequence length chosen to be 12, 18, and 22. These nucleotide contexts were processed by MEME (<xref rid="btad702-B2" ref-type="bibr">Bailey <italic toggle="yes">et al.</italic> 2015</xref>) with algorithm parameters recommended in the Tombo documentation and with customized parameters (-mod, -objfun, and -ng) in order to find the most sensitive approach. The motifs that were significantly over-represented in the selected contexts were considered as methylation sites.</p>
        <p>Tombo was used only to analyze <italic toggle="yes">H.pylori</italic> J99 and four external datasets and as a result was excluded from the analysis of <italic toggle="yes">H.pylori</italic> A45 since its sensitivity turned out to be not enough for the analysis of highly methylated genomes.</p>
      </sec>
      <sec>
        <title>2.4.2 Nanodisco</title>
        <p>For each strain, both sample and control fast5 files and the assembly file were processed according to the standard Nanodisco (v.1.0.3) pipeline described in the documentation (<ext-link xlink:href="https://nanodisco.readthedocs.io/en/latest/overview.html" ext-link-type="uri">https://nanodisco.readthedocs.io/en/latest/overview.html</ext-link>). While running motif extraction stage (“nanodisco motif”), we manually controlled each motif inference iteration observing the pdf files generated by the tool since the automated mode turned out to be prone to occasional motif collisions. For external datasets, we used the motifs discovered by the authors <italic toggle="yes">de novo</italic> (listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p>
      </sec>
      <sec>
        <title>2.4.3 Snapper</title>
        <p>Single-fast5 files obtained with “tombo resquiggle” were transformed to the multifast5 format to provide faster access to the sequencing raw signal data. These multifast5 files were processed using the python h5py library in order to collect signals for all <italic toggle="yes">k</italic>-mers presented in the considered genome for each strand independently. <italic toggle="yes">k</italic> was chosen to be 11 or higher (15 by default) in order to guarantee coverage of all 6-mers that cover an individual base (<xref rid="btad702-F1" ref-type="fig">Fig. 1A</xref>). Thus, at first the algorithm generates a hash-table, where all presented <italic toggle="yes">k</italic>-mers are used as keys and corresponding normalized signal levels as values.</p>
        <fig position="float" id="btad702-F1">
          <label>Figure 1.</label>
          <caption>
            <p>The principal scheme of the Snapper pipeline. In the first stage, for each <italic toggle="yes">k</italic>-mer in the reference genome (A and B), the algorithm collects normalized signal levels for this <italic toggle="yes">k</italic>-mer from multi-fast5 files for both native and WGA samples (here, <italic toggle="yes">k</italic> is chosen to be 11). Thereafter, for each <italic toggle="yes">k</italic>-mer presented in the genome, the algorithm directly compares the collected signal distributions (C) using the Kolmogorov–Smirnov test in order to select <italic toggle="yes">k</italic>-mers that most likely contain a modified base. The result of the first stage is an exhaustive set of all potentially modified <italic toggle="yes">k</italic>-mers (D). Next, the greedy motif enrichment algorithm implemented in Snapper iteratively extracts potential methylation motifs and calculates corresponding motif confidence levels (E). By default, motifs with confidence level &gt;5000 are considered as significant but the authors recommend manually verifying extracted motifs with confidence levels lower than 3000 especially while the observed signal shift is rather weak. The main recommendations on how to interpret the Snapper results are available in the user guide (<ext-link xlink:href="https://snapper-tutorial.readthedocs.io/en/latest/usercases.html#main-points" ext-link-type="uri">https://snapper-tutorial.readthedocs.io/en/latest/usercases.html#main-points</ext-link>)</p>
          </caption>
          <graphic xlink:href="btad702f1" position="float"/>
        </fig>
        <p>Next, for each <italic toggle="yes">k</italic>-mer in the hash-table, the Kolmogorov–Smirnov test is performed to compare signal level distributions between native and WGA samples (or, more generally, between any two samples passed as the input). Before the testing, the algorithm performs an artificial balancing of the sample sizes by random sampling (without replacement) of <italic toggle="yes">N</italic> values from each considered signal distribution to ensure the uniformity of the <italic toggle="yes">k</italic>-mers coverage (<italic toggle="yes">N</italic> was chosen to be 200). This balancing procedure is applied to make possible direct comparison of statistics values between <italic toggle="yes">k</italic>-mers, which are differently presented in the reference genome and to use the same statistics thresholds to infer modified positions along the genome. As a result, the algorithm returns the list of <italic toggle="yes">k</italic>-mers that are most likely to contain a modified base. In the further text, this list will be named <italic toggle="yes">seq_set</italic>. Simultaneously, the algorithm collects signal levels for long <italic toggle="yes">k</italic>-mers (with length of 29 by default). These long <italic toggle="yes">k</italic>-mers are used by the algorithm for additional motif refinement and enrichment of long motifs (mostly methylated by Type I R-M systems).</p>
        <p>The next step differs from the classical motif enrichment approaches like the tools included in the MEME Suit. We have implemented a highly sensitive greedy algorithm that is aimed to generate the minimal set of short supermotifs of length 4–8 that can explain most part of sequences in the <italic toggle="yes">seq_set</italic>, under the assumption that all sequences in the <italic toggle="yes">seq_set</italic> contain at least one modified base. The principal idea of the algorithm is iterative search for the most over-represented motif in the <italic toggle="yes">seq_set</italic> in comparison with a reference genome using the χ<sup>2</sup> statistics, extraction it as a potential modification motif, following procedure of motif adjustment, which additionally ensures the correctness and completeness of the extracted motif, and filtering the <italic toggle="yes">seq_set</italic> list by removing all sequences that contain the extracted motif variant. After the <italic toggle="yes">seq_set</italic> filtering, the search and extraction procedure repeats. The termination of the algorithm work is determined by the input parameters <italic toggle="yes">confidence</italic> and <italic toggle="yes">max_motifs</italic>, where the <italic toggle="yes">confidence</italic> parameter means the minimal value of χ<sup>2</sup> test statistic (the default value is 5000 to provide high sensitivity), and the <italic toggle="yes">max_motifs</italic> parameter means the maximum desired number of extracted modification motifs (the default value is 20). As a result, the algorithm returns a sorted list of all potential motifs with corresponding confidence levels (we observed that typical confidence values for known methylation motifs are higher than 3000). A more formal explanation of the motif enrichment algorithm is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S3</xref>.</p>
      </sec>
    </sec>
    <sec>
      <title>2.5 External data collection</title>
      <p>Raw FAST5-files for <italic toggle="yes">Thermacetogenium phaeum</italic> DSM 12270, <italic toggle="yes">Neisseria gonorrhoeae</italic> FA 1090, <italic toggle="yes">Methanospirillum hungatei</italic> JF-1, and <italic toggle="yes">Clostridium perfringens</italic> ATCC 13124 were downloaded from SRP219538.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Software description</title>
      <p>We have developed a novel high-sensitive algorithm for methylation motifs detecting based on Oxford Nanopore sequencing data. The algorithm has been implemented as a command-line tool called Snapper and is available as a pip package to install. To perform non-target methylome analysis, the tool requires native and control (obtained by WGA) DNA samples being sequenced and resquiggled using Tombo. Snapper uses a <italic toggle="yes">k</italic>-mer approach, with <italic toggle="yes">k</italic> chosen to be at least 11 to guarantee coverage of all 6-mers that cover one particular base (<xref rid="btad702-F1" ref-type="fig">Fig. 1A</xref>) under the assumption that, in general, ∼6 bases are located in the nanopore simultaneously (<xref rid="btad702-B20" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2021</xref>). By default, the <italic toggle="yes">k</italic> size is set to be 15 but can be tuned by the user. The raw signals data are extracted from the input fast5-files until the required minimal mean genome coverage depth is reached. The default value of the minimal coverage depth parameter was set to be 40×. This value was chosen since it showed a satisfactory convergence of the results on the external datasets, which will be described in detail below.</p>
      <p>The first stage of the Snapper pipeline is the extraction of nucleotide short <italic toggle="yes">k</italic>-mers (typical <italic toggle="yes">k</italic> = 11–15, must be odd), which are most likely to contain a modified base. The comparison of signal distributions <bold>(</bold><xref rid="btad702-F1" ref-type="fig">Fig. 1C</xref>) is performed using the Kolmogorov–Smirnov test statistics. Next, all the extracted <italic toggle="yes">k</italic>-mers (<xref rid="btad702-F1" ref-type="fig">Fig. 1D</xref>) are merged by a greedy algorithm, which generates the minimal set of potential modification motifs which can explain the most part of the selected <italic toggle="yes">k</italic>-mers (<xref rid="btad702-F1" ref-type="fig">Fig. 1E</xref>), under the assumption that all selected <italic toggle="yes">k</italic>-mers contain at least one modified base. Snapper uses negative background for enrichment, and χ<sup>2</sup> statistics is used to estimate a confidence level for the extracted motifs.</p>
      <p>We observed that the typical confidence level for known motifs is 3000 or greater. Actually, the lowest score for a methylation motif among all the datasets, we have analyzed was 2307 (GTGAC motif for <italic toggle="yes">H.pylori</italic> J99, will be described below). We decided to set 500 as the default threshold to ensure that the tool is sensitive enough even for detection of very low-represented methylation motifs. The authors understand that such a low-threshold value could result in false-positive inference, so in the cases when the confidence level is rather low (lower than 3000) the user is recommended to check the motif correctness using signal shift plots generated by the tool.</p>
      <p>The detailed algorithm explanation is available in Section 2 and <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S3</xref>. A short tool’s guideline is available on <ext-link xlink:href="https://snapper-tutorial.readthedocs.io" ext-link-type="uri">https://snapper-tutorial.readthedocs.io</ext-link>. All the source code is available on GitHub (<ext-link xlink:href="https://github.com/DNKonanov/Snapper" ext-link-type="uri">https://github.com/DNKonanov/Snapper</ext-link>).</p>
      <p>In order to verify the approach developed, firstly we performed the total methylome analysis of <italic toggle="yes">H.pylori</italic> J99 strain, which has been characterized earlier using competing long-read sequencing technology PacBio (<xref rid="btad702-B8" ref-type="bibr">Krebes <italic toggle="yes">et al.</italic> 2014</xref>). Additionally, we compared our method with instruments Tombo (<xref rid="btad702-B17" ref-type="bibr">Stoiber <italic toggle="yes">et al.</italic> 2016</xref>) and Nanodisco (<xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>), which are in our knowledge the most up-to-date tools capable of non-target methylation motifs profiling besides Snapper. To check the capability of Snapper to deal with species different from <italic toggle="yes">H.pylori</italic>, a few external datasets representing different bacterial taxa were analyzed.</p>
    </sec>
    <sec>
      <title>3.2 Total methylome analysis of <italic toggle="yes">H.pylori</italic> J99</title>
      <p>The genome of <italic toggle="yes">H.pylori</italic> J99 (genotype cagA+/vacA s1m1) encodes about 20 R-M systems of Types II and III (<xref rid="btad702-B1" ref-type="bibr">Alm <italic toggle="yes">et al.</italic> 1999</xref>). At least 14 out of them have been shown to be active earlier using the PacBio long-reads sequencing (<xref rid="btad702-B8" ref-type="bibr">Krebes <italic toggle="yes">et al.</italic> 2014</xref>). We performed the full Snapper pipeline (the minimum coverage depth parameter was set 100×, other parameters were set by default) and discovered the same set of motifs except TCNNGA (<xref rid="btad702-T1" ref-type="table">Table 1</xref>, ONT+Snapper column). We should note that in <xref rid="btad702-T1" ref-type="table">Table 1</xref>, we demonstrate just the Snapper’s raw output. You can see more details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S4</xref>. To verify the absence of TCNNGA motif, we manually observed a subset of genome contexts that contained this pattern and had a significant signal shift. We found that all such contexts contained other extracted motifs, such as GAGG, GATC, TCGA, and others. Thus, we concluded that despite the presence of TCNNGA in a number of methylated positions it is not an individual methylation motif in our J99 strain (more information about TCNNGA is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S5</xref>). In case of GTSAC and GWCAY motifs, we faced a certain ambiguity while motifs merging since GTCAC is a submotif for both these sites. Formally, such cases can be resolved only experimentally and it is the reason why we decided not to merge motifs automatically in the Snapper pipeline.</p>
      <table-wrap position="float" id="btad702-T1">
        <label>Table 1.</label>
        <caption>
          <p>Lists of J99 methylation motifs obtained using different methylation motif detection approaches.<xref rid="tblfn1" ref-type="table-fn"><sup>a</sup></xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">PacBio + MotifMaker</th>
              <th rowspan="1" colspan="1">ONT + Snapper (raw output)</th>
              <th rowspan="1" colspan="1">ONT + Tombo</th>
              <th rowspan="1" colspan="1">ONT + Nanodisco</th>
              <th rowspan="1" colspan="1">Total number in genome (±strand)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">GAGG</td>
              <td rowspan="1" colspan="1">GAGG</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GAGG</td>
              <td rowspan="1" colspan="1">2542/2462</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GTSAC</td>
              <td rowspan="1" colspan="1">GTCAC, GTGAC<xref rid="tblfn2" ref-type="table-fn"><sup>b</sup></xref></td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">104/104</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1">5499/5499</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">340/340</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CCGG</td>
              <td rowspan="1" colspan="1">CCGG</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CCGG</td>
              <td rowspan="1" colspan="1">1807/1807</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">426/426</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CCNNGG</td>
              <td rowspan="1" colspan="1">CCNNGG</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CCNNGG</td>
              <td rowspan="1" colspan="1">1193/1193</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GTAC</td>
              <td rowspan="1" colspan="1">GTAC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GTAC</td>
              <td rowspan="1" colspan="1">182/182</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CGWCG</td>
              <td rowspan="1" colspan="1">CGACG, CGTCG<xref rid="tblfn2" ref-type="table-fn"><sup>b</sup></xref></td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CGWCG</td>
              <td rowspan="1" colspan="1">264/264</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1">2756/2756</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">6104/6104</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">7567/7567</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GCCTA</td>
              <td rowspan="1" colspan="1">GCCTA</td>
              <td rowspan="1" colspan="1">GCCTA</td>
              <td rowspan="1" colspan="1">GCCTA</td>
              <td rowspan="1" colspan="1">1532/1532</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GWCAY</td>
              <td rowspan="1" colspan="1">GACAY, GTCAT, GTCAC<xref rid="tblfn2" ref-type="table-fn"><sup>b</sup></xref></td>
              <td rowspan="1" colspan="1">GACAC</td>
              <td rowspan="1" colspan="1">GWCAY</td>
              <td rowspan="1" colspan="1">2641/2464</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GGWCNA</td>
              <td rowspan="1" colspan="1">GGWCNA</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GGWCHA</td>
              <td rowspan="1" colspan="1">838/789</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">1949/1949</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <label>a</label>
            <p>It should be noted here that the column entitled Snapper contains just the raw Snapper output excluding few false-positive motifs that were removed after manual results observation. The raw Snapper output and the verification process of this particular case are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S1</xref>. The PacBio results for <italic toggle="yes">H.pylori</italic> J99 were taken from the work of <xref rid="btad702-B8" ref-type="bibr">Krebes <italic toggle="yes">et al.</italic> (2014)</xref> directly (with few changes since the authors considered not the wild J99 strain but the J99-3 mutant). For Tombo, the best results that we managed to obtain with MEME are shown. For Nanodisco, the manually curated results are shown since the results generated in the automated mode were drastically less accurate.</p>
          </fn>
          <fn id="tblfn2">
            <label>b</label>
            <p>These motifs were extracted as different because the algorithm is designed to be quite cautious in motifs merging to prevent occasional motif collisions.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Additionally, we analyzed <italic toggle="yes">H.pylori</italic> J99 ONT reads using Tombo and Nanodisco tools, which are mainly designed at methylated position profiling but have their own motif enrichment functionality as well. Tombo uses the default MEME motif enrichment algorithm (<xref rid="btad702-B2" ref-type="bibr">Bailey <italic toggle="yes">et al.</italic> 2015</xref>) to extract motifs, so it has demonstrated rather low sensitivity and has inferred only five motifs highly represented in the genome (<xref rid="btad702-T1" ref-type="table">Table 1</xref>, ONT+Tombo column). Nanodisco also performs motif enrichment with MEME but uses an iterative approach that allows to detect more methylation sites but requires manual control on each motif extraction iteration because as we found in the fully automated mode Nanodisco is strongly prone to excessive motif collisions and even the most-represented motifs, such as CATG and GCGC, are not correctly discovered automatically and merged to GCRYG. Manually curated Nanodisco results are quite close to the automated Snapper output and the PacBio results except GTSAC and TCGA motifs (<xref rid="btad702-T1" ref-type="table">Table 1</xref>, ONT+Nanodisco column). Both these motifs are rather rare in the J99 genome, so the MEME algorithm did not identify them being enriched even using an iterative approach since Nanodisco uses the default MEME objective function without negative background (according to the Nanodisco source code). In the reference article, the authors also emphasize that GTAC has not been discovered in <italic toggle="yes">de novo</italic> mode due to the same reason. In Snapper, a set of all possible <italic toggle="yes">k</italic>-mers presented in the considered genome is used as a negative background, which simplifies the identification of rare motifs.</p>
    </sec>
    <sec>
      <title>3.3 External FAST5 datasets analysis</title>
      <p>Actually, the only dataset, which was used during the development of the core Snapper logic was <italic toggle="yes">H.pylori</italic> J99. To ensure that Snapper is not “overfitted” on <italic toggle="yes">H.pylori</italic> data, we downloaded external pair datasets containing WGA and native reads in FAST5-format for four different bacteria with highest number of different methylation motifs available in SRP219538 (<xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>): <italic toggle="yes">T.phaeum</italic> DSM 12270 (8 motifs), <italic toggle="yes">N.gonorrhoeae</italic> FA 1090 (8 motifs), <italic toggle="yes">M.hungatei</italic> JF-1 (6 motifs), and <italic toggle="yes">C.perfringens</italic> ATCC 13124 (6 motifs). <italic toggle="yes">Helicobacter pylori</italic> JP26 was not downloaded since here, we intentionally checked how the method works with non-<italic toggle="yes">H.pylori</italic> data. The genome coverage depth for each sample is listed in <xref rid="btad702-T2" ref-type="table">Table 2</xref>.</p>
      <table-wrap position="float" id="btad702-T2">
        <label>Table 2.</label>
        <caption>
          <p>The genome coverage depth, used in the methylome analysis of the four bacteria from external datasets.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Dataset</th>
              <th rowspan="1" colspan="1">Native DNA coverage depth used</th>
              <th rowspan="1" colspan="1">WGA DNA coverage depth used</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">Thermacetogenium phaeum</italic> DSM 12270</td>
              <td rowspan="1" colspan="1">31×<xref rid="tblfn3" ref-type="table-fn"><sup>a</sup></xref></td>
              <td rowspan="1" colspan="1">43×</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">Neisseria gonorrhoeae</italic> FA 1090</td>
              <td rowspan="1" colspan="1">44×</td>
              <td rowspan="1" colspan="1">41×</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">Methanospirillum hungatei</italic> JF-1</td>
              <td rowspan="1" colspan="1">43×</td>
              <td rowspan="1" colspan="1">41×</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"><italic toggle="yes">Clostridium perfringens</italic> ATCC 13124</td>
              <td rowspan="1" colspan="1">42×</td>
              <td rowspan="1" colspan="1">41×</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <label>a</label>
            <p>All available reads were used.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>FAST5-files were resquiggled using Tombo and processed with Snapper with the default parameters. The results were almost identical to the reference REBASE motifs described for these strains except one long motif CACNNNNNRTAAA, which was inferred by Snapper as CACNNNNNATAAA (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). We manually checked the motif correctness and did not find significant signal shift for CACNNNNNGTAAA variant.</p>
      <p>Few inaccuracies in motif identification were caused by motif collisions. Thus, in <italic toggle="yes">M.hungatei</italic> JF-1, which actually has AGCT and GCYYGAT motifs, Snapper identified AGCT, GCCTGAT, GCCCGAT, BGCTCGAT, and BGCTTGAC motif sequences. Here, AGCT had been extracted earlier that led to omitting AGCTCGAT and AGCTTGAC variants, and GCYYGAT motif was extracted formally incomplete. Generally, the algorithm cannot resolve such collisions without additional information and does not try to merge them to prevent results ambiguity. The same problem appeared in <italic toggle="yes">N.gonorrhoeae</italic> FA 1090, where RGCGCY motif was extracted incompletely since its GGCGCC subvariant intersected with GGNNCC motif sequence extracted first, so the Snapper output included only GGNNCC, AGCGCC, AGCGCT, and GGCGCT sequences but not GGCGCC.</p>
      <p>Interestingly, Snapper inferred a few methylation sites that were not mentioned in the reference article (<xref rid="btad702-B18" ref-type="bibr">Tourancheau <italic toggle="yes">et al.</italic> 2021</xref>). Thus, we observed significant signal shift and quite high confidence level for CCAG and TGGCCA motifs in <italic toggle="yes">T.phaeum</italic> DSM 12270. Both these motifs were independently approved using Nanodisco software in manual mode using the “motif refine” command (motif refinement plots are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S6</xref>). The WGGCCW motif not mentioned in the reference article was found in <italic toggle="yes">C.perfringens</italic> ATCC 13124.</p>
      <p>Also, we analyzed the methylome of the four chosen bacteria with Tombo. Here, to detect methylated positions, all available data were used. We tried to use different parameters for both Tombo processing (the <italic toggle="yes">k</italic>-mer size, the number of extracted sequences) and MEME motif enrichment (the objective function, mode) but have managed to identify only two correct motifs for <italic toggle="yes">T.phaeum</italic> DSM 12270, and one correct motif for three other bacteria. The detected motifs are presented in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>. Probably, the iterative approach similar to implemented in Nanodisco would provide better results but we intentionally tried to follow only the instructions from the Tombo’s documentation.</p>
    </sec>
    <sec>
      <title>3.4 Total methylome analysis of <italic toggle="yes">H.pylori</italic> A45 and mutants</title>
      <p>The <italic toggle="yes">H.pylori</italic> A45 (genotype cagA-/vacA s2m2) clinical isolate was obtained previously from a gastric mucosa biopsy sample from a patient with a gastric carcinoma (<xref rid="btad702-B11" ref-type="bibr">Momynaliev 2009</xref>). In addition, the derivatives of the A45 strain of <italic toggle="yes">H.pylori</italic>, defective in MTase genes M.HpyAI (<italic toggle="yes">hpy</italic> mutant), M.HpyAIII (<italic toggle="yes">hp91/92</italic> mutant), and M.HpyAIV (<italic toggle="yes">hp1352</italic> mutant) were obtained (<xref rid="btad702-B11" ref-type="bibr">Momynaliev 2009</xref>). As well as for <italic toggle="yes">H.pylori</italic> J99, here, we set the minimal genome coverage parameter as 100×. For the native sample the tool collected raw signals with the coverage depth of 101× but the control sample had the mean coverage of 61× due to lower sequencing depth.</p>
      <p>The analysis of <italic toggle="yes">H.pylori</italic> A45 has revealed presence of 15 methylation sites belonging to R-M systems of types II and III: ATTAAT, GTNNAC, GGRGA, CCATC, CATG, CCAG, GCGC, GANTC, GATC, GGCC, GAAC, TGCA, TCGA, TCNGA, and TCNNGA (<xref rid="btad702-T3" ref-type="table">Table 3</xref>, wild-type column). Interestingly, opposite to the <italic toggle="yes">H.pylori</italic> J99 analysis, in this case, all the extracted motifs had quite high confidence levels &gt;3000 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Material S7</xref>). Despite that, we manually observed signal distributions for all suggested sites and their closest genome context to ensure that all motifs had been extracted correctly.</p>
      <table-wrap position="float" id="btad702-T3">
        <label>Table 3.</label>
        <caption>
          <p>Methylation motifs detected in the wild A45 and four mutants.<xref rid="tblfn4" ref-type="table-fn"><sup>a</sup></xref></p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Wild-type</th>
              <th rowspan="1" colspan="1">Total number in genome (+/− strand)</th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">hpy</italic>
              </th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">hp1352</italic>
              </th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">hp91/92</italic>
              </th>
              <th rowspan="1" colspan="1">
                <italic toggle="yes">hp944</italic>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">441/441</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
              <td rowspan="1" colspan="1">ATTAAT</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GTNNAC</td>
              <td rowspan="1" colspan="1">325/325</td>
              <td rowspan="1" colspan="1">GTNNAC</td>
              <td rowspan="1" colspan="1">GTNNAC</td>
              <td rowspan="1" colspan="1">GTNNAC</td>
              <td rowspan="1" colspan="1">GTNNAC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GGRGA</td>
              <td rowspan="1" colspan="1">1768/1790</td>
              <td rowspan="1" colspan="1">GGRGA</td>
              <td rowspan="1" colspan="1">GGRGA</td>
              <td rowspan="1" colspan="1">GGRGA</td>
              <td rowspan="1" colspan="1">GGRGA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CCATC</td>
              <td rowspan="1" colspan="1">1163/1115</td>
              <td rowspan="1" colspan="1">CCATC</td>
              <td rowspan="1" colspan="1">CCATC</td>
              <td rowspan="1" colspan="1">CCATC</td>
              <td rowspan="1" colspan="1">CCATC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">7246/7246</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
              <td rowspan="1" colspan="1">CATG</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CCAG</td>
              <td rowspan="1" colspan="1">2173/2271</td>
              <td rowspan="1" colspan="1">CCAG</td>
              <td rowspan="1" colspan="1">CCAG</td>
              <td rowspan="1" colspan="1">CCAG</td>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">5982/5982</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
              <td rowspan="1" colspan="1">GCGC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1">2625/2625</td>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GANTC</td>
              <td rowspan="1" colspan="1">GANTC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1">5113/5113</td>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1">GATC</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GATC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GGCC</td>
              <td rowspan="1" colspan="1">1534/1534</td>
              <td rowspan="1" colspan="1">GGCC</td>
              <td rowspan="1" colspan="1">GGCC</td>
              <td rowspan="1" colspan="1">GGCC</td>
              <td rowspan="1" colspan="1">GGCC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GAAC</td>
              <td rowspan="1" colspan="1">2760/2700</td>
              <td rowspan="1" colspan="1">GAAC</td>
              <td rowspan="1" colspan="1">GAAC</td>
              <td rowspan="1" colspan="1">GAAC</td>
              <td rowspan="1" colspan="1">GAAC</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TGCA</td>
              <td rowspan="1" colspan="1">5770/5770</td>
              <td rowspan="1" colspan="1">TGCA</td>
              <td rowspan="1" colspan="1">TGCA</td>
              <td rowspan="1" colspan="1">TGCA</td>
              <td rowspan="1" colspan="1">TGCA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">290/290</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">TCGA</td>
              <td rowspan="1" colspan="1">TCGA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCNGA</td>
              <td rowspan="1" colspan="1">1224/1224</td>
              <td rowspan="1" colspan="1">TCNGA</td>
              <td rowspan="1" colspan="1">TCNGA</td>
              <td rowspan="1" colspan="1">TCNGA</td>
              <td rowspan="1" colspan="1">TCNGA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1">1926/1926</td>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1">TCNNGA</td>
              <td rowspan="1" colspan="1">TCNNGA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">3403/3267</td>
              <td rowspan="1" colspan="1">CCAAK</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">CCAAK</td>
              <td rowspan="1" colspan="1"/>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn4">
            <label>a</label>
            <p>Interestingly, in the <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic> mutants an additional CCAAK methylation motif is observed.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>To identify the MTases responsible for methylation of new sites CCAG, GGRGA, and GAAC not described earlier for <italic toggle="yes">H.pylori</italic>, which were presented in <italic toggle="yes">H.pylori</italic> A45 and absent in <italic toggle="yes">H.pylori</italic> J99, all candidate MTase genes were extracted from both genomes and used to construct a phylogenetic tree based on protein sequences similarity. Two proteins that were presented only in <italic toggle="yes">H.pylori</italic> A45 strain and did not have orthologous genes in <italic toggle="yes">H.pylori</italic> J99 were considered as potentially new MTases. Two new <italic toggle="yes">H.pylori</italic> A45 derived mutants (<italic toggle="yes">hp8</italic> and <italic toggle="yes">hp944</italic>) disrupted in corresponding genes hp0008 and hp0944 were obtained during this work. Their native DNA was analyzed using ONT and the sequencing data were processed using Snapper. The <italic toggle="yes">hp8</italic> mutant did not have any signal changes, but in the <italic toggle="yes">hp944</italic> mutant we observed a successful deactivation of CCAG-specific MTase (<xref rid="btad702-T3" ref-type="table">Table 3</xref>, <italic toggle="yes">hp944</italic> column). As we found later, the negative result for <italic toggle="yes">hp8</italic> was caused by a nonsense mutation in the MTase gene in the wild A45.</p>
      <p>Here, to estimate the method specificity, in addition to the wild-type, we analyzed three mutants of <italic toggle="yes">H.pylori</italic> A45 disrupted in three different genes encoding MTases with known specificity (<italic toggle="yes">hpy</italic>, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp91/92</italic> mutants disrupted in the genes of MTases specific to CATG, GANTC, and GATC motifs, respectively). Here, we used as a control not the WGA sample but the native A45 to check out how the algorithm works with a small number of motifs that differ by their signal level. We expected the algorithm to extract only one motif for each mutant, but two mutants had an additional motif that seemed to be modified. Firstly, in all three mutants Snapper successfully detected the absence of methylation of the corresponding motifs (<xref rid="btad702-T3" ref-type="table">Table 3</xref>, <italic toggle="yes">hpy</italic>, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp91/92</italic> columns, and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). Secondly, the CCAAK site was detected as methylated in <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic> mutants while the native sample, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp944</italic> had CCAAK signal distributions identical to the WGA sample (<xref rid="btad702-F2" ref-type="fig">Fig. 2A</xref>).</p>
      <fig position="float" id="btad702-F2">
        <label>Figure 2.</label>
        <caption>
          <p>CCAAK-specific MTase inference. (A) Normalized signal distributions for the CCAAK methylation site. <italic toggle="yes">hp91/92</italic> and <italic toggle="yes">hpy</italic> mutants have a visible signal shift in comparison with the WGA sample while the wild A45 and the <italic toggle="yes">hp1352</italic> mutant have signal distributions identical to the WGA sample. (B) Wild A45 and the <italic toggle="yes">hp1352</italic> mutant have CCAAK-specific MTase gene broken because of a frame-shift insertion in a homopolymeric region in the gene. The reverse frame-shift mutation in the MTase gene restores the Type III R-M system activity in <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic></p>
        </caption>
        <graphic xlink:href="btad702f2" position="float"/>
      </fig>
      <p>To identify the MTase responsible for modification of CCAAK, we used non-target proteomics data that were obtained earlier for the wild A45 and <italic toggle="yes">hpy</italic>, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp91/92</italic> mutants (the procedure is described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material S14</xref>). Five proteins that were significantly over-represented (LFC≥5) in <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic> mutants in comparison to the wild-type and <italic toggle="yes">hp1352</italic> were found and manually annotated using BLASTP (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S11 and S12</xref>). Proteins encoded by hp0008 and hp0009 genes were annotated as two fragments of one MTase gene, and gene hp0010 was annotated as a Type III R-M system endonuclease, so, these three genes encode a full Type III R-M system but with a broken MTase gene. The appearance of the CCAAK methylation site in <italic toggle="yes">hpy</italic> and <italic toggle="yes">hp91/92</italic> was caused by a reverse frame-shift mutation in a homopolymeric region in hp0008 gene, which was confirmed by short Illumina reads (<xref rid="btad702-F2" ref-type="fig">Fig. 2B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>).</p>
      <p>Additionally, we checked the coverage depth required for extraction of two non-overlapped motifs (the <italic toggle="yes">hpy</italic> mutant, CATG and CCAAK motifs). The tool extracted these motifs correctly with mean coverage depth of 14× (∼20 000 reads per sample).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Oxford Nanopore sequencing has a great potential for the analysis of epigenetic modifications of the four canonical bases. Unfortunately, the current software designed for methylation site detection possesses certain drawbacks. Thus, both Tombo and Nanodisco provide high-quality profiling of methylated positions in a genome but the main problem here is to accurately generate a set of potential motifs that could explain all methylated bases. Technically, it is a classical motif enrichment task, but classical approaches have proven to be insufficiently sensitive for analyzing highly methylated genomes, such as the <italic toggle="yes">H.pylori</italic> genome. Thus, we found that the most widely used tool suit MEME is capable of detecting only highly represented motifs. An iterative approach implemented in Nanodisco is more sensitive but requires a lot of manual work while extracting motifs, which limits its applicability when more than few genomes are studied.</p>
    <p>We have developed a new greedy algorithm that is aimed at high-sensitive motif enrichment. This algorithm has been implemented as the command-line tool Snapper. Here, we have shown that, firstly, as a fully automated pipeline, Snapper outperforms both Tombo and Nanodisco coupled with the MEME tool and, secondly, Snapper is capable of detecting methylation site sequences with sensitivity equivalent to the PacBio technology and is slightly more sensitive than Nanodisco in the manual mode. In contrast to Nanodisco, Snapper provides a fully automated motif extraction algorithm and requires manual results verification only during adjustment of motifs with a low confidence level.</p>
    <p>We should note again that Snapper must not be considered as an alternative to MEME since MEME has been developed as a universal approach and can deal with any type of data, while Snapper uses special search heuristics aimed at finding methylation motifs specifically. These heuristics narrow the search space, and as a result, the algorithm can provide higher enrichment sensitivity.</p>
    <p>Another feature we should note is an intended algorithm cautiousness in motifs merging to avoid occasional motif collisions. Thus, the <italic toggle="yes">H.pylori J99</italic> analysis has shown the presence of motifs GTCAT, GTCAC, GACAY, and GTGAC as methylated. Actually, these submotifs are explained by GWCAY and GTSAC methylation sites but GWCAY+GTGAC variant is formally possible as well. Such cases can be resolved only experimentally so we decided not to merge controversial motifs in the Snapper motif extraction algorithm. A related problem with motif sequences resolving appeared in the <italic toggle="yes">M.hungatei</italic> JF-1 analysis results, which actually has AGCT and GCYYGAT methylation sites but Snapper’s output included AGCT, GCCCGAT, GCCTGAT, BGCTCGAT, and BGCTTGAC (“B” means “not A”). Indeed, the last two motif subvariants were inferred after AGCT had been inferred. Therefore, the algorithm had already explained AGCTCGAT and AGCTTGAC subvariants by the presence of AGCT. Thus, although the algorithm is formally fully automated, some cases should be considered manually.</p>
    <p>Since Snapper aims not at the methylated positions calling but methylation motif sequences, it is relatively less demanding on the input data compared with Nanodisco or Tombo. The genome coverage required for the analysis depends on the object of interest. Thus, while analyzing organisms that have very few different non-overlapped methylation sites, the method can work well even with a mean genome coverage of 15–20×. On the other hand, for organisms with higher number of different methylatinon sites Snapper requires higher sequencing coverage to more accurately resolve similar motif sequences. The authors suggest that, in most cases, coverage of 80–100× is absolutely enough for high-accurate methylation motifs detection. On the other hand, since Snapper is not aimed to detect modified positions and predict the modification type, the authors recommend using Nanodisco for these purposes after the target motif sequences have been identified.</p>
    <p>Using Snapper, we fully characterized the methylome of a new <italic toggle="yes">H.pylori</italic> strain A45. In this strain, we found three methylation sites that have not been described earlier for <italic toggle="yes">H.pylori</italic> (GGRGA, GAAC, and CCAG) and managed to experimentally confirm the MTase specific to CCAG. In addition, during the experiment, we observed a frame-shift-based phase variation in the gene encoding a new MTase specific to CCAAK methylation site. Thus, we did not observe this site being methylated in the wild A45 culture but it appeared after the disruption in CATG-specific MTase or GATC-specific MTase. In both cases, it was caused by the same reverse frame-shift mutation in a homopolymeric region in the gene encoding corresponding MTase. Such a behavior is quite typical for <italic toggle="yes">H.pylori</italic> and is often used to regulate activity of particular MTase genes (<xref rid="btad702-B3" ref-type="bibr">Beaulaurier <italic toggle="yes">et al.</italic> 2015</xref>).</p>
    <p>As an additional verification, we analyzed four external datasets representing different bacterial taxa. In all cases, Snapper discovered all methylation motif sequences that had been shown for these bacteria according to the REBASE database and few additional motifs, which has illustrated the versatility of the method. However, we observed few problems with motif sequences resolving (as the AGCT and GCYYGAT collision mentioned above), especially in highly methylated organisms, so we cannot declare that Snapper’s results can always be used as is and should be additionally curated by a user.</p>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>We have developed Snapper—a tool for high-sensitive methylation motifs identification. Snapper has been shown to be more sensitive than MEME coupled with the Tombo software. Snapper demonstrated slightly higher motif detection accuracy compared to Nanodisco and did not require extensive manual work during the motif extraction procedure, unlike Nanodisco. Snapper was tested in detail on data obtained in this study as well as on a few external datasets. Using Snapper, we characterized the methylation motifs in a new <italic toggle="yes">H.pylori</italic> A45 strain and discovered four motif sequences that have not been described for <italic toggle="yes">H.pylori</italic> earlier. We managed to experimentally confirm a gene encoding a new CCAG-specific MTase and inferred a gene encoding CCAAK-specific MTase.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad702_Supplementary_Data</label>
      <media xlink:href="btad702_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the Center for Precision Genome Editing and Genetic Technologies for Biomedicine, Federal Research and Clinical Center of Physical–Chemical Medicine of the Federal Medical Biological Agency for providing computational resources for this project. <italic toggle="yes">Helicobacter pylori</italic> J99 strain (No. 700824, cagA+/vacA s1m1 genotype) was kindly provided by Prof. M. Achtman (Max Planck Institute for Infection Biology, Germany). <italic toggle="yes">Helicobacter pylori</italic> A45 and <italic toggle="yes">hpy</italic>, <italic toggle="yes">hp1352</italic>, and <italic toggle="yes">hp91/92</italic> mutants were kindly provided by Dr K.T. Momynaliev.</p>
  </ack>
  <sec>
    <title>Author contributions</title>
    <p>D.N.K. and V.V.B. led the project, wrote the manuscript text, and prepared all the figures and supplementary data; D.N.K. designed and implemented the main algorithms and performed <italic toggle="yes">Helicobacter pylori</italic> A45 and J99 methylome analysis; A.M.B. wrote the manuscript text, realized cell culture procedures, and prepared <italic toggle="yes">Helicobacter pylori hp8</italic> and <italic toggle="yes">hp944</italic> mutant strains; A.G.M. performed Nanodisco analysis; A.G.M. and D.V.K. helped with multiprocessing implementation; O.E.G. ran Tombo and helped with methylation analysis; I.O.B. performed proteomics experiments; D.E.F. and A.I.M. processed the proteomics data; A.I.M. and V.V.B. carried out genomic data analysis; V.V.B. and D.I.B. performed genome sequencing; V.N.L., V.M.G., and E.N.I. administered the project; and E.N.I. edited the manuscript.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work did not receive any financial support from commercial or non-commercial organizations.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All the source code is available on Github (<ext-link xlink:href="https://github.com/DNKonanov/Snapper" ext-link-type="uri">https://github.com/DNKonanov/Snapper</ext-link>). Fastq files are available in SRA (NCBI Bioproject accession number PRJNA175046). The mass spectrometry proteomics data have been deposited to the ProteomeXchange Consortium via the PRIDE (<xref rid="btad702-B13" ref-type="bibr">Perez-Riverol <italic toggle="yes">et al.</italic> 2019</xref>) partner repository with the dataset identifier PXD038899 (access for the reviewers: login reviewer <email>pxd038899@ebi.ac.uk</email>, password—xOuk64qK). All genome assemblies obtained during this study are available in GenBank (<italic toggle="yes">Helicobacter pylori</italic> A45 wild-type: GCA 000333835.2, <italic toggle="yes">hpy</italic>: GCA 013122115.1, <italic toggle="yes">hp1352</italic>: GCA 013122055.1, <italic toggle="yes">hp91/92</italic>: GCA 013122035.1). External fast5-files used in this study were downloaded from SRP219538. Additionally, we provide a small fast5 example dataset in order to demonstrate the tool capabilities. The demo-dataset includes 10 + 10 preprocessed multi-fast5 files containing 40 000 long reads for the hpy mutant and 40 000 reads for the wild A45 as a control (<ext-link xlink:href="http://download.ripcm.com/snapper_test" ext-link-type="uri">http://download.ripcm.com/snapper_test</ext-link>). Both Snapper tool and the demo dataset are available in Zenodo (10.5281/zenodo.10117651).</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad702-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alm</surname><given-names>RA</given-names></string-name>, <string-name><surname>Ling</surname><given-names>LS</given-names></string-name>, <string-name><surname>Moir</surname><given-names>DT</given-names></string-name></person-group><etal>et al</etal><article-title>Genomic-sequence comparison of two unrelated isolates of the human gastric pathogen <italic toggle="yes">Helicobacter pylori</italic></article-title>. <source>Nature</source><year>1999</year>;<volume>397</volume>:<fpage>176</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">9923682</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bailey</surname><given-names>TL</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>J</given-names></string-name>, <string-name><surname>Grant</surname><given-names>CE</given-names></string-name></person-group><etal>et al</etal><article-title>The meme suite</article-title>. <source>Nucleic Acids Res</source><year>2015</year>;<volume>43</volume>:<fpage>W39</fpage>–<lpage>49</lpage>.<pub-id pub-id-type="pmid">25953851</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beaulaurier</surname><given-names>J, Zhang X, Zhu S</given-names></string-name></person-group><etal>et al</etal><article-title>Single molecule-level detection and long read-based phasing of epigenetic variations in bacterial methylomes</article-title>. <source>Nat Commun</source><year>2015</year>;<volume>6</volume>:<fpage>7438</fpage>.<pub-id pub-id-type="pmid">26074426</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Belova</surname><given-names>AM</given-names></string-name>, <string-name><surname>Basmanov</surname><given-names>DV</given-names></string-name>, <string-name><surname>Prusakov</surname><given-names>KA</given-names></string-name></person-group><etal>et al</etal><article-title>A microfluidic platform for the development of a biosensor based on genetically modified <italic toggle="yes">Helicobacter pylori</italic> single cells</article-title>. <source>Biophysics</source><year>2018</year>;<volume>63</volume>:<fpage>735</fpage>–<lpage>42</lpage>.</mixed-citation>
    </ref>
    <ref id="btad702-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gorrell</surname><given-names>R</given-names></string-name>, <string-name><surname>Kwok</surname><given-names>T.</given-names></string-name></person-group><article-title>The <italic toggle="yes">Helicobacter pylori</italic> methylome: roles in gene regulation and virulence</article-title>. <source>Curr Top Microbiol Immunol</source><year>2017</year>;<volume>400</volume>:<fpage>105</fpage>–<lpage>27</lpage>.<pub-id pub-id-type="pmid">28124151</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hofreuter</surname><given-names>D</given-names></string-name>, <string-name><surname>Odenbreit</surname><given-names>S</given-names></string-name>, <string-name><surname>Haas</surname><given-names>R.</given-names></string-name></person-group><article-title>Natural transformation competence in <italic toggle="yes">Helicobacter pylori</italic> is mediated by the basic components of a type IV secretion system</article-title>. <source>Mol Microbiol</source><year>2001</year>;<volume>41</volume>:<fpage>379</fpage>–<lpage>91</lpage>.<pub-id pub-id-type="pmid">11489125</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jain</surname><given-names>M</given-names></string-name>, <string-name><surname>Olsen</surname><given-names>HE</given-names></string-name>, <string-name><surname>Paten</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>The Oxford Nanopore MinION: delivery of nanopore sequencing to the genomics community</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>239</fpage>.<pub-id pub-id-type="pmid">27887629</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krebes</surname><given-names>J</given-names></string-name>, <string-name><surname>Morgan</surname><given-names>RD</given-names></string-name>, <string-name><surname>Bunk</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>The complex methylome of the human gastric pathogen <italic toggle="yes">Helicobacter pylori</italic></article-title>. <source>Nucleic Acids Res</source><year>2014</year>;<volume>42</volume>:<fpage>2415</fpage>–<lpage>32</lpage>.<pub-id pub-id-type="pmid">24302578</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Georgieva</surname><given-names>DC</given-names></string-name>, <string-name><surname>Egli</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>NanoMod: a computational tool to detect DNA modifications using Nanopore long-read sequencing data</article-title>. <source>BMC Genomics</source><year>2019</year>;<volume>20</volume>:<fpage>78</fpage>.<pub-id pub-id-type="pmid">30712508</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Rosikiewicz</surname><given-names>W</given-names></string-name>, <string-name><surname>Pan</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>DNA methylation-calling tools for Oxford Nanopore sequencing: a survey and human epigenome-wide evaluation</article-title>. <source>Genome Biol</source><year>2021</year>;<volume>22</volume>:<fpage>295</fpage>.<pub-id pub-id-type="pmid">34663425</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Momynaliev</surname><given-names>KT.</given-names></string-name></person-group> Genomno-proteomnaya Kharakteristika Variabelnosti <italic toggle="yes">Helicobacter Pylori</italic> [Genomic and proteomic characteristics of the <italic toggle="yes">Helicobacter pylori</italic> variability]. Ph.D. Thesis, Moscow, Russia, <year>2009</year>.</mixed-citation>
    </ref>
    <ref id="btad702-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ni</surname><given-names>P</given-names></string-name>, <string-name><surname>Huang</surname><given-names>N</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>DeepSignal: detecting DNA methylation state from Nanopore sequencing reads using deep-learning</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>4586</fpage>–<lpage>95</lpage>.<pub-id pub-id-type="pmid">30994904</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Perez-Riverol</surname><given-names>Y</given-names></string-name>, <string-name><surname>Csordas</surname><given-names>A</given-names></string-name>, <string-name><surname>Bai</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>The PRIDE database and related tools and resources in 2019: improving support for quantification data</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>D442</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">30395289</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roberts</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Vincze</surname><given-names>T</given-names></string-name>, <string-name><surname>Posfai</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>REBASE—a database for DNA restriction and modification: enzymes, genes and genomes</article-title>. <source>Nucleic Acids Res</source><year>2015</year>;<volume>43</volume>:<fpage>D298</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">25378308</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B15">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Sambrook</surname><given-names>J, Fritsch EF, Maniatis T.</given-names></string-name></person-group><source>Molecular Cloning: A Laboratory Manual</source>. <edition>2nd edn</edition>. <publisher-loc>New York</publisher-loc>: <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>, <year>1989</year>.</mixed-citation>
    </ref>
    <ref id="btad702-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Seemann</surname><given-names>T.</given-names></string-name></person-group><article-title>Prokka: rapid prokaryotic genome annotation</article-title>. <source>Bioinformatics</source><year>2014</year>;<volume>30</volume>:<fpage>2068</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24642063</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Stoiber</surname><given-names>M, Quick J, Egan R</given-names></string-name></person-group><etal>et al</etal> De novo identification of DNA modifications enabled by genome-guided nanopore signal processing. bioRxiv, 094672, <year>2016</year>, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="btad702-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tourancheau</surname><given-names>A</given-names></string-name>, <string-name><surname>Mead</surname><given-names>EA</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>X-S</given-names></string-name></person-group><etal>et al</etal><article-title>Discovering multiple types of DNA methylation from bacteria and microbiome using nanopore sequencing</article-title>. <source>Nat Methods</source><year>2021</year>;<volume>18</volume>:<fpage>491</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">33820988</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wick</surname><given-names>RR</given-names></string-name>, <string-name><surname>Judd</surname><given-names>LM</given-names></string-name>, <string-name><surname>Gorrie</surname><given-names>CL</given-names></string-name></person-group><etal>et al</etal><article-title>Completing bacterial genome assemblies with multiplex MinION sequencing</article-title>. <source>Microb Genom</source><year>2017</year>;<volume>3</volume>:<fpage>e000132</fpage>.<pub-id pub-id-type="pmid">29177090</pub-id></mixed-citation>
    </ref>
    <ref id="btad702-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>H</given-names></string-name>, <string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Jain</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Real-time mapping of nanopore raw signals</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>i477</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">34252938</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
