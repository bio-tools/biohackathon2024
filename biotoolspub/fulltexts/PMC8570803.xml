<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8570803</article-id>
    <article-id pub-id-type="pmid">34196689</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab459</article-id>
    <article-id pub-id-type="publisher-id">btab459</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>JBrowseR: an R interface to the JBrowse 2 genome browser</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2068-3366</contrib-id>
        <name>
          <surname>Hershberg</surname>
          <given-names>Elliot A</given-names>
        </name>
        <aff><institution>Department of Bioengineering, University of California</institution>, Berkeley, Berkeley, CA 94720, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9781-5323</contrib-id>
        <name>
          <surname>Stevens</surname>
          <given-names>Garrett</given-names>
        </name>
        <aff><institution>Department of Bioengineering, University of California</institution>, Berkeley, Berkeley, CA 94720, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Diesh</surname>
          <given-names>Colin</given-names>
        </name>
        <aff><institution>Department of Bioengineering, University of California</institution>, Berkeley, Berkeley, CA 94720, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xie</surname>
          <given-names>Peter</given-names>
        </name>
        <aff><institution>Department of Bioengineering, University of California</institution>, Berkeley, Berkeley, CA 94720, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>De Jesus Martinez</surname>
          <given-names>Teresa</given-names>
        </name>
        <aff><institution>Department of Bioengineering, University of California</institution>, Berkeley, Berkeley, CA 94720, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Buels</surname>
          <given-names>Robert</given-names>
        </name>
        <aff><institution>Department of Bioengineering, University of California</institution>, Berkeley, Berkeley, CA 94720, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stein</surname>
          <given-names>Lincoln</given-names>
        </name>
        <aff><institution>Adaptive Oncology, Ontario Institute for Cancer Research</institution>, Toronto, ON M5G 0A3, <country country="CA">Canada</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Holmes</surname>
          <given-names>Ian</given-names>
        </name>
        <aff><institution>Department of Bioengineering, University of California</institution>, Berkeley, Berkeley, CA 94720, <country country="US">USA</country></aff>
        <xref rid="btab459-cor1" ref-type="corresp"/>
        <!--ihh@berkeley.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alkan</surname>
          <given-names>Can</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab459-cor1">To whom correspondence should be addressed. <email>ihh@berkeley.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-07-01">
      <day>01</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>21</issue>
    <fpage>3914</fpage>
    <lpage>3915</lpage>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>07</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>18</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab459.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Genome browsers are an essential tool in genome analysis. Modern genome browsers enable complex and interactive visualization of a wide variety of genomic data modalities. While such browsers are very powerful, they can be challenging to configure and program for bioinformaticians lacking expertise in web development.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We have developed an R package that provides an interface to the JBrowse 2 genome browser. The package can be used to configure and customize the browser entirely with R code. The browser can be deployed from the R console, or embedded in Shiny applications or R Markdown documents.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>JBrowseR is available for download from CRAN, and the source code is openly available from the Github repository at <ext-link xlink:href="https://github.com/GMOD/JBrowseR/" ext-link-type="uri">https://github.com/GMOD/JBrowseR/</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>HG004483</award-id>
        <award-id>GM080203</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The development of genome browsers has been described as a milestone of the genomic revolution (<xref rid="btab459-B7" ref-type="bibr">Packer, 2007</xref>). Genome browsers provide researchers with the ability to visualize and explore genomic annotations and data. Due to their widespread adoption and use, the linear display of genomic information along reference coordinates is one of the most common representations of biological data in the 21st century.</p>
    <p>Since their original development during the advent of genome sequencing (<xref rid="btab459-B1" ref-type="bibr">Birney <italic toggle="yes">et al.</italic>, 2004</xref>; <xref rid="btab459-B4" ref-type="bibr">Kent <italic toggle="yes">et al.</italic>, 2002</xref>), genome browsers have made considerable gains in performance and sophistication. One important development has been the implementation of genome browsers in JavaScript, beginning with JBrowse (<xref rid="btab459-B2" ref-type="bibr">Buels <italic toggle="yes">et al.</italic>, 2016</xref>). Leveraging JavaScript—along with modern web technologies such as Canvas and SVG—makes it possible to move computation that previously took place on a server into the client web browser, as well as offering a more responsive and interactive experience to the user.</p>
    <p>We have recently released JBrowse 2, which is an extensible platform for visualizing and integrating biological data, consisting of a ground-up rewrite of JBrowse using ReactJS and TypeScript. JBrowse 2 contains many new views and components, to be described in a later paper. However, one core part is a React component that renders a configurable linear genome browser, enabling researchers to embed custom browsers into existing React applications. While the JBrowse 2 React linear genome view component is powerful and extensible, its use can present an obstacle to bioinformaticians who do not have experience with React development.</p>
    <p>In contrast to React and JavaScript, the R programming language and environment are widely used in the bioinformatics community. R also has a strong history of tools for interacting with genome browsers, such as the rtracklayer (<xref rid="btab459-B5" ref-type="bibr">Lawrence <italic toggle="yes">et al.</italic>, 2009</xref>) package for interacting with the UCSC genome browser, igvR for accessing igv.js (<xref rid="btab459-B8" ref-type="bibr">Robinson <italic toggle="yes">et al.</italic>, 2011</xref>, <xref rid="btab459-B9" ref-type="bibr">2017</xref>), and epivizr for manipulating epiviz (<xref rid="btab459-B3" ref-type="bibr">Chelaru <italic toggle="yes">et al.</italic>, 2014</xref>).</p>
    <p>Although these tools exist for interacting with genome browsers from R, they all work by providing a communication channel between an app in the browser and an R environment. It is not possible to use these packages to render visualizations in popular new tools such as R Shiny apps or R Markdown documents. In order to provide a novel tool and make JBrowse 2 accessible to the R community, we introduce JBrowseR: an R interface the JBrowse 2 genome browser. JBrowseR is an R package with functions for embedding a custom browser instance in a Shiny app, R Markdown document, or the R console.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>JBrowseR is implemented as an R package and distributed on CRAN. The package was built according to the R best practices encoded in the devtools package, ensuring continual use of R CMD Check and maintaining consistent and robust function documentation during development. The core rendering methods of the library rely on the htmlwidgets framework, which can be used to embed JavaScript visualization tools in R Shiny apps, as well as R Markdown documents. Htmlwidgets can also be used from an R interactive console. Using the reactR package, JBrowseR renders the JBrowse 2 widget inside of a root HTML element in an htmlwidget.</p>
    <p>The interface of JBrowseR enables users to generate JBrowse 2 configuration for their own data using simple R functions. The configuration values can be composed together to create an arbitrarily complex custom browser. The majority of genomic data formats commonly displayed in genome browsers are supported, including (but not limited to) FASTA, BED, GFF3, BAM, CRAM, VCF, Wiggle and bigWig. JBrowseR also includes an <ext-link xlink:href="http://HTTP" ext-link-type="uri">HTTP</ext-link> server for serving local data that is configured with the necessary settings and features for working with genome browsers such as JBrowse and IGV.js (<xref rid="btab459-B8" ref-type="bibr">Robinson <italic toggle="yes">et al.</italic>, 2011</xref>, <xref rid="btab459-B9" ref-type="bibr">2017</xref>).</p>
    <p>In addition to loading data from bioinformatics files, users can create tracks from R data frames. This provides an interface for users to generate computational results in R and pass them directly to the browser. When used in Shiny, JBrowseR can also send messages back to the app, enabling powerful integration with downstream processes. We provide an example app using this feature to create a data frame of bookmarked features from the browser.</p>
    <p>The source code for JBrowseR is hosted on GitHub and is automatically tested using continuous integration running on the Windows, MacOS and Linux operating systems. Automated tests for the package are implemented using the testthat R package.</p>
  </sec>
  <sec>
    <title>3 Results and discussion</title>
    <p>In order to demonstrate the utility of JBrowseR, several Shiny apps were built and are included along with the package source code on GitHub. One of the included apps demonstrates adding CRAM, VCF, GFF3, and bigWig data (<xref rid="btab459-F1" ref-type="fig">Fig. 1</xref>), as well as setting a custom color palette for the browser. Another one of the provided demo apps illustrates how JBrowseR can also be configured with a JSON file (like other JBrowse 2 apps) by loading the SARS-CoV-2 reference genome and NCBI annotations from a JBrowse 2 configuration file. Finally, we have provided an example deployment of JBrowseR in an app with interactions connected to other R shiny UI components at <ext-link xlink:href="https://elliothershberg.shinyapps.io/sars-cov-2-spike-mutations/" ext-link-type="uri">https://elliothershberg.shinyapps.io/sars-cov-2-spike-mutations/</ext-link>.</p>
    <fig position="float" id="btab459-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>A custom JBrowse 2 genome browser generated using JBrowseR.</p>
      </caption>
      <graphic xlink:href="btab459f1" position="float"/>
    </fig>
    <p>One of the core strengths of JBrowseR is its versatility. It considerably lowers the level of expertise required to create a web-facing genome database with a fast and flexible genome annotation browser. However, web applications are not the only available target point for the rendering functions: JBrowseR can also embed a genome browser into R Markdown, a flexible documentation format that is used to write scientific articles (including this one). We anticipate that as platforms such as eLife’s ‘reproducible article’ (<xref rid="btab459-B6" ref-type="bibr">Maciocci <italic toggle="yes">et al.</italic>, 2019</xref>) mature and become more widely adopted, it will be possible for genomics articles to contain interactive genome browsers such as JBrowseR displaying their data.</p>
  </sec>
  <sec>
    <title>4 Availability</title>
    <p>JBrowseR is freely available for download from CRAN, and the source code is publicly available at <ext-link xlink:href="https://github.com/GMOD/JBrowseR/" ext-link-type="uri">https://github.com/GMOD/JBrowseR/</ext-link>. The package reference guide and tutorials can be found at <ext-link xlink:href="https://gmod.github.io/JBrowseR/" ext-link-type="uri">https://gmod.github.io/JBrowseR/</ext-link>.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the reactR authors Kent Russell and Alan Dipert for creating and maintaining a clean interface between React and htmlwidgets, which spurred the experiment into whether or not a package such as JBrowseR would be feasible.</p>
    <sec>
      <title>Funding</title>
      <p>This work was funded by NIH grants HG004483 and GM080203.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab459-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Birney</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2004</year>) <article-title>An overview of Ensembl</article-title>. <source>Genome Res</source>., <volume>14</volume>, <fpage>925</fpage>–<lpage>928</lpage>.<pub-id pub-id-type="pmid">15078858</pub-id></mixed-citation>
    </ref>
    <ref id="btab459-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buels</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Jbrowse: a dynamic web platform for genome visualization and analysis</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>12</fpage>.<pub-id pub-id-type="pmid">26813113</pub-id></mixed-citation>
    </ref>
    <ref id="btab459-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chelaru</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Epiviz: interactive visual analytics for functional genomics data</article-title>. <source>Nat. Methods</source>, <volume>11</volume>, <fpage>938</fpage>–<lpage>940</lpage>.<pub-id pub-id-type="pmid">25086505</pub-id></mixed-citation>
    </ref>
    <ref id="btab459-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kent</surname><given-names>W.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2002</year>) <article-title>The human genome browser at UCSC</article-title>. <source>Genome Res</source>., <volume>12</volume>, <fpage>996</fpage>–<lpage>1006</lpage>.<pub-id pub-id-type="pmid">12045153</pub-id></mixed-citation>
    </ref>
    <ref id="btab459-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lawrence</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>rtracklayer: an r package for interfacing with genome browsers</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1841</fpage>–<lpage>1842</lpage>.<pub-id pub-id-type="pmid">19468054</pub-id></mixed-citation>
    </ref>
    <ref id="btab459-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maciocci</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Introducing eLife’s first computationally reproducible article</article-title>. <source>eLife Labs</source>, <volume>20</volume>.</mixed-citation>
    </ref>
    <ref id="btab459-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Packer</surname><given-names>A.</given-names></string-name></person-group> (<year>2007</year>) <article-title>The clickable genome</article-title>. <source>Nat. Rev. Genetics</source>, <volume>8</volume>, <fpage>S17</fpage>–<lpage>S17</lpage>.</mixed-citation>
    </ref>
    <ref id="btab459-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>J.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>Integrative genomics viewer</article-title>. <source>Nat. Biotechnol</source>., <volume>29</volume>, <fpage>24</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">21221095</pub-id></mixed-citation>
    </ref>
    <ref id="btab459-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>J.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Variant review with the integrative genomics viewer</article-title>. <source>Cancer Res</source>., <volume>77</volume>, <fpage>e31</fpage>–<lpage>e34</lpage>.<pub-id pub-id-type="pmid">29092934</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
