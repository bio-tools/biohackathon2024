<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7214028</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa105</article-id>
    <article-id pub-id-type="publisher-id">btaa105</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SPsimSeq: semi-parametric simulation of bulk and single-cell RNA-sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-7773-0621</contrib-id>
        <name>
          <surname>Assefa</surname>
          <given-names>Alemu Takele</given-names>
        </name>
        <xref ref-type="corresp" rid="btaa105-cor1"/>
        <xref ref-type="aff" rid="btaa105-aff1">b1</xref>
        <!--<email>alemutakele.assefa@ugent.be</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vandesompele</surname>
          <given-names>Jo</given-names>
        </name>
        <xref ref-type="aff" rid="btaa105-aff2">b2</xref>
        <xref ref-type="aff" rid="btaa105-aff3">b3</xref>
        <xref ref-type="aff" rid="btaa105-aff4">b4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thas</surname>
          <given-names>Olivier</given-names>
        </name>
        <xref ref-type="aff" rid="btaa105-aff1">b1</xref>
        <xref ref-type="aff" rid="btaa105-aff3">b3</xref>
        <xref ref-type="aff" rid="btaa105-aff5">b5</xref>
        <xref ref-type="aff" rid="btaa105-aff6">b6</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btaa105-aff1">
      <label>b1</label>
      <institution>Data Analysis and Mathematical Modeling</institution>
    </aff>
    <aff id="btaa105-aff2">
      <label>b2</label>
      <institution>Biomolecular Medicine</institution>
    </aff>
    <aff id="btaa105-aff3">
      <label>b3</label>
      <institution>Cancer Research Institute Ghent</institution>
    </aff>
    <aff id="btaa105-aff4"><label>b4</label><institution>Center for Medical Genetics</institution>, Ghent University, Ghent, Belgium</aff>
    <aff id="btaa105-aff5"><label>b5</label><institution>National Institute for Applied Statistics Research Australia (NIASRA)</institution>, University of Wollongong, Wollongong, Australia</aff>
    <aff id="btaa105-aff6"><label>b6</label><institution>Data Science Institute</institution>, I-BioStat, Hasselt University, Hasselt, Belgium</aff>
    <author-notes>
      <corresp id="btaa105-cor1">To whom correspondence should be addressed. <email>alemutakele.assefa@ugent.be</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-02-17">
      <day>17</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>10</issue>
    <fpage>3276</fpage>
    <lpage>3278</lpage>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>1</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>2</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa105.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>SPsimSeq is a semi-parametric simulation method to generate bulk and single-cell RNA-sequencing data. It is designed to simulate gene expression data with maximal retention of the characteristics of real data. It is reasonably flexible to accommodate a wide range of experimental scenarios, including different sample sizes, biological signals (differential expression) and confounding batch effects.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>The R package and associated documentation is available from <ext-link ext-link-type="uri" xlink:href="https://github.com/CenterForStatistics-UGent/SPsimSeq">https://github.com/CenterForStatistics-UGent/SPsimSeq</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>UGent Special Research Fund Concerted Research Actions</institution>
          </institution-wrap>
        </funding-source>
        <award-id>BOF16-GOA-023</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The number of computational tools for the analysis of bulk and single-cell RNA-sequencing (RNA-seq) data is growing rapidly (<xref rid="btaa105-B12" ref-type="bibr">Zappia <italic>et al.</italic>, 2018</xref>). Several methods have been introduced for a single task, e.g. testing for differential expression (DE). These tools typically pass through an evaluation process, often focusing on false discovery rate control and sensitivity. Although such an evaluation often relies on simulated data with a built-in truth, to realistically assess the performance of these data analysis tools, the simulated data must faithfully recapitulate the data characteristics of real data (<xref rid="btaa105-B8" ref-type="bibr">Soneson and Robinson, 2018</xref>; <xref rid="btaa105-B10" ref-type="bibr">Weber <italic>et al.</italic>, 2019</xref>).</p>
    <p>Various methods have been proposed for simulating either bulk or single-cell RNA-seq data. The starting point is typically a distributional assumption of the gene expression levels, e.g. the (zero-inflated) negative binomial distribution (<xref rid="btaa105-B11" ref-type="bibr">Zappia <italic>et al.</italic>, 2017</xref>). Although these parametric simulation methods are flexible and allow simulating various scenarios by generating synthetic data with good fit to the real data (<xref rid="btaa105-B8" ref-type="bibr">Soneson and Robinson, 2018</xref>), such strong distributional assumptions do not hold in general. Due to the intrinsic biological variability and technical noise, single-cell RNA-seq data sometimes show multimodal distributions (<xref rid="btaa105-B2" ref-type="bibr">Bacher and Kendziorski, 2016</xref>). There are also fully non-parametric approaches that employ subsampling from real data (<xref rid="btaa105-B3" ref-type="bibr">Benidt and Nettleton, 2015</xref>). Although non-parametric simulators generate realistic synthetic data, they have limited flexibility and require a large source dataset to subsample from <xref rid="btaa105-B1" ref-type="bibr">Assefa <italic>et al.</italic> (2018)</xref> and <xref rid="btaa105-B3" ref-type="bibr">Benidt and Nettleton (2015</xref>).</p>
    <p>Here, we present a new simulation procedure for simulating bulk and single-cell RNA-seq data. It is designed to maximally retain the characteristics of real RNA-seq data with reasonable flexibility to simulate a wide range of scenarios. In a first step, the logarithmic counts per millions of reads (log-CPM) values from a given real dataset are used for semi-parametrically estimating gene-wise distributions and the between-genes correlation structure. In particular, the estimation of the probability distributions uses the fast log-linear model-based density estimation approach developed by <xref rid="btaa105-B5" ref-type="bibr">Efron and Tibshirani (1996)</xref> and <xref rid="btaa105-B7" ref-type="bibr">Lindsey (1974)</xref>. The method makes use of the Gaussian-copulas (<xref rid="btaa105-B4" ref-type="bibr">Cario and Nelson, 1997</xref>) to retain the between-genes correlation structure, as implemented by <xref rid="btaa105-B6" ref-type="bibr">Hawinkel <italic>et al.</italic> (2019)</xref> for parametric microbiome data simulation. Arbitrarily large datasets, with realistically varying library sizes, can be sampled from these distributions while maintaining the correlation structure between the genes. Our method has an additional step to explicitly account for the high abundance of zero counts, typical for single-cell RNA-seq data. This step models the probability of zero counts as a function of the mean expression of the gene and the library size (read depth) of the cell (both in log scale). Zero counts are then added to the simulated data such that the observed relationship (zero probability to mean expression and library size) is maintained. In addition, our method simulates DE by separately estimating the distributions of the gene expression from the different populations (e.g. treatment groups) in the source data, and subsequently sampling a new dataset from each group.</p>
    <p>Our simulation procedure enables benchmarking of statistical and bioinformatics tools with realistic simulated datasets. In Section 3 and <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, we demonstrate that the simulated data from our method retains the characteristics of the source data in terms of variability, distribution of mean expression levels, fraction of zero counts and the dependence between genes (<xref ref-type="fig" rid="btaa105-F1">Fig. 1</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). The details of the SPsimSeq procedures, implementations and benchmarking results can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>. Data simulated with our procedure are compared with the original real source data and with data simulated with the parametric Splat procedure (<xref rid="btaa105-B11" ref-type="bibr">Zappia <italic>et al.</italic>, 2017</xref>), which uses a gamma-Poisson hierarchical model (<italic>splatter</italic> R Bioconductor package, v1.6.1; <xref rid="btaa105-B11" ref-type="bibr">Zappia <italic>et al.</italic>, 2017</xref>).</p>
    <fig id="btaa105-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>(<bold>A</bold>) Distribution of the coefficients of variations (CV) from the real and simulated (SPsimSeq and Splat) bulk RNA-seq datasets. (<bold>B</bold>) The relationship between the mean gene expression levels (in log-CPM) and three other gene-level characteristics (fraction of zeroes, variance and CV) from the real and simulated single-cell RNA-seq datasets (read-counts). The right panels show the grid differences between the simulated and real data with respect to the corresponding gene-level characteristic. In particular, the mean log2-CPM is partitioned into 1000 grids and the average characteristic per grid is used to calculate the differences. (<bold>C</bold>) The cumulative distribution of the fraction of zero counts per gene from the real and simulated single-cell RNA-seq datasets (read-counts)</p>
      </caption>
      <graphic xlink:href="btaa105f1"/>
    </fig>
  </sec>
  <sec>
    <title>2 Dataset</title>
    <p>For the demonstration and benchmarking of the SPsimSeq method, we used three publicly available datasets: (i) neuroblastoma bulk RNA-seq data retrieved from <xref rid="btaa105-B13" ref-type="bibr">Zhang <italic>et al.</italic> (2015</xref>; GEO accession GSE49711), (ii) neuroblastoma NGP cells single-cell RNA-seq data retrieved from <xref rid="btaa105-B9" ref-type="bibr">Verboom <italic>et al.</italic> (2019</xref>; GEO accession: GSE119984) and (iii) peripheral blood mononuclear cell single-cell RNA-seq data retrieved from (<ext-link ext-link-type="uri" xlink:href="http://www.10xGenomics.com">www.10xGenomics.com</ext-link>). The details of the datasets can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>Using the three source RNA-seq datasets (one bulk and two single-cell), we benchmarked the novel SPsimSeq simulation method. In particular, we compared the simulated data (using SPsimSeq and Splat) with the real data with respect to various gene and sample (cell) level characteristics as suggested by <xref rid="btaa105-B8" ref-type="bibr">Soneson and Robinson (2018</xref>) and <xref rid="btaa105-B11" ref-type="bibr">Zappia <italic>et al.</italic> (2017)</xref>. To simulate bulk RNA-seq data using Splat, we disabled its feature for adding dropouts (<italic><monospace>dropout.type = “none”</monospace></italic>), which is specifically designed for single-cell RNA-seq data simulation.</p>
    <p>The results generally show that our simulation procedure sufficiently captures the properties of the real data both for bulk and single-cell RNA-seq datasets (<xref ref-type="fig" rid="btaa105-F1">Fig. 1</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S1–S14</xref>). The variability (in terms of variance and coefficients of variation), distribution of mean expression level of genes, the fraction of zero counts (per gene and sample/cells), the relationship between the mean and variability gene expressions, the relationship between the mean expression and fraction of zero counts and the dependence between genes in SPsimSeq simulated data resemble that of the real datasets. When compared with Splat, SPsimSeq generates more realistic data with respect to all the considered metrics. In the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>, we present the detailed benchmarking results, including the application of SPsimSeq for simulating single-cell RNA-seq data with read-counts and UMI-counts (unique molecular identifier).</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the UGent Special Research Fund Concerted Research Actions [GOA grant number BOF16-GOA-023].</p>
    <sec>
      <title>Author’s contributions</title>
      <p>A.T.A.: Conceptualization, Data curation, Formal analysis, Methodology, Software, Visualization, Writing—original draft and Writing—review and editing. J.V.: Conceptualization, Funding acquisition, Resources, Supervision and Writing—review and editing. O.T.: Conceptualization, Funding acquisition, Methodology, Supervision and Writing—review and editing.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btaa105_Supplementary_Data</label>
      <media xlink:href="btaa105_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa105-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Assefa</surname><given-names>A.T.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Differential gene expression analysis tools exhibit substandard performance for long non-coding RNA-sequencing data</article-title>. <source>Genome Biol</source>., <volume>19</volume>, <fpage>96</fpage>.<pub-id pub-id-type="pmid">30041657</pub-id></mixed-citation>
    </ref>
    <ref id="btaa105-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bacher</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Kendziorski</surname><given-names>C.</given-names></name></person-group> (<year>2016</year>) 
<article-title>Design and computational analysis of single-cell RNA-sequencing experiments</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>63</fpage>.<pub-id pub-id-type="pmid">27052890</pub-id></mixed-citation>
    </ref>
    <ref id="btaa105-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Benidt</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Nettleton</surname><given-names>D.</given-names></name></person-group> (<year>2015</year>) 
<article-title>SimSeq: a nonparametric approach to simulation of RNA-sequence datasets</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>2131</fpage>–<lpage>2140</lpage>.<pub-id pub-id-type="pmid">25725090</pub-id></mixed-citation>
    </ref>
    <ref id="btaa105-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Cario</surname><given-names>M.C.</given-names></name>, <name name-style="western"><surname>Nelson</surname><given-names>B.L.</given-names></name></person-group> (<year>1997</year>). Modeling and generating random vectors with arbitrary marginal distributions and correlation matrix. <italic>Technical report</italic>. Department of Industrial Engineering and Management Sciences, Northwestern University, Evanston, Illinois.</mixed-citation>
    </ref>
    <ref id="btaa105-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Efron</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Tibshirani</surname><given-names>R.</given-names></name></person-group> (<year>1996</year>) 
<article-title>Using specially designed exponential families for density estimation</article-title>. <source>Ann. Stat</source>., <volume>24</volume>, <fpage>2431</fpage>–<lpage>2461</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa105-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hawinkel</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>A broken promise: microbiome differential abundance methods do not control the false discovery rate</article-title>. <source>Brief. Bioinform</source>., <volume>20</volume>, <fpage>210</fpage>–<lpage>221</lpage>.<pub-id pub-id-type="pmid">28968702</pub-id></mixed-citation>
    </ref>
    <ref id="btaa105-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lindsey</surname><given-names>J.</given-names></name></person-group> (<year>1974</year>) 
<article-title>Construction and comparison of statistical models</article-title>. <source>J. R. Stat. Soc. B</source>, <volume>36</volume>, <fpage>418</fpage>–<lpage>425</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa105-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Soneson</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Robinson</surname><given-names>M.D.</given-names></name></person-group> (<year>2018</year>) 
<article-title>Towards unified quality verification of synthetic count data with countsimQC</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>691</fpage>–<lpage>692</lpage>.<pub-id pub-id-type="pmid">29028961</pub-id></mixed-citation>
    </ref>
    <ref id="btaa105-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Verboom</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>SMARTer single cell total RNA sequencing</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>e93</fpage>.<pub-id pub-id-type="pmid">31216024</pub-id></mixed-citation>
    </ref>
    <ref id="btaa105-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weber</surname><given-names>L.M.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Essential guidelines for computational method benchmarking</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>125</fpage>.<pub-id pub-id-type="pmid">31221194</pub-id></mixed-citation>
    </ref>
    <ref id="btaa105-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zappia</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>174</fpage>.<pub-id pub-id-type="pmid">28899397</pub-id></mixed-citation>
    </ref>
    <ref id="btaa105-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zappia</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Exploring the single-cell RNA-seq analysis landscape with the scRNA-tools database</article-title>. <source>PLoS Comput. Biol</source>., <volume>14</volume>, <fpage>e1006245</fpage>.<pub-id pub-id-type="pmid">29939984</pub-id></mixed-citation>
    </ref>
    <ref id="btaa105-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Comparison of RNA-seq and microarray-based models for clinical endpoint prediction</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>133</fpage>.<pub-id pub-id-type="pmid">26109056</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
