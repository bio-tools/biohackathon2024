<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7750945</article-id>
    <article-id pub-id-type="pmid">32315392</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa259</article-id>
    <article-id pub-id-type="publisher-id">btaa259</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>LeafCutterMD: an algorithm for outlier splicing detection in rare diseases</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-2548-098X</contrib-id>
        <name>
          <surname>Jenkinson</surname>
          <given-names>Garrett</given-names>
        </name>
        <aff><institution>Center for Individualized Medicine</institution>, Mayo Clinic, Rochester, MN 55902, <country country="US">USA</country></aff>
        <aff><institution>Department of Health Sciences Research</institution>, Mayo Clinic, Rochester, MN 55902, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Yang I</given-names>
        </name>
        <aff><institution>Section of Genetic Medicine, Department of Medicine</institution>, Chicago, IL 60637, <country country="US">USA</country></aff>
        <aff><institution>Department of Human Genetics, University of Chicago</institution>, Chicago, IL 60637, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Basu</surname>
          <given-names>Shubham</given-names>
        </name>
        <aff><institution>Center for Individualized Medicine</institution>, Mayo Clinic, Rochester, MN 55902, <country country="US">USA</country></aff>
        <aff><institution>Department of Health Sciences Research</institution>, Mayo Clinic, Rochester, MN 55902, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cousin</surname>
          <given-names>Margot A</given-names>
        </name>
        <aff><institution>Center for Individualized Medicine</institution>, Mayo Clinic, Rochester, MN 55902, <country country="US">USA</country></aff>
        <aff><institution>Department of Health Sciences Research</institution>, Mayo Clinic, Rochester, MN 55902, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Oliver</surname>
          <given-names>Gavin R</given-names>
        </name>
        <aff><institution>Center for Individualized Medicine</institution>, Mayo Clinic, Rochester, MN 55902, <country country="US">USA</country></aff>
        <aff><institution>Department of Health Sciences Research</institution>, Mayo Clinic, Rochester, MN 55902, <country country="US">USA</country></aff>
        <xref rid="btaa259-cor1" ref-type="corresp"/>
        <!--Oliver.Gavin@mayo.edu-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Klee</surname>
          <given-names>Eric W</given-names>
        </name>
        <aff><institution>Center for Individualized Medicine</institution>, Mayo Clinic, Rochester, MN 55902, <country country="US">USA</country></aff>
        <aff><institution>Department of Health Sciences Research</institution>, Mayo Clinic, Rochester, MN 55902, <country country="US">USA</country></aff>
        <xref rid="btaa259-cor1" ref-type="corresp"/>
        <!--Klee.Eric@mayo.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Robinson</surname>
          <given-names>Peter</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa259-cor1">To whom correspondence should be addressed. E-mail: <email>Oliver.Gavin@mayo.edu</email> or <email>Klee.Eric@mayo.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-04-21">
      <day>21</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>4</month>
      <year>2020</year>
    </pub-date>
    <volume>36</volume>
    <issue>17</issue>
    <fpage>4609</fpage>
    <lpage>4615</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>1</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>19</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>4</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa259.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Next-generation sequencing is rapidly improving diagnostic rates in rare Mendelian diseases, but even with whole genome or whole exome sequencing, the majority of cases remain unsolved. Increasingly, RNA sequencing is being used to solve many cases that evade diagnosis through sequencing alone. Specifically, the detection of aberrant splicing in many rare disease patients suggests that identifying RNA splicing outliers is particularly useful for determining causal Mendelian disease genes. However, there is as yet a paucity of statistical methodologies to detect splicing outliers.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed LeafCutterMD, a new statistical framework that significantly improves the previously published LeafCutter in the context of detecting outlier splicing events. Through simulations and analysis of real patient data, we demonstrate that LeafCutterMD has better power than the state-of-the-art methodology while controlling false-positive rates. When applied to a cohort of disease-affected probands from the Mayo Clinic Center for Individualized Medicine, LeafCutterMD recovered all aberrantly spliced genes that had previously been identified by manual curation efforts.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The source code for this method is available under the opensource Apache 2.0 license in the latest release of the LeafCutter software package available online at <ext-link xlink:href="http://davidaknowles.github.io/leafcutter" ext-link-type="uri">http://davidaknowles.github.io/leafcutter</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Mayo Clinic Center for Individualized Medicine</institution>
            <institution-id institution-id-type="DOI">10.13039/100014535</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Next-generation sequencing is revolutionizing the diagnosis and study of rare diseases. Whole exome sequencing has now become standard practice for patients with a suspected rare genetic condition (<xref rid="btaa259-B9" ref-type="bibr">Posey <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa259-B10" ref-type="bibr">Sawyer <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa259-B11" ref-type="bibr">Yang <italic toggle="yes">et al.</italic>, 2013</xref>). In a landmark paper, <xref rid="btaa259-B2" ref-type="bibr">Cummings <italic toggle="yes">et al.</italic> (2017)</xref> demonstrated the value of RNA-seq for rare disease diagnosis by using multiple RNA-seq analyses to increase diagnostic yield by 35% within a cohort of rare disease probands who received no diagnosis through exome sequencing. Detection of aberrant splicing helped solve a large fraction of these previously unsolved cases. However, the use of <italic toggle="yes">ad hoc</italic> filters and thresholds to detect outlier splicing events in that study is prone to producing large lists of putatively disrupted genes, which requires laborious manual curation and expert knowledge to generate a shortened list of likely causal disease genes. The LeafCutter algorithm (<xref rid="btaa259-B8" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2018</xref>) was developed using a Dirichlet-Multinomial generalized linear model (DM-GLM) for differential RNA splicing detection between groups of samples (e.g. to explore splicing differences between tissues sequenced across many individuals). Prior to LeafCutter’s final publication, a second study (<xref rid="btaa259-B7" ref-type="bibr">Kremer <italic toggle="yes">et al.</italic>, 2017</xref>) utilized the algorithm in a one-versus-the-rest fashion to detect outlier splicing in individual probands affected by rare genetic disease. Although LeafCutter was developed with the goal of rigorously modeling variability in counts between groups of samples, it was not designed for the one-versus-many sample comparisons used by <xref rid="btaa259-B7" ref-type="bibr">Kremer <italic toggle="yes">et al.</italic> (2017)</xref> to detect aberrant splicing events in single proband samples.</p>
    <p>We found that applying a group comparison method to perform outlier detection is statistically misspecified and thus lacks power compared to a tailored outlier detection test. In brief, statistical comparisons between groups are justified (i.e. consistent) when the sample sizes are kept nearly balanced and the number of observations in both groups grows asymptotically. In the case of a cohort consisting of <italic toggle="yes">N</italic> rare disease samples, the most suitable approach for detecting aberrant splicing events using a group comparison tool is to compare each individual disease sample to the remaining <italic toggle="yes">N</italic> – 1 samples, resulting in the most imbalanced comparison possible; this was the approach pursued in the literature (<xref rid="btaa259-B7" ref-type="bibr">Kremer <italic toggle="yes">et al.</italic>, 2017</xref>). However, even as the cohort grows to an arbitrarily large size, one of the groups will have a single sample, resulting in an estimator that is asymptotically inconsistent. In this article, we present LeafCutter for Mendelian disease (LeafCutterMD), a mathematically rigorous outlier detection procedure to reliably detect aberrant splicing events within a cohort of rare disease probands. The source code will be made available as a new module of the LeafCutter software package. The updated package will enable users to utilize RNA sequencing data to efficiently perform either outlier splicing detection using the proposed LeafCutterMD algorithm, or standard group splicing comparisons (e.g. tissue versus tissue or wild-type versus common variant) using the previously published (<xref rid="btaa259-B8" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2018</xref>) LeafCutter methodology.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Dirichlet-multinomial model</title>
      <p>LeafCutterMD uses the intron-based clustering approach from LeafCutter (<xref rid="btaa259-B8" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2018</xref>), wherein splicing is measured as the excision of introns (instead of the inclusion of exons). Biological differences in splicing are thus captured by differing measurements of intron excision. Briefly, split reads anchored by at least 6 nt into each exon are used to specify and quantify excision counts of each intron, which are defined by the regional gap in the split read. LeafCutter then constructs a graph whose nodes are introns connected by edges representing a shared splice junction between two introns. An iterative filtering and graph building approach is followed until convergence, at which point the connected components of the resultant graph define ‘clusters’ of introns (<xref rid="btaa259-B8" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2018</xref>). This procedure results in each intron cluster <italic toggle="yes">c</italic> having <italic toggle="yes">I</italic> possible introns indexed <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">I</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> in a total of <italic toggle="yes">S</italic> proband samples indexed <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">S</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. For ease of notation, we focus in the subsequent on a single cluster <italic toggle="yes">c</italic> within our <italic toggle="yes">C</italic> total clusters with the understanding that each cluster will be considered independently.</p>
      <p>Subsequent to clustering, LeafCutter outputs the counts <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for intron <italic toggle="yes">i</italic> and sample <italic toggle="yes">s</italic>, which can be viewed as an <italic toggle="yes">I </italic>×<italic toggle="yes"> S</italic> matrix. To regularize the count data, which often has large number of zeros or small values, we apply Laplace smoothing on the data and consider our counts to be <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. We formulate the outlier splicing detection problem as identifying <italic toggle="yes">n<sub>is</sub></italic> that indicate an abnormally high or low usage of intron <italic toggle="yes">i</italic> in a sample <italic toggle="yes">s</italic> compared to the remaining samples from the cohort. A convenient representation of this problem is to view all intron counts from a sample as a vector <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. If all samples were expected to use intron <italic toggle="yes">i</italic> with probability <italic toggle="yes">p<sub>i</sub></italic>, then the vectors <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> would be drawn from a Multinomial distribution <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the total observations (i.e. split RNA-seq reads) in the cluster for sample <italic toggle="yes">s</italic>, and <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>I</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> is the probability of usage for each intron. In general, however, we do not expect all samples to have identical usage probabilities <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">p</mml:mi></mml:math></inline-formula>. Biological variability across individuals will result in variable intron excision rates, and therefore modeling the probability distribution <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for each individual has been shown to work well. A flexible and computationally convenient choice for modeling this distribution over <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">p</mml:mi></mml:math></inline-formula> is the Dirichlet distribution <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>I</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> which has <italic toggle="yes">I</italic> parameters that we denote <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>I</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
      <p>The leads to the following statistical model for counts vectors <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>
 <disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo>∼</mml:mo><mml:mi mathvariant="script">D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>I</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>whose probability distributions are given by
<disp-formula id="E2"><mml:math id="M2" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>!</mml:mo><mml:mo> </mml:mo><mml:mo>⋯</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi mathvariant="italic">i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="italic">I</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="italic">p</mml:mi></mml:mrow><mml:mi mathvariant="italic">i</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the multivariate beta function that serves as a normalizing constant for the Dirichlet distribution. <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a compound distribution that can be combined by integrating out the latent probabilities <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">p</mml:mi></mml:math></inline-formula> as
<disp-formula id="E3"><mml:math id="M3" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi></mml:msub><mml:mi mathvariant="italic">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mi mathvariant="italic">s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">N</mml:mi></mml:mrow><mml:mi mathvariant="italic">s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="italic">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="italic">d</mml:mi><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi></mml:msub><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">d</mml:mi><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>!</mml:mo><mml:mo> </mml:mo><mml:mo>⋯</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">i</mml:mi><mml:mi mathvariant="italic">S</mml:mi></mml:mrow></mml:msub><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>!</mml:mo><mml:mo> </mml:mo><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>!</mml:mo><mml:mo> </mml:mo><mml:mo>Γ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>I</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. The resulting distribution is known as the Dirichlet-Multinomial distribution <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mi mathvariant="script">M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>The derivation of the Dirichlet-Multinomial helps us note that a smaller <italic toggle="yes">A</italic> results in a more over-dispersed <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mi mathvariant="script">M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> compared to the Multinomial with the same mean <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula>. Thus, as <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi><mml:mo>→</mml:mo><mml:mo>∞</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula> remain fixed, <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mi mathvariant="script">M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>→</mml:mo><mml:mi mathvariant="script">M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The convergence of the Dirichlet-Multinomial to a Multinomial represents the case where the variability of a sample population around <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">p</mml:mi></mml:math></inline-formula> shrinks to zero, or equivalently the case where the Dirichlet distribution <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>I</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> converges to a point mass at <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">p</mml:mi></mml:math></inline-formula>. In the context of outlier splicing events, clusters with very small <italic toggle="yes">A</italic> represent splicing events with a large amount of natural variation in the usage of the various introns, implying that the detection of an outlier would require an especially large deviation from the expected value of the count <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:math></inline-formula>. Conversely, if <italic toggle="yes">A</italic> is large then even a relatively small departure from the expected number of counts <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> would be indicative of aberrant splicing.</p>
      <p>The other parameter that affects outlier detection is <italic toggle="yes">N<sub>s</sub></italic>. Small values of <italic toggle="yes">N<sub>s</sub></italic> indicate small numbers of observations in sample <italic toggle="yes">s</italic>, and the Multinomial portion of the Dirichlet-Multinomial controls the variability due to statistical sampling. Thus, <italic toggle="yes">n<sub>is</sub></italic> can deviate from <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> substantially if the number of observations, <italic toggle="yes">N<sub>s</sub></italic>, is small, which makes departures from the mean common due to statistical chance. The Dirichlet-Multinomial model therefore accounts for both biological variability in the population, and the uncertainty of the statistical sampling process that produces our observations.</p>
    </sec>
    <sec>
      <title>2.2 Modeling a one versus all outlier splicing test</title>
      <p>A statistical test that determines how unlikely the count <italic toggle="yes">n<sub>is</sub></italic> comes from the distribution <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mi mathvariant="script">M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> must estimate the parameters <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> that capture the variability in the proportional intron usage within the population that does not include our sample of interest <italic toggle="yes">s</italic> (<inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula>). Thus, the null hypothesis that underlies the statistical test in LeafCutterMD is that <italic toggle="yes">n<sub>is</sub></italic> is drawn from the same distribution as the rest of the samples <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula>, whereas the rejection of the null hypothesis indicates that <italic toggle="yes">n<sub>is</sub></italic> is an outlier from this population.</p>
      <p>To compute the <italic toggle="yes">P</italic>-value of this hypothesis test, we first marginalize the Dirichlet-Multinomial to find the distribution of this particular intron count under the null hypothesis
<disp-formula id="E4"><mml:math id="M4" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mo> </mml:mo><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mo> </mml:mo><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>⇒</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">B</mml:mi><mml:mi mathvariant="script">B</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msup><mml:mo> </mml:mo><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the beta function and <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">B</mml:mi><mml:mi mathvariant="script">B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a Beta-Binomial distribution which is the one-dimensional analogue of—and marginal distribution for—the Dirichlet-Multinomial (<xref rid="btaa259-B3" ref-type="bibr">Danaher, 1988</xref>). The distribution <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">B</mml:mi><mml:mi mathvariant="script">B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> represents the compound distribution where a Binomial trial with <italic toggle="yes">N</italic> samples is drawn with a probability of success <italic toggle="yes">p</italic> that was itself drawn from a Beta distribution with parameters <italic toggle="yes">α</italic> and <italic toggle="yes">β</italic>. We can compute the right <italic toggle="yes">P</italic>-value using the tail probability that a count of <italic toggle="yes">n<sub>is</sub></italic> or larger is observed from sampling this distribution. Similarly, we can compute the left <italic toggle="yes">P</italic>-value that a count of <italic toggle="yes">n<sub>is</sub></italic> or smaller is observed from sampling this distribution. The two-sided <italic toggle="yes">P</italic>-value is computed as twice the minimum of these two numbers.</p>
      <p>We note that as the number of samples in the cohort increases, the procedure of estimating <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for each cluster and each sample becomes increasingly computationally burdensome. However, estimates <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> for all <italic toggle="yes">s</italic> should have only small differences because they differ only by a single observation. Therefore, for computational efficiency, we simply estimate <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> using all samples once to approximate <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>≃</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>. In practice, this will make the outlier detection test conservative (i.e. larger <italic toggle="yes">P</italic>-values) because the model with <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> includes the variability from the potential outlier. Thus, this technique of setting <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>≃</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> results in a minor loss of sensitivity for gains in computational efficiency, and this becomes increasingly beneficial as <italic toggle="yes">S</italic> increases.</p>
      <p>In some cases, a cluster-level summary <italic toggle="yes">P</italic>-value for each sample may be of interest. The above procedure produces <italic toggle="yes">P</italic>-values <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">I</mml:mi></mml:mrow></mml:math></inline-formula> for each intron in the cluster for a given sample. Thus, a practical choice would be to report the minimum <italic toggle="yes">P</italic>-value across the introns within the sample <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">I</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. However, because this summary would lead to smaller <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> by chance for clusters with larger numbers of introns <italic toggle="yes">I</italic>, we compute a cluster-level <italic toggle="yes">P</italic>-value by inferring the null distribution of the minimum <italic toggle="yes">P</italic>-value within the cluster. Under this null hypothesis, the <italic toggle="yes">P</italic>-value distribution for each intron is expected to be uniform, and therefore under the assumption that these tests are independent, the minimum <italic toggle="yes">P</italic>-value would be distributed as a beta distribution <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Computing the approximate <italic toggle="yes">P</italic>-value for <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> from the left tail of the beta distribution can therefore serve as a cluster summary <italic toggle="yes">P</italic>-value when needed.</p>
      <p>We use the R bioconductor library <monospace>Dirichlet-Multinomial</monospace> (<xref rid="btaa259-B5" ref-type="bibr">Holmes <italic toggle="yes">et al.</italic>, 2012</xref>) to estimate the parameters <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> from the counts <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:math></inline-formula>, and the R library <monospace>TailRank</monospace> (<xref rid="btaa259-B1" ref-type="bibr">Coombes, 2018</xref>) to compute the tail probabilities of the Beta-Binomial distribution. Rankings by <italic toggle="yes">P</italic>-value are computed using the R function <monospace>rank</monospace>, which reports ties to have their average rank.</p>
    </sec>
    <sec>
      <title>2.3 Ethical compliance</title>
      <p>The probands and families provided written informed consent to a research protocol approved by the Mayo Clinic Institutional Review Board for this study.</p>
    </sec>
    <sec>
      <title>2.4 Study subjects</title>
      <p>All probands were clinically referred to the Mayo Clinic Center for Individualized Medicine, seeking genetic diagnosis of a suspected rare inherited disease. Probands not fully diagnosed by exome sequencing were selected for whole-transcriptome RNA sequencing.</p>
    </sec>
    <sec>
      <title>2.5 RNA-sequencing</title>
      <p>Sequencing was conducted on blood for 128 individuals. Blood-derived RNA was obtained by collecting peripheral whole blood in PAXgene blood RNA tubes and using the QIAcube system (Qiagen) according to the manufacturer’s protocol for RNA extraction.</p>
      <p>Sequencing libraries were prepared with the TruSeq RNA Access Library Prep Kit (Illumina, San Diego, CA). Paired-end 101-basepair reads were sequenced on an Illumina HiSeq 2500 using the TruSeq Rapid SBS sequencing kit version 1 and HCS version 2.0.12.0 data collection software. A median of approximately 200 million reads was generated per individual. Base calling was performed using Illumina’s RTA version 1.17.21.3.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We compared the performance of LeafCutterMD to the standard LeafCutter likelihood ratio-based approach (<xref rid="btaa259-B7" ref-type="bibr">Kremer <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btaa259-B8" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2018</xref>), which represents the current state-of-the-art. We begin with a simulation study where the ground truth is known, and then proceed to examine the performance of both approaches in real examples from a rare disease cohort from the Mayo Clinic Center for Individualized Medicine.</p>
    <sec>
      <title>3.1 Simulated data</title>
      <sec>
        <title>3.1.1 Exon skipping and cryptic exon inclusion</title>
        <p>We first considered a simple three intron cluster (<xref rid="btaa259-F1" ref-type="fig">Fig. 1</xref>) that can represent an exon skipping event or inclusion of a cryptic exon. In our first simulation, we assume a low-level background rate of exon skipping in a cohort of 100 samples, with a proband exhibiting dramatically increased rate of exon skipping.
</p>
        <fig position="float" id="btaa259-F1">
          <label>Fig. 1.</label>
          <caption>
            <p>The simulated exon skipping event where the canonical splicing is represented by the two red splicing events, whereas the skipping is represented by the orange splicing event. Note this same setting can represent a cryptic exon when the canonical splicing is given by the orange lines and the proband's splicing is represented by the red lines. The simulation parameters a1, a2 and a3 are shown next to their corresponding introns</p>
          </caption>
          <graphic xlink:href="btaa259f1" position="float"/>
        </fig>
        <p>To simulate this possible scenario, the total observations in each sample <italic toggle="yes">N<sub>s</sub></italic> were drawn from a Poisson distribution with a mean of <italic toggle="yes">N</italic> reads. The reads from a healthy individual were simulated using Dirichlet parameters of <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>. In this simulation, intron 1 represents exon skipping with Dirichlet parameter <italic toggle="yes">α</italic><sub>1</sub>, whereas introns 2 and 3 with parameters <italic toggle="yes">α</italic><sub>2</sub> and <italic toggle="yes">α</italic><sub>3</sub>, respectively, represent exon inclusion (<xref rid="btaa259-F1" ref-type="fig">Fig. 1</xref>). The proband was assumed to have an increased usage of the exon skipping intron, which will be represented by increasing <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> and drawing samples from a Multinomial with <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
        <p>Of note, this simulation assumes a Dirichlet-Multinomial distribution, which is consistent with both LeafCutterMD and the standard LeafCutter, and thus represents a fair comparison of the methods. We drew 2000 Monte Carlo samples for each scenario with increasing values of <italic toggle="yes">N</italic> representing increasing numbers of supporting reads within the cluster. For each method, we considered the event as being detected if the <italic toggle="yes">P</italic>-value was less than 0.05.</p>
        <p><xref rid="btaa259-F2" ref-type="fig">Figure 2A</xref> illustrates that LeafCutterMD has estimated power (i.e. one minus the probability of a Type II error) of nearly 1 for all values of <italic toggle="yes">N</italic>, whereas, the power of the standard LeafCutter likelihood approach decreases with increasing number of observations. This unintuitive result is due to the fact that reads supporting exon skipping from the single proband sample contribute a smaller and smaller proportion to the likelihood in the learned model, and thus the likelihood ratio test becomes less sensitive to the exon skipping reads, despite their increased presence in the proband compared to healthy individuals. In addition, we found that our proposed LeafCutterMD test is conservative. Indeed, estimated false-positive rates remained below 0.007 for all values of <italic toggle="yes">N</italic> despite a <italic toggle="yes">P</italic>-value threshold of 0.05.
</p>
        <fig position="float" id="btaa259-F2">
          <label>Fig. 2.</label>
          <caption>
            <p>The power in the exon skipping simulation, (<bold>A</bold>) as a function of the average number of reads <italic toggle="yes">N</italic>, and (<bold>B</bold>) as a function of the <italic toggle="yes">α</italic><sub>1</sub> effect size, for the proposed LeafCutterMD method versus the state-of-the-art method based on the likelihood ratio test in LeafCutter</p>
          </caption>
          <graphic xlink:href="btaa259f2" position="float"/>
        </fig>
        <p>To more comprehensively examine the parameter space of this simulation, we fixed <italic toggle="yes">N </italic>=<italic toggle="yes"> </italic>1000 but varied <italic toggle="yes">α</italic><sub>1</sub>, which for small values indicates a small effect size for the outlier and for larger values indicates a larger effect size. The results in <xref rid="btaa259-F2" ref-type="fig">Figure 2B</xref> shows that the proposed LeafCutterMD experiences a more rapid gain in power compared to the standard LeafCutter algorithm as effect sizes increase. We note, however, that for very small effect sizes LeafCutterMD’s performance starts to degrade faster than the original method, and this is due to the Laplace smoother, which in practice will reduce the algorithm’s power against very small effect sizes. Such small effect sizes are rarely our concern from a biological perspective when performing outlier detection, and so the reduction in noise and false positives is on the whole beneficial in practice. If increased power against small effect sizes is desirable, the user can remove Laplace smoothing, although reliable recovery of vanishingly small effect sizes at finite sample sizes cannot be expected.</p>
        <p>As noted above, the same simulation can alternatively represent cryptic exon detection if we simply set <italic toggle="yes">α</italic><sub>1</sub> to be much larger than <italic toggle="yes">α</italic><sub>2</sub> and <italic toggle="yes">α</italic><sub>3</sub>. Thus, consider the same simulation setting as the previous example, but with the population parameters now set to <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The proband will be assumed to have an increased usage of the two cryptic exon introns, which will be represented by increasing <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> and drawing samples from a multinomial with <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. In this setting, we find that both LeafCutter and LeafCutterMD maintain a power equal to one throughout the simulation parameters.</p>
        <p>When considering why there is a discrepancy between the cryptic exon and exon skipping events, we note that the majority of introns (two of three) are affected in the case of the cryptic exon whereas only one of three are affected in the exon skipping event. Because the likelihood ratio test of the original LeafCutter compares the change in likelihood across the entire three intron cluster when allowing all parameters to have unique values in the proband, we expect it to be more sensitive when a larger fraction of the cluster is affected in a given proband. By contrast, when a smaller fraction of introns and reads in a cluster are affected by aberrant splicing in the proband, we expect the original LeafCutter to lose power compared to our proposed LeafCutterMD approach. To test this hypothesis, we include a fourth ‘noise’ intron (i.e. an intron with identical behavior in the proband and the unaffected cohort, that is therefore not relevant to the proband’s phenotype) to this cluster, with increasing read counts such that the event of interest represents a decreasing fraction of the total reads in the cluster. The results are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1A</xref> and <xref rid="sup1" ref-type="supplementary-material">B</xref> and demonstrate that in both the cryptic exon and the exon skipping settings, the original LeafCutter experiences a degradation in performance, whereas LeafCutterMD remains robust to the noisy counts. We explore these points further in the next simulation setting.</p>
      </sec>
      <sec>
        <label>3.1.2</label>
        <title>Growing cluster size simulation</title>
        <p>Alternative RNA splicing is a complex and inherently noisy process, producing highly variable recombinations of DNA sequence to form distinct mRNA isoforms. As such, we investigate the role of increasing cluster sizes—which represent increasing isoform complexity—in our ability to the detect outlier splicing. This is critical to the real-world performance of the algorithm as our cohort grows, because clusters can often comprise upward of 15 distinct introns.</p>
        <p>Suppose our event of interest is one of the simple two-intron cases represented in <xref rid="btaa259-F3" ref-type="fig">Figure 3</xref>, but we will be adding a third intron representing some other unaffected splicing event that is a part of this cluster. We represent this by setting <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> in the cohort and <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></inline-formula> in the proband (indicating a significantly increased usage of intron 1 in the proband), and setting the third noise intron to have <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> in both the proband and the cohort. The total reads are drawn from a Poisson with a mean of <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>51</mml:mn></mml:mrow></mml:math></inline-formula> in both the cohort and the proband, and as before the proband has reads drawn from a multinomial with parameters <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. The results in <xref rid="btaa259-F4" ref-type="fig">Figure 4A</xref> quantitatively demonstrate the degradation in performance in the original LeafCutter method as compared to the proposed LeafCutterMD methodology, whereas the results in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S2</xref> explore how this performance is affected by the effect size <italic toggle="yes">α</italic>. Once again, the false-positive rate for the proposed approach never rose above <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mrow><mml:mn>6.25</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> even though the level of the test was set to 0.05, demonstrating the conservativeness of the approach.
</p>
        <fig position="float" id="btaa259-F3">
          <label>Fig. 3.</label>
          <caption>
            <p>Events that can be represented as a two intron cluster. In our simulation, we include additional ‘noise’ introns to this cluster that have no differential splicing in the proband (unpictured). Increasing the number of reads to this biologically irrelevant portion of the cluster can degrade the performance of the original LeafCutter algorithm, whereas the proposed method is robust to these effects</p>
          </caption>
          <graphic xlink:href="btaa259f3" position="float"/>
        </fig>
        <fig position="float" id="btaa259-F4">
          <label>Fig. 4.</label>
          <caption>
            <p>The proposed method retains power even as the number of irrelevant reads <italic toggle="yes">N</italic> is increased, whereas the original LeafCutter method experiences a decrease in power. In (<bold>A</bold>), the reads are all placed in a single noise intron, whereas in (<bold>B</bold>), there is an increasing number of noise introns each receiving 500 additional reads on average</p>
          </caption>
          <graphic xlink:href="btaa259f4" position="float"/>
        </fig>
        <p>To further explore how noisy reads impact performance, we altered the simulation to have an increasing number of noise introns. Each additional intron has <italic toggle="yes">α </italic>= 500 in both the proband and the population, and we increase the number of reads by this amount as well, which results in an average of 500 additional reads going to each additional ‘noise’ intron we add to the cluster. The results in <xref rid="btaa259-F4" ref-type="fig">Figure 4B</xref> demonstrate that LeafCutterMD is robust against added noise introns, whereas the state-of-the-art method experiences an even more rapid degradation of performance when the noisy reads are spread among more introns in the cluster.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 Rare disease cohort</title>
      <p>Our simulations demonstrate that the false-positive rate is well controlled. Indeed, the test is conservative as thresholding the <italic toggle="yes">P</italic>-value at a level <italic toggle="yes">α</italic> will results in a false-positive rate strictly less than <italic toggle="yes">α</italic>. Our simulations also demonstrate that LeafCutterMD achieve higher power to detect outlier splicing events compared to the group-comparison statistics in a one-versus-the-rest fashion.</p>
      <p>Next, we examine three outlier splicing events from our rare disease cohort that were previously discovered and confirmed by manual review of the cases. We find that LeafCutterMD, but not standard LeafCutter, is capable of detecting these outlier events.</p>
      <p>Specifically, we analyzed a cohort of 128 probands with undiagnosed disease following whole exome sequencing (WES). Using RNA-seq data from peripheral blood, three of these 128 cases were identified to have splicing aberrations by manual review of DNA variants and RNA-seq coverage at candidate disease genes prior to any systematic splicing-aware bioinformatic analysis. When we analyzed these RNA-seq data using standard LeafCutter as applied by <xref rid="btaa259-B7" ref-type="bibr">Kremer <italic toggle="yes">et al.</italic> (2017)</xref>, we were unable to identify any of the three outlier splicing events. By contrast, we were able to recover all three cases using LeafCutterMD.</p>
      <sec>
        <label>3.2.1</label>
        <title>Proband 1</title>
        <p>Proband 1 and her affected sister were born to a consanguineous family and have global developmental delay and refractory epilepsy. WES of the two sisters and their unaffected parents identified a homozygous synonymous SNV (c.1899A&gt;T, p. Arg633Arg) in the penultimate nucleotide of exon 11 in <italic toggle="yes">PEX1</italic> (transcript NM_000466.2) in both girls. SpliceAI (<xref rid="btaa259-B6" ref-type="bibr">Jaganathan <italic toggle="yes">et al.</italic>, 2019</xref>) predicts loss of the exon 11 splice donor (DS_DL = 0.7168, DP_DL=-1) without significant gain of a novel donor (DS_DG = 0.0104, DP_DG=-7). Skipping of this exon was detected by blood whole RNA sequencing, which leads to an out-of-frame transcript that may be a substrate of nonsense-mediated decay. When examined in a sashimi plot (<xref rid="btaa259-F5" ref-type="fig">Fig. 5A</xref>), a subset of the RNA-seq reads in this proband support abnormal splicing, suggesting a weakening of the splice donor. Further functional work is needed to determine if the c.1899A&gt;T variant is causing disease in this family, however, it is clear that there is aberrant splicing of <italic toggle="yes">PEX1</italic> exon 11, which is not detected by standard LeafCutter as significantly differentially spliced with an adjusted <italic toggle="yes">P</italic>-value of 0.15 although it is ranked as the second most aberrant cluster by <italic toggle="yes">P</italic>-value. In comparison, LeafCutterMD identifies this outlier splicing event with an adjusted <italic toggle="yes">P</italic>-value of <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mrow><mml:mn>1.3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and is ranked first by its <italic toggle="yes">P</italic>-value.
</p>
        <fig position="float" id="btaa259-F5">
          <label>Fig. 5.</label>
          <caption>
            <p>Aberrant splicing in disease cohort. (<bold>A</bold>) Splicing patterns from a representative control sample as well as Proband 1 demonstrate the aberrant pattern of splicing found in this individual in <italic toggle="yes">PEX1</italic>. (<bold>B</bold>) Splicing patterns from a representative control sample as well as Proband 2 demonstrate the aberrant pattern of splicing found in this individual in <italic toggle="yes">EP300</italic>. (<bold>C</bold>) Splicing patterns from a representative control sample as well as Proband 3 demonstrate the aberrant pattern of splicing found in this individual in <italic toggle="yes">HNRNPU</italic></p>
          </caption>
          <graphic xlink:href="btaa259f5" position="float"/>
        </fig>
      </sec>
      <sec>
        <label>3.2.2</label>
        <title>Proband 2</title>
        <p>Proband 2 has mild global developmental delay, distinctive features, short stature, cerebellar ectopia, Chiari I malformation, hyper-reflexia and attention-deficit hyperactivity disorder with no similarly affected family members. Trio WES identified a <italic toggle="yes">de novo</italic> intronic SNV (c.4026-9A&gt;G) in <italic toggle="yes">EP300</italic> (transcript NM_001429.3). This variant has been seen previously in an unrelated individual with Rubinstein–Taybi (<xref rid="btaa259-B4" ref-type="bibr">Fergelot <italic toggle="yes">et al.</italic>, 2016</xref>), but without any RNA or functional studies. SpliceAI (<xref rid="btaa259-B6" ref-type="bibr">Jaganathan <italic toggle="yes">et al.</italic>, 2019</xref>) predicts moderate loss of the exon 25 splice acceptor (DS_AL = 0.3704, DP_AL = 9) and a strong gain of a novel splice acceptor at c.4026-8 (DS_AG = 0.9788, DP_AG = 1) due to this variant. As visualized in <xref rid="btaa259-F5" ref-type="fig">Figure 5B</xref>, the abnormal splicing detected by RNA sequencing of blood adds 8 nts to exon 25, causing a frame shift in the transcript. Observation of the variant-induced abnormal splicing provides additional evidence supporting this variant’s pathogenicity, which results in a genetic diagnosis of Rubinstein–Taybi for this patient. Usage of the novel splice acceptor went undetected in a cluster of 8 introns with an adjusted <italic toggle="yes">P</italic>-value of 1.0 using standard LeafCutter. In comparison, the use of the novel acceptor was detected in this cluster using LeafCutterMD with an adjusted <italic toggle="yes">P</italic>-value of <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:mn>4.1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Furthermore, the traditional LeafCutter and LeafCutterMD methods, respectively, rank this event by <italic toggle="yes">P</italic>-value in the 28 611th and 154th positions out of a total of 51 347 clusters. Although not a first-place ranking in the proposed method, from the perspective of a rare disease case review, the event is in the top 0.3% of clusters. Indeed, its presence in the first few hundred outlier splicing events is sufficient for manual review, especially when analyzed using common automated or manual phenotypic prioritization and gene annotation techniques in conjunction with genetic variation analysis.</p>
      </sec>
      <sec>
        <label>3.2.3</label>
        <title>Proband 3</title>
        <p>Proband 3 has global developmental delay, focal epilepsy, autism spectrum disorder and downbeat nystagmus with unaffected parents. Trio WES identified a <italic toggle="yes">de novo</italic> 4-bp intronic deletion (c.804-9_804-6delGTCT) in <italic toggle="yes">HNRNPU</italic> (transcript NM_031844.2) predicted to weaken the strength of the exon 3 splice acceptor. <italic toggle="yes">HNRNPU</italic> is associated with autosomal dominant early infantile epileptic encephalopathy 54 and is consistent with the proband’s clinical symptoms. Blood RNA sequencing reveals skipping of both exons 2 and 3 (splicing from exon 1 to 4), as visualized in <xref rid="btaa259-F5" ref-type="fig">Figure 5C</xref>. This exon skipping event is predicted to lead to an in-frame transcript missing amino acid residues 231–293 and suspected to be disease causal in this individual. The abnormal splice event in <italic toggle="yes">HNRNPU</italic> went undetected in a cluster of 28 introns with an adjusted <italic toggle="yes">P</italic>-value of 1.0 by the traditional LeafCutter method. Comparatively, this was detected by LeafCutterMD with an adjusted <italic toggle="yes">P</italic>-value of 0.03. Similarly, the LeafCutter and LeafCutterMD methods, respectively, rank this event by <italic toggle="yes">P</italic>-value in the 26 539th and 134th positions out of a total of 51 347 clusters. Once again, the new method is able to detect this event from an unbiased case review perspective where it would have been previously undetectable using existing methodologies.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>RNA sequencing is becoming an important diagnostic tool for rare disease patients. However, the efficiency and sensitivity of methods for prioritizing disease genes from RNA-seq data have not being systematically assessed. In this article, we present LeafCutterMD, an algorithm for outlier splicing detection in rare disease cohorts. We demonstrate the statistical and practical improvements that result from LeafCutterMD using simulated and real data analyses. The rigorous Dirichlet-Multinomial model that underlies LeafCutterMD accounts for both biological variability in the cohort as well as the uncertainties due to statistical sampling. Our framework naturally accounts for variations in the total number of observations within a cluster, which could vary due to changes in expression levels, or experimental artifacts such as variation in library sizes. Importantly, we have demonstrated by simulation that this updated method outperforms the original LeafCutter when the event of interest is embedded in increasingly large clusters of complex splicing patterns.</p>
    <p>We argue that loss of power occurs when applying LeafCutter to a one versus many comparison setting for which it was not specifically designed. Interestingly, as the total read counts grow larger, aberrant splicing events that are supported by a decreasingly smaller fraction of the total number of junction reads are steadily more difficult to detect using the likelihood ratio test implemented in LeafCutter. By contrast, LeafCutterMD maintains high power for all parameters of this simulation. The conservative nature of LeafCutterMD is due to the regularization of the Laplace smoothing as well as the computational approximation discussed in Section 2 whereby the model is fit on all samples including the potential outlier sample. Also as discussed in Section 2, a more powerful, nonconservative test can be used at the cost of added computations by leaving the proband out of the estimation of the parameters from the rest of the cohort. However, the difference between these methods becomes negligible as the cohort size becomes very large. Because the added computational expense scales linearly with cohort size, the less conservative approach is only advised when analyzing a small cohort of probands, where the additional power will be beneficial and the additional computations will be minor.</p>
    <p>As the analysis of our patient data indicates, large clusters occur frequently in genes of biological relevance, which can cause the standard LeafCutter to miss events that are identified using LeafCutterMD. We expect this to be an issue of increasing importance as the number of individuals in the cohort increases, because the intron clustering step is performed considering all samples simultaneously. In practice, this can result in increasing cluster sizes as cohorts grow. But these increasing cohorts are important to the outlier detection problem as a large cohort provides a better understanding of normal variability in intron utilization, and thus the robustness to growing cluster sizes is a critical feature of the proposed methodology.</p>
    <p>When building a rare disease cohort in which to test for splicing aberrations, there are a few experimental design considerations that will optimize performance. The cohort should be built from individuals with suspected heterogeneous disorders. If many individuals with the same disorder appear in the cohort, it is possible that their aberrant splicing patterns would no longer represent outliers within this cohort; in the case of a group of samples with the same underlying phenotype, the original LeafCutter algorithm should be utilized to compare this group against a group of normal samples. In general, normal samples such as those found in GTEx could be utilized to create or supplement a cohort of samples. But special care should be taken to ensure that different RNA sequencing chemistries do not enter the cohort without some sort of correction in the junction counts to account for the biases between chemistries. For example, a poly-A pull down chemistry might be more biased to observing junctions splicing near the poly-A tail as compared to a targeted capture chemistry. Where feasible, we suggest building a cohort from samples following identical sequencing protocols.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa259_Supplementary_Data</label>
      <media xlink:href="btaa259_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank Dr. Stephan J. Sanders for his helpful comments that improved this manuscript, as well as an anonymous reviewer for their constructive feedback.</p>
    <sec>
      <title>Funding</title>
      <p>This research was supported in part by the RADiaNT study funded by the Mayo Clinic Center for Individualized Medicine.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa259-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Coombes</surname><given-names>K.R.</given-names></string-name></person-group> (<year>2018</year>) <italic toggle="yes">TailRank: The Tail-Rank Statistic.</italic> R package version 3.6.0.</mixed-citation>
    </ref>
    <ref id="btaa259-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cummings</surname><given-names>B.B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Improving genetic diagnosis in Mendelian disease with transcriptome sequencing</article-title>. <source>Sci. Transl. Med</source>., <volume>9</volume>, <fpage>eaal5209</fpage>.<pub-id pub-id-type="pmid">28424332</pub-id></mixed-citation>
    </ref>
    <ref id="btaa259-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danaher</surname><given-names>P.J.</given-names></string-name></person-group> (<year>1988</year>) 
<article-title>Parameter estimation for the dirichlet-multinomial distribution using supplementary beta-binomial data</article-title>. <source>Commun. Stat. Theory Methods</source>, <volume>17</volume>, <fpage>1777</fpage>–<lpage>1788</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa259-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fergelot</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Phenotype and genotype in 52 patients with Rubinstein–Taybi syndrome caused by ep300 mutations</article-title>. <source>Am. J. Med. Genet. A</source>, <volume>170</volume>, <fpage>3069</fpage>–<lpage>3082</lpage>.<pub-id pub-id-type="pmid">27648933</pub-id></mixed-citation>
    </ref>
    <ref id="btaa259-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Holmes</surname><given-names>I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) 
<article-title>Dirichlet multinomial mixtures: generative models for microbial metagenomics</article-title>. <source>PLoS One</source>, <volume>7</volume>, <fpage>e30126</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">22319561</pub-id></mixed-citation>
    </ref>
    <ref id="btaa259-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jaganathan</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Predicting splicing from primary sequence with deep learning</article-title>. <source>Cell</source>, <volume>176</volume>, <fpage>535</fpage>–<lpage>548.e24</lpage>.<pub-id pub-id-type="pmid">30661751</pub-id></mixed-citation>
    </ref>
    <ref id="btaa259-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kremer</surname><given-names>L.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Genetic diagnosis of Mendelian disorders via RNA sequencing</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>15824</fpage>.<pub-id pub-id-type="pmid">28604674</pub-id></mixed-citation>
    </ref>
    <ref id="btaa259-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Y.I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Annotation-free quantification of RNA splicing using LeafCutter</article-title>. <source>Nat. Genet</source>., <volume>50</volume>, <fpage>151</fpage>–<lpage>158</lpage>.<pub-id pub-id-type="pmid">29229983</pub-id></mixed-citation>
    </ref>
    <ref id="btaa259-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Posey</surname><given-names>J.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Molecular diagnostic experience of whole-exome sequencing in adult patients</article-title>. <source>Genet. Med</source>., <volume>18</volume>, <fpage>678</fpage>–<lpage>685</lpage>.<pub-id pub-id-type="pmid">26633545</pub-id></mixed-citation>
    </ref>
    <ref id="btaa259-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sawyer</surname><given-names>S.L.</given-names></string-name></person-group>, FORGE Canada Consortium <etal>et al</etal> (<year>2016</year>) 
<article-title>Utility of whole-exome sequencing for those near the end of the diagnostic odyssey: time to address gaps in care</article-title>. <source>Clin. Genet</source>., <volume>89</volume>, <fpage>275</fpage>–<lpage>284</lpage>.<pub-id pub-id-type="pmid">26283276</pub-id></mixed-citation>
    </ref>
    <ref id="btaa259-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Clinical whole-exome sequencing for the diagnosis of Mendelian disorders</article-title>. <source>N. Engl. J. Med</source>., <volume>369</volume>, <fpage>1502</fpage>–<lpage>1511</lpage>.<pub-id pub-id-type="pmid">24088041</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
