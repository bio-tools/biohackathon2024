<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9923442</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad015</article-id>
    <article-id pub-id-type="publisher-id">vbad015</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DISCO+QR: rooting species trees in the presence of GDL and ILS</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8496-3597</contrib-id>
        <name>
          <surname>Willson</surname>
          <given-names>James</given-names>
        </name>
        <aff><institution>Department of Computer Science, University of Illinois Urbana-Champaign</institution>, Urbana, IL 61801, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7811-5989</contrib-id>
        <name>
          <surname>Tabatabaee</surname>
          <given-names>Yasamin</given-names>
        </name>
        <aff><institution>Department of Computer Science, University of Illinois Urbana-Champaign</institution>, Urbana, IL 61801, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4210-8269</contrib-id>
        <name>
          <surname>Liu</surname>
          <given-names>Baqiao</given-names>
        </name>
        <aff><institution>Department of Computer Science, University of Illinois Urbana-Champaign</institution>, Urbana, IL 61801, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7717-3514</contrib-id>
        <name>
          <surname>Warnow</surname>
          <given-names>Tandy</given-names>
        </name>
        <xref rid="vbad015-cor1" ref-type="corresp"/>
        <!--warnow@illinois.edu-->
        <aff><institution>Department of Computer Science, University of Illinois Urbana-Champaign</institution>, Urbana, IL 61801, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Lengauer</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad015-cor1">To whom correspondence should be addressed. <email>warnow@illinois.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-02-07">
      <day>07</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>07</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad015</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>21</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>31</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>06</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>13</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad015.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Genes evolve under processes such as gene duplication and loss (GDL), so that gene family trees are multi-copy, as well as incomplete lineage sorting (ILS); both processes produce gene trees that differ from the species tree. The estimation of species trees from sets of gene family trees is challenging, and the estimation of rooted species trees presents additional analytical challenges. Two of the methods developed for this problem are STRIDE, which roots species trees by considering GDL events, and Quintet Rooting (QR), which roots species trees by considering ILS.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present DISCO+QR, a new approach to rooting species trees that first uses DISCO to address GDL and then uses QR to perform rooting in the presence of ILS. DISCO+QR operates by taking the input gene family trees and decomposing them into single-copy trees using DISCO and then roots the given species tree using the information in the single-copy gene trees using QR. We show that the relative accuracy of STRIDE and DISCO+QR depend on the properties of the dataset (number of species, genes, rate of gene duplication, degree of ILS and gene tree estimation error), and that each provides advantages over the other under some conditions.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>DISCO and QR are available in github.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Grainger Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100008074</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The estimation of rooted species trees is a basic step in many biological research problems, including the detection of selection, understanding adaptation, the timing of evolutionary events, etc. Over the last several years (and especially the last decade), there has been remarkable progress in developing methods that have strong statistical guarantees and high accuracy for estimating species trees, typically from multi-locus datasets, but these methods only produce unrooted trees (<xref rid="vbad015-B7" ref-type="bibr">Chifman and Kubatko, 2014</xref>; <xref rid="vbad015-B16" ref-type="bibr">Mirarab <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="vbad015-B18" ref-type="bibr">Ogilvie <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="vbad015-B28" ref-type="bibr">Vachaspati and Warnow, 2015</xref>).</p>
    <p>Several methods have been developed and are in wide use for rooting estimated species trees, including using an outgroup species (i.e. a species that is not in the clade defined by the other species) to root the species tree and midpoint rooting (i.e. rooting the species tree at the midpoint of the longest leaf-to-leaf path). While both of these methods are popular, neither is completely reliable. For example, outgroup selection is challenging since: (i) if the putative outgroup is a true outgroup but very distantly related, finding the edge to which the outgroup species attaches can be difficult (due to accumulation of mutations) and (ii) some putative outgroups may be in fact not outgroups [a challenge that can occur when the root of the phylogeny is a rapid radiation (<xref rid="vbad015-B24" ref-type="bibr">Shavit <italic toggle="yes">et al.</italic>, 2007</xref>)]. For these, as well as other reasons (<xref rid="vbad015-B20" ref-type="bibr">Pearson <italic toggle="yes">et al.</italic>, 2013</xref>), outgroup selection is challenging and unreliable in practice. The problem with midpoint rooting is that evolutionary changes are not always clocklike (<xref rid="vbad015-B2" ref-type="bibr">Ayala, 1999</xref>; <xref rid="vbad015-B19" ref-type="bibr">Pascual-García <italic toggle="yes">et al.</italic>, 2019</xref>), and when the deviation from the clock is sufficient, midpoint rooting can be inaccurate. Thus, these two standard approaches to rooting species trees are unreliable.</p>
    <p>In the last few years, new methods have been developed that take a statistical approach to rooting species trees from multi-gene datasets based on models of gene evolution within species trees. For example, STRIDE (<xref rid="vbad015-B8" ref-type="bibr">Emms and Kelly, 2017</xref>) is a method for rooting species trees from multi-copy gene family trees that result from gene duplications and losses (GDL). Another method that has been developed is Quintet Rooting (QR) (<xref rid="vbad015-B25" ref-type="bibr">Tabatabaee <italic toggle="yes">et al.</italic>, 2022a</xref>), which is a method for rooting species trees from single-copy gene trees that can differ from the species tree due to incomplete lineage sorting (ILS).</p>
    <p>In this study, we present a new approach for rooting species trees that can address both GDL and ILS. Our approach is a combination of QR, which can only work with single-copy gene trees and is based on ILS alone, and a previous method, DISCO (<xref rid="vbad015-B30" ref-type="bibr">Willson <italic toggle="yes">et al.</italic>, 2022</xref>), for breaking gene family trees into single-copy gene trees. The combination of these two methods, DISCO+QR, operates by using DISCO to break each gene family tree into single-copy gene trees and then applies QR to the resultant single-copy gene trees. This surprisingly simple approach is fast (polynomial time and fast in practice). Our simulation study evaluating DISCO+QR in comparison to STRIDE shows that each has a range of conditions where it is more accurate than the other, with STRIDE generally more accurate when ILS is low and GDL rates are high, and DISCO+QR more accurate when ILS is high.</p>
  </sec>
  <sec>
    <title>2 Background</title>
    <sec>
      <title>2.1 Estimating unrooted species trees under GDL+ILS</title>
      <p>When genes evolve under processes that include duplications and losses, then their phylogenies have multiple copies of each species, so that the gene trees are referred to as gene family trees (or MUL-trees). Many methods have been developed for estimating species trees from gene family trees, with gene tree parsimony approaches (i.e. minimizing the total number of duplications and losses, and weighted versions of these criteria) (<xref rid="vbad015-B4" ref-type="bibr">Chaudhary <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="vbad015-B29" ref-type="bibr">Wehe <italic toggle="yes">et al.</italic>, 2008</xref>) perhaps the most well-known. Other approaches include variations of supertree methods to allow for MUL-tree inputs; examples of such methods include MulRF (<xref rid="vbad015-B5" ref-type="bibr">Chaudhary <italic toggle="yes">et al.</italic>, 2015</xref>) and FastMulRFS (<xref rid="vbad015-B17" ref-type="bibr">Molloy and Warnow, 2020</xref>). Yet, none of these methods has been proven statistically consistent for estimating the species tree.</p>
      <sec>
        <title>2.1.1 Quartet-based methods</title>
        <p>The first results for statistical consistency and identifiability under any GDL model were provided in <xref rid="vbad015-B12" ref-type="bibr">Legried <italic toggle="yes">et al.</italic> (2021)</xref>, who proved that for every four species, the most frequently observed quartet tree (among the gene family trees) would be topologically identical to the species tree. This result established that properly designed quartet-based methods would be statistically consistent for species tree estimation in the presence of GDL. This theorem was later extended to show quartet-based methods, when properly designed, would be statistically consistent under a joint model for GDL and ILS [the DLCOAL model (<xref rid="vbad015-B22" ref-type="bibr">Rasmussen and Kellis, 2012</xref>)] in <xref rid="vbad015-B15" ref-type="bibr">Markin and Eulenstein (2021)</xref>.</p>
        <p>Subsequent to these studies that established statistical identifiability using quartet trees (and hence potential statistical consistency of methods based on quartet trees), quartet-based methods have been developed for species tree estimation in the presence of GDL and ILS, and some of these have been proven statistically consistent. Specifically, ASTRAL-one and ASTRAL-multi are two ways of running the ASTRAL species tree estimation method (which is also based on quartet trees) that are established statistically consistent under the DLCOAL model. ASTRAL-Pro (<xref rid="vbad015-B32" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2020</xref>) is a new variant of ASTRAL specifically designed to address GDL; several simulation studies have shown it is more accurate than ASTRAL-multi and ASTRAL-one, but it has not yet been proven statistically consistent.</p>
      </sec>
      <sec>
        <title>2.1.2 ASTRID-DISCO</title>
        <p>Another approach for estimating species trees from gene family trees that has very good accuracy, comparable to ASTRAL-Pro (sometimes more accurate) but also faster, is ASTRID-DISCO, which we now describe.</p>
        <p>ASTRID (<xref rid="vbad015-B28" ref-type="bibr">Vachaspati and Warnow, 2015</xref>) is a polynomial time method for estimating unrooted species trees from unrooted gene trees that is statistically consistent under the multispecies coalescent model; thus, ASTRID addresses species tree estimation when ILS is present but does not address GDL. ASTRID operates by computing the matrix of average internode distances between species and then runs distance-based methods [e.g. FastME (<xref rid="vbad015-B11" ref-type="bibr">Lefort <italic toggle="yes">et al.</italic>, 2015</xref>) with balanced minimum evolution] to produce the species tree.</p>
        <p>DISCO is a method for decomposing a gene family tree (which can contain multiple copies of each species) into a set of single-copy gene trees. DISCO operates using two steps. In the first step, it ‘roots-and-tags’ the gene family tree, which means that it finds a root location that implies the smallest total number of duplication and loss events, and uses that rooting to identify the nodes that are duplication events (this is the ‘tagging’ step); this is the same technique used in ASTRAL-Pro. The second step then decomposes the tree into single-copy trees at the duplication events, seeking to keep at least one large subtree. The two steps together thus decompose a single gene family tree into a set of single-copy gene trees. As shown in <xref rid="vbad015-B30" ref-type="bibr">Willson <italic toggle="yes">et al.</italic> (2022)</xref>, if ASTRAL-Pro correctly roots and tags the gene family tree, then the single-copy gene trees produced by DISCO contain only orthologs.</p>
        <p>In ASTRID-DISCO, each gene family tree in the input set of gene family trees is split into single-copy trees using DISCO (<xref rid="vbad015-B30" ref-type="bibr">Willson <italic toggle="yes">et al.</italic>, 2022</xref>), and then ASTRID is applied to the set of single-copy trees to estimate the species tree. As shown in <xref rid="vbad015-B30" ref-type="bibr">Willson <italic toggle="yes">et al.</italic> (2022)</xref>, ASTRID-DISCO was generally more accurate than the other leading species tree estimation methods, including ASTRAL-Pro (<xref rid="vbad015-B32" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2020</xref>), under a wide range of model conditions. Moreover, ASTRID-DISCO is very fast, since both ASTRID and DISCO are low-degree polynomial time; and in particular, ASTRID-DISCO is faster than ASTRAL-Pro. Thus, ASTRID-DISCO matches or improves on the accuracy and speed of ASTRAL-Pro and other methods for species tree estimation.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Rooting species trees using STRIDE</title>
      <p>STRIDE is a method designed to root species trees given a set of unrooted multi-copy gene family trees, assuming that all gene tree heterogeneity is due to GDL. It determines a set of ‘strongly supported’ duplication events given an unrooted species tree and the unrooted gene family trees then uses this set of duplications to find the best rooting for the species tree. STRIDE outputs both a species tree—rooted on the edge it judges to be the best—and a file listing all of the maximum parsimony roots (roots that minimize the number of duplication events needed to explain them) and the probability that each edge could be the root.</p>
      <p>In the study in <xref rid="vbad015-B8" ref-type="bibr">Emms and Kelly (2017)</xref>, STRIDE was applied to a collection of biological datasets from different groups of species and three previously published simulated datasets, where two of the simulated datasets contained both GDL and ILS. Most of these datasets had very large numbers of gene family trees (ranging from 8392 to 28 356 for the biological datasets and on average ≈7200 for the simulated datasets) and varying numbers of species, from 5 to 47.</p>
      <p>STRIDE had very good performance on these datasets, and was able to find the correct root on 12 out of 15 datasets. Although STRIDE was not directly compared to any other rooting method, its gene duplication prediction accuracy was compared to two reconciliation methods, Notung (<xref rid="vbad015-B6" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2000</xref>) and DLCpar_search (<xref rid="vbad015-B31" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2014</xref>) and was shown to outperform them.</p>
    </sec>
    <sec>
      <title>2.3 Rooting species trees using QR</title>
      <p>QR is a method for rooting species trees given a set of unrooted single-copy gene trees, assuming that all gene tree heterogeneity is due to ILS. QR is based on the proof of identifiability of rooted species trees with at least five taxa from unrooted gene trees under the Multi-Species Coalescent (MSC) provided by Allman, Degnan and Rhodes (ADR) (<xref rid="vbad015-B1" ref-type="bibr">Allman <italic toggle="yes">et al.</italic>, 2011</xref>). Specifically, ADR establish a set of inequalities and invariants that must hold among the probabilities of the true gene trees under each 5-taxon model species tree and prove that these inequalities and invariants are sufficient to identify the rooted species tree topology on five taxa.</p>
      <p>QR assigns a cost to each possible rooting of a given unrooted species tree based on the probability distribution that it computes over a selected set of quintets in the gene trees. It operates by selecting a set of quintets of taxa from the leafset of the input tree (referred to as ‘quintet sampling’), and in a pre-processing step, it computes a cost for each possible rooting of these quintet trees. The cost (referred to as the ‘score’) of each rooted tree is then computed by summing up the costs over all its induced rooted quintets, and the tree with the minimum score is returned as the best possible rooting. Similar to STRIDE, QR also returns an additional file containing a score and a ranking for all possible rootings of the input tree (each corresponding to the root being located on one edge in the unrooted tree).</p>
      <p>QR can be used with different quintet sampling methods that differ in terms of their runtime and accuracy. Two sampling methods proposed in <xref rid="vbad015-B25" ref-type="bibr">Tabatabaee <italic toggle="yes">et al.</italic> (2022a</xref>) are ‘exhaustive’ and ‘linear encoding (LE)’ samplings, where the first computes a cost for all <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>5</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> quintets of taxa, but the second looks at a carefully chosen set of <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> quintets (where <italic toggle="yes">n</italic> is the number of species) using an encoding that maps each edge in the unrooted tree to a single quintet. A previous study in <xref rid="vbad015-B25" ref-type="bibr">Tabatabaee <italic toggle="yes">et al.</italic> (2022a)</xref> showed that the exhaustive mode of QR is generally more accurate than LE, as it is based on more information; however, it is significantly slower. QR is polynomial time when used with both sampling methods, and the detailed runtime analysis with each sampling method is provided in Section 3.</p>
      <p>In <xref rid="vbad015-B25" ref-type="bibr">Tabatabaee <italic toggle="yes">et al.</italic> (2022a)</xref>, QR was compared with four other rooting methods, midpoint (<xref rid="vbad015-B10" ref-type="bibr">Hess and De Moraes Russo, 2007</xref>), minimum ancestor deviation (<xref rid="vbad015-B27" ref-type="bibr">Tria <italic toggle="yes">et al.</italic>, 2017</xref>), minimum variance rooting (MinVar) (<xref rid="vbad015-B13" ref-type="bibr">Mai <italic toggle="yes">et al.</italic>, 2017</xref>) and RootDigger (<xref rid="vbad015-B3" ref-type="bibr">Bettisworth and Stamatakis, 2021</xref>) and was shown to have better or comparable accuracy to other rooting methods on a set of simulated datasets and 5-taxon subsets of an avian biological dataset. The experimental study by <xref rid="vbad015-B25" ref-type="bibr">Tabatabaee <italic toggle="yes">et al.</italic> (2022a)</xref> explored rooting both true and estimated species trees given true or estimated single-copy gene trees as input, when ILS was the only source of discordance, and QR had very good relative accuracy on these datasets except when gene tree estimation error (GTEE) was very high.</p>
    </sec>
  </sec>
  <sec>
    <title>3 DISCO+QR</title>
    <p>DISCO+QR is a new approach for rooting species trees given a set of gene family trees. Operationally, it is very simple: Given the input gene family trees, DISCO is used to split each gene family tree into single-copy trees. Then, QR is used to root the input species tree with respect to the single-copy trees. The idea behind DISCO+QR is that if DISCO is successful, then each single-copy tree contains only orthologs, and any remaining discordance between the resulting single-copy gene trees and the species trees is assumed due to ILS and potentially GTEE. Under these circumstances, the species tree can be rooted with high accuracy if there is enough ILS, so that the single-copy gene trees can identify the root location.<statement id="mthst1"><label>Theorem 1</label><p><italic toggle="yes">The time complexity of DISCO+QR is</italic> <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>Q</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula><italic toggle="yes">, where Q is the set of sampled quintets in QR, N is the total number of leaves in all multi-copy gene family trees, and n is the number of taxa in the species tree. Hence, when using the linear encoding, DISCO+QR uses</italic> <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula><italic toggle="yes">time.</italic></p></statement></p>
    <p><bold>Proof.</bold> We divide the DISCO+QR pipeline into three steps:
</p>
    <list list-type="order">
      <list-item>
        <p>Run DISCO to decompose the gene-family trees into single-copy gene trees.</p>
      </list-item>
      <list-item>
        <p>QR Pre-processing: Compute the cost for each of the seven possible rootings of an unrooted quintet tree induced on each quintet in set <italic toggle="yes">Q</italic>.</p>
      </list-item>
      <list-item>
        <p>QR Scoring: Compute the score for all <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> different rootings of the input unrooted species tree.</p>
      </list-item>
    </list>
    <p>In <xref rid="sup1" ref-type="supplementary-material">Supplementary Proposition S1.1</xref>, we prove that the runtime of the DISCO decomposition step is <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In <xref rid="sup1" ref-type="supplementary-material">Supplementary Proposition S1.2</xref>, we prove that the pre-processing step of QR is done in <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>Q</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> time, where <italic toggle="yes">k</italic> is the number of single-copy gene trees given as input to QR. Note that <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> since DISCO can output at most <italic toggle="yes">N</italic> single-copy gene trees, and therefore the runtime of QR pre-processing is bounded by <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>Q</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In <xref rid="sup1" ref-type="supplementary-material">Supplementary Proposition S1.3</xref>, we prove that the scoring step of QR can be done in <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mi>Q</mml:mi><mml:mo>|</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">n</italic> is the number of taxa in the species tree. The total runtime of QR is the sum of the three parts, which is <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>|</mml:mo><mml:mi>Q</mml:mi><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In particular, when QR is used with LE sampling, the total running time of DISCO+QR reduces to <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. ▪</p>
    <p>The proofs of Propositions S1.1, S1.2 and S1.3 are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Materials Section S1</xref>.</p>
  </sec>
  <sec>
    <title>4 Experimental study</title>
    <sec>
      <title>4.1 Overview</title>
      <p>We use a collection of simulated datasets (some new and others from prior studies) to evaluate DISCO+QR in comparison to STRIDE. Our datasets vary in terms of levels of ILS (low and moderate) and GDL (six different levels) and have varying numbers of genes. Our model conditions use gene trees estimated using maximum likelihood and so vary in terms of estimation error. We ran four experiments, with Experiments 1–3 examining conditions with 20 species and two levels of ILS, and Experiment 4 examined larger numbers of species (up to 1000). In each experiment, we evaluated accuracy on the root location when given a species tree estimated using ASTRID-DISCO (described above).</p>
      <p>We report error in the root location using average normalized clade distance (nCD), which is an extension of Robinson–Foulds (RF) (<xref rid="vbad015-B23" ref-type="bibr">Robinson and Foulds, 1981</xref>) distance for rooted trees and can be computed using the following formula
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="italic">Clades</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>\</mml:mo><mml:mi mathvariant="italic">Clades</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="italic">Clades</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>\</mml:mo><mml:mi mathvariant="italic">Clades</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">R</italic> are true and estimated rooted species trees respectively and <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">Clades</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the set of all clades of a rooted tree <italic toggle="yes">t</italic>. The clade distance is also a measure of distance to the root and is equal to twice the root distance (distance of the estimated root position to the true root) when rooting the true species tree topology (<xref rid="vbad015-B25" ref-type="bibr">Tabatabaee <italic toggle="yes">et al.</italic>, 2022a</xref>).</p>
      <p>For full details of the experimental study, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Materials</xref>. All software and datasets are freely available (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Appendix SA</xref>).</p>
    </sec>
    <sec>
      <title>4.2 Datasets</title>
      <p>We used simulated data containing GDL, ILS, and GTEE from <xref rid="vbad015-B30" ref-type="bibr">Willson <italic toggle="yes">et al.</italic> (2022)</xref>, as well as new data simulated for this study.</p>
      <sec>
        <title>4.2.1 Data simulation</title>
        <p>We simulated the new data for this study using a pipeline similar to <xref rid="vbad015-B17" ref-type="bibr">Molloy and Warnow (2020)</xref>, <xref rid="vbad015-B32" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> (2020)</xref> and <xref rid="vbad015-B30" ref-type="bibr">Willson <italic toggle="yes">et al.</italic> (2022)</xref>: First, the true species tree and the true gene trees are simulated with SimPhy (<xref rid="vbad015-B14" ref-type="bibr">Mallo <italic toggle="yes">et al.</italic>, 2016</xref>). We use INDELible (<xref rid="vbad015-B9" ref-type="bibr">Fletcher and Yang, 2009</xref>) to evolve sequences down the true gene trees and then estimate gene trees from these sequences with the maximum likelihood method, FastTree2 (<xref rid="vbad015-B21" ref-type="bibr">Price <italic toggle="yes">et al.</italic>, 2010</xref>).</p>
        <p>The duplication rates and loss rates are controlled directly through SimPhy, while we control the level of ILS using the haploid effective population size. We also set several options to ensure that the evolution diverges from a strict molecular clock (i.e. branch rate heterogeneity modifiers). Our new datasets contain 21 species (20 species and an additional outgroup taxon), 1000 gene trees per replicate and varies the duplication rates under two levels of ILS; all model conditions also contain two levels of GTEE (estimated from 100 bp and 50 bp sequences). The ILS level is measured in terms of average distance (AD), which is the average normalized RF distance between the locus trees (which are true gene family trees with GDL but before modification by ILS) and true gene family trees (which reflect both ILS and GDL). More details, including the commands used, are in <xref rid="sup1" ref-type="supplementary-material">Supplementary Materials</xref>.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>5 Results</title>
    <sec>
      <title>5.1 Experiment 1: Varying the duplication rate</title>
      <p>Our first experiment compared differing duplication rates at two levels of ILS (<xref rid="vbad015-F1" ref-type="fig">Fig. 1</xref>) while holding the number of gene trees to 1000 and the amount of estimation error to moderate (about 40% MGTE). The clearest trend is that STRIDE is greatly affected by the duplication rate; at moderate to extremely high-duplication rates (<inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), it performs well; however, as the duplication rate lowers (<inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>13</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), its performance degrades. On the other hand, DISCO+QR seems largely unaffected by the duplication rates; instead, its performance is mostly impacted by the ILS levels. At the greatest level of ILS, it performs almost as well as STRIDE, even outperforming it at low levels of GDL, while with little ILS, its accuracy degrades. STRIDE does worse at high rates of ILS compared to low rates of ILS, but the differences are very small for all but the lowest duplication rate.</p>
      <fig position="float" id="vbad015-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Results on 21-species datasets, showing impact of varying the duplication rate on rooting error (nCD) of STRIDE and DISCO+QR, given at two levels of ILS; low ILS in (<bold>a</bold>) (AD <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>) and high ILS in (<bold>b</bold>) (AD <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>64</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>). The species tree was estimated with ASTRID-DISCO. The simulated model conditions contain 1000 genes, 10 replicates, a loss rate equal to the duplication rate and <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula>40% MGTE. <italic toggle="yes">Note</italic>: Circles are means, and bars are medians</p>
        </caption>
        <graphic xlink:href="vbad015f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>5.2 Experiment 2: Varying GTEE</title>
      <p>In Experiment 2, we evaluated the effect of GTEE on both methods (<xref rid="vbad015-F2" ref-type="fig">Fig. 2</xref>). Notably, we keep the duplication rate fixed at <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where STRIDE outperforms DISCO+QR under the condition with low ILS and DISCO+QR outperforms STRIDE with high ILS. These trends continue under all levels of GTEE. The impact of ILS on STRIDE, however, is much clearer under conditions with very low GTEE (the two lowest conditions examined); under these low GTEE conditions, STRIDE’s performance is much worse when ILS is high than when it is low.</p>
      <fig position="float" id="vbad015-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Results on 21-species datasets, showing impact of varying the amount of GTEE on the rooting error (nCD) of STRIDE and DISCO+QR, given at two levels of ILS; low ILS in (<bold>a</bold>) (AD <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>) and high ILS in (<bold>b</bold>) (AD <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>64</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>). The species tree was estimated with ASTRID-DISCO. The simulated model conditions contain 1000 genes, 10 replicates, a duplication rate of <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and an equal loss rate, and AD <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>. <italic toggle="yes">Note</italic>: Circles are means, and bars are medians</p>
        </caption>
        <graphic xlink:href="vbad015f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>5.3 Experiment 3: Varying the number of genes</title>
      <p>In this experiment, we varied the number of genes (<xref rid="vbad015-F3" ref-type="fig">Fig. 3</xref>). Again, we fix the duplication rate at <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and examine both levels of ILS. As expected, both STRIDE and DISCO+QR become more accurate as the number of genes increases, but the relative accuracy remains the same (with DISCO+QR more accurate than STRIDE for high ILS and STRIDE more accurate than DISCO+QR for low ILS). The number of gene trees has a larger impact on the accuracy of STRIDE and DISCO+QR under the high ILS condition than under the low ILS condition (where accuracy seems largely unaffected until 1000 genes).</p>
      <fig position="float" id="vbad015-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Results on 21-species datasets, showing impact of varying the number of gene trees on the rooting error (nCD) of STRIDE and DISCO+QR, given at two levels of ILS; low ILS in (<bold>a</bold>) (AD <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>) and high ILS in (<bold>b</bold>) (AD <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>64</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>). The species tree was estimated with ASTRID-DISCO. The simulated model conditions contain 10 replicates, a duplication rate of <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and an equal loss rate, AD <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>40</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> MGTE. <italic toggle="yes">Note</italic>: Circles are means, and bars are medians</p>
        </caption>
        <graphic xlink:href="vbad015f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>5.4 Experiment 4: Examining larger numbers of species</title>
      <p>We now examine trends on larger numbers of species (up to 1000).</p>
      <sec>
        <title>5.4.1 Moderate duplication rate and 20–100 species</title>
        <p><xref rid="vbad015-F4" ref-type="fig">Figure 4</xref> examines conditions with 1000 genes and moderate duplication rate (<inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), equal loss rate, moderate GTEE, two levels of ILS (low and moderately high), while varying the number of species from 20 to 100. The first observation is that in general error rates decrease with the number of species (although the benefit to DISCO+QR under high ILS is relatively small). The second observation is that DISCO+QR continues to be more accurate than STRIDE for all numbers of species for the high ILS condition, but the gap between them decreases with the number of species. The third observation is that while STRIDE is more accurate than DISCO+QR at 20 species and low ILS, the two are essentially tied at 50 species and then DISCO+QR is more accurate at 100 species (but only by a small amount).</p>
        <fig position="float" id="vbad015-F4">
          <label>Fig. 4.</label>
          <caption>
            <p>Impact of varying the number of species on the rooting error (nCD) of STRIDE and DISCO+QR, given moderate duplication rates. (<bold>a</bold>) Low ILS (AD <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>) and (<bold>b</bold>) high ILS (AD <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>64</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>). The species tree was estimated with ASTRID-DISCO. The simulated model conditions contain 1000 genes, 10 replicates, a moderate duplication rate of <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and an equal loss rate, and <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>40</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> MGTE. <italic toggle="yes">Note</italic>: Circles are means, and bars are medians</p>
          </caption>
          <graphic xlink:href="vbad015f4" position="float"/>
        </fig>
        <p>Thus, although our experiments on 20 species consistently showed an advantage of STRIDE over DISCO+QR when ILS was low, this advantage is no longer shown on larger numbers of species, where DISCO+QR was tied with STRIDE at 50 species and then more accurate than STRIDE on 100 species. However, this specific experiment was only under a moderate duplication rate, leaving open the question of what would happen when the duplication rate is higher.</p>
      </sec>
      <sec>
        <title>5.4.2 High duplication rates, low ILS and 100 species</title>
        <p>The next experiment evaluated STRIDE and DISCO+QR with l00 species and high duplication rates. <xref rid="vbad015-F5" ref-type="fig">Figure 5</xref> shows results as we vary the number of genes from 100 to 1000, for three high duplication rates (varying from <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). The following trends are clear. First, at 1000 genes, STRIDE is very accurate, with mean nCD ranging from 0.033 to 0.057, while DISCO+QR has higher mean nCD that range from 0.112 to 0.133. For 500 genes, STRIDE is still highly accurate, with mean nCD between 0.045 and 0.065 at all tested duplication rates, and DISCO+QR is again less accurate but still reasonable (mean nCD between 0.126 and 0.151). At 100 genes, the error increases for both STRIDE and DISCO+QR (mean nCD for STRIDE between 0.116 and 0.277, and between 0.147 and 0.318 for DISCO+QR), so that while STRIDE maintains an advantage over DISCO+QR, the improvement in accuracy has decreased.</p>
        <fig position="float" id="vbad015-F5">
          <label>Fig. 5.</label>
          <caption>
            <p>Results on 101-species datasets, evaluating impact of varying number of genes under three high duplication rates and low ILS on the rooting error (nCD) of STRIDE and DISCO+QR on simulated datasets with varying numbers of genes. (<bold>a</bold>) 1000 genes, (<bold>b</bold>) 500 genes and (<bold>c</bold>) 100 genes. The species tree was estimated with ASTRID-DISCO. The simulated model conditions contain 10 replicates, a loss rate equal to the duplication rate, AD <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>40</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> MGTE. <italic toggle="yes">Note</italic>: Circles are means, and bars are medians</p>
          </caption>
          <graphic xlink:href="vbad015f5" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>5.4.3 High duplication rates, low ILS and 1000 species</title>
        <p>Results on 1000 species, 100–1000 genes, and high duplication rates are shown in <xref rid="vbad015-F6" ref-type="fig">Figure 6</xref>. At 1000 genes, both STRIDE and DISCO+QR have excellent accuracy, with mean nCD of 0.054 and 0.066, respectively. Moreover, with lower numbers of genes, error increases for both STRIDE and DISCO+QR but only modestly, so that at 500 genes the mean nCDs are still very low (0.06 for STRIDE and 0.07 for DISCO+QR). Interestingly, with only 100 genes, DISCO+QR (mean nCD of 0.081) has an accuracy advantage over STRIDE (mean nCD of 0.262); the explanation is that STRIDE has some outliers with very high (1.0) nCD values.</p>
        <fig position="float" id="vbad015-F6">
          <label>Fig. 6.</label>
          <caption>
            <p>Results on 1001-species datasets, with varying numbers of genes. The species tree was estimated with ASTRID-DISCO. The simulated model conditions contain 10 replicates, a duplication rate of <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and an equal loss rate, AD <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>40</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> MGTE. <italic toggle="yes">Note</italic>: Circles are means, and bars are medians</p>
          </caption>
          <graphic xlink:href="vbad015f6" position="float"/>
        </fig>
        <p>Overall, therefore, for the 1000-species condition we explored (a low ILS condition with high duplication rates), STRIDE and DISCO+QR are extremely close for 500 and 1000 genes (never off by more than 0.012 in nCD), but with an advantage to DISCO+QR for the 100-gene case. This is a surprising contrast to the datasets with fewer species.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>6 Discussion</title>
    <p>This study evaluated STRIDE and DISCO+QR under a range of model conditions with varying ILS, GDL, number of genes, number of species and GTEE. For both STRIDE and DISCO+QR, accuracy increased with number of genes and decreases in GTEE; this is consistent with many other studies. For conditions with only 20 species, in general STRIDE had an advantage over DISCO+QR when there was low ILS and DISCO+QR had an advantage over STRIDE under high ILS. The relative performance was also impacted by duplication rates, with low duplication rates favoring DISCO+QR and high duplication rates favoring STRIDE. As the number of species increased from 20 to as high as 1000, the trends changed, with DISCO+QR beginning to show advantages over STRIDE even when ILS was low and duplication rates were higher. The results on 1000 species are especially interesting, since on that model condition STRIDE and DISCO+QR are extremely close on 500 or more genes, but with an advantage to DISCO+QR for 100 genes. The model condition also has low ILS and high GDL, both of which would seem to favor STRIDE based on the conditions with smaller numbers of species. This finding, although limited to just a small part of the parameter space, suggests some potential advantage to DISCO+QR on very large datasets that merits further investigation.</p>
  </sec>
  <sec>
    <title>7 Conclusion</title>
    <p>This study presented DISCO+QR, a new approach for rooting species trees given a set of gene family trees that evolve under both GDL and ILS. DISCO+QR is low-degree polynomial time and fast enough to be used on large datasets with 1000 species and 1000 genes. DISCO+QR is typically more accurate than STRIDE under high ILS conditions, and typically less accurate under low ILS conditions; however, the experimental study also suggests that relative accuracy will depend on a combination of factors, including number of species, number of genes, levels of GTEE and GDL rates.</p>
    <p>This study suggests several directions for future work. For example, given the fact that STRIDE and DISCO+QR each have advantages over the other depending on these dataset properties, it seems likely that taking input from both approaches may provide better techniques for rooting species trees. We also note that modifications to the DISCO+QR pipeline [e.g. changes to the QR optimization problem, such as using QR-STAR, an improved variant of QR (<xref rid="vbad015-B26" ref-type="bibr">Tabatabaee <italic toggle="yes">et al.</italic>, 2022b</xref>)] may improve its accuracy. This study mainly examined small numbers of species, yet DISCO+QR clearly improves significantly in accuracy on larger numbers of species; hence, further study of conditions with more species is necessary. Future work could also evaluate the accuracy of alternative methods for rooting an estimated species tree. For example, methods such as midpoint rooting could be considered, but these require meaningful branch lengths in species trees, which may be difficult when genes evolve with duplication and loss. Finally, future work should also examine results on biological datasets, where the true root is known or considered highly reliable, as was performed in <xref rid="vbad015-B8" ref-type="bibr">Emms and Kelly (2017)</xref>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbad015_Supplementary_Data</label>
      <media xlink:href="vbad015_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank the anonymous reviewers for helpful comments.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Department of Computer Science at UIUC and by the Grainger Foundation.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>Links to the data used in this study are provided at <ext-link xlink:href="https://doi.org/10.13012/B2IDB-5748609_V1" ext-link-type="uri">https://doi.org/10.13012/B2IDB-5748609_V1</ext-link>. DISCO is available on github at <ext-link xlink:href="https://github.com/JSdoubleL/DISCO" ext-link-type="uri">https://github.com/JSdoubleL/DISCO</ext-link> and QR at <ext-link xlink:href="https://github.com/ytabatabaee/Quintet-Rooting" ext-link-type="uri">https://github.com/ytabatabaee/Quintet-Rooting</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad015-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allman</surname><given-names>E.S.</given-names></string-name></person-group><etal>et al</etal> (<year>2011</year>) <article-title>Identifying the rooted species tree from the distribution of unrooted gene trees under the coalescent</article-title>. <source>J. Math. Biol</source>., <volume>62</volume>, <fpage>833</fpage>–<lpage>862</lpage>.<pub-id pub-id-type="pmid">20652704</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ayala</surname><given-names>F.J.</given-names></string-name></person-group> (<year>1999</year>) <article-title>Molecular clock mirages</article-title>. <source>Bioessays</source>, <volume>21</volume>, <fpage>71</fpage>–<lpage>75</lpage>.<pub-id pub-id-type="pmid">10070256</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bettisworth</surname><given-names>B.</given-names></string-name>, <string-name><surname>Stamatakis</surname><given-names>A.</given-names></string-name></person-group> (<year>2021</year>) <article-title>Root digger: a root placement program for phylogenetic trees</article-title>. <source>BMC Bioinformatics</source>, <volume>22</volume>, <fpage>1</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">33388027</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chaudhary</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>iGTP: a software package for large-scale gene tree parsimony analysis</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>1</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">20043860</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chaudhary</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>MulRF: a software package for phylogenetic analysis using multi-copy gene trees</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>432</fpage>–<lpage>433</lpage>.<pub-id pub-id-type="pmid">25273112</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2000</year>) Notung: dating gene duplications using gene family trees. In: <italic toggle="yes">Proceedings of the Fourth Annual International Conference on Computational molecular biology (RECOMB)</italic>, Tokyo, Japan, pp. <fpage>96</fpage>–<lpage>106</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad015-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chifman</surname><given-names>J.</given-names></string-name>, <string-name><surname>Kubatko</surname><given-names>L.</given-names></string-name></person-group> (<year>2014</year>) <article-title>Quartet inference from SNP data under the coalescent model</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>3317</fpage>–<lpage>3324</lpage>.<pub-id pub-id-type="pmid">25104814</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Emms</surname><given-names>D.M.</given-names></string-name>, <string-name><surname>Kelly</surname><given-names>S.</given-names></string-name></person-group> (<year>2017</year>) <article-title>STRIDE: species tree root inference from gene duplication events</article-title>. <source>Mol. Biol. Evol</source>., <volume>34</volume>, <fpage>3267</fpage>–<lpage>3278</lpage>.<pub-id pub-id-type="pmid">29029342</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fletcher</surname><given-names>W.</given-names></string-name>, <string-name><surname>Yang</surname><given-names>Z.</given-names></string-name></person-group> (<year>2009</year>) <article-title>INDELible: a flexible simulator of biological sequence evolution</article-title>. <source>Mol. Biol. Evol</source>., <volume>26</volume>, <fpage>1879</fpage>–<lpage>1888</lpage>.<pub-id pub-id-type="pmid">19423664</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hess</surname><given-names>P.N.</given-names></string-name>, <string-name><surname>De Moraes Russo</surname><given-names>C.A.</given-names></string-name></person-group> (<year>2007</year>) <article-title>An empirical test of the midpoint rooting method</article-title>. <source>Biol. J. Linn. Soc. Lond</source>., <volume>92</volume>, <fpage>669</fpage>–<lpage>674</lpage>.<pub-id pub-id-type="pmid">32287391</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lefort</surname><given-names>V.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>FastME 2.0: a comprehensive, accurate, and fast Distance-Based phylogeny inference program</article-title>. <source>Mol. Biol. Evol</source>., <volume>32</volume>, <fpage>2798</fpage>–<lpage>2800</lpage>.<pub-id pub-id-type="pmid">26130081</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Legried</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Polynomial-time statistical estimation of species trees under gene duplication and loss</article-title>. <source>J. Comput. Biol</source>., <volume>28</volume>, <fpage>452</fpage>–<lpage>468</lpage>.<pub-id pub-id-type="pmid">33325781</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mai</surname><given-names>U.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Minimum variance rooting of phylogenetic trees and implications for species tree reconstruction</article-title>. <source>PLoS One</source>, <volume>12</volume>, <fpage>e0182238</fpage>.<pub-id pub-id-type="pmid">28800608</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mallo</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>SimPhy: phylogenomic simulation of gene, locus, and species trees</article-title>. <source>Syst. Biol</source>., <volume>65</volume>, <fpage>334</fpage>–<lpage>344</lpage>.<pub-id pub-id-type="pmid">26526427</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Markin</surname><given-names>A.</given-names></string-name>, <string-name><surname>Eulenstein</surname><given-names>O.</given-names></string-name></person-group> (<year>2021</year>) <article-title>Quartet-based inference is statistically consistent under the unified duplication-loss-coalescence model</article-title>. <source>Bioinformatics</source>, <volume>37</volume>, <fpage>4064</fpage>–<lpage>4074</lpage>.<pub-id pub-id-type="pmid">34048529</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mirarab</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>ASTRAL: genome-scale coalescent-based species tree estimation</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>i541</fpage>–<lpage>i548</lpage>.<pub-id pub-id-type="pmid">25161245</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Molloy</surname><given-names>E.K.</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T.</given-names></string-name></person-group> (<year>2020</year>) <article-title>FastMulRFS: fast and accurate species tree estimation under generic gene duplication and loss models</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>i57</fpage>–<lpage>i65</lpage>.<pub-id pub-id-type="pmid">32657396</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ogilvie</surname><given-names>H.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>StarBEAST2 brings faster species tree inference and accurate estimates of substitution rates</article-title>. <source>Mol. Biol. Evol</source>., <volume>34</volume>, <fpage>2101</fpage>–<lpage>2114</lpage>.<pub-id pub-id-type="pmid">28431121</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pascual-García</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>The molecular clock in the evolution of protein structures</article-title>. <source>Syst. Biol</source>., <volume>68</volume>, <fpage>987</fpage>–<lpage>1002</lpage>.<pub-id pub-id-type="pmid">31111152</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pearson</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2013</year>) <article-title>When outgroups fail; phylogenomics of rooting the emerging pathogen, <italic toggle="yes">Coxiella burnetii</italic></article-title>. <source>Syst. Biol</source>., <volume>62</volume>, <fpage>752</fpage>–<lpage>762</lpage>.<pub-id pub-id-type="pmid">23736103</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Price</surname><given-names>M.N.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>FastTree 2–approximately maximum-likelihood trees for large alignments</article-title>. <source>PLoS One</source>, <volume>5</volume>, <fpage>e9490</fpage>.<pub-id pub-id-type="pmid">20224823</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rasmussen</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Kellis</surname><given-names>M.</given-names></string-name></person-group> (<year>2012</year>) <article-title>Unified modeling of gene duplication, loss, and coalescence using a locus tree</article-title>. <source>Genome Res</source>., <volume>22</volume>, <fpage>755</fpage>–<lpage>765</lpage>.<pub-id pub-id-type="pmid">22271778</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>D.F.</given-names></string-name>, <string-name><surname>Foulds</surname><given-names>L.R.</given-names></string-name></person-group> (<year>1981</year>) <article-title>Comparison of phylogenetic trees</article-title>. <source>Math. Biosci</source>., <volume>53</volume>, <fpage>131</fpage>–<lpage>147</lpage>.</mixed-citation>
    </ref>
    <ref id="vbad015-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shavit</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2007</year>) <article-title>The problem of rooting rapid radiations</article-title>. <source>Mol. Biol. Evol</source>., <volume>24</volume>, <fpage>2400</fpage>–<lpage>2411</lpage>.<pub-id pub-id-type="pmid">17720690</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tabatabaee</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2022a</year>) <article-title>Quintet rooting: rooting species trees under the multi-species coalescent model</article-title>. <source>Bioinformatics</source>, <volume>38</volume>, <fpage>i109</fpage>–<lpage>i117</lpage>.<pub-id pub-id-type="pmid">35758805</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B26">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Tabatabaee</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2022b</year>) Statistically consistent rooting of species trees under the multispecies coalescent model. bioRxiv, <pub-id pub-id-type="doi">10.1101/2022.10.26.513897</pub-id>.</mixed-citation>
    </ref>
    <ref id="vbad015-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tria</surname><given-names>F.D.K.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Phylogenetic rooting using minimal ancestor deviation</article-title>. <source>Nat. Ecol. Evol</source>., <volume>1</volume>, <fpage>1</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">28812620</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vachaspati</surname><given-names>P.</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T.</given-names></string-name></person-group> (<year>2015</year>) <article-title>ASTRID: accurate species trees from internode distances</article-title>. <source>BMC Genomics</source>, <volume>16</volume>, <fpage>1</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">25553907</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wehe</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2008</year>) <article-title>DupTree: a program for large-scale phylogenetic analyses using gene tree parsimony</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>1540</fpage>–<lpage>1541</lpage>.<pub-id pub-id-type="pmid">18474508</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Willson</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>DISCO: species tree inference using multicopy gene family tree decomposition</article-title>. <source>Syst. Biol</source>., <volume>71</volume>, <fpage>610</fpage>–<lpage>629</lpage>.<pub-id pub-id-type="pmid">34450658</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>Y.-C.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Most parsimonious reconciliation in the presence of gene duplication, loss, and deep coalescence using labeled coalescent trees</article-title>. <source>Genome Res</source>., <volume>24</volume>, <fpage>475</fpage>–<lpage>486</lpage>.<pub-id pub-id-type="pmid">24310000</pub-id></mixed-citation>
    </ref>
    <ref id="vbad015-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>ASTRAL-Pro: quartet-based species-tree inference despite paralogy</article-title>. <source>Mol. Biol. Evol</source>., <volume>37</volume>, <fpage>3292</fpage>–<lpage>3307</lpage>.<pub-id pub-id-type="pmid">32886770</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
