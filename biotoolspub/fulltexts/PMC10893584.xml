<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10893584</article-id>
    <article-id pub-id-type="pmid">38341662</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae080</article-id>
    <article-id pub-id-type="publisher-id">btae080</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RNA threading with secondary structure and sequence profile</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Zongyang</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="equal">Data curation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="equal">Software</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Chongqing Key Laboratory of Big Data for Bio Intelligence, Chongqing University of Posts and Telecommunications</institution>, Chongqing 400065, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0303-6693</contrib-id>
        <name>
          <surname>Peng</surname>
          <given-names>Zhenling</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>MOE Frontiers Science Center for Nonlinear Expectations, Research Center for Mathematics and Interdisciplinary Sciences, Shandong University</institution>, Qingdao 266237, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2912-7737</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Jianyi</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration" degree-contribution="equal">Project administration</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>MOE Frontiers Science Center for Nonlinear Expectations, Research Center for Mathematics and Interdisciplinary Sciences, Shandong University</institution>, Qingdao 266237, <country country="CN">China</country></aff>
        <xref rid="btae080-cor1" ref-type="corresp"/>
        <!--yangjy@sdu.edu.cn-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cowen</surname>
          <given-names>Lenore</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae080-cor1">Corresponding author. MOE Frontiers Science Center for Nonlinear Expectations, Research Center for Mathematics and Interdisciplinary Sciences, Shandong University, Qingdao 266237, China. E-mail: <email>yangjy@sdu.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-02-10">
      <day>10</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>2</issue>
    <elocation-id>btae080</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>05</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>01</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>23</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae080.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>RNA threading aims to identify remote homologies for template-based modeling of RNA 3D structure. Existing RNA alignment methods primarily rely on secondary structure alignment. They are often time- and memory-consuming, limiting large-scale applications. In addition, the accuracy is far from satisfactory.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Using RNA secondary structure and sequence profile, we developed a novel RNA threading algorithm, named RNAthreader. To enhance the alignment process and minimize memory usage, a novel approach has been introduced to simplify RNA secondary structures into compact diagrams. RNAthreader employs a two-step methodology. Initially, integer programming and dynamic programming are combined to create an initial alignment for the simplified diagram. Subsequently, the final alignment is obtained using dynamic programming, taking into account the initial alignment derived from the previous step. The benchmark test on 80 RNAs illustrates that RNAthreader generates more accurate alignments than other methods, especially for RNAs with pseudoknots. Another benchmark, involving 30 RNAs from the RNA-Puzzles experiments, exhibits that the models constructed using RNAthreader templates have a lower average RMSD than those created by alternative methods. Remarkably, RNAthreader takes less than two hours to complete alignments with ∼5000 RNAs, which is 3–40 times faster than other methods. These compelling results suggest that RNAthreader is a promising algorithm for RNA template detection.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>
          <ext-link xlink:href="https://yanglab.qd.sdu.edu.cn/RNAthreader" ext-link-type="uri">https://yanglab.qd.sdu.edu.cn/RNAthreader</ext-link>
        </p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Science and Technology Research Program</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>NSFC T2225007</award-id>
        <award-id>T2222012</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The 14th community-wide experiment on the critical assessment of techniques for protein structure prediction (CASP14) (<xref rid="btae080-B18" ref-type="bibr">Kryshtafovych <italic toggle="yes">et al.</italic> 2021</xref>) has witnessed great progress in protein structure prediction. With powerful deep learning techniques (<xref rid="btae080-B4" ref-type="bibr">Baek <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btae080-B14" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>), the structure prediction problem for single-domain proteins has been nearly solved (<xref rid="btae080-B26" ref-type="bibr">Peng <italic toggle="yes">et al.</italic> 2022</xref>). However, structure prediction for RNAs with deep learning remains challenging, due to the complexity of RNA molecules and the lack of enough experimentally solved structures (<xref rid="btae080-B38" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2023</xref>). The RNA structure prediction methods can be broadly grouped into two categories: <italic toggle="yes">ab initio</italic> modeling and template-based modeling (TBM).</p>
    <p>There are two major types of <italic toggle="yes">ab initio</italic> modeling methods. The first one is based on molecular dynamics simulation, such as Vfold3D (<xref rid="btae080-B44" ref-type="bibr">Zhao <italic toggle="yes">et al.</italic> 2017</xref>) and iFoldRNA (<xref rid="btae080-B17" ref-type="bibr">Krokhotin <italic toggle="yes">et al.</italic> 2015</xref>). The second one is based on fragment assembly, such as FARFAR (<xref rid="btae080-B8" ref-type="bibr">Das and Baker 2007</xref>), FARFAR2 (<xref rid="btae080-B39" ref-type="bibr">Watkins <italic toggle="yes">et al.</italic> 2020</xref>), RNAComposer (<xref rid="btae080-B28" ref-type="bibr">Popenda <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btae080-B3" ref-type="bibr">Antczak <italic toggle="yes">et al.</italic> 2016</xref>), 3dRNA (<xref rid="btae080-B45" ref-type="bibr">Zhao <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btae080-B43" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2022</xref>), and MC-Fold/MC-Sym (<xref rid="btae080-B25" ref-type="bibr">Parisien and Major 2008</xref>). These methods can be further grouped into full-atom simulation or coarse-grained simulation. The former performs a simulation of all atoms in a single round, which works well on short RNAs; while its great demand for computing resources prevents the application in structure prediction for large RNAs. The latter addresses this issue by merging certain atoms into so-called coarse-grained particles; while the ability to add atom-level details needs to be further strengthened.</p>
    <p>TBM methods build the structure model for a query RNA using homologous templates in PDB (<xref rid="btae080-B7" ref-type="bibr">Berman <italic toggle="yes">et al.</italic> 2000</xref>). Accurate query-template alignment plays a key role in TBM methods. The alignment is usually conducted based on the secondary structure. However, RNA secondary structure is formed by base pairs (2D map), making the RNA alignment much more difficult than protein (1D sequence).</p>
    <p>Sankoff proposed an algorithm to compute the alignment and the common secondary structure of two RNA sequences simultaneously, based on dynamic programming for free energy minimization (<xref rid="btae080-B30" ref-type="bibr">Sankoff 1985</xref>). This algorithm requires <italic toggle="yes">O</italic>(<italic toggle="yes">n<sup>6</sup></italic>) time and <italic toggle="yes">O</italic>(<italic toggle="yes">n<sup>4</sup></italic>) memory (<italic toggle="yes">n</italic> is the length of RNAs to be aligned), which grow very fast when the sequence length increases. This issue limits its real-world applications.</p>
    <p>To address the above issue, several algorithms were proposed, which are referred to as Sankoff-style algorithms. There are three main types of Sankoff-style algorithms (<xref rid="btae080-B10" ref-type="bibr">Havgaard and Gorodkin 2014</xref>). The first is based on energy minimization, which is most similar to the original Sankoff algorithm, with representative methods such as Foldalign (<xref rid="btae080-B11" ref-type="bibr">Havgaard <italic toggle="yes">et al.</italic> 2007</xref>) and Dynalign (<xref rid="btae080-B21" ref-type="bibr">Mathews and Turner 2002</xref>). Methods of the second type are based on the alignment of base-pairing probability matrix, such as PMcomp (<xref rid="btae080-B12" ref-type="bibr">Hofacker <italic toggle="yes">et al.</italic> 2004</xref>) and LocARNA (<xref rid="btae080-B40" ref-type="bibr">Will <italic toggle="yes">et al.</italic> 2007</xref>). The third type of method uses statistical models based on stochastic context-free grammars (SCFG), such as Consan (<xref rid="btae080-B9" ref-type="bibr">Dowell and Eddy 2006</xref>) and RSEARCH (<xref rid="btae080-B16" ref-type="bibr">Klein and Eddy 2003</xref>). Some of these methods use different heuristic strategies to reduce time and memory consumption. For instance, Foldalign filters subalignments by setting length-related cutoffs, and LocARNA simplifies the base paring probability matrix by ignoring elements below a certain threshold.</p>
    <p>There are some non-Sankoff-style algorithms for RNA alignment. For example, RNAmountAlign (<xref rid="btae080-B6" ref-type="bibr">Bayegan and Clote 2020</xref>) aligns two RNAs with Needleman-Wunsch dynamic programming (NWDP) (<xref rid="btae080-B23" ref-type="bibr">Needleman and Wunsch 1970</xref>) based on the mountain height (<xref rid="btae080-B13" ref-type="bibr">Hogeweg and Hesper 1984</xref>) of their secondary structures, and LARA (<xref rid="btae080-B5" ref-type="bibr">Bauer <italic toggle="yes">et al.</italic> 2007</xref>) is a graph-based method which solves the alignment problem by integer linear programming.</p>
    <p>In this work, we developed a new RNA threading algorithm named RNAthreader. It is built on simplified secondary structure diagrams and sequence profiles from multiple sequence alignments. Benchmark tests show the advantage of RNAthreader over other methods in terms of both accuracy and speed.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Template library</title>
      <p>We retrieve experimentally determined 3D RNA structures from the RNAsolo database (<xref rid="btae080-B1" ref-type="bibr">Adamczyk <italic toggle="yes">et al.</italic> 2022</xref>) and use them to construct a template library comprising two distinct components: single-chain and multi-chain RNAs. The single-chain component encompasses all available single-chain RNA structures. Since base pairing between different chains is common, it is necessary to consider connecting different chains that form base pairs. To this end, we utilize RNAView (<xref rid="btae080-B41" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2003</xref>) for secondary structure annotation, with the assembly structure as input. Specifically, for two chains denoted as A and B, if the number of base pairs between them exceeds 20% of the length of A or B, the combinations A_B and B_A will be added as new templates. In cases where a chain forms base pairs with multiple chains, we will include the additional chain that shares the largest number of base pairs with it. Consequently, each template in our library contains a maximum of three chains. Following this procedure, we successfully curate a template library comprising 18,195 RNAs. The library files are available for download at: <ext-link xlink:href="https://yanglab.qd.sdu.edu.cn/RNAthreader" ext-link-type="uri">https://yanglab.qd.sdu.edu.cn/RNAthreader</ext-link>.</p>
    </sec>
    <sec>
      <title>2.2 Training and test datasets</title>
      <p>Three datasets were used for training and testing. The training set, TR221, and the first test set, TE80, are obtained from our previous work RNAContact (<xref rid="btae080-B34" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> 2020</xref>). TR221 consists of 221 RNAs, and TE80 comprises 80 RNAs, with sequence lengths spanning 32 to 1,000 nucleotides. RNAs from these two datasets share less than 30% sequence identity. Based on the presence or absence of pseudoknots, we further divided the TE80 dataset into two subsets: Knotted and Nested. Here a pseudoknot is a bipartite helical structure formed by base pairing of the apical loop in the stem-loop structure with an outside sequence (<xref rid="btae080-B27" ref-type="bibr">Peselis and Serganov 2014</xref>). The second test set (denoted by PUZ30) includes 30 RNAs from RNA-Puzzles (<xref rid="btae080-B20" ref-type="bibr">Magnus <italic toggle="yes">et al.</italic> 2019</xref>). Note that Puzzle 10, Puzzle 26, Puzzle 27, and Puzzle 28 are T-box riboswitch—tRNA complexes. For these targets, we only select T-box riboswitches for structure prediction. Besides, Puzzle 14 is an <italic toggle="yes">L-glutamine riboswitch</italic> with Bound and Free forms, which are treated as two different targets. More details about the PUZ30 dataset are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>.</p>
    </sec>
    <sec>
      <title>2.3 Algorithm inputs</title>
      <sec>
        <title>2.3.1 Sequence profile</title>
        <p>The multiple sequence alignment (MSA) for each query RNA was generated with RNAcmap (<xref rid="btae080-B42" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2021</xref>). The RNAcmap method begins with an initial homolog search using BLAST-N (<xref rid="btae080-B2" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1997</xref>) against the NCBI nucleotide database. The returned homologs and the secondary structure predicted by SPOT-RNA (<xref rid="btae080-B31" ref-type="bibr">Singh <italic toggle="yes">et al.</italic> 2019</xref>) are then utilized to build a covariance model. In the end, an MSA is generated by the second round of homolog search using INFERNAL (<xref rid="btae080-B22" ref-type="bibr">Nawrocki and Eddy 2013</xref>). Given that the MSA may contain redundant sequences, we use HHfilter (<xref rid="btae080-B33" ref-type="bibr">Steinegger <italic toggle="yes">et al.</italic> 2019</xref>) to remove sequences sharing &gt;80% sequence identity or &lt;75% coverage with the query sequence. If the number of remaining homologs in the MSA is less than 5, we will not use sequence profiles in the following steps. Otherwise, we compute the sequence profile in a manner similar to that employed in PSI-BLAST (<xref rid="btae080-B2" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1997</xref>):
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>0.4</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">q<sub>i</sub></italic> is the nucleotide type for the <italic toggle="yes">i</italic>th position of the query RNA, <italic toggle="yes">d</italic>(<italic toggle="yes">q<sub>i</sub></italic>) is the number of nucleotide types different from <italic toggle="yes">q<sub>i</sub></italic> in the <italic toggle="yes">i</italic>th column of the MSA, <italic toggle="yes">f</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">k</italic>) is the observed frequency of the <italic toggle="yes">k</italic>th nucleotide in the <italic toggle="yes">i</italic>th column of the MSA, <italic toggle="yes">p</italic>(<italic toggle="yes">q<sub>i</sub></italic>) is the background probability of <italic toggle="yes">q<sub>i</sub></italic>, estimated from the NCBI nucleotide database (<italic toggle="yes">p</italic>(A) = 0.27, <italic toggle="yes">p</italic>(U) = 0.27, <italic toggle="yes">p</italic>(G) = 0.23, <italic toggle="yes">p</italic>(C) = 0.23) (<xref rid="btae080-B35" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> 2018</xref>), and <italic toggle="yes">R<sub>s</sub></italic> refers to the RIBOSUM single nucleotide matrix (<xref rid="btae080-B16" ref-type="bibr">Klein and Eddy 2003</xref>). Note that this profile automatically takes a balance between the MSA and the RIBOSUM matrix. The sequence profile largely depends on the MSA when it contains a large number of homologous sequences; while it resembles the RIBOSUM matrix when the MSA is shallow.</p>
        <p>For RNAs in the template library, we also tried using BLAST-N for homologous sequence detection. However, many templates could not find any sequence homologs. To ensure the consistency of alignment scores, we did not use the sequence profile for templates. Thus, the query-template alignment will be performed in the profile-sequence or sequence-sequence manner in the following steps.</p>
      </sec>
      <sec>
        <title>2.3.2 Secondary structure</title>
        <p>For the query RNA, we use the deep learning algorithm SPOT-RNA to predict its secondary structure. For RNAs in the template library, their secondary structures are extracted from native structures using RNAView. RNA secondary structure is usually represented as a planar graph (see <xref rid="btae080-F2" ref-type="fig">Fig. 2A</xref> for an example).</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Alignment algorithm</title>
      <sec>
        <title>2.4.1 Workflow of the alignment algorithm</title>
        <p>The flowchart of RNAthreader is presented in <xref rid="btae080-F1" ref-type="fig">Fig. 1</xref>. It consists of two main steps. First, it extracts all the nucleotides forming base pairs and performs their alignments. Second, it generates the final alignment based on the sequence profile and the secondary structure alignment result.</p>
        <fig position="float" id="btae080-F1">
          <label>Figure 1.</label>
          <caption>
            <p>Flowchart of RNAthreader. Here “SS” stands for secondary structure, “IP” is integer programming, and “NWDP” denotes Needleman-Wunsch dynamic programming.</p>
          </caption>
          <graphic xlink:href="btae080f1" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>2.4.2 Alignment of simplified secondary diagrams</title>
        <p>The secondary structure of each RNA is converted into a linear arc diagram (<xref rid="btae080-F2" ref-type="fig">Fig. 2B</xref>) for alignment. In the linear arc diagram, the vertices denote nucleotides and those connected by edges represent base pairs. With the graphical representation, the problem of finding the best alignment can be transformed into an integer programming problem with specified constraints (<xref rid="btae080-B5" ref-type="bibr">Bauer <italic toggle="yes">et al.</italic> 2007</xref>). However, the amount of constraints and variables in the integer programming problem grows rapidly with the increase of sequence lengths.</p>
        <fig position="float" id="btae080-F2">
          <label>Figure 2.</label>
          <caption>
            <p>Secondary structure diagrams for an example RNA. (A) Planar graph with base pairs indicated by colored and connected vertices. (B) Linear arc diagram. (C) Simplified linear arc diagram.</p>
          </caption>
          <graphic xlink:href="btae080f2" position="float"/>
        </fig>
        <p>To address this issue, we simplify the linear arc diagram of RNA secondary structure as follows. First, only nucleotides forming base pairs are kept. Yet for RNAs with a large proportion of base pairs, this simplification only has a limited effect. Thus, we further define the concept of <italic toggle="yes">substructures</italic>. A substructure is a fragment consisting of consecutive base pairs, which allows the existence of bulge and interior loops (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref> for examples). As illustrated in <xref rid="btae080-F2" ref-type="fig">Fig. 2A</xref>, the five colored fragments correspond to five different substructures. Second, we merge base pairs in the same substructure and get the final simplified diagram as shown in <xref rid="btae080-F2" ref-type="fig">Fig. 2C</xref>. With the above procedures, the original diagram is significantly simplified and the relative positions of substructures are retained.</p>
        <p>Initial alignment is then conducted on the simplified diagram. The alignment between two simplified diagrams is based on integer programming to maximize the following objective function.
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msubsup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">V<sub>q</sub></italic>/<italic toggle="yes">V<sub>t</sub></italic> is the set of the substructures in the simplified diagram of the query/template; the substructure <italic toggle="yes">Sq i</italic> is denoted as a two-element tuple (<italic toggle="yes">Sq i, 1</italic>, <italic toggle="yes">Sq i, 2</italic>), in which <italic toggle="yes">Sq i, 1</italic> and <italic toggle="yes">Sq i, 2</italic> are the two paired halves; δ(<italic toggle="yes">x</italic>, <italic toggle="yes">y</italic>) equals to 1 if <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> are aligned, and 0 otherwise; <italic toggle="yes">ω<sub>ij</sub></italic> is the matching score between substructures <italic toggle="yes">Sq i</italic> and <italic toggle="yes">St j</italic>, which is determined based on the NWDP (introduced in the next section). The objective function is subjective to two constraints to generate meaningful alignment: (1) there is no cross-alignment. In other words, once regions <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> are aligned, alignment cannot occur between the regions before <italic toggle="yes">x</italic> and the regions after <italic toggle="yes">y</italic> (or vice versa); (2) each vertex in a graph can be aligned to at most one vertex in another graph.</p>
        <p>After solving the above integer programming problem, the alignment between two simplified secondary diagrams is obtained. It is used in the next step to generate nucleotide-level alignment with NWDP.</p>
      </sec>
      <sec>
        <title>2.4.3 Alignment of substructures with NWDP</title>
        <p>The matching score and alignment between two substructures are obtained based on NWDP. Given that substructures only contain nucleotides forming base pairs, we design a <italic toggle="yes">partial</italic> alignment strategy, which only aligns half of the substructures. The alignment of the other half is completed automatically based on their base-pairing relationships. The scoring function for the partial alignment in NWDP is calculated as follows.
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo> + </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eff</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo> + </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo> + </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eff</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>≠</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mtext>stem</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>stem</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where (<italic toggle="yes">m<sub>1</sub></italic>, <italic toggle="yes">m<sub>2</sub></italic>)/(<italic toggle="yes">n<sub>1</sub></italic>, <italic toggle="yes">n<sub>2</sub></italic>) is a base pair in a substructure of the query/template; <italic toggle="yes">q<sub>i</sub></italic> is the type of the <italic toggle="yes">i</italic>th nucleotide in the query, <italic toggle="yes">t<sub>k</sub></italic> is the type of the <italic toggle="yes">k</italic>th nucleotide in the template; <italic toggle="yes">R<sub>P</sub></italic> refers to the RIBOSUM base-pairing matrix; <italic toggle="yes">F<sub>q</sub></italic> is defined by <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>; <italic toggle="yes">N<sub>eff</sub></italic> is the number of effective sequences in MSA, which equals to the number of remaining sequences in MSA after filtering; <italic toggle="yes">s<sub>E</sub></italic> reflects the similarity of the base pairs in the local environment (<xref rid="E4" ref-type="disp-formula">Equation (4)</xref>). To define the local environment for a base pair (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>), we first cut the whole diagram into two subgraphs at the edge (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>). The environment for the base pair (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) in query is then defined as the smallest closed loop which starts at <italic toggle="yes">i</italic> and ends at <italic toggle="yes">j</italic> in each subgraph<italic toggle="yes">.</italic> Finally, the environment’s secondary structure type (stem, hairpin, bulge, interior loop, multi-loop, or pseudoknot, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>) makes the two-element tuple <italic toggle="yes">E<sub>q</sub></italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) in <xref rid="E4" ref-type="disp-formula">Equation (4)</xref>.</p>
        <p>If the sequence profile of the query RNA is not utilized, the gap open penalty is 3 and the gap extension penalty is 1. Otherwise, gap penalties will be adjusted according to the ratio of gaps in each column of the MSA, i.e. the higher the ratio of gaps is, the lower the gap penalty will be.</p>
      </sec>
      <sec>
        <title>2.4.4 Final alignment</title>
        <p>From Section 2.4.2, we obtain the alignment between two simplified secondary diagrams. The nucleotide-level alignment between aligned substructures is the NWDP result described in Section 2.4.3. The final alignment between the query and each template is performed by NWDP with the following scoring function.
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">aln</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eff</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">aln</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eff</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where the definitions of <italic toggle="yes">q<sub>i</sub></italic>, <italic toggle="yes">t<sub>j</sub></italic>, <italic toggle="yes">R<sub>s</sub></italic>, <italic toggle="yes">N<sub>eff</sub></italic>, and <italic toggle="yes">F<sub>q</sub></italic> are the same as those in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> and <xref rid="E3" ref-type="disp-formula">Equation (3)</xref>; <italic toggle="yes">I</italic>(.) is an indicator function, whose value is 1 when the corresponding event happens, and 0 otherwise; <italic toggle="yes">S<sub>aln</sub></italic> is the set of aligned nucleotides (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) in the previous step. The setting of gap penalties is the same as that described in Section 2.4.3 except that penalty is skipped for terminal gaps.</p>
      </sec>
    </sec>
    <sec>
      <title>2.5 Performance evaluation</title>
      <p>Alignment quality and model quality are used for evaluating the performance of different methods. Here the alignment quality is quantified by two metrics: alignment coverage and the RMSD of the aligned region. Alignment coverage is calculated by dividing the aligned length by the length of the query RNA. As for RMSD of the aligned region, we first extract coordinates of all heavy atoms on the backbone of aligned nucleotides from the template RNA, then compute RMSD with the corresponding region in the native structure. The other measure model quality is quantified by the RMSD between the native structure and the full-atom model built by FARFAR2 (<xref rid="btae080-B39" ref-type="bibr">Watkins <italic toggle="yes">et al.</italic> 2020</xref>) or ModeRNA (<xref rid="btae080-B29" ref-type="bibr">Rother <italic toggle="yes">et al.</italic> 2011</xref>) according to query-template alignment. The selection of the method for constructing the full-length model is determined by the alignment coverage. FARFAR2 is used when the alignment coverage varies significantly; otherwise, ModeRNA is used.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results and discussions</title>
    <sec>
      <title>3.1 Algorithm implementation and parameter optimization</title>
      <p>The RNAthreader algorithm is implemented in C++. We use the high-performance mathematical programming engine IBM ILOG CPLEX 12.9 to solve the quadratic integer programming problem presented in <xref rid="E2" ref-type="disp-formula">Equation (2)</xref>. With simplified linear arc diagrams of RNA secondary structures (<xref rid="btae080-F2" ref-type="fig">Fig. 2C</xref>), the number of variables to be solved and corresponding constraints decrease substantially.</p>
      <p>All the parameters were empirically selected to yield the best performance on the TR221 dataset. During the training process, templates sharing &gt; 40% sequence identity with query RNAs were excluded. After the exclusion of close homologous templates, the average alignment coverage is relatively low. We tuned the parameters based on the alignment quality defined in Section 2.5.</p>
    </sec>
    <sec>
      <title>3.2 Performance on the TE80 dataset</title>
      <p>In the absence of dedicated RNA threading methods, we compare RNAthreader with four representative RNA alignment algorithms: LocARNA (version 1.9.2.1) (<xref rid="btae080-B40" ref-type="bibr">Will <italic toggle="yes">et al.</italic> 2007</xref>), CARNA (version 1.3.3) (<xref rid="btae080-B32" ref-type="bibr">Sorescu <italic toggle="yes">et al.</italic> 2012</xref>), Foldalign (version 2.5.3) (<xref rid="btae080-B36" ref-type="bibr">Sundfeld <italic toggle="yes">et al.</italic> 2015</xref>), and RNAmountAlign (<xref rid="btae080-B6" ref-type="bibr">Bayegan and Clote 2020</xref>). We first conduct experiments on the TE80 dataset with four distinct thresholds: 60%, 50%, 40%, and 30%, which correspond to four progressively increasing levels of threading difficulty. In each comparison, templates with sequence identity to the query exceeding a certain threshold are excluded. The average number of non-redundant templates (&lt;99% pairwise sequence identity) remaining in the library for the four thresholds are as follows: 3991, 3713, 3344, and 2817, respectively. <xref rid="btae080-F3" ref-type="fig">Figure 3</xref> depicts the alignment quality, assessed in terms of coverage and RMSD, for the top-scoring alignment across different thresholds.</p>
      <fig position="float" id="btae080-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Alignment quality for the top-scoring alignment across different thresholds on the TE80 dataset. “LOC,” “CAR,” “MOU,” “FDA,” and “RTH” represent the methods LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader, respectively.</p>
        </caption>
        <graphic xlink:href="btae080f3" position="float"/>
      </fig>
      <p>The compared methods can be categorized into two groups based on the average coverage (as shown in <xref rid="btae080-F3" ref-type="fig">Fig. 3A</xref>): LocARNA, CARNA, and RNAmountAlign consistently maintain high coverages across different thresholds, while Foldalign and RNAthreader exhibit increasing average coverages as more templates with higher sequence identity become available. Likewise, there is a notable variation in RMSDs between these two groups of methods (<xref rid="btae080-F3" ref-type="fig">Fig. 3B</xref>). In the first group, the RMSDs of these methods have a tendency to increase as the threshold decreases, indicating that they could not effectively identify structure templates with low sequence identity. Moreover, RNAmountAlign yields alignments with significantly higher RMSDs when compared to LocARNA and CARNA. This observation suggests that it might not be appropriate to directly apply the Needleman-Wunsch dynamic programming to align RNAs. As for methods in the second group, namely Foldalign and RNAthreader, they exhibit relatively low average RMSDs that remain consistent regardless of the threading difficulty. The above facts confirm the reliability of these two methods in template detection.</p>
      <p>For proteins, a remote homolog is typically defined as a homologous template with less than 30% sequence identity to the query (<xref rid="btae080-B15" ref-type="bibr">Khor <italic toggle="yes">et al.</italic> 2015</xref>). However, due to the limited number of nucleotide types compared to amino acids, RNA sequences often exhibit higher similarity. Therefore, for RNAs, we use a threshold of 40% for remote homologs and conduct a more detailed analysis at this specific threshold.</p>
      <p>For each query, the alignment coverage for different methods varies, making the direct comparison in terms of RMSD less meaningful. To address this issue, we say method A generates more accurate alignment than method B on a target if the following two conditions are satisfied: (1) the RMSD on the aligned region of method A is lower than that of method B; (2) the alignment coverage of method A is higher than that of method B. The comparisons of the methods in the two above-mentioned groups are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S2 and S3</xref>, respectively. Our method outperforms Foldalign on 24 targets in the set TE80; while Foldalign outperforms our method on 9 targets.</p>
      <p>Given the diverse coverage of alignments from different methods, we integrated template information into FARFAR2, a fragment assembly-based approach for RNA structure prediction, to enhance the assessment of the generated alignments. Specifically, the structure of the aligned region from the top-scoring template, coupled with the query sequence and the secondary structure predicted by RNAfold (<xref rid="btae080-B19" ref-type="bibr">Lorenz <italic toggle="yes">et al.</italic> 2011</xref>), served as inputs for FARFAR2. If FARFAR2 fails to build models for a template, then the next-ranked template will be utilized, until a model is built successfully. <xref rid="btae080-T1" ref-type="table">Table 1</xref> displays the RMSD values and the count of optimal models (those with the lowest RMSD value) for the generated structural models using templates with &lt;40% sequence identity.</p>
      <table-wrap position="float" id="btae080-T1">
        <label>Table 1.</label>
        <caption>
          <p>RMSD and optimal model count (#) for FARFAR2 models using top-scoring templates with &lt;40% sequence identity.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1">Method</th>
              <th colspan="2" align="center" rowspan="1">All (80)<hr/></th>
              <th colspan="2" align="center" rowspan="1">Knotted (33)<hr/></th>
              <th colspan="2" rowspan="1">Nested (47)<hr/></th>
            </tr>
            <tr>
              <th align="center" rowspan="1" colspan="1">RMSD(Å)</th>
              <th rowspan="1" colspan="1">#</th>
              <th align="center" rowspan="1" colspan="1">RMSD(Å)</th>
              <th rowspan="1" colspan="1">#</th>
              <th rowspan="1" colspan="1">RMSD(Å)</th>
              <th rowspan="1" colspan="1">#</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">LOC</td>
              <td rowspan="1" colspan="1">29.1</td>
              <td rowspan="1" colspan="1">11</td>
              <td rowspan="1" colspan="1">32</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">27</td>
              <td rowspan="1" colspan="1">8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CAR</td>
              <td rowspan="1" colspan="1">29.3</td>
              <td rowspan="1" colspan="1">19</td>
              <td rowspan="1" colspan="1">32.9</td>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">26.8</td>
              <td rowspan="1" colspan="1">11</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MOU</td>
              <td rowspan="1" colspan="1">40.9</td>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">48.4</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">35.7</td>
              <td rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">FDA</td>
              <td rowspan="1" colspan="1">26.2</td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">30.4</td>
              <td rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">23.3</td>
              <td rowspan="1" colspan="1">9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RTH</td>
              <td rowspan="1" colspan="1">21.4</td>
              <td rowspan="1" colspan="1">30</td>
              <td rowspan="1" colspan="1">23.1</td>
              <td rowspan="1" colspan="1">12</td>
              <td rowspan="1" colspan="1">20.2</td>
              <td rowspan="1" colspan="1">18</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>“LOC,” “CAR,” “MOU,” “FDA,” and “RTH” represent the methods LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader, respectively.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Based on the data presented in <xref rid="btae080-T1" ref-type="table">Table 1</xref>, models generated with templates selected by RNAthreader exhibit the lowest average RMSD on the TE80 dataset, which is 18.3% lower than that of the next-best method, Foldalign. Additionally, the RNAthreader model outperforms all other compared methods by achieving the lowest RMSD among 30 targets, indicating its superior performance. We also compared the results with the original FARFAR2 model, which was generated solely using sequence and predicted secondary structure as inputs. The average RMSD (20.9 Å) of the original FARFAR2 model is slightly lower than that of RNAthreader. Despite this, when considering the number of best models, the original FARFAR2 method achieves the best performance on 18 targets, while RNAthreader performs best on 21 targets. The remaining four methods, namely LocARNA, CARNA, RNAmountAlign, and Foldalign, yield results of 8, 16, 4, and 13, respectively.</p>
      <p>We then divide the test set into two subsets, Knotted and Nested, to compare all methods further. The average RMSD for RNAthreader models is 24% lower than that of the second-best method Foldalign on the Knotted dataset, demonstrating the advantage of our method on RNAs with pseudoknots. Besides, within the Knotted subset, we further compute the average coverage of alignments on pseudoknotted base pairs. The results for LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader are 85.6%, 95.8%, 92.6%, 12.8%, and 18%, respectively.</p>
      <p>Finally, we assess the influence of skipping terminal gap penalties on RNAthreader’s performance. It turns out that omitting penalties for terminal gaps has a negligible impact on alignment coverage; however, it results in a noticeable improvement in the corresponding RMSD values. For instance, at the 40% threshold, the average alignment coverage remains nearly consistent, whether or not gap penalties are omitted (53.7% verus 53.5%). Nevertheless, the RMSD decreases from 17.6 Å to 15 Å when penalties for terminal gaps are skipped.</p>
    </sec>
    <sec>
      <title>3.3 Performance on the RNA-Puzzles targets</title>
      <p>We further test our method on the RNA-Puzzles targets. To simulate the situation of the RNA-Puzzles experiments, for targets in the PUZ30 dataset, we excluded all templates released after 1 January 2010. <xref rid="btae080-T2" ref-type="table">Table 2</xref> shows the alignment quality (RMSD and Coverage) on the aligned region and the RMSD of the full-length models. Given high alignment coverage, the full-length model is built by the homology modeling method, ModeRNA, with default parameters based on the top-scoring template. Similarly, if ModeRNA fails to build models for a target, the next template will be utilized until a model is successfully built.</p>
      <table-wrap position="float" id="btae080-T2">
        <label>Table 2.</label>
        <caption>
          <p>Performance of different methods on the RNA-Puzzles targets.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1">Method</th>
              <th colspan="2" align="center" rowspan="1">Aligned region<hr/></th>
              <th rowspan="1" colspan="1">Full-length model</th>
            </tr>
            <tr>
              <th align="center" rowspan="1" colspan="1">RMSD (Å)</th>
              <th rowspan="1" colspan="1">Coverage (%)</th>
              <th align="center" rowspan="1" colspan="1">RMSD (Å)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">LOC</td>
              <td rowspan="1" colspan="1">20.9</td>
              <td rowspan="1" colspan="1">96</td>
              <td rowspan="1" colspan="1">20.3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CAR</td>
              <td rowspan="1" colspan="1">19.4</td>
              <td rowspan="1" colspan="1">94.4</td>
              <td rowspan="1" colspan="1">21</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MOU</td>
              <td rowspan="1" colspan="1">23.9</td>
              <td rowspan="1" colspan="1">94.3</td>
              <td rowspan="1" colspan="1">25.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">FDA</td>
              <td rowspan="1" colspan="1">16.4</td>
              <td rowspan="1" colspan="1">75.1</td>
              <td rowspan="1" colspan="1">23.6</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RTH</td>
              <td rowspan="1" colspan="1">17.6</td>
              <td rowspan="1" colspan="1">81.2</td>
              <td rowspan="1" colspan="1">20.1</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>From <xref rid="btae080-T2" ref-type="table">Table 2</xref>, we find that besides LocARNA, CARNA, and RNAmountAlign maintaining over 90% coverage, Foldalign and RNAthreader also achieve relatively high alignment coverage. RMSDs for other methods increase for the full-length models, except for LocARNA, which has the highest coverage. Additionally, Foldalign shows the largest increase in RMSD with a rise of 44.1%.</p>
      <p>Even if the average coverage of RNAthreader is not the highest, the quality of the full-length models generated by ModeRNA with templates selected by RNAthreader is the best among all the methods. In <xref rid="btae080-F4" ref-type="fig">Fig. 4</xref>, we present an example target from RNA-Puzzles (Puzzle 23, PDB ID: 6E8U) that RNAthreader outperforms other methods. This particular example involves a <italic toggle="yes">mango-III aptamer</italic> (<xref rid="btae080-B37" ref-type="bibr">Trachman <italic toggle="yes">et al.</italic> 2019</xref>). For this target, the RMSDs of the full-length models built using alignments generated by LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader are 11.27, 12.53, 12.07, 15.8, and 6.38 Ås, respectively. The model of RNAthreader is significantly more accurate than that of other methods, whose template 2OE5_B_A is the combination of two chains of 2OE5, with a coverage of 81.1%. Indeed, according to the assessment results released on the RNA-Puzzles website, the best model in the competition is from the Das Lab, with an RMSD of 8.129 Å, which is slightly worse than our model.</p>
      <fig position="float" id="btae080-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Superimposition of the predicted models (in blue) against the native structure (in red) for an example RNA-Puzzles target Puzzle 23 (PDB ID: 6E8U).</p>
        </caption>
        <graphic xlink:href="btae080f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 Analysis of multiple sequence alignment</title>
      <p>Unlike conventional RNA alignment methods, RNAthreader utilizes sequence profiles calculated from MSA. As described above, we filter each MSA based on coverage and sequence identity. If more than 5 homologous sequences remain in the preprocessed MSA, then a sequence profile calculated by <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> will be utilized. After filtering, the sequence profile is used for 60 RNAs in the TE80 dataset when searching for templates. To study the impact of MSA utilization, we compare the performance of three different ways of using MSAs, i.e. not using MSAs (denoted by “noMSA”), using original MSAs generated by RNAcmap (denoted by “originMSA”), using filtered MSAs (denoted by “filterMSA”) on these 60 RNAs. The results after excluding templates with &gt;40% sequence identity are summarized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4A and B</xref> show the comparison in terms of the alignment quality. Compared with not using MSAs, the coverage of the alignment increases by 2.8% after the inclusion of origin MSAs. The average RMSD increases as well, illustrating that the contribution from the original MSA is less significant. However, when filtered MSA is utilized for the sequence profile calculation, the alignment quality improves, with an increase of 7.6% in average coverage and a decrease of 2.6% in RMSD. This demonstrates the importance of filtering MSA. <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4C</xref> shows the comparison in terms of the number of better alignments. With filtered MSA, RNAthreader generates more accurate alignments (higher coverage and lower RMSD) on more targets than not using MSA and using the original MSA. In particular, there are 15 RNAs on which the “filterMSA” has higher alignment quality than “noMSA,” while the latter does not have any alignments superior to the former.</p>
    </sec>
    <sec>
      <title>3.5 Analysis of the predicted secondary structure</title>
      <p>The accuracy of secondary structure prediction may have a direct impact on the performance of RNAthreader, as the predicted secondary structure is an essential component of the alignment progress.</p>
      <p>Note that among the compared methods, only two methods CARNA and RNAthreader, are capable of handling pseudoknots. Hence, we first aim to verify whether RNAthreader's performance is primarily influenced by improved secondary structure prediction. To this end, we utilize RNAfold (<xref rid="btae080-B19" ref-type="bibr">Lorenz <italic toggle="yes">et al.</italic> 2011</xref>), a minimum free energy (MFE) based approach, to predict secondary structure and then incorporate its output as input into RNAthreader. It turns out that after excluding homologous templates with &gt;40% sequence identity, RNAthreader produce alignments with an average RMSD of 16.2 Å and a coverage of 50.5% on the TE80 dataset. Additionally, the accuracy of predicted secondary structures, as assessed by the average interaction network fidelity (INF) (<xref rid="btae080-B24" ref-type="bibr">Parisien <italic toggle="yes">et al.</italic> 2009</xref>), is 0.71 for SPOT-RNA and 0.62 for RNAfold, respectively. The results show that as the quality of RNA secondary structure prediction decreases, the performance of RNAthreader indeed experiences a decline. However, it's noteworthy that RNAthreader consistently generates a larger quantity of superior alignments (with lower RMSD and higher coverage) compared to Foldalign, another method capable of detecting remote homologous templates. In fact, RNAthreader produces superior alignments to Foldalign on 16 RNAs, while Foldalign outperforms RNAthreader on 7 RNAs.</p>
      <p>Subsequently, we further explore how the quality of secondary structure affects the three-dimensional structural models. For the PUZ30 dataset, the Pearson’s correlation coefficient (PCC) between INFs of secondary structures predicted by SPOT-RNA and RMSDs of structure models is −0.622. <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref> shows the scatter plot between the INF and the RMSD, suggesting that the more accurate secondary structure predictions do lead to more accurate 3D structure models from threading.</p>
    </sec>
    <sec>
      <title>3.6 Running time analysis</title>
      <p>We compare the speed of different methods by collecting their running time of searching against the same template library. Given that some of the methods being compared are extremely time-consuming, we exclude redundant sequences from the original library at 99% sequence identity. Then the following experiment was performed on this non-redundant library with 4860 RNAs.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> show the running time of different methods on targets from the TE80 dataset. For better visualization, the longest RNA in this dataset (PDB ID: 5WZN_P) is excluded in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>. We can see from the figure that LocARNA has the highest growth rates in running time as the sequence length increases, followed by CARNA and Foldalign. In contrast, the speed of RNAmountAlign and our method RNAthreader do not have obvious changes. The average running time per RNA for LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader on the TE80 dataset is 42.3, 19.9, 8.6, 4.5, and 1.3 h, respectively. The high speed of our method compared with others is mostly due to the use of the simplified linear arc diagram.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>We have developed a novel RNA threading algorithm named RNAthreader using RNA secondary structure and sequence profile. It speeds up the alignment significantly with a reduced representation of RNA secondary structure and improves the alignment accuracy with the sequence profile. Benchmark tests show that RNAthreader outperforms other methods in terms of alignment accuracy and speed. Nevertheless, we admit that the models built from the RNAthreader templates are not perfect. This may be because of the limited size of the existing RNA template library. We anticipate RNAthreader could be improved further with the release of more experimental RNA structures in the future. Another promising way to improve is using the powerful deep learning algorithms.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae080_Supplementary_Data</label>
      <media xlink:href="btae080_supplementary_data.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Science and Technology Research Program of Chongqing Municipal Education Commission (Grant No. KJQN202300639) and the National Natural Science Foundation of China (NSFC T2225007 and T2222012).</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article are available at <ext-link xlink:href="https://yanglab.qd.sdu.edu.cn/RNAthreader/" ext-link-type="uri">https://yanglab.qd.sdu.edu.cn/RNAthreader/</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae080-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adamczyk</surname><given-names>B</given-names></string-name>, <string-name><surname>Antczak</surname><given-names>M</given-names></string-name>, <string-name><surname>Szachniuk</surname><given-names>M.</given-names></string-name></person-group><article-title>RNAsolo: a repository of cleaned PDB-derived RNA 3D structures</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>3668</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">35674373</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>, <string-name><surname>Madden</surname><given-names>TL</given-names></string-name>, <string-name><surname>Schäffer</surname><given-names>AA</given-names></string-name></person-group><etal>et al</etal><article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res.</source><year>1997</year>;<volume>25</volume>:<fpage>3389</fpage>–<lpage>402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Antczak</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>New functionality of RNAComposer: an application to shape the axis of miR160 precursor structure</article-title>. <source>Acta Biochim. Pol</source><year>2016</year>;<volume>63</volume>:<fpage>737</fpage>–<lpage>44</lpage>.<pub-id pub-id-type="pmid">27741327</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baek</surname><given-names>M</given-names></string-name>, <string-name><surname>DiMaio</surname><given-names>F</given-names></string-name>, <string-name><surname>Anishchenko</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>Accurate prediction of protein structures and interactions using a three-track neural network</article-title>. <source>Science</source><year>2021</year>;<volume>373</volume>:<fpage>871</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">34282049</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bauer</surname><given-names>M</given-names></string-name>, <string-name><surname>Klau</surname><given-names>GW</given-names></string-name>, <string-name><surname>Reinert</surname><given-names>K.</given-names></string-name></person-group><article-title>Accurate multiple sequence-structure alignment of RNA sequences using combinatorial optimization</article-title>. <source>BMC Bioinform</source><year>2007</year>;<volume>8</volume>:<fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bayegan</surname><given-names>AH</given-names></string-name>, <string-name><surname>Clote</surname><given-names>P.</given-names></string-name></person-group><article-title>RNAmountAlign: efficient software for local, global, semiglobal pairwise and multiple RNA sequence/structure alignment</article-title>. <source>PLoS One</source><year>2020</year>;<volume>15</volume>:<fpage>e0227177</fpage>.<pub-id pub-id-type="pmid">31978147</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berman</surname><given-names>HM</given-names></string-name>, <string-name><surname>Westbrook</surname><given-names>J</given-names></string-name>, <string-name><surname>Feng</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>The protein data bank</article-title>. <source>Nucleic Acids Res.</source><year>2000</year>;<volume>28</volume>:<fpage>235</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">10592235</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Das</surname><given-names>R</given-names></string-name>, <string-name><surname>Baker</surname><given-names>D.</given-names></string-name></person-group><article-title>Automated de novo prediction of native-like RNA tertiary structures</article-title>. <source>Proc Natl Acad Sci U S A</source><year>2007</year>;<volume>104</volume>:<fpage>14664</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">17726102</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dowell</surname><given-names>RD</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR.</given-names></string-name></person-group><article-title>Efficient pairwise RNA structure prediction and alignment using sequence alignment constraints</article-title>. <source>BMC Bioinform</source><year>2006</year>;<volume>7</volume>:<fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Havgaard</surname><given-names>JH</given-names></string-name>, <string-name><surname>Gorodkin</surname><given-names>J.</given-names></string-name></person-group><article-title>RNA structural alignments, part I: sankoff-based approaches for structural alignments</article-title>. <source>Methods Mol Biol</source><year>2014</year>;<volume>1097</volume>:<fpage>275</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">24639164</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Havgaard</surname><given-names>JH</given-names></string-name>, <string-name><surname>Torarinsson</surname><given-names>E</given-names></string-name>, <string-name><surname>Gorodkin</surname><given-names>J.</given-names></string-name></person-group><article-title>Fast pairwise structural RNA alignments by pruning of the dynamical programming matrix</article-title>. <source>PLoS Comput. Biol.</source><year>2007</year>;<volume>3</volume>:<fpage>1896</fpage>–<lpage>908</lpage>.<pub-id pub-id-type="pmid">17937495</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hofacker</surname><given-names>IL</given-names></string-name>, <string-name><surname>Bernhart</surname><given-names>SH</given-names></string-name>, <string-name><surname>Stadler</surname><given-names>PF.</given-names></string-name></person-group><article-title>Alignment of RNA base pairing probability matrices</article-title>. <source>Bioinformatics</source><year>2004</year>;<volume>20</volume>:<fpage>2222</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">15073017</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hogeweg</surname><given-names>P</given-names></string-name>, <string-name><surname>Hesper</surname><given-names>B.</given-names></string-name></person-group><article-title>Energy directed folding of RNA sequences</article-title>. <source>Nucleic Acids Res.</source><year>1984</year>;<volume>12</volume>:<fpage>67</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">6198625</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jumper</surname><given-names>J</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source><year>2021</year>;<volume>596</volume>:<fpage>583</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Khor</surname><given-names>BY</given-names></string-name>, <string-name><surname>Tye</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Lim</surname><given-names>TS</given-names></string-name></person-group><etal>et al</etal><article-title>General overview on structure prediction of twilight-zone proteins</article-title>. <source>Theor. Biol. Med. Model.</source><year>2015</year>;<volume>12</volume>:<fpage>15</fpage>–<lpage>1</lpage>.<pub-id pub-id-type="pmid">26338054</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klein</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR.</given-names></string-name></person-group><article-title>RSEARCH: finding homologs of single structured RNA sequences</article-title>. <source>BMC Bioinform</source><year>2003</year>;<volume>4</volume>:<fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krokhotin</surname><given-names>A</given-names></string-name>, <string-name><surname>Houlihan</surname><given-names>K</given-names></string-name>, <string-name><surname>Dokholyan</surname><given-names>NV.</given-names></string-name></person-group><article-title>iFoldRNA v2: folding RNA with constraints</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>2891</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">25910700</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kryshtafovych</surname><given-names>A</given-names></string-name>, <string-name><surname>Schwede</surname><given-names>T</given-names></string-name>, <string-name><surname>Topf</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Critical assessment of methods of protein structure prediction (CASP)—round XIV</article-title>. <source>Proteins: Struct., Funct., Bioinf.</source><year>2021</year>;<volume>89</volume>:<fpage>1607</fpage>–<lpage>17</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lorenz</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>ViennaRNA package 2.0</article-title>. <source>Algorithms Mol. Biol</source><year>2011</year>;<volume>6</volume>:<fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">21235792</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Magnus</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>RNA-Puzzles toolkit: a computational resource of RNA 3D structure benchmark datasets, structure manipulation, and evaluation tools</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>48</volume>:<fpage>576</fpage>–<lpage>88</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mathews</surname><given-names>DH</given-names></string-name>, <string-name><surname>Turner</surname><given-names>DH.</given-names></string-name></person-group><article-title>Dynalign: an algorithm for finding the secondary structure common to two RNA sequences</article-title>. <source>J. Mol. Biol.</source><year>2002</year>;<volume>317</volume>:<fpage>191</fpage>–<lpage>203</lpage>.<pub-id pub-id-type="pmid">11902836</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nawrocki</surname><given-names>EP</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR.</given-names></string-name></person-group><article-title>Infernal 1.1: 100-fold faster RNA homology searches</article-title>. <source>Bioinformatics</source><year>2013</year>;<volume>29</volume>:<fpage>2933</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">24008419</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Needleman</surname><given-names>SB</given-names></string-name>, <string-name><surname>Wunsch</surname><given-names>CD.</given-names></string-name></person-group><article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>. <source>J Mol. Biol.</source><year>1970</year>;<volume>48</volume>:<fpage>443</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">5420325</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parisien</surname><given-names>M</given-names></string-name>, <string-name><surname>Cruz</surname><given-names>JA</given-names></string-name>, <string-name><surname>Westhof</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>New metrics for comparing and assessing discrepancies between RNA 3D structures and models</article-title>. <source>RNA</source><year>2009</year>;<volume>15</volume>:<fpage>1875</fpage>–<lpage>85</lpage>.<pub-id pub-id-type="pmid">19710185</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parisien</surname><given-names>M</given-names></string-name>, <string-name><surname>Major</surname><given-names>F.</given-names></string-name></person-group><article-title>The MC-Fold and MC-Sym pipeline infers RNA structure from sequence data</article-title>. <source>Nature</source><year>2008</year>;<volume>452</volume>:<fpage>51</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">18322526</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Han</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Protein structure prediction in the deep learning era</article-title>. <source>Curr. Opin. Struct. Biol.</source><year>2022</year>;<volume>77</volume>:<fpage>102495</fpage>.<pub-id pub-id-type="pmid">36371845</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peselis</surname><given-names>A</given-names></string-name>, <string-name><surname>Serganov</surname><given-names>A.</given-names></string-name></person-group><article-title>Structure and function of pseudoknots involved in gene expression control</article-title>. <source>Wiley Interdiscip Rev RNA</source><year>2014</year>;<volume>5</volume>:<fpage>803</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">25044223</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Popenda</surname><given-names>M</given-names></string-name>, <string-name><surname>Szachniuk</surname><given-names>M</given-names></string-name>, <string-name><surname>Antczak</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Automated 3D structure composition for large RNAs</article-title>. <source>Nucleic Acids Res.</source><year>2012</year>;<volume>40</volume>:<fpage>e112</fpage>-<lpage>e112</lpage>.<pub-id pub-id-type="pmid">22539264</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rother</surname><given-names>M</given-names></string-name>, <string-name><surname>Rother</surname><given-names>K</given-names></string-name>, <string-name><surname>Puton</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>ModeRNA: a tool for comparative modeling of RNA 3D structure</article-title>. <source>Nucleic Acids Res.</source><year>2011</year>;<volume>39</volume>:<fpage>4007</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">21300639</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sankoff</surname><given-names>D.</given-names></string-name></person-group><article-title>Simultaneous solution of the RNA folding, alignment and protosequence problems</article-title>. <source>SIAM J. Appl. Math.</source><year>1985</year>;<volume>45</volume>:<fpage>810</fpage>–<lpage>25</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Singh</surname><given-names>J</given-names></string-name>, <string-name><surname>Hanson</surname><given-names>J</given-names></string-name>, <string-name><surname>Paliwal</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>RNA secondary structure prediction using an ensemble of two-dimensional deep neural networks and transfer learning</article-title>. <source>Nat. Commun.</source><year>2019</year>;<volume>10</volume>:<fpage>5407</fpage>.<pub-id pub-id-type="pmid">31776342</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sorescu</surname><given-names>DA</given-names></string-name>, <string-name><surname>Möhl</surname><given-names>M</given-names></string-name>, <string-name><surname>Mann</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>CARNA—alignment of RNA structure ensembles</article-title>. <source>Nucleic Acids Res.</source><year>2012</year>;<volume>40</volume>:<fpage>W49</fpage>–<lpage>W53</lpage>.<pub-id pub-id-type="pmid">22689637</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>HH-suite3 for fast remote homology detection and deep protein annotation</article-title>. <source>BMC Bioinform</source><year>2019</year>;<volume>20</volume>:<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Peng</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>RNA inter-nucleotide 3D closeness prediction by deep residual neural networks</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>37</volume>:<fpage>1093</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Wu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Peng</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Enhanced prediction of RNA solvent accessibility with long short-term memory neural networks and improved sequence profiles</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>35</volume>:<fpage>1686</fpage>–<lpage>91</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sundfeld</surname><given-names>D</given-names></string-name>, <string-name><surname>Havgaard</surname><given-names>JH</given-names></string-name>, <string-name><surname>de Melo</surname><given-names>ACMA</given-names></string-name></person-group><etal>et al</etal><article-title>Foldalign 2.5: multithreaded implementation for pairwise structural RNA alignment</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>32</volume>:<fpage>1238</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">26704597</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trachman</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Autour</surname><given-names>A</given-names></string-name>, <string-name><surname>Jeng</surname><given-names>SCY</given-names></string-name></person-group><etal>et al</etal><article-title>Structure and functional reselection of the Mango-III fluorogenic RNA aptamer</article-title>. <source>Nat. Chem. Biol.</source><year>2019</year>;<volume>15</volume>:<fpage>472</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">30992561</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Feng</surname><given-names>C</given-names></string-name>, <string-name><surname>Han</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>trRosettaRNA: automated prediction of RNA 3D structure with transformer network</article-title>. <source>Nat. Commun.</source><year>2023</year>;<volume>14</volume>:<fpage>7266</fpage>.<pub-id pub-id-type="pmid">37945552</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Watkins</surname><given-names>AM</given-names></string-name>, <string-name><surname>Rangan</surname><given-names>R</given-names></string-name>, <string-name><surname>Das</surname><given-names>R.</given-names></string-name></person-group><article-title>FARFAR2: improved De novo rosetta prediction of complex global RNA folds</article-title>. <source>Structure</source><year>2020</year>;<volume>28</volume>:<fpage>963</fpage>–<lpage>76.e6</lpage>.<pub-id pub-id-type="pmid">32531203</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Will</surname><given-names>S</given-names></string-name>, <string-name><surname>Reiche</surname><given-names>K</given-names></string-name>, <string-name><surname>Hofacker</surname><given-names>IL</given-names></string-name></person-group><etal>et al</etal><article-title>Inferring noncoding rna families and classes by means of genome-scale structure-based clustering</article-title>. <source>PLoS Comput. Biol.</source><year>2007</year>;<volume>3</volume>:<fpage>e65</fpage>.<pub-id pub-id-type="pmid">17432929</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>H</given-names></string-name>, <string-name><surname>Jossinet</surname><given-names>F</given-names></string-name>, <string-name><surname>Leontis</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>Tools for the automatic identification and classification of RNA base pairs</article-title>. <source>Nucleic Acids Res.</source><year>2003</year>;<volume>31</volume>:<fpage>3450</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">12824344</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>T</given-names></string-name>, <string-name><surname>Singh</surname><given-names>J</given-names></string-name>, <string-name><surname>Litfin</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>RNAcmap: a fully automatic pipeline for predicting contact maps of RNAs by evolutionary coupling analysis</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>3494</fpage>–<lpage>500</lpage>.<pub-id pub-id-type="pmid">34021744</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Xiao</surname><given-names>Y.</given-names></string-name></person-group><article-title>3dRNA: 3D structure prediction from linear to circular RNAs</article-title>. <source>J. Mol. Biol.</source><year>2022</year>;<volume>434</volume>:<fpage>167452</fpage>.<pub-id pub-id-type="pmid">35662453</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>C</given-names></string-name>, <string-name><surname>Xu</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S-J.</given-names></string-name></person-group><article-title>Predicting RNA structure with vfold</article-title>. <source>Methods Mol Biol</source><year>2017</year>;<volume>1654</volume>:<fpage>3</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">28986779</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Huang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Gong</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Automated and fast building of three-dimensional RNA structures</article-title>. <source>Sci Rep</source><year>2012</year>;<volume>2</volume>:<fpage>734</fpage>.<pub-id pub-id-type="pmid">23071898</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10893584</article-id>
    <article-id pub-id-type="pmid">38341662</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae080</article-id>
    <article-id pub-id-type="publisher-id">btae080</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RNA threading with secondary structure and sequence profile</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Zongyang</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="equal">Data curation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="equal">Software</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Chongqing Key Laboratory of Big Data for Bio Intelligence, Chongqing University of Posts and Telecommunications</institution>, Chongqing 400065, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0303-6693</contrib-id>
        <name>
          <surname>Peng</surname>
          <given-names>Zhenling</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>MOE Frontiers Science Center for Nonlinear Expectations, Research Center for Mathematics and Interdisciplinary Sciences, Shandong University</institution>, Qingdao 266237, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2912-7737</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Jianyi</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration" degree-contribution="equal">Project administration</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>MOE Frontiers Science Center for Nonlinear Expectations, Research Center for Mathematics and Interdisciplinary Sciences, Shandong University</institution>, Qingdao 266237, <country country="CN">China</country></aff>
        <xref rid="btae080-cor1" ref-type="corresp"/>
        <!--yangjy@sdu.edu.cn-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cowen</surname>
          <given-names>Lenore</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae080-cor1">Corresponding author. MOE Frontiers Science Center for Nonlinear Expectations, Research Center for Mathematics and Interdisciplinary Sciences, Shandong University, Qingdao 266237, China. E-mail: <email>yangjy@sdu.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-02-10">
      <day>10</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>2</issue>
    <elocation-id>btae080</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>05</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>01</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>23</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae080.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>RNA threading aims to identify remote homologies for template-based modeling of RNA 3D structure. Existing RNA alignment methods primarily rely on secondary structure alignment. They are often time- and memory-consuming, limiting large-scale applications. In addition, the accuracy is far from satisfactory.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Using RNA secondary structure and sequence profile, we developed a novel RNA threading algorithm, named RNAthreader. To enhance the alignment process and minimize memory usage, a novel approach has been introduced to simplify RNA secondary structures into compact diagrams. RNAthreader employs a two-step methodology. Initially, integer programming and dynamic programming are combined to create an initial alignment for the simplified diagram. Subsequently, the final alignment is obtained using dynamic programming, taking into account the initial alignment derived from the previous step. The benchmark test on 80 RNAs illustrates that RNAthreader generates more accurate alignments than other methods, especially for RNAs with pseudoknots. Another benchmark, involving 30 RNAs from the RNA-Puzzles experiments, exhibits that the models constructed using RNAthreader templates have a lower average RMSD than those created by alternative methods. Remarkably, RNAthreader takes less than two hours to complete alignments with ∼5000 RNAs, which is 3–40 times faster than other methods. These compelling results suggest that RNAthreader is a promising algorithm for RNA template detection.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>
          <ext-link xlink:href="https://yanglab.qd.sdu.edu.cn/RNAthreader" ext-link-type="uri">https://yanglab.qd.sdu.edu.cn/RNAthreader</ext-link>
        </p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Science and Technology Research Program</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>NSFC T2225007</award-id>
        <award-id>T2222012</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The 14th community-wide experiment on the critical assessment of techniques for protein structure prediction (CASP14) (<xref rid="btae080-B18" ref-type="bibr">Kryshtafovych <italic toggle="yes">et al.</italic> 2021</xref>) has witnessed great progress in protein structure prediction. With powerful deep learning techniques (<xref rid="btae080-B4" ref-type="bibr">Baek <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btae080-B14" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>), the structure prediction problem for single-domain proteins has been nearly solved (<xref rid="btae080-B26" ref-type="bibr">Peng <italic toggle="yes">et al.</italic> 2022</xref>). However, structure prediction for RNAs with deep learning remains challenging, due to the complexity of RNA molecules and the lack of enough experimentally solved structures (<xref rid="btae080-B38" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2023</xref>). The RNA structure prediction methods can be broadly grouped into two categories: <italic toggle="yes">ab initio</italic> modeling and template-based modeling (TBM).</p>
    <p>There are two major types of <italic toggle="yes">ab initio</italic> modeling methods. The first one is based on molecular dynamics simulation, such as Vfold3D (<xref rid="btae080-B44" ref-type="bibr">Zhao <italic toggle="yes">et al.</italic> 2017</xref>) and iFoldRNA (<xref rid="btae080-B17" ref-type="bibr">Krokhotin <italic toggle="yes">et al.</italic> 2015</xref>). The second one is based on fragment assembly, such as FARFAR (<xref rid="btae080-B8" ref-type="bibr">Das and Baker 2007</xref>), FARFAR2 (<xref rid="btae080-B39" ref-type="bibr">Watkins <italic toggle="yes">et al.</italic> 2020</xref>), RNAComposer (<xref rid="btae080-B28" ref-type="bibr">Popenda <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btae080-B3" ref-type="bibr">Antczak <italic toggle="yes">et al.</italic> 2016</xref>), 3dRNA (<xref rid="btae080-B45" ref-type="bibr">Zhao <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btae080-B43" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2022</xref>), and MC-Fold/MC-Sym (<xref rid="btae080-B25" ref-type="bibr">Parisien and Major 2008</xref>). These methods can be further grouped into full-atom simulation or coarse-grained simulation. The former performs a simulation of all atoms in a single round, which works well on short RNAs; while its great demand for computing resources prevents the application in structure prediction for large RNAs. The latter addresses this issue by merging certain atoms into so-called coarse-grained particles; while the ability to add atom-level details needs to be further strengthened.</p>
    <p>TBM methods build the structure model for a query RNA using homologous templates in PDB (<xref rid="btae080-B7" ref-type="bibr">Berman <italic toggle="yes">et al.</italic> 2000</xref>). Accurate query-template alignment plays a key role in TBM methods. The alignment is usually conducted based on the secondary structure. However, RNA secondary structure is formed by base pairs (2D map), making the RNA alignment much more difficult than protein (1D sequence).</p>
    <p>Sankoff proposed an algorithm to compute the alignment and the common secondary structure of two RNA sequences simultaneously, based on dynamic programming for free energy minimization (<xref rid="btae080-B30" ref-type="bibr">Sankoff 1985</xref>). This algorithm requires <italic toggle="yes">O</italic>(<italic toggle="yes">n<sup>6</sup></italic>) time and <italic toggle="yes">O</italic>(<italic toggle="yes">n<sup>4</sup></italic>) memory (<italic toggle="yes">n</italic> is the length of RNAs to be aligned), which grow very fast when the sequence length increases. This issue limits its real-world applications.</p>
    <p>To address the above issue, several algorithms were proposed, which are referred to as Sankoff-style algorithms. There are three main types of Sankoff-style algorithms (<xref rid="btae080-B10" ref-type="bibr">Havgaard and Gorodkin 2014</xref>). The first is based on energy minimization, which is most similar to the original Sankoff algorithm, with representative methods such as Foldalign (<xref rid="btae080-B11" ref-type="bibr">Havgaard <italic toggle="yes">et al.</italic> 2007</xref>) and Dynalign (<xref rid="btae080-B21" ref-type="bibr">Mathews and Turner 2002</xref>). Methods of the second type are based on the alignment of base-pairing probability matrix, such as PMcomp (<xref rid="btae080-B12" ref-type="bibr">Hofacker <italic toggle="yes">et al.</italic> 2004</xref>) and LocARNA (<xref rid="btae080-B40" ref-type="bibr">Will <italic toggle="yes">et al.</italic> 2007</xref>). The third type of method uses statistical models based on stochastic context-free grammars (SCFG), such as Consan (<xref rid="btae080-B9" ref-type="bibr">Dowell and Eddy 2006</xref>) and RSEARCH (<xref rid="btae080-B16" ref-type="bibr">Klein and Eddy 2003</xref>). Some of these methods use different heuristic strategies to reduce time and memory consumption. For instance, Foldalign filters subalignments by setting length-related cutoffs, and LocARNA simplifies the base paring probability matrix by ignoring elements below a certain threshold.</p>
    <p>There are some non-Sankoff-style algorithms for RNA alignment. For example, RNAmountAlign (<xref rid="btae080-B6" ref-type="bibr">Bayegan and Clote 2020</xref>) aligns two RNAs with Needleman-Wunsch dynamic programming (NWDP) (<xref rid="btae080-B23" ref-type="bibr">Needleman and Wunsch 1970</xref>) based on the mountain height (<xref rid="btae080-B13" ref-type="bibr">Hogeweg and Hesper 1984</xref>) of their secondary structures, and LARA (<xref rid="btae080-B5" ref-type="bibr">Bauer <italic toggle="yes">et al.</italic> 2007</xref>) is a graph-based method which solves the alignment problem by integer linear programming.</p>
    <p>In this work, we developed a new RNA threading algorithm named RNAthreader. It is built on simplified secondary structure diagrams and sequence profiles from multiple sequence alignments. Benchmark tests show the advantage of RNAthreader over other methods in terms of both accuracy and speed.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Template library</title>
      <p>We retrieve experimentally determined 3D RNA structures from the RNAsolo database (<xref rid="btae080-B1" ref-type="bibr">Adamczyk <italic toggle="yes">et al.</italic> 2022</xref>) and use them to construct a template library comprising two distinct components: single-chain and multi-chain RNAs. The single-chain component encompasses all available single-chain RNA structures. Since base pairing between different chains is common, it is necessary to consider connecting different chains that form base pairs. To this end, we utilize RNAView (<xref rid="btae080-B41" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2003</xref>) for secondary structure annotation, with the assembly structure as input. Specifically, for two chains denoted as A and B, if the number of base pairs between them exceeds 20% of the length of A or B, the combinations A_B and B_A will be added as new templates. In cases where a chain forms base pairs with multiple chains, we will include the additional chain that shares the largest number of base pairs with it. Consequently, each template in our library contains a maximum of three chains. Following this procedure, we successfully curate a template library comprising 18,195 RNAs. The library files are available for download at: <ext-link xlink:href="https://yanglab.qd.sdu.edu.cn/RNAthreader" ext-link-type="uri">https://yanglab.qd.sdu.edu.cn/RNAthreader</ext-link>.</p>
    </sec>
    <sec>
      <title>2.2 Training and test datasets</title>
      <p>Three datasets were used for training and testing. The training set, TR221, and the first test set, TE80, are obtained from our previous work RNAContact (<xref rid="btae080-B34" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> 2020</xref>). TR221 consists of 221 RNAs, and TE80 comprises 80 RNAs, with sequence lengths spanning 32 to 1,000 nucleotides. RNAs from these two datasets share less than 30% sequence identity. Based on the presence or absence of pseudoknots, we further divided the TE80 dataset into two subsets: Knotted and Nested. Here a pseudoknot is a bipartite helical structure formed by base pairing of the apical loop in the stem-loop structure with an outside sequence (<xref rid="btae080-B27" ref-type="bibr">Peselis and Serganov 2014</xref>). The second test set (denoted by PUZ30) includes 30 RNAs from RNA-Puzzles (<xref rid="btae080-B20" ref-type="bibr">Magnus <italic toggle="yes">et al.</italic> 2019</xref>). Note that Puzzle 10, Puzzle 26, Puzzle 27, and Puzzle 28 are T-box riboswitch—tRNA complexes. For these targets, we only select T-box riboswitches for structure prediction. Besides, Puzzle 14 is an <italic toggle="yes">L-glutamine riboswitch</italic> with Bound and Free forms, which are treated as two different targets. More details about the PUZ30 dataset are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>.</p>
    </sec>
    <sec>
      <title>2.3 Algorithm inputs</title>
      <sec>
        <title>2.3.1 Sequence profile</title>
        <p>The multiple sequence alignment (MSA) for each query RNA was generated with RNAcmap (<xref rid="btae080-B42" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2021</xref>). The RNAcmap method begins with an initial homolog search using BLAST-N (<xref rid="btae080-B2" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1997</xref>) against the NCBI nucleotide database. The returned homologs and the secondary structure predicted by SPOT-RNA (<xref rid="btae080-B31" ref-type="bibr">Singh <italic toggle="yes">et al.</italic> 2019</xref>) are then utilized to build a covariance model. In the end, an MSA is generated by the second round of homolog search using INFERNAL (<xref rid="btae080-B22" ref-type="bibr">Nawrocki and Eddy 2013</xref>). Given that the MSA may contain redundant sequences, we use HHfilter (<xref rid="btae080-B33" ref-type="bibr">Steinegger <italic toggle="yes">et al.</italic> 2019</xref>) to remove sequences sharing &gt;80% sequence identity or &lt;75% coverage with the query sequence. If the number of remaining homologs in the MSA is less than 5, we will not use sequence profiles in the following steps. Otherwise, we compute the sequence profile in a manner similar to that employed in PSI-BLAST (<xref rid="btae080-B2" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1997</xref>):
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>0.4</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">q<sub>i</sub></italic> is the nucleotide type for the <italic toggle="yes">i</italic>th position of the query RNA, <italic toggle="yes">d</italic>(<italic toggle="yes">q<sub>i</sub></italic>) is the number of nucleotide types different from <italic toggle="yes">q<sub>i</sub></italic> in the <italic toggle="yes">i</italic>th column of the MSA, <italic toggle="yes">f</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">k</italic>) is the observed frequency of the <italic toggle="yes">k</italic>th nucleotide in the <italic toggle="yes">i</italic>th column of the MSA, <italic toggle="yes">p</italic>(<italic toggle="yes">q<sub>i</sub></italic>) is the background probability of <italic toggle="yes">q<sub>i</sub></italic>, estimated from the NCBI nucleotide database (<italic toggle="yes">p</italic>(A) = 0.27, <italic toggle="yes">p</italic>(U) = 0.27, <italic toggle="yes">p</italic>(G) = 0.23, <italic toggle="yes">p</italic>(C) = 0.23) (<xref rid="btae080-B35" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> 2018</xref>), and <italic toggle="yes">R<sub>s</sub></italic> refers to the RIBOSUM single nucleotide matrix (<xref rid="btae080-B16" ref-type="bibr">Klein and Eddy 2003</xref>). Note that this profile automatically takes a balance between the MSA and the RIBOSUM matrix. The sequence profile largely depends on the MSA when it contains a large number of homologous sequences; while it resembles the RIBOSUM matrix when the MSA is shallow.</p>
        <p>For RNAs in the template library, we also tried using BLAST-N for homologous sequence detection. However, many templates could not find any sequence homologs. To ensure the consistency of alignment scores, we did not use the sequence profile for templates. Thus, the query-template alignment will be performed in the profile-sequence or sequence-sequence manner in the following steps.</p>
      </sec>
      <sec>
        <title>2.3.2 Secondary structure</title>
        <p>For the query RNA, we use the deep learning algorithm SPOT-RNA to predict its secondary structure. For RNAs in the template library, their secondary structures are extracted from native structures using RNAView. RNA secondary structure is usually represented as a planar graph (see <xref rid="btae080-F2" ref-type="fig">Fig. 2A</xref> for an example).</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Alignment algorithm</title>
      <sec>
        <title>2.4.1 Workflow of the alignment algorithm</title>
        <p>The flowchart of RNAthreader is presented in <xref rid="btae080-F1" ref-type="fig">Fig. 1</xref>. It consists of two main steps. First, it extracts all the nucleotides forming base pairs and performs their alignments. Second, it generates the final alignment based on the sequence profile and the secondary structure alignment result.</p>
        <fig position="float" id="btae080-F1">
          <label>Figure 1.</label>
          <caption>
            <p>Flowchart of RNAthreader. Here “SS” stands for secondary structure, “IP” is integer programming, and “NWDP” denotes Needleman-Wunsch dynamic programming.</p>
          </caption>
          <graphic xlink:href="btae080f1" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>2.4.2 Alignment of simplified secondary diagrams</title>
        <p>The secondary structure of each RNA is converted into a linear arc diagram (<xref rid="btae080-F2" ref-type="fig">Fig. 2B</xref>) for alignment. In the linear arc diagram, the vertices denote nucleotides and those connected by edges represent base pairs. With the graphical representation, the problem of finding the best alignment can be transformed into an integer programming problem with specified constraints (<xref rid="btae080-B5" ref-type="bibr">Bauer <italic toggle="yes">et al.</italic> 2007</xref>). However, the amount of constraints and variables in the integer programming problem grows rapidly with the increase of sequence lengths.</p>
        <fig position="float" id="btae080-F2">
          <label>Figure 2.</label>
          <caption>
            <p>Secondary structure diagrams for an example RNA. (A) Planar graph with base pairs indicated by colored and connected vertices. (B) Linear arc diagram. (C) Simplified linear arc diagram.</p>
          </caption>
          <graphic xlink:href="btae080f2" position="float"/>
        </fig>
        <p>To address this issue, we simplify the linear arc diagram of RNA secondary structure as follows. First, only nucleotides forming base pairs are kept. Yet for RNAs with a large proportion of base pairs, this simplification only has a limited effect. Thus, we further define the concept of <italic toggle="yes">substructures</italic>. A substructure is a fragment consisting of consecutive base pairs, which allows the existence of bulge and interior loops (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref> for examples). As illustrated in <xref rid="btae080-F2" ref-type="fig">Fig. 2A</xref>, the five colored fragments correspond to five different substructures. Second, we merge base pairs in the same substructure and get the final simplified diagram as shown in <xref rid="btae080-F2" ref-type="fig">Fig. 2C</xref>. With the above procedures, the original diagram is significantly simplified and the relative positions of substructures are retained.</p>
        <p>Initial alignment is then conducted on the simplified diagram. The alignment between two simplified diagrams is based on integer programming to maximize the following objective function.
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msubsup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">V<sub>q</sub></italic>/<italic toggle="yes">V<sub>t</sub></italic> is the set of the substructures in the simplified diagram of the query/template; the substructure <italic toggle="yes">Sq i</italic> is denoted as a two-element tuple (<italic toggle="yes">Sq i, 1</italic>, <italic toggle="yes">Sq i, 2</italic>), in which <italic toggle="yes">Sq i, 1</italic> and <italic toggle="yes">Sq i, 2</italic> are the two paired halves; δ(<italic toggle="yes">x</italic>, <italic toggle="yes">y</italic>) equals to 1 if <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> are aligned, and 0 otherwise; <italic toggle="yes">ω<sub>ij</sub></italic> is the matching score between substructures <italic toggle="yes">Sq i</italic> and <italic toggle="yes">St j</italic>, which is determined based on the NWDP (introduced in the next section). The objective function is subjective to two constraints to generate meaningful alignment: (1) there is no cross-alignment. In other words, once regions <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> are aligned, alignment cannot occur between the regions before <italic toggle="yes">x</italic> and the regions after <italic toggle="yes">y</italic> (or vice versa); (2) each vertex in a graph can be aligned to at most one vertex in another graph.</p>
        <p>After solving the above integer programming problem, the alignment between two simplified secondary diagrams is obtained. It is used in the next step to generate nucleotide-level alignment with NWDP.</p>
      </sec>
      <sec>
        <title>2.4.3 Alignment of substructures with NWDP</title>
        <p>The matching score and alignment between two substructures are obtained based on NWDP. Given that substructures only contain nucleotides forming base pairs, we design a <italic toggle="yes">partial</italic> alignment strategy, which only aligns half of the substructures. The alignment of the other half is completed automatically based on their base-pairing relationships. The scoring function for the partial alignment in NWDP is calculated as follows.
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo> + </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eff</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo> + </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo> + </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eff</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>≠</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mtext>stem</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>stem</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where (<italic toggle="yes">m<sub>1</sub></italic>, <italic toggle="yes">m<sub>2</sub></italic>)/(<italic toggle="yes">n<sub>1</sub></italic>, <italic toggle="yes">n<sub>2</sub></italic>) is a base pair in a substructure of the query/template; <italic toggle="yes">q<sub>i</sub></italic> is the type of the <italic toggle="yes">i</italic>th nucleotide in the query, <italic toggle="yes">t<sub>k</sub></italic> is the type of the <italic toggle="yes">k</italic>th nucleotide in the template; <italic toggle="yes">R<sub>P</sub></italic> refers to the RIBOSUM base-pairing matrix; <italic toggle="yes">F<sub>q</sub></italic> is defined by <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>; <italic toggle="yes">N<sub>eff</sub></italic> is the number of effective sequences in MSA, which equals to the number of remaining sequences in MSA after filtering; <italic toggle="yes">s<sub>E</sub></italic> reflects the similarity of the base pairs in the local environment (<xref rid="E4" ref-type="disp-formula">Equation (4)</xref>). To define the local environment for a base pair (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>), we first cut the whole diagram into two subgraphs at the edge (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>). The environment for the base pair (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) in query is then defined as the smallest closed loop which starts at <italic toggle="yes">i</italic> and ends at <italic toggle="yes">j</italic> in each subgraph<italic toggle="yes">.</italic> Finally, the environment’s secondary structure type (stem, hairpin, bulge, interior loop, multi-loop, or pseudoknot, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>) makes the two-element tuple <italic toggle="yes">E<sub>q</sub></italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) in <xref rid="E4" ref-type="disp-formula">Equation (4)</xref>.</p>
        <p>If the sequence profile of the query RNA is not utilized, the gap open penalty is 3 and the gap extension penalty is 1. Otherwise, gap penalties will be adjusted according to the ratio of gaps in each column of the MSA, i.e. the higher the ratio of gaps is, the lower the gap penalty will be.</p>
      </sec>
      <sec>
        <title>2.4.4 Final alignment</title>
        <p>From Section 2.4.2, we obtain the alignment between two simplified secondary diagrams. The nucleotide-level alignment between aligned substructures is the NWDP result described in Section 2.4.3. The final alignment between the query and each template is performed by NWDP with the following scoring function.
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">aln</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eff</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">aln</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eff</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where the definitions of <italic toggle="yes">q<sub>i</sub></italic>, <italic toggle="yes">t<sub>j</sub></italic>, <italic toggle="yes">R<sub>s</sub></italic>, <italic toggle="yes">N<sub>eff</sub></italic>, and <italic toggle="yes">F<sub>q</sub></italic> are the same as those in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> and <xref rid="E3" ref-type="disp-formula">Equation (3)</xref>; <italic toggle="yes">I</italic>(.) is an indicator function, whose value is 1 when the corresponding event happens, and 0 otherwise; <italic toggle="yes">S<sub>aln</sub></italic> is the set of aligned nucleotides (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) in the previous step. The setting of gap penalties is the same as that described in Section 2.4.3 except that penalty is skipped for terminal gaps.</p>
      </sec>
    </sec>
    <sec>
      <title>2.5 Performance evaluation</title>
      <p>Alignment quality and model quality are used for evaluating the performance of different methods. Here the alignment quality is quantified by two metrics: alignment coverage and the RMSD of the aligned region. Alignment coverage is calculated by dividing the aligned length by the length of the query RNA. As for RMSD of the aligned region, we first extract coordinates of all heavy atoms on the backbone of aligned nucleotides from the template RNA, then compute RMSD with the corresponding region in the native structure. The other measure model quality is quantified by the RMSD between the native structure and the full-atom model built by FARFAR2 (<xref rid="btae080-B39" ref-type="bibr">Watkins <italic toggle="yes">et al.</italic> 2020</xref>) or ModeRNA (<xref rid="btae080-B29" ref-type="bibr">Rother <italic toggle="yes">et al.</italic> 2011</xref>) according to query-template alignment. The selection of the method for constructing the full-length model is determined by the alignment coverage. FARFAR2 is used when the alignment coverage varies significantly; otherwise, ModeRNA is used.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results and discussions</title>
    <sec>
      <title>3.1 Algorithm implementation and parameter optimization</title>
      <p>The RNAthreader algorithm is implemented in C++. We use the high-performance mathematical programming engine IBM ILOG CPLEX 12.9 to solve the quadratic integer programming problem presented in <xref rid="E2" ref-type="disp-formula">Equation (2)</xref>. With simplified linear arc diagrams of RNA secondary structures (<xref rid="btae080-F2" ref-type="fig">Fig. 2C</xref>), the number of variables to be solved and corresponding constraints decrease substantially.</p>
      <p>All the parameters were empirically selected to yield the best performance on the TR221 dataset. During the training process, templates sharing &gt; 40% sequence identity with query RNAs were excluded. After the exclusion of close homologous templates, the average alignment coverage is relatively low. We tuned the parameters based on the alignment quality defined in Section 2.5.</p>
    </sec>
    <sec>
      <title>3.2 Performance on the TE80 dataset</title>
      <p>In the absence of dedicated RNA threading methods, we compare RNAthreader with four representative RNA alignment algorithms: LocARNA (version 1.9.2.1) (<xref rid="btae080-B40" ref-type="bibr">Will <italic toggle="yes">et al.</italic> 2007</xref>), CARNA (version 1.3.3) (<xref rid="btae080-B32" ref-type="bibr">Sorescu <italic toggle="yes">et al.</italic> 2012</xref>), Foldalign (version 2.5.3) (<xref rid="btae080-B36" ref-type="bibr">Sundfeld <italic toggle="yes">et al.</italic> 2015</xref>), and RNAmountAlign (<xref rid="btae080-B6" ref-type="bibr">Bayegan and Clote 2020</xref>). We first conduct experiments on the TE80 dataset with four distinct thresholds: 60%, 50%, 40%, and 30%, which correspond to four progressively increasing levels of threading difficulty. In each comparison, templates with sequence identity to the query exceeding a certain threshold are excluded. The average number of non-redundant templates (&lt;99% pairwise sequence identity) remaining in the library for the four thresholds are as follows: 3991, 3713, 3344, and 2817, respectively. <xref rid="btae080-F3" ref-type="fig">Figure 3</xref> depicts the alignment quality, assessed in terms of coverage and RMSD, for the top-scoring alignment across different thresholds.</p>
      <fig position="float" id="btae080-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Alignment quality for the top-scoring alignment across different thresholds on the TE80 dataset. “LOC,” “CAR,” “MOU,” “FDA,” and “RTH” represent the methods LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader, respectively.</p>
        </caption>
        <graphic xlink:href="btae080f3" position="float"/>
      </fig>
      <p>The compared methods can be categorized into two groups based on the average coverage (as shown in <xref rid="btae080-F3" ref-type="fig">Fig. 3A</xref>): LocARNA, CARNA, and RNAmountAlign consistently maintain high coverages across different thresholds, while Foldalign and RNAthreader exhibit increasing average coverages as more templates with higher sequence identity become available. Likewise, there is a notable variation in RMSDs between these two groups of methods (<xref rid="btae080-F3" ref-type="fig">Fig. 3B</xref>). In the first group, the RMSDs of these methods have a tendency to increase as the threshold decreases, indicating that they could not effectively identify structure templates with low sequence identity. Moreover, RNAmountAlign yields alignments with significantly higher RMSDs when compared to LocARNA and CARNA. This observation suggests that it might not be appropriate to directly apply the Needleman-Wunsch dynamic programming to align RNAs. As for methods in the second group, namely Foldalign and RNAthreader, they exhibit relatively low average RMSDs that remain consistent regardless of the threading difficulty. The above facts confirm the reliability of these two methods in template detection.</p>
      <p>For proteins, a remote homolog is typically defined as a homologous template with less than 30% sequence identity to the query (<xref rid="btae080-B15" ref-type="bibr">Khor <italic toggle="yes">et al.</italic> 2015</xref>). However, due to the limited number of nucleotide types compared to amino acids, RNA sequences often exhibit higher similarity. Therefore, for RNAs, we use a threshold of 40% for remote homologs and conduct a more detailed analysis at this specific threshold.</p>
      <p>For each query, the alignment coverage for different methods varies, making the direct comparison in terms of RMSD less meaningful. To address this issue, we say method A generates more accurate alignment than method B on a target if the following two conditions are satisfied: (1) the RMSD on the aligned region of method A is lower than that of method B; (2) the alignment coverage of method A is higher than that of method B. The comparisons of the methods in the two above-mentioned groups are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S2 and S3</xref>, respectively. Our method outperforms Foldalign on 24 targets in the set TE80; while Foldalign outperforms our method on 9 targets.</p>
      <p>Given the diverse coverage of alignments from different methods, we integrated template information into FARFAR2, a fragment assembly-based approach for RNA structure prediction, to enhance the assessment of the generated alignments. Specifically, the structure of the aligned region from the top-scoring template, coupled with the query sequence and the secondary structure predicted by RNAfold (<xref rid="btae080-B19" ref-type="bibr">Lorenz <italic toggle="yes">et al.</italic> 2011</xref>), served as inputs for FARFAR2. If FARFAR2 fails to build models for a template, then the next-ranked template will be utilized, until a model is built successfully. <xref rid="btae080-T1" ref-type="table">Table 1</xref> displays the RMSD values and the count of optimal models (those with the lowest RMSD value) for the generated structural models using templates with &lt;40% sequence identity.</p>
      <table-wrap position="float" id="btae080-T1">
        <label>Table 1.</label>
        <caption>
          <p>RMSD and optimal model count (#) for FARFAR2 models using top-scoring templates with &lt;40% sequence identity.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1">Method</th>
              <th colspan="2" align="center" rowspan="1">All (80)<hr/></th>
              <th colspan="2" align="center" rowspan="1">Knotted (33)<hr/></th>
              <th colspan="2" rowspan="1">Nested (47)<hr/></th>
            </tr>
            <tr>
              <th align="center" rowspan="1" colspan="1">RMSD(Å)</th>
              <th rowspan="1" colspan="1">#</th>
              <th align="center" rowspan="1" colspan="1">RMSD(Å)</th>
              <th rowspan="1" colspan="1">#</th>
              <th rowspan="1" colspan="1">RMSD(Å)</th>
              <th rowspan="1" colspan="1">#</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">LOC</td>
              <td rowspan="1" colspan="1">29.1</td>
              <td rowspan="1" colspan="1">11</td>
              <td rowspan="1" colspan="1">32</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">27</td>
              <td rowspan="1" colspan="1">8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CAR</td>
              <td rowspan="1" colspan="1">29.3</td>
              <td rowspan="1" colspan="1">19</td>
              <td rowspan="1" colspan="1">32.9</td>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">26.8</td>
              <td rowspan="1" colspan="1">11</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MOU</td>
              <td rowspan="1" colspan="1">40.9</td>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">48.4</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">35.7</td>
              <td rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">FDA</td>
              <td rowspan="1" colspan="1">26.2</td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">30.4</td>
              <td rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">23.3</td>
              <td rowspan="1" colspan="1">9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RTH</td>
              <td rowspan="1" colspan="1">21.4</td>
              <td rowspan="1" colspan="1">30</td>
              <td rowspan="1" colspan="1">23.1</td>
              <td rowspan="1" colspan="1">12</td>
              <td rowspan="1" colspan="1">20.2</td>
              <td rowspan="1" colspan="1">18</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>“LOC,” “CAR,” “MOU,” “FDA,” and “RTH” represent the methods LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader, respectively.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Based on the data presented in <xref rid="btae080-T1" ref-type="table">Table 1</xref>, models generated with templates selected by RNAthreader exhibit the lowest average RMSD on the TE80 dataset, which is 18.3% lower than that of the next-best method, Foldalign. Additionally, the RNAthreader model outperforms all other compared methods by achieving the lowest RMSD among 30 targets, indicating its superior performance. We also compared the results with the original FARFAR2 model, which was generated solely using sequence and predicted secondary structure as inputs. The average RMSD (20.9 Å) of the original FARFAR2 model is slightly lower than that of RNAthreader. Despite this, when considering the number of best models, the original FARFAR2 method achieves the best performance on 18 targets, while RNAthreader performs best on 21 targets. The remaining four methods, namely LocARNA, CARNA, RNAmountAlign, and Foldalign, yield results of 8, 16, 4, and 13, respectively.</p>
      <p>We then divide the test set into two subsets, Knotted and Nested, to compare all methods further. The average RMSD for RNAthreader models is 24% lower than that of the second-best method Foldalign on the Knotted dataset, demonstrating the advantage of our method on RNAs with pseudoknots. Besides, within the Knotted subset, we further compute the average coverage of alignments on pseudoknotted base pairs. The results for LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader are 85.6%, 95.8%, 92.6%, 12.8%, and 18%, respectively.</p>
      <p>Finally, we assess the influence of skipping terminal gap penalties on RNAthreader’s performance. It turns out that omitting penalties for terminal gaps has a negligible impact on alignment coverage; however, it results in a noticeable improvement in the corresponding RMSD values. For instance, at the 40% threshold, the average alignment coverage remains nearly consistent, whether or not gap penalties are omitted (53.7% verus 53.5%). Nevertheless, the RMSD decreases from 17.6 Å to 15 Å when penalties for terminal gaps are skipped.</p>
    </sec>
    <sec>
      <title>3.3 Performance on the RNA-Puzzles targets</title>
      <p>We further test our method on the RNA-Puzzles targets. To simulate the situation of the RNA-Puzzles experiments, for targets in the PUZ30 dataset, we excluded all templates released after 1 January 2010. <xref rid="btae080-T2" ref-type="table">Table 2</xref> shows the alignment quality (RMSD and Coverage) on the aligned region and the RMSD of the full-length models. Given high alignment coverage, the full-length model is built by the homology modeling method, ModeRNA, with default parameters based on the top-scoring template. Similarly, if ModeRNA fails to build models for a target, the next template will be utilized until a model is successfully built.</p>
      <table-wrap position="float" id="btae080-T2">
        <label>Table 2.</label>
        <caption>
          <p>Performance of different methods on the RNA-Puzzles targets.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1">Method</th>
              <th colspan="2" align="center" rowspan="1">Aligned region<hr/></th>
              <th rowspan="1" colspan="1">Full-length model</th>
            </tr>
            <tr>
              <th align="center" rowspan="1" colspan="1">RMSD (Å)</th>
              <th rowspan="1" colspan="1">Coverage (%)</th>
              <th align="center" rowspan="1" colspan="1">RMSD (Å)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">LOC</td>
              <td rowspan="1" colspan="1">20.9</td>
              <td rowspan="1" colspan="1">96</td>
              <td rowspan="1" colspan="1">20.3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CAR</td>
              <td rowspan="1" colspan="1">19.4</td>
              <td rowspan="1" colspan="1">94.4</td>
              <td rowspan="1" colspan="1">21</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MOU</td>
              <td rowspan="1" colspan="1">23.9</td>
              <td rowspan="1" colspan="1">94.3</td>
              <td rowspan="1" colspan="1">25.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">FDA</td>
              <td rowspan="1" colspan="1">16.4</td>
              <td rowspan="1" colspan="1">75.1</td>
              <td rowspan="1" colspan="1">23.6</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RTH</td>
              <td rowspan="1" colspan="1">17.6</td>
              <td rowspan="1" colspan="1">81.2</td>
              <td rowspan="1" colspan="1">20.1</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>From <xref rid="btae080-T2" ref-type="table">Table 2</xref>, we find that besides LocARNA, CARNA, and RNAmountAlign maintaining over 90% coverage, Foldalign and RNAthreader also achieve relatively high alignment coverage. RMSDs for other methods increase for the full-length models, except for LocARNA, which has the highest coverage. Additionally, Foldalign shows the largest increase in RMSD with a rise of 44.1%.</p>
      <p>Even if the average coverage of RNAthreader is not the highest, the quality of the full-length models generated by ModeRNA with templates selected by RNAthreader is the best among all the methods. In <xref rid="btae080-F4" ref-type="fig">Fig. 4</xref>, we present an example target from RNA-Puzzles (Puzzle 23, PDB ID: 6E8U) that RNAthreader outperforms other methods. This particular example involves a <italic toggle="yes">mango-III aptamer</italic> (<xref rid="btae080-B37" ref-type="bibr">Trachman <italic toggle="yes">et al.</italic> 2019</xref>). For this target, the RMSDs of the full-length models built using alignments generated by LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader are 11.27, 12.53, 12.07, 15.8, and 6.38 Ås, respectively. The model of RNAthreader is significantly more accurate than that of other methods, whose template 2OE5_B_A is the combination of two chains of 2OE5, with a coverage of 81.1%. Indeed, according to the assessment results released on the RNA-Puzzles website, the best model in the competition is from the Das Lab, with an RMSD of 8.129 Å, which is slightly worse than our model.</p>
      <fig position="float" id="btae080-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Superimposition of the predicted models (in blue) against the native structure (in red) for an example RNA-Puzzles target Puzzle 23 (PDB ID: 6E8U).</p>
        </caption>
        <graphic xlink:href="btae080f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 Analysis of multiple sequence alignment</title>
      <p>Unlike conventional RNA alignment methods, RNAthreader utilizes sequence profiles calculated from MSA. As described above, we filter each MSA based on coverage and sequence identity. If more than 5 homologous sequences remain in the preprocessed MSA, then a sequence profile calculated by <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> will be utilized. After filtering, the sequence profile is used for 60 RNAs in the TE80 dataset when searching for templates. To study the impact of MSA utilization, we compare the performance of three different ways of using MSAs, i.e. not using MSAs (denoted by “noMSA”), using original MSAs generated by RNAcmap (denoted by “originMSA”), using filtered MSAs (denoted by “filterMSA”) on these 60 RNAs. The results after excluding templates with &gt;40% sequence identity are summarized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4A and B</xref> show the comparison in terms of the alignment quality. Compared with not using MSAs, the coverage of the alignment increases by 2.8% after the inclusion of origin MSAs. The average RMSD increases as well, illustrating that the contribution from the original MSA is less significant. However, when filtered MSA is utilized for the sequence profile calculation, the alignment quality improves, with an increase of 7.6% in average coverage and a decrease of 2.6% in RMSD. This demonstrates the importance of filtering MSA. <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4C</xref> shows the comparison in terms of the number of better alignments. With filtered MSA, RNAthreader generates more accurate alignments (higher coverage and lower RMSD) on more targets than not using MSA and using the original MSA. In particular, there are 15 RNAs on which the “filterMSA” has higher alignment quality than “noMSA,” while the latter does not have any alignments superior to the former.</p>
    </sec>
    <sec>
      <title>3.5 Analysis of the predicted secondary structure</title>
      <p>The accuracy of secondary structure prediction may have a direct impact on the performance of RNAthreader, as the predicted secondary structure is an essential component of the alignment progress.</p>
      <p>Note that among the compared methods, only two methods CARNA and RNAthreader, are capable of handling pseudoknots. Hence, we first aim to verify whether RNAthreader's performance is primarily influenced by improved secondary structure prediction. To this end, we utilize RNAfold (<xref rid="btae080-B19" ref-type="bibr">Lorenz <italic toggle="yes">et al.</italic> 2011</xref>), a minimum free energy (MFE) based approach, to predict secondary structure and then incorporate its output as input into RNAthreader. It turns out that after excluding homologous templates with &gt;40% sequence identity, RNAthreader produce alignments with an average RMSD of 16.2 Å and a coverage of 50.5% on the TE80 dataset. Additionally, the accuracy of predicted secondary structures, as assessed by the average interaction network fidelity (INF) (<xref rid="btae080-B24" ref-type="bibr">Parisien <italic toggle="yes">et al.</italic> 2009</xref>), is 0.71 for SPOT-RNA and 0.62 for RNAfold, respectively. The results show that as the quality of RNA secondary structure prediction decreases, the performance of RNAthreader indeed experiences a decline. However, it's noteworthy that RNAthreader consistently generates a larger quantity of superior alignments (with lower RMSD and higher coverage) compared to Foldalign, another method capable of detecting remote homologous templates. In fact, RNAthreader produces superior alignments to Foldalign on 16 RNAs, while Foldalign outperforms RNAthreader on 7 RNAs.</p>
      <p>Subsequently, we further explore how the quality of secondary structure affects the three-dimensional structural models. For the PUZ30 dataset, the Pearson’s correlation coefficient (PCC) between INFs of secondary structures predicted by SPOT-RNA and RMSDs of structure models is −0.622. <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref> shows the scatter plot between the INF and the RMSD, suggesting that the more accurate secondary structure predictions do lead to more accurate 3D structure models from threading.</p>
    </sec>
    <sec>
      <title>3.6 Running time analysis</title>
      <p>We compare the speed of different methods by collecting their running time of searching against the same template library. Given that some of the methods being compared are extremely time-consuming, we exclude redundant sequences from the original library at 99% sequence identity. Then the following experiment was performed on this non-redundant library with 4860 RNAs.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> show the running time of different methods on targets from the TE80 dataset. For better visualization, the longest RNA in this dataset (PDB ID: 5WZN_P) is excluded in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>. We can see from the figure that LocARNA has the highest growth rates in running time as the sequence length increases, followed by CARNA and Foldalign. In contrast, the speed of RNAmountAlign and our method RNAthreader do not have obvious changes. The average running time per RNA for LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader on the TE80 dataset is 42.3, 19.9, 8.6, 4.5, and 1.3 h, respectively. The high speed of our method compared with others is mostly due to the use of the simplified linear arc diagram.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>We have developed a novel RNA threading algorithm named RNAthreader using RNA secondary structure and sequence profile. It speeds up the alignment significantly with a reduced representation of RNA secondary structure and improves the alignment accuracy with the sequence profile. Benchmark tests show that RNAthreader outperforms other methods in terms of alignment accuracy and speed. Nevertheless, we admit that the models built from the RNAthreader templates are not perfect. This may be because of the limited size of the existing RNA template library. We anticipate RNAthreader could be improved further with the release of more experimental RNA structures in the future. Another promising way to improve is using the powerful deep learning algorithms.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae080_Supplementary_Data</label>
      <media xlink:href="btae080_supplementary_data.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Science and Technology Research Program of Chongqing Municipal Education Commission (Grant No. KJQN202300639) and the National Natural Science Foundation of China (NSFC T2225007 and T2222012).</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article are available at <ext-link xlink:href="https://yanglab.qd.sdu.edu.cn/RNAthreader/" ext-link-type="uri">https://yanglab.qd.sdu.edu.cn/RNAthreader/</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae080-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adamczyk</surname><given-names>B</given-names></string-name>, <string-name><surname>Antczak</surname><given-names>M</given-names></string-name>, <string-name><surname>Szachniuk</surname><given-names>M.</given-names></string-name></person-group><article-title>RNAsolo: a repository of cleaned PDB-derived RNA 3D structures</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>3668</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">35674373</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>, <string-name><surname>Madden</surname><given-names>TL</given-names></string-name>, <string-name><surname>Schäffer</surname><given-names>AA</given-names></string-name></person-group><etal>et al</etal><article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res.</source><year>1997</year>;<volume>25</volume>:<fpage>3389</fpage>–<lpage>402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Antczak</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>New functionality of RNAComposer: an application to shape the axis of miR160 precursor structure</article-title>. <source>Acta Biochim. Pol</source><year>2016</year>;<volume>63</volume>:<fpage>737</fpage>–<lpage>44</lpage>.<pub-id pub-id-type="pmid">27741327</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baek</surname><given-names>M</given-names></string-name>, <string-name><surname>DiMaio</surname><given-names>F</given-names></string-name>, <string-name><surname>Anishchenko</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>Accurate prediction of protein structures and interactions using a three-track neural network</article-title>. <source>Science</source><year>2021</year>;<volume>373</volume>:<fpage>871</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">34282049</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bauer</surname><given-names>M</given-names></string-name>, <string-name><surname>Klau</surname><given-names>GW</given-names></string-name>, <string-name><surname>Reinert</surname><given-names>K.</given-names></string-name></person-group><article-title>Accurate multiple sequence-structure alignment of RNA sequences using combinatorial optimization</article-title>. <source>BMC Bioinform</source><year>2007</year>;<volume>8</volume>:<fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bayegan</surname><given-names>AH</given-names></string-name>, <string-name><surname>Clote</surname><given-names>P.</given-names></string-name></person-group><article-title>RNAmountAlign: efficient software for local, global, semiglobal pairwise and multiple RNA sequence/structure alignment</article-title>. <source>PLoS One</source><year>2020</year>;<volume>15</volume>:<fpage>e0227177</fpage>.<pub-id pub-id-type="pmid">31978147</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berman</surname><given-names>HM</given-names></string-name>, <string-name><surname>Westbrook</surname><given-names>J</given-names></string-name>, <string-name><surname>Feng</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>The protein data bank</article-title>. <source>Nucleic Acids Res.</source><year>2000</year>;<volume>28</volume>:<fpage>235</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">10592235</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Das</surname><given-names>R</given-names></string-name>, <string-name><surname>Baker</surname><given-names>D.</given-names></string-name></person-group><article-title>Automated de novo prediction of native-like RNA tertiary structures</article-title>. <source>Proc Natl Acad Sci U S A</source><year>2007</year>;<volume>104</volume>:<fpage>14664</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">17726102</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dowell</surname><given-names>RD</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR.</given-names></string-name></person-group><article-title>Efficient pairwise RNA structure prediction and alignment using sequence alignment constraints</article-title>. <source>BMC Bioinform</source><year>2006</year>;<volume>7</volume>:<fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Havgaard</surname><given-names>JH</given-names></string-name>, <string-name><surname>Gorodkin</surname><given-names>J.</given-names></string-name></person-group><article-title>RNA structural alignments, part I: sankoff-based approaches for structural alignments</article-title>. <source>Methods Mol Biol</source><year>2014</year>;<volume>1097</volume>:<fpage>275</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">24639164</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Havgaard</surname><given-names>JH</given-names></string-name>, <string-name><surname>Torarinsson</surname><given-names>E</given-names></string-name>, <string-name><surname>Gorodkin</surname><given-names>J.</given-names></string-name></person-group><article-title>Fast pairwise structural RNA alignments by pruning of the dynamical programming matrix</article-title>. <source>PLoS Comput. Biol.</source><year>2007</year>;<volume>3</volume>:<fpage>1896</fpage>–<lpage>908</lpage>.<pub-id pub-id-type="pmid">17937495</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hofacker</surname><given-names>IL</given-names></string-name>, <string-name><surname>Bernhart</surname><given-names>SH</given-names></string-name>, <string-name><surname>Stadler</surname><given-names>PF.</given-names></string-name></person-group><article-title>Alignment of RNA base pairing probability matrices</article-title>. <source>Bioinformatics</source><year>2004</year>;<volume>20</volume>:<fpage>2222</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">15073017</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hogeweg</surname><given-names>P</given-names></string-name>, <string-name><surname>Hesper</surname><given-names>B.</given-names></string-name></person-group><article-title>Energy directed folding of RNA sequences</article-title>. <source>Nucleic Acids Res.</source><year>1984</year>;<volume>12</volume>:<fpage>67</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">6198625</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jumper</surname><given-names>J</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source><year>2021</year>;<volume>596</volume>:<fpage>583</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Khor</surname><given-names>BY</given-names></string-name>, <string-name><surname>Tye</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Lim</surname><given-names>TS</given-names></string-name></person-group><etal>et al</etal><article-title>General overview on structure prediction of twilight-zone proteins</article-title>. <source>Theor. Biol. Med. Model.</source><year>2015</year>;<volume>12</volume>:<fpage>15</fpage>–<lpage>1</lpage>.<pub-id pub-id-type="pmid">26338054</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klein</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR.</given-names></string-name></person-group><article-title>RSEARCH: finding homologs of single structured RNA sequences</article-title>. <source>BMC Bioinform</source><year>2003</year>;<volume>4</volume>:<fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krokhotin</surname><given-names>A</given-names></string-name>, <string-name><surname>Houlihan</surname><given-names>K</given-names></string-name>, <string-name><surname>Dokholyan</surname><given-names>NV.</given-names></string-name></person-group><article-title>iFoldRNA v2: folding RNA with constraints</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>2891</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">25910700</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kryshtafovych</surname><given-names>A</given-names></string-name>, <string-name><surname>Schwede</surname><given-names>T</given-names></string-name>, <string-name><surname>Topf</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Critical assessment of methods of protein structure prediction (CASP)—round XIV</article-title>. <source>Proteins: Struct., Funct., Bioinf.</source><year>2021</year>;<volume>89</volume>:<fpage>1607</fpage>–<lpage>17</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lorenz</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>ViennaRNA package 2.0</article-title>. <source>Algorithms Mol. Biol</source><year>2011</year>;<volume>6</volume>:<fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">21235792</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Magnus</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>RNA-Puzzles toolkit: a computational resource of RNA 3D structure benchmark datasets, structure manipulation, and evaluation tools</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>48</volume>:<fpage>576</fpage>–<lpage>88</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mathews</surname><given-names>DH</given-names></string-name>, <string-name><surname>Turner</surname><given-names>DH.</given-names></string-name></person-group><article-title>Dynalign: an algorithm for finding the secondary structure common to two RNA sequences</article-title>. <source>J. Mol. Biol.</source><year>2002</year>;<volume>317</volume>:<fpage>191</fpage>–<lpage>203</lpage>.<pub-id pub-id-type="pmid">11902836</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nawrocki</surname><given-names>EP</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR.</given-names></string-name></person-group><article-title>Infernal 1.1: 100-fold faster RNA homology searches</article-title>. <source>Bioinformatics</source><year>2013</year>;<volume>29</volume>:<fpage>2933</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">24008419</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Needleman</surname><given-names>SB</given-names></string-name>, <string-name><surname>Wunsch</surname><given-names>CD.</given-names></string-name></person-group><article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>. <source>J Mol. Biol.</source><year>1970</year>;<volume>48</volume>:<fpage>443</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">5420325</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parisien</surname><given-names>M</given-names></string-name>, <string-name><surname>Cruz</surname><given-names>JA</given-names></string-name>, <string-name><surname>Westhof</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>New metrics for comparing and assessing discrepancies between RNA 3D structures and models</article-title>. <source>RNA</source><year>2009</year>;<volume>15</volume>:<fpage>1875</fpage>–<lpage>85</lpage>.<pub-id pub-id-type="pmid">19710185</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parisien</surname><given-names>M</given-names></string-name>, <string-name><surname>Major</surname><given-names>F.</given-names></string-name></person-group><article-title>The MC-Fold and MC-Sym pipeline infers RNA structure from sequence data</article-title>. <source>Nature</source><year>2008</year>;<volume>452</volume>:<fpage>51</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">18322526</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Han</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Protein structure prediction in the deep learning era</article-title>. <source>Curr. Opin. Struct. Biol.</source><year>2022</year>;<volume>77</volume>:<fpage>102495</fpage>.<pub-id pub-id-type="pmid">36371845</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peselis</surname><given-names>A</given-names></string-name>, <string-name><surname>Serganov</surname><given-names>A.</given-names></string-name></person-group><article-title>Structure and function of pseudoknots involved in gene expression control</article-title>. <source>Wiley Interdiscip Rev RNA</source><year>2014</year>;<volume>5</volume>:<fpage>803</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">25044223</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Popenda</surname><given-names>M</given-names></string-name>, <string-name><surname>Szachniuk</surname><given-names>M</given-names></string-name>, <string-name><surname>Antczak</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Automated 3D structure composition for large RNAs</article-title>. <source>Nucleic Acids Res.</source><year>2012</year>;<volume>40</volume>:<fpage>e112</fpage>-<lpage>e112</lpage>.<pub-id pub-id-type="pmid">22539264</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rother</surname><given-names>M</given-names></string-name>, <string-name><surname>Rother</surname><given-names>K</given-names></string-name>, <string-name><surname>Puton</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>ModeRNA: a tool for comparative modeling of RNA 3D structure</article-title>. <source>Nucleic Acids Res.</source><year>2011</year>;<volume>39</volume>:<fpage>4007</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">21300639</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sankoff</surname><given-names>D.</given-names></string-name></person-group><article-title>Simultaneous solution of the RNA folding, alignment and protosequence problems</article-title>. <source>SIAM J. Appl. Math.</source><year>1985</year>;<volume>45</volume>:<fpage>810</fpage>–<lpage>25</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Singh</surname><given-names>J</given-names></string-name>, <string-name><surname>Hanson</surname><given-names>J</given-names></string-name>, <string-name><surname>Paliwal</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>RNA secondary structure prediction using an ensemble of two-dimensional deep neural networks and transfer learning</article-title>. <source>Nat. Commun.</source><year>2019</year>;<volume>10</volume>:<fpage>5407</fpage>.<pub-id pub-id-type="pmid">31776342</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sorescu</surname><given-names>DA</given-names></string-name>, <string-name><surname>Möhl</surname><given-names>M</given-names></string-name>, <string-name><surname>Mann</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>CARNA—alignment of RNA structure ensembles</article-title>. <source>Nucleic Acids Res.</source><year>2012</year>;<volume>40</volume>:<fpage>W49</fpage>–<lpage>W53</lpage>.<pub-id pub-id-type="pmid">22689637</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>HH-suite3 for fast remote homology detection and deep protein annotation</article-title>. <source>BMC Bioinform</source><year>2019</year>;<volume>20</volume>:<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Peng</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>RNA inter-nucleotide 3D closeness prediction by deep residual neural networks</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>37</volume>:<fpage>1093</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Wu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Peng</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Enhanced prediction of RNA solvent accessibility with long short-term memory neural networks and improved sequence profiles</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>35</volume>:<fpage>1686</fpage>–<lpage>91</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sundfeld</surname><given-names>D</given-names></string-name>, <string-name><surname>Havgaard</surname><given-names>JH</given-names></string-name>, <string-name><surname>de Melo</surname><given-names>ACMA</given-names></string-name></person-group><etal>et al</etal><article-title>Foldalign 2.5: multithreaded implementation for pairwise structural RNA alignment</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>32</volume>:<fpage>1238</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">26704597</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trachman</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Autour</surname><given-names>A</given-names></string-name>, <string-name><surname>Jeng</surname><given-names>SCY</given-names></string-name></person-group><etal>et al</etal><article-title>Structure and functional reselection of the Mango-III fluorogenic RNA aptamer</article-title>. <source>Nat. Chem. Biol.</source><year>2019</year>;<volume>15</volume>:<fpage>472</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">30992561</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Feng</surname><given-names>C</given-names></string-name>, <string-name><surname>Han</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>trRosettaRNA: automated prediction of RNA 3D structure with transformer network</article-title>. <source>Nat. Commun.</source><year>2023</year>;<volume>14</volume>:<fpage>7266</fpage>.<pub-id pub-id-type="pmid">37945552</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Watkins</surname><given-names>AM</given-names></string-name>, <string-name><surname>Rangan</surname><given-names>R</given-names></string-name>, <string-name><surname>Das</surname><given-names>R.</given-names></string-name></person-group><article-title>FARFAR2: improved De novo rosetta prediction of complex global RNA folds</article-title>. <source>Structure</source><year>2020</year>;<volume>28</volume>:<fpage>963</fpage>–<lpage>76.e6</lpage>.<pub-id pub-id-type="pmid">32531203</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Will</surname><given-names>S</given-names></string-name>, <string-name><surname>Reiche</surname><given-names>K</given-names></string-name>, <string-name><surname>Hofacker</surname><given-names>IL</given-names></string-name></person-group><etal>et al</etal><article-title>Inferring noncoding rna families and classes by means of genome-scale structure-based clustering</article-title>. <source>PLoS Comput. Biol.</source><year>2007</year>;<volume>3</volume>:<fpage>e65</fpage>.<pub-id pub-id-type="pmid">17432929</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>H</given-names></string-name>, <string-name><surname>Jossinet</surname><given-names>F</given-names></string-name>, <string-name><surname>Leontis</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>Tools for the automatic identification and classification of RNA base pairs</article-title>. <source>Nucleic Acids Res.</source><year>2003</year>;<volume>31</volume>:<fpage>3450</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">12824344</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>T</given-names></string-name>, <string-name><surname>Singh</surname><given-names>J</given-names></string-name>, <string-name><surname>Litfin</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>RNAcmap: a fully automatic pipeline for predicting contact maps of RNAs by evolutionary coupling analysis</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>3494</fpage>–<lpage>500</lpage>.<pub-id pub-id-type="pmid">34021744</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Xiao</surname><given-names>Y.</given-names></string-name></person-group><article-title>3dRNA: 3D structure prediction from linear to circular RNAs</article-title>. <source>J. Mol. Biol.</source><year>2022</year>;<volume>434</volume>:<fpage>167452</fpage>.<pub-id pub-id-type="pmid">35662453</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>C</given-names></string-name>, <string-name><surname>Xu</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S-J.</given-names></string-name></person-group><article-title>Predicting RNA structure with vfold</article-title>. <source>Methods Mol Biol</source><year>2017</year>;<volume>1654</volume>:<fpage>3</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">28986779</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Huang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Gong</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Automated and fast building of three-dimensional RNA structures</article-title>. <source>Sci Rep</source><year>2012</year>;<volume>2</volume>:<fpage>734</fpage>.<pub-id pub-id-type="pmid">23071898</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10893584</article-id>
    <article-id pub-id-type="pmid">38341662</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btae080</article-id>
    <article-id pub-id-type="publisher-id">btae080</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RNA threading with secondary structure and sequence profile</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Zongyang</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation" degree-contribution="equal">Data curation</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="equal">Software</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>Chongqing Key Laboratory of Big Data for Bio Intelligence, Chongqing University of Posts and Telecommunications</institution>, Chongqing 400065, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0303-6693</contrib-id>
        <name>
          <surname>Peng</surname>
          <given-names>Zhenling</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>MOE Frontiers Science Center for Nonlinear Expectations, Research Center for Mathematics and Interdisciplinary Sciences, Shandong University</institution>, Qingdao 266237, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2912-7737</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Jianyi</given-names>
        </name>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Formal analysis" vocab-term-identifier="https://credit.niso.org/contributor-roles/formal-analysis" degree-contribution="equal">Formal analysis</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Project administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration" degree-contribution="equal">Project administration</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="equal">Supervision</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role>
        <role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &amp; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &amp; editing</role>
        <aff><institution>MOE Frontiers Science Center for Nonlinear Expectations, Research Center for Mathematics and Interdisciplinary Sciences, Shandong University</institution>, Qingdao 266237, <country country="CN">China</country></aff>
        <xref rid="btae080-cor1" ref-type="corresp"/>
        <!--yangjy@sdu.edu.cn-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cowen</surname>
          <given-names>Lenore</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btae080-cor1">Corresponding author. MOE Frontiers Science Center for Nonlinear Expectations, Research Center for Mathematics and Interdisciplinary Sciences, Shandong University, Qingdao 266237, China. E-mail: <email>yangjy@sdu.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2024-02-10">
      <day>10</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>2</month>
      <year>2024</year>
    </pub-date>
    <volume>40</volume>
    <issue>2</issue>
    <elocation-id>btae080</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>05</day>
        <month>1</month>
        <year>2024</year>
      </date>
      <date date-type="editorial-decision">
        <day>01</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>2</month>
        <year>2024</year>
      </date>
      <date date-type="corrected-typeset">
        <day>23</day>
        <month>2</month>
        <year>2024</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2024. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2024</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btae080.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>RNA threading aims to identify remote homologies for template-based modeling of RNA 3D structure. Existing RNA alignment methods primarily rely on secondary structure alignment. They are often time- and memory-consuming, limiting large-scale applications. In addition, the accuracy is far from satisfactory.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Using RNA secondary structure and sequence profile, we developed a novel RNA threading algorithm, named RNAthreader. To enhance the alignment process and minimize memory usage, a novel approach has been introduced to simplify RNA secondary structures into compact diagrams. RNAthreader employs a two-step methodology. Initially, integer programming and dynamic programming are combined to create an initial alignment for the simplified diagram. Subsequently, the final alignment is obtained using dynamic programming, taking into account the initial alignment derived from the previous step. The benchmark test on 80 RNAs illustrates that RNAthreader generates more accurate alignments than other methods, especially for RNAs with pseudoknots. Another benchmark, involving 30 RNAs from the RNA-Puzzles experiments, exhibits that the models constructed using RNAthreader templates have a lower average RMSD than those created by alternative methods. Remarkably, RNAthreader takes less than two hours to complete alignments with ∼5000 RNAs, which is 3–40 times faster than other methods. These compelling results suggest that RNAthreader is a promising algorithm for RNA template detection.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>
          <ext-link xlink:href="https://yanglab.qd.sdu.edu.cn/RNAthreader" ext-link-type="uri">https://yanglab.qd.sdu.edu.cn/RNAthreader</ext-link>
        </p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Science and Technology Research Program</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>NSFC T2225007</award-id>
        <award-id>T2222012</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The 14th community-wide experiment on the critical assessment of techniques for protein structure prediction (CASP14) (<xref rid="btae080-B18" ref-type="bibr">Kryshtafovych <italic toggle="yes">et al.</italic> 2021</xref>) has witnessed great progress in protein structure prediction. With powerful deep learning techniques (<xref rid="btae080-B4" ref-type="bibr">Baek <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btae080-B14" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic> 2021</xref>), the structure prediction problem for single-domain proteins has been nearly solved (<xref rid="btae080-B26" ref-type="bibr">Peng <italic toggle="yes">et al.</italic> 2022</xref>). However, structure prediction for RNAs with deep learning remains challenging, due to the complexity of RNA molecules and the lack of enough experimentally solved structures (<xref rid="btae080-B38" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2023</xref>). The RNA structure prediction methods can be broadly grouped into two categories: <italic toggle="yes">ab initio</italic> modeling and template-based modeling (TBM).</p>
    <p>There are two major types of <italic toggle="yes">ab initio</italic> modeling methods. The first one is based on molecular dynamics simulation, such as Vfold3D (<xref rid="btae080-B44" ref-type="bibr">Zhao <italic toggle="yes">et al.</italic> 2017</xref>) and iFoldRNA (<xref rid="btae080-B17" ref-type="bibr">Krokhotin <italic toggle="yes">et al.</italic> 2015</xref>). The second one is based on fragment assembly, such as FARFAR (<xref rid="btae080-B8" ref-type="bibr">Das and Baker 2007</xref>), FARFAR2 (<xref rid="btae080-B39" ref-type="bibr">Watkins <italic toggle="yes">et al.</italic> 2020</xref>), RNAComposer (<xref rid="btae080-B28" ref-type="bibr">Popenda <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btae080-B3" ref-type="bibr">Antczak <italic toggle="yes">et al.</italic> 2016</xref>), 3dRNA (<xref rid="btae080-B45" ref-type="bibr">Zhao <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="btae080-B43" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2022</xref>), and MC-Fold/MC-Sym (<xref rid="btae080-B25" ref-type="bibr">Parisien and Major 2008</xref>). These methods can be further grouped into full-atom simulation or coarse-grained simulation. The former performs a simulation of all atoms in a single round, which works well on short RNAs; while its great demand for computing resources prevents the application in structure prediction for large RNAs. The latter addresses this issue by merging certain atoms into so-called coarse-grained particles; while the ability to add atom-level details needs to be further strengthened.</p>
    <p>TBM methods build the structure model for a query RNA using homologous templates in PDB (<xref rid="btae080-B7" ref-type="bibr">Berman <italic toggle="yes">et al.</italic> 2000</xref>). Accurate query-template alignment plays a key role in TBM methods. The alignment is usually conducted based on the secondary structure. However, RNA secondary structure is formed by base pairs (2D map), making the RNA alignment much more difficult than protein (1D sequence).</p>
    <p>Sankoff proposed an algorithm to compute the alignment and the common secondary structure of two RNA sequences simultaneously, based on dynamic programming for free energy minimization (<xref rid="btae080-B30" ref-type="bibr">Sankoff 1985</xref>). This algorithm requires <italic toggle="yes">O</italic>(<italic toggle="yes">n<sup>6</sup></italic>) time and <italic toggle="yes">O</italic>(<italic toggle="yes">n<sup>4</sup></italic>) memory (<italic toggle="yes">n</italic> is the length of RNAs to be aligned), which grow very fast when the sequence length increases. This issue limits its real-world applications.</p>
    <p>To address the above issue, several algorithms were proposed, which are referred to as Sankoff-style algorithms. There are three main types of Sankoff-style algorithms (<xref rid="btae080-B10" ref-type="bibr">Havgaard and Gorodkin 2014</xref>). The first is based on energy minimization, which is most similar to the original Sankoff algorithm, with representative methods such as Foldalign (<xref rid="btae080-B11" ref-type="bibr">Havgaard <italic toggle="yes">et al.</italic> 2007</xref>) and Dynalign (<xref rid="btae080-B21" ref-type="bibr">Mathews and Turner 2002</xref>). Methods of the second type are based on the alignment of base-pairing probability matrix, such as PMcomp (<xref rid="btae080-B12" ref-type="bibr">Hofacker <italic toggle="yes">et al.</italic> 2004</xref>) and LocARNA (<xref rid="btae080-B40" ref-type="bibr">Will <italic toggle="yes">et al.</italic> 2007</xref>). The third type of method uses statistical models based on stochastic context-free grammars (SCFG), such as Consan (<xref rid="btae080-B9" ref-type="bibr">Dowell and Eddy 2006</xref>) and RSEARCH (<xref rid="btae080-B16" ref-type="bibr">Klein and Eddy 2003</xref>). Some of these methods use different heuristic strategies to reduce time and memory consumption. For instance, Foldalign filters subalignments by setting length-related cutoffs, and LocARNA simplifies the base paring probability matrix by ignoring elements below a certain threshold.</p>
    <p>There are some non-Sankoff-style algorithms for RNA alignment. For example, RNAmountAlign (<xref rid="btae080-B6" ref-type="bibr">Bayegan and Clote 2020</xref>) aligns two RNAs with Needleman-Wunsch dynamic programming (NWDP) (<xref rid="btae080-B23" ref-type="bibr">Needleman and Wunsch 1970</xref>) based on the mountain height (<xref rid="btae080-B13" ref-type="bibr">Hogeweg and Hesper 1984</xref>) of their secondary structures, and LARA (<xref rid="btae080-B5" ref-type="bibr">Bauer <italic toggle="yes">et al.</italic> 2007</xref>) is a graph-based method which solves the alignment problem by integer linear programming.</p>
    <p>In this work, we developed a new RNA threading algorithm named RNAthreader. It is built on simplified secondary structure diagrams and sequence profiles from multiple sequence alignments. Benchmark tests show the advantage of RNAthreader over other methods in terms of both accuracy and speed.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Template library</title>
      <p>We retrieve experimentally determined 3D RNA structures from the RNAsolo database (<xref rid="btae080-B1" ref-type="bibr">Adamczyk <italic toggle="yes">et al.</italic> 2022</xref>) and use them to construct a template library comprising two distinct components: single-chain and multi-chain RNAs. The single-chain component encompasses all available single-chain RNA structures. Since base pairing between different chains is common, it is necessary to consider connecting different chains that form base pairs. To this end, we utilize RNAView (<xref rid="btae080-B41" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2003</xref>) for secondary structure annotation, with the assembly structure as input. Specifically, for two chains denoted as A and B, if the number of base pairs between them exceeds 20% of the length of A or B, the combinations A_B and B_A will be added as new templates. In cases where a chain forms base pairs with multiple chains, we will include the additional chain that shares the largest number of base pairs with it. Consequently, each template in our library contains a maximum of three chains. Following this procedure, we successfully curate a template library comprising 18,195 RNAs. The library files are available for download at: <ext-link xlink:href="https://yanglab.qd.sdu.edu.cn/RNAthreader" ext-link-type="uri">https://yanglab.qd.sdu.edu.cn/RNAthreader</ext-link>.</p>
    </sec>
    <sec>
      <title>2.2 Training and test datasets</title>
      <p>Three datasets were used for training and testing. The training set, TR221, and the first test set, TE80, are obtained from our previous work RNAContact (<xref rid="btae080-B34" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> 2020</xref>). TR221 consists of 221 RNAs, and TE80 comprises 80 RNAs, with sequence lengths spanning 32 to 1,000 nucleotides. RNAs from these two datasets share less than 30% sequence identity. Based on the presence or absence of pseudoknots, we further divided the TE80 dataset into two subsets: Knotted and Nested. Here a pseudoknot is a bipartite helical structure formed by base pairing of the apical loop in the stem-loop structure with an outside sequence (<xref rid="btae080-B27" ref-type="bibr">Peselis and Serganov 2014</xref>). The second test set (denoted by PUZ30) includes 30 RNAs from RNA-Puzzles (<xref rid="btae080-B20" ref-type="bibr">Magnus <italic toggle="yes">et al.</italic> 2019</xref>). Note that Puzzle 10, Puzzle 26, Puzzle 27, and Puzzle 28 are T-box riboswitch—tRNA complexes. For these targets, we only select T-box riboswitches for structure prediction. Besides, Puzzle 14 is an <italic toggle="yes">L-glutamine riboswitch</italic> with Bound and Free forms, which are treated as two different targets. More details about the PUZ30 dataset are given in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>.</p>
    </sec>
    <sec>
      <title>2.3 Algorithm inputs</title>
      <sec>
        <title>2.3.1 Sequence profile</title>
        <p>The multiple sequence alignment (MSA) for each query RNA was generated with RNAcmap (<xref rid="btae080-B42" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2021</xref>). The RNAcmap method begins with an initial homolog search using BLAST-N (<xref rid="btae080-B2" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1997</xref>) against the NCBI nucleotide database. The returned homologs and the secondary structure predicted by SPOT-RNA (<xref rid="btae080-B31" ref-type="bibr">Singh <italic toggle="yes">et al.</italic> 2019</xref>) are then utilized to build a covariance model. In the end, an MSA is generated by the second round of homolog search using INFERNAL (<xref rid="btae080-B22" ref-type="bibr">Nawrocki and Eddy 2013</xref>). Given that the MSA may contain redundant sequences, we use HHfilter (<xref rid="btae080-B33" ref-type="bibr">Steinegger <italic toggle="yes">et al.</italic> 2019</xref>) to remove sequences sharing &gt;80% sequence identity or &lt;75% coverage with the query sequence. If the number of remaining homologs in the MSA is less than 5, we will not use sequence profiles in the following steps. Otherwise, we compute the sequence profile in a manner similar to that employed in PSI-BLAST (<xref rid="btae080-B2" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic> 1997</xref>):
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>0.4</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">q<sub>i</sub></italic> is the nucleotide type for the <italic toggle="yes">i</italic>th position of the query RNA, <italic toggle="yes">d</italic>(<italic toggle="yes">q<sub>i</sub></italic>) is the number of nucleotide types different from <italic toggle="yes">q<sub>i</sub></italic> in the <italic toggle="yes">i</italic>th column of the MSA, <italic toggle="yes">f</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">k</italic>) is the observed frequency of the <italic toggle="yes">k</italic>th nucleotide in the <italic toggle="yes">i</italic>th column of the MSA, <italic toggle="yes">p</italic>(<italic toggle="yes">q<sub>i</sub></italic>) is the background probability of <italic toggle="yes">q<sub>i</sub></italic>, estimated from the NCBI nucleotide database (<italic toggle="yes">p</italic>(A) = 0.27, <italic toggle="yes">p</italic>(U) = 0.27, <italic toggle="yes">p</italic>(G) = 0.23, <italic toggle="yes">p</italic>(C) = 0.23) (<xref rid="btae080-B35" ref-type="bibr">Sun <italic toggle="yes">et al.</italic> 2018</xref>), and <italic toggle="yes">R<sub>s</sub></italic> refers to the RIBOSUM single nucleotide matrix (<xref rid="btae080-B16" ref-type="bibr">Klein and Eddy 2003</xref>). Note that this profile automatically takes a balance between the MSA and the RIBOSUM matrix. The sequence profile largely depends on the MSA when it contains a large number of homologous sequences; while it resembles the RIBOSUM matrix when the MSA is shallow.</p>
        <p>For RNAs in the template library, we also tried using BLAST-N for homologous sequence detection. However, many templates could not find any sequence homologs. To ensure the consistency of alignment scores, we did not use the sequence profile for templates. Thus, the query-template alignment will be performed in the profile-sequence or sequence-sequence manner in the following steps.</p>
      </sec>
      <sec>
        <title>2.3.2 Secondary structure</title>
        <p>For the query RNA, we use the deep learning algorithm SPOT-RNA to predict its secondary structure. For RNAs in the template library, their secondary structures are extracted from native structures using RNAView. RNA secondary structure is usually represented as a planar graph (see <xref rid="btae080-F2" ref-type="fig">Fig. 2A</xref> for an example).</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Alignment algorithm</title>
      <sec>
        <title>2.4.1 Workflow of the alignment algorithm</title>
        <p>The flowchart of RNAthreader is presented in <xref rid="btae080-F1" ref-type="fig">Fig. 1</xref>. It consists of two main steps. First, it extracts all the nucleotides forming base pairs and performs their alignments. Second, it generates the final alignment based on the sequence profile and the secondary structure alignment result.</p>
        <fig position="float" id="btae080-F1">
          <label>Figure 1.</label>
          <caption>
            <p>Flowchart of RNAthreader. Here “SS” stands for secondary structure, “IP” is integer programming, and “NWDP” denotes Needleman-Wunsch dynamic programming.</p>
          </caption>
          <graphic xlink:href="btae080f1" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>2.4.2 Alignment of simplified secondary diagrams</title>
        <p>The secondary structure of each RNA is converted into a linear arc diagram (<xref rid="btae080-F2" ref-type="fig">Fig. 2B</xref>) for alignment. In the linear arc diagram, the vertices denote nucleotides and those connected by edges represent base pairs. With the graphical representation, the problem of finding the best alignment can be transformed into an integer programming problem with specified constraints (<xref rid="btae080-B5" ref-type="bibr">Bauer <italic toggle="yes">et al.</italic> 2007</xref>). However, the amount of constraints and variables in the integer programming problem grows rapidly with the increase of sequence lengths.</p>
        <fig position="float" id="btae080-F2">
          <label>Figure 2.</label>
          <caption>
            <p>Secondary structure diagrams for an example RNA. (A) Planar graph with base pairs indicated by colored and connected vertices. (B) Linear arc diagram. (C) Simplified linear arc diagram.</p>
          </caption>
          <graphic xlink:href="btae080f2" position="float"/>
        </fig>
        <p>To address this issue, we simplify the linear arc diagram of RNA secondary structure as follows. First, only nucleotides forming base pairs are kept. Yet for RNAs with a large proportion of base pairs, this simplification only has a limited effect. Thus, we further define the concept of <italic toggle="yes">substructures</italic>. A substructure is a fragment consisting of consecutive base pairs, which allows the existence of bulge and interior loops (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref> for examples). As illustrated in <xref rid="btae080-F2" ref-type="fig">Fig. 2A</xref>, the five colored fragments correspond to five different substructures. Second, we merge base pairs in the same substructure and get the final simplified diagram as shown in <xref rid="btae080-F2" ref-type="fig">Fig. 2C</xref>. With the above procedures, the original diagram is significantly simplified and the relative positions of substructures are retained.</p>
        <p>Initial alignment is then conducted on the simplified diagram. The alignment between two simplified diagrams is based on integer programming to maximize the following objective function.
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>q</mml:mi></mml:msubsup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">V<sub>q</sub></italic>/<italic toggle="yes">V<sub>t</sub></italic> is the set of the substructures in the simplified diagram of the query/template; the substructure <italic toggle="yes">Sq i</italic> is denoted as a two-element tuple (<italic toggle="yes">Sq i, 1</italic>, <italic toggle="yes">Sq i, 2</italic>), in which <italic toggle="yes">Sq i, 1</italic> and <italic toggle="yes">Sq i, 2</italic> are the two paired halves; δ(<italic toggle="yes">x</italic>, <italic toggle="yes">y</italic>) equals to 1 if <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> are aligned, and 0 otherwise; <italic toggle="yes">ω<sub>ij</sub></italic> is the matching score between substructures <italic toggle="yes">Sq i</italic> and <italic toggle="yes">St j</italic>, which is determined based on the NWDP (introduced in the next section). The objective function is subjective to two constraints to generate meaningful alignment: (1) there is no cross-alignment. In other words, once regions <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> are aligned, alignment cannot occur between the regions before <italic toggle="yes">x</italic> and the regions after <italic toggle="yes">y</italic> (or vice versa); (2) each vertex in a graph can be aligned to at most one vertex in another graph.</p>
        <p>After solving the above integer programming problem, the alignment between two simplified secondary diagrams is obtained. It is used in the next step to generate nucleotide-level alignment with NWDP.</p>
      </sec>
      <sec>
        <title>2.4.3 Alignment of substructures with NWDP</title>
        <p>The matching score and alignment between two substructures are obtained based on NWDP. Given that substructures only contain nucleotides forming base pairs, we design a <italic toggle="yes">partial</italic> alignment strategy, which only aligns half of the substructures. The alignment of the other half is completed automatically based on their base-pairing relationships. The scoring function for the partial alignment in NWDP is calculated as follows.
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo> + </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eff</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo> + </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo> + </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eff</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>E</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>≠</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mtext>stem</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mtext>stem</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where (<italic toggle="yes">m<sub>1</sub></italic>, <italic toggle="yes">m<sub>2</sub></italic>)/(<italic toggle="yes">n<sub>1</sub></italic>, <italic toggle="yes">n<sub>2</sub></italic>) is a base pair in a substructure of the query/template; <italic toggle="yes">q<sub>i</sub></italic> is the type of the <italic toggle="yes">i</italic>th nucleotide in the query, <italic toggle="yes">t<sub>k</sub></italic> is the type of the <italic toggle="yes">k</italic>th nucleotide in the template; <italic toggle="yes">R<sub>P</sub></italic> refers to the RIBOSUM base-pairing matrix; <italic toggle="yes">F<sub>q</sub></italic> is defined by <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>; <italic toggle="yes">N<sub>eff</sub></italic> is the number of effective sequences in MSA, which equals to the number of remaining sequences in MSA after filtering; <italic toggle="yes">s<sub>E</sub></italic> reflects the similarity of the base pairs in the local environment (<xref rid="E4" ref-type="disp-formula">Equation (4)</xref>). To define the local environment for a base pair (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>), we first cut the whole diagram into two subgraphs at the edge (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>). The environment for the base pair (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) in query is then defined as the smallest closed loop which starts at <italic toggle="yes">i</italic> and ends at <italic toggle="yes">j</italic> in each subgraph<italic toggle="yes">.</italic> Finally, the environment’s secondary structure type (stem, hairpin, bulge, interior loop, multi-loop, or pseudoknot, see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>) makes the two-element tuple <italic toggle="yes">E<sub>q</sub></italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) in <xref rid="E4" ref-type="disp-formula">Equation (4)</xref>.</p>
        <p>If the sequence profile of the query RNA is not utilized, the gap open penalty is 3 and the gap extension penalty is 1. Otherwise, gap penalties will be adjusted according to the ratio of gaps in each column of the MSA, i.e. the higher the ratio of gaps is, the lower the gap penalty will be.</p>
      </sec>
      <sec>
        <title>2.4.4 Final alignment</title>
        <p>From Section 2.4.2, we obtain the alignment between two simplified secondary diagrams. The nucleotide-level alignment between aligned substructures is the NWDP result described in Section 2.4.3. The final alignment between the query and each template is performed by NWDP with the following scoring function.
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">aln</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eff</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">aln</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">eff</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where the definitions of <italic toggle="yes">q<sub>i</sub></italic>, <italic toggle="yes">t<sub>j</sub></italic>, <italic toggle="yes">R<sub>s</sub></italic>, <italic toggle="yes">N<sub>eff</sub></italic>, and <italic toggle="yes">F<sub>q</sub></italic> are the same as those in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> and <xref rid="E3" ref-type="disp-formula">Equation (3)</xref>; <italic toggle="yes">I</italic>(.) is an indicator function, whose value is 1 when the corresponding event happens, and 0 otherwise; <italic toggle="yes">S<sub>aln</sub></italic> is the set of aligned nucleotides (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) in the previous step. The setting of gap penalties is the same as that described in Section 2.4.3 except that penalty is skipped for terminal gaps.</p>
      </sec>
    </sec>
    <sec>
      <title>2.5 Performance evaluation</title>
      <p>Alignment quality and model quality are used for evaluating the performance of different methods. Here the alignment quality is quantified by two metrics: alignment coverage and the RMSD of the aligned region. Alignment coverage is calculated by dividing the aligned length by the length of the query RNA. As for RMSD of the aligned region, we first extract coordinates of all heavy atoms on the backbone of aligned nucleotides from the template RNA, then compute RMSD with the corresponding region in the native structure. The other measure model quality is quantified by the RMSD between the native structure and the full-atom model built by FARFAR2 (<xref rid="btae080-B39" ref-type="bibr">Watkins <italic toggle="yes">et al.</italic> 2020</xref>) or ModeRNA (<xref rid="btae080-B29" ref-type="bibr">Rother <italic toggle="yes">et al.</italic> 2011</xref>) according to query-template alignment. The selection of the method for constructing the full-length model is determined by the alignment coverage. FARFAR2 is used when the alignment coverage varies significantly; otherwise, ModeRNA is used.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results and discussions</title>
    <sec>
      <title>3.1 Algorithm implementation and parameter optimization</title>
      <p>The RNAthreader algorithm is implemented in C++. We use the high-performance mathematical programming engine IBM ILOG CPLEX 12.9 to solve the quadratic integer programming problem presented in <xref rid="E2" ref-type="disp-formula">Equation (2)</xref>. With simplified linear arc diagrams of RNA secondary structures (<xref rid="btae080-F2" ref-type="fig">Fig. 2C</xref>), the number of variables to be solved and corresponding constraints decrease substantially.</p>
      <p>All the parameters were empirically selected to yield the best performance on the TR221 dataset. During the training process, templates sharing &gt; 40% sequence identity with query RNAs were excluded. After the exclusion of close homologous templates, the average alignment coverage is relatively low. We tuned the parameters based on the alignment quality defined in Section 2.5.</p>
    </sec>
    <sec>
      <title>3.2 Performance on the TE80 dataset</title>
      <p>In the absence of dedicated RNA threading methods, we compare RNAthreader with four representative RNA alignment algorithms: LocARNA (version 1.9.2.1) (<xref rid="btae080-B40" ref-type="bibr">Will <italic toggle="yes">et al.</italic> 2007</xref>), CARNA (version 1.3.3) (<xref rid="btae080-B32" ref-type="bibr">Sorescu <italic toggle="yes">et al.</italic> 2012</xref>), Foldalign (version 2.5.3) (<xref rid="btae080-B36" ref-type="bibr">Sundfeld <italic toggle="yes">et al.</italic> 2015</xref>), and RNAmountAlign (<xref rid="btae080-B6" ref-type="bibr">Bayegan and Clote 2020</xref>). We first conduct experiments on the TE80 dataset with four distinct thresholds: 60%, 50%, 40%, and 30%, which correspond to four progressively increasing levels of threading difficulty. In each comparison, templates with sequence identity to the query exceeding a certain threshold are excluded. The average number of non-redundant templates (&lt;99% pairwise sequence identity) remaining in the library for the four thresholds are as follows: 3991, 3713, 3344, and 2817, respectively. <xref rid="btae080-F3" ref-type="fig">Figure 3</xref> depicts the alignment quality, assessed in terms of coverage and RMSD, for the top-scoring alignment across different thresholds.</p>
      <fig position="float" id="btae080-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Alignment quality for the top-scoring alignment across different thresholds on the TE80 dataset. “LOC,” “CAR,” “MOU,” “FDA,” and “RTH” represent the methods LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader, respectively.</p>
        </caption>
        <graphic xlink:href="btae080f3" position="float"/>
      </fig>
      <p>The compared methods can be categorized into two groups based on the average coverage (as shown in <xref rid="btae080-F3" ref-type="fig">Fig. 3A</xref>): LocARNA, CARNA, and RNAmountAlign consistently maintain high coverages across different thresholds, while Foldalign and RNAthreader exhibit increasing average coverages as more templates with higher sequence identity become available. Likewise, there is a notable variation in RMSDs between these two groups of methods (<xref rid="btae080-F3" ref-type="fig">Fig. 3B</xref>). In the first group, the RMSDs of these methods have a tendency to increase as the threshold decreases, indicating that they could not effectively identify structure templates with low sequence identity. Moreover, RNAmountAlign yields alignments with significantly higher RMSDs when compared to LocARNA and CARNA. This observation suggests that it might not be appropriate to directly apply the Needleman-Wunsch dynamic programming to align RNAs. As for methods in the second group, namely Foldalign and RNAthreader, they exhibit relatively low average RMSDs that remain consistent regardless of the threading difficulty. The above facts confirm the reliability of these two methods in template detection.</p>
      <p>For proteins, a remote homolog is typically defined as a homologous template with less than 30% sequence identity to the query (<xref rid="btae080-B15" ref-type="bibr">Khor <italic toggle="yes">et al.</italic> 2015</xref>). However, due to the limited number of nucleotide types compared to amino acids, RNA sequences often exhibit higher similarity. Therefore, for RNAs, we use a threshold of 40% for remote homologs and conduct a more detailed analysis at this specific threshold.</p>
      <p>For each query, the alignment coverage for different methods varies, making the direct comparison in terms of RMSD less meaningful. To address this issue, we say method A generates more accurate alignment than method B on a target if the following two conditions are satisfied: (1) the RMSD on the aligned region of method A is lower than that of method B; (2) the alignment coverage of method A is higher than that of method B. The comparisons of the methods in the two above-mentioned groups are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S2 and S3</xref>, respectively. Our method outperforms Foldalign on 24 targets in the set TE80; while Foldalign outperforms our method on 9 targets.</p>
      <p>Given the diverse coverage of alignments from different methods, we integrated template information into FARFAR2, a fragment assembly-based approach for RNA structure prediction, to enhance the assessment of the generated alignments. Specifically, the structure of the aligned region from the top-scoring template, coupled with the query sequence and the secondary structure predicted by RNAfold (<xref rid="btae080-B19" ref-type="bibr">Lorenz <italic toggle="yes">et al.</italic> 2011</xref>), served as inputs for FARFAR2. If FARFAR2 fails to build models for a template, then the next-ranked template will be utilized, until a model is built successfully. <xref rid="btae080-T1" ref-type="table">Table 1</xref> displays the RMSD values and the count of optimal models (those with the lowest RMSD value) for the generated structural models using templates with &lt;40% sequence identity.</p>
      <table-wrap position="float" id="btae080-T1">
        <label>Table 1.</label>
        <caption>
          <p>RMSD and optimal model count (#) for FARFAR2 models using top-scoring templates with &lt;40% sequence identity.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1">Method</th>
              <th colspan="2" align="center" rowspan="1">All (80)<hr/></th>
              <th colspan="2" align="center" rowspan="1">Knotted (33)<hr/></th>
              <th colspan="2" rowspan="1">Nested (47)<hr/></th>
            </tr>
            <tr>
              <th align="center" rowspan="1" colspan="1">RMSD(Å)</th>
              <th rowspan="1" colspan="1">#</th>
              <th align="center" rowspan="1" colspan="1">RMSD(Å)</th>
              <th rowspan="1" colspan="1">#</th>
              <th rowspan="1" colspan="1">RMSD(Å)</th>
              <th rowspan="1" colspan="1">#</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">LOC</td>
              <td rowspan="1" colspan="1">29.1</td>
              <td rowspan="1" colspan="1">11</td>
              <td rowspan="1" colspan="1">32</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">27</td>
              <td rowspan="1" colspan="1">8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CAR</td>
              <td rowspan="1" colspan="1">29.3</td>
              <td rowspan="1" colspan="1">19</td>
              <td rowspan="1" colspan="1">32.9</td>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">26.8</td>
              <td rowspan="1" colspan="1">11</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MOU</td>
              <td rowspan="1" colspan="1">40.9</td>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">48.4</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">35.7</td>
              <td rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">FDA</td>
              <td rowspan="1" colspan="1">26.2</td>
              <td rowspan="1" colspan="1">16</td>
              <td rowspan="1" colspan="1">30.4</td>
              <td rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">23.3</td>
              <td rowspan="1" colspan="1">9</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RTH</td>
              <td rowspan="1" colspan="1">21.4</td>
              <td rowspan="1" colspan="1">30</td>
              <td rowspan="1" colspan="1">23.1</td>
              <td rowspan="1" colspan="1">12</td>
              <td rowspan="1" colspan="1">20.2</td>
              <td rowspan="1" colspan="1">18</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>“LOC,” “CAR,” “MOU,” “FDA,” and “RTH” represent the methods LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader, respectively.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Based on the data presented in <xref rid="btae080-T1" ref-type="table">Table 1</xref>, models generated with templates selected by RNAthreader exhibit the lowest average RMSD on the TE80 dataset, which is 18.3% lower than that of the next-best method, Foldalign. Additionally, the RNAthreader model outperforms all other compared methods by achieving the lowest RMSD among 30 targets, indicating its superior performance. We also compared the results with the original FARFAR2 model, which was generated solely using sequence and predicted secondary structure as inputs. The average RMSD (20.9 Å) of the original FARFAR2 model is slightly lower than that of RNAthreader. Despite this, when considering the number of best models, the original FARFAR2 method achieves the best performance on 18 targets, while RNAthreader performs best on 21 targets. The remaining four methods, namely LocARNA, CARNA, RNAmountAlign, and Foldalign, yield results of 8, 16, 4, and 13, respectively.</p>
      <p>We then divide the test set into two subsets, Knotted and Nested, to compare all methods further. The average RMSD for RNAthreader models is 24% lower than that of the second-best method Foldalign on the Knotted dataset, demonstrating the advantage of our method on RNAs with pseudoknots. Besides, within the Knotted subset, we further compute the average coverage of alignments on pseudoknotted base pairs. The results for LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader are 85.6%, 95.8%, 92.6%, 12.8%, and 18%, respectively.</p>
      <p>Finally, we assess the influence of skipping terminal gap penalties on RNAthreader’s performance. It turns out that omitting penalties for terminal gaps has a negligible impact on alignment coverage; however, it results in a noticeable improvement in the corresponding RMSD values. For instance, at the 40% threshold, the average alignment coverage remains nearly consistent, whether or not gap penalties are omitted (53.7% verus 53.5%). Nevertheless, the RMSD decreases from 17.6 Å to 15 Å when penalties for terminal gaps are skipped.</p>
    </sec>
    <sec>
      <title>3.3 Performance on the RNA-Puzzles targets</title>
      <p>We further test our method on the RNA-Puzzles targets. To simulate the situation of the RNA-Puzzles experiments, for targets in the PUZ30 dataset, we excluded all templates released after 1 January 2010. <xref rid="btae080-T2" ref-type="table">Table 2</xref> shows the alignment quality (RMSD and Coverage) on the aligned region and the RMSD of the full-length models. Given high alignment coverage, the full-length model is built by the homology modeling method, ModeRNA, with default parameters based on the top-scoring template. Similarly, if ModeRNA fails to build models for a target, the next template will be utilized until a model is successfully built.</p>
      <table-wrap position="float" id="btae080-T2">
        <label>Table 2.</label>
        <caption>
          <p>Performance of different methods on the RNA-Puzzles targets.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1">Method</th>
              <th colspan="2" align="center" rowspan="1">Aligned region<hr/></th>
              <th rowspan="1" colspan="1">Full-length model</th>
            </tr>
            <tr>
              <th align="center" rowspan="1" colspan="1">RMSD (Å)</th>
              <th rowspan="1" colspan="1">Coverage (%)</th>
              <th align="center" rowspan="1" colspan="1">RMSD (Å)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">LOC</td>
              <td rowspan="1" colspan="1">20.9</td>
              <td rowspan="1" colspan="1">96</td>
              <td rowspan="1" colspan="1">20.3</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">CAR</td>
              <td rowspan="1" colspan="1">19.4</td>
              <td rowspan="1" colspan="1">94.4</td>
              <td rowspan="1" colspan="1">21</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MOU</td>
              <td rowspan="1" colspan="1">23.9</td>
              <td rowspan="1" colspan="1">94.3</td>
              <td rowspan="1" colspan="1">25.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">FDA</td>
              <td rowspan="1" colspan="1">16.4</td>
              <td rowspan="1" colspan="1">75.1</td>
              <td rowspan="1" colspan="1">23.6</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">RTH</td>
              <td rowspan="1" colspan="1">17.6</td>
              <td rowspan="1" colspan="1">81.2</td>
              <td rowspan="1" colspan="1">20.1</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>From <xref rid="btae080-T2" ref-type="table">Table 2</xref>, we find that besides LocARNA, CARNA, and RNAmountAlign maintaining over 90% coverage, Foldalign and RNAthreader also achieve relatively high alignment coverage. RMSDs for other methods increase for the full-length models, except for LocARNA, which has the highest coverage. Additionally, Foldalign shows the largest increase in RMSD with a rise of 44.1%.</p>
      <p>Even if the average coverage of RNAthreader is not the highest, the quality of the full-length models generated by ModeRNA with templates selected by RNAthreader is the best among all the methods. In <xref rid="btae080-F4" ref-type="fig">Fig. 4</xref>, we present an example target from RNA-Puzzles (Puzzle 23, PDB ID: 6E8U) that RNAthreader outperforms other methods. This particular example involves a <italic toggle="yes">mango-III aptamer</italic> (<xref rid="btae080-B37" ref-type="bibr">Trachman <italic toggle="yes">et al.</italic> 2019</xref>). For this target, the RMSDs of the full-length models built using alignments generated by LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader are 11.27, 12.53, 12.07, 15.8, and 6.38 Ås, respectively. The model of RNAthreader is significantly more accurate than that of other methods, whose template 2OE5_B_A is the combination of two chains of 2OE5, with a coverage of 81.1%. Indeed, according to the assessment results released on the RNA-Puzzles website, the best model in the competition is from the Das Lab, with an RMSD of 8.129 Å, which is slightly worse than our model.</p>
      <fig position="float" id="btae080-F4">
        <label>Figure 4.</label>
        <caption>
          <p>Superimposition of the predicted models (in blue) against the native structure (in red) for an example RNA-Puzzles target Puzzle 23 (PDB ID: 6E8U).</p>
        </caption>
        <graphic xlink:href="btae080f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 Analysis of multiple sequence alignment</title>
      <p>Unlike conventional RNA alignment methods, RNAthreader utilizes sequence profiles calculated from MSA. As described above, we filter each MSA based on coverage and sequence identity. If more than 5 homologous sequences remain in the preprocessed MSA, then a sequence profile calculated by <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> will be utilized. After filtering, the sequence profile is used for 60 RNAs in the TE80 dataset when searching for templates. To study the impact of MSA utilization, we compare the performance of three different ways of using MSAs, i.e. not using MSAs (denoted by “noMSA”), using original MSAs generated by RNAcmap (denoted by “originMSA”), using filtered MSAs (denoted by “filterMSA”) on these 60 RNAs. The results after excluding templates with &gt;40% sequence identity are summarized in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4A and B</xref> show the comparison in terms of the alignment quality. Compared with not using MSAs, the coverage of the alignment increases by 2.8% after the inclusion of origin MSAs. The average RMSD increases as well, illustrating that the contribution from the original MSA is less significant. However, when filtered MSA is utilized for the sequence profile calculation, the alignment quality improves, with an increase of 7.6% in average coverage and a decrease of 2.6% in RMSD. This demonstrates the importance of filtering MSA. <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4C</xref> shows the comparison in terms of the number of better alignments. With filtered MSA, RNAthreader generates more accurate alignments (higher coverage and lower RMSD) on more targets than not using MSA and using the original MSA. In particular, there are 15 RNAs on which the “filterMSA” has higher alignment quality than “noMSA,” while the latter does not have any alignments superior to the former.</p>
    </sec>
    <sec>
      <title>3.5 Analysis of the predicted secondary structure</title>
      <p>The accuracy of secondary structure prediction may have a direct impact on the performance of RNAthreader, as the predicted secondary structure is an essential component of the alignment progress.</p>
      <p>Note that among the compared methods, only two methods CARNA and RNAthreader, are capable of handling pseudoknots. Hence, we first aim to verify whether RNAthreader's performance is primarily influenced by improved secondary structure prediction. To this end, we utilize RNAfold (<xref rid="btae080-B19" ref-type="bibr">Lorenz <italic toggle="yes">et al.</italic> 2011</xref>), a minimum free energy (MFE) based approach, to predict secondary structure and then incorporate its output as input into RNAthreader. It turns out that after excluding homologous templates with &gt;40% sequence identity, RNAthreader produce alignments with an average RMSD of 16.2 Å and a coverage of 50.5% on the TE80 dataset. Additionally, the accuracy of predicted secondary structures, as assessed by the average interaction network fidelity (INF) (<xref rid="btae080-B24" ref-type="bibr">Parisien <italic toggle="yes">et al.</italic> 2009</xref>), is 0.71 for SPOT-RNA and 0.62 for RNAfold, respectively. The results show that as the quality of RNA secondary structure prediction decreases, the performance of RNAthreader indeed experiences a decline. However, it's noteworthy that RNAthreader consistently generates a larger quantity of superior alignments (with lower RMSD and higher coverage) compared to Foldalign, another method capable of detecting remote homologous templates. In fact, RNAthreader produces superior alignments to Foldalign on 16 RNAs, while Foldalign outperforms RNAthreader on 7 RNAs.</p>
      <p>Subsequently, we further explore how the quality of secondary structure affects the three-dimensional structural models. For the PUZ30 dataset, the Pearson’s correlation coefficient (PCC) between INFs of secondary structures predicted by SPOT-RNA and RMSDs of structure models is −0.622. <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref> shows the scatter plot between the INF and the RMSD, suggesting that the more accurate secondary structure predictions do lead to more accurate 3D structure models from threading.</p>
    </sec>
    <sec>
      <title>3.6 Running time analysis</title>
      <p>We compare the speed of different methods by collecting their running time of searching against the same template library. Given that some of the methods being compared are extremely time-consuming, we exclude redundant sequences from the original library at 99% sequence identity. Then the following experiment was performed on this non-redundant library with 4860 RNAs.</p>
      <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref> show the running time of different methods on targets from the TE80 dataset. For better visualization, the longest RNA in this dataset (PDB ID: 5WZN_P) is excluded in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>. We can see from the figure that LocARNA has the highest growth rates in running time as the sequence length increases, followed by CARNA and Foldalign. In contrast, the speed of RNAmountAlign and our method RNAthreader do not have obvious changes. The average running time per RNA for LocARNA, CARNA, RNAmountAlign, Foldalign, and RNAthreader on the TE80 dataset is 42.3, 19.9, 8.6, 4.5, and 1.3 h, respectively. The high speed of our method compared with others is mostly due to the use of the simplified linear arc diagram.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>We have developed a novel RNA threading algorithm named RNAthreader using RNA secondary structure and sequence profile. It speeds up the alignment significantly with a reduced representation of RNA secondary structure and improves the alignment accuracy with the sequence profile. Benchmark tests show that RNAthreader outperforms other methods in terms of alignment accuracy and speed. Nevertheless, we admit that the models built from the RNAthreader templates are not perfect. This may be because of the limited size of the existing RNA template library. We anticipate RNAthreader could be improved further with the release of more experimental RNA structures in the future. Another promising way to improve is using the powerful deep learning algorithms.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btae080_Supplementary_Data</label>
      <media xlink:href="btae080_supplementary_data.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Science and Technology Research Program of Chongqing Municipal Education Commission (Grant No. KJQN202300639) and the National Natural Science Foundation of China (NSFC T2225007 and T2222012).</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article are available at <ext-link xlink:href="https://yanglab.qd.sdu.edu.cn/RNAthreader/" ext-link-type="uri">https://yanglab.qd.sdu.edu.cn/RNAthreader/</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btae080-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adamczyk</surname><given-names>B</given-names></string-name>, <string-name><surname>Antczak</surname><given-names>M</given-names></string-name>, <string-name><surname>Szachniuk</surname><given-names>M.</given-names></string-name></person-group><article-title>RNAsolo: a repository of cleaned PDB-derived RNA 3D structures</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>3668</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">35674373</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>SF</given-names></string-name>, <string-name><surname>Madden</surname><given-names>TL</given-names></string-name>, <string-name><surname>Schäffer</surname><given-names>AA</given-names></string-name></person-group><etal>et al</etal><article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res.</source><year>1997</year>;<volume>25</volume>:<fpage>3389</fpage>–<lpage>402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Antczak</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>New functionality of RNAComposer: an application to shape the axis of miR160 precursor structure</article-title>. <source>Acta Biochim. Pol</source><year>2016</year>;<volume>63</volume>:<fpage>737</fpage>–<lpage>44</lpage>.<pub-id pub-id-type="pmid">27741327</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baek</surname><given-names>M</given-names></string-name>, <string-name><surname>DiMaio</surname><given-names>F</given-names></string-name>, <string-name><surname>Anishchenko</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>Accurate prediction of protein structures and interactions using a three-track neural network</article-title>. <source>Science</source><year>2021</year>;<volume>373</volume>:<fpage>871</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">34282049</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bauer</surname><given-names>M</given-names></string-name>, <string-name><surname>Klau</surname><given-names>GW</given-names></string-name>, <string-name><surname>Reinert</surname><given-names>K.</given-names></string-name></person-group><article-title>Accurate multiple sequence-structure alignment of RNA sequences using combinatorial optimization</article-title>. <source>BMC Bioinform</source><year>2007</year>;<volume>8</volume>:<fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bayegan</surname><given-names>AH</given-names></string-name>, <string-name><surname>Clote</surname><given-names>P.</given-names></string-name></person-group><article-title>RNAmountAlign: efficient software for local, global, semiglobal pairwise and multiple RNA sequence/structure alignment</article-title>. <source>PLoS One</source><year>2020</year>;<volume>15</volume>:<fpage>e0227177</fpage>.<pub-id pub-id-type="pmid">31978147</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berman</surname><given-names>HM</given-names></string-name>, <string-name><surname>Westbrook</surname><given-names>J</given-names></string-name>, <string-name><surname>Feng</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>The protein data bank</article-title>. <source>Nucleic Acids Res.</source><year>2000</year>;<volume>28</volume>:<fpage>235</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">10592235</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Das</surname><given-names>R</given-names></string-name>, <string-name><surname>Baker</surname><given-names>D.</given-names></string-name></person-group><article-title>Automated de novo prediction of native-like RNA tertiary structures</article-title>. <source>Proc Natl Acad Sci U S A</source><year>2007</year>;<volume>104</volume>:<fpage>14664</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">17726102</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dowell</surname><given-names>RD</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR.</given-names></string-name></person-group><article-title>Efficient pairwise RNA structure prediction and alignment using sequence alignment constraints</article-title>. <source>BMC Bioinform</source><year>2006</year>;<volume>7</volume>:<fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Havgaard</surname><given-names>JH</given-names></string-name>, <string-name><surname>Gorodkin</surname><given-names>J.</given-names></string-name></person-group><article-title>RNA structural alignments, part I: sankoff-based approaches for structural alignments</article-title>. <source>Methods Mol Biol</source><year>2014</year>;<volume>1097</volume>:<fpage>275</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">24639164</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Havgaard</surname><given-names>JH</given-names></string-name>, <string-name><surname>Torarinsson</surname><given-names>E</given-names></string-name>, <string-name><surname>Gorodkin</surname><given-names>J.</given-names></string-name></person-group><article-title>Fast pairwise structural RNA alignments by pruning of the dynamical programming matrix</article-title>. <source>PLoS Comput. Biol.</source><year>2007</year>;<volume>3</volume>:<fpage>1896</fpage>–<lpage>908</lpage>.<pub-id pub-id-type="pmid">17937495</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hofacker</surname><given-names>IL</given-names></string-name>, <string-name><surname>Bernhart</surname><given-names>SH</given-names></string-name>, <string-name><surname>Stadler</surname><given-names>PF.</given-names></string-name></person-group><article-title>Alignment of RNA base pairing probability matrices</article-title>. <source>Bioinformatics</source><year>2004</year>;<volume>20</volume>:<fpage>2222</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">15073017</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hogeweg</surname><given-names>P</given-names></string-name>, <string-name><surname>Hesper</surname><given-names>B.</given-names></string-name></person-group><article-title>Energy directed folding of RNA sequences</article-title>. <source>Nucleic Acids Res.</source><year>1984</year>;<volume>12</volume>:<fpage>67</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">6198625</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jumper</surname><given-names>J</given-names></string-name>, <string-name><surname>Evans</surname><given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source><year>2021</year>;<volume>596</volume>:<fpage>583</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Khor</surname><given-names>BY</given-names></string-name>, <string-name><surname>Tye</surname><given-names>GJ</given-names></string-name>, <string-name><surname>Lim</surname><given-names>TS</given-names></string-name></person-group><etal>et al</etal><article-title>General overview on structure prediction of twilight-zone proteins</article-title>. <source>Theor. Biol. Med. Model.</source><year>2015</year>;<volume>12</volume>:<fpage>15</fpage>–<lpage>1</lpage>.<pub-id pub-id-type="pmid">26338054</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klein</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR.</given-names></string-name></person-group><article-title>RSEARCH: finding homologs of single structured RNA sequences</article-title>. <source>BMC Bioinform</source><year>2003</year>;<volume>4</volume>:<fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krokhotin</surname><given-names>A</given-names></string-name>, <string-name><surname>Houlihan</surname><given-names>K</given-names></string-name>, <string-name><surname>Dokholyan</surname><given-names>NV.</given-names></string-name></person-group><article-title>iFoldRNA v2: folding RNA with constraints</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>2891</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">25910700</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kryshtafovych</surname><given-names>A</given-names></string-name>, <string-name><surname>Schwede</surname><given-names>T</given-names></string-name>, <string-name><surname>Topf</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Critical assessment of methods of protein structure prediction (CASP)—round XIV</article-title>. <source>Proteins: Struct., Funct., Bioinf.</source><year>2021</year>;<volume>89</volume>:<fpage>1607</fpage>–<lpage>17</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lorenz</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>ViennaRNA package 2.0</article-title>. <source>Algorithms Mol. Biol</source><year>2011</year>;<volume>6</volume>:<fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">21235792</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Magnus</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>RNA-Puzzles toolkit: a computational resource of RNA 3D structure benchmark datasets, structure manipulation, and evaluation tools</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>48</volume>:<fpage>576</fpage>–<lpage>88</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mathews</surname><given-names>DH</given-names></string-name>, <string-name><surname>Turner</surname><given-names>DH.</given-names></string-name></person-group><article-title>Dynalign: an algorithm for finding the secondary structure common to two RNA sequences</article-title>. <source>J. Mol. Biol.</source><year>2002</year>;<volume>317</volume>:<fpage>191</fpage>–<lpage>203</lpage>.<pub-id pub-id-type="pmid">11902836</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nawrocki</surname><given-names>EP</given-names></string-name>, <string-name><surname>Eddy</surname><given-names>SR.</given-names></string-name></person-group><article-title>Infernal 1.1: 100-fold faster RNA homology searches</article-title>. <source>Bioinformatics</source><year>2013</year>;<volume>29</volume>:<fpage>2933</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">24008419</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Needleman</surname><given-names>SB</given-names></string-name>, <string-name><surname>Wunsch</surname><given-names>CD.</given-names></string-name></person-group><article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>. <source>J Mol. Biol.</source><year>1970</year>;<volume>48</volume>:<fpage>443</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">5420325</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parisien</surname><given-names>M</given-names></string-name>, <string-name><surname>Cruz</surname><given-names>JA</given-names></string-name>, <string-name><surname>Westhof</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>New metrics for comparing and assessing discrepancies between RNA 3D structures and models</article-title>. <source>RNA</source><year>2009</year>;<volume>15</volume>:<fpage>1875</fpage>–<lpage>85</lpage>.<pub-id pub-id-type="pmid">19710185</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parisien</surname><given-names>M</given-names></string-name>, <string-name><surname>Major</surname><given-names>F.</given-names></string-name></person-group><article-title>The MC-Fold and MC-Sym pipeline infers RNA structure from sequence data</article-title>. <source>Nature</source><year>2008</year>;<volume>452</volume>:<fpage>51</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">18322526</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Han</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Protein structure prediction in the deep learning era</article-title>. <source>Curr. Opin. Struct. Biol.</source><year>2022</year>;<volume>77</volume>:<fpage>102495</fpage>.<pub-id pub-id-type="pmid">36371845</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peselis</surname><given-names>A</given-names></string-name>, <string-name><surname>Serganov</surname><given-names>A.</given-names></string-name></person-group><article-title>Structure and function of pseudoknots involved in gene expression control</article-title>. <source>Wiley Interdiscip Rev RNA</source><year>2014</year>;<volume>5</volume>:<fpage>803</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">25044223</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Popenda</surname><given-names>M</given-names></string-name>, <string-name><surname>Szachniuk</surname><given-names>M</given-names></string-name>, <string-name><surname>Antczak</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Automated 3D structure composition for large RNAs</article-title>. <source>Nucleic Acids Res.</source><year>2012</year>;<volume>40</volume>:<fpage>e112</fpage>-<lpage>e112</lpage>.<pub-id pub-id-type="pmid">22539264</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rother</surname><given-names>M</given-names></string-name>, <string-name><surname>Rother</surname><given-names>K</given-names></string-name>, <string-name><surname>Puton</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>ModeRNA: a tool for comparative modeling of RNA 3D structure</article-title>. <source>Nucleic Acids Res.</source><year>2011</year>;<volume>39</volume>:<fpage>4007</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">21300639</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sankoff</surname><given-names>D.</given-names></string-name></person-group><article-title>Simultaneous solution of the RNA folding, alignment and protosequence problems</article-title>. <source>SIAM J. Appl. Math.</source><year>1985</year>;<volume>45</volume>:<fpage>810</fpage>–<lpage>25</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Singh</surname><given-names>J</given-names></string-name>, <string-name><surname>Hanson</surname><given-names>J</given-names></string-name>, <string-name><surname>Paliwal</surname><given-names>K</given-names></string-name></person-group><etal>et al</etal><article-title>RNA secondary structure prediction using an ensemble of two-dimensional deep neural networks and transfer learning</article-title>. <source>Nat. Commun.</source><year>2019</year>;<volume>10</volume>:<fpage>5407</fpage>.<pub-id pub-id-type="pmid">31776342</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sorescu</surname><given-names>DA</given-names></string-name>, <string-name><surname>Möhl</surname><given-names>M</given-names></string-name>, <string-name><surname>Mann</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>CARNA—alignment of RNA structure ensembles</article-title>. <source>Nucleic Acids Res.</source><year>2012</year>;<volume>40</volume>:<fpage>W49</fpage>–<lpage>W53</lpage>.<pub-id pub-id-type="pmid">22689637</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinegger</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>HH-suite3 for fast remote homology detection and deep protein annotation</article-title>. <source>BMC Bioinform</source><year>2019</year>;<volume>20</volume>:<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Peng</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>RNA inter-nucleotide 3D closeness prediction by deep residual neural networks</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>37</volume>:<fpage>1093</fpage>–<lpage>8</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>S</given-names></string-name>, <string-name><surname>Wu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Peng</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Enhanced prediction of RNA solvent accessibility with long short-term memory neural networks and improved sequence profiles</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>35</volume>:<fpage>1686</fpage>–<lpage>91</lpage>.</mixed-citation>
    </ref>
    <ref id="btae080-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sundfeld</surname><given-names>D</given-names></string-name>, <string-name><surname>Havgaard</surname><given-names>JH</given-names></string-name>, <string-name><surname>de Melo</surname><given-names>ACMA</given-names></string-name></person-group><etal>et al</etal><article-title>Foldalign 2.5: multithreaded implementation for pairwise structural RNA alignment</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>32</volume>:<fpage>1238</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">26704597</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trachman</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Autour</surname><given-names>A</given-names></string-name>, <string-name><surname>Jeng</surname><given-names>SCY</given-names></string-name></person-group><etal>et al</etal><article-title>Structure and functional reselection of the Mango-III fluorogenic RNA aptamer</article-title>. <source>Nat. Chem. Biol.</source><year>2019</year>;<volume>15</volume>:<fpage>472</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">30992561</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Feng</surname><given-names>C</given-names></string-name>, <string-name><surname>Han</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>trRosettaRNA: automated prediction of RNA 3D structure with transformer network</article-title>. <source>Nat. Commun.</source><year>2023</year>;<volume>14</volume>:<fpage>7266</fpage>.<pub-id pub-id-type="pmid">37945552</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Watkins</surname><given-names>AM</given-names></string-name>, <string-name><surname>Rangan</surname><given-names>R</given-names></string-name>, <string-name><surname>Das</surname><given-names>R.</given-names></string-name></person-group><article-title>FARFAR2: improved De novo rosetta prediction of complex global RNA folds</article-title>. <source>Structure</source><year>2020</year>;<volume>28</volume>:<fpage>963</fpage>–<lpage>76.e6</lpage>.<pub-id pub-id-type="pmid">32531203</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Will</surname><given-names>S</given-names></string-name>, <string-name><surname>Reiche</surname><given-names>K</given-names></string-name>, <string-name><surname>Hofacker</surname><given-names>IL</given-names></string-name></person-group><etal>et al</etal><article-title>Inferring noncoding rna families and classes by means of genome-scale structure-based clustering</article-title>. <source>PLoS Comput. Biol.</source><year>2007</year>;<volume>3</volume>:<fpage>e65</fpage>.<pub-id pub-id-type="pmid">17432929</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>H</given-names></string-name>, <string-name><surname>Jossinet</surname><given-names>F</given-names></string-name>, <string-name><surname>Leontis</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>Tools for the automatic identification and classification of RNA base pairs</article-title>. <source>Nucleic Acids Res.</source><year>2003</year>;<volume>31</volume>:<fpage>3450</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">12824344</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>T</given-names></string-name>, <string-name><surname>Singh</surname><given-names>J</given-names></string-name>, <string-name><surname>Litfin</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>RNAcmap: a fully automatic pipeline for predicting contact maps of RNAs by evolutionary coupling analysis</article-title>. <source>Bioinformatics</source><year>2021</year>;<volume>37</volume>:<fpage>3494</fpage>–<lpage>500</lpage>.<pub-id pub-id-type="pmid">34021744</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Xiao</surname><given-names>Y.</given-names></string-name></person-group><article-title>3dRNA: 3D structure prediction from linear to circular RNAs</article-title>. <source>J. Mol. Biol.</source><year>2022</year>;<volume>434</volume>:<fpage>167452</fpage>.<pub-id pub-id-type="pmid">35662453</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>C</given-names></string-name>, <string-name><surname>Xu</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S-J.</given-names></string-name></person-group><article-title>Predicting RNA structure with vfold</article-title>. <source>Methods Mol Biol</source><year>2017</year>;<volume>1654</volume>:<fpage>3</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">28986779</pub-id></mixed-citation>
    </ref>
    <ref id="btae080-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Huang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Gong</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>Automated and fast building of three-dimensional RNA structures</article-title>. <source>Sci Rep</source><year>2012</year>;<volume>2</volume>:<fpage>734</fpage>.<pub-id pub-id-type="pmid">23071898</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
