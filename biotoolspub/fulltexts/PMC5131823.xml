<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Res</journal-id>
    <journal-id journal-id-type="hwp">genome</journal-id>
    <journal-id journal-id-type="pmc">genome</journal-id>
    <journal-id journal-id-type="publisher-id">GENOME</journal-id>
    <journal-title-group>
      <journal-title>Genome Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1088-9051</issn>
    <issn pub-type="epub">1549-5469</issn>
    <publisher>
      <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5131823</article-id>
    <article-id pub-id-type="medline">9509184</article-id>
    <article-id pub-id-type="doi">10.1101/gr.210641.116</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Centrifuge: rapid and sensitive classification of metagenomic sequences</article-title>
      <alt-title alt-title-type="left-running">Kim et al.</alt-title>
      <alt-title alt-title-type="right-running">Centrifuge: classifier for metagenomic sequences</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-1182-629X</contrib-id>
        <name>
          <surname>Kim</surname>
          <given-names>Daehwan</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
        <xref ref-type="author-notes" rid="FN1">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Li</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
        <xref ref-type="aff" rid="af2">2</xref>
        <xref ref-type="author-notes" rid="FN1">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Breitwieser</surname>
          <given-names>Florian P.</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
        <xref ref-type="author-notes" rid="FN1">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8859-7432</contrib-id>
        <name>
          <surname>Salzberg</surname>
          <given-names>Steven L.</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
        <xref ref-type="aff" rid="af2">2</xref>
        <xref ref-type="aff" rid="af3">3</xref>
      </contrib>
    </contrib-group>
    <aff id="af1"><label>1</label>Center for Computational Biology, McKusick-Nathans Institute of Genetic Medicine, Johns Hopkins University School of Medicine, Baltimore, Maryland 21205, USA;</aff>
    <aff id="af2"><label>2</label>Department of Computer Science, Johns Hopkins University, Baltimore, Maryland 21218, USA;</aff>
    <aff id="af3"><label>3</label>Departments of Biomedical Engineering and Biostatistics, Johns Hopkins University, Baltimore, Maryland 21205, USA</aff>
    <author-notes>
      <fn fn-type="equal" id="FN1">
        <label>4</label>
        <p>These authors contributed equally to this work.</p>
      </fn>
      <corresp>Corresponding author: <email>infphilo@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>12</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <month>12</month>
      <year>2016</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="ppub"/>. -->
    <volume>26</volume>
    <issue>12</issue>
    <fpage>1721</fpage>
    <lpage>1729</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>5</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>13</day>
        <month>10</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>
        <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml">© 2016 Kim et al.; Published by Cold Spring Harbor Laboratory Press</ext-link>
      </copyright-statement>
      <copyright-year>2016</copyright-year>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This article, published in <italic>Genome Research</italic>, is available under a Creative Commons License (Attribution 4.0 International), as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="1721.pdf"/>
    <abstract>
      <p>Centrifuge is a novel microbial classification engine that enables rapid, accurate, and sensitive labeling of reads and quantification of species on desktop computers. The system uses an indexing scheme based on the Burrows-Wheeler transform (BWT) and the Ferragina-Manzini (FM) index, optimized specifically for the metagenomic classification problem. Centrifuge requires a relatively small index (4.2 GB for 4078 bacterial and 200 archaeal genomes) and classifies sequences at very high speed, allowing it to process the millions of reads from a typical high-throughput DNA sequencing run within a few minutes. Together, these advances enable timely and accurate analysis of large metagenomics data sets on conventional desktop computers. Because of its space-optimized indexing schemes, Centrifuge also makes it possible to index the entire NCBI nonredundant nucleotide sequence database (a total of 109 billion bases) with an index size of 69 GB, in contrast to <italic>k</italic>-mer-based indexing schemes, which require far more extensive space.</p>
    </abstract>
    <funding-group>
      <award-group id="funding-1">
        <funding-source>National Institutes of Health (NIH) <named-content content-type="funder-id">http://dx.doi.org/10.13039/100000002</named-content></funding-source>
        <award-id>R01-HG006677</award-id>
        <award-id>R01-GM083873</award-id>
        <award-id>W911NF-1410490</award-id>
      </award-group>
      <award-group id="funding-2">
        <funding-source>National Science Foundation (NSF) <named-content content-type="funder-id">http://dx.doi.org/10.13039/100000001</named-content></funding-source>
        <award-id>ABI-1356078</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>Microbes such as archaea and bacteria are found virtually everywhere on earth, from soils and oceans to hot springs and deep mines (<xref rid="KIMGR210641C11" ref-type="bibr">Keller and Zengler 2004</xref>). They are also abundant on and inside living creatures, including a variety of niches on the human body such as the skin and the intestinal tract (<xref rid="KIMGR210641C9" ref-type="bibr">Human Microbiome Project Consortium 2012</xref>). These invisible life forms perform a vast range of biological functions; they are indispensable for the survival of many species; and they maintain the ecological balance of the planet. Many millions of prokaryotic species exist (<xref rid="KIMGR210641C27" ref-type="bibr">Schloss and Handelsman 2004</xref>), although only a small fraction of them (&lt;1% in soil and even fewer in the ocean) can be isolated and cultivated (<xref rid="KIMGR210641C1" ref-type="bibr">Amann et al. 1995</xref>). High-throughput sequencing of microbial communities, known as metagenomic sequencing, does not require cultivation and therefore has the potential to provide countless insights into the biological functions of microbial species and their effects on the visible world.</p>
  <p>In 2004, the RefSeq database contained 179 complete prokaryotic genomes, a number that grew to 954 genomes by 2009 and to 4278 by December 2015. Together with advances in sequencing throughput, this ever-increasing number of genomes presents a challenge for computational methods that compare DNA sequences to the full database of microbial genomes. Analysis of metagenomics samples, which contain millions of reads from complex mixtures of species, necessitates a compact and scalable indexing scheme for classifying these sequences quickly and accurately. Most of the current metagenomics classification programs either suffer from slow classification speed, a large index size, or both. For example, machine-learning-based approaches such as the Naive Bayes Classifier (NBC) (<xref rid="KIMGR210641C26" ref-type="bibr">Rosen et al. 2008</xref>) and PhymmBL (<xref rid="KIMGR210641C3" ref-type="bibr">Brady and Salzberg 2009</xref>, <xref rid="KIMGR210641C4" ref-type="bibr">2011</xref>) classify &lt;100 reads per minute, which is too slow for data sets that contain millions of reads. In contrast, the pseudoalignment approach employed in Kraken (<xref rid="KIMGR210641C30" ref-type="bibr">Wood and Salzberg 2014</xref>) processes reads far more quickly, more than 1 million reads per minute, but its exact <italic>k</italic>-mer matching algorithm requires a large index. For example, Kraken's 31-mer database requires 93 GB of memory (RAM) for 4278 prokaryotic genomes, considerably more memory than today's desktop computers contain.</p>
  <p>Fortunately, modern read-mapping algorithms such as Bowtie (<xref rid="KIMGR210641C14" ref-type="bibr">Langmead et al. 2009</xref>; <xref rid="KIMGR210641C13" ref-type="bibr">Langmead and Salzberg 2012</xref>) and BWA (<xref rid="KIMGR210641C16" ref-type="bibr">Li and Durbin 2009</xref>, <xref rid="KIMGR210641C17" ref-type="bibr">2010</xref>) have developed a data structure that provides very fast alignment with a relatively small memory footprint. We have adapted this data structure, which is based on the Burrows-Wheeler transform (<xref rid="KIMGR210641C5" ref-type="bibr">Burrows and Wheeler 1994</xref>) and the Ferragina-Manzini (FM) index (<xref rid="KIMGR210641C7" ref-type="bibr">Ferragina and Manzini 2000</xref>), to create a metagenomics classifier, Centrifuge, that can efficiently store large numbers of genome sequences, taxonomical mappings of the sequences, and the taxonomical tree.</p>
  <sec sec-type="methods" id="s1">
    <title>Methods</title>
    <sec id="s1a">
      <title>Database sequence compression</title>
      <p>We implemented memory-efficient indexing schemes for the classification of microbial sequences based on the FM-index, which also permits very fast search operations. We further reduced the size of the index by compressing genomic sequences and building a modified version of the FM-index for those compressed genomes, as follows. First, we observed that for some bacterial species, large numbers of closely related strains and isolates have been sequenced, usually because they represent significant human pathogens. Such genomes include <italic>Salmonella enterica</italic> with 138 genomes, <italic>Escherichia coli</italic> with 131 genomes, and <italic>Helicobacter pylori</italic> with 73 genomes available (these figures represent the contents of RefSeq as of December 2015). As expected, the genomic sequences of strains within the same species are likely to be highly similar to one another. We leveraged this fact to remove such redundant genomic sequences, so that the storage size of our index can remain compact even as the number of sequenced isolates for these species increases.</p>
      <p><xref ref-type="fig" rid="KIMGR210641F1">Figure 1</xref> illustrates how we compress multiple genomes of the same species by storing near-identical sequences only once. First, we choose the two genomes (G<sub>1</sub> and G<sub>2</sub> in the figure) that are most similar among all genomes. We define the two most similar genomes as those that share the greatest number of <italic>k</italic>-mers (using <italic>k</italic> = 53 for this study) after <italic>k</italic>-mers are randomly sampled at a rate of 1% from the genomes of the same species. In order to facilitate this selection process, we used Jellyfish (<xref rid="KIMGR210641C21" ref-type="bibr">Marcais and Kingsford 2011</xref>) to build a table indicating which <italic>k</italic>-mers belong to which genomes. Using the two most similar genomes allows for better compression as they tend to share larger chunks of genomic sequences than two randomly selected genomes. We then compared the two most similar genomes using nucmer (<xref rid="KIMGR210641C12" ref-type="bibr">Kurtz et al. 2004</xref>), which outputs a list of the nearly or completely identical regions in both genomes. When combining the two genomes, we discard those sequences of G<sub>2</sub> with ≥99% identity to G<sub>1</sub> and retain the remaining sequences to use in our index. We then find the genome that is most similar to the combined sequences from G<sub>1</sub> and G<sub>2</sub> and combine this in the same manner as just described. This process is repeated for the rest of the genomes.</p>
      <fig id="KIMGR210641F1" orientation="portrait" position="float">
        <label>Figure 1.</label>
        <caption>
          <p>Compression of genome sequences before building the Centrifuge index. All genomes are compared and similarities are computed based on shared 53-mers. In the figure, genomes G<sub>1</sub> and G<sub>2</sub> are the most similar pair. Sequences of G<sub>2</sub> that are ≥99% identical to G<sub>1</sub> are discarded, and the remaining “unique” sequences from G<sub>2</sub> are added to genome G<sub>1</sub>, creating a merged genome, G<sub>1+2</sub>. Similarity between all genomes is recomputed using the merged genomes. Sequences &lt;99% identical in genome G<sub>3</sub> are then added to the merged genome, creating genome G<sub>1+2+3</sub>. This process repeats for the entire Centrifuge database until each merged genome has no sequences ≥99% identical to any other genome.</p>
        </caption>
        <graphic xlink:href="1721f01"/>
      </fig>
      <p>As a result of this concatenation procedure, we obtained dramatic space reductions for many species; e.g., the total sequence was reduced from 661 to 74 Mbp (11% of the original sequence size) in <italic>S. enterica</italic> and from 655 to 107 Mbp (16%) in <italic>E. coli</italic> (see <xref ref-type="table" rid="KIMGR210641TB1">Table 1</xref>). Overall, the number of base pairs from ∼4300 bacterial and archaeal genomes was reduced from 15 to 9.1 billion base pairs (Gbp). The FM-index for these compressed sequences occupies 4.2 GB of memory, which is small enough to fit into the main memory (RAM) on a conventional desktop computer. As we demonstrate in the <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.210641.116/-/DC1">Supplemental Methods</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.210641.116/-/DC1">Supplemental Table S1</ext-link>, this compression operation has only a negligible impact on classification sensitivity and accuracy.</p>
      <table-wrap id="KIMGR210641TB1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Compression ratios for 10 bacterial species that have multiple genomes fully sequenced and available in RefSeq</p>
        </caption>
        <graphic xlink:href="1721tb01"/>
      </table-wrap>
    </sec>
    <sec id="s1b">
      <title>Classification based on the FM-index</title>
      <p>The FM-index provides several advantages over <italic>k</italic>-mer-based indexing schemes that store all <italic>k</italic>-mers in the target genomes. First, the size of the <italic>k</italic>-mer table is usually large; for example, Kraken's <italic>k</italic>-mer table for storing all 31-mers in ∼4300 prokaryotic genomes occupies ∼100 GB of disk space. Second, using a fixed value for <italic>k</italic> incurs a tradeoff between sensitivity and precision: Classification based on exact matches of large <italic>k</italic>-mers (e.g., 31 bp) provides higher precision but at the expense of lower sensitivity, especially when the data being analyzed originate from divergent species. To achieve higher sensitivity, smaller <italic>k</italic>-mer matches (e.g., 20–25 bp) can be used; however, this results in more false-positive matches. The FM-index provides a means to exploit both large and small <italic>k</italic>-mer matches by enabling rapid search of <italic>k</italic>-mers of any length, at speeds comparable to those of <italic>k</italic>-mer table indexing algorithms (see Results).</p>
      <p>Using this FM-index, Centrifuge classifies DNA sequences as follows. Suppose we are given a 100-bp read (note the Centrifuge can just as easily process very long reads, assembled contigs from a draft genome, or even entire chromosomes). We search both the read (forward) and its reverse complement from right to left (3′ to 5′) as illustrated in <xref ref-type="fig" rid="KIMGR210641F2">Figure 2</xref>A. Centrifuge begins with a short exact match (16-bp minimum) and extends the match as far as possible. In the example shown in <xref ref-type="fig" rid="KIMGR210641F2">Figure 2</xref>A, the first 40 bp match exactly, with a mismatch at the 41st base from the right. The rightmost 40-bp segment of the read is found in six species (A, B, C, D, E, and F) that had been stored in the Centrifuge database. The algorithm then resumes the search beginning at the 42nd base and stops at the next mismatch, which occurs at the 68th base. The 26-bp segment in the middle of the read is found in species G and H. We then continue to search for mappings in the rest of the read, identifying a 32-bp segment that matches species G. Note that only exact matches are considered throughout this process, which is a key factor in the speed of the algorithm. We perform the same procedure for the reverse complement of the read which, in this example, produces more mappings with smaller lengths (17, 16, 28, 18, and 17) compared to the forward strand.</p>
      <fig id="KIMGR210641F2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>Classification of reads. (<italic>A</italic>) The figure shows how the score for a candidate at the species level is calculated. Given a 100-bp read, both the read (forward) and its reverse complement from <italic>right</italic> to <italic>left</italic> are searched. Centrifuge first identifies a short exact match, then continues until reaching a mismatch: The first 40-bp segment exactly matches six species (A, B, C, D, E, F), followed by a mismatch at the 41st base; the second 26-bp segment matches two species (G and H), followed by a mismatch at the 68th base; and the third 32-bp segment matches only species G. This procedure is repeated for the reverse complement of the read. Centrifuge assigns the highest score (625) to species A, B, C, D, E, and F. (<italic>B</italic>) Centrifuge then traverses up the taxonomic tree to reduce the number of assignments, first by considering the genus that includes the largest number of species, genus I, which covers species A, B, and C, and then replacing these three species with the genus. This procedure results in reducing the number of assignments to four (genus I plus species D, E, and F).</p>
        </caption>
        <graphic xlink:href="1721f02"/>
      </fig>
      <p>Based on the exact matches found in the read and its reverse complement, Centrifuge then classifies the read using only those mappings with at least one 22-bp match. <xref ref-type="fig" rid="KIMGR210641F2">Figure 2</xref>A shows three segment mappings on the forward strand read and one on the read's reverse complement that meet this length threshold. Centrifuge then scores each species using the following formula, which assigns greater weight to the longer segments:
<disp-formula><mml:math id="UM1"><mml:mrow><mml:mi mathvariant="normal">Score</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">Species</mml:mi></mml:mrow><mml:mspace width="0.4em"/><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">hit</mml:mi></mml:mrow><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="normal">Species</mml:mi></mml:mrow><mml:mspace width="0.4em"/><mml:mi>X</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">length</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="normal">hit</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mn>15</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <p>After assessing a variety of formulas, we empirically found that the sum of squared lengths of segments provides the best classification precision. Because almost all sequences of 15 bp or shorter occur in the database by chance, we subtract 15 from the match length. Other values such as 0 and 7 bp work almost as well, while higher values such as 21 bp result in slightly lower precision and sensitivity. For the example in <xref ref-type="fig" rid="KIMGR210641F2">Figure 2</xref>, species A, B, C, D, E, and F are assigned the highest score (625), based on the relatively long 40-bp exact match. Species G and H get lower scores because they have considerably shorter matches, even though each has two distinct matches. Note that H has mappings on both the read and its reverse complement, and in this case, Centrifuge chooses the strand that gives the maximum score, rather than using the summed score on both strands, which might bias it toward palindromic sequences.</p>
      <p>Centrifuge can assign a sequence to multiple taxonomic categories; by default, it allows up to five labels per sequence. (Note that this strategy differs from Kraken, which always chooses a single taxonomic category, using the lowest common ancestor of all matching species.) In <xref ref-type="fig" rid="KIMGR210641F2">Figure 2</xref>, six different species match the read equally well. In order to reduce the number of assignments, Centrifuge traverses up the taxonomic tree. First, it considers the genus that includes the largest number of species, which, in this example (<xref ref-type="fig" rid="KIMGR210641F2">Fig. 2</xref>B), is genus I, which covers species A, B, and C. It then replaces these three species with the genus, thereby reducing the number of assignments to four (genus I plus species D, E, and F). If more than five taxonomic labels had remained, Centrifuge would repeat this process for other genera and subsequently for higher taxonomic units until it reduced the number of labels to five or fewer.</p>
      <p>The user can easily change the default threshold of five labels per sequence; for example, if this threshold is set to one, then Centrifuge will report only the lowest common ancestor as the taxonomic label, mimicking the behavior of Kraken. In the example shown in <xref ref-type="fig" rid="KIMGR210641F2">Figure 2</xref>, this label would be at the family level, which would lose some of the more specific information about which genera and species the reads matched best.</p>
      <p>If the size of the index is not a constraint, then the user can also use Centrifuge with uncompressed indexes, which classify reads using the same algorithm. Although considerably larger, the uncompressed indexes allow Centrifuge to classify reads at the strain or genome level; e.g., as <italic>E. coli</italic> K12 rather than just <italic>E. coli</italic>.</p>
    </sec>
    <sec id="s1c">
      <title>Abundance analysis</title>
      <p>In addition to per-read classification, Centrifuge performs abundance analysis at any taxonomic rank (e.g., strain, species, genus). Because many genomes share near-identical segments of DNA with other species, reads originating from those segments will be classified as multiple species. Simply counting the number of the reads that are uniquely classified as a given genome (ignoring those that match other genomes) will therefore give poor estimates of that species’ abundance. To address this problem, we define the following statistical model and use it to find maximum likelihood estimates of abundance through an Expectation-Maximization (EM) algorithm. Detailed EM solutions to the model have been previously described and implemented in the Cufflinks (<xref rid="KIMGR210641C29" ref-type="bibr">Trapnell et al. 2010</xref>) and Sailfish (<xref rid="KIMGR210641C24" ref-type="bibr">Patro et al. 2014</xref>) software packages.</p>
      <p>Similar to how Cufflinks calculates gene/transcript expressions, the likelihood for a specific configuration of species abundance α, given the read assignments <italic>C</italic>, is defined as follows:
<disp-formula><mml:math id="UM2"><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:munderover><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁡</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula>
where <italic>R</italic> is the number of the reads, <italic>S</italic> is the number of species, α<sub>j</sub> is the abundance of species <italic>j</italic>, summing up to 1 over all <italic>S</italic> species, <italic>l</italic><sub><italic>j</italic></sub> is the average length of the genomes of species <italic>j</italic>, and <italic>C</italic><sub><italic>ij</italic></sub> is 1 if read <italic>i</italic> is classified to species <italic>j</italic> and 0 otherwise.</p>
      <p>To find the abundances α that maximize the likelihood function <italic>L</italic>(α|<italic>C</italic>), Centrifuge repeats the following EM procedure as also implemented in Cufflinks until the difference between the previous estimate of abundances and the current estimate, <inline-formula><mml:math id="IL1"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></inline-formula> is less than 10<sup>−10</sup>.</p>
      <p>Expectation (E-step):
<disp-formula><mml:math id="UM3"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:munderover><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁡</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula>
where <italic>n</italic><sub><italic>j</italic></sub> is the estimated number of reads assigned to species <italic>j</italic>.</p>
      <p>Maximization (M-step):
<disp-formula><mml:math id="UM4"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mo>⁡</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mrow><mml:mo>/</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:mstyle></mml:math></disp-formula>
where <inline-formula><mml:math id="IL2"><mml:msubsup><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the updated estimate of species <italic>j</italic>’s abundance. α′ is then used in the next iteration as α.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s2">
    <title>Results</title>
    <p>We demonstrated the performance of Centrifuge in four different settings involving both real and simulated reads and using several databases with different sizes, specifically one consisting of ∼4300 prokaryotic genomes (index name: <italic>p</italic>, index size: 4.2 GB), another with ∼4300 prokaryotic genomes plus human and viral genomes (<italic>p</italic> + <italic>h</italic> + <italic>v</italic>, 6.9 GB), and a third comprised of NCBI nucleotide sequences (<italic>nt</italic>, 69 GB). We compared the sensitivity and speed of Centrifuge to one of the leading classification programs, Kraken (v0.10.5-beta) (<xref rid="KIMGR210641C30" ref-type="bibr">Wood and Salzberg 2014</xref>). We also included MegaBLAST (<xref rid="KIMGR210641C31" ref-type="bibr">Zhang et al. 2000</xref>) in our assessment, as it is a very widely used program that is often used for classification. In terms of both sensitivity and precision of classification, Centrifuge demonstrated similar accuracy to the other programs we tested. Centrifuge's principal advantage is that it provides a combination of fast classification speed and low memory requirements, making it possible to perform large metagenomics analyses on a desktop computer using <italic>p</italic> or <italic>p</italic> + <italic>h</italic> + <italic>v</italic> index. For example, Centrifuge took only 47 min on a standard desktop computer to analyze 130 paired-end RNA sequencing runs (a total of 26 GB) from patients infected with Ebola virus (<xref rid="KIMGR210641C2" ref-type="bibr">Baize et al. 2014</xref>; <xref rid="KIMGR210641C8" ref-type="bibr">Gire et al. 2014</xref>; <xref rid="KIMGR210641C23" ref-type="bibr">Park et al. 2015</xref>) as described below. Centrifuge's efficient indexing scheme makes it possible to index the NCBI nucleotide collection (<italic>nt</italic>) database, which is a comprehensive set of sequences (&gt;36 million nonredundant sequences, ∼110 billion bp) collected from viruses, archaea, bacteria, and eukaryotes, and enables rapid and accurate classification of metagenomic samples.</p>
    <sec id="s2a">
      <title>Comparison of Centrifuge, Kraken, and MegaBLAST on simulated reads from 4278 prokaryotic genomes</title>
      <p>We created a simulated read data set from the 4278 complete prokaryotic genomes in RefSeq (<xref rid="KIMGR210641C25" ref-type="bibr">Pruitt et al. 2014</xref>) that were used to build the database, <italic>p</italic>. From these genomes, we generated 10 million 100-bp reads with a per-base error rate of 3% using the Mason simulator, v0.1.2 (<xref rid="KIMGR210641C20" ref-type="bibr">Luke et al. 2005</xref>). We used an error rate higher than found in Illumina reads (≤0.5%) in order to model the high mutation rates of prokaryotes. Reads were generated randomly from the entire data set; thus, longer genomes had proportionally more reads. The full set of genomes is provided in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.210641.116/-/DC1">Supplemental Table S2</ext-link>. We built indexes for each of the respective programs. Kraken and MegaBLAST require 100 GB and 25 GB of space (respectively) for their indexes. In contrast, Centrifuge requires only 4.2 GB to store and index the same genomes. The run-time memory footprint of MegaBLAST is small (<xref ref-type="table" rid="KIMGR210641TB2">Table 2</xref>) because it does not read the entire database into memory, in contrast to Kraken and Centrifuge. We classified the reads with Centrifuge, Kraken, and MegaBLAST and calculated sensitivity and precision at the genus and species levels for each program (<xref ref-type="table" rid="KIMGR210641TB2">Table 2</xref>). Centrifuge and MegaBLAST often report multiple assignments for a given read, while Kraken instead reports the lowest common ancestor. To make our evaluation consistent across the programs, we only considered uniquely classified reads. Here, we define sensitivity as the number of reads that are correctly classified divided by the total number of reads. Precision (also called positive predictive value) is defined as the number of correctly classified reads divided by the number of predictions made (i.e., reads that have no match and are not classified at a given taxonomic rank or below are not counted).</p>
      <table-wrap id="KIMGR210641TB2" orientation="portrait" position="float">
        <label>Table 2.</label>
        <caption>
          <p>Classification sensitivity and precision for Centrifuge, Kraken, and MegaBLAST using simulated reads</p>
        </caption>
        <graphic xlink:href="1721tb02"/>
      </table-wrap>
      <p>At the species level, MegaBLAST provides the highest sensitivity at 78.8%, followed by Centrifuge (76.9%) and then Kraken (73.9%). Overall sensitivity is relatively low because many reads are assigned to multiple species and considered as unclassified in our evaluation. MegaBLAST provides the highest precision, 99.4%, followed closely by Kraken at 99%, then Centrifuge at 98.4%. At the genus level, MegaBLAST provides the highest sensitivity at 93.4%, followed by Centrifuge (93.1%) and then by Kraken (90.4%) (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.210641.116/-/DC1">Supplemental Table S2</ext-link>). All three programs had near-perfect precision at the genus level, from 99.6% to 99.9%. Kraken was the fastest program on these data, classifying about 1,062,000 reads per minute (rpm), followed by Centrifuge, which was approximately one-half as fast at 563,000 rpm. MegaBLAST is far slower, processing only 327 rpm.</p>
      <p>As a side note, fast alignment programs such as Bowtie 2 (<xref rid="KIMGR210641C13" ref-type="bibr">Langmead and Salzberg 2012</xref>) and BWA (<xref rid="KIMGR210641C16" ref-type="bibr">Li and Durbin 2009</xref>) can be used for classifying reads, though they were not designed for that purpose. To explore such repurposing, we built a Bowtie 2 index and used Bowtie 2 on the simulated reads. Bowtie 2 is very fast, processing &gt;56,000 reads/minute, but is still only one-tenth as fast as Centrifuge. Bowtie 2 also requires 21 GB of RAM, five times more than required by Centrifuge. Bowtie 2 has classification sensitivity and precision comparable to Centrifuge (e.g., sensitivity of 96.8% and precision of 99.1% at the genus level).</p>
      <p>In addition to the above per-read classification, Centrifuge estimates abundance at various taxonomic ranks. Centrifuge's abundance assessment closely matches the true abundance distribution of genomes in the simulated reads (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.210641.116/-/DC1">Supplemental Fig. S1</ext-link>) at the species level (Pearson's correlation coefficient of 0.919) and the genus level (correlation of 0.986).</p>
    </sec>
    <sec id="s2b">
      <title>Comparison of Centrifuge and Kraken performance on real data sets from sequencing reads of bacterial genomes</title>
      <p>To test our method on real sequencing data sets, we downloaded 530 DNA sequencing data sets from the Sequence Read Archive (SRA). We selected them according to whether the SRA samples had been assigned a taxonomic identifier that belongs to a genus for which we have at least one genome in the database. All of the data sets were generated by whole-genome shotgun projects using recent Illumina platforms; 225 were sequenced on HiSeq and 305 on MiSeq instruments, with mean read lengths of 100 and 218 bp, respectively. <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.210641.116/-/DC1">Supplemental Table S3</ext-link> contains a complete list of the SRA identifiers, taxonomy IDs, number of reads, and classification results. In total, these data contain over 560 million reads, with an average of 1,061,536 reads per sample.</p>
      <p>For this experiment, we compared Centrifuge and Kraken but omitted MegaBLAST because it would take far too long to run. Kraken was chosen as the standard for comparison because it demonstrated superior accuracy over multiple other programs in a recent comparison of metagenomic classifiers (<xref rid="KIMGR210641C18" ref-type="bibr">Lindgreen et al. 2016</xref>).</p>
      <p><xref ref-type="fig" rid="KIMGR210641F3">Figure 3</xref> and <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.210641.116/-/DC1">Supplemental Figure S2</ext-link> show the results for classification sensitivity, accuracy, speed, and memory usage using the database <italic>p</italic> of ∼4300 prokaryotic genomes. On average, Centrifuge had slightly higher sensitivity (0.6% higher) than Kraken. Perhaps due to its use of a longer exact match requirement (31 bases), Kraken had slightly higher precision (2%) than Centrifuge. The lower accuracy of both programs on some data sets may be due to: (1) substantial differences between the genome that we have in the database and the strain that was sequenced; (2) numerous contaminating reads from the host or reagents; or (3) a high sequencing error rate for a particular sample. For example, SRR2225903 is labeled as a strain of <italic>Acinetobacter</italic>, but 85% of the reads are assigned to <italic>Escherichia</italic>. SRR1656428 is labeled as a clinical isolate of <italic>Shigella dysenteriae</italic>, but 92% of the reads are classified as <italic>Klebsiella</italic> (note that for this experiment the taxonomy ID has since been updated by NCBI, but the name has not changed). In other instances (such as SRR1656029 and SRR1655687, labeled as clinical isolates of <italic>Ferrimonas balearica</italic> and <italic>Kytococcus sedentarius</italic>, respectively), we could not match taxonomic IDs to a substantial fraction of the reads, even when searching against the <italic>nt</italic> database. The reads might have come from a species that has no close relative in the database or could not be assigned due to poor quality.</p>
      <fig id="KIMGR210641F3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Results on 530 sequencing data sets from bacterial genomes retrieved from the Sequence Read Archive at NCBI. Each dot represents the results for one genome, with Centrifuge shown in orange and Kraken in teal. The <italic>upper left</italic> plot shows sensitivity, computed as the percentage of reads classified as the correct genus. The <italic>upper right</italic> plot shows precision, computed as the percentage of genus-level classifications made by a program that were correct. The <italic>lower left</italic> plot shows runtime measured in seconds.</p>
        </caption>
        <graphic xlink:href="1721f03"/>
      </fig>
      <p>Overall accuracy for both programs was very similar. Kraken was slightly faster, with an average run time of 39.3 sec per genome, while Centrifuge required 50.9 sec per genome (both using eight cores).</p>
    </sec>
    <sec id="s2c">
      <title>Application of Centrifuge for analyzing samples with Ebola virus and GB virus C co-infections on a desktop</title>
      <p>To demonstrate the speed, sensitivity, and applicability of Centrifuge on a real data set, we used data from the Ebola virus disease (EVD) outbreak. The 2013–2015 EVD outbreak in West Africa cost the lives of over 11,000 people as of August 26, 2015 (WHO Ebola Situation Report, <uri xlink:href="http://apps.who.int/ebola/ebola-situation-reports">http://apps.who.int/ebola/ebola-situation-reports</uri>). In an international effort to research the disease and stop its spread, several groups sequenced the Ebola virus collected from patients’ blood samples and released their data sets online (<xref rid="KIMGR210641C2" ref-type="bibr">Baize et al. 2014</xref>; <xref rid="KIMGR210641C8" ref-type="bibr">Gire et al. 2014</xref>; <xref rid="KIMGR210641C23" ref-type="bibr">Park et al. 2015</xref>). The genomic data were used to trace the disease and mutations in the Ebola genome and inform further public health and research efforts. <xref rid="KIMGR210641C15" ref-type="bibr">Lauck et al. (2015)</xref> reanalyzed one of the data sets (<xref rid="KIMGR210641C8" ref-type="bibr">Gire et al. 2014</xref>) in order to assess the prevalence and effect of GB virus C co-infection on the outcome of EVD.</p>
      <p>We analyzed 130 paired-end sequencing runs from 49 patients reported in <xref rid="KIMGR210641C8" ref-type="bibr">Gire et al. (2014)</xref> using Centrifuge to look for further co-infections. This data set has a total of 97,097,119 reads (26 GB of FASTA files). The accession IDs of these data are provided in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.210641.116/-/DC1">Supplemental Table S4</ext-link>. For this analysis, we used the database <italic>p</italic> + <italic>h</italic> + <italic>v</italic> containing all prokaryotic genomes (compressed), all viral genomes, and the human genome (total index size: 6.9 GB). Running on a desktop computer (quad-core, Intel Core i5-4460 @ 3.2 GHz with 8 GB RAM), Centrifuge completed the analysis of all samples in 47 min with four cores. RNA-sequencing (<xref rid="KIMGR210641C22" ref-type="bibr">Mortazavi et al. 2008</xref>) requires more steps than DNA-sequencing, including the reverse-transcription of RNA to DNA molecules, which introduces sequencing biases and artifacts. In order to handle these additional sources of errors and remove spurious detections, we filtered the results to include only reads that have a matching length of at least 60 bp on the 2 × 100-bp reads.</p>
      <p><xref ref-type="fig" rid="KIMGR210641F4">Figure 4</xref> shows our classification results for the 49 patients. Centrifuge detects between 3853 and 6,781,684 Ebola virus reads per patient. As reported by Lauck et al., we also detected co-infection of Ebola virus and GB virus C in many of the patients. Centrifuge identified at least one read from this virus in 27 of the 49 patients; nine patient samples had 50 or more reads. Nine patients had between one and 10 reads matching the Hepatitis B virus, and in one sample, over 1000 reads aligned uniquely to this virus. This Hepatitis B co-infection has not been reported previously, demonstrating the inherent advantage of using a metagenomics classification tool, which can also detect off-target species.</p>
      <fig id="KIMGR210641F4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>Heat map of the most abundant species in Ebola samples. The color scale encodes species abundance (the number of unique reads normalized by genome size), ranging from yellow (&lt;0.1% of the normalized read count) to red (100%), with white representing an abundance of zero. All species that have a normalized read count over 1% in any of the samples are shown. Zaire ebolavirus dominates the samples; however, there is also a signal for other viruses in some of the patients—namely GB virus C and Hepatitis B virus.</p>
        </caption>
        <graphic xlink:href="1721f04"/>
      </fig>
    </sec>
    <sec id="s2d">
      <title>Application of Centrifuge for analyzing Oxford Nanopore MinION reads of fruitshake using <italic>nt</italic> database</title>
      <p>As a test of Centrifuge's <italic>nt</italic> database, we used it to analyze sequences from a mixture of common fruits and vegetables sequenced using long-read single-molecule technology. The mixture included more than a dozen common foods: grape, blueberry, yam (sweet potato), asparagus, cranberry, lemon, orange, iceberg lettuce, black pepper, wheat (flour), cherry tomato, pear, bread (wheat plus other ingredients), and coffee (beans). The “fruitshake” mixture was blended together, DNA was extracted, and sequencing was run on an Oxford Nanopore MinION. The number of reads generated from the fruitshake sample was 20,809, with lengths ranging from 90 to 13,174 bp and a mean length of 893 bp. Although MinION platforms produce much longer reads than Illumina platforms, MinIONs’ high sequencing error rates (estimated at 15%) (<xref rid="KIMGR210641C10" ref-type="bibr">Jain et al. 2015</xref>) prevent reads from containing long exact matches and increase the chance of noisy and incorrect matches. We initially labeled 8236 reads using Centrifuge. In order to reduce false-positive assignments for these error-prone reads, we filtered out those reads that scored ≤300 and had match lengths ≤50 bp, resulting in 3617 reads ultimately classified. <xref ref-type="table" rid="KIMGR210641TB3">Table 3</xref> shows 14 species to which at least five reads are uniquely assigned, encompassing many of the species included in the sample, such as wheat, tomato, lettuce, grape, barley, and pear. Note that as with any real sample, the true composition of the reads is unknown; we present these results here to illustrate (1) the use of the large <italic>nt</italic> database, and (2) the use of Centrifuge on long, high-error-rate reads. Although apple was not known to be present in the sample, the five reads assigned to apple might have been due to similarity between the apple genome and the pear genome. Twenty-six reads were identified as sheep and eight as cow, which were confirmed separately by BLAST searches. These could represent sample contamination or possibly contaminants in the sheep and cow assemblies. Missing species can be explained either by low abundance in the sample or because their genomes are substantially different from those in the Centrifuge <italic>nt</italic> database.</p>
      <table-wrap id="KIMGR210641TB3" orientation="portrait" position="float">
        <label>Table 3.</label>
        <caption>
          <p>Classification of the fruitshake sample using Centrifuge's <italic>nt</italic> database</p>
        </caption>
        <graphic xlink:href="1721tb03"/>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s3">
    <title>Discussion</title>
    <p>Centrifuge requires a relatively small index for representing and searching ∼4300 prokaryotic genomes, only 4.2 GB, lean enough to fit the memory of a personal desktop. These space-optimized indexing schemes also make it possible to index the NCBI nucleotide sequence database that includes a comprehensive set of sequences collected from viruses, archaea, bacteria, and eukaryotes. Identical sequences have been removed to make it nonredundant, but even after this reduction, the database contains over 36.5 million sequences with a total of ∼109 billion base pairs (Gbp). This rapidly growing database, called <italic>nt</italic>, enables the classification of sequencing data sets from hundreds of plant, animal, and fungal species as well as thousands of viruses and bacteria and many other eukaryotes. Metagenomics projects often include substantial quantities of eukaryotic DNA, and a prokaryotes-only index cannot identify these species.</p>
    <p>The challenge in using a much larger database is the far greater number of unique <italic>k</italic>-mers that must be indexed. For example, using Kraken's default <italic>k</italic>-mer length of 31 bp, the <italic>nt</italic> database contains ∼57 billion distinct <italic>k</italic>-mers. Although it employs several elegant techniques to minimize space, Kraken still requires 12 bytes per <italic>k</italic>-mer, which means it would require an index size of 684 GB for the full <italic>nt</italic> database. Reducing the <italic>k</italic>-mer size helps only slightly: With <italic>k</italic> = 22, Kraken would require an index of 520 GB. Either of these indexes would require a specialized computer with very large main memory.</p>
    <p>Centrifuge's index is based on the space-efficient Burrows-Wheeler transform, and as a result, it requires only 69 GB for the <italic>nt</italic> database, less than the raw sequence itself. BLAST and MegaBLAST are currently the only alternative methods that can classify sequences against the entire <italic>nt</italic> database; thus, we compared Centrifuge with MegaBLAST using our simulated read data, described above. MegaBLAST uses a larger index, requiring 155 GB on disk, but it does not load the entire index into memory and requires only 16 GB of RAM, while Centrifuge requires 69 GB. However, Centrifuge classified reads at a far higher speed: In our experiments on the Mason simulation data, it processed ∼372,000 reads/min, over 3500 times faster than MegaBLAST, which processed only 105 reads/min. Using the much larger <italic>nt</italic> database instead of the prokaryotic database on the Mason simulated reads (<xref ref-type="table" rid="KIMGR210641TB2">Table 2</xref>) does not decrease the classification precision and sensitivity of both programs at the genus level, with Centrifuge's sensitivity only marginally decreasing by 3.2%.</p>
    <p>As the prokaryotic and <italic>nt</italic> databases continue to rapidly expand and provide more comprehensive coverage, further difficulties arise in analyzing sequencing data. For example, two major challenges remain to be addressed in the statistical estimation of abundance (<xref rid="KIMGR210641C19" ref-type="bibr">Lu et al. 2016</xref>). First, the RefSeq database includes many genomes nearly identical to one another, which makes it extremely difficult to distinguish those genomes present in the sample from those that are not. For example, many strains of <italic>Chlamydia trachomatis</italic> are almost identical (&gt;99.99%) to one another (e.g., <italic>Chlamydia trachomatis D/UW-3/CX</italic> and <italic>Chlamydia trachomatis strain Ia/CS190/96</italic>). Second, the microbial taxonomy is sometimes not based on genomic sequence similarity and contains taxonomically misnamed or misplaced species (<xref rid="KIMGR210641C6" ref-type="bibr">Federhen 2015</xref>). Incorrectly positioned species (or strains) can contribute to inaccurate ancestor assignment (e.g., genus or family) in abundance estimations. For example, a genome initially identified as <italic>Anabaena variabilis</italic> ATCC 29413 was reassigned to the genus <italic>Nostoc,</italic> not <italic>Anabaena</italic> (<xref rid="KIMGR210641C28" ref-type="bibr">Thiel et al. 2014</xref>).</p>
    <p>In conclusion, Centrifuge is a rapid and sensitive classifier for microbial sequences with low memory requirements and a speed comparable to the fastest systems. Centrifuge classifies 10 million reads against a database of all complete prokaryotic and viral genomes within 20 min using one CPU core and requiring &lt;8 GB of RAM. Furthermore, Centrifuge can also build an index for NCBI's entire <italic>nt</italic> database of nonredundant sequences from both prokaryotes and eukaryotes. The search requires a computer system with 128 GB of RAM but runs over 3500 times faster than MegaBLAST.</p>
  </sec>
  <sec id="s4">
    <title>Data access</title>
    <p>Centrifuge is available as free, open-source software from <uri xlink:href="https://github.com/infphilo/centrifuge/archive/centrifuge-genome-research.zip">https://github.com/infphilo/centrifuge/archive/centrifuge-genome-research.zip</uri> and provided in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.210641.116/-/DC1">Supplemental Data S1</ext-link>. The fruitshake sequencing data from this study have been submitted to the NCBI BioProject database (<uri xlink:href="http://www.ncbi.nlm.nih.gov/bioproject/">http://www.ncbi.nlm.nih.gov/bioproject/</uri>) under accession number PRJNA343503.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplemental Material</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_26_12_1721__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="supp_gr.210641.116_Supplemental_Data_S1.zip"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_gr.210641.116_Supplemental_Figure_S1.docx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_gr.210641.116_Supplemental_Figure_S2.docx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_gr.210641.116_Supplemental_Methods.docx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="msword" xlink:href="supp_gr.210641.116_Supplemental_Table_S1.docx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="supp_gr.210641.116_Supplemental_Table_S2.xlsx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="supp_gr.210641.116_Supplemental_Table_S3.xlsx"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="vnd.ms-excel" xlink:href="supp_gr.210641.116_Supplemental_Table_S4.xlsx"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We thank Winston Timp and Rachael Workman for generating the fruitshake data from the MinION sequencing platform. This work was supported in part by the National Institutes of Health (NIH) under grants R01-HG006677 and R01-GM083873, by the US Army Research Office under grant W911NF-1410490, and by the National Science Foundation (NSF) under grant ABI-1356078.</p>
    <p><italic>Author contributions:</italic> D.K., L.S., F.P.B., and S.L.S. performed the analysis and discussed the results of Centrifuge. D.K., L.S., and F.P.B. implemented Centrifuge. D.K., F.P.B., L.S., and S.L.S. wrote the manuscript. All authors read and approved the final manuscript.</p>
  </ack>
  <fn-group>
    <fn fn-type="supplementary-material">
      <p>[Supplemental material is available for this article.]</p>
    </fn>
    <fn>
      <p>Article published online before print. Article, supplemental material, and publication date are at <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/doi/10.1101/gr.210641.116">http://www.genome.org/cgi/doi/10.1101/gr.210641.116</ext-link>.</p>
    </fn>
    <fn>
      <p>Freely available online through the <italic>Genome Research</italic> Open Access option.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="KIMGR210641C1">
      <mixed-citation publication-type="journal"><string-name><surname>Amann</surname><given-names>RI</given-names></string-name>, <string-name><surname>Ludwig</surname><given-names>W</given-names></string-name>, <string-name><surname>Schleifer</surname><given-names>KH</given-names></string-name>. <year>1995</year><article-title>Phylogenetic identification and in situ detection of individual microbial cells without cultivation</article-title>. <source>Microbiol Rev</source><volume>59</volume>: <fpage>143</fpage>–<lpage>169</lpage>.<pub-id pub-id-type="pmid">7535888</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C2">
      <mixed-citation publication-type="journal"><string-name><surname>Baize</surname><given-names>S</given-names></string-name>, <string-name><surname>Pannetier</surname><given-names>D</given-names></string-name>, <string-name><surname>Oestereich</surname><given-names>L</given-names></string-name>, <string-name><surname>Rieger</surname><given-names>T</given-names></string-name>, <string-name><surname>Koivogui</surname><given-names>L</given-names></string-name>, <string-name><surname>Magassouba</surname><given-names>N</given-names></string-name>, <string-name><surname>Soropogui</surname><given-names>B</given-names></string-name>, <string-name><surname>Sow</surname><given-names>MS</given-names></string-name>, <string-name><surname>Keita</surname><given-names>S</given-names></string-name>, <string-name><surname>De Clerck</surname><given-names>H</given-names></string-name>, <etal/><year>2014</year><article-title>Emergence of Zaire Ebola virus disease in Guinea</article-title>. <source>N Engl J Med</source><volume>371</volume>: <fpage>1418</fpage>–<lpage>1425</lpage>.<pub-id pub-id-type="pmid">24738640</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C3">
      <mixed-citation publication-type="journal"><string-name><surname>Brady</surname><given-names>A</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name>. <year>2009</year><article-title>Phymm and PhymmBL: metagenomic phylogenetic classification with interpolated Markov models</article-title>. <source>Nat Methods</source><volume>6</volume>: <fpage>673</fpage>–<lpage>676</lpage>.<pub-id pub-id-type="pmid">19648916</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C4">
      <mixed-citation publication-type="journal"><string-name><surname>Brady</surname><given-names>A</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>S</given-names></string-name>. <year>2011</year><article-title>PhymmBL expanded: confidence scores, custom databases, parallelization and more</article-title>. <source>Nat Methods</source><volume>8</volume>: <fpage>367</fpage>.<pub-id pub-id-type="pmid">21527926</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C5">
      <mixed-citation publication-type="book"><string-name><surname>Burrows</surname><given-names>M</given-names></string-name>, <string-name><surname>Wheeler</surname><given-names>DJ</given-names></string-name>. <year>1994</year><source>A block-sorting lossless data compression algorithm</source>. <comment>Technical Report 124</comment><publisher-name>Digital Equipment Corporation</publisher-name>, <publisher-loc>Palo Alto, CA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="KIMGR210641C6">
      <mixed-citation publication-type="journal"><string-name><surname>Federhen</surname><given-names>S</given-names></string-name>. <year>2015</year><article-title>Type material in the NCBI taxonomy database</article-title>. <source>Nucleic Acids Res</source><volume>43</volume>: <fpage>D1086</fpage>–<lpage>D1098</lpage>.<pub-id pub-id-type="pmid">25398905</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C7">
      <mixed-citation publication-type="confproc"><string-name><surname>Ferragina</surname><given-names>P</given-names></string-name>, <string-name><surname>Manzini</surname><given-names>G</given-names></string-name>. <year>2000</year><article-title>Opportunistic data structures with applications</article-title>. In <conf-name>Proceedings of the 41st IEEE symposium on foundations of computer science</conf-name>, <conf-loc>Redondo Beach, CA</conf-loc>.</mixed-citation>
    </ref>
    <ref id="KIMGR210641C8">
      <mixed-citation publication-type="journal"><string-name><surname>Gire</surname><given-names>SK</given-names></string-name>, <string-name><surname>Goba</surname><given-names>A</given-names></string-name>, <string-name><surname>Andersen</surname><given-names>KG</given-names></string-name>, <string-name><surname>Sealfon</surname><given-names>RS</given-names></string-name>, <string-name><surname>Park</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Kanneh</surname><given-names>L</given-names></string-name>, <string-name><surname>Jalloh</surname><given-names>S</given-names></string-name>, <string-name><surname>Momoh</surname><given-names>M</given-names></string-name>, <string-name><surname>Fullah</surname><given-names>M</given-names></string-name>, <string-name><surname>Dudas</surname><given-names>G</given-names></string-name>, <etal/><year>2014</year><article-title>Genomic surveillance elucidates Ebola virus origin and transmission during the 2014 outbreak</article-title>. <source>Science</source><volume>345</volume>: <fpage>1369</fpage>–<lpage>1372</lpage>.<pub-id pub-id-type="pmid">25214632</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C9">
      <mixed-citation publication-type="journal"><collab>Human Microbiome Project Consortium</collab>. <year>2012</year><article-title>A framework for human microbiome research</article-title>. <source>Nature</source><volume>486</volume>: <fpage>215</fpage>–<lpage>221</lpage>.<pub-id pub-id-type="pmid">22699610</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C10">
      <mixed-citation publication-type="journal"><string-name><surname>Jain</surname><given-names>M</given-names></string-name>, <string-name><surname>Fiddes</surname><given-names>IT</given-names></string-name>, <string-name><surname>Miga</surname><given-names>KH</given-names></string-name>, <string-name><surname>Olsen</surname><given-names>HE</given-names></string-name>, <string-name><surname>Paten</surname><given-names>B</given-names></string-name>, <string-name><surname>Akeson</surname><given-names>M</given-names></string-name>. <year>2015</year><article-title>Improved data analysis for the MinION nanopore sequencer</article-title>. <source>Nat Methods</source><volume>12</volume>: <fpage>351</fpage>–<lpage>356</lpage>.<pub-id pub-id-type="pmid">25686389</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C11">
      <mixed-citation publication-type="journal"><string-name><surname>Keller</surname><given-names>M</given-names></string-name>, <string-name><surname>Zengler</surname><given-names>K</given-names></string-name>. <year>2004</year><article-title>Tapping into microbial diversity</article-title>. <source>Nat Rev Microbiol</source><volume>2</volume>: <fpage>141</fpage>–<lpage>150</lpage>.<pub-id pub-id-type="pmid">15040261</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C12">
      <mixed-citation publication-type="journal"><string-name><surname>Kurtz</surname><given-names>S</given-names></string-name>, <string-name><surname>Phillippy</surname><given-names>A</given-names></string-name>, <string-name><surname>Delcher</surname><given-names>AL</given-names></string-name>, <string-name><surname>Smoot</surname><given-names>M</given-names></string-name>, <string-name><surname>Shumway</surname><given-names>M</given-names></string-name>, <string-name><surname>Antonescu</surname><given-names>C</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name>. <year>2004</year><article-title>Versatile and open software for comparing large genomes</article-title>. <source>Genome Biol</source><volume>5</volume>: <fpage>R12</fpage>.<pub-id pub-id-type="pmid">14759262</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C13">
      <mixed-citation publication-type="journal"><string-name><surname>Langmead</surname><given-names>B</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name>. <year>2012</year><article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat Methods</source><volume>9</volume>: <fpage>357</fpage>–<lpage>359</lpage>.<pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C14">
      <mixed-citation publication-type="journal"><string-name><surname>Langmead</surname><given-names>B</given-names></string-name>, <string-name><surname>Trapnell</surname><given-names>C</given-names></string-name>, <string-name><surname>Pop</surname><given-names>M</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name>. <year>2009</year><article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome Biol</source><volume>10</volume>: <fpage>R25</fpage>.<pub-id pub-id-type="pmid">19261174</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C15">
      <mixed-citation publication-type="journal"><string-name><surname>Lauck</surname><given-names>M</given-names></string-name>, <string-name><surname>Bailey</surname><given-names>AL</given-names></string-name>, <string-name><surname>Andersen</surname><given-names>KG</given-names></string-name>, <string-name><surname>Goldberg</surname><given-names>TL</given-names></string-name>, <string-name><surname>Sabeti</surname><given-names>PC</given-names></string-name>, <string-name><surname>O'Connor</surname><given-names>DH</given-names></string-name>. <year>2015</year><article-title>GB virus C coinfections in West African Ebola patients</article-title>. <source>J Virol</source><volume>89</volume>: <fpage>2425</fpage>–<lpage>2429</lpage>.<pub-id pub-id-type="pmid">25473056</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C16">
      <mixed-citation publication-type="journal"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R</given-names></string-name>. <year>2009</year><article-title>Fast and accurate short read alignment with Burrows–Wheeler transform</article-title>. <source>Bioinformatics</source><volume>25</volume>: <fpage>1754</fpage>–<lpage>1760</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C17">
      <mixed-citation publication-type="journal"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R</given-names></string-name>. <year>2010</year><article-title>Fast and accurate long-read alignment with Burrows–Wheeler transform</article-title>. <source>Bioinformatics</source><volume>26</volume>: <fpage>589</fpage>–<lpage>595</lpage>.<pub-id pub-id-type="pmid">20080505</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C18">
      <mixed-citation publication-type="journal"><string-name><surname>Lindgreen</surname><given-names>S</given-names></string-name>, <string-name><surname>Adair</surname><given-names>KL</given-names></string-name>, <string-name><surname>Gardner</surname><given-names>PP</given-names></string-name>. <year>2016</year><article-title>An evaluation of the accuracy and speed of metagenome analysis tools</article-title>. <source>Sci Rep</source><volume>6</volume>: <fpage>19233</fpage>.<pub-id pub-id-type="pmid">26778510</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C19">
      <mixed-citation publication-type="journal"><string-name><surname>Lu</surname><given-names>J</given-names></string-name>, <string-name><surname>Breitwieser</surname><given-names>FP</given-names></string-name>, <string-name><surname>Thielen</surname><given-names>P</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name>. <year>2016</year><article-title>Bracken: estimating species abundance in metagenomics data</article-title>. <source>bioRxiv</source><pub-id pub-id-type="doi">10.1101/051813</pub-id>.</mixed-citation>
    </ref>
    <ref id="KIMGR210641C20">
      <mixed-citation publication-type="journal"><string-name><surname>Luke</surname><given-names>S</given-names></string-name>, <string-name><surname>Cioffi-Revilla</surname><given-names>C</given-names></string-name>, <string-name><surname>Panait</surname><given-names>L</given-names></string-name>, <string-name><surname>Sullivan</surname><given-names>K</given-names></string-name>, <string-name><surname>Balan</surname><given-names>G</given-names></string-name>. <year>2005</year><article-title>MASON: a multiagent simulation environment</article-title>. <source>Simulation</source><volume>81</volume>: <fpage>517</fpage>–<lpage>527</lpage>.</mixed-citation>
    </ref>
    <ref id="KIMGR210641C21">
      <mixed-citation publication-type="journal"><string-name><surname>Marcais</surname><given-names>G</given-names></string-name>, <string-name><surname>Kingsford</surname><given-names>C</given-names></string-name>. <year>2011</year><article-title>A fast, lock-free approach for efficient parallel counting of occurrences of <italic>k</italic>-mers</article-title>. <source>Bioinformatics</source><volume>27</volume>: <fpage>764</fpage>–<lpage>770</lpage>.<pub-id pub-id-type="pmid">21217122</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C22">
      <mixed-citation publication-type="journal"><string-name><surname>Mortazavi</surname><given-names>A</given-names></string-name>, <string-name><surname>Williams</surname><given-names>BA</given-names></string-name>, <string-name><surname>McCue</surname><given-names>K</given-names></string-name>, <string-name><surname>Schaeffer</surname><given-names>L</given-names></string-name>, <string-name><surname>Wold</surname><given-names>B</given-names></string-name>. <year>2008</year><article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>. <source>Nat Methods</source><volume>5</volume>: <fpage>621</fpage>–<lpage>628</lpage>.<pub-id pub-id-type="pmid">18516045</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C23">
      <mixed-citation publication-type="journal"><string-name><surname>Park</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Dudas</surname><given-names>G</given-names></string-name>, <string-name><surname>Wohl</surname><given-names>S</given-names></string-name>, <string-name><surname>Goba</surname><given-names>A</given-names></string-name>, <string-name><surname>Whitmer</surname><given-names>SL</given-names></string-name>, <string-name><surname>Andersen</surname><given-names>KG</given-names></string-name>, <string-name><surname>Sealfon</surname><given-names>RS</given-names></string-name>, <string-name><surname>Ladner</surname><given-names>JT</given-names></string-name>, <string-name><surname>Kugelman</surname><given-names>JR</given-names></string-name>, <string-name><surname>Matranga</surname><given-names>CB</given-names></string-name>, <etal/><year>2015</year><article-title>Ebola virus epidemiology, transmission, and evolution during seven months in Sierra Leone</article-title>. <source>Cell</source><volume>161</volume>: <fpage>1516</fpage>–<lpage>1526</lpage>.<pub-id pub-id-type="pmid">26091036</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C24">
      <mixed-citation publication-type="journal"><string-name><surname>Patro</surname><given-names>R</given-names></string-name>, <string-name><surname>Mount</surname><given-names>SM</given-names></string-name>, <string-name><surname>Kingsford</surname><given-names>C</given-names></string-name>. <year>2014</year><article-title>Sailfish enables alignment-free isoform quantification from RNA-seq reads using lightweight algorithms</article-title>. <source>Nat Biotechnol</source><volume>32</volume>: <fpage>462</fpage>–<lpage>464</lpage>.<pub-id pub-id-type="pmid">24752080</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C25">
      <mixed-citation publication-type="journal"><string-name><surname>Pruitt</surname><given-names>KD</given-names></string-name>, <string-name><surname>Brown</surname><given-names>GR</given-names></string-name>, <string-name><surname>Hiatt</surname><given-names>SM</given-names></string-name>, <string-name><surname>Thibaud-Nissen</surname><given-names>F</given-names></string-name>, <string-name><surname>Astashyn</surname><given-names>A</given-names></string-name>, <string-name><surname>Ermolaeva</surname><given-names>O</given-names></string-name>, <string-name><surname>Farrell</surname><given-names>CM</given-names></string-name>, <string-name><surname>Hart</surname><given-names>J</given-names></string-name>, <string-name><surname>Landrum</surname><given-names>MJ</given-names></string-name>, <string-name><surname>McGarvey</surname><given-names>KM</given-names></string-name>, <etal/><year>2014</year><article-title>RefSeq: an update on mammalian reference sequences</article-title>. <source>Nucleic Acids Res</source><volume>42</volume>: <fpage>D756</fpage>–<lpage>D763</lpage>.<pub-id pub-id-type="pmid">24259432</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C26">
      <mixed-citation publication-type="journal"><string-name><surname>Rosen</surname><given-names>G</given-names></string-name>, <string-name><surname>Garbarine</surname><given-names>E</given-names></string-name>, <string-name><surname>Caseiro</surname><given-names>D</given-names></string-name>, <string-name><surname>Polikar</surname><given-names>R</given-names></string-name>, <string-name><surname>Sokhansanj</surname><given-names>B</given-names></string-name>. <year>2008</year><article-title>Metagenome fragment classification using <italic>N</italic>-mer frequency profiles</article-title>. <source>Adv Bioinformatics</source><volume>2008</volume>: <fpage>205969</fpage>.<pub-id pub-id-type="pmid">19956701</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C27">
      <mixed-citation publication-type="journal"><string-name><surname>Schloss</surname><given-names>PD</given-names></string-name>, <string-name><surname>Handelsman</surname><given-names>J</given-names></string-name>. <year>2004</year><article-title>Status of the microbial census</article-title>. <source>Microbiol Mol Biol Rev</source><volume>68</volume>: <fpage>686</fpage>–<lpage>691</lpage>.<pub-id pub-id-type="pmid">15590780</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C28">
      <mixed-citation publication-type="journal"><string-name><surname>Thiel</surname><given-names>T</given-names></string-name>, <string-name><surname>Pratte</surname><given-names>BS</given-names></string-name>, <string-name><surname>Zhong</surname><given-names>J</given-names></string-name>, <string-name><surname>Goodwin</surname><given-names>L</given-names></string-name>, <string-name><surname>Copeland</surname><given-names>A</given-names></string-name>, <string-name><surname>Lucas</surname><given-names>S</given-names></string-name>, <string-name><surname>Han</surname><given-names>C</given-names></string-name>, <string-name><surname>Pitluck</surname><given-names>S</given-names></string-name>, <string-name><surname>Land</surname><given-names>ML</given-names></string-name>, <string-name><surname>Kyrpides</surname><given-names>NC</given-names></string-name>, <etal/><year>2014</year><article-title>Complete genome sequence of <italic>Anabaena variabilis</italic> ATCC 29413</article-title>. <source>Stand Genomic Sci</source><volume>9</volume>: <fpage>562</fpage>–<lpage>573</lpage>.<pub-id pub-id-type="pmid">25197444</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C29">
      <mixed-citation publication-type="journal"><string-name><surname>Trapnell</surname><given-names>C</given-names></string-name>, <string-name><surname>Williams</surname><given-names>BA</given-names></string-name>, <string-name><surname>Pertea</surname><given-names>G</given-names></string-name>, <string-name><surname>Mortazavi</surname><given-names>A</given-names></string-name>, <string-name><surname>Kwan</surname><given-names>G</given-names></string-name>, <string-name><surname>van Baren</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name>, <string-name><surname>Wold</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L</given-names></string-name>. <year>2010</year><article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>. <source>Nat Biotechnol</source><volume>28</volume>: <fpage>511</fpage>–<lpage>515</lpage>.<pub-id pub-id-type="pmid">20436464</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C30">
      <mixed-citation publication-type="journal"><string-name><surname>Wood</surname><given-names>DE</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name>. <year>2014</year><article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol</source><volume>15</volume>: <fpage>R46</fpage>.<pub-id pub-id-type="pmid">24580807</pub-id></mixed-citation>
    </ref>
    <ref id="KIMGR210641C31">
      <mixed-citation publication-type="journal"><string-name><surname>Zhang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Schwartz</surname><given-names>S</given-names></string-name>, <string-name><surname>Wagner</surname><given-names>L</given-names></string-name>, <string-name><surname>Miller</surname><given-names>W</given-names></string-name>. <year>2000</year><article-title>A greedy algorithm for aligning DNA sequences</article-title>. <source>J Comput Biol</source><volume>7</volume>: <fpage>203</fpage>–<lpage>214</lpage>.<pub-id pub-id-type="pmid">10890397</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
