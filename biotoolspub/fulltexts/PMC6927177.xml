<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6927177</article-id>
    <article-id pub-id-type="publisher-id">1915</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1915-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RADAR: differential analysis of MeRIP-seq data with a random effect model</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Zijie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhan</surname>
          <given-names>Qi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Eckert</surname>
          <given-names>Mark</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Allen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chryplewicz</surname>
          <given-names>Agnieszka</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>De Jesus</surname>
          <given-names>Dario F.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ren</surname>
          <given-names>Decheng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kulkarni</surname>
          <given-names>Rohit N.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lengyel</surname>
          <given-names>Ernst</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>He</surname>
          <given-names>Chuan</given-names>
        </name>
        <address>
          <email>chuanhe@uchicago.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1579-087X</contrib-id>
        <name>
          <surname>Chen</surname>
          <given-names>Mengjie</given-names>
        </name>
        <address>
          <email>mengjiechen@uchicago.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7822</institution-id><institution-id institution-id-type="GRID">grid.170205.1</institution-id><institution>Department of Chemistry and Institute for Biophysical Dynamics, </institution><institution>The University of Chicago, </institution></institution-wrap>Chicago, IL 60637 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7822</institution-id><institution-id institution-id-type="GRID">grid.170205.1</institution-id><institution>Department of Biochemistry and Molecular Biology and Institute for Biophysical Dynamics, </institution><institution>The University of Chicago, </institution></institution-wrap>Chicago, IL 60637 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7822</institution-id><institution-id institution-id-type="GRID">grid.170205.1</institution-id><institution>Howard Hughes Medical Institute, </institution><institution>The University of Chicago, </institution></institution-wrap>Chicago, IL 60637 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7822</institution-id><institution-id institution-id-type="GRID">grid.170205.1</institution-id><institution>Section of Genetic Medicine, Department of Medicine, </institution><institution>The University of Chicago, </institution></institution-wrap>Chicago, IL 60637 USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7822</institution-id><institution-id institution-id-type="GRID">grid.170205.1</institution-id><institution>Department of Human Genetics, </institution><institution>The University of Chicago, </institution></institution-wrap>Chicago, IL 60637 USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7822</institution-id><institution-id institution-id-type="GRID">grid.170205.1</institution-id><institution>Section of Gynecologic Oncology, Department of Obstetrics and Gynecology, </institution><institution>The University of Chicago, </institution></institution-wrap>Chicago, IL 60637 USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution>Section of Islet Cell and Regenerative Biology, </institution><institution>Joslin Diabetes Center and Harvard Medical School, </institution></institution-wrap>Boston, MA 02215 USA </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 7822</institution-id><institution-id institution-id-type="GRID">grid.170205.1</institution-id><institution>Section of Endocrinology, Diabetes &amp; Metabolism, Department of Medicine, </institution><institution>The University of Chicago, </institution></institution-wrap>Chicago, IL 60637 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>294</elocation-id>
    <history>
      <date date-type="received">
        <day>4</day>
        <month>8</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>12</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Epitranscriptome profiling using MeRIP-seq is a powerful technique for in vivo functional studies of reversible RNA modifications. We develop RADAR, a comprehensive analytical tool for detecting differentially methylated loci in MeRIP-seq data. RADAR enables accurate identification of altered methylation sites by accommodating variability of pre-immunoprecipitation expression level and post-immunoprecipitation count using different strategies. In addition, it is compatible with complex study design when covariates need to be incorporated in the analysis. Through simulation and real dataset analyses, we show that RADAR leads to more accurate and reproducible differential methylation analysis results than alternatives, which is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/scottzijiezhang/RADAR">https://github.com/scottzijiezhang/RADAR</ext-link>.</p>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd><italic>N</italic><sup>6</sup>-adenosine methylation (m<sup>6</sup>A)</kwd>
      <kwd>Differential methylation</kwd>
      <kwd>MeRIP-seq</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM126553</award-id>
        <award-id>RM1 HG008935</award-id>
        <award-id>R01 DK67536</award-id>
        <award-id>UC4 DK116278</award-id>
        <principal-award-recipient>
          <name>
            <surname>Kulkarni</surname>
            <given-names>Rohit N.</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Chuan</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Mengjie</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000879</institution-id>
            <institution>Alfred P. Sloan Foundation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Chan Zuckerberg Initiative</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000011</institution-id>
            <institution>Howard Hughes Medical Institute</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">The RNA epigenetics gold rush in the past few years has brought reversible RNA modifications into the spotlight as an important mechanism of gene regulation. Particularly, <italic>N</italic><sup>6</sup>-adenosine methylation (m<sup>6</sup>A), the most abundant modification on mRNA, has drawn extensive attention due to its important functions in various biological systems [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. Methylated RNA immunoprecipitation sequencing (MeRIP-seq) [<xref ref-type="bibr" rid="CR4">4</xref>–<xref ref-type="bibr" rid="CR6">6</xref>] is a key technique used in mRNA modification studies that has enabled us to survey the epitranscriptome using various study designs: (1) identifying the location of modification on the transcript by performing peak calling on MeRIP-seq samples of certain phenotype or experimental condition and (2) identifying differentially methylated loci by comparing MeRIP-seq samples across different phenotypical or experimental groups. These analyses connect mRNA modifications with phenotypes and have the great potential to reveal its functional consequences.</p>
    <p id="Par3">Early studies performing qualitative analysis compared peaks called in one experimental group versus peaks in another group and identified peaks unique to each experimental group as differentially methylated peaks. However, many differential peaks identified by this method are caused by boundary cases at the peak-detection threshold rather than true presence/absence of peaks as noted in a recent study [<xref ref-type="bibr" rid="CR7">7</xref>]. To enable cross-group comparisons, a few methods have been developed and applied to analyze differential methylation in MeRIP-seq data [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>]. ExomePeak uses Fisher’s exact test for differential methylation identifications, and its later version uses a likelihood ratio test based on the binomial distribution (termed “bltest”) [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. MeTPeak uses a beta-binomial model to infer differential peaks [<xref ref-type="bibr" rid="CR8">8</xref>]. DRME and its improved version—QNB—use a model based on the negative binomial distribution [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>].</p>
    <p id="Par4">While existing methods have yielded promising results, they also have important drawbacks: (1) Current methods [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>] designed for small sample size scenario ignore the existence of confounding factors and cannot accommodate complex study designs with covariates (such as age and gender) that are frequently encountered in patient or animal studies with larger sample sizes. (2) Most of the differential gene expression (DE) analysis tools such as edgeR, DESeq2, and Sleuth [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR15">15</xref>] are compatible with complex study designs. But they rely on models developed for RNA-seq experiment and cannot accommodate unique features of MeRIP-seq data. A standard MeRIP-seq experiment yields an INPUT and an Immunoprecipitation (IP) library for each sample. The INPUT library is the initial RNA fragments pool prior to the antibody pull-down—a measurement of RNA expression level. The IP library represents the RNA fragments carrying modified bases captured by antibody pull-down—a measurement of methylated RNA abundance. RNA differential methylation (DM) is defined as the alteration of methylated RNA abundance conditioning on the RNA expression background. Thus, DM analysis requires assessment of RNA methylation change based on pre-IP and post-IP measurements in pairs. In contrast, DE analysis tools only compare a single read count measurement across samples. (3) Current MeRIP-seq-specific tools [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR11">11</xref>] use peak (~ 250 bp) read counts in the INPUT library as measurement of RNA expression for a gene (~ 11 kb). However, the variability in a small genomic range across samples due to the sparsity of reads sampled can result in unwanted variation to the expression level estimation if using local read counts. QNB combines local read counts of both INPUT and IP as an estimator of the expression level to mitigate this problem. However, incorporating IP read counts can cofound pre-IP expression level with post-IP RNA abundance, leading to biased estimation of expression level. Inaccurate expression level measurement can lead to substantial false discoveries in the subsequent DM analysis. Thus, the utilization of INPUT library to account for pre-IP RNA expression level needs to be further optimized.</p>
    <p id="Par5">To combat these challenges and allow for accurate identification of differentially methylated loci, we present a novel approach to perform <italic>R</italic>NA methyl<italic>A</italic>tion <italic>D</italic>ifferential <italic>A</italic>nalysis in <italic>R</italic> (<italic>RADAR</italic>) for MeRIP-seq data. RADAR accounts for variation in pre-IP RNA and in post-IP read counts using different strategies. Specifically, RADAR uses gene-level read counts instead of peak-level read counts in the INPUT library as a robust measurement of the initial pre-IP RNA expression level. In addition, RADAR uses a flexible Poisson random effect model to accommodate over-dispersion in the post-IP read counts due to variability of biological replicates and noise introduced in the immunoprecipitation process. This generalized linear model framework enables incorporation of covariates in complex study designs.</p>
    <p id="Par6">We benchmarked the performance of RADAR with alternative methods on simulated data by different data generating models. We showed RADAR achieved higher sensitivity and specificity compared to existing alternative methods. We also demonstrated the performance of RADAR on real MeRIP-seq data by applying it to four high-quality m<sup>6</sup>A-meRIP-seq (aka m<sup>6</sup>A-seq) datasets generated by us and others, including an ovarian cancer dataset (GSE 119168) consisting of 7 normal fallopian tube tissue from healthy individuals and 6 metastatic omental tumors, a type 2 diabetes (T2D, GSE 120024) dataset consisting of human islets from 8 type II diabetes patients and 7 healthy control patients with samples being processed in three batches due to different sample acquisition times, a mouse liver (GSE 119490) dataset consisting of mouse liver from 4 wild type mice and 4 METTL14 knockout mice, and a mouse brain (GSE 113781) dataset consisting of 7 mouse cortex samples of stress-exposed mice and 7 from control mice. We showed that our approach can accommodate distinct study designs and led to more sensitive and reproducible DM locus identification than possible alternatives.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>RADAR overcomes challenges in modeling MeRIP-seq data and accommodates complex study designs</title>
      <p id="Par7">Using BAM files as the input, RADAR first divides transcripts (concatenated exons) into 50-bp consecutive bins and quantifies pre-IP and post-IP read counts for each bin (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Unlike current differential methylation analysis methods [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>] that scale to library sizes as a way of normalization, which can be strongly skewed by highly expressed genes [<xref ref-type="bibr" rid="CR16">16</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1), RADAR uses the median-of-ratio method [<xref ref-type="bibr" rid="CR17">17</xref>] implemented in DEseq2 to normalize the INPUT library for the sake of robustness. For the IP library, RADAR normalizes the fold enrichment computed from the IP counts divided by the INPUT counts, which takes both IP efficiency and IP library size variation into account.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Unique features of m<sup>6</sup>A-seq (MeRIP-seq) data. RADAR divides concatenated exons of a gene into consecutive bins and models the immunoprecipitation (IP)-enriched read counts in such bins. <bold>a</bold> depicts a pair of read counts in the INPUT and the IP library in the <italic>i</italic>th bin as <italic>c</italic><sub><italic>i</italic></sub> and <italic>t</italic><sub><italic>i</italic></sub>. In the RADAR workflow, the gene-level read count of the input library <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {s}_{i\in {\mathrm{gene}}_m} $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mtext>gene</mml:mtext><mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1915_Article_IEq1.gif"/></alternatives></inline-formula> substitutes the bin-level read count <italic>c</italic><sub><italic>i</italic></sub> as the representation of the pre-IP RNA levels of the <italic>i</italic>th bin. <bold>b</bold> compares the relative variation of gene-level and bin-level (local) read counts of different bin sizes in four m<sup>6</sup>A-seq datasets, suggesting that unwanted variation can be reduced using gene-level counts as the estimates of pre-IP RNA levels. Panel <bold>c</bold> compares the cross-sample mean and variance of regular RNA-seq (pre-IP counts) and m<sup>6</sup>A-seq (post-IP read counts adjusted for pre-IP RNA level variation) data in four m<sup>6</sup>A-seq datasets. The fitted curvature of m<sup>6</sup>A-seq can differ from that of RNA-seq, indicating that m<sup>6</sup>A-seq may have a different mean-variance relationship from RNA-seq. Biological and experimental confounding factors are often encountered in patient samples. <bold>d</bold> shows the first two principal components (PCs) of m<sup>6</sup>A enrichment in each dataset, where the samples are colored by covariates that need to be accounted for. m<sup>6</sup>A enrichment was represented by IP sample read counts adjusted for pre-IP (INPUT) RNA-level variation. <bold>e</bold> shows the first two PCs after regressing out known covariates—age in the ovarian cancer dataset and batch in the T2D dataset. After regressing out the covariate, samples are separated by disease conditions on the PCA plot</p></caption><graphic xlink:href="13059_2019_1915_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par8">After proper normalization across all samples, RADAR then calculates the methylation level for each bin conditioned on its pre-IP RNA expression level for each sample. In contrast to previous methods [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>] that use peak-level read counts in the INPUT library as its measurement of pre-IP RNA expression level, we use gene-level read counts as a more robust representation, which is defined as the total number of reads across all bins that span the same gene (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). This choice is motivated by the observation that the median read coverage within each peak is very low—18 reads per peak (7 reads in a 50-bp bin) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2) in a typical MeRIP-seq input sample of 20 million (mappable) reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3). Over-dispersion of low counts due to random sampling in the sequencing process can introduce substantial unwanted variation to the estimation of pre-IP RNA level. This can be further exacerbated by the uneven distribution of reads caused by local sequence characteristics such as GC content and mappability. Using gene-level counts as the estimate of pre-IP RNA expression level can mitigate the dispersion by increasing the number of reads (272 reads on average) and simultaneously diminishing the effects of sequence characteristics within a gene (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). By comparing the variance of read counts across replicates at the gene level with that at the bin level, we show that the cross-sample variance is much less at the gene level than at the bin level in all three datasets (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b).</p>
      <p id="Par9">RADAR models the read count distribution using a Poisson random effect model instead of a negative binomial distribution, which is commonly used in RNA-seq analysis [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR17">17</xref>] as well as in DRME and QNB for MeRIP-seq analysis [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. Negative binomial distribution-based models assume a quadratic relationship between mean read counts and their variance across all genes. We observe in real m<sup>6</sup>A-seq datasets that the mean-variance relationship of post-IP counts across genes significantly differs from that of regular RNA-seq counts (i.e., pre-IP counts). The former does not always follow a similar quadratic curvature and can exhibit very different patterns of variability (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). To overcome these limitations, RADAR applies a more flexible generalized linear model framework (see the “<xref rid="Sec10" ref-type="sec">Material and methods</xref>” section) that captures variability through random effects.</p>
      <p id="Par10">Another important advancement of RADAR, compared to existing MeRIP-seq data analysis tools [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>], is the flexibility to incorporate covariates and permit more complex study design. Phenotypic covariates such as age and gender as well as experimental covariates such as batch information are often encountered in epitranscriptomic profiling studies with heterogenous patient samples. Covariates such as litter and age are common in experimental animal studies. For example, in the ovarian cancer dataset, the age of the tissue donors is partially confounded with predictor variable—disease status. In the T2D islets dataset, the variance of the first two principal components is confounded with the sequencing batch (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d). After regressing out the batch effect, the remaining variance can be better explained by disease status (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e). This indicates the importance of controlling for potential confounding factors when performing differential methylation tests. The generalized linear model framework in RADAR allows the inclusion of covariates and offers support for complex study designs.</p>
    </sec>
    <sec id="Sec4">
      <title>Comparative benchmarks of different methods using simulated datasets</title>
      <p id="Par11">To evaluate the performance of RADAR in comparison to current methods, we applied RADAR and other methods for MeRIP-seq differential analysis including exomePeak, Fisher’s exact test, MeTDiff, and QNB on simulated datasets. We considered four scenarios: the proposed random effect model with/without covariates and the quad-negative binomial (QNB) model adopted from QNB [<xref ref-type="bibr" rid="CR9">9</xref>, <xref ref-type="bibr" rid="CR10">10</xref>] with/without covariates. For each scenario, we evaluated the sensitivity and false discovery rate (FDR) of different methods using ten simulated copies. We first simulated a dataset of eight samples using the random effect model (“<xref rid="Sec10" ref-type="sec">Materials and method</xref>” section Eq. (1), denoted as the simple case). The INPUT library was directly drawn from the T2D dataset. We simulated IP read count adjusted for pre-IP expression level of each bin according to Eq. (1) where <italic>μ</italic> is equal to mean log read count in the “control” group of T2D dataset. The final IP read counts were obtained by rescaling simulated data by the average IP/INPUT ratio observed in the T2D data. In total, we simulated three datasets of 26,324 sites in which 20% of sites are true positives with effect sizes of 0.5, 0.75, or 1, respectively.</p>
      <p id="Par12">For DM loci with an effect size of 0.5, RADAR achieved 29.1% sensitivity and 12.0% FDR at an FDR cutoff of 10%. At the same cutoff, exomePeak and Fisher’s test achieved 72.8% sensitivity/52.5% FDR and 72.2% sensitivity/50.5% FDR, respectively. MeTDiff achieved 10.5% sensitivity and 16.2% FDR. QNB, on the contrary, did not own any power for the small effect size. When the effect size increased, RADAR achieved much higher sensitivity, 77.8% for an effect size of 0.75 and 95.7% for an effect size of 1, while FDR were well calibrated at 10.4% and 10.1%, respectively. exomePeak and Fisher’s test both achieved 89% and 96% sensitivity for effect sizes of 0.75 and 1, respectively, but at the cost of unsatisfactory FDRs, which were greater than 46%. MeTPeak exhibited well-calibrated FDR (12.3% and 11.4%) and moderate sensitivity of 50.4% and 81.5% for effect sizes of 0.75 and 1, respectively. QNB only had low power for an effect size of 1 (beta = 1, 13.9% sensitivity and 0.5% FDR). Overall, for the simple case without covariates, RADAR achieved high sensitivity while maintained low FDR at varying true effect sizes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). We then applied the above analysis at varying FDR cutoff and found RADAR achieved the highest sensitivity at a fixed level of empirical FDR (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5A). We note exomePeak and Fisher’s test achieved high sensitivity at all effect sizes as combining read counts across replicates of the same group helped to gain power. As a tradeoff, failing to account for within-group variability resulted in high FDR. On the contrary, RADAR and MeTDiff exhibited well-calibrated FDR while achieved high sensitivity at same levels as exomePeak for large effect sizes. QNB was overconservative and possessed little power.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Benchmarking RADAR on two simulation models. We benchmarked RADAR and other alternative methods on simulated data. Using two simulation models—a random effect (RADAR) model and a quad-negative-binomial (QNB) model, we simulated dataset of eight replicates of varying true effect sizes (0.5, 0.75, and 1) with and without covariates. We tested different methods on simulated dataset and compared the results at an FDR cutoff of 0.1 with simulated true sites. We show the sensitivity (fraction of true sites detected by the method at an FDR cutoff of 0.1) and false discovery rate (fraction of detected differential sites that are not true sites) of each method applied on data simulated by the random effect model without covariates (<bold>a</bold>) and with covariates (<bold>b</bold>) and the quad-negative-binomial model without covariates (<bold>c</bold>) and with covariates (<bold>d</bold>), respectively. The FDR cutoff used to select DM sites is labeled by a dashed line</p></caption><graphic xlink:href="13059_2019_1915_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par13">We next applied the aforementioned methods to the proposed model with a covariate (effect size equal to 2, denoted as the difficult case) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). As a result, at an FDR cutoff of 10%, RADAR achieved 38.4%, 79.7%, and 95.7% sensitivity with empirical FDRs slightly higher than those in the simple case (18.2%, 14.4%, and 13.7% for effect sizes of 0.5, 0.75, and 1, respectively). MeTDiff, with similar performance as RADAR in the simple case, lost power in the difficult case due to incapability of accounting for confounding factors. exomePeak, Fisher’s test, and QNB behaved similarly as in the simple case. The advantage of RADAR over other methods is robust to the choice of FDR cutoff as shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5B. In summary, RADAR outperformed existing alternatives in both cases.</p>
      <p id="Par14">Taking the covariate model with a DM effect size of 0.75 as an example, we also checked the distributions of effect size estimates and <italic>p</italic> values obtained from each method. In all methods, effect sizes were overall correctly estimated with estimates for “true” sites centered at 0.75 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6A) and that for null sites centered at zero (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6B). However, we note the distribution of beta estimates is narrower for RADAR, especially in the difficult case, suggesting a more confident estimation. <italic>p</italic> values of exomePeak and Fisher’s test at null sites were enriched near zero, indicating over-detection of false-positive signals (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6C). We also observed many large <italic>p</italic> values obtained by QNB for “true” sites in both cases and MeTDiff in the difficult case, which suggested a high false-negative rate (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S6D).</p>
      <p id="Par15">We then repeated simulation studies using the QNB model. Instead of setting the variances of INPUT and IP libraries equal as presented in the QNB paper, we let the variance of IP read count be larger than that of INPUT. This setting better reflects our observation in the real data as extra noise can be introduced during immunoprecipitation process for IP reads generation (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). In the simple case without covariates, RADAR exhibited the lowest empirical FDR (18.9% and 18.5%) despite slightly lower sensitivity comparing to other methods (73.5% and 82.3%) when the effect sizes were relatively large (for effect sizes of 0.75 and 1). QNB performed better when the effect size was small with 58.6% sensitivity and 15.6% FDR for an effect size of 0.5 (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). The results were consistent when we evaluated their performance with different FDR cutoffs. Overall, QNB performed slightly better than RADAR with an effect size of 0.5. RADAR achieved similar sensitivity but better calibrated FDR when effect sizes equal to 0.75 and 1 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5C). In the model with covariates, RADAR exhibited the lowest empirical FDR, with 25.8%, 23.0%, and 22.5% at effect sizes of 0.5, 0.75, and 1, respectively, while other methods either failed to detect the signal or had a higher empirical FDR. Specifically, MeTDiff had sensitivity below 0.5% at varying effect sizes and QNB reached FDRs of 64.1%, 55.8%, and 50.5% for effect sizes of 0.5, 0.75, and 1, respectively, at an FDR cutoff of 10% (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). The advantage of RADAR over alternative methods hold in the difficult case at varying cutoffs (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5D). In summary, RADAR outperformed other existing methods in most scenarios, particularly when covariates were present.</p>
    </sec>
    <sec id="Sec5">
      <title>Comparative benchmarks of different methods using four real m<sup>6</sup>A-seq datasets</title>
      <p id="Par16">Next, we compared the performance of different methods using four real m<sup>6</sup>A-seq datasets: ovarian cancer (GSE119168), T2D (GSE120024), mouse liver (GSE119490), and mouse brain (GSE113781). To evaluate the sensitivity of different methods, we first checked the distributions of <italic>p</italic> values obtained from corresponding DM tests (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). In the ovarian cancer, T2D, and mouse liver data, Fisher’s test and exomePeak detected the most signals as the <italic>p</italic> values are most dense near zero. In these three datasets, RADAR also returned a desirable shape for the <italic>p</italic> value histogram in which <italic>p</italic> values were enriched near zero while uniformly distributed elsewhere. MeTDiff returned a desired shape only in the ovarian cancer and mouse liver datasets. QNB were overconservative in the ovarian cancer and T2D dataset. All methods failed to return enriched <italic>p</italic> values near zero for the mouse brain dataset, suggesting there was no or little signal in this dataset. This is consistent with the original publication that very few differential peaks were detected in this study [<xref ref-type="bibr" rid="CR7">7</xref>].
<fig id="Fig3"><label>Fig. 3</label><caption><p>Sensitivity of benchmarked methods on real m<sup>6</sup>A-seq data. We benchmarked RADAR and other alternative methods on four m<sup>6</sup>A-seq data with different characteristics. Each panel shows the histogram of <italic>p</italic>-values obtained from DM tests using RADAR, MeTDiff, QNB, Fisher’s exact test and exomePeak on each dataset, respectively</p></caption><graphic xlink:href="13059_2019_1915_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par17">To ensure that well-performed methods achieved high sensitivity while maintaining a low FDR, we further performed permutation analyses to obtain the null distribution of <italic>p</italic> values for each dataset. Specifically, we shuffled the phenotype labels of samples such that the new labels were not associated with the true ones or any other important confounding factors. We expected the <italic>p</italic> values from a permutation test to follow a uniform distribution and the enriched <italic>p</italic> values near zero would be considered as false discoveries. For each dataset, we combined test statistics from 15 permuted copies and compared their distribution with the original tests (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). <italic>p</italic> values from Fisher’s test and exomePeak were strongly enriched near zero and only slightly lower than those from the original tests. This suggests the strong signals detected by these two methods are likely to be false discoveries, consistent with the conclusion from simulation analysis. On the contrary, the histograms of <italic>p</italic> values from RADAR were close to flat in all datasets, indicating that strong signals detected by RADAR were more likely to be true. MeTDiff exhibited well-calibrated <italic>p</italic> values in the ovarian cancer and T2D data but enriched for small <italic>p</italic> values in the mouse liver data with an indicated high FDR. QNB test returned conservative <italic>p</italic> value estimates in all datasets. Taking together these analyses, we demonstrated that RADAR outperforms the alternatives by achieving high sensitivity and specificity simultaneously in real datasets.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Benchmarking false-positive signals using permutation analysis on real m<sup>6</sup>A-seq data. To assess empirical FDR of the test, we permuted the phenotype labels of samples so that the new labels were not associated with true ones. Each panel shows the histograms of <italic>p</italic> values obtained from DM tests on 15 permuted copies (blue) and those from the tests on the original dataset (red)</p></caption><graphic xlink:href="13059_2019_1915_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par18">To better demonstrate that RADAR detects DM sites with better sensitivity and specificity in real data, we show examples of DM site that is only detected by RADAR as well as likely false discovery sites identified by exomePeak and Fisher’s test but not by RADAR in the T2D dataset. We plot sequence coverage of individual samples for the DM sites in the RNF213 gene (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7A) and show despite large variability in control samples, m<sup>6</sup>A enrichment of T2D samples is consistently lower on this locus. Conversely, in the bogus DM sites detected by alternative methods (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7B, C), enrichment differences are mainly driven by one or two outlier samples in one group.</p>
      <p id="Par19">To further demonstrate the advantage of using gene-level read counts over local read counts to account for RNA expression level, we repeated the above analysis using post-IP counts adjusted by the local read counts of INPUT. We showed that in the T2D dataset, gene-level adjustment not only enabled stronger signal detection, but also lowered FDR as we observed that the permutation analysis using local count adjustment resulted in undesired stronger signals around zero in the <italic>p</italic> value histogram (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8). In the ovarian cancer and the mouse liver datasets, local count adjustment achieved higher signal detection but at the cost of a higher FDR. This analysis suggested that using gene-level read counts as the estimates of pre-IP RNA expression levels could effectively reduce FDR and lead to more accurate DM locus detections.</p>
      <p id="Par20">Attributed to the robust representation of pre-IP RNA expression level using gene-level read counts, RADAR’s performance is more robust to the sequencing depth of INPUT samples. To demonstrate this, we applied RADAR on data created by sub-sampling the read counts of INPUT samples in the T2D dataset so that the sequencing depth is half of the full dataset (average 17.5 million reads). We compared the DM sites detected in the reduced dataset with the results obtained from the full dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9A). Using a 10% FDR cutoff, RADAR-detected DM sites in the reduced dataset showed the highest overlap with that in the full dataset. MeTDiff and QNB only had a few overlapping DM sites between the sub-sampled and full dataset. Fisher’s test and exomePeak had slightly fewer overlaps comparing to RADAR but had more false discoveries. We further compared the log fold change (logFC) estimates from reduced and full datasets to check their consistency. As a result, we found reduced sequencing depth had the least impact on the logFC estimated by RADAR while the estimates by others are much less reproducible with a shallower sequencing depth (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9A).</p>
      <p id="Par21">Unlike earlier pipelines that perform DM tests only on peaks identified from peak calling, RADAR directly tests on all filtered bins and reports DM sites. To check if the DM sites reported by RADAR are consistent with known characteristics of m<sup>6</sup>A, we performed de novo motif search on these sites and found DM sites detected in ovarian cancer, mouse liver, and T2D datasets are enriched for known m<sup>6</sup>A consensus motif (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10A) [<xref ref-type="bibr" rid="CR18">18</xref>], suggesting DM sites reported by RADAR are mostly true. We also examined the topological distribution of these DM sites by metagene analysis (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10B). The distributions in ovarian cancer and mouse liver datasets are consistent with the topological distribution of common m<sup>6</sup>A sites, indicating methylation changes that occurred in these two datasets were not spatially biased. Interestingly, DM sites detected in T2D dataset are strongly enriched at 5′UTR, suggesting T2D-related m<sup>6</sup>A alteration are more likely to occur at 5′UTR.</p>
    </sec>
    <sec id="Sec6">
      <title>RADAR analyses of m<sup>6</sup>A-seq data connect phenotype with m<sup>6</sup>A-modulated molecular mechanisms</title>
      <p id="Par22">Finally, we investigated whether DM test results obtained from RADAR would lead to better downstream interpretation. In the ovarian cancer dataset, we performed KEGG pathway enrichment analysis on the differential methylated genes (DMGs) detected by RADAR (Fig. <xref rid="Fig5" ref-type="fig">5</xref>a). We found the detected DMGs were enriched with molecular markers related to ovarian cancer dissemination [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. For instance, we identified key regulators of the PI3K (enrichment <italic>p</italic> value 7.8 × 10<sup>−5</sup>) and MAPK pathways (enrichment <italic>p</italic> value 1.1 × 10<sup>−4</sup>), including hypo-methylated PTEN and hyper-methylated BCL2 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11). Other notable DMGs include key markers of ovarian cancer such as MUC16 (CA-125) and PAX8, as well as genes that play key roles in ovarian cancer biology such as CCNE1 and MTHFR. Conversely, DMGs detected by MeTDiff were only enriched in three KEGG pathways (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b), most likely due to its inadequate power. We showed through permutation analysis that exomePeak and Fisher’s test results included a significant portion of false positives and could lead to biased downstream interpretations.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Pathways enriched in differential methylated genes identified in ovarian cancer and T2D datasets. We performed KEGG pathway enrichment analysis using <italic>ClusterProfiler</italic> [<xref ref-type="bibr" rid="CR37">37</xref>] on DMGs identified in the ovarian cancer dataset by RADAR (<bold>a</bold>) and MeTDiff (<bold>b</bold>), respectively. The enrichment maps represent identified pathways as a network with edges weighted by the ratio of overlapping gene sets</p></caption><graphic xlink:href="13059_2019_1915_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par23">In the T2D dataset, DMGs identified by RADAR were enriched in related pathways including insulin signaling pathways, type II diabetes mellitus, mTOR pathways, and AKT pathways (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1), indicating a role that m<sup>6</sup>A might play in T2D. We further analyzed these DMGs in related pathways and found the methylome of insulin/IGF1-AKT-PDX1 signaling pathway been mostly hypo-methylated in T2D islets (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S12). Impairment of this pathway resulting in downregulation of PDX1 has been recognized as a mechanism associated with T2D where PDX1 is a critical gene regulating β cell identity and cell cycle and promoting insulin secretion [<xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR24">24</xref>]. Indeed, follow-up experiment on a cell line model validated the role of m<sup>6</sup>A in tuning cell cycle and insulin secretion in β cells and animal model lacking methyltransferase Mettl14 in β cells recapitulated key T2D phenotypes (results presented in a separate manuscript, [<xref ref-type="bibr" rid="CR25">25</xref>]). To summarize, RADAR-identified DMGs enabled us to pursue an in-depth analysis of the role that m<sup>6</sup>A methylation plays in T2D. On the contrary, due to the incapability to take sample acquisition batches as covariates, the alternative methods were underpowered to detect DM sites in T2D dataset and could not lead to any in-depth discovery of m<sup>6</sup>A biology in T2D islets. These examples suggest that MeRIP-seq followed by RADAR analysis could further advance functional studies of RNA modifications.</p>
    </sec>
    <sec id="Sec7">
      <title>Validation of RADAR-detected DM sites by the SELECT method</title>
      <p id="Par24">Recently, Xiao et al. developed an elongation and ligation-based qPCR amplification method (termed SELECT) for single nucleotide-specific detection of m<sup>6</sup>A [<xref ref-type="bibr" rid="CR26">26</xref>]. This method relies on mechanism different from antibody pull-down-based MeRIP-seq to detect m<sup>6</sup>A, making it a suitable method for validating DM sites discovered by RADAR analysis. We selected six DM sites (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2) including two sites only detected by RADAR and four sites in genes important in β cell for experimental validation using the SELECT method. Among six validated sites, the β cells regulator PDX1 and RADAR-specific DM sites showed significant m<sup>6</sup>A level alteration with <italic>p</italic> values 0.009 and 0.017, respectively (Fig. <xref rid="Fig6" ref-type="fig">6</xref>). Three other sites, IGF1R in the insulin/IGF1-AKT-PDX1 signaling pathway, MAFA—another important regulator of β cell function, and RADAR-specific DM site in CPEB2, showed m<sup>6</sup>A changes consistent with RADAR result despite not reaching statistical significance. The sites in the TRIB3 gene are similarly methylated in control and T2D samples as measured by SELECT. Overall, five out of six experimentally validated sites were supported by orthogonal evidence by SELECT, confirming the reliability of RADAR-detected differential methylation sites.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Experimental validation of RADAR-detected DM sites using the SELECT method. We applied antibody independent method SELECT on T2D samples (<italic>N</italic> = 4). Shown are SELECT results of six putative DM sites for validation. SELECT measures the relative abundance of non-methylated RNA molecules of target locus as represented by the elongation and ligation “read through” of oligo probes. Thus, SELECT results—“relative read through”—are inversely correlated with m<sup>6</sup>A level</p></caption><graphic xlink:href="13059_2019_1915_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par25">Sample size is an important parameter of the study design that directly affects the power and reproducibility of an inferential test [<xref ref-type="bibr" rid="CR27">27</xref>]. DM analyses based on less than three biological replicates are still common practice in the RNA epigenetics field and have been shown to exhibit poor reproducibility [<xref ref-type="bibr" rid="CR28">28</xref>]. To explore the influence of sample size on the power and reproducibility of DM detection, we ran tests on 10 copies of simulated data with effect size equal to 0.75 (roughly twofold enrichment difference) from two replicates (commonly used) to eight replicates (up-to-date highest). We show that at an FDR cutoff of 10% to select DM loci, FDR increases rapidly as the sample size gets smaller and less than 5 (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). When the sample size is greater than 6, improvement of FDR is slow while sensitivity climbs rapidly. Our simulation results show the number of replicates greatly influences sensitivity and reproducibility of DM detection as each additional replicate can bring significant gain of area under ROC curve (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S13). To ensure adequate power and reliable DM analysis, we strongly suggest using no less than five biological replicates when surveying the alterations in the epitranscriptome of human samples with commonly sequenced library sizes (≥ 20 million mappable reads).
<fig id="Fig7"><label>Fig. 7</label><caption><p>The influence of sample size on the statistical power of differential methylation analysis. Sensitivity vs. empirical FDR for each method on simulated data with different numbers of replicates (2 to 8) at 10% FDR. Each data point represents the results on one of ten simulated copies. Sample sizes are labeled by colors</p></caption><graphic xlink:href="13059_2019_1915_Fig7_HTML" id="MO7"/></fig></p>
    <p id="Par26">The choice of bin size in the RADAR analysis concerns the tradeoff between resolution and accuracy. At a given sequencing depth, the smaller the bin, the higher resolution achieved. However, a smaller bin size also implies fewer reads in a bin, resulting in increased sampling noise. At common library size of 20 million mappable reads or above, the default bin size (50 bp) should enable sufficient coverage for most enriched regions in the IP library. We recommend to use larger bin size (e.g., 100-bp) for data with smaller library sizes (&lt; 15 million mappable reads) to include enough reads in each bin for DM tests.</p>
    <p id="Par27">A potential caveat of using gene-level instead of local read count to represent pre-IP expression level is that exon-specific expression variation in alternative splicing scenarios would be underrepresented. Filtering out DM sites that co-localize with alternative spliced exons in post-processing could help avoid false signals due to this caveat.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusion</title>
    <p id="Par28">Using simulation and real m<sup>6</sup>A-seq datasets, we demonstrated that RADAR can achieve higher sensitivity with lower FDR than existing methods in the DM analysis. Taking advantage of newly developed SELECT method for experimental validation, we verified that RADAR analysis can uncover true differentially methylated sites. RADAR is a general framework that can be applicable to comparative profiling by MeRIP-seq of various types of RNA modifications including but not limited to <italic>N</italic><sup>6</sup>-methyladenosine, <italic>N</italic><sup>1</sup>-methyladenosine, and 5-methylcytosine. It also offers great flexibility to adopt to a wide range of mean-variance relationships in the data and accommodate different study designs. We believe RADAR will greatly advance our knowledge of the functions of post-transcriptional modifications.</p>
  </sec>
  <sec id="Sec10">
    <title>Material and methods</title>
    <sec id="Sec11">
      <title>Ovarian cancer samples</title>
      <p id="Par29">All human tissue samples were collected with informed consent under approved University of Chicago Institutional Review Board protocols and in accordance with the Declaration of Helsinki. All experiments were conducted in accordance with approved protocol guidelines and regulations. Six omental tumor tissues were collected from newly diagnosed patients with advanced, metastatic high-grade serous ovarian cancer during primary debulking surgery at the University of Chicago. Seven normal fallopian tube tissues were collected from patients with benign gynecological conditions at the time of surgery.</p>
    </sec>
    <sec id="Sec12">
      <title>T2D samples</title>
      <p id="Par30">A minimum of 20,000 human islets equivalents (IEQs)/patient were obtained from the Integrated Islet Distribution Program (IIIDP) and Prodo Laboratories. Upon receipt, islets were cultured overnight in Miami Media #1A (Cellgro, USA) and then handpicked, washed twice by self-sedimentation with ice-cold DPBS, and pelleted for RNA isolation. All studies and protocols used were approved by the Joslin Diabetes Center’s Committee on Human Studies (CHS#5-05). Samples from eight T2D patients and seven non-diabetic controls were collected for analyses in this study.</p>
    </sec>
    <sec id="Sec13">
      <title>Mouse liver samples</title>
      <p id="Par31">Mouse liver tissues were collected from wild type Albumin-Cre;<italic>Mettl14</italic><sup>+/+</sup> and Albumin-Cre;<italic>Mettl14</italic><sup>flox/flox;Cre</sup> liver-specific conditional knockout mice [<xref ref-type="bibr" rid="CR29">29</xref>]. Four wild type and four <italic>Mettl14</italic> cKO mice on 42% high-fat diet for 3 months were sequenced and analyzed.</p>
    </sec>
    <sec id="Sec14">
      <title>RNA extraction and m<sup>6</sup>A-MeRIP-seq</title>
      <p id="Par32">Total RNA was extracted from tissues using TRIzol (Invitrogen) according to the manufacturer’s instruction. For T2D and mouse liver samples, mRNA was further purified with Dynabeads mRNA DIRECT purification kit (Thermo Fisher, cat. 61,011). mRNA was adjusted to 15 ng/μl in 100 μl and fragmented using Bioruptor ultrasonicator (Diagenode) with 30 s on/off for 30 cycles. m<sup>6</sup>A-immunoprecipitation (m<sup>6</sup>A-IP) was performed using EpiMark N6-Methyladenosine enrichment kit (NEB cat. E1610S). RNA eluted from m<sup>6</sup>A-IP was cleaned using RNA Clean and Concentrator (Zymo Research, cat. R1013). Input and IP samples were then used to prepare library with KAPA mRNA Hyper Kit (Roche, Cat. KK8541). For fallopian tube and omental tumor tissues, total RNA was fragmented and directly subjected to m<sup>6</sup>A-IP. Takara Pico-Input Strand-Specific Total RNA-seq for Illumina (Takara, Cat. 634413) was used to construct libraries from total RNA where ribosome-derived cDNA was removed before final library amplification. T2D and mouse liver libraries were sequenced by the HiSeq4000 platform at SE50 mode. The ovarian cancer libraries were sequenced by the NextSeq 500 platform at PE37 mode.</p>
    </sec>
    <sec id="Sec15">
      <title>Data preparation</title>
      <p id="Par33">For each dataset, the raw sequencing data were mapped to the corresponding reference genome (hg38 for human, and mm10 for mouse) by <italic>Hisat2</italic> [<xref ref-type="bibr" rid="CR30">30</xref>] with parameter -x 1. The BAM files obtained from alignment are used as an input file for RADAR.</p>
    </sec>
    <sec id="Sec16">
      <title>Read count pre-processing</title>
      <p id="Par34">RADAR takes a GTF file as an input for gene annotation and obtains a gene model using the R package <italic>GenomicFeatures</italic> [<xref ref-type="bibr" rid="CR31">31</xref>]. Exons of a gene are concatenated to form the “longest isoform” transcript, which is then divided into bins of user-defined size. The R package <italic>Rsamtools</italic> [<xref ref-type="bibr" rid="CR32">32</xref>] is used to extract and quantify aligned reads from BAM files in each bin. The gene-level counts of INPUT library are obtained by summing up bin-level read counts of each gene.</p>
    </sec>
    <sec id="Sec17">
      <title>Normalization</title>
      <p id="Par35">Unlike previous methods [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR11">11</xref>] that scale read counts to library sizes as a way of normalization, which can be strongly skewed by highly expressed genes [<xref ref-type="bibr" rid="CR16">16</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1), RADAR considers INPUT and IP samples separately. The INPUT sample is essentially an RNA-seq library; therefore, we directly apply the median-of-ratio method implemented in DESeq2, which is robust to outliers, to estimate a sample-wise size factor for each sample from INPUT gene-level counts. In regard to the IP sample, the abundance of read counts <italic>t</italic><sub><italic>i</italic>, <italic>j</italic></sub> depends on the abundance of RNA in the pre-IP RNA pool, the overall IP efficiency of that sample, the total sequencing depth of that IP library, and the methylation level of that locus. To normalize the variation due to sample-wise IP efficiency difference and sequencing depth variations of IP libraries, we estimate a sample-wise size factor from the fold enrichment <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {E}_{i,j}=\frac{t_{i,j}}{s_{{\mathrm{gene}}_m,j}} $$\end{document}</tex-math><mml:math id="M4" display="inline"><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mtext>gene</mml:mtext><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:math><inline-graphic xlink:href="13059_2019_1915_Article_IEq2.gif"/></alternatives></inline-formula> of the top 1% bins ranked by IP read counts where <italic>t</italic><sub><italic>i</italic>, <italic>j</italic></sub> is IP read counts and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {s}_{{\mathrm{gene}}_m,j} $$\end{document}</tex-math><mml:math id="M6" display="inline"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:msub><mml:mtext>gene</mml:mtext><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1915_Article_IEq3.gif"/></alternatives></inline-formula> is the normalized <italic>geneSum</italic> (gene-level) read count at corresponding gene. The reason that only top bins are used to estimate the overall IP efficiency is to exclude the regions where IP read counts are mainly attributed to non-specific binding.</p>
    </sec>
    <sec id="Sec18">
      <title>Adjust IP read count for pre-IP RNA expression level</title>
      <p id="Par36">To account for the pre-IP gene expression level variation in IP read counts, we compute a gene-wise size factor by centering normalized gene-level counts to 1. For each bin, we divide the normalized IP read counts by the gene-wise size factor of the corresponding gene. The resulting IP read counts now reflect the methylation level as other factors have all been accounted for. The adjusted IP read counts representing methylation levels are further used for DM tests.</p>
    </sec>
    <sec id="Sec19">
      <title>Data filtering</title>
      <p id="Par37">We apply two filters to remove unwanted bins in the data: (1) we remove bins in which reads are depleted in IP libraries because read counts in these bins are likely attributed to non-specific binding during the immunoprecipitation and (2) we remove bins in which raw IP read counts are smaller than 15 (this cutoff can be defined by the user) because signals in regions without sufficient coverage will be too noisy and unreliable. Low IP read count also implies that the bin is likely a non-methylated region.</p>
    </sec>
    <sec id="Sec20">
      <title>Model for DM test</title>
      <p id="Par38">For each bin, we model the processed IP read counts <italic>Y</italic><sub><italic>i</italic></sub> in the <italic>i</italic>th sample as follows:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{rrr}{Y}_i&amp; \sim &amp; Poi\left({\lambda}_i\right)\\ {}\log \left({\lambda}_i\right)&amp; =&amp; \mu +\boldsymbol{X}\boldsymbol{\beta } +{e}_i=\mu +{X}_0\ {\beta}_0+{\sum}_{j=1}^k{X}_j\ {\beta}_j+{e}_i,\end{array}} $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mtable columnalign="right" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mo>∼</mml:mo></mml:mtd><mml:mtd><mml:mi mathvariant="italic">Poi</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>λ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">Xβ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mspace width="0.25em"/><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.25em"/><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1915_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <italic>λ</italic><sub><italic>i</italic></sub> is the mean of a Poisson distribution, <italic>μ</italic> is a bin-specific intercept, <bold>X</bold> is the design matrix including the indicator of the groups of interest <italic>X</italic><sub>0</sub> and covariates <italic>X</italic><sub><italic>j</italic></sub> (<italic>j</italic> = 1, …, <italic>k</italic>), <bold><italic>β</italic></bold> represent associated coefficients, and <italic>e</italic><sub><italic>i</italic></sub> is a random effect following a log gamma distribution with a scale parameter <italic>ψ</italic> and mean equal to 1, i.e., <italic>e</italic><sub><italic>i</italic></sub> ∈ log <italic>Gamma</italic>(<italic>ψ</italic>, <italic>ψ</italic>). Introducing a new variable <italic>w</italic><sub><italic>i</italic></sub> ∈ <italic>Gamma</italic>(<italic>ψ</italic>, <italic>ψ</italic>), we have <italic>λ</italic><sub><italic>i</italic></sub> = <italic>e</italic><sup>μ + <bold>X</bold><bold><italic>β</italic></bold></sup><italic>w</italic><sub><italic>i</italic></sub>. The differential analysis is equivalent to test against the null hypothesis <italic>β</italic><sub>0</sub> = 0.</p>
      <p id="Par39">After integrating out <italic>w</italic><sub><italic>i</italic></sub>, the likelihood of observing the data given all other parameters <italic>Θ</italic> is:
<disp-formula id="Equa"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{rrr}P\left(\mathrm{Y}|\varTheta, -{w}_i\right)&amp; =&amp; \int {e}^{-{w}_i{e}^{\upmu +\mathbf{X}\boldsymbol{\beta }}}\frac{{\left({w}_i{e}^{\upmu +\mathbf{X}\boldsymbol{\beta }}\right)}^{Y_i}}{Y_i!}\frac{\psi^{\psi }{w}_i^{\psi -1}{e}^{-\psi {w}_i}}{\varGamma \left(\psi \right)}d{w}_i\\ {}&amp; =&amp; \frac{\psi^{\psi }}{Y_i!}\frac{\varGamma \left({Y}_i+\psi \right)}{\varGamma \left(\psi \right)}\frac{{\left({e}^{\upmu +\mathbf{X}\boldsymbol{\beta }}\right)}^{Y_i}}{{\left({e}^{\upmu +\mathbf{X}\boldsymbol{\beta }}+\psi \right)}^{Y_i+\psi }}\end{array}} $$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mtable columnalign="right" displaystyle="true"><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|"><mml:mi mathvariant="normal">Y</mml:mi><mml:mrow><mml:mi>Θ</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mo>∫</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msup><mml:mfrac><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi>ψ</mml:mi><mml:mi>ψ</mml:mi></mml:msup><mml:msubsup><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>ψ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>ψ</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>ψ</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:mfrac><mml:msup><mml:mi>ψ</mml:mi><mml:mi>ψ</mml:mi></mml:msup><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>Γ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>ψ</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mfrac><mml:msup><mml:mfenced close=")" open="("><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:msup></mml:mfenced><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:msup></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1915_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par40">The marginal log likelihood of observing <bold>Y</bold> can be written as:
<disp-formula id="Equb"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \log L\left(\mathbf{Y}\right)\kern0.5em =\kern0.5em \sum \limits_i^n\left[{Y}_i\left(\upmu +\mathbf{X}\boldsymbol{\beta } \right)+\psi \log \psi +\log \varGamma \left({Y}_i+\psi \right)-\log {Y}_i!-\log \varGamma \left(\psi \right)-\left({Y}_i+\psi \right)\log \left({e}^{\upmu +\mathbf{X}\boldsymbol{\beta }}+\psi \right)\right] $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mo>log</mml:mo><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">Y</mml:mi></mml:mfenced><mml:mspace width="0.5em"/><mml:mo>=</mml:mo><mml:mspace width="0.5em"/><mml:munderover><mml:mo>∑</mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:munderover><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi><mml:mo>log</mml:mo><mml:mi>ψ</mml:mi><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mi>Γ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>!</mml:mo><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:mi>Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>ψ</mml:mi></mml:mfenced><mml:mo>−</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfenced><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2019_1915_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par41">We use the gradient ascent algorithm to calculate maximum likelihood estimators of all the parameters, which involves the calculation of the first derivatives.
<disp-formula id="Equc"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{rrr}\frac{\partial \log L\left(\mathbf{Y}\right)}{\partial {\beta}_k}&amp; =&amp; \sum \limits_i^n\ \left[{Y}_i-\left({Y}_i+\psi \right)\frac{e^{\upmu +\mathbf{X}\boldsymbol{\beta }}}{e^{\upmu +\mathbf{X}\boldsymbol{\beta }}+\psi}\right]{X}_{ik}\\ {}\frac{\partial \log L\left(\mathbf{Y}\right)}{\partial \psi }&amp; =&amp; \sum \limits_i^n\Big[\log \psi +1-\frac{Y_i+\psi }{e^{\upmu +\mathbf{X}\boldsymbol{\beta }}+\psi }-\log \left({e}^{\upmu +\mathbf{X}\boldsymbol{\beta }}+\psi \right)\\ {}&amp; &amp; + digamma\left({Y}_i+\psi \right)- digamma\left(\psi \right)\Big]\\ {}\frac{\partial \log L\left(\mathbf{Y}\right)}{\partial \mu }&amp; =&amp; \sum \limits_i^n\left[{Y}_i-\left({Y}_i+\psi \right)\frac{e^{\upmu +\mathbf{X}\boldsymbol{\beta }}}{e^{\upmu +\mathbf{X}\boldsymbol{\beta }}+\psi}\right]\end{array}} $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:mtable columnalign="right" displaystyle="true"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mo>log</mml:mo><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">Y</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:munderover><mml:mo>∑</mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:munderover><mml:mspace width="0.25em"/><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfenced><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:msub><mml:mi>X</mml:mi><mml:mi mathvariant="italic">ik</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mo>log</mml:mo><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">Y</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>ψ</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:munderover><mml:mo>∑</mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:munderover><mml:mo stretchy="true">[</mml:mo><mml:mo>log</mml:mo><mml:mi>ψ</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd><mml:mo>+</mml:mo><mml:mtext mathvariant="italic">digamma</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfenced><mml:mo>−</mml:mo><mml:mtext mathvariant="italic">digamma</mml:mtext><mml:mfenced close=")" open="("><mml:mi>ψ</mml:mi></mml:mfenced><mml:mo stretchy="true">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mo>log</mml:mo><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">Y</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>μ</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd><mml:munderover><mml:mo>∑</mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:munderover><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfenced><mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="normal">μ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>ψ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2019_1915_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par42">In each iteration, the parameters are updated through <inline-formula id="IEq4"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\varPhi}_{\left(t+1\right)}={\varPhi}_{(t)}+{s}_{\left(t+1\right)}{\frac{\partial \log \left(\mathbf{Y}\right)}{\partial \varPhi}}_{\mid \varPhi ={\varPhi}_{(t)}} $$\end{document}</tex-math><mml:math id="M16" display="inline"><mml:msub><mml:mi>Φ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>Φ</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:msub><mml:msub><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mi mathvariant="bold">Y</mml:mi></mml:mfenced></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>Φ</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mo>∣</mml:mo><mml:mi>Φ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>Φ</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2019_1915_Article_IEq4.gif"/></alternatives></inline-formula>. The step size <italic>s</italic><sub>(<italic>t</italic> + 1)</sub> is determined by a line search algorithm. Finally, a Wald test is derived to test against <italic>β</italic><sub>0</sub> = 0, i.e., the test statistics is <inline-formula id="IEq5"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{\beta_0} $$\end{document}</tex-math><mml:math id="M18" display="inline"><mml:mover accent="true"><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1915_Article_IEq5.gif"/></alternatives></inline-formula>/sd(<inline-formula id="IEq6"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{\beta_0} $$\end{document}</tex-math><mml:math id="M20" display="inline"><mml:mover accent="true"><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1915_Article_IEq6.gif"/></alternatives></inline-formula>) where <inline-formula id="IEq7"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{\beta_0} $$\end{document}</tex-math><mml:math id="M22" display="inline"><mml:mover accent="true"><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mspace width="0.25em"/></mml:math><inline-graphic xlink:href="13059_2019_1915_Article_IEq7.gif"/></alternatives></inline-formula> is the MLE and sd(<inline-formula id="IEq8"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{\beta_0} $$\end{document}</tex-math><mml:math id="M24" display="inline"><mml:mover accent="true"><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1915_Article_IEq8.gif"/></alternatives></inline-formula>) is estimated using observed Fisher information.</p>
    </sec>
    <sec id="Sec21">
      <title>Post-processing</title>
      <p id="Par43">Since the DM tests are performed on consecutive bins on the mRNA, post-processing is needed to merge connected bins that contain reads derived from the same methylation site and report their genome coordinates instead of mRNA coordinates. Specifically, we filter all the bins under user-defined FDR cutoffs and merge adjacent significant bins to a single peak. To represent the mRNA peaks using the genome coordinate, we report the final result in BED12 format, which can specify exon blocks for an intron-spanning interval.</p>
    </sec>
    <sec id="Sec22">
      <title>Simulation analysis</title>
      <p id="Par44">To assess the sensitivity and specificity of each method on detecting true DM sites, we simulated dataset of eight replicates with and without covariate. Since RADAR make inferential test on fold enrichment (pre-processed IP read counts adjusted for input RNA level variation), we first simulated this enrichment data (pre-processed IP read counts) using model (1). We draw the distribution of gene-specific intercept parameter <italic>μ</italic> (equivalent to baseline sequencing depth of control samples) and random effect parameter <italic>ψ</italic> from real data (T2D) to better reflect the property of real data. For each dataset, we simulated 26,324 sites where 20% of them were pre-defined as true DM sites with effect sizes of 0.5, 0.75, or 1. At pre-defined true DM sites, we simulated read counts with <bold><italic>β =</italic></bold> 0.5 (or 0.75 or 1) while <bold><italic>β =</italic></bold> 0 at null sites. Other alternative methods take INPUT and IP read counts as input data for DM tests. To convert our simulated enrichment data into paired INPUT and IP read counts, we used INPUT read counts from the real T2D dataset and generated corresponding IP read counts by rescaling simulated IP counts to match the IP/INPUT ratio in the real data.</p>
      <p id="Par45">We then applied RADAR, MeTPeak (version 1.1) [<xref ref-type="bibr" rid="CR8">8</xref>], QNB (version 1.1.11) [<xref ref-type="bibr" rid="CR10">10</xref>], Fisher’s exact test, and exomePeak (version 2.17.0) [<xref ref-type="bibr" rid="CR11">11</xref>] to the simulated data. We used the Benjamini-Hochberg method to adjust for multiple comparisons. Using an FDR cutoff at 10% (or 1%, 5% … in sliding threshold analysis), we obtained a set of predicted DM sites for each method. We then checked whether pre-defined true DM sites were predicted to be DM site. To evaluate the performance, we computed sensitivity by dividing the number of overlaps between predicted DM sites and true sites by the number of true sites. We also computed the empirical FDR by dividing the number of predicted sites that is not in the true sites by the number of predicted sites. To evaluate effect of covariates on the performance, we repeated the above analysis using model (1) with an additional binary categorical (such as gender) variable with an effect size of 2. There are three covariates included in the T2D data analysis. The covariate with the largest effect size ranges from 0 to 4. We chose an intermediate effect size of 2 to represent a moderately challenging scenario in real data.</p>
      <p id="Par46">Next, we repeated the simulation analysis with an alternative model as described in the QNB manuscript [<xref ref-type="bibr" rid="CR10">10</xref>], termed as the “QNB model.” Unlike model (1) that directly simulates the enrichment as pre-processed IP read counts, the QNB model simulates the paired INPUT and IP read counts separately, each following a negative binomial distribution. The original QNB model sets equal variance for both INPUT and IP data. However, we observe that in the MeRIP-seq, the IP read counts usually have higher variability than the INPUT read counts due to extra variation introduced during the IP process (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). Therefore, we modified the QNB model so that the variance parameter for IP is a magnitude higher than INPUT. Similarly, we generated data for the simple case as well as the difficult case with one confounding factor using the QNB model and applied each method to test for DM loci.</p>
    </sec>
    <sec id="Sec23">
      <title>Coverage sub-sampling analysis</title>
      <p id="Par47">To demonstrate that the robust measurement of pre-IP RNA level implemented in RADAR improves the robustness to varying INPUT sequencing depth, we used T2D dataset as an example and performed sequencing depth sub-sampling analysis. We used the Sambamba [<xref ref-type="bibr" rid="CR33">33</xref>] with parameters “view -h -t 20 -s 0.5 -f bam –subsampling-seed=1231” to sub-sample half of the reads from BAM files of INPUT samples. To count the overlap between results from sub-sampled and full data, we first obtained filtered bins that are shared in both datasets, then count the bin if it reached significant threshold in both datasets. To compare the log fold change (logFC) estimates, we plotted the logFC estimated from the sub-sampled data against that estimated from the full data by each method.</p>
    </sec>
    <sec id="Sec24">
      <title>De novo motif discovery and metagene analysis</title>
      <p id="Par48">To examine if the putative DM sites detected by RADAR are consistent with known characteristics of m<sup>6</sup>A sites, we performed de novo motif discovery analysis using the <italic>findMotifs</italic> function of homer2 [<xref ref-type="bibr" rid="CR34">34</xref>] with parameter “-len 5,6 -rna -p 20 -S 5 –noknown.” A background sequence of randomly sampled peaks on transcriptome was used in the motif analysis.</p>
      <p id="Par49">Topological distribution of putative DM sites was plotted on a metagene using R package Guitar [<xref ref-type="bibr" rid="CR35">35</xref>].</p>
    </sec>
    <sec id="Sec25">
      <title>Pathway enrichment analysis</title>
      <p id="Par50">A pathway enrichment analysis was performed on the DMGs identified from the ovarian cancer dataset using KEGG pathways [<xref ref-type="bibr" rid="CR36">36</xref>] using the <italic>enrichKEGG</italic> function in R package <italic>ClusterProfiler</italic> [<xref ref-type="bibr" rid="CR37">37</xref>].</p>
    </sec>
    <sec id="Sec26">
      <title>Experimental validation by SELECT method</title>
      <p id="Par51">SELECT is an elongation and ligation-based method that can distinguish single m<sup>6</sup>A site from A site [<xref ref-type="bibr" rid="CR26">26</xref>]. Briefly, we design two oligos flanking the target m<sup>6</sup>A/A site that leave a gap on the m<sup>6</sup>A/A site. Then, <italic>Bst</italic> DNA polymerase and SplintR ligase are used to fill the gap where m<sup>6</sup>A hinders the elongation of the complementary oligo and thus prevent the gap to be filled. Finally, qPCR targeting the ligated oligo is used to quantify the abundance of the non-methylated RNA molecules. qPCR quantification targeting a nearby region on the target gene is used to normalize the gene expression variation. Since readout of SELECT method reflects relative abundance of non-methylated molecules, we expect the SELECT result to be inversely correlated to the m<sup>6</sup>A levels.</p>
      <p id="Par52">Since SELECT method involves many steps for each site and is not feasible for high-throughput analysis, we selected six sites including two DM sites that were only detected by RADAR and four DM sites that were implicated in T2D biology for experimental validation. We first matched RRACH motif in the putative DM peak and designed complementary oligos of 30 nt flanking the putative m<sup>6</sup>A site. An additional 21 nt sequence at 5′ of the up-probe and 20 nt sequence 3′ of the down-probe were added to the oligos as universal primer sequence. For each DM site, we also designed a pair of primer targeting the gene harboring the DM site (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3 for oligo and primer sequences).</p>
      <p id="Par53">We applied the SELECT method to four control and T2D samples that have enough RNA material leftover from sequencing experiment. For each sample, 50 ng of total RNA was mixed with 0.8 μl up-probe and down-probe oligo (1 μM) of each target m<sup>6</sup>A site, 1 μl dTTP (100 μM), and 2 μl 10X CutSmart buffer (NEB) supplemented with H<sub>2</sub>O to 17 μl total volume. The mix was incubated at a temperature gradient: 90 °C for 1 min, 80 °C for 1 min, 70 °C for 1 min, 60 °C for 1 min, 50 °C for 1 min, and then 40 °C for 6 min. Subsequently, a 3 μl of enzyme mixture containing 0.5 μl <italic>Bst</italic> 2.0 DNA polymerase (0.02 U/μl) (NEB M0275S), 0.5 μl SplintR ligase (1 U/μl) (NEB M0375S), and 2 μl ATP (5 mM) was added in the former mixture to the final volume of 20 μl. The final reaction mixture was incubated at 40 °C for 20 min then denatured at 80 °C for 20 min. Then, qPCR reaction to quantify the “read through” oligos was assembled by 10 μl 2X qPCR master mix, 0.8 μl universal primer as designed in the oligo probes (10 μM), 2 μl reaction from previous step, and 7.2 μl H<sub>2</sub>O. To quantify the RNA expression level of each gene harboring the m<sup>6</sup>A site, we first prepared the cDNA from 50 ng of total RNA using SuperScript VILO Master Mix (Thermo Fisher 11755050). Then, 2 μl of cDNA was used for qPCR quantification of each gene. Finally, the gene expression level quantification was used to normalize the “read through” oligo probe quantification to obtain “relative read through” level for each site. Note the “relative read through” level reflects the non-methylated level, which is inversely correlated with m<sup>6</sup>A site.</p>
    </sec>
    <sec id="Sec27">
      <title>Sample size analysis</title>
      <p id="Par54">To investigate the effect of sample size on the power of detecting DM sites, we simulated datasets of varying sample sizes from <italic>N</italic> = 2 to <italic>N</italic> = 8 using Model (1) without covariates. We assessed the performance by plotting the sensitivity of each method against its FDR using DM loci obtained at an FDR cutoff of 10%. Additionally, we also made the ROC curve for each sample size by varying the FDR cutoffs when selecting predicted sites (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S13).</p>
    </sec>
  </sec>
  <sec id="Sec28" sec-type="data-availability">
    <title>Availability of data and materials</title>
    <sec id="Sec29">
      <title>Software availability</title>
      <p id="Par55">Our method is implemented as a C++/R package and is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/scottzijiezhang/RADAR">https://github.com/scottzijiezhang/RADAR</ext-link> [<xref ref-type="bibr" rid="CR38">38</xref>] under GNU General Public License (GPL-v3.0).</p>
      <p id="Par56">Reproducible documents with all the analysis presented in the paper are available at <ext-link ext-link-type="uri" xlink:href="https://scottzijiezhang.github.io/RADARmanual/Reproducible.html">https://scottzijiezhang.github.io/RADARmanual/Reproducible.html</ext-link>.</p>
      <p id="Par57">Source code of the software can be found at Zenodo repository: 10.5281/zenodo.3561035</p>
    </sec>
    <sec id="Sec30" sec-type="data-availability">
      <title>Data availability</title>
      <p id="Par58">All MeRIP-seq datasets sequenced and analyzed in this manuscript have been deposited in GEO repository: GSE 119168 (ovarian cancer), GSE 120024 (T2D), and GSE 119490 (mouse liver). The mouse brain dataset was downloaded from GSE 113781 [<xref ref-type="bibr" rid="CR7">7</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec31">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1915_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Figure S1.</bold> Scatter plot of read count. <bold>Figure S2.</bold> Read count distribution of INPUT data. <bold>Figure S3.</bold> Sequencing depth distribution of m6A-seq in published literatures. <bold>Figure S4.</bold> Variability distribution comparing RNA-seq and m6A-seq (MeRIP-seq). <bold>Figure S5.</bold> Evaluating performances of benchmarked methods on simulated data using sliding thresholds. <bold>Figure S6.</bold> P-value and effect size estimates on simulated data. <bold>Figure S7.</bold> Coverage plot of individual samples for example DM sites and bogus sites in the T2D dataset. <bold>Figure S8.</bold> Compare the methods to adjust for gene expression level. <bold>Figure S9.</bold> Compare results obtained from shallower sequence depth with that from original depth. <bold>Figure S10.</bold> Motif analysis and topological distribution of putative DM sites. <bold>Figure S11.</bold> Coverage plot to visualize differential m6A peaks in ovarian cancer. <bold>Figure S12.</bold> Representation of Insulin/IGF1-AKT-PDX1 pathway. <bold>Figure S13.</bold> Analysis of statistical power and the number of replicates. <bold>Table S1.</bold> Enriched DM genes in KEGG pathways in the T2D dataset. <bold>Table S2.</bold> Selected DM sites for experimental validation. <bold>Table S3.</bold> Oligo probes sequences and qPCR primer sequences.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2019_1915_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13059-019-1915-9.</p>
  </sec>
  <ack>
    <sec id="FPar1">
      <title>Peer review information</title>
      <p id="Par59">Yixin Yao was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
    <sec id="FPar2">
      <title>Review history</title>
      <p id="Par60">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>MC and ZZ conceived the idea, developed the method, and designed the experiments. ZZ implemented the software and performed the analyses. QZ contributed to the simulation model. ZZ, ME, AC, DFDJ, and DR designed and performed the experiments (wet). CH, EL, and RNK designed and supervised the experiments (wet). MC, ZZ, and CH wrote the paper. All the authors have reviewed, commented, and edited the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>MC’s work was supported by the National Institutes of Health (NIH) grants R01GM126553, Alfred Sloan Fellowship and a human cell atlas seed network grant from Chan Zuckerberg Initiative. CH’s work was supported by the NIH RM1 HG008935 and Howard Hughes Medical Institute. RNK’s work was supported by NIH R01 DK67536 and UC4 DK116278.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par61">Ethics approval is not applicable for this study.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par62">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Willyard</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>A new twist on epigenetics</article-title>
        <source>Nature</source>
        <year>2017</year>
        <volume>542</volume>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1038/542406a</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Roundtree</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Post-transcriptional gene regulation by mRNA modifications</article-title>
        <source>Nat Rev Mol Cell Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>31</fpage>
        <lpage>42</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm.2016.132</pub-id>
        <pub-id pub-id-type="pmid">27808276</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roundtree</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Dynamic RNA modifications in gene expression regulation</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>169</volume>
        <fpage>1187</fpage>
        <lpage>1200</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.05.045</pub-id>
        <pub-id pub-id-type="pmid">28622506</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dominissini</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Moshitch-Moshkovitz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Salmon-Divon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ungar</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Osenberg</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cesarkas</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jacob-Hirsch</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Amariglio</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kupiec</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Topology of the human and mouse m6A RNA methylomes revealed by m6A-seq</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <fpage>201</fpage>
        <lpage>206</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11112</pub-id>
        <pub-id pub-id-type="pmid">22575960</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meyer</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Saletore</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zumbo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Elemento</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Mason</surname>
            <given-names>CE</given-names>
          </name>
          <name>
            <surname>Jaffrey</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive analysis of mRNA methylation reveals enrichment in 3′ UTRs and near stop codons</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>149</volume>
        <fpage>1635</fpage>
        <lpage>1646</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.05.003</pub-id>
        <pub-id pub-id-type="pmid">22608085</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dominissini</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Nachtergaele</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Moshitch-Moshkovitz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Peer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kol</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Ben-Haim</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Di Segni</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Salmon-Divon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clark</surname>
            <given-names>WC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The dynamic N(1)-methyladenosine methylome in eukaryotic messenger RNA</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>530</volume>
        <fpage>441</fpage>
        <lpage>446</lpage>
        <pub-id pub-id-type="doi">10.1038/nature16998</pub-id>
        <pub-id pub-id-type="pmid">26863196</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Engel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Eggert</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kaplick</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Eder</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Röh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tietze</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Namendorf</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Arloth</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weber</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rex-Haffner</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The role of m6A/m-RNA methylation in stress response regulation</article-title>
        <source>Neuron</source>
        <year>2018</year>
        <volume>99</volume>
        <fpage>389</fpage>
        <lpage>403</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2018.07.009</pub-id>
        <pub-id pub-id-type="pmid">30048615</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cui</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Meng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>MeTDiff: a novel differential RNA methylation analysis for MeRIP-Seq data</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinform</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>526</fpage>
        <lpage>534</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2015.2403355</pub-id>
        <pub-id pub-id-type="pmid">29610101</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Meng</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>DRME: count-based differential RNA methylation analysis at small sample size scenario</article-title>
        <source>Anal Biochem</source>
        <year>2016</year>
        <volume>499</volume>
        <fpage>15</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ab.2016.01.014</pub-id>
        <pub-id pub-id-type="pmid">26851340</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Meng</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>QNB: differential RNA methylation analysis for count-based small-sample sequencing data with a quad-negative binomial model</article-title>
        <source>BMC Bioinformatics</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>387</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-017-1808-4</pub-id>
        <pub-id pub-id-type="pmid">28859631</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>A protocol for RNA methylation differential analysis with MeRIP-Seq data and exomePeak R/Bioconductor package</article-title>
        <source>Methods</source>
        <year>2014</year>
        <volume>69</volume>
        <fpage>274</fpage>
        <lpage>281</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymeth.2014.06.008</pub-id>
        <pub-id pub-id-type="pmid">24979058</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cui</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Exome-based analysis for RNA epigenome sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>1565</fpage>
        <lpage>1567</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt171</pub-id>
        <pub-id pub-id-type="pmid">23589649</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pimentel</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Bray</surname>
            <given-names>NL</given-names>
          </name>
          <name>
            <surname>Puente</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Melsted</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Pachter</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Differential analysis of RNA-seq incorporating quantification uncertainty</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>687</fpage>
        <lpage>690</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4324</pub-id>
        <pub-id pub-id-type="pmid">28581496</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Oshlack</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-3-r25</pub-id>
        <pub-id pub-id-type="pmid">20196867</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Genome Biol</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>R106</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id>
        <pub-id pub-id-type="pmid">20979621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A METTL3–METTL14 complex mediates mammalian nuclear RNA N6-adenosine methylation</article-title>
        <source>Nat Chem Biol</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>93</fpage>
        <pub-id pub-id-type="doi">10.1038/nchembio.1432</pub-id>
        <pub-id pub-id-type="pmid">24316715</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Manning</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Cantley</surname>
            <given-names>LC</given-names>
          </name>
        </person-group>
        <article-title>Targeting the PI3K-Akt pathway in human cancer: rationale and promise</article-title>
        <source>Cancer Cell</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>257</fpage>
        <lpage>262</lpage>
        <pub-id pub-id-type="doi">10.1016/S1535-6108(03)00248-4</pub-id>
        <pub-id pub-id-type="pmid">14585353</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kwok-Shing Ng</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kucherlapati</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tsang</surname>
            <given-names>YH</given-names>
          </name>
          <name>
            <surname>de Velasco</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Jeong</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Akbani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hadjipanayis</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A pan-cancer proteogenomic atlas of PI3K/AKT/mTOR pathway alterations</article-title>
        <source>Cancer Cell</source>
        <year>2017</year>
        <volume>31</volume>
        <fpage>820</fpage>
        <lpage>832</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccell.2017.04.013</pub-id>
        <pub-id pub-id-type="pmid">28528867</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoffers</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Zinkin</surname>
            <given-names>NT</given-names>
          </name>
          <name>
            <surname>Stanojevic</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>WL</given-names>
          </name>
          <name>
            <surname>Habener</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Pancreatic agenesis attributable to a single nucleotide deletion in the human IPF1 gene coding sequence</article-title>
        <source>Nat Genet</source>
        <year>1997</year>
        <volume>15</volume>
        <fpage>106</fpage>
        <lpage>110</lpage>
        <pub-id pub-id-type="doi">10.1038/ng0197-106</pub-id>
        <pub-id pub-id-type="pmid">8988180</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Harmon</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Robertson</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Powers</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Inactivation of specific β cell transcription factors in type 2 diabetes</article-title>
        <source>J Clin Invest</source>
        <year>2013</year>
        <volume>123</volume>
        <fpage>3305</fpage>
        <lpage>3316</lpage>
        <pub-id pub-id-type="doi">10.1172/JCI65390</pub-id>
        <pub-id pub-id-type="pmid">23863625</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oliver-Krasinski</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Kasner</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Crutchlow</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Rustgi</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Kaestner</surname>
            <given-names>KH</given-names>
          </name>
          <name>
            <surname>Stoffers</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>The diabetes gene Pdx1 regulates the transcriptional network of pancreatic endocrine progenitor cells in mice</article-title>
        <source>J Clin Invest</source>
        <year>2009</year>
        <volume>119</volume>
        <fpage>1888</fpage>
        <lpage>1898</lpage>
        <pub-id pub-id-type="doi">10.1172/JCI37028</pub-id>
        <pub-id pub-id-type="pmid">19487809</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Humphrey</surname>
            <given-names>RK</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>S-M</given-names>
          </name>
          <name>
            <surname>Flores</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Jhala</surname>
            <given-names>US</given-names>
          </name>
        </person-group>
        <article-title>Glucose regulates steady-state levels of PDX1 via the reciprocal actions of GSK3 and AKT kinases</article-title>
        <source>J Biol Chem</source>
        <year>2010</year>
        <volume>285</volume>
        <fpage>3406</fpage>
        <lpage>3416</lpage>
        <pub-id pub-id-type="doi">10.1074/jbc.M109.006734</pub-id>
        <pub-id pub-id-type="pmid">19833727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Jesus</surname>
            <given-names>Dario F.</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Zijie</given-names>
          </name>
          <name>
            <surname>Kahraman</surname>
            <given-names>Sevim</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>Natalie K.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Mengjie</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Jiang</given-names>
          </name>
          <name>
            <surname>Gupta</surname>
            <given-names>Manoj K.</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Chuan</given-names>
          </name>
          <name>
            <surname>Kulkarni</surname>
            <given-names>Rohit N.</given-names>
          </name>
        </person-group>
        <article-title>m6A mRNA methylation regulates human β-cell biology in physiological states and in type 2 diabetes</article-title>
        <source>Nature Metabolism</source>
        <year>2019</year>
        <volume>1</volume>
        <issue>8</issue>
        <fpage>765</fpage>
        <lpage>774</lpage>
        <pub-id pub-id-type="doi">10.1038/s42255-019-0089-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>An elongation- and ligation-based qPCR amplification method for the radiolabeling-free detection of locus-specific N(6)-methyladenosine modification</article-title>
        <source>Angew Chem Int Ed Engl</source>
        <year>2018</year>
        <volume>57</volume>
        <fpage>15995</fpage>
        <lpage>16000</lpage>
        <pub-id pub-id-type="doi">10.1002/anie.201807942</pub-id>
        <pub-id pub-id-type="pmid">30345651</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conesa</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Madrigal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tarazona</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gomez-Cabrero</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cervera</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Szczesniak</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Gaffney</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Elo</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Mortazavi</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A survey of best practices for RNA-seq data analysis</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>13</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0881-8</pub-id>
        <pub-id pub-id-type="pmid">26813401</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">McIntyre ABR, Gokhale NS, Cerchietti L, Jaffrey SR, Horner SM, Mason CE: Limits in the detection of m6A changes using MeRIP/m6A-seq. bioRxiv 2019.</mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yoon</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Ringeling</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Vissers</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jacob</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Pokrass</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jimenez-Cyrus</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>NS</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Temporal control of mammalian cortical neurogenesis by m(6)A methylation</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <fpage>877</fpage>
        <lpage>889</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.09.003</pub-id>
        <pub-id pub-id-type="pmid">28965759</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Langmead</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
        </person-group>
        <article-title>HISAT: a fast spliced aligner with low memory requirements</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>357</fpage>
        <lpage>360</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3317</pub-id>
        <pub-id pub-id-type="pmid">25751142</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawrence</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Pages</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Aboyoun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Morgan</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
        </person-group>
        <article-title>Software for computing and annotating genomic ranges</article-title>
        <source>PLoS Comput Biol</source>
        <year>2013</year>
        <volume>9</volume>
        <fpage>e1003118</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003118</pub-id>
        <pub-id pub-id-type="pmid">23950696</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Morgan M, Pag’es He, Obenchain V, Hayden N: Rsamtools: binary alignment (BAM), FASTA, variant call (BCF), and tabix file import. 2018.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tarasov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vilella</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Cuppen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Nijman</surname>
            <given-names>IJ</given-names>
          </name>
          <name>
            <surname>Prins</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Sambamba: fast processing of NGS alignment formats</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <fpage>2032</fpage>
        <lpage>2034</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv098</pub-id>
        <pub-id pub-id-type="pmid">25697820</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heinz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Benner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Spann</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Bertolino</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>YC</given-names>
          </name>
          <name>
            <surname>Laslo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>JX</given-names>
          </name>
          <name>
            <surname>Murre</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Glass</surname>
            <given-names>CK</given-names>
          </name>
        </person-group>
        <article-title>Simple combinations of lineage-determining transcription factors prime cis-regulatory elements required for macrophage and B cell identities</article-title>
        <source>Mol Cell</source>
        <year>2010</year>
        <volume>38</volume>
        <fpage>576</fpage>
        <lpage>589</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2010.05.004</pub-id>
        <pub-id pub-id-type="pmid">20513432</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cui</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S-W</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Meng</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Guitar: an R/Bioconductor package for gene annotation guided transcriptomic analysis of RNA-related genomic features</article-title>
        <source>Biomed Res Int</source>
        <year>2016</year>
        <volume>2016</volume>
        <fpage>8</fpage>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Furumichi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tanabe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Morishima</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>KEGG: new perspectives on genomes, pathways, diseases and drugs</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <fpage>D353</fpage>
        <lpage>D361</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw1092</pub-id>
        <pub-id pub-id-type="pmid">27899662</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>LG</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>QY</given-names>
          </name>
        </person-group>
        <article-title>clusterProfiler: an R package for comparing biological themes among gene clusters</article-title>
        <source>OMICS</source>
        <year>2012</year>
        <volume>16</volume>
        <fpage>284</fpage>
        <lpage>287</lpage>
        <pub-id pub-id-type="doi">10.1089/omi.2011.0118</pub-id>
        <pub-id pub-id-type="pmid">22455463</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Zhang, Z., Zhan Q., Eckert M., Zhu A. , Chryplewicz A., De Jesus D.F. , et al. RADAR: differential analysis of MeRIP-seq data with a random effect model. Github. <ext-link ext-link-type="uri" xlink:href="https://github.com/scottzijiezhang/RADAR">https://github.com/scottzijiezhang/RADAR</ext-link> (2019).</mixed-citation>
    </ref>
  </ref-list>
</back>
