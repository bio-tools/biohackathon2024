<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8275345</article-id>
    <article-id pub-id-type="pmid">34252925</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab273</article-id>
    <article-id pub-id-type="publisher-id">btab273</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Regulatory and Functional Genomics</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scPNMF: sparse gene encoding of single cells to facilitate gene selection for targeted gene profiling</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Dongyuan</given-names>
        </name>
        <aff><institution>Bioinformatics Interdepartmental Ph.D. Program, University of California</institution>, Los Angeles, CA 90095-7246, <country country="US">USA</country></aff>
        <xref rid="btab273-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Kexin</given-names>
        </name>
        <aff><institution>Department of Statistics, University of California</institution>, Los Angeles, CA 90095-1554, <country country="US">USA</country></aff>
        <xref rid="btab273-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hemminger</surname>
          <given-names>Zachary</given-names>
        </name>
        <aff><institution>Institute for Quantitative and Computational Biosciences, University of California</institution>, Los Angeles, CA 90095, <country country="US">USA</country></aff>
        <aff><institution>Department of Integrative Biology and Physiology, University of California</institution>, Los Angeles, CA 90095-7239, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wollman</surname>
          <given-names>Roy</given-names>
        </name>
        <aff><institution>Institute for Quantitative and Computational Biosciences, University of California</institution>, Los Angeles, CA 90095, <country country="US">USA</country></aff>
        <aff><institution>Department of Integrative Biology and Physiology, University of California</institution>, Los Angeles, CA 90095-7239, <country country="US">USA</country></aff>
        <aff><institution>Department of Chemistry and Biochemistry, University of California</institution>, Los Angeles, CA 90095-1569, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Li</surname>
          <given-names>Jingyi Jessica</given-names>
        </name>
        <aff><institution>Department of Statistics, University of California</institution>, Los Angeles, CA 90095-1554, <country country="US">USA</country></aff>
        <aff><institution>Department of Human Genetics, University of California</institution>, Los Angeles, CA 90095-7088, <country country="US">USA</country></aff>
        <aff><institution>Department of Computational Medicine, University of California</institution>, Los Angeles, CA 90095-1766, <country country="US">USA</country></aff>
        <aff><institution>Department of Biostatistics, University of California Los Angeles</institution>, CA 90095-1772, <country country="US">USA</country></aff>
        <xref rid="btab273-cor1" ref-type="corresp"/>
        <!--jli@stat.ucla.edu-->
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btab273-FM1">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="btab273-cor1">To whom correspondence should be addressed. <email>jli@stat.ucla.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-07-12">
      <day>12</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>Suppl 1</issue>
    <issue-title>ISMB/ECCB 2021 Proceedings</issue-title>
    <fpage>i358</fpage>
    <lpage>i366</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab273.pdf"/>
    <abstract>
      <title>ABSTRACT:</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-cell RNA sequencing (scRNA-seq) captures whole transcriptome information of individual cells. While scRNA-seq measures thousands of genes, researchers are often interested in only dozens to hundreds of genes for a closer study. Then, a question is how to select those informative genes from scRNA-seq data. Moreover, single-cell targeted gene profiling technologies are gaining popularity for their low costs, high sensitivity and extra (e.g. spatial) information; however, they typically can only measure up to a few hundred genes. Then another challenging question is how to select genes for targeted gene profiling based on existing scRNA-seq data.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we develop the single-cell Projective Non-negative Matrix Factorization (scPNMF) method to select informative genes from scRNA-seq data in an unsupervised way. Compared with existing gene selection methods, scPNMF has two advantages. First, its selected informative genes can better distinguish cell types. Second, it enables the alignment of new targeted gene profiling data with reference data in a low-dimensional space to facilitate the prediction of cell types in the new data. Technically, scPNMF modifies the PNMF algorithm for gene selection by changing the initialization and adding a basis selection step, which selects informative bases to distinguish cell types. We demonstrate that scPNMF outperforms the state-of-the-art gene selection methods on diverse scRNA-seq datasets. Moreover, we show that scPNMF can guide the design of targeted gene profiling experiments and the cell-type annotation on targeted gene profiling data.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The R package is open-access and available at <ext-link xlink:href="https://github.com/JSB-UCLA/scPNMF" ext-link-type="uri">https://github.com/JSB-UCLA/scPNMF</ext-link>. The data used in this work are available at Zenodo: <ext-link xlink:href="10.5281/zenodo.4797997" ext-link-type="doi">https://doi.org/10.5281/zenodo.4797997</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
        <award-id>DBI-1846216</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIGMS</institution>
            <institution-id institution-id-type="DOI">10.13039/100000057</institution-id>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
        <award-id>R01GM120507</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Johnson &amp; Johnson WiSTEM2D Award</institution>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Sloan Research Fellowship</institution>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>UCLA David Geffen School of Medicine W.M. Keck Foundation Junior Faculty Award</institution>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NINDS</institution>
            <institution-id institution-id-type="DOI">10.13039/100000065</institution-id>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
        <award-id>R01NS117148</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The recent development of single-cell RNA sequencing (scRNA-seq) technologies provides unprecedented opportunities to decipher transcriptome heterogeneity among individual cells (<xref rid="btab273-B5" ref-type="bibr">Birnbaum, 2018</xref>; <xref rid="btab273-B28" ref-type="bibr">Potter, 2018</xref>; <xref rid="btab273-B42" ref-type="bibr">Zhu <italic toggle="yes">et al.</italic>, 2020</xref>). A typical scRNA-seq dataset contains thousands to tens of thousands of genes; however, a subset of genes, which we call <italic toggle="yes">informative genes</italic>, are usually sufficient for representing the underlying biological variations of cells in the dataset for two reasons. First, variations of many genes are not related to the biological variations of interest. For instance, fluctuations in the expression levels of housekeeping genes are irrelevant to cell types (<xref rid="btab273-B15" ref-type="bibr">Eisenberg and Levanon, 2013</xref>; <xref rid="btab273-B34" ref-type="bibr">Thellin <italic toggle="yes">et al.</italic>, 1999</xref>). Second, many genes have strongly correlated expression levels, suggesting that one gene may represent a group of genes without much loss of information (<xref rid="btab273-B32" ref-type="bibr">Subramanian <italic toggle="yes">et al.</italic>, 2017</xref>). Therefore, for scRNA-seq data analysis, informative gene selection has three advantages: (i) enhancing biological signals by removing unwanted technical variations, (ii) improving the interpretability of analysis results by focusing on informative genes and (iii) reducing the number of genes to save computational resources.</p>
    <p>Besides scRNA-seq data analysis, informative gene selection is also crucial for designing single-cell targeted gene profiling experiments, which we define to include all technologies that measure only a specific set of genes’ expression levels in individual cells. Unlike scRNA-seq, targeted gene profiling requires a limited number (often no more than hundreds) of genes to be specified before sequencing. Examples of targeted gene profiling include spatial technologies [e.g. smFISH (<xref rid="btab273-B29" ref-type="bibr">Raj <italic toggle="yes">et al.</italic>, 2008</xref>) and MERFISH (<xref rid="btab273-B25" ref-type="bibr">Moffitt <italic toggle="yes">et al.</italic>, 2016</xref>)] and non-spatial technologies [e.g. BART-Seq (<xref rid="btab273-B35" ref-type="bibr">Uzbas <italic toggle="yes">et al.</italic>, 2019</xref>), HyPR-seq (<xref rid="btab273-B24" ref-type="bibr">Marshall <italic toggle="yes">et al.</italic>, 2020</xref>) and 10x-Genomics Targeted Gene Expression]. Compared with scRNA-seq, targeted gene profiling technologies have advantages such as capturing spatial information (by smFISH and MERFISH), having a lower cost per cell (by BART-Seq), and exhibiting a higher sensitivity for detecting lowly expressed genes (by HyPR-seq). However, it remains an open and challenging question to optimize the gene selection for targeted gene profiling under a gene number limitation.</p>
    <p>Given the importance of informative gene selection, researchers have developed many gene selection methods for scRNA-seq data. Most existing methods select genes based on the relationship between per-gene expression means and per-gene expression variances (with the mean and variance of each gene calculated across cells). Popular example methods include variance stabilization transformation (vst) (<xref rid="btab273-B18" ref-type="bibr">Hafemeister and Satija, 2019</xref>) and mean–variance plot (mvp) in the R package Seurat (<xref rid="btab273-B31" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>), as well as modelGeneVar in the R package scran (<xref rid="btab273-B22" ref-type="bibr">Lun <italic toggle="yes">et al.</italic>, 2016</xref>). These methods select highly variable genes that have large expression variances in relation to their expression means. Other methods use various metrics of gene importance instead of the per-gene expression variance. For example, M3Drop selects the genes that have zero expression levels in many cells (<xref rid="btab273-B2" ref-type="bibr">Andrews and Hemberg, 2019</xref>); GiniClust selects the genes with large Gini indices of expression levels (<xref rid="btab273-B19" ref-type="bibr">Jiang <italic toggle="yes">et al.</italic>, 2016</xref>); SCMarker selects the genes that have expression levels bi/multimodally distributed and are coexpressed or mutually exclusively expressed with some other genes (<xref rid="btab273-B36" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2019</xref>). A common limitation of these existing methods is that they are all designed to select a relatively large number of genes; thus, their performance for selecting a small number of genes remains unclear. For instance, in Seurat, the default gene number is 2000; SCMarker selects 700–900 genes in its exemplar applications (<xref rid="btab273-B36" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2019</xref>). All these gene numbers are much greater than 200, the maximum gene number allowed by multiple targeted gene profiling technologies. Therefore, existing gene selection methods may not be suitable for selecting genes for targeted gene profiling. Another drawback of these methods is that their selected genes lack functional interpretability; that is, their selected genes are not categorized as functional gene groups.</p>
    <p>In addition to these gene selection methods, linear dimensionality reduction methods, such as principal component analysis (PCA) and non-negative matrix factorization (NMF), can also be used for gene selection. Specifically, genes can be selected based on their contributions to the projected low dimensions found by PCA or NMF (<xref rid="btab273-B4" ref-type="bibr">Baron <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab273-B23" ref-type="bibr">Macosko <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab273-B50" ref-type="bibr">Ye and Li, 2016</xref>; <xref rid="btab273-B43" ref-type="bibr">Zhu <italic toggle="yes">et al.</italic>, 2017</xref>). Although many variants of PCA and NMF algorithms have been developed for scRNA-seq data analysis, they are not designed for gene selection (<xref rid="btab273-B7" ref-type="bibr">Boileau <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab273-B13" ref-type="bibr">Duren <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab273-B14" ref-type="bibr">Durif <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab273-B17" ref-type="bibr">Gao and Welch, 2020</xref>; <xref rid="btab273-B37" ref-type="bibr">Welch <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab273-B38" ref-type="bibr">Yang and Michailidis, 2016</xref>; <xref rid="btab273-B41" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
    <p>Here, we propose an unsupervised method scPNMF to simultaneously select informative genes and project scRNA-seq data onto an interpretable low-dimensional space. Leveraging the Projective Non-negative Matrix Factorization (PNMF) algorithm (<xref rid="btab273-B40" ref-type="bibr">Yuan <italic toggle="yes">et al.</italic>, 2009</xref>), scPNMF combines the advantages of PCA and NMF by outputting a non-negative sparse weight matrix that can project cells in a high-dimensional scRNA-seq dataset onto a low-dimensional space. Unlike the weight matrix (a.k.a., loading matrix) found by PCA, the non-negative sparse weight matrix output by scPNMF corresponds to bases that each corresponds to a group of coexpressed genes. Compared with the original PNMF, a unique feature of scPNMF is basis selection: scPNMF uses correlation screening and multimodality testing to remove the bases that cannot reveal potential cell clusters in the input scRNA-seq dataset. There are two functionalities of scPNMF: (i) given a prespecified gene number and a scRNA-seq dataset, scPNMF selects informative genes based on its weight matrix; (ii) given a targeted gene profiling dataset containing the informative genes, scPNMF projects this dataset onto the same low-dimensional space of a reference scRNA-seq dataset containing cell-type labels, thus enabling cell-type annotation on the targeted gene profiling dataset. A comprehensive benchmark shows that scPNMF outperforms existing gene selection methods in two aspects. First, the informative genes selected by scPNMF lead to the most accurate cell clustering. Second, the informative genes and weight matrix of scPNMF lead to the best cell-type prediction accuracy for targeted gene profiling data. Therefore, scPNMF is a powerful gene selection method that can guide the experimental design and data analysis of single-cell targeted gene profiling.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>The core of scPNMF is to learn a low-dimensional embedding of cells so that the bases of the low-dimensional space correspond to sparse and mutually exclusive gene groups, and that genes in each group are coexpressed and thus functionally related. <xref rid="btab273-F1" ref-type="fig">Figure 1</xref> illustrates the workflow of scPNMF. The input of scPNMF is a log-transformed gene-by-cell count matrix measured by scRNA-seq. There are two main steps in scPNMF: (i) it learns a low-dimensional sparse weight matrix by PNMF; (ii) it selects bases in the weight matrix based on functional annotations (optional), correlation screening and multimodality testing to remove uninformative bases that cannot distinguish cell types. The output of scPNMF includes (i) the selected weight matrix, a sparse and mutually exclusive encoding of genes as new, low dimensions and (ii) the score matrix containing embeddings of input cells in the low dimensions. The selected weight matrix has two main applications: extracting informative genes for downstream analyses, such as cell clustering and new marker gene identification, and projecting new targeted gene profiling data for data integration and cell-type annotation.</p>
    <fig position="float" id="btab273-F1">
      <label>Fig. 1</label>
      <caption>
        <p>An overview of scPNMF. Taking a log-transformed gene-by-cell count matrix as the input, scPNMF first learns a low-dimensional sparse weight matrix <bold>W</bold> and a low-dimensional cell embedding matrix <bold>S</bold>. Second, it removes the bases irrelevant to cell-type variations by examining bases’ functional annotations (optional), Pearson correlations with cell library sizes, and multimodality. Given a user-defined gene number <italic toggle="yes">M</italic>, scPNMF performs <italic toggle="yes">M</italic>-truncation to facilitate two main applications: (1) selecting the desired number of informative genes; (2) projecting new targeted gene profiling data onto the low-dimensional space defined by reference scRNA-seq data. The details are in the Methods section.</p>
      </caption>
      <graphic xlink:href="btab273f1" position="float"/>
    </fig>
    <sec>
      <title>2.1 scPNMF Step I: PNMF</title>
      <p>In this section, we review the PNMF algorithm (<xref rid="btab273-B40" ref-type="bibr">Yuan <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btab273-B39" ref-type="bibr">Yang and Oja, 2010</xref>) as the foundation of scPNMF. We first compare the formulation of PNMF with that of PCA and NMF, and we show that PNMF has the advantages of both PCA and NMF so that it can be a useful tool for scRNA-seq data analysis. Next, we introduce our PNMF implementation.</p>
      <p>Given a log-transformed count matrix <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, whose <italic toggle="yes">p</italic> rows correspond to genes and whose <italic toggle="yes">n</italic> columns represent cells, and a positive integer <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>K</mml:mi><mml:mo>≤</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>, PNMF aims to find a <italic toggle="yes">K</italic>-dimensional space, whose dimensions correspond to non-negative, sparse and mutually exclusive linear combinations of the <italic toggle="yes">p</italic> genes, so that projecting the <italic toggle="yes">n</italic> cells onto the <italic toggle="yes">K</italic>-dimensional space does not cause much information loss (i.e. projecting the <italic toggle="yes">K</italic>-dimensional embeddings of the <italic toggle="yes">n</italic> cells back to the original <italic toggle="yes">p</italic>-dimensional space can largely restore the original <italic toggle="yes">n</italic> cells). PNMF tackles this task by solving the optimization problem:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:munder><mml:mi>min</mml:mi><mml:mrow><mml:mi mathvariant="bold">W</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">W</mml:mi><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo>·</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> denotes the Frobenius matrix norm. The solution <bold>W</bold> is referred to as a <italic toggle="yes">weight matrix</italic>. Each column of <bold>W</bold> is a <italic toggle="yes">basis</italic>, whose <italic toggle="yes">p</italic> entries are the weights of the <italic toggle="yes">p</italic> genes. PNMF requires all weights to be non-negative, leading to a sparse <bold>W</bold> with most weights as zeros.</p>
      <p>PCA is similar to PNMF but does not require all weights to be non-negative. We can write the optimization problem of PCA as
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:munder><mml:mi>min</mml:mi><mml:mrow><mml:mi mathvariant="bold">W</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">I</mml:mi></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">W</mml:mi><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>whose solution <bold>W</bold> is also a weight matrix but not sparse, and <bold>W</bold> is often referred to as the loading matrix.</p>
      <p>A common property of PNMF and PCA is that the transpose of their weight matrix, <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, can be used to project a new cell with <italic toggle="yes">p</italic> gene measurements, <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, onto the <italic toggle="yes">K</italic>-dimensional space as <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">x</mml:mi></mml:math></inline-formula>.</p>
      <p>In contrast to PNMF and PCA, NMF finds two non-negative matrices <bold>W</bold> and <bold>H</bold> so that their product approximates the original matrix <bold>X</bold>. NMF solves the optimization problem:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:munder><mml:mi>min</mml:mi><mml:mrow><mml:mi mathvariant="bold">W</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="bold">H</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">W</mml:mi><mml:mi mathvariant="bold">H</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mo> </mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>whose solution <bold>W</bold> still has <italic toggle="yes">K</italic> columns representing bases, and <bold>H</bold> has <italic toggle="yes">n</italic> columns as <italic toggle="yes">K</italic>-dimensional embeddings of the <italic toggle="yes">n</italic> cells. Due to the non-negative constraint on <bold>W</bold> and <bold>H</bold>, <bold>W</bold> is a sparse matrix (<xref rid="btab273-B21" ref-type="bibr">Lee and Seung, 1999</xref>). However, the transpose <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:math></inline-formula> cannot be used as a projection matrix from the original <italic toggle="yes">p</italic>-dimensional space to a <italic toggle="yes">K</italic>-dimensional space. The reason is that, if <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:math></inline-formula> is a projection matrix, then by the definition of <bold>H</bold> we have <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">H</mml:mi></mml:math></inline-formula>, which would convert the objective function (3) of NMF to the objective function (1) of PNMF. In other words, PNMF is a constrained version of NMF by requiring <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:math></inline-formula> to be a projection matrix. Hence, PNMF inherits the property of NMF by having non-negative, sparse bases that are mostly mutually exclusive (i.e., different bases correspond to different gene groups). Moreover, based on the similarities of the objective functions of PNMF (1) and PCA (2), we can see that PNMF also resembles PCA by finding a weight matrix whose transpose can serve as a projection matrix and whose bases are largely orthogonal to each other. <xref rid="btab273-T1" ref-type="table">Table 1</xref> summarizes the properties of PNMF, PCA and NMF.</p>
      <table-wrap position="float" id="btab273-T1">
        <label>Table 1</label>
        <caption>
          <p>Comparison of the properties of PNMF, PCA and NMF</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">Optimization problem</th>
              <th rowspan="1" colspan="1">Non-negativity</th>
              <th rowspan="1" colspan="1">Sparsity</th>
              <th rowspan="1" colspan="1">Mutual exclusiveness</th>
              <th rowspan="1" colspan="1">New data projection</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">PNMF</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE11">
                  <mml:math id="IM11" display="inline" overflow="scroll">
                    <mml:munder>
                      <mml:mi>min</mml:mi>
                      <mml:mi mathvariant="bold">W</mml:mi>
                    </mml:munder>
                    <mml:mo>|</mml:mo>
                    <mml:mo>|</mml:mo>
                    <mml:mi mathvariant="bold">X</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mi mathvariant="bold">W</mml:mi>
                    <mml:msup>
                      <mml:mi mathvariant="bold">W</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:mi mathvariant="bold">X</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:mo>|</mml:mo>
                    <mml:mo> </mml:mo>
                    <mml:mi>s</mml:mi>
                    <mml:mo>.</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>.</mml:mo>
                    <mml:mo> </mml:mo>
                    <mml:mi mathvariant="bold">W</mml:mi>
                    <mml:mo>≥</mml:mo>
                    <mml:mn>0</mml:mn>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">Yes</td>
              <td rowspan="1" colspan="1">Very high</td>
              <td rowspan="1" colspan="1">Very high</td>
              <td rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">PCA</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE12">
                  <mml:math id="IM12" display="inline" overflow="scroll">
                    <mml:munder>
                      <mml:mi>min</mml:mi>
                      <mml:mi mathvariant="bold">W</mml:mi>
                    </mml:munder>
                    <mml:mo>|</mml:mo>
                    <mml:mo>|</mml:mo>
                    <mml:mi mathvariant="bold">X</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mi mathvariant="bold">W</mml:mi>
                    <mml:msup>
                      <mml:mi mathvariant="bold">W</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:mi mathvariant="bold">X</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:mo>|</mml:mo>
                    <mml:mo> </mml:mo>
                    <mml:mi>s</mml:mi>
                    <mml:mo>.</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>.</mml:mo>
                    <mml:mo> </mml:mo>
                    <mml:msup>
                      <mml:mi mathvariant="bold">W</mml:mi>
                      <mml:mi>T</mml:mi>
                    </mml:msup>
                    <mml:mi mathvariant="bold">W</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mi mathvariant="bold">I</mml:mi>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">No</td>
              <td rowspan="1" colspan="1">Low</td>
              <td rowspan="1" colspan="1">Low</td>
              <td rowspan="1" colspan="1">Yes</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">NMF</td>
              <td rowspan="1" colspan="1">
                <inline-formula id="IE13">
                  <mml:math id="IM13" display="inline" overflow="scroll">
                    <mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>min</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="bold">W</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi mathvariant="bold">H</mml:mi>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mo>|</mml:mo>
                      <mml:mo>|</mml:mo>
                      <mml:mi mathvariant="bold">X</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mi mathvariant="bold">W</mml:mi>
                      <mml:mi mathvariant="bold">H</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:mo>|</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi>s</mml:mi>
                      <mml:mo>.</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>.</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mi mathvariant="bold">W</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi mathvariant="bold">H</mml:mi>
                      <mml:mo>≥</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">Yes</td>
              <td rowspan="1" colspan="1">High</td>
              <td rowspan="1" colspan="1">High</td>
              <td rowspan="1" colspan="1">No</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>In the context of scRNA-seq data analysis, the above advantages of PNMF lead to an interpretable and useful weight matrix <bold>W</bold>. First, the high sparsity of <bold>W</bold> makes each basis (column) depend on only a small set of genes, which has been defined as a <italic toggle="yes">meta-gene</italic> for NMF (<xref rid="btab273-B10" ref-type="bibr">Brunet <italic toggle="yes">et al.</italic>, 2004</xref>). Second, the mutual exclusiveness of <bold>W</bold> makes different bases correspond to different gene sets, easing the interpretation of bases as meta-genes or functional units. Third, the projection matrix <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:math></inline-formula> allows the alignment of new data to reference data, thus facilitating cell-type annotation on the new data.<boxed-text id="btab273-BOX1" position="float"><sec><title><bold>Algorithm 1</bold> Pseudocode of PNMF implementation in scPNMF</title><p><bold>Initialize:</bold>  <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">W</mml:mi><mml:mo>=</mml:mo><mml:mtext>abs</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mtext>PCA</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></p><p>1: <bold>while</bold> not converge <bold>do</bold></p><p>2:  <bold>for</bold>  <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>; <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>  <bold>do</bold></p><p>3:   <inline-formula id="E4"><mml:math id="IM18" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">W</mml:mi><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula></p><p>4:  <bold>end for</bold></p><p>5:  <inline-formula id="E5"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">W</mml:mi><mml:mo>←</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">W</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mi mathvariant="bold">W</mml:mi></mml:mrow></mml:math></inline-formula></p><p>6: <bold>end while</bold></p><p><bold>Output</bold>: <inline-formula id="IE18"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mi mathvariant="bold">W</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></p></sec></boxed-text>Algorithm 1 summarizes the key steps of PNMF implementation in scPNMF. Our implementation mainly follows the two papers that proposed the PNMF algorithm (<xref rid="btab273-B39" ref-type="bibr">Yang and Oja, 2010</xref>; <xref rid="btab273-B40" ref-type="bibr">Yuan <italic toggle="yes">et al.</italic>, 2009</xref>), and we change the initialization of <bold>W</bold> to the weight matrix found by PCA, <inline-formula id="IE19"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mtext>PCA</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, with the absolute value taken on every entry. Our initialization is motivated by the desired orthogonality of bases (i.e. columns of <bold>W</bold>).</p>
      <p>With the weight matrix <inline-formula id="IE20"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">W</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> learned by PNMF, we obtain the <italic toggle="yes">score matrix</italic> <inline-formula id="IE21"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mi mathvariant="bold">S</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi mathvariant="bold">W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, whose <italic toggle="yes">K</italic> rows correspond to the bases and whose <italic toggle="yes">n</italic> columns represent the cells. Specifically, the <italic toggle="yes">j</italic>th column of <bold>S</bold> is the <italic toggle="yes">K</italic>-dimensional embedding of the <italic toggle="yes">j</italic>th cell; the <italic toggle="yes">k</italic>th row of <bold>S</bold>, denoted by <inline-formula id="IE22"><mml:math id="IM24" display="inline" overflow="scroll"><mml:msup><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:msup></mml:math></inline-formula>, contains the <italic toggle="yes">scores</italic> (i.e. coordinates) of all <italic toggle="yes">n</italic> cells in the <italic toggle="yes">k</italic>th basis:
<disp-formula id="E6"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:msup><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:msub><mml:mi mathvariant="bold-italic">w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE23"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">w</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the <italic toggle="yes">k</italic>th column of <bold>W</bold>, <inline-formula id="IE24"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      <p>The low rank <italic toggle="yes">K</italic> needs to be prespecified in PNMF, same as in PCA and NMF. A larger <italic toggle="yes">K</italic> preserves more information in <bold>X</bold> but also removes less noise (technical variation of cells that is not of biological interest), impedes the interpretation of <bold>W</bold> (more bases are more difficult to interpret) and increases the computational burden. To choose <italic toggle="yes">K</italic> in a data-driven way, we propose an orthogonality measure, which shows that <italic toggle="yes">K </italic>=<italic toggle="yes"> </italic>20 is a reasonable choice for multiple scRNA-seq datasets (Supplementary Section S1.1).</p>
    </sec>
    <sec>
      <title>2.2 scPNMF Step II: basis selection</title>
      <p>The second key step of scPNMF is to select informative bases among the <italic toggle="yes">K</italic> bases found by PNMF (i.e. columns of <bold>W</bold> and rows of <bold>S</bold>) to remove unwanted variations of cells (e.g. variations irrelevant to cell types). The columns of <bold>W</bold> enjoy high sparsity and mutual exclusiveness; that is, each column contains positive weights corresponding to a unique small set of genes, so it is expected to reflect a certain biological function. However, some biological functions may not be relevant to the cell heterogeneity of interest, for example, cell-type composition. Motivated by this, we propose three strategies for selecting informative bases (columns of <bold>W</bold> and rows of <bold>S</bold>): functional annotations (optional), correlations with cell library sizes and tests of multimodality.</p>
      <sec>
        <title>2.2.1 Strategy 1: examine bases by functional annotations (optional)</title>
        <p>The first, optional strategy is to annotate the biological function(s) of each basis in the weight matrix. For example, scPNMF may apply gene ontology (GO) analysis to the top 10% genes with the highest weights in each basis (column of <bold>W</bold>) and record the enriched GO terms as the basis’ functional annotation. Then, users with prior knowledge can interpret the functional annotation on each basis and decide whether or not to remove the basis. For example, if the goal is to delineate cell types in scRNA-seq data, a basis corresponding to cell-cycle genes should be removed because they would obscure the distinction of cell types.</p>
        <p>However, it is worth noting that filtering bases by biological annotations is optional in scPNMF. Conservative users can keep all <italic toggle="yes">K</italic> bases output by PNMF and directly use data-driven basis selection (Section 2.2.2). For our results in this article, scPNMF removes the bases corresponding to well-known housekeeping genes (Supplementary Section S2).</p>
      </sec>
      <sec>
        <title>2.2.2 Data-driven strategies</title>
        <sec>
          <title>2.2.2.1 Strategy 2: examine bases by correlations with cell library sizes</title>
          <p>Note that the input of scPNMF is a log-transformed unnormalized count matrix for users’ convenience. Hence, scPNMF does not adjust for cell library sizes in the computation of <bold>W</bold> and <bold>S</bold> in Step I. (For a detailed discussion on why scPNMF uses unnormalized data as input, see Supplementary Section S6.) Given that the variance of cell library sizes contributes to unwanted variations of cells (<xref rid="btab273-B18" ref-type="bibr">Hafemeister and Satija, 2019</xref>), it is necessary to remove the bases whose corresponding rows in <bold>S</bold> are strongly correlated with cell library sizes.</p>
          <p>We use the total log-transformed counts to approximate the library size of each cell, and we calculate the Pearson correlation between each <inline-formula id="IE25"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and the library sizes of <italic toggle="yes">n</italic> cells. The strategy is to retain the bases whose Pearson correlations are under a pre-defined threshold, which we set to 0.7 based on empirical observations (Supplementary Section S1.2).</p>
        </sec>
        <sec>
          <title>2.2.2.2 Strategy 3: examine bases by multimodality tests</title>
          <p>Another data-driven strategy is to retain the bases whose corresponding scores are multimodally distributed. If a basis’ score vector (row in <bold>S</bold>) contains <italic toggle="yes">n</italic> scores with a multimodality pattern, then it is likely to distinguish cell types and should be retained. To implement this strategy, we use the ACR test (<xref rid="btab273-B1" ref-type="bibr">Ameijeiras-Alonso <italic toggle="yes">et al.</italic>, 2019</xref>) to check the multimodality of each basis’ score vector. The null hypothesis is that the score vector contains <italic toggle="yes">n</italic> scores sampled from a unimodal distribution, and the alternative hypothesis is that the distribution has more than one mode. After performing multiple multimodality tests, one per basis, we use the Benjamini–Hochberg procedure to set a <italic toggle="yes">P</italic>-value threshold by controlling the false discovery rate under 1%. The bases whose <italic toggle="yes">P-</italic>values are under this threshold will be retained.</p>
          <p>In summary, scPNMF step II allows users to use Strategy 1 to filter out uninformative bases based on functional annotations if available; then it implements data-driven Strategies 2 and 3 to further remove bases that have strong correlations with cell library sizes and exhibit unimodality patterns. The retained bases will have their corresponding columns in <bold>W</bold> selected and stacked into the <italic toggle="yes">selected weight matrix</italic> <inline-formula id="IE26"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">K</italic><sub>0</sub> is the number of selected bases.</p>
        </sec>
      </sec>
    </sec>
    <sec>
      <title>2.3 Applications of scPNMF output: informative gene selection and new data projection</title>
      <p>The selected weight matrix <inline-formula id="IE27"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> output by scPNMF has two main applications: selection of a desired number of informative genes and projection of new targeted gene profiling data onto the low-dimensional space defined by <inline-formula id="IE28"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Given a gene number <italic toggle="yes">M</italic> (e.g. 200), scPNMF uses <italic toggle="yes">M</italic>-truncation, a step to select <italic toggle="yes">M</italic> rows in <inline-formula id="IE29"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, resulting in <italic toggle="yes">M</italic> informative genes and a <italic toggle="yes">truncated, selected weight matrix</italic> <inline-formula id="IE30"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> for new data projection.</p>
      <sec>
        <title>2.3.1 <italic toggle="yes">M</italic>-Truncation and informative gene selection</title>
        <p>We denote the desired number of informative genes by <inline-formula id="IE31"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow></mml:math></inline-formula>, with <inline-formula id="IE32"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mi>M</mml:mi><mml:mo>≤</mml:mo><mml:mo>#</mml:mo><mml:mo> </mml:mo><mml:mtext>of nonzero rows in </mml:mtext><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:math></inline-formula>. <italic toggle="yes">M</italic>-truncation has three steps.
</p>
        <list list-type="simple">
          <list-item>
            <p>3.1. Truncate the selected weight matrix <inline-formula id="IE38"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> by setting all <inline-formula id="IE39"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to be 0;</p>
          </list-item>
          <list-item>
            <p>3.2. Keep the <italic toggle="yes">M</italic> rows with nonzero entries; stack them by row into <inline-formula id="IE40"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> based on the order of the informative genes.</p>
          </list-item>
        </list>
        <p>In short, scPNMF selects informative genes based on their maximum weights in the selected bases. The rationale is that a gene’s maximum weight reflects the gene’s contribution to the establishment of the <italic toggle="yes">K</italic><sub>0</sub>-dimensional space, which preserves the <italic toggle="yes">n</italic> cells’ biological variations of interest. Hence, genes with larger maximum weights are more informative in the sense of encoding cells’ biological variations. An important application of informative gene selection is to guide the design of targeted gene profiling experiments.</p>
      </sec>
      <sec>
        <title>2.3.2 New data projection</title>
        <p>Given the selected <italic toggle="yes">M</italic> informative genes, once new cells are measured by targeted gene profiling on these genes, <inline-formula id="IE41"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> can be used to project the new cells onto the <italic toggle="yes">K</italic><sub>0</sub>-dimensional space where the cells in the input scRNA-seq data are embedded in. If the input data has cell-type annotations, we refer to the input data as <italic toggle="yes">reference data</italic>, then we can predict the new cells’ types from the types of the cells in the reference data. In detail, new data projection has the following steps:
</p>
        <list list-type="order">
          <list-item>
            <p>Apply scPNMF with <italic toggle="yes">M</italic>-truncation to input, reference data <inline-formula id="IE42"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> with <italic toggle="yes">n</italic> cells to obtain the truncated, selected weight matrix <inline-formula id="IE43"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Construct <inline-formula id="IE44"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> as a submatrix of <bold>X</bold>, with rows corresponding to the rows of <inline-formula id="IE45"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">W</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, that is, the <italic toggle="yes">M</italic> informative genes. Hence, the <italic toggle="yes">K</italic><sub>0</sub>-dimensional embeddings of the <italic toggle="yes">n</italic> cells in the reference data are the columns of
<disp-formula id="E7"><label>(6)</label><mml:math id="M5" display="block" overflow="scroll"><mml:msubsup><mml:mi mathvariant="bold">S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext>Ref</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:msup><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula></p>
          </list-item>
          <list-item>
            <p>Denote the targeted gene profiling data of <inline-formula id="IE46"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> new cells with <italic toggle="yes">M</italic> informative genes measured by <inline-formula id="IE47"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>New</mml:mtext></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. Note that <inline-formula id="IE48"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>New</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> contains log-transformed counts and has rows (genes) corresponding to the rows of <inline-formula id="IE49"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Project the <inline-formula id="IE50"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> cells to the <italic toggle="yes">K</italic><sub>0</sub>-dimensional space by
<disp-formula id="E8"><label>(7)</label><mml:math id="M6" display="block" overflow="scroll"><mml:msubsup><mml:mi mathvariant="bold">S</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext>New</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:msub><mml:mi mathvariant="bold">W</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mi>T</mml:mi></mml:msup><mml:mo>×</mml:mo><mml:msubsup><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext>New</mml:mtext></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mi mathvariant="normal">ℝ</mml:mi><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>n</mml:mi><mml:mo>`</mml:mo></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula></p>
          </list-item>
          <list-item>
            <p>(Optional) Normalize <inline-formula id="IE51"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>New</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE52"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>Ref</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> to remove batch effects, if existent, by using a single-cell data integration method such as Harmony (<xref rid="btab273-B20" ref-type="bibr">Korsunsky <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
          </list-item>
        </list>
        <p>Now the <italic toggle="yes">n</italic> reference cells and the <inline-formula id="IE53"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> new cells are in the same <italic toggle="yes">K</italic><sub>0</sub>-dimensional space with biological variations preserved. Then, a classifier can be trained on the <italic toggle="yes">n</italic> reference cells’ types and <inline-formula id="IE54"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>Ref</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> for cell-type prediction, and it can be used to predict the <inline-formula id="IE55"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> cells’ types from <inline-formula id="IE56"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>New</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 scPNMF outputs a sparse and functionally interpretable representation of scRNA-seq data</title>
      <p>We first demonstrate that scPNMF Step I, PNMF, outputs a sparse and functionally interpretable gene encoding of cells. We use the FregGold dataset (<xref rid="btab273-B16" ref-type="bibr">Freytag <italic toggle="yes">et al.</italic>, 2018</xref>), which consists of three cell types (three human lung adenocarcinoma cell lines), and set the basis number <italic toggle="yes">K </italic>=<italic toggle="yes"> </italic>5 for demonstration purpose. Both PCA and PNMF learn a weight matrix that can project the original scRNA-seq data onto a 5D space. Unlike the weight matrix of PCA that has no zero entries, the weight matrix of PNMF is non-negative, highly sparse, containing 42.6% of entries as zeros, and has bases that are largely mutually exclusive (i.e. nonzero entries in different columns correspond to different rows/genes) (<xref rid="btab273-F2" ref-type="fig">Fig. 2a</xref>). Compared with NMF, PNMF also has greater sparsity and mutual exclusiveness in bases (Supplementary Section S7). GO enrichment analysis shows that high weight genes in each PNMF basis are enriched with conceptually similar GO terms, and high weight genes in different PNMF bases are enriched with conceptually different GO terms (<xref rid="btab273-F2" ref-type="fig">Fig. 2b</xref>). This result indicates that PNMF bases correspond to gene groups with distinct functions. On the contrary, the PCA bases do not have good functional interpretations: the high weight genes in each PCA basis are not enriched with conceptually similar GO terms, and different PCA bases share many high weight genes (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S8</xref>).</p>
      <fig position="float" id="btab273-F2">
        <label>Fig. 2</label>
        <caption>
          <p>Illustration of the sparse and interpretable projection found by scPNMF. We use the FregGold dataset as an example. (<bold>a</bold>) Comparison of the weight matrices of PCA and PNMF. Heatmaps visualize the learned weight matrices of PCA (top) and PNMF (bottom), where rows are genes and columns are bases. Red represents positive weights while blue represents negative weights. The rows are ordered by gene-wise hierarchical clustering. Compared to PCA, the weight matrix of PNMF is strictly non-negative, much more sparse and mutually exclusive between bases. (<bold>b</bold>) GO analysis result of each basis in the weight matrix of PNMF. Texts in black boxes summarize the functions of genes in each basis. The enriched GO terms are almost mutually exclusive, implying that each basis represents a unique gene functional cluster. (c) Statistical tests on each basis in the score matrix of PNMF. Top row: scatter plots of scores and total log-counts (cell library sizes). Each dot represents a cell. Cell scores in bases 1 and 4 are highly correlated with cell library sizes. Bottom row: histograms of cell scores in each basis. Scores in bases 2 and 3 show strong multimodality patterns (adjusted <italic toggle="yes">P</italic>-value <inline-formula id="IE57"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>). (d) UMAP visualizations of cells based on high weight genes in the unselected bases 1 and 4 and those in the selected bases 2, 3 and 5. Genes in the unselected bases completely fail to distinguish the three cell types, while genes in the selected bases lead to a clear separation of the three cell types.</p>
        </caption>
        <graphic xlink:href="btab273f2" position="float"/>
      </fig>
      <p>To further analyze the PNMF bases, we list the top 10 high weight genes in each basis (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>), from which we identify many well-known genes with important functions. For instance, basis 1 contains classic housekeeping genes, such as <italic toggle="yes">GAPDH</italic> (<xref rid="btab273-B3" ref-type="bibr">Barber <italic toggle="yes">et al.</italic>, 2005</xref>) and ribosomal protein genes (<italic toggle="yes">RP-</italic>) (<xref rid="btab273-B30" ref-type="bibr">Silver <italic toggle="yes">et al.</italic>, 2006</xref>); basis 3 contains well-known tumor-related genes, including <italic toggle="yes">EGFR</italic> (<xref rid="btab273-B6" ref-type="bibr">Blakely <italic toggle="yes">et al.</italic>, 2017</xref>) and <italic toggle="yes">CDK4</italic> (<xref rid="btab273-B26" ref-type="bibr">O’Leary <italic toggle="yes">et al.</italic>, 2016</xref>). In particular, the cells of the HCC827 cell line (one of the three cell types) have overall high scores in basis 3 (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S9</xref>), a reasonable result because the HCC827 cell line contains an <italic toggle="yes">EGFR</italic> activating mutation (<xref rid="btab273-B12" ref-type="bibr">Della Corte <italic toggle="yes">et al.</italic>, 2017</xref>). In summary, scPNMF step I outputs bases representing sparse and functionally interpretable gene sets.</p>
    </sec>
    <sec>
      <title>3.2 Basis selection is an essential step in scPNMF</title>
      <p>Here, we explain why basis selection is an essential step in scPNMF. In the last section, we show that each PNMF basis of the FregGold dataset approximately represents one functional gene group. It is well known that housekeeping genes (basis 1) and cell-cycle genes (basis 4) are usually irrelevant to cell-type distinctions. However, such biological knowledge is not always available or certain. Therefore, scPNMF mainly relies on the two data-driven strategies: correlations with cell library sizes and multimodality tests (Section 2.2.2) for selecting informative bases.</p>
      <p><xref rid="btab273-F2" ref-type="fig">Figure 2c</xref> visualizes the two strategies: cell scores in bases 1 and 4 are highly correlated with cell library sizes (Pearson correlations &gt; 0.9); cell scores in bases 2 and 3 show strong evidence as multimodally distributed (adjusted <italic toggle="yes">P</italic>-value &lt; 0.05). Hence, Strategy 1 will not retain bases 1 and 4, and Strategy 2 will not retain bases 1, 4 and 5; together, bases 1 and 4 will be removed, and bases 2, 3 and 5 will be selected. To verify the effectiveness of basis selection, we use UMAP to visualize cells based on the top 50 high weight genes in the unselected bases 1 and 4 versus those in the selected bases 2, 3 and 5 (<xref rid="btab273-F2" ref-type="fig">Fig. 2d</xref>). We observe that the top genes in the unselected bases completely fail to separate the three cell types, while the top genes in the selected bases perfectly distinguish the three cell types. This result strongly supports that basis selection is a necessary step of scPNMF. If cell-type labels are provided, users may use a strategy alternative to ‘correlations with cell library sizes’ by regressing out the cell library sizes in a cell-type-specific manner from every basis (see Supplementary Section S6).</p>
    </sec>
    <sec>
      <title>3.3 scPNMF outperforms state-of-the-art gene selection methods on diverse scRNA-seq datasets</title>
      <p>In this section, we demonstrate scPNMF’s capacity for informative gene selection. We comprehensively benchmark scPNMF against 11 other single-cell informative gene selection methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>) on seven scRNA-seq datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>) using three clustering methods (Louvain clustering, K-means clustering and hierarchical clustering). For fair benchmarking, the seven scRNA-seq datasets cover both unique molecule identifier (UMI) and non-UMI protocols and include various biological samples. Using the adjusted Rand index (ARI) as the metric of clustering accuracy, we calculate the ARI values of the three clustering methods on each dataset using 100 informative genes selected by each gene selection method, as 100 genes are commonly used in targeted gene profiling.</p>
      <p><xref rid="btab273-F3" ref-type="fig">Figure 3a</xref> shows that scPNMF has overall the highest ARI values across datasets and clustering methods. In particular, scPNMF has the highest average ARI value with each clustering method (Louvain: 0.83; K-means: 0.74; hierarchical clustering: 0.69) and the highest overall average ARI (0.75) across datasets and clustering methods. Note that the mean of the overall average ARI values of all methods except scPNMF is only 0.66.</p>
      <fig position="float" id="btab273-F3">
        <label>Fig. 3</label>
        <caption>
          <p>Benchmarking scPNMF against 11 informative gene selection methods on seven scRNA-seq datasets. (<bold>a</bold>) Clustering accuracies (ARI values) of three clustering methods based on the informative genes selected. Gene selection methods are ordered from left to right by their average ARI across the three clustering methods and the seven datasets. (<bold>b</bold>) UMAP visualization of cells in the Zheng4 dataset based on 100 informative genes selected by each method. Genes selected by scPNMF lead to a clear separation between naive cytotoxic T cells and regulatory T cells, while the genes selected by others methods do not.</p>
        </caption>
        <graphic xlink:href="btab273f3" position="float"/>
      </fig>
      <p>We further show the UMAP visualization of cells in the Zheng4 dataset based on the informative genes selected by each of the 12 gene selection methods (<xref rid="btab273-F3" ref-type="fig">Fig. 3b</xref>). Only scPNMF leads to a clear separation of naive cytotoxic T cells and regulatory T cells, while the informative genes selected by other methods except corFS and irlbaPcaFS cannot distinguish the two cell types at all.</p>
      <p>We also compare the 12 methods under a varying number of informative genes: 20, 50, 200 and 500, the commonly used gene numbers in targeted gene profiling. We observe that the overall average ARI values of scPNMF are consistently higher than those of other methods, across all informative gene numbers (Supplementary <xref rid="sup1" ref-type="supplementary-material">Fig. S11</xref>). We apply the same benchmarking framework to scPNMF and its variant, where PNMF is replaced by NMF, and find that scPNMF performs consistently better (Supplementary Section S7). Moreover, compared with other methods, scPNMF leads to more stable overall average ARI values under varying numbers of informative genes, indicating its stronger robustness to the gene number constraint of targeted gene profiling. These results strongly support the superior performance of scPNMF as an informative gene selection method.</p>
    </sec>
    <sec>
      <title>3.4 scPNMF guides targeted gene profiling experimental design and cell-type prediction</title>
      <p>In this section, we demonstrate how scPNMF can guide the selection of genes to be measured in a targeted gene profiling experiment, and how scPNMF enables subsequent cell-type annotation on the targeted gene profiling data. We design two case studies with paired scRNA-seq reference data and ‘pseudo’ targeted gene profiling data, whose per-cell sequencing depth is higher than that of the corresponding scRNA-seq data.</p>
      <p>In the first case study, we use the Zheng8 dataset (measured by the 10x Genomics protocol) as the reference dataset. To generate the pseudo targeted gene profiling data, we use a new single-cell gene expression simulator that captures gene correlations, scDesign2 (<xref rid="btab273-B33" ref-type="bibr">Sun <italic toggle="yes">et al.</italic>, 2021</xref>), to generate data with a 100-time higher per-cell sequencing depth. In the second case study, we use the PBMC10x dataset (measured by 10x Genomics protocol) as the reference dataset, and we use PBMCSmartseq (measured by Smart-Seq2) as the pseudo targeted gene profiling data because Smart-Seq2 has a higher per-gene sequencing depth than 10x Genomics does. In both case studies, for each gene selection method, the corresponding pseudo targeted gene profiling datasets only contain the <italic toggle="yes">M</italic> informative genes selected by the method.</p>
      <p>We benchmark scPNMF against the 11 gene selection methods in terms of cell-type prediction on the pseudo targeted gene profiling data. To avoid the bias for a specific classification algorithm, we apply three popular algorithms for cell-type prediction: random forest (<xref rid="btab273-B9" ref-type="bibr">Breiman, 2001</xref>), k-nearest neighbors (KNN) (<xref rid="btab273-B8" ref-type="bibr">Boser <italic toggle="yes">et al.</italic>, 1992</xref>) and support vector machine (SVM) (<xref rid="btab273-B8" ref-type="bibr">Boser <italic toggle="yes">et al.</italic>, 1992</xref>). In each case study, we first train each classification algorithm on the low-dimensional embeddings of the reference cells <inline-formula id="IE58"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>Ref</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> given the <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>100 informative genes selected by each gene selection method. Then, we apply the trained classifier to the low-dimensional embeddings of the cells in the pseudo targeted gene profiling data <inline-formula id="IE59"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>New</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. <xref rid="btab273-T2" ref-type="table">Table 2</xref> shows that scPNMF leads to the highest average prediction accuracy (0.81) across six combinations (two case studies × three classification algorithms). Moreover, scPNMF achieves the highest accuracy in each combination except Zheng8 + random forest where it is the second best. These results confirm that scPNMF effectively guides the selection of genes to measure in targeted gene profiling experiments, and it enables accurate cell-type annotation on newly generated targeted gene profiling datasets.</p>
      <table-wrap position="float" id="btab273-T2">
        <label>Table 2.</label>
        <caption>
          <p>Prediction accuracy of cell types based on 100 informative genes selected by 12 gene selection methods in the two case studies with paired reference scRNA-seq data and targeted gene profiling data</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Method</th>
              <th colspan="3" rowspan="1">Zheng8<hr/></th>
              <th colspan="3" rowspan="1">PBMC<hr/></th>
              <th rowspan="1" colspan="1">Average Accuracy</th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th rowspan="1" colspan="1">RandomForest</th>
              <th rowspan="1" colspan="1">KNN</th>
              <th rowspan="1" colspan="1">SVM</th>
              <th rowspan="1" colspan="1">RandomForest</th>
              <th rowspan="1" colspan="1">KNN</th>
              <th rowspan="1" colspan="1">SVM</th>
              <th rowspan="1" colspan="1"/>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">scPNMF</td>
              <td rowspan="1" colspan="1">0.85 (0.83,0.87)</td>
              <td rowspan="1" colspan="1"><bold><underline>0.80</underline></bold> (0.78,0.83)</td>
              <td rowspan="1" colspan="1"><bold><underline>0.87</underline></bold> (0.85,0.89)</td>
              <td rowspan="1" colspan="1"><bold><underline>0.84</underline></bold> (0.79,0.88)</td>
              <td rowspan="1" colspan="1"><bold><underline>0.84</underline></bold> (0.79,0.88)</td>
              <td rowspan="1" colspan="1"><bold><underline>0.67</underline></bold> (0.61,0.73)</td>
              <td rowspan="1" colspan="1">
                <bold>
                  <underline>0.81</underline>
                </bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">M3Drop</td>
              <td rowspan="1" colspan="1">0.85 (0.83,0.87)</td>
              <td rowspan="1" colspan="1"><underline><bold>0.80</bold></underline> (0.77,0.83)</td>
              <td rowspan="1" colspan="1"><bold><underline>0.87</underline></bold> (0.84,0.89)</td>
              <td rowspan="1" colspan="1"><bold><underline>0.84</underline></bold> (0.79,0.88)</td>
              <td rowspan="1" colspan="1">0.77 (0.71,0.82)</td>
              <td rowspan="1" colspan="1">0.63 (0.57,0.69)</td>
              <td rowspan="1" colspan="1">0.79</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SeuratDISP</td>
              <td rowspan="1" colspan="1">0.84 (0.81,0.86)</td>
              <td rowspan="1" colspan="1">0.78 (0.75,0.81)</td>
              <td rowspan="1" colspan="1">0.86 (0.84,0.88)</td>
              <td rowspan="1" colspan="1">0.80 (0.75,0.84)</td>
              <td rowspan="1" colspan="1">0.75 (0.70,0.80)</td>
              <td rowspan="1" colspan="1">0.64 (0.58,0.70)</td>
              <td rowspan="1" colspan="1">0.78</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">corFS</td>
              <td rowspan="1" colspan="1">0.80 (0.77,0.82)</td>
              <td rowspan="1" colspan="1">0.75 (0.73,0.78)</td>
              <td rowspan="1" colspan="1">0.82 (0.80,0.85)</td>
              <td rowspan="1" colspan="1">0.82 (0.77,0.86)</td>
              <td rowspan="1" colspan="1">0.81 (0.76,0.86)</td>
              <td rowspan="1" colspan="1">0.62 (0.56,0.68)</td>
              <td rowspan="1" colspan="1">0.77</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">GiniClust</td>
              <td rowspan="1" colspan="1"><bold><underline>0.86</underline></bold> (0.83,0.88)</td>
              <td rowspan="1" colspan="1">0.79 (0.76,0.81)</td>
              <td rowspan="1" colspan="1">0.86 (0.83,0.88)</td>
              <td rowspan="1" colspan="1">0.80 (0.75,0.84)</td>
              <td rowspan="1" colspan="1">0.76 (0.71,0.81)</td>
              <td rowspan="1" colspan="1">0.53 (0.47,0.60)</td>
              <td rowspan="1" colspan="1">0.75</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">scran</td>
              <td rowspan="1" colspan="1">0.79 (0.76,0.81)</td>
              <td rowspan="1" colspan="1">0.72 (0.69,0.75)</td>
              <td rowspan="1" colspan="1">0.82 (0.80,0.85)</td>
              <td rowspan="1" colspan="1">0.78 (0.72,0.82)</td>
              <td rowspan="1" colspan="1">0.73 (0.67,0.78)</td>
              <td rowspan="1" colspan="1">0.67 (0.61,0.72)</td>
              <td rowspan="1" colspan="1">0.75</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SeuratMVP</td>
              <td rowspan="1" colspan="1">0.83 (0.81,0.85)</td>
              <td rowspan="1" colspan="1">0.77 (0.74,0.80)</td>
              <td rowspan="1" colspan="1">0.85 (0.82,0.87)</td>
              <td rowspan="1" colspan="1">0.82 (0.77,0.86)</td>
              <td rowspan="1" colspan="1">0.74 (0.69,0.79)</td>
              <td rowspan="1" colspan="1">0.47 (0.40,0.53)</td>
              <td rowspan="1" colspan="1">0.74</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Scanpy</td>
              <td rowspan="1" colspan="1">0.79 (0.77,0.82)</td>
              <td rowspan="1" colspan="1">0.71 (0.68,0.74)</td>
              <td rowspan="1" colspan="1">0.80 (0.78,0.83)</td>
              <td rowspan="1" colspan="1">0.80 (0.75,0.84)</td>
              <td rowspan="1" colspan="1">0.76 (0.71,0.81)</td>
              <td rowspan="1" colspan="1">0.52 (0.46,0.58)</td>
              <td rowspan="1" colspan="1">0.73</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SCMarker</td>
              <td rowspan="1" colspan="1">0.77 (0.74,0.79)</td>
              <td rowspan="1" colspan="1">0.68 (0.65,0.71)</td>
              <td rowspan="1" colspan="1">0.74 (0.71,0.77)</td>
              <td rowspan="1" colspan="1">0.77 (0.71,0.81)</td>
              <td rowspan="1" colspan="1">0.71 (0.65,0.76)</td>
              <td rowspan="1" colspan="1">0.45 (0.39,0.52)</td>
              <td rowspan="1" colspan="1">0.69</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SeuratVST</td>
              <td rowspan="1" colspan="1">0.73 (0.70,0.76)</td>
              <td rowspan="1" colspan="1">0.68 (0.65,0.71)</td>
              <td rowspan="1" colspan="1">0.75 (0.73,0.78)</td>
              <td rowspan="1" colspan="1">0.74 (0.68,0.79)</td>
              <td rowspan="1" colspan="1">0.68 (0.63,0.74)</td>
              <td rowspan="1" colspan="1">0.40 (0.34,0.46)</td>
              <td rowspan="1" colspan="1">0.67</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">DANB</td>
              <td rowspan="1" colspan="1">0.71 (0.68,0.73)</td>
              <td rowspan="1" colspan="1">0.69 (0.66,0.71)</td>
              <td rowspan="1" colspan="1">0.75 (0.73,0.78)</td>
              <td rowspan="1" colspan="1">0.73 (0.67,0.78)</td>
              <td rowspan="1" colspan="1">0.74 (0.68,0.79)</td>
              <td rowspan="1" colspan="1">0.28 (0.23,0.34)</td>
              <td rowspan="1" colspan="1">0.65</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">irlbaPcaFS</td>
              <td rowspan="1" colspan="1">0.68 (0.65,0.71)</td>
              <td rowspan="1" colspan="1">0.61 (0.58,0.64)</td>
              <td rowspan="1" colspan="1">0.71 (0.68,0.74)</td>
              <td rowspan="1" colspan="1">0.71 (0.65,0.76)</td>
              <td rowspan="1" colspan="1">0.77 (0.71,0.82)</td>
              <td rowspan="1" colspan="1">0.16 (0.12,0.21)</td>
              <td rowspan="1" colspan="1">0.61</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>Parentheses are 95% confidence intervals. Highest number within each column is labeled by boldface and underline.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We propose scPNMF, an unsupervised gene selection and data projection method for scRNA-seq data. The major goal of scPNMF is to select a fixed number of informative genes to distinguish cell types and guide gene selection for targeted gene profiling experiments. Moreover, scPNMF can project a new targeted gene profiling dataset with the selected genes to the low-dimensional space that embeds a reference scRNA-seq dataset. We perform a comprehensive benchmark to evaluate scPNMF in terms of informative gene selection against the state-of-the-art gene selection methods. Our results show that scPNMF consistently outperforms 11 existing methods for a wide range of informative gene numbers (from 20 to 500) on diverse scRNA-seq datasets. We also demonstrate that the informative genes selected by scPNMF can effectively guide gene selection for targeted gene profiling and lead to accurate cell-type annotation on targeted gene profiling data based on reference scRNA-seq data. In addition to the 11 methods, we compare scPNMF to the factorial single-cell latent variable model (f-scLVM) (<xref rid="btab273-B11" ref-type="bibr">Buettner <italic toggle="yes">et al.</italic>, 2017</xref>), both conceptually and empirically, to clarify their differences and further illustrate the unique strength of scPNMF (see Supplementary Section S8).</p>
    <p>Besides gene selection and data projection, scPNMF also works as a dimensionality reduction method with good interpretability. Each dimension in the low-dimensional space found by scPNMF can be considered as a new functional ‘feature’ (as a linear combination of correlated and thus functionally related genes). Moreover, the mutual exclusiveness makes the PNMF bases used in scPNMF advantageous over the PCA bases in terms of removing confounding effects. For example, cell-cycle genes obscure the identification of cell types and should be removed from low-dimensional embeddings of cells. For PCA, cell-cycle genes affect many PCA bases, so the popular scRNA-seq pipeline Seurat implements a complicated approach that first calculates ‘cell-cycle scores’ and then regresses each basis (principal component) on these scores to remove the effects of cell-cycle genes (<xref rid="btab273-B31" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>). In contrast, cell-cycle genes are concentrated in only one PNMF basis, so it is easy to remove that basis to clear the effects of cell-cycle genes. Therefore, scPNMF has great potentials in deciphering cell heterogeneity in single-cell data by working as an interpretable dimensionality reduction method.</p>
    <p>The current implementation of scPNMF focuses on single-cell gene expression data. Considering the rapid development of single-cell multiomics technologies, we plan to extend scPNMF to accommodate other technologies that measure other genomics features such chromatin accessibility landscapes measured by single-cell ATAC-seq (<xref rid="btab273-B27" ref-type="bibr">Pott and Lieb, 2015</xref>), or even to integrate data across multiomics datasets. Another note is that the multimodality test for basis selection in scPNMF only accounts for discrete cell types but not continuous cell trajectories. Therefore, other tests or strategies are needed to select informative bases to capture biological variations along continuous cell trajectories.</p>
    <p>An important question for gene selection is: how many genes should be selected as informative genes to fully capture the biological variations of interest? In our studies, we observe that, after the informative gene number reaches 200, the clustering accuracies based on the selected informative genes plateau for most gene selection methods including scPNMF. Therefore, 200 genes may be sufficient for capturing biological variations in scRNA-seq data. However, it remains challenging to decide the minimum number of informative genes, given that the underlying cell subpopulation structure is data-specific and might be complex. We plan to explore this problem in the future with the possible use of information theory.</p>
    <p><italic toggle="yes">Financial Support</italic>: This work was supported by the following grants: National Science Foundation DBI-1846216, NIH/NIGMS R01GM120507, Johnson &amp; Johnson WiSTEM2D Award, Sloan Research Fellowship, and UCLA David Geffen School of Medicine W.M. Keck Foundation Junior Faculty Award (to J.J.L); NIH/NINDS R01NS117148 (to R.W).</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab273_Supplementary_Data</label>
      <media xlink:href="btab273_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab273-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ameijeiras-Alonso</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Mode testing, critical bandwidth and excess mass</article-title>. <source>Test</source>, <volume>28</volume>, <fpage>900</fpage>–<lpage>919</lpage>.</mixed-citation>
    </ref>
    <ref id="btab273-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andrews</surname><given-names>T.S.</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M.</given-names></string-name></person-group> (<year>2019</year>) <article-title>M3drop: dropout-based feature selection for scRNAseq</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>2865</fpage>–<lpage>2867</lpage>.<pub-id pub-id-type="pmid">30590489</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barber</surname><given-names>R.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2005</year>) <article-title>GAPDH as a housekeeping gene: analysis of GAPDH mRNA expression in a panel of 72 human tissues</article-title>. <source>Physiol. Genomics</source>, <volume>21</volume>, <fpage>389</fpage>–<lpage>395</lpage>.<pub-id pub-id-type="pmid">15769908</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baron</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter-and intra-cell population structure</article-title>. <source>Cell Syst</source>., <volume>3</volume>, <fpage>346</fpage>–<lpage>360</lpage>.<pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Birnbaum</surname><given-names>K.D.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Power in numbers: single-cell RNA-seq strategies to dissect complex tissues</article-title>. <source>Annu. Rev. Genetics</source>, <volume>52</volume>, <fpage>203</fpage>–<lpage>221</lpage>.<pub-id pub-id-type="pmid">30192636</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blakely</surname><given-names>C.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Evolution and clinical impact of co-occurring genetic alterations in advanced-stage egfr-mutant lung cancers</article-title>. <source>Nat. Genetics</source>, <volume>49</volume>, <fpage>1693</fpage>–<lpage>1704</lpage>.<pub-id pub-id-type="pmid">29106415</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boileau</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Exploring high-dimensional biological data with sparse contrastive principal component analysis</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>3422</fpage>–<lpage>3430</lpage>.<pub-id pub-id-type="pmid">32176249</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Boser</surname><given-names>B.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1992</year>) A training algorithm for optimal margin classifiers. In: <italic toggle="yes">Proceedings of the Fifth Annual Workshop on Computational Learning Theory (<italic toggle="yes">COLT '92</italic>). Association for Computing Machinery, New York, NY, USA,</italic>  <fpage>144</fpage>–<lpage>152</lpage>.</mixed-citation>
    </ref>
    <ref id="btab273-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Breiman</surname><given-names>L.</given-names></string-name></person-group> (<year>2001</year>) <article-title>Random forests</article-title>. <source>Mach. Learn</source>., <volume>45</volume>, <fpage>5</fpage>–<lpage>32</lpage>.</mixed-citation>
    </ref>
    <ref id="btab273-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brunet</surname><given-names>J.-P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2004</year>) <article-title>Metagenes and molecular pattern discovery using matrix factorization</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>101</volume>, <fpage>4164</fpage>–<lpage>4169</lpage>.<pub-id pub-id-type="pmid">15016911</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buettner</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>f-scLVM: scalable and versatile factor analysis for single-cell RNA-seq</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>1</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">28077169</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Della Corte</surname><given-names>C.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Efficacy of continuous EGFR-inhibition and role of hedgehog in egfr acquired resistance in human lung cancer cells with activating mutation of EGFR</article-title>. <source>Oncotarget</source>, <volume>8</volume>, <fpage>23020</fpage>–<lpage>23032</lpage>.<pub-id pub-id-type="pmid">28416737</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duren</surname><given-names>Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Integrative analysis of single-cell genomics data by coupled nonnegative matrix factorizations</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>115</volume>, <fpage>7723</fpage>–<lpage>7728</lpage>.<pub-id pub-id-type="pmid">29987051</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Durif</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Probabilistic count matrix factorization for single cell expression data analysis</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>4011</fpage>–<lpage>4019</lpage>.<pub-id pub-id-type="pmid">30865271</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eisenberg</surname><given-names>E.</given-names></string-name>, <string-name><surname>Levanon</surname><given-names>E.Y.</given-names></string-name></person-group> (<year>2013</year>) <article-title>Human housekeeping genes, revisited</article-title>. <source>Trends Genetics</source>, <volume>29</volume>, <fpage>569</fpage>–<lpage>574</lpage>.</mixed-citation>
    </ref>
    <ref id="btab273-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Freytag</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Comparison of clustering tools in r for medium-sized 10x genomics single-cell RNA-sequencing data</article-title>. <source>F1000Research</source>, <volume>7</volume>, <fpage>1297</fpage>.<pub-id pub-id-type="pmid">30228881</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Gao</surname><given-names>C.</given-names></string-name>, <string-name><surname>Welch</surname><given-names>J.D.</given-names></string-name></person-group> (<year>2020</year>). Iterative refinement of cellular identity from single-cell data using online learning. In: <italic toggle="yes">International Conference on Research in Computational Molecular Biology</italic>. p. <fpage>248</fpage>–<lpage>250</lpage>. Springer, Cham.</mixed-citation>
    </ref>
    <ref id="btab273-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hafemeister</surname><given-names>C.</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Normalization and variance stabilization of single-cell rna-seq data using regularized negative binomial regression</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>1</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Giniclust: detecting rare cell types from single-cell gene expression data with gini index</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>144</fpage>.<pub-id pub-id-type="pmid">27368803</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korsunsky</surname><given-names>I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Fast, sensitive and accurate integration of single-cell data with harmony</article-title>. <source>Nat. Methods</source>, <volume>16</volume>, <fpage>1289</fpage>–<lpage>1296</lpage>.<pub-id pub-id-type="pmid">31740819</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>D.D.</given-names></string-name>, <string-name><surname>Seung</surname><given-names>H.S.</given-names></string-name></person-group> (<year>1999</year>) <article-title>Learning the parts of objects by non-negative matrix factorization</article-title>. <source>Nature</source>, <volume>401</volume>, <fpage>788</fpage>–<lpage>791</lpage>.<pub-id pub-id-type="pmid">10548103</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lun</surname><given-names>A.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>75</fpage>.<pub-id pub-id-type="pmid">27122128</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Macosko</surname><given-names>E.Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1202</fpage>–<lpage>1214</lpage>.<pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marshall</surname><given-names>J.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>HyPR-seq: single-cell quantification of chosen RNAs via hybridization and sequencing of DNA probes</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>117</volume>, <fpage>33404</fpage>–<lpage>33413</lpage>.<pub-id pub-id-type="pmid">33376219</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moffitt</surname><given-names>J.R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>High-throughput single-cell gene-expression profiling with multiplexed error-robust fluorescence in situ hybridization</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>113</volume>, <fpage>11046</fpage>–<lpage>11051</lpage>.<pub-id pub-id-type="pmid">27625426</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O'Leary</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Treating cancer with selective cdk4/6 inhibitors</article-title>. <source>Nat. Rev. Clin. Oncol</source>., <volume>13</volume>, <fpage>417</fpage>–<lpage>430</lpage>.<pub-id pub-id-type="pmid">27030077</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pott</surname><given-names>S.</given-names></string-name>, <string-name><surname>Lieb</surname><given-names>J.D.</given-names></string-name></person-group> (<year>2015</year>) <article-title>Single-cell ATAC-seq: strength in numbers</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>1</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">25583448</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Potter</surname><given-names>S.S.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Single-cell RNA sequencing for the study of development, physiology and disease</article-title>. <source>Nat. Rev. Nephrol</source>., <volume>14</volume>, <fpage>479</fpage>–<lpage>492</lpage>.<pub-id pub-id-type="pmid">29789704</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Raj</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>Imaging individual mrna molecules using multiple singly labeled probes</article-title>. <source>Nat. Methods</source>, <volume>5</volume>, <fpage>877</fpage>–<lpage>879</lpage>.<pub-id pub-id-type="pmid">18806792</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Silver</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2006</year>) <article-title>Selection of housekeeping genes for gene expression studies in human reticulocytes using real-time PCR</article-title>. <source>BMC Mol. Biol</source>., <volume>7</volume>, <fpage>33</fpage>.<pub-id pub-id-type="pmid">17026756</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source>, <volume>177</volume>, <fpage>1888</fpage>–<lpage>1902</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>A next generation connectivity map: L1000 platform and the first 1,000,000 profiles</article-title>. <source>Cell</source>, <volume>171</volume>, <fpage>1437</fpage>–<lpage>1452</lpage>.<pub-id pub-id-type="pmid">29195078</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B33">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>). scDesign2: a transparent simulator that generates high-fidelity single-cell gene expression count data with gene correlations captured. Genome Biol., 22, 163.</mixed-citation>
    </ref>
    <ref id="btab273-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thellin</surname><given-names>O.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1999</year>) <article-title>Housekeeping genes as internal standards: use and limits</article-title>. <source>J. Biotechnol</source>., <volume>75</volume>, <fpage>291</fpage>–<lpage>295</lpage>.<pub-id pub-id-type="pmid">10617337</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Uzbas</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Bart-seq: cost-effective massively parallelized targeted sequencing for genomics, transcriptomics, and single-cell analysis</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>1</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">30606230</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Scmarker: ab initio marker selection for single cell transcriptome profiling</article-title>. <source>PLoS Comput. Biol</source>., <volume>15</volume>, <fpage>e1007445</fpage>.<pub-id pub-id-type="pmid">31658262</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Welch</surname><given-names>J.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Single-cell multi-omic integration compares and contrasts features of brain cell identity</article-title>. <source>Cell</source>, <volume>177</volume>, <fpage>1873</fpage>–<lpage>1887</lpage>.<pub-id pub-id-type="pmid">31178122</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Michailidis</surname><given-names>G.</given-names></string-name></person-group> (<year>2016</year>) <article-title>A non-negative matrix factorization method for detecting modules in heterogeneous omics multi-modal data</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>1</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">26377073</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Z.</given-names></string-name>, <string-name><surname>Oja</surname><given-names>E.</given-names></string-name></person-group> (<year>2010</year>) <article-title>Linear and nonlinear projective nonnegative matrix factorization</article-title>. <source>IEEE Trans. Neural Netw</source>., <volume>21</volume>, <fpage>734</fpage>–<lpage>749</lpage>.<pub-id pub-id-type="pmid">20350841</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B50">
      <mixed-citation publication-type="journal">Ye, Y., and Li, J.J. (2016) NMFP: a non-negative matrix factorization based preselection method to increase accuracy of identifying mRNA isoforms from RNA-seq data. <italic toggle="yes">BMC Genomics</italic>., <bold>17</bold>, 11. <pub-id pub-id-type="doi">10.1186/s12864-015-2304-8</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yuan</surname><given-names>Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>Projective nonnegative matrix factorization: sparseness</article-title>, orthogonality, and clustering. <source>Neural Process. Lett</source>., <fpage>11</fpage>–<lpage>13</lpage>. [CVOCROSSCVO]</mixed-citation>
    </ref>
    <ref id="btab273-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Dimensionality reduction for single cell RNA sequencing data using constrained robust non-negative matrix factorization</article-title>. <source>NAR Genomics Bioinformatics</source>, <volume>2</volume>, <fpage>lqaa064</fpage>.<pub-id pub-id-type="pmid">33575614</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Single-cell multimodal omics: the power of many</article-title>. <source>Nat. Methods</source>, <volume>17</volume>, <fpage>11</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">31907462</pub-id></mixed-citation>
    </ref>
    <ref id="btab273-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Detecting heterogeneity in single-cell RNA-seq data by non-negative matrix factorization</article-title>. <source>PeerJ</source>, <volume>5</volume>, <fpage>e2888</fpage>.<pub-id pub-id-type="pmid">28133571</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
