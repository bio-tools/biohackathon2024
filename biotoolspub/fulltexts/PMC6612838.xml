<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6612838</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz352</article-id>
    <article-id pub-id-type="publisher-id">btz352</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2019 Conference Proceedings</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Comparative and Functional Genomics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Integrating regulatory DNA sequence and gene expression to predict genome-wide chromatin accessibility across cellular contexts</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nair</surname>
          <given-names>Surag</given-names>
        </name>
        <xref ref-type="aff" rid="btz352-aff1">1</xref>
        <xref ref-type="author-notes" rid="btz352-FM2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Daniel S</given-names>
        </name>
        <xref ref-type="aff" rid="btz352-aff2">2</xref>
        <xref ref-type="author-notes" rid="btz352-FM2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Perricone</surname>
          <given-names>Jacob</given-names>
        </name>
        <xref ref-type="aff" rid="btz352-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-3084-2287</contrib-id>
        <name>
          <surname>Kundaje</surname>
          <given-names>Anshul</given-names>
        </name>
        <xref ref-type="aff" rid="btz352-aff1">1</xref>
        <xref ref-type="aff" rid="btz352-aff4">4</xref>
        <xref ref-type="corresp" rid="btz352-cor1"/>
        <!--<email>akundaje@stanford.edu</email>-->
      </contrib>
    </contrib-group>
    <aff id="btz352-aff1"><label>1</label>Department of Computer Science, Stanford University, Stanford, CA, USA</aff>
    <aff id="btz352-aff2"><label>2</label>Department of Biomedical Data Sciences, Stanford University, Stanford, CA, USA</aff>
    <aff id="btz352-aff3"><label>3</label>Institute for Computational and Mathematical Engineering, Stanford University, Stanford, CA, USA</aff>
    <aff id="btz352-aff4"><label>4</label>Department of Genetics, Stanford University, Stanford, CA, USA</aff>
    <author-notes>
      <corresp id="btz352-cor1">To whom correspondence should be addressed. <email>akundaje@stanford.edu</email></corresp>
      <fn id="btz352-FM2">
        <p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-07-05">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>14</issue>
    <fpage>i108</fpage>
    <lpage>i116</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz352.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Genome-wide profiles of chromatin accessibility and gene expression in diverse cellular contexts are critical to decipher the dynamics of transcriptional regulation. Recently, convolutional neural networks have been used to learn predictive <italic>cis</italic>-regulatory DNA sequence models of context-specific chromatin accessibility landscapes. However, these context-specific regulatory sequence models cannot generalize predictions across cell types.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce multi-modal, residual neural network architectures that integrate <italic>cis</italic>-regulatory sequence and context-specific expression of <italic>trans</italic>-regulators to predict genome-wide chromatin accessibility profiles across cellular contexts. We show that the average accessibility of a genomic region across training contexts can be a surprisingly powerful predictor. We leverage this feature and employ novel strategies for training models to enhance genome-wide prediction of shared and context-specific chromatin accessible sites across cell types. We interpret the models to reveal insights into <italic>cis</italic>- and <italic>trans</italic>-regulation of chromatin dynamics across 123 diverse cellular contexts.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/kundajelab/ChromDragoNN">https://github.com/kundajelab/ChromDragoNN</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Institute of Health</named-content>
        </funding-source>
        <award-id>1DP2GM123485</award-id>
        <award-id>1U01HG009431</award-id>
        <award-id>1R01HG009674</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">BioX Fellowship</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Cost-effective, sequencing-based functional genomics assays such as RNA-seq, ChIP-seq, DNase-seq and ATAC-seq have enabled large-scale profiling of epigenomes and transcriptomes across diverse cellular contexts (<xref rid="btz352-B10" ref-type="bibr">Consortium, 2012</xref>; <xref rid="btz352-B22" ref-type="bibr">Kundaje <italic>et al.</italic>, 2015</xref>). These datasets provide a unique resource to understand the relationship between regulatory DNA sequence, chromatin state and gene expression.</p>
    <p>DNase-seq (<xref rid="btz352-B5" ref-type="bibr">Boyle <italic>et al.</italic>, 2008</xref>; <xref rid="btz352-B40" ref-type="bibr">Thurman <italic>et al.</italic>, 2012</xref>) or ATAC-seq (<xref rid="btz352-B7" ref-type="bibr">Buenrostro <italic>et al.</italic>, 2013</xref>) experiments profile the accessible chromatin landscape typically bound by regulatory DNA binding proteins such as transcription factors (TFs). Chromatin accessibility is highly dynamic across cellular contexts (<xref rid="btz352-B40" ref-type="bibr">Thurman <italic>et al.</italic>, 2012</xref>). Chromatin accessibility of a regulatory element is largely a function of the combinatorial <italic>cis</italic>-regulatory code of TF binding sequence motifs embedded in its DNA as well as the availability and activity of the <italic>trans</italic>-regulatory proteins such as TFs that bind them.</p>
    <p>A large body of literature has focused on developing computational models to decipher the <italic>cis</italic>-regulatory sequence code of cell-type specific chromatin accessibility landscapes. Recently, convolutional neural networks (CNNs) have been used to learn the <italic>cis</italic>-regulatory grammars encoded in regulatory DNA sequences associated with cell-type specific <italic>in vivo</italic> TF binding and chromatin accessibility (<xref rid="btz352-B1" ref-type="bibr">Alipanahi <italic>et al.</italic>, 2015</xref>; <xref rid="btz352-B20" ref-type="bibr">Kelley <italic>et al.</italic>, 2016</xref>; <xref rid="btz352-B30" ref-type="bibr">Quang and Xie, 2016</xref>; <xref rid="btz352-B43" ref-type="bibr">Zeng <italic>et al.</italic>, 2016</xref>; <xref rid="btz352-B44" ref-type="bibr">Zhou and Troyanskaya, 2015</xref>). By learning a series of de-novo motif-like pattern detectors (called convolutional filters) and non-linear activation transformations, CNNs are able to map raw DNA sequence across the genome to binary or continuous measures of associated regulatory activity profiles without explicit feature engineering.</p>
    <p>The Basset model (<xref rid="btz352-B18" ref-type="bibr">Kelley <italic>et al.</italic>, 2016</xref>) is a state-of-the-art CNN architecture that predicts binary chromatin accessibility in a specific cellular context across the genome as a function of local 600 bp DNA sequence context around each bin. The Basset model is also a multi-task architecture trained simultaneously on binary chromatin accessibility profiles from multiple cellular contexts (each context is a prediction task) and produces a vector of outputs for any genomic position containing the probability of accessible chromatin state at that position in each of the cellular contexts (task). The input DNA sequences represented using a one-hot encoding is transformed by three convolution layers. A rectified linear unit (ReLU) non-linear transformation is applied to the output of the final convolution layer and a pooling operation takes the maximum across a window of adjacent positions. These transformations are then passed to three fully connected layers followed by a logistic non-linearity for each task (cellular context) that outputs the probability of accessibility. The convolutional filters learned by Basset were visualized and interpreted to infer putative <italic>cis</italic>-regulatory sequence drivers of context-specific chromatin accessibility. The model was also used to score putative regulatory genetic variants using an <italic>in-silico</italic> mutagenesis approach.</p>
    <p>The Basset model was recently enhanced by factorizing the convolution layers (<xref rid="btz352-B42" ref-type="bibr">Wnuk <italic>et al.</italic>, 2017</xref>) (Factorized model). The Factorized model increases the model depth—the three convolution layers in Basset are replaced by nine convolution layers. Further, the first two convolution layers in Basset which contain convolutional filters (motif-like pattern detectors) of widths 19 and 11, respectively, are factorized into multiple convolution layers with smaller widths. The authors note that these modifications enhance prediction performance and reduce learning time.</p>
    <p>While these and other sequence-only models (<xref rid="btz352-B19" ref-type="bibr">Kelley <italic>et al.</italic>, 2018</xref>; <xref rid="btz352-B44" ref-type="bibr">Zhou and Troyanskaya, 2015</xref>) have provided useful insight into context-specific <italic>cis</italic>-regulatory sequence features and the context-specific impact of regulatory genetic variants, these models cannot be used to predict chromatin accessibility or other regulatory profiles in cellular contexts not present in the training set. This is largely because these sequence-only models do not model the regulatory activity of <italic>trans</italic>-factors that vary across cellular contexts. Gene expression levels of <italic>trans</italic>-factors as measured by RNA-seq provide a useful, albeit indirect surrogate for their availability and activity in different cellular contexts. Models that can integrate <italic>cis</italic>-regulatory DNA sequence and <italic>trans</italic>-regulator expression should in principle be able to generalize to predict chromatin accessibility landscapes across cellular contexts. Such a model would be very valuable because it would enable prediction of chromatin accessibility profiles in large collections of cellular contexts that are currently characterized only by RNA-seq (<xref rid="btz352-B9" ref-type="bibr">Collado-Torres <italic>et al.</italic>, 2017</xref>). Moreover, interpreting such an integrative model would also provide insights into <italic>cis</italic>-regulatory sequence features and <italic>trans</italic>-regulators that are predictive of chromatin dynamics across cellular contexts.</p>
    <p>Deep-learning architectures allow this kind of flexibility to integrate multi-modal data i.e. DNA sequence coupled with RNA expression profiles. Hence, we expand upon previous work to predict genome-wide maps of chromatin accessibility using sequence and gene expression data (<xref rid="btz352-B18" ref-type="bibr">Kelley <italic>et al.</italic>, 2016</xref>; <xref rid="btz352-B42" ref-type="bibr">Wnuk <italic>et al.</italic>, 2017</xref>). We introduce multi-modal, residual neural network (ResNet) architectures (<xref rid="btz352-B15" ref-type="bibr">He <italic>et al.</italic>, 2016</xref>) that integrate <italic>cis</italic>-regulatory sequence and context-specific expression of <italic>trans</italic>-regulators to predict genome-wide chromatin accessibility profiles across cellular contexts. We show that the average accessibility of a genomic region across training contexts can be a powerful baseline predictor. We leverage this feature and employ novel strategies for training models to enhance prediction performance of shared and context-specific chromatin accessible sites across cell types. Further, we show that we can interpret these cross-cell type models to reveal insights into <italic>cis</italic>- and <italic>trans</italic>-regulators of chromatin dynamics across 123 diverse cellular contexts.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Chromatin accessibility data</title>
      <p>DNase-seq datasets profiling genome-wide chromatin accessibility were downloaded from the Roadmap Epigenomics Project (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/geo/roadmap/epigenomics/">http://www.ncbi.nlm.nih.gov/geo/roadmap/epigenomics/</ext-link>) and ENCODE (<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/">https://www.encodeproject.org/</ext-link>). The complete list of DNase-seq datasets and their identifiers is provided in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>. The fastq files were aligned with BWA aln (v0.7.10), where all datasets were treated as single-end, with ENCODE default alignment parameters. After mapping, reads were filtered to remove unmapped reads and mates, non-primary alignments, reads failing platform/vendor quality checks and PCR/optical duplicates (-F 1804). Low quality reads (MAPQ &lt; 30) were also removed. Duplicates were then marked with Picard MarkDuplicates and removed. The final filtered file was then converted to tagAlign format (BED 3 + 3) using bedtools bamtobed. Cross-correlation scores were then obtained for each file using phantompeakqualtools (v1.1).</p>
      <p>All files were checked to have cross-correlation with a quality tag above 0 and discarded if not. For the ENCODE data generated from the Stam Lab protocol, all datasets were trimmed to 36 bp and then technical replicates were combined. Read depths were considered, and a standardized depth of 50 million reads was set for the final datasets. As such, the files were filtered to remove mitochondrial reads, filtered for mappability (MAPQ &gt; 30) and then subsampled to 50 million reads. For the ENCODE data generated from the Crawford Lab protocol, the same procedure as above was performed, except reads were trimmed to 20 bp due to the different library generation protocol. For the Roadmap data, which was all generated by the Stam Lab protocol, the same procedure as above was performed with trimming to 36 bp, and files were only combined to give a minimum read depth of 50 million reads, since each file came from a different developmental time point. These trimmed, filtered, subsampled tagAlign files were then used to generate signal tracks and call peaks. Signal tracks and peaks were called with a loose threshold (<italic>P</italic> &lt; 0.01) with MACS2 to generate bigwig files (fold enrichment and <italic>P</italic>-value) and narrowPeak files, respectively.</p>
      <p>To identify reproducible peaks, we performed pseudoreplicate subsampling on the pooled reads across all replicates (taking all reads from the final tagAligns and splitting in half by random assignment to two replicates) and retaining reproducible peaks passing an Irreproducible Discovery Rate (v2.0.3) (<xref rid="btz352-B24" ref-type="bibr">Li <italic>et al.</italic>, 2011</xref>) (<ext-link ext-link-type="uri" xlink:href="https://github.com/kundajelab/idr">https://github.com/kundajelab/idr</ext-link>) threshold of 0.1 to get a reproducible peaks for each DNase experiment. The pipeline is available in a Zenodo record <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.156534">https://doi.org/10.5281/zenodo.156534</ext-link>.</p>
      <p>We bin the human genome (GRCh37 assembly) into 200 bp bins (<inline-formula id="IE002"><mml:math id="IM1"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:math></inline-formula>) every 50 bp. For each of the 123 cellular contexts (<inline-formula id="IE1"><mml:math id="IM2"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mn>123</mml:mn><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></inline-formula>), all bins are assigned binary labels (<inline-formula id="IE2"><mml:math id="IM3"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></inline-formula>) corresponding to accessible (+1) or inaccessible (0) state based on whether they overlap (&gt;50% overlap) context-specific reproducible DNase-seq peaks or not. The genome-wide binary labels for each task <italic>j</italic> (cellular context) are highly imbalanced (Proportion of positive bins: min = 3%, median = 7%, max = 10% across cell types). The complete binary label matrix is available via a Zenodo archive <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.2603199">https://doi.org/10.5281/zenodo.2603199</ext-link>. The <italic>cis</italic>-regulatory sequence context (S<sub><italic>i</italic></sub>) for each bin <italic>i</italic> is represented using 1000 bp of genomic DNA sequence centered at the bin. We use a 1000 bp sequence context since previous work showed performance gains using contexts up to 1000 bp (<xref rid="btz352-B3" ref-type="bibr">Avsec <italic>et al.</italic>, 2018</xref>; <xref rid="btz352-B44" ref-type="bibr">Zhou and Troyanskaya, 2015</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Gene expression data</title>
      <p>RNA-seq fastq files (no subsampling, no filtering, no trimming) from Roadmap and ENCODE were mapped using the STAR aligner (version 2.4.1d), using ENCODE default parameters. GENCODE release 19 (GRCh37.p13) transcriptome annotations were used. To determine the strandedness of the file (which is needed for RSEM quantification), the infer_experiment.py script from RSeQC (version 2.6.4) was used in conjunction with the STAR output that was sorted by coordinate. The strandedness and the pairedness (paired-end or single-end) of the experiment were passed on to RSEM (version 1.2.21). For RSEM, we used ‘–estimate-rspd’ to estimate read start position distribution, and we did not calculate confidence bounds. If the experiment was stranded, we set ‘–forward-prob’ to be 0, and unstranded experiments were left at default. The transcriptome aligned file from STAR was used in the RSEM run. The complete list of RNA-seq datasets and their identifiers is provided in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>. The pipeline is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ENCODE-DCC/rna-seq-pipeline">https://github.com/ENCODE-DCC/rna-seq-pipeline</ext-link> (v1.0).</p>
      <p>The final dataset includes RNA-seq data associated with each of the 123 cell types. We extract the transcripts per million (TPM) values and use the log transformed TPM values.</p>
      <p>The <italic>trans</italic>-regulatory feature space <italic>R<sub>j</sub></italic> for each cellular context <inline-formula id="IE3"><mml:math id="IM4"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mn>123</mml:mn><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></inline-formula> is represented by the log(TPM) expression levels of a list of 1630 putative TFs as curated by the FANTOM5 consortium (<ext-link ext-link-type="uri" xlink:href="http://fantom.gsc.riken.jp/5/sstar/Browse_Transcription_Factors_hg19">http://fantom.gsc.riken.jp/5/sstar/Browse_Transcription_Factors_hg19</ext-link>) of human TFs. The TF gene expression feature matrix is available via a Zenodo archive <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.2603199">https://doi.org/10.5281/zenodo.2603199</ext-link>.</p>
    </sec>
    <sec>
      <title>2.3 ChromDragoNN neural network architecture</title>
      <p>Our goal is to learn a model <inline-formula id="IE4"><mml:math id="IM5"><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> that can predict the binary chromatin accessibility state <inline-formula id="IE5"><mml:math id="IM6"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> at any bin <italic>i</italic> in genome in any cellular context <italic>j</italic> as a function of the one-hot encoded 1 kb <italic>cis</italic>-regulatory sequence context Si of bin <italic>i</italic> and the expression of 1630 TFs <italic>R<sub>j</sub></italic> in cellular context <italic>j</italic>. We use a multi-modal neural network model to integrate the <italic>cis</italic>-sequence and <italic>trans</italic>-expression modalities and optionally the mean accessibility of the bin across cell types.</p>
      <p>The one-hot encoded sequence <italic>S<sub>i</sub></italic> for each bin <italic>i</italic> in the genome is fed into a residual convolutional neural network (ResNet) model (<xref ref-type="fig" rid="btz352-F1">Fig. 1A</xref>). The ResNet architecture includes hierarchically arranged convolution layers that are able to map one-hot encodings of raw DNA sequence input data to learn complex representations without explicit feature engineering. Each convolution layer learns and scans a set of weight matrix pattern detectors (convolutional filters) across its input and detects patterns in the input sequence. ResNets (<xref rid="btz352-B15" ref-type="bibr">He <italic>et al.</italic>, 2016</xref>) have been shown to be more effective for training CNNs with a large number of layers by introducing skip connections between blocks of convolution layers to optimize gradient flow and improve learning. Utilizing these concepts, we use a ResNet architecture to extend previous models (<xref rid="btz352-B18" ref-type="bibr">Kelley <italic>et al.</italic>, 2016</xref>; <xref rid="btz352-B42" ref-type="bibr">Wnuk <italic>et al.</italic>, 2017</xref>). The residual network (<xref rid="btz352-B15" ref-type="bibr">He <italic>et al.</italic>, 2016</xref>) consists of blocks in which the input is transformed through one or more convolutional layers to an intermediate output to which the input is added back. In our model, the convolution layers within a block preserve the input dimensions.</p>
      <fig id="btz352-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>Improved training methods and new architecture design enhances model performance (<bold>A</bold>) Model architecture for the ResNet model. The RNA-seq inputs and mean accessibility (if used) are concatenated after the convolutional layers. (<bold>B</bold>) The validation set loss over training steps for a model (Basset architecture for sequence mode) with and without two-stage learning (without mean accessibility as an input feature). In two-stage learning the weights of the convolutional layer of the model are initialized from a model first trained to map sequence to chromatin accessibility for all training cell types. (<bold>C</bold>) The test set AUPRC of the original Basset model, Factorized model and ResNet model under 4 training paradigms: with and without mean accessibility as an input feature, and with (Tune) and without (Freeze) fine-tuning convolution layers in second stage. Numbers reported on a fixed training, validation and test split with 103 training, 10 validation and 10 test cell types. Models using mean accessibility as an input feature significantly outperform models without mean accessibility. (<bold>D</bold>) Five-fold cross-validation performance of the ResNet model compared to the Factorized model with and without mean locus accessibility as an input to the model. Each fold contains a split over 123 cell types in the dataset. All models trained using 2-stage scheme with all weights tunable in second stage. Wilcoxon signed rank test (single-tailed) was performed with <italic>n</italic> = 5, n.s. not significant, *<italic>P</italic>&lt;0.05. (<bold>E</bold>) Binned AUPRC of Factorized model without mean accessibility, ResNet model without mean accessibility and ResNet model with mean accessibility. Loci are binned by the fraction of training cell types that are accessible, and AUPRC is computed for predictions on test cell types for each bin. Note that AUPRC is computed for the minority class—when fraction of accessible cell types &gt;0.5, AUPRC is computed on non-accessible regions. Gray bars indicate the fraction of loci having a certain fraction of accessible cell types. Numbers reported on a training, validation and test split same as for (C)</p>
        </caption>
        <graphic xlink:href="btz352f1"/>
      </fig>
      <p>To provide the model with quantitative information on the availability of <italic>trans</italic>-regulator TFs, we follow recent work (<xref rid="btz352-B42" ref-type="bibr">Wnuk <italic>et al.</italic>, 2017</xref>) that extended the Basset model to predict chromatin accessibility in held-out cellular contexts, using RNA-seq profiles as surrogates of cell-type specific availability and activity of <italic>trans</italic>-regulators. RNA-seq profiles have been shown to uniquely identify individual cell types while preserving biological similarity between cell types (<xref rid="btz352-B38" ref-type="bibr">Sudmant <italic>et al.</italic>, 2015</xref>). We use log(TPM) RNA expression levels of 1630 TFs as a meaningful representation of <italic>trans</italic>-regulatory cell state, as TFs are the DNA binding proteins that would affect chromatin accessibility by binding <italic>cis</italic>-regulatory sequence patterns. The sequence ResNet-CNN component of the model learns <italic>cis</italic>-regulatory sequence patterns and returns a transformed sequence-based feature space as intermediate representation. The TF RNA-seq vector <italic>R<sub>j</sub></italic> for cellular context <italic>j</italic> is concatenated with this intermediate sequence representation, which is then passed through fully connected neural network layers and a logistic non-linearity to produce an output <inline-formula id="IE6"><mml:math id="IM7"><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> representing the predicted probability that the bin <italic>i</italic> is accessible in the cellular context <italic>j</italic>. The mean accessibility for bin <italic>i</italic> across all training cell types, if used, is concatenated at the final fully connected layer. The complete sequential network is as follows:</p>
      <p>One-hot input sequence of dimension 1000. Two convolutional layers with 48 and 64 channels, respectively, filter size (3, 1). Two residual blocks, each with three convolution layers with 64 channels and filter size (3, 1). Two residual blocks, each with two convolution layers with 128 channels and filter size (7, 1). Two residual blocks, each with three convolution layers with 200 channels and filter sizes (7, 1), (3, 1), (3, 1) respectively. Two residual blocks, each with two convolution layers with 200 channels and filter size (7, 1). The output is flattened and concatenated with gene expression. In case of mean accessibility models, the mean is concatenated. Fully connected layer with 1000 dimension output. Fully connected layer with 1000 dimension output. Fully connected layer with one output dimension.</p>
      <p>A single convolution layer is present after each residual block (except the third) to transform the number of channels. Batch normalization (<xref rid="btz352-B16" ref-type="bibr">Ioffe and Szegedy, 2015</xref>) layers are present after each layer. A max pool is applied after the last three residual blocks. We use the ReLU non-linearity transform. We use a fixed dropout of 0.3 on the fully connected layers.</p>
    </sec>
    <sec>
      <title>2.4 Multi-stage training</title>
      <p>We randomly split our 123 cellular contexts into training, validation and test sets across 5 folds (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>). For each fold, we train models genome-wide across the training cell types. The validation set cell types are used for hyperparameter tuning. The models are evaluated based on their genome-wide predictions in the held-out cell types in the test sets.</p>
      <p>The shift from a multi-task, cell-type specific sequence-only model to a single-task, cross-cell type, multi-modal model increases the number of training examples by a factor of <italic>C</italic>, equal to the number of cell types in the training data. The increased size of the training data has implications for training. A naive training setup could potentially take up to a factor <italic>C</italic> longer to train compared to a fixed cell type model. To improve efficiency, performance and interpretability, we train our models in two steps: the first stage pre-trains a multi-task sequence-only model that maps sequence of each genomic bin to accessibility labels in each of the cellular contexts in the training set as individual tasks. The second stage trains the multi-modal model across all genomic bins and cellular contexts in the training set by initializing the sequence-mode’s convolutional layer weights using the pre-trained model. The two-stage training scheme provides added flexibility in that during the second stage of training, the convolutional layer weights may or may not be frozen while the fully connected layers are trained.</p>
    </sec>
    <sec>
      <title>2.5 Model training and testing</title>
      <p>We use the Adam optimizer (<xref rid="btz352-B20" ref-type="bibr">Kingma and Ba, 2014</xref>) on binary cross entropy loss to update our network’s weights, along with batch normalization on the convolution and fully connected layers. We use the default PyTorch v0.4 parameter initialization method (<xref rid="btz352-B23" ref-type="bibr">LeCun <italic>et al.</italic>, 2012</xref>). We perform hyperparameter searches for all stage 1 models with batch sizes (128, 256) and learning rates (2e-2, 2e-3, 2e-4), and for stage 2 models with batch sizes (256, 512, 1024) and learning rates (1e-3, 1e-4). To mitigate the class imbalance, we maintained a 1:3 ratio of positives to negatives per batch by upsampling accessible regions in the second stage of training.</p>
      <p>Given the significant class imbalance in the labels, we use the area under precision–recall curve (AUPRC) as our primary performance evaluation measure.</p>
    </sec>
    <sec>
      <title>2.6 Motif extraction</title>
      <p>The dynamics of chromatin accessibility of regulatory elements across cellular contexts is a result of distinct subsets of context-specific TFs binding combinations of motifs encoded in the sequence of the regulatory elements (<xref rid="btz352-B33" ref-type="bibr">Sherwood <italic>et al.</italic>, 2014</xref>; <xref rid="btz352-B41" ref-type="bibr">Voss and Hager, 2014</xref>). Deep neural network models of regulatory DNA sequence implicitly learn these motifs as distributed representations across the convolutional filters. Hence, valuable insights on predictive regulatory sequence features can be obtained by interpreting the model. A commonly used approach involves directly visualizing the convolutional filters or deriving position weight matrices from subsequences that maximally activate filters (<xref rid="btz352-B18" ref-type="bibr">Kelley <italic>et al.</italic>, 2016</xref>). However, this approach has the drawback that the motifs obtained from individual filters are often redundant or incomplete since the models learn distributed representations (<xref rid="btz352-B35" ref-type="bibr">Shrikumar <italic>et al.</italic>, 2018</xref>). An alternative approach is to use feature attribution methods to interpret predictive patterns in specific input DNA sequences. These feature attribution methods (<xref rid="btz352-B34" ref-type="bibr">Shrikumar <italic>et al.</italic>, 2017</xref>; <xref rid="btz352-B36" ref-type="bibr">Simonyan <italic>et al.</italic>, 2013</xref>; <xref rid="btz352-B39" ref-type="bibr">Sundararajan <italic>et al.</italic>, 2017</xref>) decompose the output prediction of a model for a specific input sequence of interest in the form of contribution scores of individual nucleotides in the sequence. Nucleotides with high positive scores can be interpreted as driving the prediction for the sequence. Feature attribution methods allow for instance-by-instance interpretation of predictive patterns but do not provide a global summary of predictive motifs across all accessible sites within and across cellular contexts. Hence, we used a new method we recently developed called TF-MoDISco (v0.2.1) (<xref rid="btz352-B35" ref-type="bibr">Shrikumar <italic>et al.</italic>, 2018</xref>) that (i) identifies predictive sequence patterns within the sequences of each accessible site across the genome in a cell context of interest as subsequences (called seqlets) with significant contribution scores derived using a feature attribution method (specified below); (ii) computes a similarity matrix between all predictive seqlets across the accessible landscape and (iii) clusters the seqlets into non-redundant motifs. To obtain nucleotide-resolution contribution scores for each input sequence corresponding to accessible bins in the genome in a specific cellular context, we used the gradient of the logit of the output probability of the model (predicted probability of site being accessible in the specific cellular context) with respect to the one-hot DNA sequence, gated by the observed nucleotides in the input sequence. To focus on motifs associated with dynamic chromatin accessible sites, for each cellular context, we extracted the contribution score profiles from the ResNet model (that does not use mean accessibility as an input feature) for subsets of 20 000 bins that are accessible in the given cellular context and in &lt;30% of all the cell types. Contribution score profiles computed for these 20 K sequences in each cellular context were passed to TF-MoDISco to learn context-specific globally predictive motifs. The TF-MoDISco motifs were matched against a database of known TF motifs using Tomtom (<xref rid="btz352-B14" ref-type="bibr">Gupta <italic>et al.</italic>, 2007</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Accurate prediction of chromatin accessibility across cellular contexts from DNA sequence and gene expression with multi-stage training</title>
      <p>We developed multi-modal neural network architectures to predict the binary chromatin accessibility state at each bin in the genome in any cellular context by integrating 1 kb <italic>cis</italic>-regulatory sequence context around each genomic bin and gene expression levels of 1630 TFs in the specific cellular context. Models were trained on a subset of training cell types and their performance was reported based on genome-wide predictions in held-out test cell types. We developed a two-stage learning strategy to improve efficiency, performance and interpretability of the models. In the first stage, we pre-trained a multi-task sequence-only model across all training cell types. In the second stage, we trained a multi-modal model integrating sequence and expression, where we initialized the convolutional layer weights of the sequence model from the first stage. We found that tuning the convolution layers in the second stage consistently improved performance over freezing the weights of the layers at an increased computational cost. Further, pre-training the sequence mode consistently improved training time and performance (<xref ref-type="fig" rid="btz352-F1">Fig. 1B</xref>).</p>
      <p>We experimented with different CNN architectures, training strategies and tested the impact of adding an additional feature—the mean accessibility of a genomic bin across training cell types. After evaluating the various models on our validation datasets, our best model architecture achieves an average AUPRC=0.76 and area under Receiver Operating Characteristic curve (AUROC)=0.954 across five folds, outperforming previously published model architectures trained and tested on matching data (average AUPRC=0.69, AUROC=0.937 across five folds) (<xref ref-type="fig" rid="btz352-F1">Fig. 1C</xref>).</p>
    </sec>
    <sec>
      <title>3.2 Using mean accessibility as an input feature boosts performance</title>
      <p>A key difference between cell-type specific models and cross-cell type models is that cross-cell type models can make use of statistics based on the accessibility state of each genomic bin (locus) across the training cell types. For each bin in the genome, we computed the mean of the binary accessibility values across all cell types in the training set. Since binary accessibility is 0 if the locus is closed and 1 if open, the mean accessibility is a value in <inline-formula id="IE7"><mml:math id="IM8"><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:math></inline-formula> that is equivalent to the fraction of cell types in which the bin is accessible.</p>
      <p>We observed that mean accessibility is a strong baseline predictor of chromatin accessibility across cell types [also recently reported by <xref rid="btz352-B32" ref-type="bibr">Schreiber <italic>et al.</italic> (2019)</xref>]. Setting the predicted accessibility of a locus equal to its mean accessibility across training cell types yielded an AUPRC of 0.579 and an AUROC of 0.902 on the test set. This method is oblivious to the test cell type and in fact assigns the same values to all test cell types for a given bin. A stronger baseline is achieved by computing a weighted average of accessibility across training cell types, where the weight is proportional to the similarity between RNA-seq profiles of the training and test cell types. The resulting predictions yield an AUPRC of 0.587 and AUROC of 0.903 which are marginally better than the unweighted version.</p>
      <p>All our multi-modal models that use sequence and expression substantially outperform this strong baseline predictor (mean baseline AUPRC = 0.579, weighted-mean baseline AUPRC = 0.587, Basset+expr AUPRC = 0.656, FactorizedBasset+expr AUPRC = 0.692, ResNet+expr AUPRC = 0.700). However, we decided to capitalize on the strong mean baseline and decided to use it as an auxiliary input feature to the multi-modal model. The single scalar mean accessibility value for each bin is concatenated with the output of first feed forward layer. We observe substantial improvements when the mean accessibility feature is provided as an input to the model (<xref ref-type="fig" rid="btz352-F1">Fig. 1C and D</xref>). Across three different types of architectures that we trained, incorporating the mean as an input feature improves the performance of the model by as much as 0.09 AUPRC.</p>
    </sec>
    <sec>
      <title>3.3 Residual network architecture outperforms previous architectures</title>
      <p>ResNets (<xref rid="btz352-B15" ref-type="bibr">He <italic>et al.</italic>, 2016</xref>) have been shown to be highly effective for training deeper CNNs with a large number of layers. ResNets provide added flexibility to CNNs by introducing skip connections between blocks of convolution layers. In practice, while the performance of ordinary CNNs saturates or even drops with increasing layers (<xref rid="btz352-B37" ref-type="bibr">Srivastava <italic>et al.</italic>, 2015</xref>), ResNets have made possible training of CNNs often having &gt;100 convolution layers. ResNets have also recently been used to train high performance deep learning sequence models of splicing (<xref rid="btz352-B17" ref-type="bibr">Jaganathan <italic>et al.</italic>, 2019</xref>).</p>
      <p>We implemented a ResNet architecture that uses 23 convolution layers across eight residual blocks. Following the Factorized model, we used convolution filters with shorter widths. <xref ref-type="fig" rid="btz352-F1">Figure 1D</xref> shows the results of a 5-fold cross-validation performed on our dataset. We compared the performance of the model with the Factorized model with and without passing mean locus accessibility as an input to the model. In both cases, the ResNet architecture improved upon the performance of the Factorized model. Overall, our best performing ResNet(+mean accessibility) model achieves a mean AUPRC of 0.76 while the previous best published model in the literature i.e. the Factorized Basset model (<xref rid="btz352-B42" ref-type="bibr">Wnuk <italic>et al.</italic>, 2017</xref>) achieves 0.69 (<xref ref-type="fig" rid="btz352-F1">Fig. 1C</xref>) on a matched training/validation/test data split.</p>
      <p>Next, in order to understand performance variation as a function of cell-type specificity of accessible sites, we grouped genomic bins based on the fraction of cell types in which bins exhibit accessibility. For each group, we compared the AUPRC of our best ResNet model that included mean accessibility as auxiliary input with the previous best published model i.e. Factorized Basset without mean accessibility (<xref ref-type="fig" rid="btz352-F1">Fig. 1E</xref>). Our models consistently outperform the previous state-of-the-art across all groups.</p>
    </sec>
    <sec>
      <title>3.4 Model interpretation reveals cell-type specific <italic>cis</italic>-regulatory sequence features and associated <italic>trans</italic>-regulators</title>
      <p>Understanding what the model is utilizing in the DNA sequence input is of interest, and previous work has successfully shown that CNNs learn predictive motif-like patterns of cell-type relevant TFs from regulatory DNA sequences (<xref rid="btz352-B18" ref-type="bibr">Kelley <italic>et al.</italic>, 2016</xref>). However, the model learns a distributed representation of the sequence features. Hence, interpreting individual convolutional filters results in redundant and partially complete motifs. Instead, we use TF-MoDISco, a new method we recently developed, for distilling consolidated motifs from sequence-based deep learning models (<xref rid="btz352-B35" ref-type="bibr">Shrikumar <italic>et al.</italic>, 2018</xref>). First, we use a feature attribution approach (gradient×input) to infer contribution scores attributed by the model to each nucleotide in chromatin accessible sequences with respect to the output prediction in each cellular context. Predictive nucleotides and motif instances get highlighted with high positive contribution scores. The same sequence can have different contribution score profiles across different cellular contexts representing dynamic regulation of the region by different sequence motifs (<xref ref-type="fig" rid="btz352-F2">Fig. 2A</xref>). For each cellular context, we sample a subset of bins that are labeled accessible, obtain contribution scores for corresponding input sequences and extract motifs using TF-MoDISco with default parameters. The motifs are matched against a database of known motifs of TFs using Tomtom (<xref rid="btz352-B14" ref-type="bibr">Gupta <italic>et al.</italic>, 2007</xref>). The sets of motifs retrieved for each cellular context reflect the globally predictive TF motif patterns learned by the model for that context (<xref ref-type="fig" rid="btz352-F2">Fig. 2B</xref>).</p>
      <fig id="btz352-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Cell-type specific TF motifs distilled from the ResNet model (<bold>A</bold>) Gradient × input contribution scores of each nucleotide (columns) in an example genomic sequence (chr8: 128929715–128931715) across different cellular contexts (tasks shown as rows). The obtained nucleotide-resolution contribution scores for the same genomic sequence can differ between cell-types reflecting differential chromatin accessibility and differences in regulation of the sequence, as shown in this example locus. (<bold>B</bold>) Summary of motifs learned by the model for individual cell types. The TF-MoDISco method is used to distill consolidated motifs learned by the model for each cell type using a subset of sequences which are accessible in the respective cell type. The returned motifs are then matched to known motifs of TFs using Tomtom (<xref rid="btz352-B14" ref-type="bibr">Gupta <italic>et al.</italic>, 2007</xref>)</p>
        </caption>
        <graphic xlink:href="btz352f2"/>
      </fig>
      <p>The model learned known DNA motifs of ubiquitous as well as cell-type specific TFs that match the canonical roles of TFs in different lineages (<xref ref-type="fig" rid="btz352-F2">Fig. 2B</xref>). As reported in <xref rid="btz352-B18" ref-type="bibr">Kelley <italic>et al.</italic> (2016)</xref>, the model learns the CTCF motif as a widely important sequence element for accessible regions across cellular contexts (<xref rid="btz352-B27" ref-type="bibr">Ong and Corces, 2014</xref>). The HNF1A and HNF4A motifs are more narrowly predictive of accessibility in hepatocyte-related, large and small intestinal contexts (<xref rid="btz352-B11" ref-type="bibr">D’Angelo <italic>et al.</italic>, 2010</xref>). The model discovers SIX2 motif as a key predictor in kidney-related contexts (<xref rid="btz352-B21" ref-type="bibr">Kobayashi <italic>et al.</italic>, 2008</xref>). TWIST1 motif is retrieved for contexts of mesenchymal origin (<xref rid="btz352-B29" ref-type="bibr">Qin <italic>et al.</italic>, 2012</xref>), while RUNX1, ETS1 and IRF1 motifs are mainly discovered only in specific hematopoietic cell types (<xref rid="btz352-B6" ref-type="bibr">Brien <italic>et al.</italic>, 2011</xref>). GRHL2 motif is discovered in the lung, epithelial cells and kidneys, which matches known differential expression patterns of GRHL family TFs across cell types (<xref rid="btz352-B2" ref-type="bibr">Aue <italic>et al.</italic>, 2015</xref>). No prior information about sequence motifs is provided to the model, suggesting that the model is effective at extracting cell context relevant <italic>cis</italic>-regulatory features from the DNA sequence input.</p>
      <p>Many of the discovered motifs are cell-type specific, which suggested that intersecting these results with the dynamics of RNA expression profiles of <italic>trans</italic>-regulators could potentially lead us to the TFs that potentially bind these discovered motifs. For each discovered motif, we determined all the TFs (often from the same family) that could potentially bind the motif. We computed the binary vector of dynamic motif activity for each motif across cell types (whether that motif was discovered by TF-MoDISco in the cell type or not). We computed the Pearson correlation between the motif activity vector and the vector of expression levels of matching TFs across those cell types. We show the top 15 most correlated TFs in <xref ref-type="fig" rid="btz352-F3">Fig. 3A</xref>. This analysis highlighted several known key regulators, both universal and cell-type specific, across a variety of cell types. TWIST1 is a known regulator in mesenchymal cell types and is highlighted as important in muscle cell types and fibroblasts (<xref rid="btz352-B29" ref-type="bibr">Qin <italic>et al.</italic>, 2012</xref>). RUNX3 and IRF1 are important regulators in blood cell types (<xref rid="btz352-B6" ref-type="bibr">Brien <italic>et al.</italic>, 2011</xref>), while HNF4A is a master regulator in intestinal development (<xref rid="btz352-B4" ref-type="bibr">Babeu and Boudreau, 2014</xref>). HNF1A, GRHL2, SIX2 and HOXA9 are all regulators known to be important in kidney development (<xref rid="btz352-B2" ref-type="bibr">Aue <italic>et al.</italic>, 2015</xref>; <xref rid="btz352-B21" ref-type="bibr">Kobayashi <italic>et al.</italic>, 2008</xref>; <xref rid="btz352-B26" ref-type="bibr">Martovetsky <italic>et al.</italic>, 2013</xref>), and are highlighted here as important specifically in kidney cell types. Interestingly, ASCL1 is highlighted as important in thymus and spleen cell types, where the expression is also very specifically high in these cell types—this suggests a role for ASCL1 in these cell types that was not elucidated before, though further work is required to fully validate this hypothesis. This analysis thus uncovers possible <italic>trans</italic>-regulators that modulate cell context-specific chromatin accessibility profiles through predictive <italic>cis</italic>-regulatory motifs.</p>
      <fig id="btz352-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Predictive <italic>cis</italic>-sequence features and <italic>trans</italic>-regulators inferred from the models: (<bold>A</bold>) TF-MoDISco motifs (left) and row-normalized log TPM RNA-expression values (right) for each training cell type, where each row is a matching motif and TF. (<bold>B</bold>) t-SNE embedding of 250 additional cell types (points) based on the RNA-seq profiles of 1630 TFs (left) compared to t-SNE embedding of the same cell types based on the predicted chromatin accessibility profiles</p>
        </caption>
        <graphic xlink:href="btz352f3"/>
      </fig>
    </sec>
    <sec>
      <title>3.5 Biologically relevant segregation of cell types based on predicted chromatin accessibility</title>
      <p>We used our cross-cell type, multi-modal models to impute genome-wide binary chromatin accessibility profiles in 250 additional cellular contexts (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>) that were not seen in our original dataset and were profiled only using RNA-seq. These new imputed samples were then embedded into a 2D visualization using t-SNE (<xref rid="btz352-B25" ref-type="bibr">Maaten and Hinton, 2008</xref>) to determine how well the imputed accessibility profiles group distinct and related cell types. Comparing an equivalent t-SNE visualization in RNA-seq expression space (using the 1630 TFs as features) to the predicted chromatin accessibility (<xref ref-type="fig" rid="btz352-F3">Fig. 3B</xref>), we find that the t-SNE map from imputed accessibility shows improved separation of distinct clusters of samples grouped by cell type and disease state. E.g. the carcinoma cell types and the adenocarcinoma cell types are embedded near each other in the t-SNE from predicted accessibility. Further, the predicted accessibility t-SNE embeds the adenocarcinomas as slightly offset from the carcinomas. While t-SNE embeddings can be unstable and difficult to interpret, our visualizations do suggest that the imputed accessibility profiles do capture biologically meaningful differences and similarities between cell types and that these differences are not simply reflecting differences in expression of the TFs that were used as predictors. This ability to distinguish cell types through imputed accessibility profiles is important because it suggests that given a new expression profile, these models can produce distinct accessibility profiles that may be granular enough to potentially reveal subtypes and finer grained structure beyond the expression profile.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We present an optimized multi-modal residual network architecture that can integrate <italic>cis</italic>-regulatory DNA sequence and expression of <italic>trans</italic>-regulators to predict genome-wide binary chromatin accessibility profiles across cellular contexts. The model can be used to predict genome-wide chromatin accessibility in cellular contexts that are only profiled with RNA-seq. This is particularly useful given the large number of profiled transcriptomes that do not have corresponding experimentally profiled epigenomes. We demonstrate that accessibility profiles predicted from sequence and TF expression do not simply recapitulate the landscape of expression profiles across cell types but rather provides a complementary feature space that can discriminate between related and distinct cellular contexts.</p>
    <p>Using enhanced training strategies, we achieve a new state-of-the-art in terms of prediction performance across cellular contexts. We show that a two-stage training strategy that pre-trains using only sequence before integrating the expression data improves performance and training time. This method of transfer learning is common in applications in computer vision and natural language processing (<xref rid="btz352-B8" ref-type="bibr">Chen <italic>et al.</italic>, 2015</xref>; <xref rid="btz352-B28" ref-type="bibr">Oquab <italic>et al.</italic>, 2014</xref>). In two-stage model learning, we show that tuning the convolution layers in the second stage offers a benefit over freezing the weights of the layers, however, at an increased computational cost. Mean accessibility of a given locus across contexts is a surprisingly strong predictor of chromatin accessibility. Combining the mean accessibility with <italic>cis</italic>-regulatory sequence and <italic>trans</italic>-regulator RNA expression allows improved prediction performance. Notably, we find that adding mean accessibility as a feature improves performance across all types of accessible sites including the cell-type specific and ubiquitously active.</p>
    <p>We demonstrate that using a residual CNN architecture for chromatin accessibility prediction results in superior performance compared to previous architectures. Recent related work (<xref rid="btz352-B42" ref-type="bibr">Wnuk <italic>et al.</italic>, 2017</xref>) showed that increasing the number of convolution layers while reducing the width of each convolution layer increases the model performance. ResNets (<xref rid="btz352-B15" ref-type="bibr">He <italic>et al.</italic>, 2016</xref>) allows for connections between non-adjacent layers and have been shown to confer performance gains in deep networks. We observe and confirm similar improvements in model performance for predicting chromatin accessibility models.</p>
    <p>Recently developed imputation methods such as ChromImpute (<xref rid="btz352-B13" ref-type="bibr">Ernst and Kellis, 2015</xref>), BIRD (<xref rid="btz352-B45" ref-type="bibr">Zhou <italic>et al.,</italic> 2017</xref>), PREDICTD (<xref rid="btz352-B12" ref-type="bibr">Durham <italic>et al.</italic>, 2018</xref>) and Avocado (<xref rid="btz352-B31" ref-type="bibr">Schreiber <italic>et al.</italic>, 2018</xref>) also tackle the problem of predicting regulatory profiles in new cellular contexts. In systematic comparisons on matched data, our models outperform the BIRD method in predicting genome-wide binary chromatin accessibility profiles from RNA expression data (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S4</xref>). The imputation methods are based on capturing and modeling the local correlation structure between profiles of multiple biochemical markers such as RNA, histone modifications and chromatin accessibility within and across diverse cell types. In our framework, we instead use only one widely available auxiliary modality, the gene expression of <italic>trans</italic>-regulators. Moreover, the above mentioned imputation methods do not model <italic>cis</italic>-regulatory DNA sequence and hence lack the ability to interpret biologically meaningful predictive sequence features from the models. Our models enable interpretation of predictive <italic>cis</italic>-sequence features learned by the models. Using model interpretation methods, we show that our models learn motifs of ubiquitous and lineage specific TFs. Correlating the RNA profiles of TFs with the dynamic predictive activity of motifs discovered by the model provides insights into the TFs that might bind these motifs and the relationship between <italic>cis</italic>- and <italic>trans</italic>-regulatory features.</p>
    <p>Our current models predict genome-wide binary chromatin accessibility profiles instead of continuous, quantitative profiles. However, our models can be easily adapted to predict continuous, quantitative profiles at finer resolutions by using regression loss functions (<xref rid="btz352-B19" ref-type="bibr">Kelley <italic>et al.</italic>, 2018</xref>). Our models can also be extended to include additional input data modalities or predict other types of genome-wide regulatory profiles such as histone modification profiles. Finally, improved approaches for interpreting multi-modal neural networks will provide significantly more nuanced insights into the complex interactions between <italic>cis</italic>-regulatory sequence features and <italic>trans</italic>-regulatory features. More transparent encodings of the gene expression space (e.g. using latent variables that directly model modules of functionally related genes or pathway annotations) would also improve interpretability. Our study highlights the promise of integrative multi-modal deep learning models for learning predictive models that generalize across cellular contexts and obtaining insight into the dynamics of gene regulation.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz352_Supplementary_Data</label>
      <media xlink:href="btz352_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The computing for this project was performed on the Sherlock and Nautilus clusters. We thank Stanford University, the Stanford Research Computing Center and the Pacific Research Platform for computational resources.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the National Institute of Health grants 1DP2GM123485, 1U01HG009431, 1R01HG009674. DSK is supported by a BioX Fellowship.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz352-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alipanahi</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Predicting the sequence specificities of DNA-and RNA-binding proteins by deep learning</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>831.</fpage><pub-id pub-id-type="pmid">26213851</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Aue</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>A grainyhead-like 2/ovo-like 2 pathway regulates renal epithelial barrier function and lumen expansion</article-title>. <source>J. Am. Soc. Nephrol</source>., <volume>26</volume>, <fpage>2704</fpage>–<lpage>2715</lpage>.<pub-id pub-id-type="pmid">25788534</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Avsec</surname><given-names>Z.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>). 
<article-title>Kipoi: Accelerating the Community Exchange and Reuse of Predictive Models for Genomics</article-title>. <source>bioRxiv</source>, p. <fpage>375345</fpage>.</mixed-citation>
    </ref>
    <ref id="btz352-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Babeu</surname><given-names>J.-P.</given-names></name>, <name name-style="western"><surname>Boudreau</surname><given-names>F.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Hepatocyte nuclear factor 4-alpha involvement in liver and intestinal inflammatory networks</article-title>. <source>World J. Gastroenterol</source>., <volume>20</volume>, <fpage>22.</fpage><pub-id pub-id-type="pmid">24415854</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Boyle</surname><given-names>A.P.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>High-resolution mapping and characterization of open chromatin across the genome</article-title>. <source>Cell</source>, <volume>132</volume>, <fpage>311</fpage>–<lpage>322</lpage>.<pub-id pub-id-type="pmid">18243105</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brien</surname><given-names>J.D.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Interferon regulatory factor-1 (IRF-1) shapes both innate and cd8+ t cell immune responses against west Nile virus infection</article-title>. <source>PLoS Pathogens</source>, <volume>7</volume>, <fpage>e1002230.</fpage><pub-id pub-id-type="pmid">21909274</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Buenrostro</surname><given-names>J.D.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Transposition of native chromatin for multimodal regulatory analysis and personal epigenomics</article-title>. <source>Nat. Methods</source>, <volume>10</volume>, <fpage>1213.</fpage><pub-id pub-id-type="pmid">24097267</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>). 
<article-title>Net2net: accelerating learning via knowledge transfer</article-title>. In: <source>4th International Conference on Learning Representations, ICLR 2016</source>. Conference Track Proceedings, May 2-4, 2016, San Juan, Puerto Rico.</mixed-citation>
    </ref>
    <ref id="btz352-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Collado-Torres</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Reproducible RNA-seq analysis using recount2</article-title>. <source>Nat. Biotechnol</source>., <volume>35</volume>, <fpage>319.</fpage><pub-id pub-id-type="pmid">28398307</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Consortium</surname><given-names>T.E.P.</given-names></name></person-group> (<year>2012</year>). 
<article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>, <volume>489</volume>, <fpage>57</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>D’Angelo</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Hepatocyte nuclear factor 1α and β control terminal differentiation and cell fate commitment in the gut epithelium</article-title>. <source>Development</source>, <volume>137</volume>, <fpage>1573</fpage>–<lpage>1582</lpage>.<pub-id pub-id-type="pmid">20388655</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Durham</surname><given-names>T.J.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Predicted parallel epigenomics data imputation with cloud-based tensor decomposition</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>1402.</fpage><pub-id pub-id-type="pmid">29643364</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ernst</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Kellis</surname><given-names>M.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Large-scale imputation of epigenomic datasets for systematic annotation of diverse human tissues</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>364.</fpage><pub-id pub-id-type="pmid">25690853</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gupta</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Quantifying similarity between motifs</article-title>. <source>Genome Biol</source>., <volume>8</volume>, <fpage>R24.</fpage><pub-id pub-id-type="pmid">17324271</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>He</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>). Deep residual learning for image recognition. In: <italic>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</italic>, pp. <fpage>770</fpage>–<lpage>778</lpage>.</mixed-citation>
    </ref>
    <ref id="btz352-B16">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Ioffe</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Szegedy</surname><given-names>C.</given-names></name></person-group> (<year>2015</year>). Batch normalization: accelerating deep network training by reducing internal covariate shift. In: <italic>International Conference on Machine Learning</italic>, pp. <fpage>448</fpage>–<lpage>456</lpage>.</mixed-citation>
    </ref>
    <ref id="btz352-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jaganathan</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Predicting splicing from primary sequence with deep learning</article-title>. <source>Cell</source>, <volume>176,</volume><fpage>535</fpage>–<lpage>548.e24</lpage>.<pub-id pub-id-type="pmid">30661751</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kelley</surname><given-names>D.R.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Basset: learning the regulatory code of the accessible genome with deep convolutional neural networks</article-title>. <source>Genome Res</source>., <volume>26</volume>, <fpage>990</fpage>–<lpage>999</lpage>.<pub-id pub-id-type="pmid">27197224</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kelley</surname><given-names>D.R.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Sequential regulatory activity prediction across chromosomes with convolutional neural networks</article-title>. <source>Genome Res</source>., <volume>28</volume>, <fpage>739</fpage>–<lpage>750</lpage>.<pub-id pub-id-type="pmid">29588361</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kingma</surname><given-names>D.P.</given-names></name>, <name name-style="western"><surname>Ba</surname><given-names>J.</given-names></name></person-group> (<year>2014</year>). 
<article-title>Adam: a method for stochastic optimization</article-title>. In: <source>3rd International Conference on Learning Representations, ICLR 2015</source>. Conference Track Proceedings, May 7-9, 2015, San Diego, CA, USA.</mixed-citation>
    </ref>
    <ref id="btz352-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kobayashi</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Six2 defines and regulates a multipotent self-renewing nephron progenitor population throughout mammalian kidney development</article-title>. <source>Cell Stem Cell</source>, <volume>3</volume>, <fpage>169</fpage>–<lpage>181</lpage>.<pub-id pub-id-type="pmid">18682239</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kundaje</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Integrative analysis of 111 reference human epigenomes</article-title>. <source>Nature</source>, <volume>518</volume>, <fpage>317.</fpage><pub-id pub-id-type="pmid">25693563</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B23">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>LeCun</surname><given-names>Y.A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>). <chapter-title>Efficient backprop</chapter-title> In: <source>Neural Networks: Tricks of the Trade</source>, pp. <fpage>9</fpage>–<lpage>48</lpage>. 
<publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btz352-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>Q.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Measuring reproducibility of high-throughput experiments</article-title>. <source>Ann. Appl. Stat</source>., <volume>5</volume>, <fpage>1752</fpage>–<lpage>1779</lpage>.</mixed-citation>
    </ref>
    <ref id="btz352-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Maaten</surname><given-names>L. v d.</given-names></name>, <name name-style="western"><surname>Hinton</surname><given-names>G.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Visualizing data using t-SNE</article-title>. <source>J. Mach. Learn. Res</source>., <volume>9</volume>, <fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation>
    </ref>
    <ref id="btz352-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Martovetsky</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Hepatocyte nuclear factors 4a and 1a (hnf4a and hnf1a) regulate kidney developmental expression of drug-metabolizing enzymes and drug transporters</article-title>. <source>Mol. Pharmacol</source>., <volume>84</volume>, <fpage>808</fpage>–<lpage>823</lpage>.<pub-id pub-id-type="pmid">24038112</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ong</surname><given-names>C.-T.</given-names></name>, <name name-style="western"><surname>Corces</surname><given-names>V.G.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Ctcf: an architectural protein bridging genome topology and function</article-title>. <source>Nat. Rev. Genet</source>., <volume>15</volume>, <fpage>234.</fpage><pub-id pub-id-type="pmid">24614316</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B28">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Oquab</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>). Learning and transferring mid-level image representations using convolutional neural networks. In: <italic>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</italic>, pp. <fpage>1717</fpage>–<lpage>1724</lpage>.</mixed-citation>
    </ref>
    <ref id="btz352-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Qin</surname><given-names>Q.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Normal and disease-related biological functions of twist1 and underlying molecular mechanisms</article-title>. <source>Cell Res</source>., <volume>22</volume>, <fpage>90.</fpage><pub-id pub-id-type="pmid">21876555</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Quang</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Xie</surname><given-names>X.</given-names></name></person-group> (<year>2016</year>). 
<article-title>Danq: a hybrid convolutional and recurrent deep neural network for quantifying the function of DNA sequences</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>e107</fpage>.<pub-id pub-id-type="pmid">27084946</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schreiber</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>). 
<article-title>Multi-Scale Deep Tensor Factorization Learns a Latent Representation of the Human Epigenome</article-title>. <source>bioRxiv</source>, p. <fpage>364976</fpage>.</mixed-citation>
    </ref>
    <ref id="btz352-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schreiber</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>). 
<article-title>A Pitfall for Machine Learning Methods Aiming to Predict across Cell Types</article-title>. <source>bioRxiv</source>, p. <fpage>512434</fpage>.</mixed-citation>
    </ref>
    <ref id="btz352-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sherwood</surname><given-names>R.I.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Discovery of directional and nondirectional pioneer transcription factors by modeling DNase profile magnitude and shape</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>171.</fpage><pub-id pub-id-type="pmid">24441470</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B34">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Shrikumar</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>). Learning important features through propagating activation differences. In: <italic>Proceedings of the 34th International Conference on Machine Learning</italic>, Vol. 70, pp. <fpage>3145</fpage>–<lpage>3153</lpage>.</mixed-citation>
    </ref>
    <ref id="btz352-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shrikumar</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>). 
<article-title>Tf-Modisco v0. 4.4. 2-Alpha</article-title>. <source>arXiv</source>:1811.00416.</mixed-citation>
    </ref>
    <ref id="btz352-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Simonyan</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>). 
<article-title>Deep inside convolutional networks: visualising image classification models and saliency maps</article-title>. In: <source>2nd International Conference on Learning Representations, ICLR 2014</source>. Workshop Track Proceedings, April 14-16, 2014, Banff, AB, Canada.</mixed-citation>
    </ref>
    <ref id="btz352-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Srivastava</surname><given-names>R.K.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>). 
<article-title>Training very deep networks</article-title>. In: <source>Advances in Neural Information Processing Systems 28: Annual Conference on Neural Information Processing Systems 2015</source>, pp. <fpage>2377</fpage>–<lpage>2385</lpage>. December 7-12, 2015, Montreal, Quebec, Canada.</mixed-citation>
    </ref>
    <ref id="btz352-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sudmant</surname><given-names>P.H.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Meta-analysis of RNA-seq expression data across species, tissues and studies</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>287.</fpage><pub-id pub-id-type="pmid">26694591</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B39">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Sundararajan</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>). Axiomatic attribution for deep networks. In: <italic>Proceedings of the 34th International Conference on Machine Learning</italic>, Vol. 70, pp. <fpage>3319</fpage>–<lpage>3328</lpage>.</mixed-citation>
    </ref>
    <ref id="btz352-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Thurman</surname><given-names>R.E.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>The accessible chromatin landscape of the human genome</article-title>. <source>Nature</source>, <volume>489</volume>, <fpage>75.</fpage><pub-id pub-id-type="pmid">22955617</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Voss</surname><given-names>T.C.</given-names></name>, <name name-style="western"><surname>Hager</surname><given-names>G.L.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Dynamic regulation of transcriptional states by chromatin and transcription factors</article-title>. <source>Nat. Rev. Genet</source>., <volume>15</volume>, <fpage>69.</fpage><pub-id pub-id-type="pmid">24342920</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wnuk</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>). 
<article-title>Predicting DNA accessibility in the pan-cancer tumor genome using RNA-seq, WGS, and deep learning</article-title>. <source>bioRxiv</source>, p. <fpage>229385</fpage>.</mixed-citation>
    </ref>
    <ref id="btz352-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zeng</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>). 
<article-title>Convolutional neural network architectures for predicting DNA-protein binding</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>i121</fpage>–<lpage>i127</lpage>.<pub-id pub-id-type="pmid">27307608</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhou</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Troyanskaya</surname><given-names>O.G.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Predicting effects of noncoding variants with deep learning-based sequence model</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>931.</fpage><pub-id pub-id-type="pmid">26301843</pub-id></mixed-citation>
    </ref>
    <ref id="btz352-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhou</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Genome-wide prediction of dnase I hypersensitivity using gene expression</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>1038</fpage>.<pub-id pub-id-type="pmid">29051481</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
