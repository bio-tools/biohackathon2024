<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7355300</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa433</article-id>
    <article-id pub-id-type="publisher-id">btaa433</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Macromolecular Sequence, Structure, and Function</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Cancer mutational signatures representation by large-scale context embedding</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Yang</given-names>
        </name>
        <xref ref-type="aff" rid="btaa433-aff1">b1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xiao</surname>
          <given-names>Yunxuan</given-names>
        </name>
        <xref ref-type="aff" rid="btaa433-aff1">b1</xref>
        <xref ref-type="aff" rid="btaa433-aff2">b2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Muyu</given-names>
        </name>
        <xref ref-type="aff" rid="btaa433-aff1">b1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <xref ref-type="aff" rid="btaa433-aff1">b1</xref>
        <xref ref-type="corresp" rid="btaa433-cor1"/>
        <!--<email>jianma@cs.cmu.edu</email>-->
      </contrib>
    </contrib-group>
    <aff id="btaa433-aff1"><label>b1</label><institution>Computational Biology Department, School of Computer Science, Carnegie Mellon University</institution>, Pittsburgh, PA 15213, <country country="US">USA</country></aff>
    <aff id="btaa433-aff2"><label>b2</label><institution>Department of Computer Science and Technology, Shanghai Jiao Tong University</institution>, Shanghai 200240, <country country="CN">China</country></aff>
    <author-notes>
      <corresp id="btaa433-cor1">To whom correspondence should be addressed. E-mail: <email>jianma@cs.cmu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-07-13">
      <day>13</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>Suppl 1</issue>
    <issue-title>ISMB 2020 Proceedings</issue-title>
    <fpage>i309</fpage>
    <lpage>i316</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa433.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The accumulation of somatic mutations plays critical roles in cancer development and progression. However, the global patterns of somatic mutations, especially non-coding mutations, and their roles in defining molecular subtypes of cancer have not been well characterized due to the computational challenges in analysing the complex mutational patterns.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we develop a new algorithm, called MutSpace, to effectively extract patient-specific mutational features using an embedding framework for larger sequence context. Our method is motivated by the observation that the mutation rate at megabase scale and the local mutational patterns jointly contribute to distinguishing cancer subtypes, both of which can be simultaneously captured by MutSpace. Simulation evaluations show that MutSpace can effectively characterize mutational features from known patient subgroups and achieve superior performance compared with previous methods. As a proof-of-principle, we apply MutSpace to 560 breast cancer patient samples and demonstrate that our method achieves high accuracy in subtype identification. In addition, the learned embeddings from MutSpace reflect intrinsic patterns of breast cancer subtypes and other features of genome structure and function. MutSpace is a promising new framework to better understand cancer heterogeneity based on somatic mutations.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Source code of MutSpace can be accessed at: <ext-link ext-link-type="uri" xlink:href="https://github.com/ma-compbio/MutSpace">https://github.com/ma-compbio/MutSpace</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Mark Foundation for Cancer Research</institution>
            <institution-id institution-id-type="DOI">10.13039/100014599</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id># 19-043-ASP</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Tencent AI Lab</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Cancer is a genetic disease with high degree of heterogeneity in different tissues and cell types (<xref rid="btaa433-B10" ref-type="bibr">Hanahan and Weinberg, 2011</xref>). Even for cancers with the same tissue-of-origin, cancer subtypes have been revealed with distinct histology, molecular phenotypes and responses to therapies, which provide the foundations for more targeted therapies (<xref rid="btaa433-B27" ref-type="bibr">Perou <italic>et al.</italic>, 2000</xref>; <xref rid="btaa433-B36" ref-type="bibr">Vogelstein <italic>et al.</italic>, 2013</xref>). For example, breast cancers can be typically classified into four primary subtypes, i.e. Luminal A (LumA), Luminal B (LumB), Basal and HER2, with different treatments (<xref rid="btaa433-B27" ref-type="bibr">Perou <italic>et al.</italic>, 2000</xref>). Conventionally, cancer subtype identification is achieved by integrating features derived from gene expressions and histopathology. With the advent of high-throughput sequencing, the list of molecular features for cancer subtype classification has been significantly extended (<xref rid="btaa433-B12" ref-type="bibr">Hoadley <italic>et al.</italic>, 2014</xref>). In particular, somatic mutations on protein-coding genes (i.e. coding mutations) emerge as a promising orthogonal feature for uncovering cancer subtypes (<xref rid="btaa433-B4" ref-type="bibr">Arslanturk and Draghici, 2018</xref>; <xref rid="btaa433-B18" ref-type="bibr">Kuijjer <italic>et al.</italic>, 2018</xref>). However, the feasibility of using non-coding mutations for cancer subtype identification is underexplored. Somatic mutations arise from the accumulation of DNA damage and the disruption of the DNA damage repair machinery (<xref rid="btaa433-B13" ref-type="bibr">Jeggo <italic>et al.</italic>, 2016</xref>). Importantly, the magnitude and patterns of somatic mutations are strongly affected by exposures to exogenous and endogenous mutagens, which also serve important features to classify patients (<xref rid="btaa433-B2" ref-type="bibr">Alexandrov <italic>et al.</italic>, 2013</xref>; <xref rid="btaa433-B20" ref-type="bibr">Martincorena and Campbell, 2015</xref>). Previous works have shown that the tissue-of-origin of cancer can be accurately identified using the frequency of non-coding mutations (<xref rid="btaa433-B14" ref-type="bibr">Jiao <italic>et al.</italic>, 2020</xref>; <xref rid="btaa433-B34" ref-type="bibr">Temiz <italic>et al.</italic>, 2015</xref>). However, using non-coding somatic mutations for subtype identification remains challenging due to the sparsity of mutation occurrence in the genome, the complexity of mutation patterns and the difficulty to prioritize the mutations (<xref rid="btaa433-B8" ref-type="bibr">Fu <italic>et al.</italic>, 2014</xref>; <xref rid="btaa433-B37" ref-type="bibr">Watson <italic>et al.</italic>, 2013</xref>).</p>
    <p>Several types of methods have been developed to extract somatic mutation features for non-coding mutations in the past. The first approach relies on the regional mutation density (RMD) at the megabase scale. Regional variation of mutation rate is associated with the epigenetic states of the tumour’s cell-of-origin. For example, 74–86% of the variance of the mutation rate can be explained by combinatorial patterns of histone modifications (<xref rid="btaa433-B28" ref-type="bibr">Polak <italic>et al.</italic>, 2015</xref>). However, as cancer subtypes are derived from cells with similar tissue-of-origin, whether the regional variation of mutation rate alone can provide accurate cancer subtype identification is unclear. The second approach is based on the mutational spectrum of 96 trinucleotides (immediate 5′ and 3′ bases of each mutated base, named MS96) in each patient or the decomposed mutational signatures using non-negative matrix factorization (NMF) (<xref rid="btaa433-B2" ref-type="bibr">Alexandrov <italic>et al.</italic>, 2013</xref>). MS96 or its variant mutational signatures are thought to reflect multiple mutational processes caused by the exogenous mutagens such as UV radiation (<xref rid="btaa433-B6" ref-type="bibr">Brash, 2015</xref>) and smoking (<xref rid="btaa433-B3" ref-type="bibr">Alexandrov <italic>et al.</italic>, 2016</xref>), or endogenous mutagens such as defective DNA repair activity (<xref rid="btaa433-B2" ref-type="bibr">Alexandrov <italic>et al.</italic>, 2013</xref>). However, it remains elusive whether such ±1 bp mutation context (i.e. trinucleotides) is sufficient to capture the mutational signatures. Indeed, <xref rid="btaa433-B33" ref-type="bibr">Stobbe <italic>et al.</italic> (2019)</xref> recently used features from recurrent non-coding mutations to cluster cancer patients and revealed a large-scale sequence context on several cancer types, including those samples caused by UV radiation, gastric-acid exposure and deregulated activity of POLE. Unfortunately, current approaches extracting all possible combinations of sequence context are computationally intractable when the mutation sequence context gets longer because the number of possible parameters increases exponentially, causing the <italic>curse of dimensionality</italic> and making the estimation of mutational spectrum unstable. Moreover, other covariates, such as age and sex of patients, and local genomic properties (e.g. mutations in cancer driver genes), may also influence mutation rate and patterns, but have been mostly ignored by current mutational feature representation methods. Therefore, algorithms that can extract mutational features with large-scale sequence context in each patient while also considering different covariates are needed.</p>
    <p>Here, we perform a series of computational analysis to approach these questions. In particular, we develop a new machine learning algorithm to effectively extract patient-specific mutational features using an embedding framework for distributed entities in the field of natural language processing (NLP) (see Section 2.2 for an overview and Section 3.2 for details of the algorithm). Our main contribution is threefold: (i) We identify important mutational features that can help distinguish different cancer subtypes. Using melanoma and breast cancer data as examples, we demonstrate that RMD and large-scale nucleotide context beyond trinucleotides are both informative features (see Section 2.1), which serves as the motivation for us to develop a new method for larger-context embedding. (ii) We develop MutSpace, a new method that can effectively capture various types of mutational features by incorporating both large-scale sequence context and genomic location of mutations (see Sections 2.2–2.4). (iii) We evaluate our method using both simulated data and breast cancer patient samples, as a proof-of-principle, to demonstrate that MutSpace can extract mutational features more effectively compared with conventional methods in terms of cancer subtype classification. Overall, our method represents a significant advancement in capturing mutational features, especially for non-coding somatic mutations. The new method distinguishes itself from previous methods by incorporating various features of mutations and patients, which are key to better stratifying distinct cancer subtypes for more targeted potential treatment strategies.</p>
  </sec>
  <sec>
    <title>2 Results</title>
    <sec>
      <title>2.1 Non-coding somatic mutations show regional variations across cancer subtypes</title>
      <p>We started by calculating the RMD (i.e. the number of mutations per million base pairs per patient) to explore its connection with different cancer types and their subtypes. Note that here we only consider non-coding mutations to mitigate bias from coding mutations affected by selective pressure during tumour progression (see Section 3.1). Previous studies have shown associations between variations of mutations in megabase scale and functional genomic data derived from tumour cell-of-origin, including replication timing and chromatin accessibility (<xref rid="btaa433-B9" ref-type="bibr">Gonzalez-Perez <italic>et al.</italic>, 2019</xref>; <xref rid="btaa433-B30" ref-type="bibr">Schuster-Böckler and Lehner, 2012</xref>; <xref rid="btaa433-B32" ref-type="bibr">Stamatoyannopoulos <italic>et al.</italic>, 2009</xref>). As shown in <xref ref-type="fig" rid="btaa433-F1">Figure 1</xref>, we found that genome-wide RMD profiles not only exhibit distinct patterns between melanoma and breast cancer but also show different variations within their subtypes. For example, cutaneous melanoma, the most severe subtype of melanoma, has a much higher mutation rate than other subtypes of melanoma (<xref ref-type="fig" rid="btaa433-F1">Fig. 1A</xref>). This pattern may be caused by the elevated C<inline-formula id="IE36"><mml:math id="IM1"><mml:mo>→</mml:mo></mml:math></inline-formula>T mutations at dipyrimidines induced by the UV radiation in cutaneous melanoma [<xref ref-type="fig" rid="btaa433-F1">Fig. 1B;</xref> also revealed in prior studies (<xref rid="btaa433-B1" ref-type="bibr">Akbani <italic>et al.</italic>, 2015</xref>; <xref rid="btaa433-B11" ref-type="bibr">Hayward <italic>et al.</italic>, 2017</xref>)]. However, despite the difference in the absolute values of mutation rate, we observed that different melanoma subtypes show a consistent trend between mutational variation (<xref ref-type="fig" rid="btaa433-F1">Fig. 1A</xref>) and chromatin structures. In particular, heterochromatic regions marked as B compartment based on Hi-C data tend to have a higher mutation rate than more active regions in A compartment. Also, RMD profiles in breast cancer subtypes are quite different from melanoma. For example, Basal and Her2 subtypes have a higher mutation rate than LumA and LumB subtypes, consistent with previous reports based on different patient cohorts (<xref rid="btaa433-B23" ref-type="bibr">Network <italic>et al.</italic>, 2012</xref>). Except for a few regions, different subtypes of breast cancer have fewer coherence patterns in terms of the correlation between mutation rate and chromatin structure, though the compositions of six mutation types are similar across different subtypes (<xref ref-type="fig" rid="btaa433-F1">Fig. 1D and E</xref>). Overall, these results suggest connections between cancer subtypes and mutation rate at the megabase scale.
</p>
      <fig id="btaa433-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>Mutational patterns vary across cancers and their subtypes. (<bold>A</bold>) An example of RMD profile on Chromosome 10 for different subtypes in melanoma. <italic>Y</italic>-axis represents log10 of number of mutations per Mb per patient. (<bold>B</bold>) The fraction of six mutation types in different subtypes in melanoma. Mutations are separated into two groups based on Hi-C A/B compartments. (<bold>C</bold>) The sequence logos show the sequence context of ±5 bp around the mutated bases. <italic>Y</italic>-axis indicates the relative entropy representing the enrichment of nucleotides compared with genome-wide background. Each motif logo is calculated using mutations from different cancer subtypes and the location of mutations (see Section 3.1). (<bold>D–F</bold>) Similar plots as (A–C) using data from breast cancer</p>
        </caption>
        <graphic xlink:href="btaa433f1"/>
      </fig>
      <p>We next explored the sequence context of mutations in different cancers and their subtypes. The trinucleotides context (i.e. the immediate nucleotides flanking the mutated base) around mutations are widely used for learning mutational signatures and characterizing different patient cohort (<xref rid="btaa433-B2" ref-type="bibr">Alexandrov <italic>et al.</italic>, 2013</xref>). Recently, the analysis of recurrent mutations revealed that local sequence contexts beyond trinucleotides are hallmarks of recurrent mutations in certain cancer types, which may be related to context-specific mutagenesis (<xref rid="btaa433-B33" ref-type="bibr">Stobbe <italic>et al.</italic>, 2019</xref>). We therefore sought to ask whether there exist subtype-specific sequence patterns between cancer subtypes. In <xref ref-type="fig" rid="btaa433-F1">Figure 1C and F</xref>, we plotted the relative enrichment of DNA sequence up to ±5 bp around the mutated base for subtypes in melanoma and breast cancer. We found that there is a strong enrichment of TTT[C<inline-formula id="IE37"><mml:math id="IM2"><mml:mo>→</mml:mo></mml:math></inline-formula>]CTT mutational pattern for C<inline-formula id="IE38"><mml:math id="IM3"><mml:mo>→</mml:mo></mml:math></inline-formula>T mutation in cutaneous melanoma, which cannot be observed in mucosal melanoma. Similarly, C<inline-formula id="IE39"><mml:math id="IM4"><mml:mo>→</mml:mo></mml:math></inline-formula>T mutations in LumB breast cancer tend to have a GGCCT sequence in the 5′ of the mutated C, which cannot be observed in the Basal subtype. We also observed that the sequence context of mutation has associations with the locations of mutations. Specifically, in cutaneous melanoma, there is a slight enrichment of C in the +1 bp of the 5′ for C<inline-formula id="IE40"><mml:math id="IM5"><mml:mo>→</mml:mo></mml:math></inline-formula>T mutations in A compartment (<xref ref-type="fig" rid="btaa433-F1">Fig. 1C</xref>). In addition, in LumB, there is an enrichment of C/G at the ±4th and 5th nucleotides from the mutated base for mutations in A compartment compared with mutations in B compartment (<xref ref-type="fig" rid="btaa433-F1">Fig. 1F</xref>). Altogether, these observations suggest that the extended context beyond trinucleotides is an informative feature related to molecular subtypes of cancer that may provide important predictive power in addition to RMD.</p>
    </sec>
    <sec>
      <title>2.2 Overview of MutSpace—learning mutation patterns by embedding larger context</title>
      <p>Motivated by the observations from the previous section, we developed a novel machine learning approach, named MutSpace, to effectively extract mutational features from larger context based on neural embedding algorithms (<xref rid="btaa433-B5" ref-type="bibr">Bengio <italic>et al.</italic>, 2003</xref>), which can then be used for downstream analysis such as cancer subtype identification (see Sections 2.3 and 2.4). As illustrated in <xref ref-type="fig" rid="btaa433-F2">Figure 2A</xref>, the input of MutSpace contains two types of data: somatic mutations and cancer patients, which are naturally related by the fact that a somatic mutation is observed in one patient. The output of MutSpace is a set of vectors in high-dimensional space for cancer patients and mutational patterns, which is derived by maximizing the dot-product similarities between the embeddings of related mutation–patient pairs while minimizing similarities between those incompatible pairs. Therefore, the similarities between vectors of patients in the embedding space reflect the closeness of patients’ mutational patterns, as shown in <xref ref-type="fig" rid="btaa433-F2">Figure 2B</xref>. The algorithm details of MutSpace are discussed in Section 3.2.
</p>
      <fig id="btaa433-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Overview of the MutSpace framework. (<bold>A</bold>) Cancer patients, somatic mutations and their local sequence context are represented as bags-of-features (see example in Section 3.2). (<bold>B</bold>) Examples of mutations and their decomposed features are shown in green. Features associated with patients such as patients’ ID and cancer type are shown in purple. (<bold>C</bold>) MutSpace jointly learns embeddings of mutations, patients and their features in the same high-dimensional space. Patients with similar mutational patterns are expected to be close to each other in the latent space</p>
        </caption>
        <graphic xlink:href="btaa433f2"/>
      </fig>
      <p>Without loss of generality, although the input data of MutSpace are in different formats, we consider both of them as abstract entities consisting of a set of discrete features (bag-of-features) (<xref ref-type="fig" rid="btaa433-F2">Fig. 2B</xref>). For example, features of mutations contain the mutation type (one of the six substitution patterns, see Section 3.1), the genomic location by assigning mutations into genomic bins with fixed size (e.g. 1 Mb), and a series of discrete features for each mutation type representing the flanking nucleotides with variable distances from the mutated base (see examples in Section 3.2 and <xref ref-type="fig" rid="btaa433-F2">Fig. 2B</xref>). Decomposing sequence context into separate discrete features is preferred to reduce the space complexity of the algorithm especially when we model the large-scale sequence context of mutations (<xref rid="btaa433-B31" ref-type="bibr">Shiraishi <italic>et al.</italic>, 2015</xref>). For patients, relevant discrete features include the cancer type of patients, unique patients’ ID, and possibly other covariates of patients, such as sex and age of diagnosis. The key concept of MutSpace is to integrate these heterogeneous entities through a unified embedding framework adapted from StarSpace (<xref rid="btaa433-B38" ref-type="bibr">Wu <italic>et al.</italic>, 2018</xref>), a recent embedding framework developed for NLP. In particular, MutSpace embeds mutations, patients and their features into a common high-dimensional space such that the comparisons between them can be achieved by calculating the similarity of between two vectors. MutSpace then learns embeddings of mutations and patients such that mutation patterns observed in the same patient stay close to each other but away from mutations belonging to other patients (<xref ref-type="fig" rid="btaa433-F2">Fig. 2C</xref>, Section 3.2). Consequently, patients containing similar mutational information tend to be embedded close in the high-dimensional space, whereas more distinct patients are further away. The model is trained to maximize the similarities between true pairs of mutations and patients while minimizing the similarities between randomly sampled noisy pairs (see Section 3.2). Finally, patients’ embedded vectors can be used as patient-specific features extracted from mutations for the downstream subtype classification.</p>
      <p>MutSpace provides a generic framework to more effectively incorporate mutational features including large-scale sequence context around mutations and other covariates for stratifying cancer patients.</p>
    </sec>
    <sec>
      <title>2.3 Simulation demonstrates the accuracy of MutSpace in identifying cancer subtypes</title>
      <p>To assess whether the mutational features obtained by MutSpace can accurately identify cancer subtypes, we evaluated MutSpace using synthetic datasets in two types of simulation studies. We assessed the performance based on <italic>F</italic><sub>1</sub> score, AUROC and AUPRC by comparing the predicted labels of subtypes with the ground truth labels (see Section 3.5). In simulation study I (SS-I), mutational patterns of each subtype were generated from different mixtures of synthetic mutational signatures up to ±4 bp, whereas in simulation study II (SS-II), we further allowed the distribution of mutational density on the genome to vary across subtypes. Both simulation studies contain three to six subtypes and 100 patients in each subtype, respectively (see details in Section 3.4).</p>
      <p>We compared MutSpace with other methods that extract patient-specific mutational features, including the frequency of the occurrence for each mutational pattern with different lengths of sequence context (Mut-Freq), NMF decomposition of Mut-Freq and regional mutational density (RMD) at megabase resolution (see descriptions of these methods in Section 3.3). Among different types of classifiers, we found that the SVM had the best performance and was therefore chosen as the classifier for further analysis. The average performance is reported based on fivefold nested cross validation with hyperparameters selected using the grid-search strategy (see Section 3.5). Performances are calculated for mutational patterns with different lengths of context to provide a comprehensive evaluation. We found that MutSpace is able to make accurate predictions with different lengths of sequence context in both simulated studies (<xref ref-type="fig" rid="btaa433-F3">Fig. 3A</xref>). In particular, MutSpace shows significant advantages in reaching a higher <italic>F</italic><sub>1</sub> score than other methods as a longer sequence context is considered (<xref ref-type="fig" rid="btaa433-F3">Fig. 3A</xref>). In SS-II, we further added the genomic location of mutations (after discretization into the ID of 1 Mb genomic bin in the human genome) as features of mutations in MutSpace to capture the variation of mutational density in different subtypes. As the difference of mutational density cannot be captured by methods that only examine at the frequency of mutational pattern per patient, Mut-Freq and NMF consistently show poor performance with different lengths of sequence context (<xref ref-type="fig" rid="btaa433-F3">Fig. 3B</xref>). We therefore concatenated features extracted by RMD and Mut-Freq with ±1 bp (MS96) and used those combined features (RMD+MS96) for predictions. However, MutSpace still outperforms the combined method when ±2 bp sequence context is considered (average <italic>F</italic><sub>1</sub> score 0.809 for RMD+MS96 versus 0.856 for MutSpace). Importantly, in MutSpace, only the ID of the genomic bins instead of the count of mutations per bin is used as part of the input. Together, these simulation evaluations strongly suggest that MutSpace can effectively extract features by jointly modelling mutational patterns and patients. Our method even outperforms approaches that integrate both regional mutational density and frequencies of mutation patterns.
</p>
      <fig id="btaa433-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Evaluation using simulated datasets. (<bold>A</bold>) Evaluation of MutSpace, Mut-Freq and NMF on simulated data SS-I in terms of <italic>F</italic><sub>1</sub> score, AUROC and AUPRC. (<bold>B</bold>) Evaluation of MutSpace, Mut-Freq, NMF and RMD on simulated data SS-II in terms of <italic>F</italic><sub>1</sub> score, AUROC and AUPRC</p>
        </caption>
        <graphic xlink:href="btaa433f3"/>
      </fig>
    </sec>
    <sec>
      <title>2.4 The embeddings from MutSpace can accurately classify breast cancer subtypes</title>
      <p>To further assess the performance of MutSpace for delineating patient-specific mutational features, we applied MutSpace to reveal the heterogeneity of breast cancer subtypes from mutational patterns. We first evaluated MutSpace on its ability to classify subtypes of breast cancer. Similar to evaluations for the simulated datasets, we trained an SVM model based on the mutational features from MutSpace and compared its performance with other methods. <xref ref-type="fig" rid="btaa433-F4">Figure 4A</xref> shows the best prediction results using these methods when different lengths of sequence context are considered. We found that MutSpace can accurately identify three primary subtypes in breast cancer. In particular, in the basal subtype, the average <italic>F</italic><sub>1</sub> score achieved by MutSpace is 0.922, which is higher than the method using features by the concatenation of RMD and MS96 (0.896). In LumA and LumB, MutSpace outperforms other methods with a higher <italic>F</italic><sub>1</sub> score, AUROC and AUPRC. Notably, we observed that MutSpace achieves its highest performance for encoding ±5 bp sequence context, consistent with our observations that breast cancer subtypes have distinct patterns in the large-scale sequence context around mutations.
</p>
      <fig id="btaa433-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>(<bold>A</bold>) Evaluation of MutSpace, Mut-Freq, NMF and RMD for identifying breast cancer subtypes. (<bold>B</bold>) Visualization of patients’ embeddings using t-SNE with colours indicating subtypes. (<bold>C</bold>) Unsupervised clustering of embedded vectors of patients using HDBSCAN identifies four subgroups of breast cancer. (<bold>D</bold>) Barplot shows the number of patients in each cluster with colours indicating subtypes. (<bold>E</bold>) The distribution of HDR score in each <italic>de novo</italic> identified cluster. (<bold>F</bold>) Curves show the trend of <italic>F</italic><sub>1</sub> scores for predicting A/B compartments (upper panel) and replication timing signals (bottom panel) as different epochs of embedded vectors for genomic bins are used as input</p>
        </caption>
        <graphic xlink:href="btaa433f4"/>
      </fig>
      <p>To better demonstrate the ability of MutSpace in representing patients with similar mutational patterns, we projected patients’ embedding from MutSpace into two-dimensional space with t-SNE (<xref rid="btaa433-B35" ref-type="bibr">van der Maaten and Hinton, 2008</xref>) (<xref ref-type="fig" rid="btaa433-F4">Fig. 4B</xref>). Here each data point represents a patient with colours showing subtype information. We found that patients belonging to the same subtype are clearly clustered together. We also noticed that some patients from three subtypes tend to form a unique cluster in the t-SNE. We therefore applied HDBSCAN (<xref rid="btaa433-B21" ref-type="bibr">McInnes <italic>et al.</italic>, 2017</xref>), an unsupervised clustering method to separate patients into four groups based on mutational patterns alone (<xref ref-type="fig" rid="btaa433-F4">Fig. 4C and D</xref>). Using the homologous recombination deficiency (HRD) score as an orthogonal clinical feature, we found that these four groups have distinct distributions of HRD score. Further analysis could be performed to assess whether those four groups of patients have different clinical outcomes.</p>
      <p>Besides patients’ and mutations’ embeddings, we also sought to demonstrate the utility of other jointly learned feature embeddings, such as the embeddings of genomic bins. Specifically, we asked if the embedding of a genomic bin reflects useful features related to the organization and function of the corresponding genomic location. We tested this hypothesis by extracting the embeddings of genomic bins on each epoch during the MutSpace training process and using them as input to predict corresponding orthogonal features of genome structure and function. <xref ref-type="fig" rid="btaa433-F4">Figure 4F</xref> shows the <italic>F</italic><sub>1</sub> score of the prediction on Hi-C A/B compartment annotations and quartile of replication timing signals, respectively. Notably, we found that as the training proceeds, embeddings of genomic bins become more correlated with A/B compartmentalization and replication timing, suggesting that MutSpace can successfully learn the underlying information of genomic location (covariate of mutations) and predict related genome structure and function.</p>
      <p>Taken together, these results highlight the advantage of MutSpace in representing mutation patterns.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Materials and methods</title>
    <sec>
      <title>3.1 Data collection</title>
      <p>We collected tumour somatic mutations derived from whole-genome sequencing (WGS) across multiple resources (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). We only used single-nucleotide substitutions in autosomes and combined substitutions that are reverse-complement to each other (e.g. G<inline-formula id="IE1"><mml:math id="IM6"><mml:mo>→</mml:mo></mml:math></inline-formula>T is treated the same as C<inline-formula id="IE2"><mml:math id="IM7"><mml:mo>→</mml:mo></mml:math></inline-formula>A) into six mutation types: C<inline-formula id="IE3"><mml:math id="IM8"><mml:mo>→</mml:mo></mml:math></inline-formula>A, C<inline-formula id="IE4"><mml:math id="IM9"><mml:mo>→</mml:mo></mml:math></inline-formula>G, C<inline-formula id="IE5"><mml:math id="IM10"><mml:mo>→</mml:mo></mml:math></inline-formula>T, T<inline-formula id="IE6"><mml:math id="IM11"><mml:mo>→</mml:mo></mml:math></inline-formula>A, T<inline-formula id="IE7"><mml:math id="IM12"><mml:mo>→</mml:mo></mml:math></inline-formula>C and T<inline-formula id="IE8"><mml:math id="IM13"><mml:mo>→</mml:mo></mml:math></inline-formula>G. We discarded mutations located in the protein-coding regions according to the human GENCODE annotation release 19 as sequence context of those somatic coding mutations are likely under stronger selection pressure and may show distinct sequence preference compared with non-coding mutations. We further removed mutations that are located in the human blacklisted regions defined by the ENCODE project (accession: ENCSR636HFF) or overlapped with known common SNP track (snp151Common) downloaded from the UCSC Genome Browser. Flanking nucleotides around mutations (reverse complement the DNA sequence if necessary, see above for the definition of six mutation types) were extracted from the human reference assembly hg19 downloaded from the UCSC Genome Browser. Clinical information including molecular subtypes of cancer patients was retrieved from various previous literatures investigating each cancer sequencing dataset. <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref> shows the number of patients in each subtype from different cancer datasets. We collected functional genomics data from public resources. The source of data is shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>. Sequence logos of mutational pattern around mutations were generated by adapting scripts provided by <xref rid="btaa433-B33" ref-type="bibr">Stobbe <italic>et al.</italic> (2019)</xref> on GitHub.</p>
    </sec>
    <sec>
      <title>3.2 MutSpace—joint modelling of mutational patterns and patients</title>
      <p>In MutSpace, we jointly learn an embedding for mutational patterns (i.e. one of the six mutation types and its flanking nucleotides) observed in cancer cohort and cancer patients into a continuous vector space <inline-formula id="IE9"><mml:math id="IM14"><mml:mrow><mml:msup><mml:mo>ℝ</mml:mo><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. In <inline-formula id="IE10"><mml:math id="IM15"><mml:mrow><mml:msup><mml:mo>ℝ</mml:mo><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, mutational patterns and patients are both entities represented as <italic>d</italic> dimensional continuous vectors (i.e. embedding vectors) induced in a bag-of-features manner. This bag-of-features embedding framework is developed based on a recent semantic embedding model, StarSpace (<xref rid="btaa433-B38" ref-type="bibr">Wu <italic>et al.</italic>, 2018</xref>), which has been proven to be a general-purpose method for various tasks in the field of NLP and also the prediction of transcription factor binding in genomics (<xref rid="btaa433-B39" ref-type="bibr">Yuan <italic>et al.</italic>, 2019</xref>). In StarSpace, heterogeneous entities are embedded in the same semantic space, and each entity is described by a set of discrete features (i.e. bag-of-features). For example, in NLP a document entity can be described by a set of words, and a reader can be described by a set of documents the reader likes.</p>
      <p>The bag-of-features representation provides flexibility to the choice of entities’ features and makes it possible to incorporate heterogeneous covariates. In our cases, the embedded vector of the <italic>i</italic>th patient is represented by embedded vectors of this patient’s features (<inline-formula id="IE11"><mml:math id="IM16"><mml:mrow><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, …, <inline-formula id="IE12"><mml:math id="IM17"><mml:mrow><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>), where <italic>m<sub>i</sub></italic> is the number of discrete features of the patient. For example, features associated with patients include cancer type, patient’s IDs, etc. The embedding of the <italic>i</italic>th patient is thus induced by the summation of embeddings of all features from this patient.
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>Here <italic>p</italic> is a hyperparameter and we keep it the same as the default value (0.5) used in StarSpace.</p>
      <p>Similarly, the embedding of a mutation with a large-scale local context is represented by the summation of embedded vectors of its sub-components and other features associated with this mutation. Here, we define a set of sub-components of a mutational pattern as a series of non-overlapping flanking nucleotides of length <italic>w</italic> with different distances from the central mutated base. The maximum distance of the flanking nucleotides from the central mutated base determines the size of sequence context we consider (represented by <italic>l</italic>). For instance, AACC[C→A]TTCG is one example of an observed ±4 bp mutational pattern. When <italic>w</italic> equals to 1, we split this mutational pattern into four sub-components: ANNN[C→A]NNNG, NANN[C→A]NNCN, NNCN[C→A]NTNN and NNNC[C→ A]TNNN (here N indicates any nucleotide from A, C, G and T). This representation of mutation patterns by sub-components can significantly reduce the number of features associated with a mutation, allowing a long flanking sequence of the mutation to be included in the model. Considering a mutational pattern of length <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:mn>2</mml:mn><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, where <italic>l</italic> is the length of sequence on either up- or down-stream of the mutated base, the number of sequence patterns given the sub-components with length <italic>w</italic> is <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msup><mml:mn>4</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>w</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> because the number of sub-component is <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo stretchy="false">⌉</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and the number of the possible DNA sequence is <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:msup><mml:mn>4</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>w</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> because the number of nucleotides in each sub-component is 2<italic>w</italic> (considering both up- and down-stream nucleotides). Therefore, the total number of sub-components associated with six types of substitutions is <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:mn>6</mml:mn><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">⌈</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo stretchy="false">⌉</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msup><mml:mn>4</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>w</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, with a spatial complexity significantly lower than the entire combination of the flanking sequence (<inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:mn>6</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>4</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>l</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). Based on our observations on real mutation data, when <italic>l</italic> is greater than 6, the nucleotide compositions are very similar to the genome-wide average. Therefore, we only considered <italic>l</italic> smaller than 6 bp in both simulation and real data application. We can also encode other covariates of mutations as discrete features. In particular, the genomic location of the mutation is encoded by splitting the genome into fixed-sized bins and assigning mutations to these bins by the bins’ ID. Therefore, the final embedding of the <italic>i</italic>th mutation is induced by the summation of embeddings of all its associated sub-components and other discrete features (<inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, …, <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>), where <italic>n<sub>i</sub></italic> is the number of features associated with each mutation.
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msubsup></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>To learn the embedded vectors, we developed a similar approach used in the StarSpace by maximizing the similarities calculated from positive mutation–patient pairs while minimizing those from negative ones. Briefly, we define a positive pair of latent embedded vectors in mutation–patient relationship as <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which represents the <italic>j</italic>th mutation <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> observed in the <italic>i</italic>th patient <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Negative pairs of latent embedded vectors between mutations and patients <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo>−</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> are generated by negative sampling (<xref rid="btaa433-B22" ref-type="bibr">Mikolov <italic>et al.</italic>, 2013</xref>), through which the <italic>j</italic>th mutation observed in the <italic>i</italic>th patient is paired with those from the rest of the patients other than patient <italic>i</italic> and this process is repeated for <italic>K</italic> times. The model is then trained to maximize the similarities between positive pairs while minimizing those in negative pairs through optimizing the following hinge loss function:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mi>K</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo mathvariant="italic">μ</mml:mo><mml:mo>−</mml:mo><mml:mtext>sim</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mtext>sim</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>k</mml:mi><mml:mo>−</mml:mo></mml:msubsup><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:math></disp-formula>where <italic>μ</italic> is a constant margin parameter, which is 1.0 by default. Also, to measure the similarity between entities, we calculated the scaled dot-product similarity <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:mtext>sim</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> between mutation embeddings and patient embeddings as shown below:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:mtext>sim</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>a</mml:mi><mml:msup><mml:mi>b</mml:mi><mml:mi mathvariant="normal">⊤</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:msqrt><mml:mi>d</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mo>ℝ</mml:mo><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></disp-formula></p>
      <p>We also applied a constraint to embedded vectors to enforce an upper bound of the <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:msup><mml:mo>ℓ</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>-norm of embeddings. In each training epoch of MutSpace, patients’ embeddings and the embeddings of patients’ features, mutations’ embeddings and the embedding of mutations’ sub-components are all optimized based on the gradient of this loss using the Adam optimization algorithm (<xref rid="btaa433-B16" ref-type="bibr">Kingma and Ba, 2014</xref>). By minimizing the defined loss shown above, in the latent vector space, the mutational patterns will gather around their corresponding patients, while the patients with similar mutational patterns will also become closer to each other.</p>
      <p>After the training, the learned embedded vectors of entities can then be used for downstream tasks, such as classifying patients into subtypes. To retrieve mutational patterns that are closer to one patient, we can use the learned embedded vectors to measure the similarity between two entities (e.g. mutational patterns with patients, patients with other patients). We can select top <italic>q</italic> compatible mutational patterns for the <italic>i</italic>th patient by sorting <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:mtext>sim</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> over all possible mutational patterns <inline-formula id="IE33"><mml:math id="IM33"><mml:mi mathvariant="bold-italic">s</mml:mi></mml:math></inline-formula>. The MutSpace algorithm was implemented using PyTorch (<xref rid="btaa433-B24" ref-type="bibr">Paszke <italic>et al.</italic>, 2019</xref>).</p>
    </sec>
    <sec>
      <title>3.3 Mutational features extraction using other methods</title>
      <p>There are other methods that can also extract mutational features for each patient. Here we compared the performance of MutSpace with several other methods, including calculating the frequencies of occurrence for mutational patterns in each patient (Mut-Freq), decomposing the frequency matrix of mutational patterns using the NMF algorithm, and regional mutational density (RMD) (<xref rid="btaa433-B14" ref-type="bibr">Jiao <italic>et al.</italic>, 2020</xref>; <xref rid="btaa433-B29" ref-type="bibr">Salvadores <italic>et al.</italic>, 2019</xref>).</p>
      <p>We obtained the frequency of mutational patterns (Mut-Freq) by calculating the relative frequencies of them in each patient. Regarding mutational patterns, we considered different lengths of sequence context around the mutated base. As the length of the sequence context grows, the number of mutational patterns grows exponentially, which makes the training process of the classifier unstable. Therefore, we applied principal component analysis (PCA) on the mutation frequency matrix and kept the top 50 principal components as the mutational features for each patient. Evaluations on both simulated and real data showed that this strategy can improve the performance when a larger sequence context (&gt;±2 bp) is considered. We also applied the NMF algorithm to the raw frequency matrix of mutational patterns to reduce the number of mutational features. We used scikit-learn for the implementation of NMF (<xref rid="btaa433-B26" ref-type="bibr">Pedregosa <italic>et al.</italic>, 2011</xref>). We set the number of components decomposed by NMF also to be 50. We found that choosing different parameters will not noticeably affect the performance. We calculated RMD by counting the number of non-coding mutations in each 1 Mb window in the human genome. We further normalized it by dividing the count by the effective size of each bin after we removed those regions belonging to protein-coding genes or unmappable regions according to the annotation of Umap (<xref rid="btaa433-B15" ref-type="bibr">Karimzadeh <italic>et al.</italic>, 2018</xref>).</p>
    </sec>
    <sec>
      <title>3.4 Simulation of mutation dataset</title>
      <p>We used two types of settings for data simulation, corresponding to SS-I and SS-II. In SS-I, we assume that cancer subtypes are different from each other only by their mutational patterns rather than the distributions of mutation density on the genome. Specifically, we first built a series of synthetic mutational signatures such that each signature represents a set of 393 216 mutation patterns depicting all possible combinations of nucleotides within ±4 bp of the central mutated base. Here we only consider six types of single nucleotide mutations as mentioned above. Each mutational pattern is then associated with a frequency indicating the probability of observing such mutational pattern and the sum of all frequencies in each synthetic signature is 1. To make the synthetic signatures analogous to what we observed in the real data, we utilized the COSMIC mutational signatures (<ext-link ext-link-type="uri" xlink:href="https://cancer.sanger.ac.uk/cosmic/signatures_v2">https://cancer.sanger.ac.uk/cosmic/signatures_v2</ext-link>) as a reference to build the margin frequency of trinucleotides (immediate nucleotides flanking the mutated base) in synthetic signatures by mixing frequency of different COSMIC signatures. The frequency of flanking nucleotides with distance &gt;1 bp from the mutated base is derived by ignoring the central mutated base when mixing COSMIC trinucleotides signatures. Finally, the frequencies of mutational patterns in each subtype were constructed by a mixture model with weights as the contribution of those ±4 bp synthetic signatures. To generate synthetic data, we randomly sampled mutations according to the frequencies in each subtype. In each subtype, we simulated mutation data for 100 patients. The number of mutations in each patient (<italic>N</italic>) is determined by parameter <italic>θ</italic> (<inline-formula id="IE34"><mml:math id="IM34"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mo>θ</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>), where the value of <italic>θ</italic> is randomly sampled from a Gaussian distribution with a mean of 3 and a standard deviation of 0.3. In SS-II, we assume that cancer subtypes are also varied by their mutational density profile along the genome. For simplicity, we assume all the mutations are from one chromosome and their locations on the chromosome are sampled from a beta distribution with shape parameters <italic>α</italic> and <italic>β</italic> (we assume the start of chromosome is 0 and the end of chromosome is 1). We further discretized the locations of mutations by binning mutations into 100 bins. In SS-II, cancer subtypes are different from each other by either the weight of mixtures of the synthetic signatures or the underlying distribution of locations determined by the shape parameters.</p>
    </sec>
    <sec>
      <title>3.5 Classification of cancer subtypes using mutational features</title>
      <p>To demonstrate the power of the embedded vectors extracted by MutSpace on identifying cancer subtypes, we performed supervised classification using kernelized support-vector machine (SVM) (<xref rid="btaa433-B01947867" ref-type="bibr">Vapnik 2000</xref>). The kernelized SVM takes mutational features extracted from each patient as input and returns the predicted subtype assignment and probability. To apply SVM in multi-class setting, we applied one-versus-rest strategy. For each subtype, we treated patients with subtype A as positive and patients with other subtypes as negative, and build a single SVM classifier to learn whether a patient belongs to A subtype. We trained our model with nested cross validation using different representations of mutational features. The inner fivefold cross-validation conducts grid-search to select hyperparameters (e.g. kernel, regularization penalty, etc.) that leads to the highest <italic>F</italic><sub>1</sub> score, and the outer fivefold cross validation evaluates model performance on testing dataset by randomly splitting data into 80% training and 20% testing for five times. To account for the imbalanced number of instances in each subtype, we modulated the weight of class for a subtype to increase the penalty for mis-classifying minor classes by the inverse of their frequency.</p>
      <p>We evaluated the performance using <italic>F</italic><sub>1</sub> score, area under receiver operating characteristic curve (AUROC) and area under the precision-recall curve (AUPRC). <italic>F</italic><sub>1</sub> score is the harmonic mean of precision and recall for each binary classification task, i.e. <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mtext>precision</mml:mtext><mml:mo>×</mml:mo><mml:mtext>recall</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mtext>precision</mml:mtext><mml:mo>+</mml:mo><mml:mtext>recall</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. AUPRC measures how well the model is able to identify all positive instances without mistakenly labelling negative instances as positive. ROC curve is plotted as true positive rate versus false positive rate, and the area under this curve measures the ability to separate two classes. Since all of the metrics described above are only applicable to binary cases, we first calculated the scores for each subtype and then took the average weighted by the class frequency as the overall score. We report the mean and variance of these metrics calculated from our nested cross validation. Model training and evaluation were implemented using Python package scikit-learn version 0.22.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion and discussion</title>
    <p>Although the integration of somatic mutations for cancer subtype identification has received much attention recently, it remains unclear whether non-coding somatic mutations can offer unique characterizations of molecular subtypes of cancer. One of the advantages of using somatic mutations as input data is that the mutations provide a cumulative record of the evolutionary process caused by exogenous and endogenous mutagens (<xref rid="btaa433-B13" ref-type="bibr">Jeggo <italic>et al.</italic>, 2016</xref>). In this work, we developed MutSpace to specifically address the computational challenges to consider large-scale context for mutational signatures. MutSpace effectively extracts patient-specific features by jointly modelling mutations and patients in a latent high-dimensional space. We demonstrated the feasibility of using non-coding somatic mutations for cancer subtype identification by simultaneously considering mutational density and mutational patterns. Both simulations and proof-of-principle real data application confirmed that the mutational features captured by MutSpace are capable of stratifying cancer subtypes.</p>
    <p>There are several directions that we can further improve MutSpace. First, one of the promising future directions is to integrate non-coding somatic mutations with coding mutations, in particular, those residing in the known cancer driver genes. <xref rid="btaa433-B19" ref-type="bibr">Kumar <italic>et al.</italic> (2020)</xref> have recently discovered that the aggregated effect of non-coding mutations may play a more important role in tumorigenesis than coding mutations. In the framework of MutSpace, coding mutations can be treated as covariates of patients and thus modulate the final embeddings of patients. Future research is needed to evaluate whether this integrative approach can provide a better stratification for different types of cancers. Second, we have a limited ability to interpret mutational features extracted from MutSpace, which is a challenge for embedding-based methods. Projecting the mutational features to lower dimensions by approaches such as t-SNE is a possible way of exploring the enrichment of external annotations on embedded space and has been widely used in other areas of computational genomics such as single-cell transcriptomics. A hierarchical approach to further cluster patients based on their embeddings using localized diffusion folders (LDF) (<xref rid="btaa433-B7" ref-type="bibr">David <italic>et al.</italic>, 2010</xref>) may provide potential representations of patients’ relationship. Another possible alternative is to utilize synthetic mutation data with known aetiology. For example, a recent study (<xref rid="btaa433-B17" ref-type="bibr">Kucab <italic>et al.</italic>, 2019</xref>) generated mutation data by exposing cells to dozens of known environmental carcinogens. Integrating these types of data together with somatic mutation data from cancer patients in the same latent space may have the potential to interpret patient-specific mutation patterns based on mutations related to known carcinogens. Third, choosing the right covariates as features of mutations and patients requires prior knowledge. Future work is needed to more efficiently determine the best set of covariates as input features. Finally, with the development of single-cell-based technologies, somatic mutation data from longitudinal cancer studies are becoming available. It would be important to further extend the framework of MutSpace by specifically considering the temporal patterns of the mutational signatures in the latent space. This may provide key insights into the evolutionary forces that drive somatic mutation accumulation. Nevertheless, MutSpace provides a new framework that would allow us to further pursue these exciting questions.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btaa433_Supplementary_Data</label>
      <media xlink:href="btaa433_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank Ruochi Zhang for helpful discussions that improved the manuscript.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported in part by an ASPIRE Award from the Mark Foundation for Cancer Research (Grant # 19-043-ASP) (to J.M.) and a Rhino-Bird Gift Award from Tencent AI Lab (to J.M.).</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa433-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Akbani</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Genomic classification of cutaneous melanoma</article-title>. <source>Cell</source>, <volume>161</volume>, <fpage>1681</fpage>–<lpage>1696</lpage>.<pub-id pub-id-type="pmid">26091043</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alexandrov</surname><given-names>L.B.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Signatures of mutational processes in human cancer</article-title>. <source>Nature</source>, <volume>500</volume>, <fpage>415</fpage>–<lpage>421</lpage>.<pub-id pub-id-type="pmid">23945592</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alexandrov</surname><given-names>L.B.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Mutational signatures associated with tobacco smoking in human cancer</article-title>. <source>Science</source>, <volume>354</volume>, <fpage>618</fpage>–<lpage>622</lpage>.<pub-id pub-id-type="pmid">27811275</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B4">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Arslanturk</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Draghici</surname><given-names>S.</given-names></name></person-group> (<year>2018</year>) Disease subtyping using somatic variant data. In <italic>Proceedings of the 2018 ACM International Conference on Bioinformatics, Computational Biology, and Health Informatics</italic>, pp. <fpage>277</fpage>–<lpage>282</lpage>. ACM, New York, NY.</mixed-citation>
    </ref>
    <ref id="btaa433-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bengio</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2003</year>) 
<article-title>A neural probabilistic language model</article-title>. <source>J. Mach. Learn. Res</source>., <volume>3</volume>, <fpage>1137</fpage>–<lpage>1155</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa433-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brash</surname><given-names>D.E.</given-names></name></person-group> (<year>2015</year>) 
<article-title>UV signature mutations</article-title>. <source>Photochem. Photobiol</source>., <volume>91</volume>, <fpage>15</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">25354245</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>David</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) Hierarchical clustering via localized diffusion folders. In: <italic>2010 AAAI Fall Symposium Series</italic>. AAAI, Menlo Park, CA.</mixed-citation>
    </ref>
    <ref id="btaa433-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fu</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>FunSeq2: a framework for prioritizing noncoding regulatory variants in cancer</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>480</fpage>.<pub-id pub-id-type="pmid">25273974</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gonzalez-Perez</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Local determinants of the mutational landscape of the human genome</article-title>. <source>Cell</source>, <volume>177</volume>, <fpage>101</fpage>–<lpage>114</lpage>.<pub-id pub-id-type="pmid">30901533</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hanahan</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Weinberg</surname><given-names>R.A.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Hallmarks of cancer: the next generation</article-title>. <source>Cell</source>, <volume>144</volume>, <fpage>646</fpage>–<lpage>674</lpage>.<pub-id pub-id-type="pmid">21376230</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hayward</surname><given-names>N.K.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Whole-genome landscapes of major melanoma subtypes</article-title>. <source>Nature</source>, <volume>545</volume>, <fpage>175</fpage>–<lpage>180</lpage>.<pub-id pub-id-type="pmid">28467829</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hoadley</surname><given-names>K.A.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Multiplatform analysis of 12 cancer types reveals molecular classification within and across tissues of origin</article-title>. <source>Cell</source>, <volume>158</volume>, <fpage>929</fpage>–<lpage>944</lpage>.<pub-id pub-id-type="pmid">25109877</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jeggo</surname><given-names>P.A.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>DNA repair, genome stability and cancer: a historical perspective</article-title>. <source>Nat. Rev. Cancer</source>, <volume>16</volume>, <fpage>35</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">26667849</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jiao</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2020</year>) 
<article-title>A deep learning system accurately classifies primary and metastatic cancers using passenger mutation patterns</article-title>. <source>Nat. Commun</source>., <volume>11</volume>, <fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">31911652</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Karimzadeh</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Umap and Bismap: quantifying genome and methylome mappability</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>e120</fpage>.<pub-id pub-id-type="pmid">30169659</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B16">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Kingma</surname><given-names>D.P.</given-names></name>, <name name-style="western"><surname>Ba</surname><given-names>J.</given-names></name></person-group> (<year>2014</year>) Adam: a method for stochastic optimization. <italic>arXiv preprint arXiv:1412.6980.</italic></mixed-citation>
    </ref>
    <ref id="btaa433-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kucab</surname><given-names>J.E.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>A compendium of mutational signatures of environmental agents</article-title>. <source>Cell</source>, <volume>177</volume>, <fpage>821</fpage>–<lpage>836</lpage>.<pub-id pub-id-type="pmid">30982602</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kuijjer</surname><given-names>M.L.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Cancer subtype identification using somatic mutation data</article-title>. <source>Br. J. Cancer</source>, <volume>118</volume>, <fpage>1492</fpage>–<lpage>1501</lpage>.<pub-id pub-id-type="pmid">29765148</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kumar</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2020</year>) 
<article-title>Passenger mutations in more than 2,500 cancer genomes: overall molecular functional impact and consequences</article-title>. <source>Cell</source>, <volume>180</volume>, <fpage>915</fpage>–<lpage>927.e16</lpage>.<pub-id pub-id-type="pmid">32084333</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Martincorena</surname><given-names>I.</given-names></name>, <name name-style="western"><surname>Campbell</surname><given-names>P.J.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Somatic mutation in cancer and normal cells</article-title>. <source>Science</source>, <volume>349</volume>, <fpage>1483</fpage>–<lpage>1489</lpage>.<pub-id pub-id-type="pmid">26404825</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McInnes</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>hdbscan: hierarchical density based clustering</article-title>. <source>J. Open Source Softw</source>., <volume>2</volume>, <fpage>205</fpage>.</mixed-citation>
    </ref>
    <ref id="btaa433-B22">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Mikolov</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) Efficient estimation of word representations in vector space. <italic>arXiv preprint arXiv:1301.3781.</italic></mixed-citation>
    </ref>
    <ref id="btaa433-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Network</surname><given-names>C.G.A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Comprehensive molecular portraits of human breast tumours</article-title>. <source>Nature</source>, <volume>490</volume>, <fpage>61</fpage>.<pub-id pub-id-type="pmid">23000897</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B24">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Paszke</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) PyTorch: an imperative style, high-performance deep learning library. In: <italic>Advances in Neural Information Processing Systems</italic>, pp. <fpage>8024</fpage>–<lpage>8035</lpage>. Curran Associates, Inc., Red Hook, NY.</mixed-citation>
    </ref>
    <ref id="btaa433-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pedregosa</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Scikit-learn: machine learning in Python</article-title>. <source>J. Mach. Learn. Res</source>., <volume>12</volume>, <fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa433-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Perou</surname><given-names>C.M.</given-names></name></person-group><etal>et al</etal> (<year>2000</year>) 
<article-title>Molecular portraits of human breast tumours</article-title>. <source>Nature</source>, <volume>406</volume>, <fpage>747</fpage>–<lpage>752</lpage>.<pub-id pub-id-type="pmid">10963602</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Polak</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Cell-of-origin chromatin organization shapes the mutational landscape of cancer</article-title>. <source>Nature</source>, <volume>518</volume>, <fpage>360</fpage>–<lpage>364</lpage>.<pub-id pub-id-type="pmid">25693567</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Salvadores</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Passenger mutations accurately classify human tumors</article-title>. <source>PLoS Comput. Biol</source>., <volume>15</volume>, <fpage>e1006953</fpage>.<pub-id pub-id-type="pmid">30986244</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schuster-Böckler</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Lehner</surname><given-names>B.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Chromatin organization is a major influence on regional mutation rates in human cancer cells</article-title>. <source>Nature</source>, <volume>488</volume>, <fpage>504</fpage>–<lpage>507</lpage>.<pub-id pub-id-type="pmid">22820252</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shiraishi</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>A simple model-based approach to inferring and visualizing cancer mutation signatures</article-title>. <source>PLoS Genet</source>., <volume>11</volume>, <fpage>e1005657</fpage>.<pub-id pub-id-type="pmid">26630308</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stamatoyannopoulos</surname><given-names>J.A.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Human mutation rate associated with DNA replication timing</article-title>. <source>Nat. Genet</source>., <volume>41</volume>, <fpage>393</fpage>–<lpage>395</lpage>.<pub-id pub-id-type="pmid">19287383</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stobbe</surname><given-names>M.D.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Recurrent somatic mutations reveal new insights into consequences of mutagenic processes in cancer</article-title>. <source>PLoS Comput. Biol</source>., <volume>15</volume>, <fpage>e1007496</fpage>.<pub-id pub-id-type="pmid">31765368</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Temiz</surname><given-names>N.A.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>The somatic autosomal mutation matrix in cancer genomes</article-title>. <source>Hum. Genet</source>., <volume>134</volume>, <fpage>851</fpage>–<lpage>864</lpage>.<pub-id pub-id-type="pmid">26001532</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>van der Maaten</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Hinton</surname><given-names>G.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Visualizing high-dimensional data using t-SNE</article-title>. <source>J. Mach. Learn. Res</source>., <volume>9</volume>, <fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa433-B01947867">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vapnik</surname><given-names>V.</given-names></name></person-group> (<year>2000</year>) The nature of statistical learning theory. Springer-Verlag, <source>New York</source>, NY.</mixed-citation>
    </ref>
    <ref id="btaa433-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vogelstein</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Cancer genome landscapes</article-title>. <source>Science</source>, <volume>339</volume>, <fpage>1546</fpage>–<lpage>1558</lpage>.<pub-id pub-id-type="pmid">23539594</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Watson</surname><given-names>I.R.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Emerging patterns of somatic mutations in cancer</article-title>. <source>Nat. Rev. Genet</source>., <volume>14</volume>, <fpage>703</fpage>–<lpage>718</lpage>.<pub-id pub-id-type="pmid">24022702</pub-id></mixed-citation>
    </ref>
    <ref id="btaa433-B38">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>L.Y.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) StarSpace: embed all the things! In: <italic>Thirty-Second AAAI Conference on Artificial Intelligence</italic>. AAAI, Palo Alto, CA.</mixed-citation>
    </ref>
    <ref id="btaa433-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yuan</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>BindSpace decodes transcription factor binding signals by large-scale sequence embedding</article-title>. <source>Nat. Methods</source>, <volume>16</volume>, <fpage>858</fpage>–<lpage>861</lpage>.<pub-id pub-id-type="pmid">31406384</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
