<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BioData Min</journal-id>
    <journal-title-group>
      <journal-title>BioData Mining</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1756-0381</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3096586</article-id>
    <article-id pub-id-type="publisher-id">1756-0381-4-9</article-id>
    <article-id pub-id-type="pmid">21501515</article-id>
    <article-id pub-id-type="doi">10.1186/1756-0381-4-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>pGQL: A probabilistic graphical query language for gene expression time courses</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Schilling</surname>
          <given-names>Ruben</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>ruben.schilling@molgen.mpg.de</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Costa</surname>
          <given-names>Ivan G</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>igcf@cin.ufpe.br</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Schliep</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>schliep@cs.rutgers.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Max Planck Institute for Molecular Genetics, Department of Computational Biology, Ihnestr. 63-73, 14195 Berlin, Germany</aff>
    <aff id="I2"><label>2</label>Center of Informatics, Federal University of Pernambuco, Av. Prof. Luiz Freire, s/n, Recife - Pernambuco - Brazil</aff>
    <aff id="I3"><label>3</label>Department of Computer Science and BioMaPS Institute for Quantitative Biology, Rutgers, The State University of New Jersey, 110 Frelinghuysen Rd, Piscataway, NJ 08854-8019, USA</aff>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>4</month>
      <year>2011</year>
    </pub-date>
    <volume>4</volume>
    <fpage>9</fpage>
    <lpage>9</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>4</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>4</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2011 Schilling et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <copyright-holder>Schilling et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biodatamining.org/content/4/1/9"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Timeboxes are graphical user interface widgets that were proposed to specify queries on time course data. As queries can be very easily defined, an exploratory analysis of time course data is greatly facilitated. While timeboxes are effective, they have no provisions for dealing with noisy data or data with fluctuations along the time axis, which is very common in many applications. In particular, this is true for the analysis of gene expression time courses, which are mostly derived from noisy microarray measurements at few unevenly sampled time points. From a data mining point of view the robust handling of data through a sound statistical model is of great importance.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We propose probabilistic timeboxes, which correspond to a specific class of Hidden Markov Models, that constitutes an established method in data mining. Since HMMs are a particular class of probabilistic graphical models we call our method Probabilistic Graphical Query Language. Its implementation was realized in the free software package pGQL. We evaluate its effectiveness in exploratory analysis on a yeast sporulation data set.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>We introduce a new approach to define dynamic, statistical queries on time course data. It supports an interactive exploration of reasonably large amounts of data and enables users without expert knowledge to specify fairly complex statistical models with ease. The expressivity of our approach is by its statistical nature greater and more robust with respect to amplitude and frequency fluctuation than the prior, deterministic timeboxes.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>The analysis of gene expression time courses e.g. from DNA microarrays is crucial in understanding dynamical biological processes such as cell cycle, cell development and cell response to external stimuli. Common data sets consist of 5-30 time points and hundreds or thousands of genes [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>]. In the beginning investigators often explore their data by querying for certain qualitative and quantitative behaviors as an informative visual inspection of multivariate time points is indeed difficult. We define <italic>querying </italic>here as the evaluation of a set of conditions on time courses. The result of a query is a score for each time course that can be used to select a subset of time courses exposing behavior specified through the conditions. Among the characteristics of time courses is their variation in speed (cf. Figure <xref ref-type="fig" rid="F1">1d</xref>), i.e. delay of similar observations inducing uncertainty about exact time periods where measurements are expected to happen and phase shifts (c.f. Figure <xref ref-type="fig" rid="F1">1b</xref>). Generally, missing values, noise and outliers (cf. Figure <xref ref-type="fig" rid="F1">1c</xref>) can commonly be expected. In particular, gene expression time courses have only very few, unevenly sampled time points [<xref ref-type="bibr" rid="B3">3</xref>], in contrast to temporal data from other domains such as finance or multimedia. Intuitive software tools which support interactive formulation of query parameters by non-experts can foster wider and more flexible usage of time course data analysis tools by scientists and analysts in a range of disciplines. Yet an open research problem is finding a robust method to interactively query short time courses for specific qualitative and quantitative behavior.</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>Deterministic queries under the effect of common characteristics of time courses</bold>. In (a) both time courses are in the result set of the deterministic query interpretation. For (b), (c) and (d) the red time course is not included in the result set. In (b) a phase shift has moved the red time course out of the query's scope. In (c) an outlier prevents the red time course from being included. In (d) a variation in the speed at which values are taken prevents the red time course from matching the deterministic query interpretation. See the Results section on how deterministic timebox queries are evaluated.</p>
      </caption>
      <graphic xlink:href="1756-0381-4-9-1"/>
    </fig>
    <p>Previously, timeboxes--specifying minimal and maximal values for a continuous range of time points--were proposed [<xref ref-type="bibr" rid="B4">4</xref>] to select time courses of interest. Timeboxes are rectangular, graphical user interface (GUI) widgets, that are embedded in a graphical time course data display. However the method is not robust to noise, temporal or amplitude variations (c.f. Figure <xref ref-type="fig" rid="F1">1</xref>) common in typical data sets and does not attempt to model them. We previously implemented a method called GQL for analyzing time course data that used graphical sliders to specify parameters of densities used in a HMM [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>]. The tool lacked however an intuitive relationship between the query parameters and the data.</p>
    <p>We show that timeboxes have a natural interpretation as stochastic, piece-wise linear functions, or linear Hidden Markov Models (HMM) [<xref ref-type="bibr" rid="B7">7</xref>]. Their statistical interpretation allows for more flexible and meaningful queries, in particular in the context of analyzing biological data. We refer to our method as Probabilistic Graphical Query Language (pGQL), as HMMs are a specific class of (probabilistic) graphical models [<xref ref-type="bibr" rid="B8">8</xref>]. The visual query tool implementing our model allows users to define graphical model parameters; ranking time-courses by likelihood under that model and using a cut-off on the likelihood deter-mines the query result. Note that this is in contrast to the definition of query languages in the field of in-formation science, where graphical query languages are formal languages for querying graphs for graph-theoretical properties and/or attributes of nodes and edges. Although it is not possible to phrase all deterministic queries within pGQL, such as e.g. finding time courses whose values drop by 50% within a time interval or finding time courses for which there exists at least one time period, where they fluctuate by at most some quantity. However it is also not possible to phrase all probabilistic queries in a deterministic query system. The queries you can ask in pGQL are based on expected values and standard deviations. We demonstrate the effectiveness of probabilistic queries on a yeast sporulation data set using our implementation of the probabilistic time-boxes (pGQL). We discuss how our approach contrasts with deterministic timeboxes and identify impact our method has for practitioners.</p>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>Algorithm</title>
      <p>In the following we will refer to a set time courses as <italic>O </italic>= {<italic>o<sub>i</sub></italic>}, 1 ≤ <italic>i </italic>≤ <italic>N</italic>, where each time course <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i1.gif"/></inline-formula> takes values <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i2.gif"/></inline-formula> for times <italic>t </italic>∈ {1, ..., <italic>T</italic>}.</p>
      <sec>
        <title>Timeboxes</title>
        <p>Let us start reviewing the definition of [<xref ref-type="bibr" rid="B4">4</xref>] for timeboxes and their queries formally:</p>
        <p>A timebox <italic>b<sub>j </sub></italic>is defined by the 4-tuple <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i3.gif"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i4.gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i5.gif"/></inline-formula>. For a given set of time courses <italic>O </italic>= {<italic>o<sub>i</sub></italic>}, where 1 ≤ <italic>i </italic>≤ <italic>N</italic>, <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i6.gif"/></inline-formula> and <italic>d </italic>is the number of time points observed, a time courses <italic>o<sub>i </sub></italic>satisfies a query <italic>b<sub>j </sub></italic>only if <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i7.gif"/></inline-formula> for <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i8.gif"/></inline-formula>.</p>
        <p>In Figure <xref ref-type="fig" rid="F2">2a</xref>, we display all time courses whose values lie in the interval [<italic>x</italic><sup>-</sup>, <italic>x</italic><sup>+</sup>] for all time points in the time frame <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i9.gif"/></inline-formula>. That is, for a given time-box <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i3.gif"/></inline-formula> and set of time courses <italic>O </italic>= {<italic>o<sub>i</sub></italic>}, where <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i1.gif"/></inline-formula>, a query is defined as<disp-formula id="bmcM1"><label>(1)</label><graphic xlink:href="1756-0381-4-9-i10.gif"/></disp-formula></p>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p><bold>Comparison of deterministic and probabilistic timeboxes</bold>. (a) Query evaluation using a deterministic timebox (b) Query evaluation using probabilistic timeboxes The deterministic query in (a) does not contain all time courses showing the trend as defined by the graphical query and even contains time courses that do not follow the trend outside of the specified time interval. The corresponding probabilistic query in (b) however does not have such shortcomings and produces a much more consistent result on this real data set.</p>
          </caption>
          <graphic xlink:href="1756-0381-4-9-2"/>
        </fig>
        <p>Naturally the query operation can be easily extended for multiple timeboxes {<italic>b</italic><sub>1</sub>, ..., <italic>b<sub>j</sub></italic>, <italic>b</italic><sub><italic>j</italic>+1</sub>, ..., <italic>b<sub>q</sub></italic>} where <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i11.gif"/></inline-formula> holds ∀<italic>j </italic>∈ [1, <italic>q</italic>]. In this case, a time course satisfies the query only if <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i12.gif"/></inline-formula>, which is the intersection of individual queries: <italic>Q</italic>(<italic>b</italic><sub>1</sub>, ..., <italic>b<sub>q</sub></italic>) = ∩<italic><sub>j</sub>Q</italic>(<italic>b<sub>j</sub></italic>).</p>
      </sec>
      <sec>
        <title>HMMs and Probabilistic Timeboxes</title>
        <p>A HMM can be seen as a probabilistic function of a Markov chain [<xref ref-type="bibr" rid="B9">9</xref>] and is fully determined through the specification of its states <italic>S</italic>, the probability of starting in <italic>s<sub>i</sub></italic>, the transition probability <italic>π<sub>ij </sub></italic>from state <italic>s<sub>i </sub></italic>to <italic>s<sub>j </sub></italic>and the emission densities see [<xref ref-type="bibr" rid="B7">7</xref>] for details on Hidden Markov Models.</p>
        <p>A particular HMM [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B9">9</xref>] specialized for time course analysis is the following. The observed states correspond to the user drawn boxes, the hidden states to (graphically) invisible boxes. The latter span any time period not covered by the user defined boxes. The observed states have a normal density, which is parametrized by the mean and variance of the expression values at the time interval defined by the time box (see Figure <xref ref-type="fig" rid="F3">3a</xref> and <xref ref-type="fig" rid="F3">3b</xref>). The hidden states have a uniform density. The length of the time boxes are equivalent to the expected duration per state (cf. eq 2). We restrict the topology to contain only successor- and self-transitions (see Figure <xref ref-type="fig" rid="F3">3B</xref>). We require the model to have unique start and end states and normalize the expected durations such, that their sum matches the length of the longest time course in the data set. The HMM has the following free parameters per state: The expected duration and the emission density parameters (see [<xref ref-type="bibr" rid="B2">2</xref>] for a detailed description of the model). In the following we detail how we derive these parameters from timeboxes and how queries can be defined using this model.</p>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p><bold>Graphical Query and its interpretation as lHMM</bold>. Example of the relation of a probabilistic timebox query (Fig. 3A) to its state model in the corresponding lHMM (Fig. 3B). In Fig. 3A the central black bar within each blue PTB represent the mean value, while a quarter of each PTBs height represents the variance. In Fig. 3B the states 2 and 4 correspond to the blue PTBs in Fig. 3A. When we compare Fig. 3A with Fig. 3B we see, that pGQL inserts automatically hidden states with a uniform distribution in areas where no blue PTB has been placed.</p>
          </caption>
          <graphic xlink:href="1756-0381-4-9-3"/>
        </fig>
        <p>As depicted in Figure <xref ref-type="fig" rid="F2">2b</xref>, we can allow values out-side of <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i13.gif"/></inline-formula>, as long as the overall values of a time course fit the timebox. This can be obtained by modeling the value range covered by a timebox with one uni-variate Normal, where the mean defines the mid point of the value range of the timebox and the standard deviation is proportional to a half of the height of the box.</p>
        <p>Additionally, we also want to account for variation along the time axis, in particular time courses with phase-shifts (cf. Figure <xref ref-type="fig" rid="F1">1b</xref>) and difference in speed (cf. Figure <xref ref-type="fig" rid="F1">1d</xref>). This can be achieved by modeling the time frame as an expected duration of a timebox. Such probabilistic timeboxes define a state with an uni-variate normal density emission in a lHMM [<xref ref-type="bibr" rid="B2">2</xref>]. In this model, we also need to assign states for time frames where no timebox is defined, such as the regions in the left of Figure <xref ref-type="fig" rid="F2">2b</xref>. Specifying states in such frames substantiates the assumption about <italic>when </italic>we expect the user defined normal models to occur. These hidden boxes can be interpreted as waiting timeboxes, where any observation is equally likely to occur.</p>
        <p>More formally, a probabilistic timebox PTB is a state in a lHMM <italic>λ </italic>with an uni-variate normal density emission (see Figure <xref ref-type="fig" rid="F3">3B</xref>). This (<italic>k</italic>th) state is parametrized by the triplet (<italic>p<sub>k</sub></italic>, <italic>μ<sub>k</sub></italic>, <italic>σ<sub>k</sub></italic>), where <italic>p<sub>k </sub></italic>is the self transition probability or expected duration, and <italic>N </italic>(<italic>μ<sub>k</sub></italic>, <italic>σ<sub>k</sub></italic>) is the state emission density. Given the (graphical) parameters of a timebox (c.f. Figure <xref ref-type="fig" rid="F3">3A</xref>), the state parameters can be defined as,<disp-formula id="bmcM2"><label>(2)</label><graphic xlink:href="1756-0381-4-9-i14.gif"/></disp-formula><disp-formula id="bmcM3"><label>(3)</label><graphic xlink:href="1756-0381-4-9-i15.gif"/></disp-formula><disp-formula id="bmcM4"><label>(4)</label><graphic xlink:href="1756-0381-4-9-i16.gif"/></disp-formula></p>
        <p>Note that the current choice of <italic>σ<sub>k </sub></italic>places approximately 95.5% of the density mass in the interval <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i13.gif"/></inline-formula>, and that <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i17.gif"/></inline-formula> is the expected duration of the timebox. The latter defines <italic>p<sub>k</sub></italic>, which obeys a geometrical distribution [<xref ref-type="bibr" rid="B10">10</xref>]. The relation between transition probability and duration is detailed in [<xref ref-type="bibr" rid="B7">7</xref>]. The idea is to consider the probability of staying <italic>n </italic>times in state <italic>s<sub>i</sub></italic>, before you make a transition to <italic>s</italic><sub><italic>i</italic>+1</sub>.</p>
        <p>Hidden states, that have no graphical representation, model time frames between timeboxes. They are defined by a single parameter, their expected length, <italic>p<sub>l</sub></italic>, and a uniform distribution U(<italic>x<sub>min</sub></italic>, <italic>x<sub>max</sub></italic>), where <italic>x<sub>min </sub></italic>(and <italic>x<sub>max</sub></italic>) are the minimum (and maximum) value in <italic>O</italic>. For two consecutive timeboxes, <italic>j </italic>and <italic>j </italic>+ 1, where <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i18.gif"/></inline-formula>, we have<disp-formula id="bmcM5"><label>(5)</label><graphic xlink:href="1756-0381-4-9-i19.gif"/></disp-formula></p>
        <p>Time ranges before (and after) the first and last timeboxes <italic>b</italic><sub>1 </sub>and <italic>b<sub>q </sub></italic>represent special cases. We also include a state emitting a uniform distribution in these ranges when <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i20.gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="1756-0381-4-9-i21.gif"/></inline-formula>.</p>
        <p>One additional requirement for querying with PTBs is a parameter <italic>m</italic>, which defines how many time courses should be returned by the query. Intuitively, the query works by estimating the time course likelihoods (<bold>P</bold>[<italic>o<sub>i</sub></italic>|<italic>λ</italic>]) using the Forward-algorithm [<xref ref-type="bibr" rid="B7">7</xref>], followed by the selection of the <italic>m </italic>time courses with highest likelihoods. In particular setting <italic>m </italic>to the number of time courses will return all time courses as query result and setting <italic>m </italic>to 1 will return the time course with highest likelihood. More formally, given a full parametrized lHMM <italic>λ </italic>defined by the timeboxes (<italic>b</italic><sub>1</sub>, ..., <italic>b<sub>q</sub></italic>) and <italic>m</italic>, the probabilistic query is defined as,<disp-formula id="bmcM6"><label>(6)</label><graphic xlink:href="1756-0381-4-9-i22.gif"/></disp-formula></p>
        <p>The main computational task behind the query is computing the log-likelihood of the time-courses for a given HMM. This has the computational complexity of <italic>O</italic>(<italic>N · </italic><italic>K · </italic><italic>L</italic>), where <italic>N </italic>is the number of time-courses, <italic>K </italic>the number of states (or time-boxes) and <italic>L </italic>the number of time points. Note that <italic>K </italic>and <italic>L </italic>are usually small (&lt; 10) in this application, there-fore the running time only depends linearly on the number of samples <italic>N</italic>.</p>
      </sec>
    </sec>
    <sec>
      <title>Testing</title>
      <sec>
        <title>Case Study - Yeast Sporulation</title>
        <p>To show the usefulness of the probabilistic timeboxes in the analysis of gene expression, we perform a case study with the time courses of Yeast during sporulation [<xref ref-type="bibr" rid="B11">11</xref>] There, the expression values of approximately 6,200 genes have been measured through the course of seven time points (0 h, 0.5 h, 2 h, 5 h, 7 h, 9 h and 11 h). The biological process is formed by a cascade of transcriptional events, which can be subdivided in three main consecutive events: DNA replication, meiosis and spore maturation. We pre-processed the data, as described in [<xref ref-type="bibr" rid="B2">2</xref>], to discard time courses with a large number of missing values or with small temporal expression change, which resulted in a data set with 1,171 genes. In [<xref ref-type="bibr" rid="B11">11</xref>], authors hand selected seven groups of genes as prototypes of interesting expression patterns. For example, genes with an increase in expression in early, middle or late time points. The mean expression value of each group was taken, and a nearest neighbor approach based on the correlation coefficient was used to assign other genes to each of the expression patterns.</p>
        <p>We show here, how such exploratory analysis of temporal expression patterns, can be interactively performed with the PTBs. In the following we refer to a pattern of over-expression, which is visible in data and can be scored by our model, simply as over-expression. For example, to find all genes with early over-expression patterns, we simply need to draw a timebox in the upper left side of the canvas and set the query stringency to 150 genes (Figure <xref ref-type="fig" rid="F4">4a</xref>). Note that all time courses display high expression at early time points but distinct expression patterns at later time points. A functional analysis of the genes indicates that the query contains genes mostly related to metabolism and meiosis. To refine the query, we can create an additional PTB, now at the upper-right part of the canvas (Figure <xref ref-type="fig" rid="F4">4b</xref>). This query will return all genes with an over-expression pattern, which is sustained over time. Functional analysis of these genes indicates a relation to meiosis, which is in accordance with the functional analysis performed in [<xref ref-type="bibr" rid="B11">11</xref>]. We can then modify the query, by moving the second timebox toward zero expression values, therefore querying genes with a over-expression followed by an expression decrease (Figure <xref ref-type="fig" rid="F4">4c</xref>). These genes, which are involved in metabolism, are activated as a reflex of the nitrogen starvation caused by the sporulation medium [<xref ref-type="bibr" rid="B11">11</xref>]. The user can perform further operations on the timeboxes to find other expression patterns of interest. Deleting the second PTB and moving the first one down returns a query with genes displaying under-expression pattern (Figure <xref ref-type="fig" rid="F4">4d</xref>). These genes are mostly related to the ribosome, which has been interpreted as effect of the cessation of growth under the nitrogen starvation [<xref ref-type="bibr" rid="B11">11</xref>]. This example displays how a user can easily perform an exploratory analysis of temporal expression patterns with PTBs and all main features provided by pGQL.</p>
        <fig id="F4" position="float">
          <label>Figure 4</label>
          <caption>
            <p><bold>Yeast sporulation case study</bold>. We depict query results from a Yeast sporulation data set. In the first query (a), we have 150 genes with early over expression pattern. This query is made more specific by creating a new timebox (b). Now, it returns genes that have a sustained over-expression pattern. By applying a move operation on the second timebox, we query for genes with a over-expression followed by expression decrease (c). We can look for further patterns by deleting the second timebox and move the first timebox down to obtain genes with under-expression patterns(d).</p>
          </caption>
          <graphic xlink:href="1756-0381-4-9-4"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>The software is implemented in Python and Tkinter using the GHMM library [<xref ref-type="bibr" rid="B5">5</xref>] and was tested on Linux and Mac OS X, but works on other modern operating systems including Windows as well. It is licensed under the GPL. The software is available from our web site <ext-link ext-link-type="uri" xlink:href="http://algorithmics.molgen.mpg.de/Software/pGQL/">http://algorithmics.molgen.mpg.de/Software/pGQL/</ext-link>.</p>
      <p>The tool automatically inserts (and removes) hidden states into (from) regions, where the user has not (has) defined a PTB for a state corresponding to a normal emission density. These hidden states correspond to uniform emission densities. While drawing and editing PTBs consistency constraints are automatically checked and create a frame for specifying useful models. In particular pGQL checks, that users draw boxes with a minimum of 1.0 expected duration, since we do not assume any interpolation model on the discrete data. Users are also automatically guided to never produce overlapping states or states extending beyond the graph display. When-ever a query is graphically modified pGQL automatically recomputes the query and updates the result. It is possible to display PTBs on top of the time course data for query redefinition or below to inspect query results. pGQL also implements deterministic timebox queries to enable direct comparisons of the methods by switching between query types on the fly.</p>
      <sec>
        <title>Functional Analysis</title>
        <p>An important method for the biological analysis of a group of genes, as the one returned by a query, is the so called enrichment functional analysis [<xref ref-type="bibr" rid="B12">12</xref>]. This method uses databases with functional annotation of genes, such as Gene Ontology [<xref ref-type="bibr" rid="B13">13</xref>] to search for functional groups, whose genes are also within the query result. pGQL provides an out-link to the G: Profiler tool [<xref ref-type="bibr" rid="B12">12</xref>] to perform an enrichment functional analysis based on the current working query.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>The PTB based graphical query approach enables users to phrase their hypotheses in a fashion many are already familiar with, i.e. defining normal distributions in the value domain and placing them as expected durations. Uncertainty is naturally incorporated in such models, while the user is not required to bother with the formalisms, but can simply use an interactive tool, that alleviates the usage of these models. The specificity of queries can easily be in-creased by adding more PTBs to a query. It would be interesting to combine pGQL with formal queries known from other field s to benefit from many deterministic queries as well. It is a future research problem how to translate such queries into one common graphical query interface. The only deterministic query pGQL currently provides is of the basic time box query type [<xref ref-type="bibr" rid="B4">4</xref>]. Although beyond the scope of the present article, it would be interesting to perform a full usability study of our tool in the future to conduct a user related performance evaluation as well.</p>
    <p>The interpretation of query results from pGQL is straightforward: The result set will contain the <italic>m </italic>top ranking time courses, where obviously the highest scores will be assigned to time courses that lie centrally to the query. In contrast deterministic queries do not have a notion of rank as their scoring is binary.</p>
    <p>We could in principle approximate the behavior of deterministic boxes by imposing peak like boxes on time periods. From a statistical point of view this is equivalent to overfitting the query model on the time dimension. Since the measurements will be taken in units of time, it generally doesn't make much sense from a modeling perspective to expect any measurement to last shorter than a a full time unit. Thus pGQL requires at least a unit of time for each timebox. This choice leads to query models, that are robust to time delays, since the self-transition probability in the HMM will not be forced to be infinitesimally small. If a user has a strong belief in values taking place in an exact, predefined time period he might get additional time courses returned from the query model, that exhibit similar behavior delayed in time. The ranking of time courses is one way to re ne the selection of such a result set: Time courses that adhere to the query during the exact time periods of the probabilistic boxes, should always be contained in the results, as they will be ranked highly by the query model.</p>
    <p>Deterministic timeboxes could in principle be made approximate by requiring only a certain fraction of measurements to lie within a box. This shifts the problem to determining what this fraction really is. It is unclear how well this concept could capture common time course characteristics we mentioned in the Background section.</p>
    <p>An example (again on the yeast sporulation data) demonstrating the robustness of the probabilistic queries is shown in Figure <xref ref-type="fig" rid="F2">2b</xref>: Despite of outliers on time points four and five the query result shows time courses displaying strongly similar behavior. The ex-act same graphical query in the deterministic setting shown in Figure <xref ref-type="fig" rid="F2">2a</xref> returns only a subset of the probabilistic query result, which is owed to the sensitivity to outliers. Moreover the result contains a few time courses, that do not seem to fit the overall trend specified by the query well. The latter is an artifact owed to the over fitting in time.</p>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>Probabilistic timeboxes introduced new semantics to timeboxes proposed by [<xref ref-type="bibr" rid="B4">4</xref>]. Graphical queries are interactively created and manipulated by enabling users to draw, delete, move and resize any number of PTB's with respect to the incorporated constraints of this approach. This allows for easy and comfortable definition of meaningful, flexible queries even in complex data analysis scenarios. Probabilistic models, in particular in use for gene expression data, are known to be much more appropriate and flexible than their deterministic counter parts [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B14">14</xref>-<xref ref-type="bibr" rid="B16">16</xref>]. The ease of the graphical definition encapsulates a sound method for query definition, requiring no in-depth knowledge of the underlying probabilistic methods to use this tool. We have demonstrated the method on a real world data set of yeast sporulation. This case study also revealed typical advantages our method has over deterministic methods. We contrasted the PTBs with the original timeboxes and shown how they cope better with many properties of gene expression time courses. pGQL can be of great help in finding interesting clusters in time course data.</p>
    <p>A straight-forward extension to our method would be modeling cyclic data. All that is needed for this is to insert a transition from the end state to the start state and specify the transition probability favoring more or fewer cycles. Then we expect cyclic or periodic data to benefit from queries with probabilistic timeboxes just as well. GHMM supports cyclic queries already.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>RS implemented the graphical tool and drafted the manuscript. IGC and AS implemented the probabilistic models and contributed to the manuscript. AS conceived the study initially. All authors read and approved the final manuscript.</p>
  </sec>
</body>
<back>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bar-Joseph</surname>
          <given-names>Z</given-names>
        </name>
        <article-title>Analyzing time series gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <issue>16</issue>
        <fpage>2493</fpage>
        <lpage>503</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth283</pub-id>
        <pub-id pub-id-type="pmid">15130923</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schliep</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Costa</surname>
          <given-names>IG</given-names>
        </name>
        <name>
          <surname>Steinhoff</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Schönhuth</surname>
          <given-names>AA</given-names>
        </name>
        <article-title>Analyzing Gene Expression Time-Courses</article-title>
        <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source>
        <year>2005</year>
        <volume>2</volume>
        <issue>3</issue>
        <fpage>179</fpage>
        <lpage>193</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2005.31</pub-id>
        <pub-id pub-id-type="pmid">17044182</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ernst</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Bar-Joseph</surname>
          <given-names>Z</given-names>
        </name>
        <article-title>STEM: a tool for the analysis of short time series gene expression data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>191</fpage>
        <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/7/191">http://www.biomedcentral.com/1471-2105/7/191</ext-link>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-191</pub-id>
        <pub-id pub-id-type="pmid">16597342</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Hochheiser</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Shneiderman</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Dynamic query tools for time series data sets: Timebox widgets for interactive exploration</article-title>
        <source>Information Visualization</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>1</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1057/palgrave.ivs.9500061</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Costa</surname>
          <given-names>IG</given-names>
        </name>
        <name>
          <surname>Schönhuth</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Schliep</surname>
          <given-names>A</given-names>
        </name>
        <article-title>The Graphical Query Language: a tool for analysis of gene expression time-courses</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>10</issue>
        <fpage>2544</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti311</pub-id>
        <pub-id pub-id-type="pmid">15701683</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="other">
        <article-title>The Graphical Query Language (GQL)</article-title>
        <year>2003</year>
        <ext-link ext-link-type="uri" xlink:href="http://ghmm.org/gql">http://ghmm.org/gql</ext-link>
        <comment>Accessed 13.4.2011</comment>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rabiner</surname>
          <given-names>LR</given-names>
        </name>
        <article-title>A Tutorial on Hidden Markov Models and Selected Applications in Speech Recognition</article-title>
        <source>Proceedings of the IEEE</source>
        <year>1989</year>
        <volume>77</volume>
        <issue>2</issue>
        <fpage>257</fpage>
        <lpage>285</lpage>
        <pub-id pub-id-type="doi">10.1109/5.18626</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="book">
        <name>
          <surname>Jordan</surname>
          <given-names>MI</given-names>
        </name>
        <collab>(Ed)</collab>
        <source>Learning in graphical models</source>
        <year>1999</year>
        <publisher-name>Cambridge, MA, USA: MIT Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schliep</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Schonhuth</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Steinhoff</surname>
          <given-names>C</given-names>
        </name>
        <article-title>Using hidden Markov models to analyze gene expression time course data</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <issue>suppl_1</issue>
        <fpage>i255</fpage>
        <lpage>263</lpage>
        <pub-id pub-id-type="pmid">12855468</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="book">
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Eddy</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Krogh</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Mitchison</surname>
          <given-names>G</given-names>
        </name>
        <source>Biological Sequence Analysis: probabilistic models of proteins and nucleic acids</source>
        <year>1998</year>
        <publisher-name>Cambridge Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chu</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>DeRisi</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Eisen</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Mulholland</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Botstein</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Brown</surname>
          <given-names>PO</given-names>
        </name>
        <name>
          <surname>Herskowitz</surname>
          <given-names>I</given-names>
        </name>
        <article-title>The Transcriptional Program of Sporulation in Budding Yeast</article-title>
        <source>Science</source>
        <year>1998</year>
        <volume>282</volume>
        <issue>5389</issue>
        <fpage>699</fpage>
        <lpage>705</lpage>
        <pub-id pub-id-type="pmid">9784122</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="other">
        <name>
          <surname>Reimand</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kull</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Peterson</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Hansen</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Vilo</surname>
          <given-names>J</given-names>
        </name>
        <article-title>g: Profiler-a web-based toolset for functional profiling of gene lists from large-scale experiments</article-title>
        <source>Nucleic Acids Res</source>
        <year>2007</year>
        <issue>35 Web Server</issue>
        <fpage>W193</fpage>
        <lpage>W200</lpage>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ashburner</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Gene Ontology: tool for the unification of biology</article-title>
        <source>Nature Genetics</source>
        <year>2000</year>
        <volume>25</volume>
        <fpage>25</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="doi">10.1038/75556</pub-id>
        <pub-id pub-id-type="pmid">10802651</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bar-Joseph</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Gerber</surname>
          <given-names>GK</given-names>
        </name>
        <name>
          <surname>Gifford</surname>
          <given-names>DK</given-names>
        </name>
        <name>
          <surname>Jaakkola</surname>
          <given-names>TS</given-names>
        </name>
        <name>
          <surname>Simon</surname>
          <given-names>I</given-names>
        </name>
        <article-title>Continuous representations of time-series gene expression data</article-title>
        <source>J Comput Biol</source>
        <year>2003</year>
        <volume>10</volume>
        <issue>3-4</issue>
        <fpage>341</fpage>
        <lpage>356</lpage>
        <pub-id pub-id-type="doi">10.1089/10665270360688057</pub-id>
        <pub-id pub-id-type="pmid">12935332</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ramoni</surname>
          <given-names>MF</given-names>
        </name>
        <name>
          <surname>Sebastiani</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Kohane</surname>
          <given-names>IS</given-names>
        </name>
        <article-title>Cluster analysis of gene expression dynamics</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2002</year>
        <volume>99</volume>
        <issue>14</issue>
        <fpage>9121</fpage>
        <lpage>9126</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.132656399</pub-id>
        <pub-id pub-id-type="pmid">12082179</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Yeung</surname>
          <given-names>KY</given-names>
        </name>
        <name>
          <surname>Fraley</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Murua</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Raftery</surname>
          <given-names>AE</given-names>
        </name>
        <name>
          <surname>Ruzzo</surname>
          <given-names>WL</given-names>
        </name>
        <article-title>Model-based clustering and data transformations for gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <issue>10</issue>
        <fpage>977</fpage>
        <lpage>987</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/17.10.977</pub-id>
        <pub-id pub-id-type="pmid">11673243</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
