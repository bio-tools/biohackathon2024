<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9838317</article-id>
    <article-id pub-id-type="pmid">36576010</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac832</article-id>
    <article-id pub-id-type="publisher-id">btac832</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Asteroid: a new algorithm to infer species trees from gene trees under high proportions of missing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6286-4419</contrib-id>
        <name>
          <surname>Morel</surname>
          <given-names>Benoit</given-names>
        </name>
        <aff><institution>Computational Molecular Evolution Group, Heidelberg Institute for Theoretical Studies</institution>, Heidelberg 69118, <country country="DE">Germany</country></aff>
        <aff><institution>Institute for Theoretical Informatics, Karlsruhe Institute of Technology</institution>, Karlsruhe 76131, <country country="DE">Germany</country></aff>
        <xref rid="btac832-cor1" ref-type="corresp"/>
        <!--benoit.morel@h-its.org-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Williams</surname>
          <given-names>Tom A</given-names>
        </name>
        <aff><institution>School of Biological Sciences, University of Bristol</institution>, Bristol BS8, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0353-0691</contrib-id>
        <name>
          <surname>Stamatakis</surname>
          <given-names>Alexandros</given-names>
        </name>
        <aff><institution>Computational Molecular Evolution Group, Heidelberg Institute for Theoretical Studies</institution>, Heidelberg 69118, <country country="DE">Germany</country></aff>
        <aff><institution>Institute for Theoretical Informatics, Karlsruhe Institute of Technology</institution>, Karlsruhe 76131, <country country="DE">Germany</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac832-cor1">To whom correspondence should be addressed. <email>benoit.morel@h-its.org</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-12-28">
      <day>28</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac832</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>12</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>20</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>13</day>
        <month>1</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac832.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Missing data and incomplete lineage sorting (ILS) are two major obstacles to accurate species tree inference. Gene tree summary methods such as ASTRAL and ASTRID have been developed to account for ILS. However, they can be severely affected by high levels of missing data.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present Asteroid, a novel algorithm that infers an unrooted species tree from a set of unrooted gene trees. We show on both empirical and simulated datasets that Asteroid is substantially more accurate than ASTRAL and ASTRID for very high proportions (&gt;80%) of missing data. Asteroid is several orders of magnitude faster than ASTRAL for datasets that contain thousands of genes. It offers advanced features such as parallelization, support value computation and support for multi-copy and multifurcating gene trees.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>Asteroid is freely available at <ext-link xlink:href="https://github.com/BenoitMorel/Asteroid" ext-link-type="uri">https://github.com/BenoitMorel/Asteroid</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Klaus Tschira Foundation and by DFG</institution>
          </institution-wrap>
        </funding-source>
        <award-id>STA 860/6-2</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Due to recent advances in sequencing technology, biologists now have access to an exponentially increasing quantity of phylogenomic data that can help to unravel evolutionary relationships between species. However, despite this abundance of informative data, inferring species trees remains a challenging task, especially when speciation events occurred within very short time intervals.</p>
    <p>An important obstacle to accurate phylogenetic tree inference is the discordance between species and gene histories. Biological processes such as incomplete lineage sorting (ILS), gene duplication, gene loss or horizontal gene transfer, yield species trees that are topologically distinct from the respective gene trees. In particular, it has been shown that concatenation approaches (<xref rid="btac832-B2" ref-type="bibr">Aberer <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btac832-B9" ref-type="bibr">Kozlov <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac832-B10" ref-type="bibr">Lartillot <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btac832-B17" ref-type="bibr">Minh <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac832-B26" ref-type="bibr">Ronquist <italic toggle="yes">et al.</italic>, 2012</xref>) (also called supermatrix methods) are inconsistent under the multi-species coalescent (MSC) model (<xref rid="btac832-B25" ref-type="bibr">Roch and Steel, 2015</xref>), which is widely used to model ILS (<xref rid="btac832-B22" ref-type="bibr">Rannala and Yang, 2003</xref>).</p>
    <p>Gene tree summary methods have been developed to better accommodate the incongruence between the gene trees and species history. They initially infer one gene tree per gene sequence alignment, and subsequently estimate the species tree from the inferred set of input gene trees. Some of these methods are particularly appealing because they can process large datasets and because some of them are consistent under the MSC model, under the assumption that the gene trees are correctly estimated.</p>
    <p>ASTRAL-III (<xref rid="btac832-B42" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2018</xref>) defines the quartet score of a species tree as the number of quartets induced by the input gene trees that are compatible with the species tree. ASTRAL-III implements a search heuristic that first extracts a list of all bipartitions from the input gene trees, and subsequently deploys a dynamic programming algorithm to traverse all species trees whose bipartitions are contained in this list. ASTRAL-III computes the quartet score for each of those candidate species trees, and returns the tree with the best quartet score. FastRFS (<xref rid="btac832-B30" ref-type="bibr">Vachaspati and Warnow, 2017</xref>) uses the same exploration strategy to search for the species tree but has not been proven to be consistent under the MSC model. In contrast to ASTRAL-III, it attempts to minimize the Robinson-Foulds (RF) distance (<xref rid="btac832-B24" ref-type="bibr">Robinson and Foulds, 1981</xref>) between the species tree and the gene trees. The search strategy used by ASTRAL-III and FastRFS allows them to analyze datasets comprising a large number of species. However, their runtime complexity is more than quadratic with respect to the number of genes [<inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2.726</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, for ASTRAL-III and <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for FastRFS, where <italic toggle="yes">N</italic> is the number of species, and <italic toggle="yes">K</italic> the number of genes], and they therefore become computationally demanding with increasing numbers of genes. ASTRID (<xref rid="btac832-B29" ref-type="bibr">Vachaspati and Warnow, 2015</xref>) is a faster alternative that runs in time that is linear in the number of genes [<inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>]. It defines the internode distance between two leaves in a tree as the number of internal nodes on the path connecting those two leaves. ASTRID computes a distance matrix whose elements represent the distance between each pair of species, as estimated from the gene tree leaf internode distances. Then, it estimates a species tree from this matrix under the minimum balanced evolution principle (<xref rid="btac832-B12" ref-type="bibr">Lefort <italic toggle="yes">et al.</italic>, 2015</xref>) (see our Section 2 for a more detailed description of ASTRID). ASTRAL-III and ASTRID, as well as some other gene tree summary methods, are consistent under the MSC model, assuming that the gene trees have been correctly estimated <italic toggle="yes">and</italic> that each gene tree comprises all species.</p>
    <p>However, the consistency of ASTRAL-III and ASTRID is not well established for datasets with missing data, which represent the standard use case in biological practice. In the following, as <italic toggle="yes">missing data</italic>, we consider gene trees that do not comprise all species under study. Missing data can have various causes, such as gene loss events, errors in the gene orthology clustering process, or genes simply not being sequenced. In addition, some pre-processing pipelines filter out gene sequences, for instance by identifying abnormally long gene tree branches (<xref rid="btac832-B14" ref-type="bibr">Mai and Mirarab, 2018</xref>), by removing sequences with too many gaps (<xref rid="btac832-B32" ref-type="bibr">Wickett <italic toggle="yes">et al.</italic>, 2014</xref>), or by identifying and removing rogue gene sequences (<xref rid="btac832-B1" ref-type="bibr">Aberer <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btac832-B5" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2021</xref>). Missing data can be considered as the result of a stochastic process that, starting from a comprehensive gene tree comprising all species, randomly deletes gene leaves. We refer to the models describing this stochastic process as <italic toggle="yes">models of taxon deletion</italic>. It has been shown that under some models of taxon deletion, ASTRAL-I and ASTRAL-II are still consistent under the MSC model (<xref rid="btac832-B20" ref-type="bibr">Nute <italic toggle="yes">et al.</italic>, 2018</xref>), but that ASTRID is inconsistent (<xref rid="btac832-B23" ref-type="bibr">Rhodes <italic toggle="yes">et al.</italic>, 2020</xref>). However, the consistency of ASTRAL as well as other methods such as FastRFS has not yet been established for more general models of taxon deletion.</p>
    <p>Here, we show that widely used methods such as ASTRAL-III, FastRFS and ASTRID are not robust to high proportions of missing data. To address this issue, we introduce a new algorithm and open-source implementation, Asteroid, that constitutes a modification of the ASTRID algorithm and can better account for missing data. To achieve this in Asteroid, we introduce a new optimization criterion, the <italic toggle="yes">global induced length</italic> of a tree. We show that this optimization criterion is consistent under any model of taxon deletion. Our experiments on simulated datasets show that Asteroid is as accurate as the competing methods in the absence of missing data, and considerably more accurate for large proportions of missing data. Further, we provide several empirical examples where Asteroid infers biologically plausible trees in contrast to the competing methods that fail to recover widely accepted and well-established phylogenetic relationships. In addition, on these empirical datasets, Asteroid is two orders of magnitude faster than ASTRAL-III and ASTER, and three orders of magnitude faster than FastRFS. It is, in the worst case, only one order of magnitude slower than ASTRID. Asteroid provides several useful features, such as bootstrap support value computation, conducting tree searches from multiple starting trees, support for multifurcating as well as multi-copy gene trees, and a distributed memory parallelization. Finally, we evaluated the quality of our implementation with respect to coding standards adherence using the SoftWipe (<xref rid="btac832-B37" ref-type="bibr">Zapletal <italic toggle="yes">et al.</italic>, 2021</xref>) tool. The SoftWipe score of Asteroid is <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mn>8.6</mml:mn><mml:mo>/</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula>, which places Asteroid second in the list of 52 scientific tools written in C/C++ that the SoftWipe benchmark covers.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>We first introduce some necessary notations and definitions. Then, we review the definition of the <italic toggle="yes">global length</italic> of a species tree (<xref rid="btac832-B12" ref-type="bibr">Lefort <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btac832-B29" ref-type="bibr">Vachaspati and Warnow, 2015</xref>). We then explain our extension to define the <italic toggle="yes">global induced length</italic> of a tree. Subsequently, we outline our new method, Asteroid and how it efficiently searches for the species tree that minimizes our global induced length.</p>
    <sec>
      <title>2.1 Preliminaries</title>
      <p>Let <italic toggle="yes">T</italic> be an unrooted tree with <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> taxa. The <italic toggle="yes">internode distance</italic> between two taxa <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> of <italic toggle="yes">T</italic> is the number of internal nodes on the path connecting <italic toggle="yes">i</italic> with <italic toggle="yes">j</italic> in <italic toggle="yes">T</italic>. Let <italic toggle="yes">L</italic>(<italic toggle="yes">T</italic>) denote the taxon set of <italic toggle="yes">T</italic>. Further, let <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi>X</mml:mi><mml:mo>⊂</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The tree <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula><italic toggle="yes">induced</italic> by <italic toggle="yes">T</italic> and <italic toggle="yes">X</italic> is the tree obtained from <italic toggle="yes">T</italic> by removing all taxa that are not contained in <italic toggle="yes">X</italic> and by subsequently contracting all nodes of degree one. A <italic toggle="yes">species tree S</italic> is an unrooted binary tree. Given a species tree <italic toggle="yes">S</italic>, a <italic toggle="yes">gene tree</italic> is an unrooted tree such that <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>⊂</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Note that a gene tree <italic toggle="yes">can</italic> be multifurcating. <italic toggle="yes">L</italic>(<italic toggle="yes">G</italic>) represents the set of species taxa covered by the gene tree <italic toggle="yes">G</italic> and is called the <italic toggle="yes">coverage pattern</italic> of <italic toggle="yes">G</italic>.</p>
    </sec>
    <sec>
      <title>2.2 Global length of a species tree in ASTRID</title>
      <p>Let <italic toggle="yes">S</italic> be a species tree with <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> taxa. Let <italic toggle="yes">M<sub>S</sub></italic> be the matrix whose elements <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> represent the pairwise internode distances between the taxa of <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> of <italic toggle="yes">S</italic>. Let <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script" class="calligraphy">G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be a set of <italic toggle="yes">K</italic> gene trees. Let <italic toggle="yes">F</italic>(<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) be the set of indices of the gene trees that include taxa <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>. Let <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the internode distance between the gene taxa <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> in <italic toggle="yes">G<sub>k</sub></italic> if <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and 0 otherwise. Let <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> be the average internode distance matrix, such that for all taxon indices <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>, <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      <p>The <italic toggle="yes">global length</italic> of <italic toggle="yes">S</italic> and <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:math></inline-formula> is defined as:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script" class="calligraphy">G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>ASTRID (<xref rid="btac832-B29" ref-type="bibr">Vachaspati and Warnow, 2015</xref>) aims to find the species tree <italic toggle="yes">S</italic> that minimizes this global length. Note that the absence of a set of taxa in a gene tree might result in underestimating the internode distance between the remaining species that <italic toggle="yes">are</italic> present in this gene tree. As a result, including genes with missing data introduces a bias that will, in some cases, mislead the species tree inference process. This even holds in the absence of ILS and in case the gene trees are correctly inferred (see <xref rid="btac832-F1" ref-type="fig">Fig. 1</xref>).</p>
      <fig position="float" id="btac832-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Example of the missing data bias causing ASTRID to infer an incorrect species tree. <italic toggle="yes">G</italic><sub>1</sub>, <italic toggle="yes">G</italic><sub>2</sub> and <italic toggle="yes">G</italic><sub>3</sub> are three incomplete gene trees that perfectly agree with the true species tree (‘True tree’) shown. Grey lines correspond to non-sampled subtrees. The gene tree <italic toggle="yes">G</italic><sub>1</sub> is the only tree that covers both species <italic toggle="yes">A</italic> and <italic toggle="yes">F</italic>. The internode distance between <italic toggle="yes">A</italic> and <italic toggle="yes">F</italic> is 5 in the true species tree, but only 2 in <italic toggle="yes">G</italic><sub>1</sub>. Similarly, the internode distances between <italic toggle="yes">A</italic> and <italic toggle="yes">G</italic>, between <italic toggle="yes">B</italic> and <italic toggle="yes">F</italic>, and between <italic toggle="yes">B</italic> and <italic toggle="yes">G</italic> are all being underestimated because of missing genes. This introduces a bias in the resulting distance matrix, placing the clades (<italic toggle="yes">A</italic>, <italic toggle="yes">B</italic>) and (<italic toggle="yes">F</italic>, <italic toggle="yes">G</italic>) closer to each other than they should be</p>
        </caption>
        <graphic xlink:href="btac832f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.3 Global induced length of a species tree</title>
      <p>We introduce the <italic toggle="yes">global induced length</italic> of a tree to correct for this missing data bias. Instead of merging all gene tree internode matrices <italic toggle="yes">D<sub>k</sub></italic> into one single matrix <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we separately compute the global length for every gene tree and matrix. We then apply an appropriate correction based on the respective taxon coverage patterns.</p>
      <p>For each <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>, let <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> be the species tree induced by <italic toggle="yes">S</italic> and the set of species covered by the gene tree <italic toggle="yes">G<sub>k</sub></italic>. Let <italic toggle="yes">M<sub>k</sub></italic> be the matrix whose elements contain the pairwise internode distances between the taxa of <italic toggle="yes">S<sub>k</sub></italic>. The <italic toggle="yes">global induced length</italic> is defined as:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script" class="calligraphy">G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>Separately weighting each gene tree internode distance matrix <italic toggle="yes">D<sub>k</sub></italic> with the corresponding induced species tree distance matrix <italic toggle="yes">M<sub>k</sub></italic> (instead of <italic toggle="yes">M</italic>) corrects for the gene internode estimation bias and yields the global induced length, which is more robust to missing data. In the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>, we prove that the global induced length is consistent under the MSC model and under any random model of taxon deletion that is independent across genes, under the assumption that the gene trees have been correctly estimated. In other words, when the number of input gene trees increases asymptotically, the global induced length is minimized by the true species tree.</p>
    </sec>
    <sec>
      <title>2.4 Asteroid</title>
      <p>Asteroid is a search heuristic that aims to find the species tree with the lowest global induced length. In this section, we briefly outline our approach. A more detailed description of our algorithm can be found in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
      <p>Asteroid starts from a given species tree topology and applies a tree search strategy based on subtree prune and regraft (SPR) moves to further improve the score. The starting species tree can be either a random tree or a tree estimated with our own re-implementation of the ASTRID algorithm. Then, we iteratively optimize the species tree topology by adapting the FastME tree search algorithm (<xref rid="btac832-B12" ref-type="bibr">Lefort <italic toggle="yes">et al.</italic>, 2015</xref>) to the global induced length score. Note that, at each step, the original FastME algorithm evaluates all possible SPR moves, but only applies the best one. To accelerate convergence, Asteroid simultaneously applies all non-conflicting SPR moves that improve the global induced length. We discuss the asymptotic runtime of Asteroid in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
    </sec>
    <sec>
      <title>2.5 Multi-copy and multifurcating gene trees</title>
      <p>Asteroid supports both multi-copy and multifurcating input gene trees. When a gene tree covers the same species strictly more than once, we compute the corresponding gene tree distance matrix using the MiniNJ approach (<xref rid="btac832-B19" ref-type="bibr">Morel <italic toggle="yes">et al.</italic>, 2022</xref>): the distance between two species is the minimum internode distance among all gene leaves that are mapped to those two species. Accounting for polytomies in the gene trees does not require any change in the Asteroid algorithm, because the internode distance is also well defined for multifurcating gene trees.</p>
    </sec>
    <sec>
      <title>2.6 Support value estimation</title>
      <p>To assess confidence in the inferred species tree, Asteroid computes branch support values via multi-locus bootstrapping (<xref rid="btac832-B27" ref-type="bibr">Seo, 2008</xref>). Let <italic toggle="yes">K</italic> be the number of gene trees used to infer the best scoring tree, let <italic toggle="yes">m</italic> be the user-given number of bootstrap species trees to compute, and let <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> be a set of user-provided bootstrap gene trees. Note that, <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> can also be set to <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:math></inline-formula>, the set of gene trees used to infer the best-scoring tree. At every iteration, Asteroid builds a bootstrap replicate by sampling <italic toggle="yes">K</italic> gene trees from <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">G</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> with replacement, and then computes a bootstrap species tree from this replicate. It repeats the procedure <italic toggle="yes">m</italic> times to infer <italic toggle="yes">m</italic> bootstrap species trees. Then, it applies the Felsenstein bootstrap algorithm (<xref rid="btac832-B6" ref-type="bibr">Felsenstein, 1985</xref>) to compute the branch support values on the best-scoring species tree.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Experiments</title>
    <sec>
      <title>3.1 Tested methods</title>
      <p>We compared Asteroid with four competing algorithms: ASTRAL-III, ASTER (<xref rid="btac832-B41" ref-type="bibr">Zhang and Mirarab, 2022</xref>), FastRFS and ASTRID. ASTER is a new implementation of ASTRAL that uses a different search strategy which is more robust to missing data, both in terms of runtime and accuracy (<xref rid="btac832-B41" ref-type="bibr">Zhang and Mirarab, 2022</xref>). We ran all the experiments on the same machine with 40 physical cores and 754GB of main memory. Asteroid, ASTRAL-III and ASTER offer a parallel implementation, but for a fair comparison, all reported runtimes were obtained by running the tools <italic toggle="yes">without</italic> parallelization in sequential mode. However, in experiments that do not focus on runtime performance, we occasionally executed the parallel versions of Asteroid, ASTRAL-III [ASTRAL-MP (<xref rid="btac832-B36" ref-type="bibr">Yin <italic toggle="yes">et al.</italic>, 2019</xref>)] and ASTER for the sake of convenience. Furthermore, the reported runtimes for Asteroid do not include bootstrap tree computations. We ran the FastME version of ASTRID with both NNI and SPR moves (-s option). We did not run the BioNJ version of ASTRID, which attempts to account for missing data, because the developers recommend not to use it (<ext-link xlink:href="https://github.com/pranjalv123/ASTRID/blob/2dacaf4c827f915f79d6b4f47434037521b2a575/README.md" ext-link-type="uri">https://github.com/pranjalv123/ASTRID/blob/2dacaf4c827f915f79d6b4f47434037521b2a575/README.md</ext-link>) and removed it from the tool. We ran the unweighted version of ASTER. We ran Asteroid with both the option -r 0 (which infers the starting tree with the ASTRID algorithm) and the option -r 1 (which generates a random starting tree). We only report the results with the -r 0 option because both modes yield the same average accuracy for the experiments on simulated datasets, and identical trees for the experiments on empirical datasets.</p>
    </sec>
    <sec>
      <title>3.2 Dataset simulation</title>
      <p>We generated simulated datasets with SimPhy (<xref rid="btac832-B15" ref-type="bibr">Mallo <italic toggle="yes">et al.</italic>, 2016</xref>) to assess the influence of various model parameters on the reconstruction accuracy of the tested methods.</p>
      <p>The parameters we studied are: the level of missing data, the level of discordance due to ILS, the number of gene trees, the number of species, the average sequence length, and the <italic toggle="yes">gene tree branch length scaler</italic>. The gene tree branch length scaler is used to post-process the gene trees generated with SimPhy in order to rescale their branch lengths. This allows us to increase or decrease the expected average number of substitution per site when simulating the sequences. The level of discordance due to ILS is defined as the average RF distance between the true gene trees and the true species tree <italic toggle="yes">before</italic> deleting genes.</p>
      <p>For each gene, we sampled the sequence length from a log-normal distribution (with, by default, 100 sites per sequence on average).</p>
      <p>To simulate missing data, we randomly sampled gene sequences from the simulated datasets. In a first step, we assigned to each species <italic toggle="yes">a</italic> a deletion probability <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and to each gene <italic toggle="yes">k</italic> a deletion probability <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In a second step, we deleted every gene sequence belonging to gene <italic toggle="yes">k</italic> and species <italic toggle="yes">a</italic> from the initial dataset with probability <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. When a species was not covered by any gene, we removed it from the reference species tree. When a gene contained fewer than 4 gene sequences, we excluded it from the dataset. We sampled the probabilities <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from a Beta distribution, because this distribution yields values between 0 and 1, allows for generating various and highly distinct distribution shapes, and matches our observations on empirical missing data patterns, as we show in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. In order to better control the average proportion of missing data, we used a re-parametrization <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mo>μ</mml:mo><mml:mo>,</mml:mo><mml:mo>ν</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of the standard Beta distribution <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mo>μ</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mo>α</mml:mo><mml:mrow><mml:mo>α</mml:mo><mml:mo>+</mml:mo><mml:mo>β</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> is the mean and <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mo>ν</mml:mo><mml:mo>=</mml:mo><mml:mo>α</mml:mo><mml:mo>+</mml:mo><mml:mo>β</mml:mo></mml:mrow></mml:math></inline-formula> the sample size of the distribution.</p>
      <p>We inferred the gene trees with ParGenes (<xref rid="btac832-B18" ref-type="bibr">Morel <italic toggle="yes">et al.</italic>, 2018</xref>), performing one RAxML-NG maximum likelihood search from a single random starting tree per gene under the general time reversible model of nucleotide substitution with four discrete gamma rates (GTR+G4) (<xref rid="btac832-B28" ref-type="bibr">Tavaré <italic toggle="yes">et al.</italic>, 1986</xref>; <xref rid="btac832-B35" ref-type="bibr">Yang, 1993</xref>). We performed gene tree inferences <italic toggle="yes">after</italic> the gene sequence deletion step. Then, we inferred the species trees with all tested tools from this set of inferred gene trees.</p>
    </sec>
    <sec>
      <title>3.3 Effect of missing data distribution</title>
      <p>In this first experiment, we studied how missing data affects the tested methods in the absence of ILS. We selected a default set of simulation parameters and applied different random distributions of taxon deletion. The default parameters are: 50 species, 200 genes, 100 sites per sequence (on average) and no ILS. We provide a more detailed description of the simulation parameters in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
      <p>We first studied the effect of missing data under heterogeneous deletion probabilities across <italic toggle="yes">species</italic>. We set <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> (no per-gene deletion) and drew the per-species deletion probabilities <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for different values of <italic toggle="yes">μ<sub>s</sub></italic>.</p>
      <p>Then, we studied the effect of missing data under heterogeneous deletion probabilities across <italic toggle="yes">genes</italic>. We set <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and drew the per-gene deletion probability <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for different values of <italic toggle="yes">μ<sub>f</sub></italic>.</p>
      <p>Finally, we studied the effect of missing data under heterogeneous deletion probabilities across both, genes and species. We drew both <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mo>μ</mml:mo><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for different values of <italic toggle="yes">μ</italic>. Since we apply two deletion steps (per-species and per-gene), the resulting mean proportion of missing data is <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>3.4 Effect of remaining simulation parameters</title>
      <p>In this second experiment, we studied the effect of the remaining simulation parameters in the presence of ILS for high proportions of missing data. We defined a default set of simulation parameters, and varied each parameter individually. The default parameters are: 50 species, 1000 genes, 100 sites per sequence (on average) and a population size of 500 000 000 (average level of discordance: 0.18). The parameters that we varied were the number of species, the average sequence length, the average proportion of missing data, the level of discordance due to ILS (controlled by the population size parameter in SimPhy), the number of genes and the gene tree branch length scaling factor. We provide a detailed list of the simulation parameters in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. By default, <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math></inline-formula>, which means that we first removed 60% of the gene sequences under heterogeneous deletion probabilities across species, and then 60% of the remaining gene sequences under heterogeneous deletion probabilities across genes. This means that we removed on average 84% of the genes.</p>
    </sec>
    <sec>
      <title>3.5 Empirical datasets</title>
      <p>We studied the performance of the tested methods on three different phylogenomic datasets: a plant dataset with 81 species, a vertebrate dataset with 179 species and a dataset with 92 Eukaryote and Archaea species. We generated two versions of each of these three datasets: the <italic toggle="yes">single</italic> datasets only contain the initial single-copy gene trees. We generated the <italic toggle="yes">disco</italic> datasets by inferring or extracting multi-copy gene trees, and subsequently decomposing them into single-copy gene trees using DISCO (<xref rid="btac832-B34" ref-type="bibr">Willson <italic toggle="yes">et al.</italic>, 2022</xref>). We only kept the gene trees covering at least four different species. <xref rid="btac832-T1" ref-type="table">Table 1</xref> summarizes the dimensions of the resulting six datasets. Finally, in order to study the effect of an increasing proportion of missing genes, we filtered out the most gappy gene sequences from the vertebrates single-copy gene alignments using different threshold values.</p>
      <table-wrap position="float" id="btac832-T1">
        <label>Table 1.</label>
        <caption>
          <p>Description of the empirical datasets used in our benchmark</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Dataset</th>
              <th align="center" rowspan="1" colspan="1">Gene trees</th>
              <th align="center" rowspan="1" colspan="1">Gene leaves</th>
              <th align="center" rowspan="1" colspan="1">Av. coverage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">Life92-single</italic>
              </td>
              <td rowspan="1" colspan="1">3199</td>
              <td rowspan="1" colspan="1">33 489</td>
              <td rowspan="1" colspan="1">0.11</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">Life92-disco</italic>
              </td>
              <td rowspan="1" colspan="1">24 066</td>
              <td rowspan="1" colspan="1">242 358</td>
              <td rowspan="1" colspan="1">0.11</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">Plants81-single</italic>
              </td>
              <td rowspan="1" colspan="1">6176</td>
              <td rowspan="1" colspan="1">38 521</td>
              <td rowspan="1" colspan="1">0.077</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">Plants81-disco</italic>
              </td>
              <td rowspan="1" colspan="1">87 511</td>
              <td rowspan="1" colspan="1">1 455 353</td>
              <td rowspan="1" colspan="1">0.21</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">Vertebrates179-single</italic>
              </td>
              <td rowspan="1" colspan="1">8205</td>
              <td rowspan="1" colspan="1">127 720</td>
              <td rowspan="1" colspan="1">0.087</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">Vertebrates179-disco</italic>
              </td>
              <td rowspan="1" colspan="1">79 143</td>
              <td rowspan="1" colspan="1">3 258 608</td>
              <td rowspan="1" colspan="1">0.23</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic toggle="yes">Note</italic>: Dataset names are suffixed by the number of species in the respective dataset. Gene trees is the number of gene trees. Gene leaves is the total number of gene tree leaves. Av. coverage is the average proportion of species covered by each gene tree.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>We noticed that in some cases, ASTRAL-III failed to find the species tree with the optimal quartet score. Thus, for every dataset, we performed an additional ASTRAL-III run and extended its search space with the splits from the species tree inferred with Asteroid. In Section 4, we only report the cases where this more thorough search resulted in a different tree than with the default ASTRAL-III search settings.</p>
      <sec>
        <title>3.5.1 Eukaryote and Archaea dataset</title>
        <p>The dataset <italic toggle="yes">Life92-single</italic> consists of 3199 single-copy gene trees covering 92 species from the Eukaryote and Archaea domains. The corresponding gene trees were inferred in a previous study (<xref rid="btac832-B33" ref-type="bibr">Williams <italic toggle="yes">et al.</italic>, 2020</xref>). We extracted the <italic toggle="yes">Life92-disco</italic> dataset from 41 222 multi-copy gene trees that we had also inferred in another study (<xref rid="btac832-B19" ref-type="bibr">Morel <italic toggle="yes">et al.</italic>, 2022</xref>). We applied DISCO to those gene trees to obtain 24 066 single-copy gene trees. The number of single-copy gene trees is lower than the number of input multi-copy gene trees because we filtered out the gene trees that consist of less than four distinct species.</p>
      </sec>
      <sec>
        <title>3.5.2 Plant dataset</title>
        <p>The dataset <italic toggle="yes">Plants81-single</italic> consists of 6176 single-copy gene trees covering 81 plant species. We extracted the corresponding gene multiple sequence alignments from release 59 of the Ensembl Plants database (<xref rid="btac832-B3" ref-type="bibr">Bolser <italic toggle="yes">et al.</italic>, 2016</xref>). Then, we inferred the gene trees with ParGenes, performing one RAxML-NG maximum likelihood search from a single random starting tree per gene under the LG+G model (<xref rid="btac832-B11" ref-type="bibr">Le and Gascuel, 2008</xref>). We also extracted 51 461 multi-copy gene sequence alignments from the same database, and inferred the corresponding gene trees with ParGenes, again performing one RAxML-NG maximum likelihood search from a single random starting tree per gene under the LG+G model. We obtained the <italic toggle="yes">Plants81-disco</italic> dataset by decomposing these multi-copy gene trees into 87 511 single-copy gene trees with DISCO.</p>
      </sec>
      <sec>
        <title>3.5.3 Vertebrate dataset</title>
        <p>The dataset <italic toggle="yes">Vertebrates179-single</italic> consists of 8205 gene trees covering 179 vertebrate species. We extracted the single-copy multiple sequence alignments from release 105 of the Ensembl Compara database (<xref rid="btac832-B40" ref-type="bibr">Zerbino <italic toggle="yes">et al.</italic>, 2018</xref>). We also generated several filtered datasets by removing gene sequences with a proportion of gaps exceeding a threshold value <italic toggle="yes">τ</italic> for different values of <italic toggle="yes">τ</italic>. The filtered datasets are described in <xref rid="btac832-T2" ref-type="table">Table 2</xref>. We also extracted all 33 809 multi-copy sequence alignments from the Ensembl database, inferred the corresponding gene trees and applied DISCO to obtain the <italic toggle="yes">Vertebrates179-disco</italic> dataset with 79 143 single-copy gene trees. We inferred all gene trees (from the single-copy, multi-copy and filtered alignments) with ParGenes, performing one RAxML-NG maximum likelihood search from a single random starting tree per locus under the GTR+G model.</p>
        <table-wrap position="float" id="btac832-T2">
          <label>Table 2.</label>
          <caption>
            <p>Dimensions of the datasets obtained by filtering gene sequences of the <italic toggle="yes">Vertebrates179-single</italic> that exhibit a proportion of non-gap characters below <italic toggle="yes">τ</italic> (<italic toggle="yes">τ </italic>= 0 corresponds to the unfiltered dataset)</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col valign="top" align="left" span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Filter</th>
                <th align="center" rowspan="1" colspan="1">Gene trees</th>
                <th align="center" rowspan="1" colspan="1">Gene leaves</th>
                <th align="center" rowspan="1" colspan="1">Av. coverage</th>
                <th align="center" rowspan="1" colspan="1">Terrace size</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1"><italic toggle="yes">τ </italic>= 0</td>
                <td rowspan="1" colspan="1">8205</td>
                <td rowspan="1" colspan="1">127 720</td>
                <td rowspan="1" colspan="1">0.087</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE44">
                    <mml:math id="IM44" display="inline" overflow="scroll">
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0.2</mml:mn>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
                <td rowspan="1" colspan="1">8059</td>
                <td rowspan="1" colspan="1">123 988</td>
                <td rowspan="1" colspan="1">0.086</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE45">
                    <mml:math id="IM45" display="inline" overflow="scroll">
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0.4</mml:mn>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
                <td rowspan="1" colspan="1">7320</td>
                <td rowspan="1" colspan="1">99 358</td>
                <td rowspan="1" colspan="1">0.076</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE46">
                    <mml:math id="IM46" display="inline" overflow="scroll">
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0.5</mml:mn>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
                <td rowspan="1" colspan="1">6544</td>
                <td rowspan="1" colspan="1">79 884</td>
                <td rowspan="1" colspan="1">0.068</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE47">
                    <mml:math id="IM47" display="inline" overflow="scroll">
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0.6</mml:mn>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
                <td rowspan="1" colspan="1">5348</td>
                <td rowspan="1" colspan="1">57 892</td>
                <td rowspan="1" colspan="1">0.060</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE48">
                    <mml:math id="IM48" display="inline" overflow="scroll">
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0.7</mml:mn>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
                <td rowspan="1" colspan="1">3817</td>
                <td rowspan="1" colspan="1">37 811</td>
                <td rowspan="1" colspan="1">0.055</td>
                <td rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE49">
                    <mml:math id="IM49" display="inline" overflow="scroll">
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0.8</mml:mn>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
                <td rowspan="1" colspan="1">2382</td>
                <td rowspan="1" colspan="1">22 008</td>
                <td rowspan="1" colspan="1">0.051</td>
                <td rowspan="1" colspan="1">3</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">
                  <inline-formula id="IE50">
                    <mml:math id="IM50" display="inline" overflow="scroll">
                      <mml:mrow>
                        <mml:mo>τ</mml:mo>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0.9</mml:mn>
                      </mml:mrow>
                    </mml:math>
                  </inline-formula>
                </td>
                <td rowspan="1" colspan="1">1128</td>
                <td rowspan="1" colspan="1">9941</td>
                <td rowspan="1" colspan="1">0.049</td>
                <td rowspan="1" colspan="1">&gt;1M</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn id="tblfn2">
              <p><italic toggle="yes">Note</italic>: Gene trees is the number of gene trees. Gene leaves is the total number of gene tree leaves (summed over all the gene trees). Av. coverage is the average proportion of species covered by each gene tree. Terrace size is the number of species trees that have the same global induced length as the Asteroid tree (see the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for more details about terrace computation).</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>We generated a multifurcating reference species tree by starting from the NCBI tree of the 179 species, and contracting the splits that were contradicted by at least one of the tested tools <italic toggle="yes">and</italic> by several independent studies. We describe the five splits that we contracted in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Results</title>
    <p>In the following, we present the results of our experiments. All data and inferred trees are available at <ext-link xlink:href="https://cme.h-its.org/exelixis/material/asteroid_data.tar.gz" ext-link-type="uri">https://cme.h-its.org/exelixis/material/asteroid_data.tar.gz</ext-link>.</p>
    <sec>
      <title>4.1 Effect of missing data in the absence of ILS</title>
      <p>We summarize the results of the simulated data experiment without ILS in <xref rid="btac832-F2" ref-type="fig">Figure 2</xref>. We first remark that for the same mean proportion of missing data, all methods are substantially more sensitive to heterogeneous taxon deletion probabilities across species than across genes. For instance, for simulations with 80% of missing data, the average RF distance between the Asteroid species trees and the true species tree is 0.23 when all species have the same average coverage, and 0.55 when species have a different average coverage. A potential explanation is that with per-species missing data heterogeneity, some species are sampled in very few genes, and are thus very difficult to place. Among-taxa variation in the proportion of missing data is common in empirical datasets because of species- or clade-specific differences in patterns of genome evolution, such as elevated rates of gene loss and genome reduction in host-associated microbes (<xref rid="btac832-B16" ref-type="bibr">McCutcheon and Moran, 2011</xref>). This result indicates that such patterns are likely to be particularly challenging for accurate species tree inference. For all simulation parameters in this first experiment, we observe the same trend: all tested methods perform analogously for low proportions of missing data (less than 50%). For high proportions of missing data, Asteroid performs better than ASTRAL-III, ASTER and FastRFS. astrid performs considerably worse than all other methods. For instance, for the highest proportions of missing data with heterogeneous rates across both species and genes, Asteroid finds the most accurate trees (<italic toggle="yes">RF </italic>=<italic toggle="yes"> </italic>0.51), followed by FastRFS (<italic toggle="yes">RF </italic>=<italic toggle="yes"> </italic>0.59), ASTER (<italic toggle="yes">RF </italic>=<italic toggle="yes"> </italic>0.61), ASTRAL-III (<italic toggle="yes">RF </italic>=<italic toggle="yes"> </italic>0.61) and ASTRID (<italic toggle="yes">RF </italic>=<italic toggle="yes"> </italic>0.91).</p>
      <fig position="float" id="btac832-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Average unrooted RF distance between inferred and true species trees in the absence of ILS for varying proportions of missing data. Remember that the per-gene deletion probability <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is drawn from <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and that the per-species deletion probability <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is drawn from <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In the third plot, the total number of deleted genes is the combination of the per species and the per gene deletion rates, and ranges on average from 0% to 84%</p>
        </caption>
        <graphic xlink:href="btac832f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>4.2 Effect of various parameters under high proportions of missing data</title>
      <p>We summarize the results of the simulated data experiment with high proportions of missing data in <xref rid="btac832-F3" ref-type="fig">Figure 3</xref>. We observe the same trend as in the previous experiment: Asteroid is the most accurate method under most simulation parameters. FastRFS, ASTER and ASTRAL-III perform similarly. ASTRID is considerably less accurate. The difference between the methods increases for increasing proportions of missing data, until the RF distance becomes saturated. All tools achieve better performance when the number of genes increases and when the gene tree reconstruction error decreases. The gene tree discordance due to ILS negatively affects reconstruction accuracy for all methods, but affects all of them similarly. Finally, the number of species does not appear to affect the average RF distance to the true tree.</p>
      <fig position="float" id="btac832-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Average unrooted RF distance between inferred and true species trees for high levels of missing data (by default, 84% of missing data)</p>
        </caption>
        <graphic xlink:href="btac832f3" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>4.3 Plants81 biological dataset</title>
      <p>On the Plants81-single dataset, Asteroid recovers a tree that is in good agreement with the reference taxonomy and a series of recent studies (<xref rid="btac832-B7" ref-type="bibr">Harris <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac832-B8" ref-type="bibr">Initiative, 2019</xref>; <xref rid="btac832-B21" ref-type="bibr">Puttick <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac832-B32" ref-type="bibr">Wickett <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btac832-B39" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic>, 2014</xref>), with the exception of three specific branches.</p>
      <p>First, it places Rosales within Malvids instead of within Fabids. Second, it places <italic toggle="yes">Daucus carota</italic> within Ericales instead of Campanulids. Finally, it places the Streptophyta clade between the two Chlorophyta species (<italic toggle="yes">Chlamydomonas</italic> and <italic toggle="yes">Ostreococcus</italic>), which traditionally form a monophyletic clade. All these conflicts are local (i.e. they only affect one branch) and the remaining splits are in agreement with the taxonomy. ASTRID, ASTER, ASTRAL-III and FastRFS all fail to infer a plausible tree and contradict the taxonomy tree on numerous and diverse splits that we do not list here. The RF distance to the NCBI taxonomy is 0.09 for Asteroid, 0.22 for ASTER, 0.30 for ASTRAL-III, 0.37 for FastRFS and 0.65 for ASTRID. We also attempted to run ASTRAL-III by extending its search space by the bipartitions of the species tree inferred with Asteroid, resulting in another tree with a higher quartet scores, and a RF distance to the taxonomy of 0.1.</p>
      <p>On the Plants81-disco dataset, both Asteroid and ASTRID find highly similar trees, in agreement with recent literature (<xref rid="btac832-B7" ref-type="bibr">Harris <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac832-B8" ref-type="bibr">Initiative, 2019</xref>; <xref rid="btac832-B21" ref-type="bibr">Puttick <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac832-B32" ref-type="bibr">Wickett <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btac832-B39" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic>, 2014</xref>). The Asteroid tree is presented in <xref rid="btac832-F4" ref-type="fig">Figure 4</xref>. The tree inferred by ASTRAL-III, ASTER and FastME contradict the literature on one split among red alga, placing <italic toggle="yes">Chondrus crispus</italic> (Gigartinales) between <italic toggle="yes">Galdieria sulphuraria</italic> and <italic toggle="yes">Cyanidioschyzon merolae</italic> (Cyanidiales). On the disco dataset, all tested methods recover one relationship that, based on the literature (<xref rid="btac832-B7" ref-type="bibr">Harris <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac832-B8" ref-type="bibr">Initiative, 2019</xref>; <xref rid="btac832-B21" ref-type="bibr">Puttick <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac832-B32" ref-type="bibr">Wickett <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btac832-B39" ref-type="bibr">Zeng <italic toggle="yes">et al.</italic>, 2014</xref>), is unlikely to be correct: they recover the lycophyte <italic toggle="yes">Selaginella</italic> as sister to the bryophytes, rather than as sister to the euphyllophytes (angiosperms and ferns). This result might reflect the sparse sampling of bryophytes and lycophytes in the Plants81 dataset.</p>
      <fig position="float" id="btac832-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Species tree inferred with Asteroid from the Plants81-disco dataset. We placed the root manually. We only show support values below 100%. In red, we show the Malpighiales clade that is placed within Fabids in the NCBI taxonomy but within Malvids in all trees we inferred</p>
        </caption>
        <graphic xlink:href="btac832f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>4.4 Life92 biological dataset</title>
      <p>The Life92 dataset consists of representative genomes from the known major clades of eukaryotes and Archaea; some of the relationships among these groups are uncertain, while for others there is an emerging consensus in the literature. The Asteroid and FastRFS trees inferred from the Life92-single dataset are in good agreement with recent analyses using complex substitution models on protein concatenations (<xref rid="btac832-B13" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac832-B33" ref-type="bibr">Williams <italic toggle="yes">et al.</italic>, 2020</xref>). Based on the assumption that the tree is rooted elsewhere within the Archaea, Asteroid and FastRFS recover a sister-group relationship between Asgardarchaeota and eukaryotes [rather than a specific relationship between Heimdallarchaeota and eukaryotes (<xref rid="btac832-B33" ref-type="bibr">Williams <italic toggle="yes">et al.</italic>, 2020</xref>)]. The TACK (Thaumarchaeota, Aigarchaeota, Crenarchaeota and Korarchaeota) lineages are recovered as being monophyletic. Within eukaryotes, the metamonads are recovered as the group most distantly related to other eukaryotes, with the metamonad <italic toggle="yes">Trimastix marina</italic> branching between the other metamonads and the remaining eukaryotes (<xref rid="btac832-B33" ref-type="bibr">Williams <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
      <p>The ASTRAL-III tree is similar to the Asteroid, ASTER and FastRFS trees, but provides only weak support (0.16) for the monophyly of Asgardarchaeota; this does not imply that the method is less accurate, because the monophyly of Asgardarchaeota with respect to eukaryotes is currently uncertain (<xref rid="btac832-B13" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac832-B33" ref-type="bibr">Williams <italic toggle="yes">et al.</italic>, 2020</xref>). The ASTRAL-III, ASTER and ASTRID trees fail to recover the monophyly of the SAR (Stramenopiles, Alveolates and Rhizarians) clade of eukaryotes, for which there is reasonable phylogenomic support (<xref rid="btac832-B4" ref-type="bibr">Burki <italic toggle="yes">et al.</italic>, 2020</xref>). In addition, the ASTRID tree does not recover a specific relationship between Asgardarchaeota and eukaryotes, instead placing the Bathy- and Thaumarchaeota closest to the eukaryote stem in the unrooted tree.</p>
      <p>Results with the Life92-disco dataset were broadly similar, with some exceptions. The Asteroid and FastRFS trees recover a clade of metamonads and discobans (monophyletic excavates), while ASTRAL-III, ASTER and ASTRID support excavate paraphyly, with metamonads the earliest-diverging lineage within eukaryotes. ASTRAL-III and ASTER fail to recover the monophyly of Asgardarchaeota, placing Odinarchaeota with the TACK+Euryarchaeota—a relationship that disagrees with published analyses (<xref rid="btac832-B13" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac832-B33" ref-type="bibr">Williams <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac832-B38" ref-type="bibr">Zaremba-Niedzwiedzka <italic toggle="yes">et al.</italic>, 2017</xref>), while ASTRID again fails to recover Asgardarchaeota as the closest relatives of eukaryotes in the unrooted tree.</p>
    </sec>
    <sec>
      <title>4.5 Vertebrates179 biological dataset</title>
      <p>On the Vertebrates179-single dataset, Asteroid, FastRFS and ASTRAL-III perfectly agree with the reference tree. ASTRID contradicts the reference tree on four splits. ASTER places <italic toggle="yes">Eptatetrus burgeri</italic> within <italic toggle="yes">Actinopterygii</italic>, seven branches away from its expected position (within <italic toggle="yes">Agnatha</italic>). Interestingly, the tree inferred with ASTER has a better quartet score (1391504548) than the tree inferred with ASTRAL-III (1391471298).</p>
      <p>On the Vertebrates179-disco dataset, Asteroid, ASTER, ASTRID and ASTRAL-III all agree with the reference tree, except for one split: the elephant shark (<italic toggle="yes">Chondrichtyian</italic>), is placed within <italic toggle="yes">Osteicthyians</italic>, as sister to <italic toggle="yes">Sarcopterygii</italic>. This placement is likely to be incorrect because it contradicts the current consensus about elephant shark placement in the tree of life (<xref rid="btac832-B31" ref-type="bibr">Venkatesh <italic toggle="yes">et al.</italic>, 2014</xref>). Interestingly, we found the same placement in another study (<xref rid="btac832-B19" ref-type="bibr">Morel <italic toggle="yes">et al.</italic>, 2022</xref>) that compared several multi-copy gene methods on the same dataset, suggesting a bias in the multi-copy gene trees. Due to excessive runtimes, we stopped FastRFS after one month of execution.</p>
      <p>We then studied the effect of filtering out the gene sequences that exhibit a proportion of non-gap characters below <italic toggle="yes">τ</italic> for different values of <italic toggle="yes">τ</italic>. When <italic toggle="yes">τ</italic> increases, the number of deleted genes also increases, as we report in <xref rid="btac832-T2" ref-type="table">Table 2</xref>. As we show in <xref rid="btac832-F5" ref-type="fig">Figure 5</xref>, Asteroid is substantially more robust to this filtering strategy than the competing methods. It infers trees that are very close to the reference tree (normalized RF &lt; 0.013) for values of <italic toggle="yes">τ</italic> ranging between 0.0 and 0.6, while the other methods (with the exception of ASTER), start diverging from the reference tree at <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mo>τ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn></mml:mrow></mml:math></inline-formula>. For instance, for <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mo>τ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:math></inline-formula>, the normalized RF distance to the reference tree is 0.006 for Asteroid (one mismatching branch), 0.027 for ASTER, 0.28 for ASTRAL-III and FastRFS, and 0.59 for ASTRID. The RF distance between the Asteroid and the reference trees only starts to drastically increase for <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mo>τ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula> (<italic toggle="yes">RF </italic>=<italic toggle="yes"> </italic>0.36, against <italic toggle="yes">RF </italic>=<italic toggle="yes"> </italic>0.09 for <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mo>τ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>). This was expected, because the dataset with <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mo>τ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula> is indecisive with very large terrace sizes (more than 1 000 000 trees have the same optimal global induced length). Note that, when adding the Asteroid tree bipartitions to its search space, ASTRAL-III is able to recover the same tree as Asteroid for all filtered datasets. This again indicates that the current ASTRAL-III search strategy might be sub-optimal under high proportions of missing data. ASTER is more robust to increasing <italic toggle="yes">τ</italic> than ASTRAL-III, but infers trees that are more distant to the reference phylogeny than the trees inferred with Asteroid for almost all values of <italic toggle="yes">τ</italic>.</p>
      <fig position="float" id="btac832-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>RF distance between the inferred and reference species tree for the dataset Vertebrates179 for different gap ratio thresholds</p>
        </caption>
        <graphic xlink:href="btac832f5" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>4.6 Runtimes</title>
      <p>We report the runtimes of the tested methods on the different empirical datasets in <xref rid="btac832-T3" ref-type="table">Table 3</xref>. ASTRID is the fastest method for most datasets. Asteroid is only four times slower than ASTRID in the worse case. On the disco datasets, Asteroid is more than two orders of magnitude faster than ASTRAL-III and ASTER, and three orders of magnitude faster than FastRFS.</p>
      <table-wrap position="float" id="btac832-T3">
        <label>Table 3.</label>
        <caption>
          <p>Sequential runtimes of the distinct methods on empirical datasets</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Dataset</th>
              <th rowspan="1" colspan="1">FastRFS</th>
              <th rowspan="1" colspan="1">ASTRAL-III</th>
              <th rowspan="1" colspan="1">ASTER</th>
              <th rowspan="1" colspan="1">ASTRID</th>
              <th rowspan="1" colspan="1">Asteroid</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">Plants81-single</italic>
              </td>
              <td rowspan="1" colspan="1">135 s</td>
              <td rowspan="1" colspan="1">52 s</td>
              <td rowspan="1" colspan="1">418 s</td>
              <td rowspan="1" colspan="1">2 s</td>
              <td rowspan="1" colspan="1">2 s</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">Plants81-disco</italic>
              </td>
              <td rowspan="1" colspan="1">653 045 s</td>
              <td rowspan="1" colspan="1">48 530 s</td>
              <td rowspan="1" colspan="1">9681 s</td>
              <td rowspan="1" colspan="1">32 s</td>
              <td rowspan="1" colspan="1">134 s</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">Life92-single</italic>
              </td>
              <td rowspan="1" colspan="1">177 s</td>
              <td rowspan="1" colspan="1">12 s</td>
              <td rowspan="1" colspan="1">19 s</td>
              <td rowspan="1" colspan="1">1.5 s</td>
              <td rowspan="1" colspan="1">2 s</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">Life92-disco</italic>
              </td>
              <td rowspan="1" colspan="1">55 859 s</td>
              <td rowspan="1" colspan="1">11 363 s</td>
              <td rowspan="1" colspan="1">2183 s</td>
              <td rowspan="1" colspan="1">10 s</td>
              <td rowspan="1" colspan="1">15 s</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">Vertebrates179-single</italic>
              </td>
              <td rowspan="1" colspan="1">1635 s</td>
              <td rowspan="1" colspan="1">481 s</td>
              <td rowspan="1" colspan="1">71 s</td>
              <td rowspan="1" colspan="1">32 s</td>
              <td rowspan="1" colspan="1">13 s</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <italic toggle="yes">Vertebrates179-disco</italic>
              </td>
              <td rowspan="1" colspan="1">&gt;1 month</td>
              <td rowspan="1" colspan="1">283 761 s</td>
              <td rowspan="1" colspan="1">61 671 s</td>
              <td rowspan="1" colspan="1">171s</td>
              <td rowspan="1" colspan="1">563 s</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn3">
            <p><italic toggle="yes">Note</italic>: Asteroid first estimates a starting tree with our implementation of the ASTRID algorithm and then applies the tree search algorithm presented in Section 2. We terminated FastRFS on Vertebrates179-disco after one month. The reported runtimes do not include the time needed to estimate the gene trees.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>5 Discussion</title>
    <p>Our experiments on both simulated and empirical data suggest that Asteroid is more robust to missing data than the competing methods. In particular, ASTRID performs substantially worse than all other methods for large proportions of missing data.</p>
    <p>The sub-optimal performance of ASTRID for high proportions of missing data (in comparison with other methods) is likely due to the missing data bias that we illustrate in <xref rid="btac832-F1" ref-type="fig">Figure 1</xref>: the values in the internode distance matrix computed by ASTRID underestimate the internode distance matrix of the true species tree. If the amplitude of this underestimation substantially differs from one pair of species to another, the distance matrix used by ASTRID will inevitably induce an incorrect species tree.</p>
    <p>Surprisingly, our experiments also showed that Asteroid outperforms ASTRAL-III, ASTER and FastRFS for large proportions of missing data. Unlike ASTRID, there is, to our knowledge, no reason to believe that the scores used by ASTRAL-III, ASTER and FastRFS are biased in presence of missing data. Indeed, our proof that the global induced length is consistent under the MSC and any random of model of taxon deletion can also be adapted to the quartet score (ASTRAL-III and ASTER) and to the RF distance between the gene trees and the species tree (FastRFS). An important difference between Asteroid and the other methods is the heuristic used to explore candidate species trees. Both ASTRAL-III and FastRFS rely on the same search heuristic that consists in exploring all the species trees whose bipartitions are present in the input gene trees. Although ASTRAL-III deploys some strategies to accommodate incomplete gene trees when building the set of induced bipartitions (<xref rid="btac832-B42" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2018</xref>), we showed in the empirical experiments that ASTRAL-III might find a sub-optimal tree. Although there is no theoretical guarantee that it will find the best-scoring tree, the tree search heuristic implemented in Asteroid appears to be less affected by missing data, which might explain its good accuracy.</p>
    <p>We note, however, that the differences between all tested methods decrease with increasing numbers of input gene trees. In particular, all methods inferred reasonable species trees for the three empirical datasets when using all the available data (by decomposing multi-copy gene trees into single-copy gene trees). We also observed the same trend under simulations: all methods find increasingly accurate species trees when the number of families increases, even under high proportions of missing data. Nonetheless, it is impossible to know how many gene trees are sufficient to alleviate the effects of missing data. In addition, it has been shown that, under specific conditions and for some models of taxon deletion, ASTRID is guaranteed to converge to an incorrect species tree when the number of gene trees increases asymptotically (<xref rid="btac832-B23" ref-type="bibr">Rhodes <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
    <p>In terms of runtime, Asteroid has a clear advantage over ASTRAL-III, ASTER and FastRFS for datasets with a large number of genes: it is up to two orders of magnitude faster than ASTRAL-III and ASTER, and up to three orders of magnitude faster than FastRFS. In particular, FastRFS failed to infer the Vertebrates179-disco species tree in less than one month, while Asteroid managed to complete within 10 min. ASTRID remains the fastest method and is at most one order of magnitude faster than Asteroid in our experiments, but at the cost of being inconsistent in the presence of ILS and missing data. It is also important to note that Asteroid can be run in parallel (unlike ASTRID and FastRFS), which might allow it to process even larger datasets in a reasonable amount of time.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac832_Supplementary_Data</label>
      <media xlink:href="btac832_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors wish to thank an anonymous reviewer for suggesting a possible hypothesis to explain our observation that all reconstruction methods are substantially more sensitive to heterogeneous taxon deletion probabilities across species than across genes.</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work was financially supported by the Klaus Tschira Foundation and by DFG grant STA 860/6-2. T.A.W. was supported by a Royal Society University Fellowship. This work was funded by the Gordon and Betty Moore Foundation [GBMF9741 to T.A.W.].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac832-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aberer</surname><given-names>A.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2013</year>) <article-title>Pruning rogue taxa improves phylogenetic accuracy: an efficient algorithm and webservice</article-title>. <source>Syst. Biol</source>., <volume>62</volume>, <fpage>162</fpage>–<lpage>166</lpage>.<pub-id pub-id-type="pmid">22962004</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aberer</surname><given-names>A.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>ExaBayes: massively parallel Bayesian tree inference for the whole-genome era</article-title>. <source>Mol. Biol. Evol</source>., <volume>31</volume>, <fpage>2553</fpage>–<lpage>2556</lpage>.<pub-id pub-id-type="pmid">25135941</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B3">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Bolser</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <part-title>Ensembl plants: integrating tools for visualizing, mining, and analyzing plant genomics data</part-title>. In: Edwards,D (ed.) <source>Plant Bioinformatics</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>New York</publisher-loc>, pp. <fpage>115</fpage>–<lpage>140</lpage>. <ext-link xlink:href="https://link.springer.com/protocol/10.1007/978-1-4939-3167-5_6#editor-information" ext-link-type="uri">https://link.springer.com/protocol/10.1007/978-1-4939-3167-5_6#editor-information</ext-link>.</mixed-citation>
    </ref>
    <ref id="btac832-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burki</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>The new tree of eukaryotes</article-title>. <source>Trends Ecol. Evol</source>., <volume>35</volume>, <fpage>43</fpage>–<lpage>55</lpage>.<pub-id pub-id-type="pmid">31606140</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>C.-L.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Phylotranscriptomics reveals extensive gene duplication in the subtribe gentianinae (gentianaceae)</article-title>. <source>J. Syst. Evol</source>., <volume>59</volume>, <fpage>1198</fpage>–<lpage>1208</lpage>.</mixed-citation>
    </ref>
    <ref id="btac832-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Felsenstein</surname><given-names>J.</given-names></string-name></person-group> (<year>1985</year>) <article-title>Confidence limits on phylogenies: an approach using the bootstrap</article-title>. <source>Evolution</source>, <volume>39</volume>, <fpage>783</fpage>–<lpage>791</lpage>.<pub-id pub-id-type="pmid">28561359</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harris</surname><given-names>B.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Phylogenomic evidence for the monophyly of bryophytes and the reductive evolution of stomata</article-title>. <source>Curr. Biol</source>., <volume>30</volume>, <fpage>2001</fpage>–<lpage>2012.e2</lpage>.<pub-id pub-id-type="pmid">32302587</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Initiative</surname><given-names>O.T.P.T.</given-names></string-name></person-group> (<year>2019</year>) <article-title>One thousand plant transcriptomes and the phylogenomics of green plants</article-title>. <source>Nature</source>, <volume>574</volume>, <fpage>679</fpage>–<lpage>685</lpage>.<pub-id pub-id-type="pmid">31645766</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kozlov</surname><given-names>A.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>RAxML-NG: a fast, scalable and user-friendly tool for maximum likelihood phylogenetic inference</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>4453</fpage>–<lpage>4455</lpage>.<pub-id pub-id-type="pmid">31070718</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lartillot</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>PhyloBayes 3: a Bayesian software package for phylogenetic reconstruction and molecular dating</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>2286</fpage>–<lpage>2288</lpage>.<pub-id pub-id-type="pmid">19535536</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Le</surname><given-names>S.Q.</given-names></string-name>, <string-name><surname>Gascuel</surname><given-names>O.</given-names></string-name></person-group> (<year>2008</year>) <article-title>An improved general amino acid replacement matrix</article-title>. <source>Mol. Biol. Evol</source>., <volume>25</volume>, <fpage>1307</fpage>–<lpage>1320</lpage>.<pub-id pub-id-type="pmid">18367465</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lefort</surname><given-names>V.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>FastME 2.0: a comprehensive, accurate, and fast distance-based phylogeny inference program: table 1</article-title>. <source>Mol. Biol. Evol</source>., <volume>32</volume>, <fpage>2798</fpage>–<lpage>2800</lpage>.<pub-id pub-id-type="pmid">26130081</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Expanded diversity of <italic toggle="yes">Asgard archaea</italic> and their relationships with eukaryotes</article-title>. <source>Nature</source>, <volume>593</volume>, <fpage>553</fpage>–<lpage>557</lpage>.<pub-id pub-id-type="pmid">33911286</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mai</surname><given-names>U.</given-names></string-name>, <string-name><surname>Mirarab</surname><given-names>S.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Treeshrink: fast and accurate detection of outlier long branches in collections of phylogenetic trees</article-title>. <source>BMC Genomics</source>, <volume>19</volume>, <fpage>23</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">29304736</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mallo</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>SimPhy: phylogenomic simulation of gene, locus, and species trees</article-title>. <source>Syst. Biol</source>., <volume>65</volume>, <fpage>334</fpage>–<lpage>344</lpage>.<pub-id pub-id-type="pmid">26526427</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCutcheon</surname><given-names>J.P.</given-names></string-name>, <string-name><surname>Moran</surname><given-names>N.A.</given-names></string-name></person-group> (<year>2011</year>) <article-title>Extreme genome reduction in symbiotic bacteria</article-title>. <source>Nat. Rev. Microbiol</source>., <volume>10</volume>, <fpage>13</fpage>–<lpage>26</lpage>.<pub-id pub-id-type="pmid">22064560</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Minh</surname><given-names>B.Q.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>IQ-TREE 2: new models and efficient methods for phylogenetic inference in the genomic era</article-title>. <source>Mol. Biol. Evol</source>., <volume>37</volume>, <fpage>1530</fpage>–<lpage>1534</lpage>.<pub-id pub-id-type="pmid">32011700</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morel</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>ParGenes: a tool for massively parallel model selection and phylogenetic tree inference on thousands of genes</article-title>. <source>Bioinformatics, <bold>39</bold>(2)</source>.</mixed-citation>
    </ref>
    <ref id="btac832-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morel</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>SpeciesRax: a tool for maximum likelihood species tree inference from gene family trees under duplication, transfer, and loss</article-title>. <source>Mol. Biol. Evol</source>., <volume>39</volume>, <fpage>msab365</fpage>.<pub-id pub-id-type="pmid">35021210</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nute</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>The performance of coalescent-based species tree estimation methods under models of missing data</article-title>. <source>BMC Genomics</source>, <volume>19</volume>, <fpage>1</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">29291715</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Puttick</surname><given-names>M.N.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>The interrelationships of land plants and the nature of the ancestral embryophyte</article-title>. <source>Curr. Biol</source>., <volume>28</volume>, <fpage>733</fpage>–<lpage>745.e2</lpage>.<pub-id pub-id-type="pmid">29456145</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rannala</surname><given-names>B.</given-names></string-name>, <string-name><surname>Yang</surname><given-names>Z.</given-names></string-name></person-group> (<year>2003</year>) <article-title>Bayes estimation of species divergence times and ancestral population sizes using DNA sequences from multiple loci</article-title>. <source>Genetics</source>, <volume>164</volume>, <fpage>1645</fpage>–<lpage>1656</lpage>.<pub-id pub-id-type="pmid">12930768</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B23">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Rhodes</surname><given-names>J.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) NJST and ASTRID are not statistically consistent under a random model of missing data. <italic toggle="yes">arXiv preprint arXiv:2001.07844.</italic></mixed-citation>
    </ref>
    <ref id="btac832-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>D.</given-names></string-name>, <string-name><surname>Foulds</surname><given-names>L.</given-names></string-name></person-group> (<year>1981</year>) <article-title>Comparison of phylogenetic trees</article-title>. <source>Math. Biosci</source>., <volume>53</volume>, <fpage>131</fpage>–<lpage>147</lpage>.</mixed-citation>
    </ref>
    <ref id="btac832-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roch</surname><given-names>S.</given-names></string-name>, <string-name><surname>Steel</surname><given-names>M.</given-names></string-name></person-group> (<year>2015</year>) <article-title>Likelihood-based tree reconstruction on a concatenation of aligned sequence data sets can be statistically inconsistent</article-title>. <source>Theor. Popul. Biol</source>., <volume>100</volume>, <fpage>56</fpage>–<lpage>62</lpage>.</mixed-citation>
    </ref>
    <ref id="btac832-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ronquist</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>MrBayes 3.2: efficient Bayesian phylogenetic inference and model choice across a large model space</article-title>. <source>Syst. Biol</source>., <volume>61</volume>, <fpage>539</fpage>–<lpage>542</lpage>.<pub-id pub-id-type="pmid">22357727</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Seo</surname><given-names>T.-K.</given-names></string-name></person-group> (<year>2008</year>) <article-title>Calculating bootstrap probabilities of phylogeny using multilocus sequence data</article-title>. <source>Mol. Biol. Evol</source>., <volume>25</volume>, <fpage>960</fpage>–<lpage>971</lpage>.<pub-id pub-id-type="pmid">18281270</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tavaré</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>1986</year>) <article-title>Some probabilistic and statistical problems in the analysis of DNA sequences</article-title>. <source>Lectures Math. Life Sci</source>., <volume>17</volume>, <fpage>57</fpage>–<lpage>86</lpage>.</mixed-citation>
    </ref>
    <ref id="btac832-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vachaspati</surname><given-names>P.</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T.</given-names></string-name></person-group> (<year>2015</year>) <article-title>ASTRID: accurate species TRees from internode distances</article-title>. <source>BMC Genomics</source>, <volume>16, S3</volume>.</mixed-citation>
    </ref>
    <ref id="btac832-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vachaspati</surname><given-names>P.</given-names></string-name>, <string-name><surname>Warnow</surname><given-names>T.</given-names></string-name></person-group> (<year>2017</year>) <article-title>FastRFS: fast and accurate Robinson-Foulds supertrees using constrained exact optimization</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>631</fpage>–<lpage>639</lpage>.<pub-id pub-id-type="pmid">27663499</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Venkatesh</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Elephant shark genome provides unique insights into gnathostome evolution</article-title>. <source>Nature</source>, <volume>505</volume>, <fpage>174</fpage>–<lpage>179</lpage>.<pub-id pub-id-type="pmid">24402279</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wickett</surname><given-names>N.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Phylotranscriptomic analysis of the origin and early diversification of land plants</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>111</volume>, <fpage>E4859</fpage>–<lpage>E4868</lpage>.<pub-id pub-id-type="pmid">25355905</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Williams</surname><given-names>T.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Phylogenomics provides robust support for a two-domains tree of life</article-title>. <source>Nat. Ecol. Evol</source>., <volume>4</volume>, <fpage>138</fpage>–<lpage>147</lpage>.<pub-id pub-id-type="pmid">31819234</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Willson</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>DISCO: species tree inference using multicopy gene family tree decomposition</article-title>. <source>Syst. Biol</source>., <volume>71</volume>, <fpage>610</fpage>–<lpage>629</lpage>.<pub-id pub-id-type="pmid">34450658</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Z.</given-names></string-name></person-group> (<year>1993</year>) <article-title>Maximum-likelihood estimation of phylogeny from DNA sequences when substitution rates differ over sites</article-title>. <source>Mol. Biol. Evol</source>., <volume>10</volume>, <fpage>1396</fpage>–<lpage>1401</lpage>.<pub-id pub-id-type="pmid">8277861</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yin</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>ASTRAL-MP: scaling ASTRAL to very large datasets using randomization and parallelization</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>3961</fpage>–<lpage>3969</lpage>.<pub-id pub-id-type="pmid">30903685</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zapletal</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>The softwipe tool and benchmark for assessing coding standards adherence of scientific software</article-title>. <source>Sci. Rep</source>., <volume>11</volume>, <fpage>1</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">33414495</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zaremba-Niedzwiedzka</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title><italic toggle="yes">Asgard archaea</italic> illuminate the origin of eukaryotic cellular complexity</article-title>. <source>Nature</source>, <volume>541</volume>, <fpage>353</fpage>–<lpage>358</lpage>.<pub-id pub-id-type="pmid">28077874</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeng</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Resolution of deep angiosperm phylogeny using conserved nuclear genes and estimates of early divergence times</article-title>. <source>Nat. Commun</source>., <volume>5</volume>, <fpage>1</fpage>–<lpage>12</lpage>.</mixed-citation>
    </ref>
    <ref id="btac832-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zerbino</surname><given-names>D.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Ensembl 2018</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>D754</fpage>–<lpage>D761</lpage>.<pub-id pub-id-type="pmid">29155950</pub-id></mixed-citation>
    </ref>
    <ref id="btac832-B41">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C.</given-names></string-name>, <string-name><surname>Mirarab</surname><given-names>S.</given-names></string-name></person-group> (<year>2022</year>) Weighting by gene tree uncertainty improves accuracy of quartet-based species trees. <italic toggle="yes">Mol. Biol. Evol.,</italic><bold>39</bold>(12), msac215. https://doi.org/10.1093/molbev/msac215.</mixed-citation>
    </ref>
    <ref id="btac832-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>ASTRAL-III: polynomial time species tree reconstruction from partially resolved gene trees</article-title>. <source>BMC Bioinformatics</source>, <volume>19, 153</volume>.</mixed-citation>
    </ref>
  </ref-list>
</back>
