<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">G3 (Bethesda)</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">g3journal</journal-id>
    <journal-title-group>
      <journal-title>G3: Genes|Genomes|Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2160-1836</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8495739</article-id>
    <article-id pub-id-type="pmid">33787873</article-id>
    <article-id pub-id-type="doi">10.1093/g3journal/jkab098</article-id>
    <article-id pub-id-type="publisher-id">jkab098</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software and Data Resources</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01180</subject>
        <subject>AcademicSubjects/SCI01140</subject>
        <subject>AcademicSubjects/SCI00010</subject>
        <subject>AcademicSubjects/SCI00960</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Single-cell data clustering based on sparse optimization and low-rank matrix factorization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Hu</surname>
          <given-names>Yinlei</given-names>
        </name>
        <xref rid="jkab098-aff1" ref-type="aff">1</xref>
        <xref rid="jkab098-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Bin</given-names>
        </name>
        <xref rid="jkab098-aff2" ref-type="aff">2</xref>
        <xref rid="jkab098-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Falai</given-names>
        </name>
        <xref rid="jkab098-cor1" ref-type="corresp"/>
        <xref rid="jkab098-aff1" ref-type="aff">1</xref>
        <xref rid="jkab098-aff3" ref-type="aff">3</xref>
        <!--chenfl@ustc.edu.cn-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5555-8437</contrib-id>
        <name>
          <surname>Qu</surname>
          <given-names>Kun</given-names>
        </name>
        <xref rid="jkab098-cor1" ref-type="corresp"/>
        <xref rid="jkab098-aff2" ref-type="aff">2</xref>
        <xref rid="jkab098-aff3" ref-type="aff">3</xref>
        <xref rid="jkab098-aff4" ref-type="aff">4</xref>
        <!--qukun@ustc.edu.cn-->
      </contrib>
    </contrib-group>
    <aff id="jkab098-aff1"><label>1</label><institution>School of Mathematical Sciences, University of Science and Technology of China</institution>, 230026 Hefei, Anhui, <country country="CN">China</country></aff>
    <aff id="jkab098-aff2"><label>2</label><institution>Department of Oncology, The First Affiliated Hospital of USTC, Division of Molecular Medicine, Hefei National Laboratory for Physical Sciences at Microscale, School of Basic Medical Sciences, Division of Life Sciences and Medicine, University of Science and Technology of China</institution>, 230021 Hefei, Anhui, <country country="CN">China</country></aff>
    <aff id="jkab098-aff3"><label>3</label><institution>School of Data Science, University of Science and Technology of China</institution>, 230026 Hefei, Anhui, <country country="CN">China</country></aff>
    <aff id="jkab098-aff4"><label>4</label><institution>CAS Center for Excellence in Molecular Cell Sciences, the CAS Key Laboratory of Innate Immunity and Chronic Disease, University of Science and Technology of China</institution>, 230027 Hefei, Anhui, <country country="CN">China</country></aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Andrews</surname>
          <given-names>B</given-names>
        </name>
        <role>Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="jkab098-cor1">Corresponding author: Department of Oncology, The First Affiliated Hospital of USTC, Division of Molecular Medicine, Hefei National Laboratory for Physical Sciences at Microscale, School of Basic Medical Sciences, Division of Life Sciences and Medicine, University of Science and Technology of China, 230021 Hefei, Anhui, China. <email>qukun@ustc.edu.cn</email> (K.Q.); School of Mathematical Sciences, University of Science and Technology of China, 230026 Hefei, Anhui, China. <email>chenfl@ustc.edu.cn</email> (F.C.)</corresp>
      <fn id="jkab098-FM1">
        <p>Yinlei Hu and Bin Li authors contributed equally to this work.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-03-31">
      <day>31</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>31</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <volume>11</volume>
    <issue>6</issue>
    <elocation-id>jkab098</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press on behalf of Genetics Society of America.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbyncndlicense">https://creativecommons.org/licenses/by-nc-nd/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial-NoDerivs licence (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc-nd/4.0/">http://creativecommons.org/licenses/by-nc-nd/4.0/</ext-link>), which permits non-commercial reproduction and distribution of the work, in any medium, provided the original work is not altered or transformed in any way, and that the work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="jkab098.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Unsupervised clustering is a fundamental step of single-cell RNA-sequencing (scRNA-seq) data analysis. This issue has inspired several clustering methods to classify cells in scRNA-seq data. However, accurate prediction of the cell clusters remains a substantial challenge. In this study, we propose a new algorithm for scRNA-seq data clustering based on Sparse Optimization and low-rank matrix factorization (scSO). We applied our scSO algorithm to analyze multiple benchmark datasets and showed that the cluster number predicted by scSO was close to the number of reference cell types and that most cells were correctly classified. Our scSO algorithm is available at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/QuKunLab/scSO" ext-link-type="uri">https://github.com/QuKunLab/scSO</ext-link>. Overall, this study demonstrates a potent cell clustering approach that can help researchers distinguish cell types in single- scRNA-seq data.</p>
    </abstract>
    <kwd-group>
      <kwd>scSO</kwd>
      <kwd>single-cell cluster</kwd>
      <kwd>spectral cluster</kwd>
      <kwd>sparse optimization</kwd>
      <kwd>scRNA-seq</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Key R&amp;D Program of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2020YFA0112200</award-id>
        <award-id>2017YFA0102900</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>91940306</award-id>
        <award-id>81788101</award-id>
        <award-id>31970858</award-id>
        <award-id>31771428</award-id>
        <award-id>91640113</award-id>
        <award-id>61972368</award-id>
        <award-id>11571338</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Fundamental Research Funds for the Central Universities</institution>
            <institution-id institution-id-type="DOI">10.13039/501100012226</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>YD2070002019</award-id>
        <award-id>WK2070000158</award-id>
        <award-id>WK9110000141</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Anhui Provincial Natural Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100003995</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>BJ2070000097</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro">
    <title>Introduction</title>
    <p>Single-cell RNA-sequencing (scRNA-seq) technology has been widely used in many biological investigations, including the elucidation of cell subtype heterogeneity (<xref rid="jkab098-B45" ref-type="bibr">Zeisel <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="jkab098-B13" ref-type="bibr">Goolam <italic toggle="yes">et al.</italic> 2016</xref>), construction of gene regulatory networks (<xref rid="jkab098-B7" ref-type="bibr">Darmanis <italic toggle="yes">et al.</italic> 2015</xref>), profiling of cell development and differentiation (<xref rid="jkab098-B8" ref-type="bibr">Deng <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="jkab098-B25" ref-type="bibr">Liu <italic toggle="yes">et al.</italic> 2017</xref>), and depiction of disease in an immunoresponsive environment (<xref rid="jkab098-B14" ref-type="bibr">Guo <italic toggle="yes">et al.</italic> 2018</xref>; <xref rid="jkab098-B46" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2018</xref>). The analysis of scRNA-seq data contains, but is not limited to, quality control (<xref rid="jkab098-B5" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2016</xref>), data normalization (<xref rid="jkab098-B6" ref-type="bibr">Cole <italic toggle="yes">et al.</italic> 2019</xref>), unsupervised clustering (<xref rid="jkab098-B19" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="jkab098-B38" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="jkab098-B39" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2018</xref>; <xref rid="jkab098-B42" ref-type="bibr">Yang and Wang 2020</xref>), trajectory construction (<xref rid="jkab098-B40" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic> 2019</xref>), and differentially expressed gene identification (<xref rid="jkab098-B30" ref-type="bibr">Soneson and Robinson 2018</xref>). As a fundamental step of scRNA-seq data analysis, cell clustering determines the results of subsequent downstream analyses to a certain extent, but is often inaccurate and misconstrues analyses. In recent years, various clustering methods emerged to address this problem, and they have been widely used in single-cell data analysis (<xref rid="jkab098-B18" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2019</xref>). For example, in Seurat (<xref rid="jkab098-B4" ref-type="bibr">Butler <italic toggle="yes">et al.</italic> 2018</xref>; <xref rid="jkab098-B31" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic> 2019</xref>), Butler and Stuart <italic toggle="yes">et al.</italic> employed K-nearest-neighbor graphs to obtain cell–cell similarity and used the community detection algorithm to cluster cells. To estimate cell-cell correlation, <xref rid="jkab098-B38" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> (2017)</xref> proposed a multi-kernel learning method in SIMLR, and <xref rid="jkab098-B19" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> (2017)</xref> presented a consensus clustering algorithm in SC3. However, the clustering accuracy of the currently established algorithms is limited, and as such, algorithms need to be further improved for the accurate prediction of cell clusters (<xref rid="jkab098-B18" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>In this work, by assuming that the expression vectors of cells in the same cluster are approximately linearly correlated, we proposed the use of Sparse Nonnegative Matrix Factorization (SNMF) and a Gaussian mixture model (GMM) to calculate cell-cell similarity. After assembling the cell–cell similarity matrix, we introduced a novel, unsupervised algorithm to predict cell clusters based on spectral methods and sparse optimization techniques (see Materials and Methods). As shown by our experimental results derived from 12 benchmark datasets whose cell types have been biologically verified (<xref rid="jkab098-B41" ref-type="bibr">Yan <italic toggle="yes">et al.</italic> 2013</xref>; <xref rid="jkab098-B3" ref-type="bibr">Biase <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="jkab098-B8" ref-type="bibr">Deng <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="jkab098-B28" ref-type="bibr">Pollen <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="jkab098-B34" ref-type="bibr">Treutlein <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="jkab098-B20" ref-type="bibr">Klein <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="jkab098-B21" ref-type="bibr">Kolodziejczyk <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="jkab098-B35" ref-type="bibr">Usoskin <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="jkab098-B45" ref-type="bibr">Zeisel <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="jkab098-B2" ref-type="bibr">Baron <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="jkab098-B13" ref-type="bibr">Goolam <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="jkab098-B22" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2017</xref>), the clustering accuracy of our scRNA-seq data clustering based on Sparse Optimization and low-rank matrix factorization (scSO) method outperforms the previously established, state-of-the-art single-cell clustering methods. Furthermore, our scSO algorithm can be used to generate a visual representation of cell–cell similarity (see <xref rid="jkab098-F4" ref-type="fig">Figure 4</xref>).</p>
  </sec>
  <sec>
    <title>Materials and methods</title>
    <sec>
      <title>Methods</title>
      <p>As an input, scSO takes an expression matrix <inline-formula id="IE1"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM1" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">A</mml:mi></mml:math></inline-formula> whose element <inline-formula id="IE2"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM2" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the expression of the <inline-formula id="IE3"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM3" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>th gene in the <inline-formula id="IE4"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM4" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>th cell. There are four elementary procedures in scSO, including preprocessing, SNMF dimensionality reduction, cell-to-cell similarity matrix construction, and unsupervised clustering based on sparse optimization. The pipeline is illustrated in <xref rid="jkab098-F1" ref-type="fig">Figure 1</xref>. For the convenience of other researchers, we have uploaded scSO to GitHub (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/QuKunLab/scSO" ext-link-type="uri">https://github.com/QuKunLab/scSO</ext-link>).</p>
      <fig position="float" id="jkab098-F1">
        <label>Figure 1</label>
        <caption>
          <p>A conceptual overview of the scSO workflow.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="jkab098f1" position="float"/>
      </fig>
      <p><bold><italic toggle="yes">Preprocessing</italic>:</bold> The preprocessing procedure includes two steps. In the paper of SC3 method (<xref rid="jkab098-B19" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2017</xref>), Kiselev <italic toggle="yes">et al.</italic> pointed out that the ubiquitous genes and rare genes usually cannot help clustering, and filtering out these genes can significantly improve the efficiency of calculations. Moreover, in other recently published studies, researchers also removed ubiquitous genes in the preprocessing stage (<xref rid="jkab098-B10" ref-type="bibr">Gan <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="jkab098-B11" ref-type="bibr">2020</xref>; <xref rid="jkab098-B36" ref-type="bibr">Vans <italic toggle="yes">et al.</italic> 2019</xref>; <xref rid="jkab098-B26" ref-type="bibr">Lu <italic toggle="yes">et al.</italic> 2020</xref>; <xref rid="jkab098-B43" ref-type="bibr">Ye <italic toggle="yes">et al.</italic> 2020</xref>). Therefore, we first removed genes that were not detected in any cell (uncaptured genes), and genes detected in all cells (ubiquitous genes). Second, the genes used for classification were filtered by their average expression among cells. We defined a function <inline-formula id="IE5"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM5" display="inline" overflow="scroll"><mml:mi>f</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ι</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:math></inline-formula>, as:
<disp-formula id="E1"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" display="block" overflow="scroll"><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ι</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced open="{" close="" separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>ι</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>η</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>η</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">otherwise</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math></disp-formula>
to determine whether the <inline-formula id="IE6"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM6" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>th gene should be considered for cluster analysis, where <inline-formula id="IE7"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ι</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the average expression of the <inline-formula id="IE8"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM8" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>th gene in all cells. We set <inline-formula id="IE9"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM9" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>η</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>ρ</mml:mo></mml:math></inline-formula> and <inline-formula id="IE10"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM10" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>η</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>8.5</mml:mn><mml:mo>ρ</mml:mo></mml:math></inline-formula> for all datasets tested in this article, where <inline-formula id="IE11"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM11" display="inline" overflow="scroll"><mml:mo>ρ</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo> </mml:mo><mml:mn>1</mml:mn><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ι</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>and retain the genes with <inline-formula id="IE12"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM12" display="inline" overflow="scroll"><mml:mi>f</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>ι</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. Finally, the scSO algorithm normalizes the total expression of each cell to 10,000, and updates the expression values by performing a logarithmic translation on them that is, <inline-formula id="IE13"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM13" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">log</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mn>10,000</mml:mn><mml:mo>×</mml:mo><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">)</mml:mo></mml:math></inline-formula>.</p>
      <p><bold><italic toggle="yes">SNMF dimensionality reduction</italic>:</bold> We used SNMF for dimensionality reduction [a detailed introduction to NMF can refer to (<xref rid="jkab098-B17" ref-type="bibr">Kim and Park 2007</xref>)] that is,
<disp-formula id="E2"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:munder><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">W</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">H</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mo>∥</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold">W</mml:mi><mml:mi mathvariant="bold">H</mml:mi><mml:msubsup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>∥</mml:mo><mml:mi mathvariant="bold">H</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:mo>∥</mml:mo><mml:mi mathvariant="bold">W</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mo>∥</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where <inline-formula id="IE14"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM14" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo>:</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> is the <italic toggle="yes">j</italic>th row of <inline-formula id="IE15"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM15" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">W</mml:mi></mml:math></inline-formula> and <inline-formula id="IE16"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM16" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mo>(</mml:mo><mml:mo>:</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is the <italic toggle="yes">i</italic>th column of <inline-formula id="IE17"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM17" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">H</mml:mi></mml:math></inline-formula>, and<inline-formula id="IE18"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM18" display="inline" overflow="scroll"><mml:mo> </mml:mo><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE19"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM19" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> are nonnegative tuning parameters. <inline-formula id="IE20"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM20" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">W</mml:mi></mml:math></inline-formula> and <inline-formula id="IE21"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM21" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">H</mml:mi></mml:math></inline-formula> are the basis matrix and coefficient matrix of <inline-formula id="IE22"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM22" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">A</mml:mi></mml:math></inline-formula>, respectively. Each column of <inline-formula id="IE23"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM23" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">H</mml:mi></mml:math></inline-formula> is a low-dimensional representation of the corresponding cell. Because the model (1) is a convex problem after fixing <inline-formula id="IE24"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM24" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">W</mml:mi></mml:math></inline-formula> or <inline-formula id="IE25"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM25" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">H</mml:mi></mml:math></inline-formula>, it can be solved by the alternating iteration algorithm. The detailed process is described in Supplementary Note S1.</p>
      <p><bold><italic toggle="yes">Constructing the cell-to-cell similarity matrix</italic>:</bold> After obtaining the low-dimensional expression matrix <inline-formula id="IE26"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM26" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">H</mml:mi></mml:math></inline-formula> of cells, we used the GMM (Supplementary Note S2) to fit the distribution of cells in space spanned by <bold><italic toggle="yes">W</italic></bold>. We adopted the MATLAB function <inline-formula id="IE27"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM27" display="inline" overflow="scroll"><mml:mi mathvariant="italic">fitgmdist</mml:mi><mml:mo>(</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> to build the GMM (<inline-formula id="IE28"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM28" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), and then calculated the probability that the <italic toggle="yes">i</italic>th cell belongs to the <italic toggle="yes">j</italic>th component through Bayes’ rule [<italic toggle="yes">i.e.</italic>, <inline-formula id="IE227"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM29" display="inline" overflow="scroll"><mml:mstyle mathvariant="bold-italic"><mml:mi>γ</mml:mi></mml:mstyle><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>i</mml:mi></mml:mstyle></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>μ</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>Σ</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></inline-formula>]. Finally, the similarity matrix <inline-formula id="IE30"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM30" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">S</mml:mi></mml:math></inline-formula> can be derived by calculating the probability that any two cells belong to the same component that is, <inline-formula id="IE31"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM31" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">γ</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">T</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, here <inline-formula id="IE32"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM32" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>)</mml:mo></mml:math></inline-formula>.</p>
      <p><bold><italic toggle="yes">Unsupervised clustering based on sparse optimization</italic>:</bold> Assuming that a dataset <inline-formula id="IE33"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM33" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">A</mml:mi></mml:math></inline-formula> can be divided into <inline-formula id="IE34"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM34" display="inline" overflow="scroll"><mml:mi mathvariant="normal">c</mml:mi></mml:math></inline-formula> clusters (<inline-formula id="IE35"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM35" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), and the perfect similarity matrix should be:
<disp-formula id="E3"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{" close="" separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">otherwise</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>∼</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>The zero eigenvalue of <inline-formula id="IE36"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM36" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">L</mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mi mathvariant="normal">here</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">diag</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">and</mml:mi><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo><mml:mo> </mml:mo></mml:math></inline-formula>has multiplicity <inline-formula id="IE37"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM37" display="inline" overflow="scroll"><mml:mi>c</mml:mi></mml:math></inline-formula>, and its eigenspace is spanned by the indicator vectors <inline-formula id="IE38"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM38" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>, here <inline-formula id="IE39"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM39" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo> </mml:mo><mml:mi mathvariant="italic">and</mml:mi><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{" close="" separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">otherwise</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></inline-formula>. Moreover, each nonzero eigenvalue <inline-formula id="IE40"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM40" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of <inline-formula id="IE41"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM41" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">L</mml:mi></mml:math></inline-formula> has multiplicity <inline-formula id="IE42"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM42" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>−1 (<inline-formula id="IE43"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM43" display="inline" overflow="scroll"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>∼</mml:mo><mml:mi>c</mml:mi></mml:math></inline-formula>), where <inline-formula id="IE44"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM44" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the number of cells in <inline-formula id="IE45"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM45" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (Supplementary Note S3). For the eigenvector <inline-formula id="IE46"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM46" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> corresponding to a zero eigenvalue of <inline-formula id="IE47"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM47" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">L</mml:mi></mml:math></inline-formula>, if we sort the entries of <inline-formula id="IE48"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM48" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> in ascending order, as:
<disp-formula id="E4"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" display="block" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mo>⋯</mml:mo><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msubsup><mml:mo> </mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>
the entries of <inline-formula id="IE49"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM49" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> with the same values belong to the same class and they can be used to segment <inline-formula id="IE50"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM50" display="inline" overflow="scroll"><mml:mi>C</mml:mi></mml:math></inline-formula> into <inline-formula id="IE51"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM51" display="inline" overflow="scroll"><mml:mi>c</mml:mi></mml:math></inline-formula> classes.</p>
      <p>After obtaining the similarity matrix <inline-formula id="IE52"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM52" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">S</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (see previous section), we constructed the Laplacian matrix <inline-formula id="IE53"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM53" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">L</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">D</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="bold-italic">S</mml:mi></mml:math></inline-formula>, and computed the eigenvalues <inline-formula id="IE54"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM54" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mo>…</mml:mo><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and the eigenvector <inline-formula id="IE55"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM55" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of <inline-formula id="IE56"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM56" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">L</mml:mi></mml:math></inline-formula>. It is easy to show that <inline-formula id="IE57"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM57" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">L</mml:mi></mml:math></inline-formula> is positive semidefinite. Because the similarity matrix <inline-formula id="IE58"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM58" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">S</mml:mi></mml:math></inline-formula> generated from previous section contains noise, the minimum eigenvalue <inline-formula id="IE59"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM59" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of <inline-formula id="IE60"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM60" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">L</mml:mi></mml:math></inline-formula> is not exactly zero, and the multiplicity <inline-formula id="IE61"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM61" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is usually equal to 1. However, the vector <inline-formula id="IE62"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM62" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> is a piecewise constant vector if <inline-formula id="IE63"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM63" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">S</mml:mi></mml:math></inline-formula> is “perfect” (Supplementary Note S3). Thus, we calculated the piecewise constant approximation of <inline-formula id="IE64"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM64" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">l</mml:mi></mml:math></inline-formula> as <inline-formula id="IE65"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM65" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">′</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and defined the multiplicity of eigenvalue zero (termed<inline-formula id="IE66"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM66" display="inline" overflow="scroll"><mml:mi mathvariant="normal"> </mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">'</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>) as the number of the minimum elements in <inline-formula id="IE67"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM67" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">′</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>. As shown in Supplementary Figure S1, <inline-formula id="IE68"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM68" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE69"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM69" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula id="IE70"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM70" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> cannot separate zygote, two-, and three-cell, but the center of <inline-formula id="IE71"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM71" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE72"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM72" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula id="IE73"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM73" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> can distinguish them well. Therefore, we used the center of <inline-formula id="IE74"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM74" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> as an initial guess <inline-formula id="IE75"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM75" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> of cell clustering (blue points in <xref rid="jkab098-F2" ref-type="fig">Figure 2A</xref>).</p>
      <fig position="float" id="jkab098-F2">
        <label>Figure 2</label>
        <caption>
          <p>An example of scSO determine cell clusters. (A) The blue points represent the sorted elements of the eigenvector corresponding to the zero eigenvalue of the Laplacian matrix. (B) The solid red line is the piecewise constant approximation of the sorted eigenvector calculated by sparse optimization. (C) The result of clustering generated by the piecewise constant vector.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="jkab098f2" position="float"/>
      </fig>
      <p>After obtaining the<inline-formula id="IE76"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM76" display="inline" overflow="scroll"><mml:mi> </mml:mi><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula>, scSO takes the following process to predict cell clusters: (1) sort the elements of <inline-formula id="IE77"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM77" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> in ascending order to obtain <inline-formula id="IE78"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> (blue points in <xref rid="jkab098-F2" ref-type="fig">Figure 2A</xref>); (2) calculate the piecewise constant approximate <inline-formula id="IE79"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> of <inline-formula id="IE80"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> to remove noise (solid red line in <xref rid="jkab098-F2" ref-type="fig">Figure 2B</xref>); (3) group cells corresponding to a piecewise constant (<italic toggle="yes">i.e</italic>., a step in <xref rid="jkab098-F2" ref-type="fig">Figure 2C</xref>) into a cluster, and the number of piecewise constants is the number of cell clusters.</p>
      <p>In this work, we obtain the piecewise constant approximation of a vector <inline-formula id="IE81"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM81" display="inline" overflow="scroll"><mml:mi mathvariant="bold">b</mml:mi></mml:math></inline-formula> by the weighted sparse optimization model (<xref rid="jkab098-B33" ref-type="bibr">Tong <italic toggle="yes">et al.</italic> 2020</xref>) that is:
<disp-formula id="E5"><label>(2)</label><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" display="block" overflow="scroll"><mml:mrow><mml:munder><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x,z</mml:mi></mml:mrow></mml:munder><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>λ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">b</mml:mi><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mo>λ</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>z</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>.</mml:mo><mml:mi>t</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="bold">z</mml:mi><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:mrow></mml:math></disp-formula>
where the entries of <inline-formula id="IE82"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM82" display="inline" overflow="scroll"><mml:mi mathvariant="bold">b</mml:mi></mml:math></inline-formula> are sorted in ascending order, <inline-formula id="IE83"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM83" display="inline" overflow="scroll"><mml:mi mathvariant="bold">x</mml:mi></mml:math></inline-formula> is the piecewise constant approximation of <inline-formula id="IE84"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM84" display="inline" overflow="scroll"><mml:mi mathvariant="bold">b</mml:mi></mml:math></inline-formula>, <inline-formula id="IE85"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM85" display="inline" overflow="scroll"><mml:mi mathvariant="normal">λ</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>(</mml:mo><mml:mn>0,1</mml:mn><mml:mo>)</mml:mo></mml:math></inline-formula> is the balance parameter, and <inline-formula id="IE86"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM86" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> is a sparse matrix. All entries of <inline-formula id="IE87"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM87" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">D</mml:mi></mml:math></inline-formula> are zeros, except for <inline-formula id="IE88"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM88" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> and <inline-formula id="IE89"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM89" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">D</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>. As the model (2) is a convex quadratic programming problem, we solved it by the convex optimization package CVXPY (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.cvxpy.org/" ext-link-type="uri">https://www.cvxpy.org/</ext-link>; <xref rid="jkab098-B9" ref-type="bibr">Diamond and Boyd 2016</xref>; <xref rid="jkab098-B1" ref-type="bibr">Agrawal <italic toggle="yes">et al.</italic> 2018</xref>).</p>
    </sec>
    <sec>
      <title>Parameters for other tools</title>
      <p>Seurat (version 3.0.0) was downloaded from <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/satijalab/seurat/" ext-link-type="uri">https://github.com/satijalab/seurat/</ext-link>. For all datasets in the paper, Seurat was performed with default parameters. Specially, we set the number of neighbors to 20, the cluster resolution to 0.8, and used the <italic toggle="yes">ScoreJackStraw()</italic> function and 0.05 (the bound of <italic toggle="yes">P</italic>-value) to determine the number of principal components. (2) Scanpy (version 1.4.0) was downloaded from <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/theislab/scanpy" ext-link-type="uri">https://github.com/theislab/scanpy</ext-link>. In addition to using <italic toggle="yes">n_pcs = 20</italic> in the function <italic toggle="yes">pp.neighbors ()</italic>, we ran Scanpy with default parameters (<italic toggle="yes">n_neighbors = 15</italic> and <italic toggle="yes">resolution = 1.0</italic>). (3) We downloaded SC3 (version 1.10.1) from <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/hemberg-lab/SC3" ext-link-type="uri">https://github.com/hemberg-lab/SC3</ext-link>. SC3 was run with default parameters, for example, <italic toggle="yes">gene_filter = FALSE</italic>, <italic toggle="yes">pct_dropout_min = 10</italic>, <italic toggle="yes">pct_dropout_max = 90</italic>, <italic toggle="yes">d_region_min = 0.04</italic>, and <italic toggle="yes">d_region_max = 0.07.</italic> (4) SIMLR (version 1.8.1) was downloaded from <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/BatzoglouLabSU/SIMLR" ext-link-type="uri">https://github.com/BatzoglouLabSU/SIMLR</ext-link>. We use the default parameters to perform SIMLR except that we set <italic toggle="yes">kk = 30</italic> in the <italic toggle="yes">SIMLR_Large_Scale ()</italic> function and used <italic toggle="yes">NUMC = 2:15</italic> to calculate the number of clusters.</p>
    </sec>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>There is no new data associated with this article. Published datasets used in this study: nine datasets are available at GEO with the accession numbers: GSE36552 (<xref rid="jkab098-B41" ref-type="bibr">Yan <italic toggle="yes">et al.</italic> 2013</xref>), GSE57249 (<xref rid="jkab098-B3" ref-type="bibr">Biase <italic toggle="yes">et al.</italic> 2014</xref>), GSE45719 (<xref rid="jkab098-B8" ref-type="bibr">Deng <italic toggle="yes">et al.</italic> 2014</xref>), GSE65525 (<xref rid="jkab098-B20" ref-type="bibr">Klein <italic toggle="yes">et al.</italic> 2015</xref>), GSE60361 (<xref rid="jkab098-B45" ref-type="bibr">Zeisel <italic toggle="yes">et al.</italic> 2015</xref>), GSE81861(Rca; <xref rid="jkab098-B22" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2017</xref>), GSE52583 (<xref rid="jkab098-B34" ref-type="bibr">Treutlein <italic toggle="yes">et al.</italic> 2014</xref>), GSE84133 (<xref rid="jkab098-B2" ref-type="bibr">Baron <italic toggle="yes">et al.</italic> 2016</xref>), and GSE59739 (<xref rid="jkab098-B35" ref-type="bibr">Usoskin <italic toggle="yes">et al.</italic> 2015</xref>); the rest of three datasets can be available with the accession number: E-MTAB-2600 (<xref rid="jkab098-B21" ref-type="bibr">Kolodziejczyk <italic toggle="yes">et al.</italic> 2015</xref>), E-MTAB-3321 (<xref rid="jkab098-B13" ref-type="bibr">Goolam <italic toggle="yes">et al.</italic> 2016</xref>), and SRP041736 (<xref rid="jkab098-B28" ref-type="bibr">Pollen <italic toggle="yes">et al.</italic> 2014</xref>) (Supplementary Table S1). Supplementary Figures S1–4, Supplementary Tables S1 and S2, and Supplementary Notes S1–3 are available at figshare: <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://doi.org/10.25387/g3.14256641" ext-link-type="uri">https://doi.org/10.25387/g3.14256641</ext-link>. The source code of scSO is released at <ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://github.com/QuKunLab/scSO" ext-link-type="uri">https://github.com/QuKunLab/scSO</ext-link>, and all results in this article are obtained by using python version of scSO.</p>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <p>To assess the performance of scSO, we applied our approach to 12 benchmark scRNA-seq datasets (<xref rid="jkab098-B41" ref-type="bibr">Yan <italic toggle="yes">et al.</italic> 2013</xref>; <xref rid="jkab098-B3" ref-type="bibr">Biase <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="jkab098-B8" ref-type="bibr">Deng <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="jkab098-B28" ref-type="bibr">Pollen <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="jkab098-B34" ref-type="bibr">Treutlein <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="jkab098-B20" ref-type="bibr">Klein <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="jkab098-B21" ref-type="bibr">Kolodziejczyk <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="jkab098-B35" ref-type="bibr">Usoskin <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="jkab098-B45" ref-type="bibr">Zeisel <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="jkab098-B2" ref-type="bibr">Baron <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="jkab098-B13" ref-type="bibr">Goolam <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="jkab098-B22" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2017</xref>), Among 12 benchmark datasets, the cells in Biase (<xref rid="jkab098-B3" ref-type="bibr">Biase <italic toggle="yes">et al.</italic> 2014</xref>), Yan (<xref rid="jkab098-B41" ref-type="bibr">Yan <italic toggle="yes">et al.</italic> 2013</xref>), Goolam (<xref rid="jkab098-B13" ref-type="bibr">Goolam <italic toggle="yes">et al.</italic> 2016</xref>), and Deng (<xref rid="jkab098-B8" ref-type="bibr">Deng <italic toggle="yes">et al.</italic> 2014</xref>) came from different cell stages (those cell types represent different cell stages), and the cells in Kolodziejczyk (<xref rid="jkab098-B21" ref-type="bibr">Kolodziejczyk <italic toggle="yes">et al.</italic> 2015</xref>) and Pollen (<xref rid="jkab098-B28" ref-type="bibr">Pollen <italic toggle="yes">et al.</italic> 2014</xref>) were generated under different experimental conditions (those cell labels represent different experimental conditions). <xref rid="jkab098-B19" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> (2017)</xref> believed that these cell labels in the six datasets have high-confidence and call them “gold standard” data. The other six datasets (such as the Zeisel (<xref rid="jkab098-B45" ref-type="bibr">Zeisel <italic toggle="yes">et al.</italic> 2015</xref>) dataset) are considered as “silver standard” data. Their cell types were assigned by computational methods and experimentally verified by differential expressed mark genes of each cell group. Those benchmark datasets also were used in other recent studies (<xref rid="jkab098-B19" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="jkab098-B29" ref-type="bibr">Qi <italic toggle="yes">et al.</italic> 2020</xref>).</p>
    <p>Currently there are &gt;50 single-cell clustering algorithms (<xref rid="jkab098-B44" ref-type="bibr">Zappia <italic toggle="yes">et al.</italic> 2018</xref>); however, the recently published benchmark article from <italic toggle="yes">Briefings in Bioinformatics</italic> (<xref rid="jkab098-B29" ref-type="bibr">Qi <italic toggle="yes">et al.</italic> 2020</xref>), Qi <italic toggle="yes">et al.</italic> tested five representative clustering methods (SC3, SNN-Cliq, SINCERA, SEURAT, and pcaReduce) of the most advanced scRNA-seq tools currently available through 12 public benchmark datasets and showed that SC3 had the highest clustering accuracy under default parameters, while Seurat performed well in the mixture control experiment reported by the recently published benchmark article in <italic toggle="yes">Nature Methods</italic> (<xref rid="jkab098-B32" ref-type="bibr">Tian <italic toggle="yes">et al.</italic> 2019</xref>) Tian <italic toggle="yes">et al.</italic> believed that RaceD3, Seurat, clusterExperiment, RCA, and SC3 were representative, and tested them in their mixture control experiment). Scanpy is a widely used python packages for single-cell analysis (<xref rid="jkab098-B23" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2020a</xref>,<xref rid="jkab098-B24" ref-type="bibr">b</xref>). SIMLR measures the cell–cell similarity based on a multi-kernel learning method, which is a representative method in single-cell clustering algorithms (<xref rid="jkab098-B18" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2019</xref>). Therefore, we only compared our algorithm with SC3, Scanpy, Seurat, and SIMLR. To ensure that comparisons between algorithms were based on the same criteria, we used the same gene-filtering and normalization steps for all these algorithms.</p>
    <p>We used the following three metrics to quantify the performance of scSO in predicting the number of cell types: (1) the difference between the predicted and reference cell type numbers of each dataset (<inline-formula id="IE90"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM90" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>Δ</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">pred</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> for dataset <italic toggle="yes">m</italic>), (2) the Pearson correlation coefficient between the predicted and reference cell type numbers (<inline-formula id="IE91"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM91" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">corr</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="italic">corr</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>⇀</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="italic">pred</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>⇀</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ref</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>)), and (3) the number of datasets with <inline-formula id="IE92"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM92" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>Δ</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> less than or equal to 2 (<inline-formula id="IE93"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM93" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>Δ</mml:mo><mml:mo>≤</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula>). Specifically, <inline-formula id="IE94"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM94" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>Δ</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the error of the predicted number of cell types, and the average <inline-formula id="IE95"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM95" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>Δ</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> of the prediction results of scSO on the 12 datasets was 1.58, which was the lowest of the 5 methods (<xref rid="jkab098-F3" ref-type="fig">Figure 3A</xref>). For the <inline-formula id="IE96"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM96" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">corr</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> parameter that represents the prediction accuracy of the cell type number, the scSO result was 0.79, and the results of SC3, Scanpy, Seurat, and SIMLR were 0.41, 0.51, 0.47, and 0.23, respectively (<xref rid="jkab098-F3" ref-type="fig">Figure 3B</xref>). Moreover, <inline-formula id="IE97"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM97" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>Δ</mml:mo><mml:mo>≤</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> indicates the number of datasets for which the cell type number was accurately predicted, and the <inline-formula id="IE98"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM98" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>Δ</mml:mo><mml:mo>≤</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> for the scSO results was 10, whereas for the other four methods <inline-formula id="IE99"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM99" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>Δ</mml:mo><mml:mo>≤</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> were 6 (SC3), 5 (Scanpy), 4 (Seurat), and 6 (SIMLR; <xref rid="jkab098-F3" ref-type="fig">Figure 3C</xref>).</p>
    <fig position="float" id="jkab098-F3">
      <label>Figure 3</label>
      <caption>
        <p>Performance of scSO on 12 benchmark datasets. (A) Difference (<inline-formula id="IE100"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM100" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>Δ</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) between the reference and predicted cell type numbers. Center line, median; box limits, upper and lower quartiles; whiskers, 1.5× interquartile range. (B) Pearson correlation coefficient between the reference and predicted cell type numbers. (C) A table listing the reference cell type numbers reported by the data source papers, and the predicted cell type numbers generated by different methods. (D) ARI values between the reference cell types and predicted cell clusters. Bar, average ARI; Dots, ARI values for multiple runs. SC3 and SIMLR were performed 50 times for each dataset.</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="jkab098f3" position="float"/>
    </fig>
    <p>To further evaluate the clustering performance of scSO, we calculated the adjusted rand index (ARI; <xref rid="jkab098-B19" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="jkab098-B16" ref-type="bibr">Huang <italic toggle="yes">et al.</italic> 2018</xref>) between its clustering results and reference labels of cells. A higher ARI value indicates higher consistency between the clustering result and the reported cell types of each dataset. In the scSO clustering results of all the 12 datasets, the ARI values of 8 datasets were greater than or equal to 0.8 (<xref rid="jkab098-F3" ref-type="fig">Figure 3D</xref>). On the contrary, in the clustering results of SC3, the ARI values of three datasets were greater than 0.8, which was the second-highest among all the five methods (The results of different ARI thresholds can refer to Supplementary Table S2). We also tested these state-of-the-art methods with their filtering and normalization processes, which did not significantly change their performance on these datasets (Supplementary Figure S2).</p>
    <p>Specifically, scSO classified all the oligodendrocytes in the Zeisel dataset (<xref rid="jkab098-B45" ref-type="bibr">Zeisel <italic toggle="yes">et al.</italic> 2015</xref>) into one cell cluster, and the d0 mouse embryonic stem cells in the Klein dataset. In contrast, the other four methods divided these cell types into multiple subclusters, and the subclusters classified by different methods were not identical (Supplementary Figure S3).</p>
    <p>Furthermore, we used scSO to sort cells by its corresponding element in <inline-formula id="IE101"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM101" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> (the eigenvector corresponding to zero eigenvalue, <xref rid="jkab098-F4" ref-type="fig">Figure 4</xref>). The cells with the same height belong to one cluster, and the height of a “step” indicates the difference between two clusters. The <inline-formula id="IE102"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM102" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula> can be used to visualize the similarity between cells. Also, the users can tune the balance parameter <inline-formula id="IE103"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM103" display="inline" overflow="scroll"><mml:mo>λ</mml:mo></mml:math></inline-formula> to adjust cluster number, according to the heights of “steps” in <inline-formula id="IE104"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM104" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">u</mml:mi></mml:math></inline-formula>, to obtain a better clustering result.</p>
    <fig position="float" id="jkab098-F4">
      <label>Figure 4</label>
      <caption>
        <p>Eigenvector <inline-formula id="IE105"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM105" display="inline" overflow="scroll"><mml:mi>u</mml:mi></mml:math></inline-formula> generated by scSO for Kolodziejczyk’s and Usoskin’s datasets. Each point denotes a cell, and colors denote cell types. “lif,” “2i,” and “a2i” represent single-cell RNA-sequencing of Mouse embryonic stem cells (mESCs) cultured under three different conditions (<xref rid="jkab098-B35" ref-type="bibr">Usoskin <italic toggle="yes">et al.</italic> 2015</xref>). PEP, NP, NF, and TH are the abbreviations for peptidergic nociceptor, non-peptidergic nociceptor, neurofilament, and tyrosine hydroxylase, respectively (<xref rid="jkab098-B21" ref-type="bibr">Kolodziejczyk <italic toggle="yes">et al.</italic> 2015</xref>).</p>
      </caption>
      <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="jkab098f4" position="float"/>
    </fig>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>In this article, we propose a new clustering algorithm, scSO, to classify cell types from scRNA-seq data. In the construction of the scSO algorithm, we assumed that the gene expression of cells of the same type was approximately linearly correlated, and we adopted NMF method and GMM to construct the similarity matrix. Then, a new spectral clustering algorithm based on sparse optimization (scSO) was proposed to predict the final cell clusters. The eigenvector that we used to obtain cell identity (<xref rid="jkab098-F4" ref-type="fig">Figure 4</xref>) can be used to visualize the cell–cell similarity determined by scSO. Finally, we applied scSO to 12 benchmark datasets to assess its performance. Our results indicate that scSO outperformed other state-of-the-art methods in terms of clustering accuracy, implying its advantage in processing single-cell sequencing data.</p>
    <p>In scSO, there are several parameters for setting, such as the gene filtering parameter <inline-formula id="IE106"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM106" display="inline" overflow="scroll"><mml:mo>η</mml:mo></mml:math></inline-formula>, the number of reduced dimensions <inline-formula id="IE107"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM107" display="inline" overflow="scroll"><mml:mi>r</mml:mi></mml:math></inline-formula> in NMF, the number of clusters and covariance structure in GMM and the balance parameter <inline-formula id="IE108"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM108" display="inline" overflow="scroll"><mml:mo>λ</mml:mo></mml:math></inline-formula> in the piecewise constant approximation. All these parameters are set as default values in this study. The gene filtering parameter <inline-formula id="IE109"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM109" display="inline" overflow="scroll"><mml:mo>η</mml:mo></mml:math></inline-formula> is used to screen out the genes that do not contribute to scSO clustering. For all the datasets shown in <xref rid="jkab098-F3" ref-type="fig">Figure 3</xref>, we empirically set<inline-formula id="IE110"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM110" display="inline" overflow="scroll"><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>η</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>ρ</mml:mo></mml:math></inline-formula> and <inline-formula id="IE111"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM111" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>η</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>8.5</mml:mn><mml:mo>ρ</mml:mo></mml:math></inline-formula>, where <inline-formula id="IE112"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM112" display="inline" overflow="scroll"><mml:mo>ρ</mml:mo></mml:math></inline-formula> is the average expression of all the genes. Experiments show that such setting outperforms other gene filtering methods. For the rank <italic toggle="yes">r</italic> of gene expression matrix, we use a heuristic algorithm to automatically estimate <inline-formula id="IE113"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM113" display="inline" overflow="scroll"><mml:mi>r</mml:mi></mml:math></inline-formula> in scSO. The heuristic algorithm is based on the observation that the ratios <inline-formula id="IE114"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM114" display="inline" overflow="scroll"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula> of singular values (<inline-formula id="IE115"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM115" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mo>…</mml:mo><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi><mml:mo>⁡</mml:mo><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula>), has a large jump at <inline-formula id="IE116"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM116" display="inline" overflow="scroll"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>r</mml:mi></mml:math></inline-formula>, and <inline-formula id="IE117"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM117" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> is small (<xref rid="jkab098-B15" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> 2020</xref>). For the covariance structure for GMM, since the <inline-formula id="IE118"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM118" display="inline" overflow="scroll"><mml:mi>r</mml:mi></mml:math></inline-formula> features obtained by SNMF are approximately linearly independent, we set the covariance matrix structure to be diagonal for the 12 benchmark datasets. For the number of clusters in GMM, under the assumption that cells of different types are approximately linearly independent, and in order to better fit the distribution of cells in the low-dimensional space, the number of clusters in the GMM should not be less than <inline-formula id="IE119"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM119" display="inline" overflow="scroll"><mml:mi>r</mml:mi></mml:math></inline-formula>. Meanwhile, in order to avoid over-fitting caused by setting the cluster number in GMM to be too large, the number of clusters should be close to <inline-formula id="IE120"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM120" display="inline" overflow="scroll"><mml:mi>r</mml:mi></mml:math></inline-formula>. We found that <inline-formula id="IE121"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM121" display="inline" overflow="scroll"><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> is a good choice for the number of clusters of GMM by experiment. For the balance parameter <inline-formula id="IE122"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM122" display="inline" overflow="scroll"><mml:mo>λ</mml:mo></mml:math></inline-formula>, we tested the performance of scSO with different <inline-formula id="IE123"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM123" display="inline" overflow="scroll"><mml:mo>λ</mml:mo></mml:math></inline-formula> through 12 benchmark datasets (Supplementary Figure S4). The results show that for <inline-formula id="IE124"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM124" display="inline" overflow="scroll"><mml:mo>λ</mml:mo></mml:math></inline-formula> values between 0.15 and 0.2, the ARI values of the scSO were stable (except the ARI values of Klein data near <inline-formula id="IE125"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM125" display="inline" overflow="scroll"><mml:mo>λ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.172</mml:mn></mml:math></inline-formula>), which implies scSO is robust to <inline-formula id="IE126"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM126" display="inline" overflow="scroll"><mml:mo>λ</mml:mo></mml:math></inline-formula> (Supplementary Figure S4). Therefore, we set <inline-formula id="IE127"><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="IM127" display="inline" overflow="scroll"><mml:mo>λ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.15</mml:mn></mml:math></inline-formula> as the default value.</p>
    <p>Regarding future work, there are three possible directions to improve the clustering effect of scSO. First, to reduce the number of free parameters in scSO, we can try to use a hierarchical version of the Expectation–Maximization algorithm to automatically estimate the number of cell clusters in the future version of scSO. Second, recent studies (<xref rid="jkab098-B16" ref-type="bibr">Huang <italic toggle="yes">et al.</italic> 2018</xref>; <xref rid="jkab098-B15" ref-type="bibr">Hu <italic toggle="yes">et al.</italic> 2020</xref>) indicated that using an appropriate imputation method for single-cell data can improve the profiling of cell types. As such, we will progress the performance of scSO by enhancing the resistance of scSO to dropout events (due to the low capture and sequencing efficiency of single-cell sequencing technology, most genes are represented by zero values in scRNA-seq data). Finally, batch effects hinder scRNA-seq data analyses, and <xref rid="jkab098-B31" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic> (2019)</xref> showed that a suitable batch effect elimination algorithm can effectively improve the accuracy of clustering. Therefore, in future work, we will improve the method of measuring the similarity among cells to make scSO more robust for batch effects.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgments</title>
    <p>We thank the USTC supercomputing center and the School of Life Science Bioinformatics Center for providing supercomputing resources for this project. We thank the CAS interdisciplinary innovation team for helpful discussion.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the National Key R&amp;D Program of China (grant numbers 2020YFA0112200 and 2017YFA0102900 to K.Q.), the National Natural Science Foundation of China grants (grant numbers 91940306, 81788101, 31970858, 31771428, and 91640113 to K.Q.; grant numbers 61972368 and 11571338 to F.C.), and the Fundamental Research Funds for the Central Universities (grant number YD2070002019, WK2070000158, and WK9110000141 to K.Q.). It was also supported by Anhui Provincial Natural Science Foundation (grant number BJ2070000097 to B.L.).</p>
    </sec>
    <sec>
      <title>Conflicts of interest</title>
      <p>There is no conflict of interest.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>Literature cited</title>
    <ref id="jkab098-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Agrawal</surname><given-names>A</given-names></string-name>, <string-name><surname>Verschueren</surname><given-names>R</given-names></string-name>, <string-name><surname>Diamond</surname><given-names>S</given-names></string-name>, <string-name><surname>Boyd</surname><given-names>S.</given-names></string-name></person-group><year>2018</year>. 
<article-title>A rewriting system for convex optimization problems</article-title>. <source>J Control Decis</source>. <volume>5</volume>:<fpage>42</fpage>–<lpage>60</lpage>.</mixed-citation>
    </ref>
    <ref id="jkab098-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baron</surname><given-names>M</given-names></string-name>, <string-name><surname>Veres</surname><given-names>A</given-names></string-name>, <string-name><surname>Wolock</surname><given-names>SL</given-names></string-name>, <string-name><surname>Faust</surname><given-names>AL</given-names></string-name>, <string-name><surname>Gaujoux</surname><given-names>R</given-names></string-name></person-group>, <etal>et al</etal><year>2016</year>. 
<article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>. <source>Cell Syst</source>. <volume>3</volume>:<fpage>346</fpage>–<lpage>360.e4</lpage>.<pub-id pub-id-type="pmid">27667365</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Biase</surname><given-names>FH</given-names></string-name>, <string-name><surname>Cao</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhong</surname><given-names>S.</given-names></string-name></person-group><year>2014</year>. 
<article-title>Cell fate inclination within 2-cell and 4-cell mouse embryos revealed by single-cell RNA sequencing</article-title>. <source>Genome Res</source>. <volume>24</volume>:<fpage>1787</fpage>–<lpage>1796</lpage>.<pub-id pub-id-type="pmid">25096407</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P</given-names></string-name>, <string-name><surname>Papalexi</surname><given-names>E</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group><year>2018</year>. 
<article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat Biotechnol</source>. <volume>36</volume>:<fpage>411</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>H-IH</given-names></string-name>, <string-name><surname>Jin</surname><given-names>Y</given-names></string-name>, <string-name><surname>Huang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y.</given-names></string-name></person-group><year>2016</year>. 
<article-title>Detection of high variability in gene expression from single-cell RNA-seq profiling</article-title>. <source>BMC Genomics</source>. <volume>17</volume>:<fpage>508</fpage>.<pub-id pub-id-type="pmid">27556924</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cole</surname><given-names>MB</given-names></string-name>, <string-name><surname>Risso</surname><given-names>D</given-names></string-name>, <string-name><surname>Wagner</surname><given-names>A</given-names></string-name>, <string-name><surname>DeTomaso</surname><given-names>D</given-names></string-name>, <string-name><surname>Ngai</surname><given-names>J</given-names></string-name></person-group>, <etal>et al</etal><year>2019</year>. 
<article-title>Performance assessment and selection of normalization procedures for single-cell RNA-seq</article-title>. <source>Cell Syst</source>. <volume>8</volume>:<fpage>315</fpage>–<lpage>328.e8</lpage>.<pub-id pub-id-type="pmid">31022373</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Darmanis</surname><given-names>S</given-names></string-name>, <string-name><surname>Sloan</surname><given-names>SA</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Enge</surname><given-names>M</given-names></string-name>, <string-name><surname>Caneda</surname><given-names>C</given-names></string-name></person-group>, <etal>et al</etal><year>2015</year>. 
<article-title>A survey of human brain transcriptome diversity at the single cell level</article-title>. <source>Proc Natl Acad Sci U S A</source>. <volume>112</volume>:<fpage>7285</fpage>–<lpage>7290</lpage>.<pub-id pub-id-type="pmid">26060301</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deng</surname><given-names>Q</given-names></string-name>, <string-name><surname>Ramsköld</surname><given-names>D</given-names></string-name>, <string-name><surname>Reinius</surname><given-names>B</given-names></string-name>, <string-name><surname>Sandberg</surname><given-names>R.</given-names></string-name></person-group><year>2014</year>. 
<article-title>Single-cell RNA-seq reveals dynamic, random monoallelic gene expression in mammalian cells</article-title>. <source>Science.</source><volume>343</volume>:<fpage>193</fpage>–<lpage>196</lpage>.<pub-id pub-id-type="pmid">24408435</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diamond</surname><given-names>S</given-names></string-name>, <string-name><surname>Boyd</surname><given-names>S.</given-names></string-name></person-group><year>2016</year>. 
<article-title>CVXPY: A Python-embedded modeling language for convex optimization</article-title>. <source>J Mach Learn Res</source>. <volume>17</volume>:<fpage>1</fpage>–<lpage>5</lpage>.</mixed-citation>
    </ref>
    <ref id="jkab098-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Li</surname><given-names>N</given-names></string-name>, <string-name><surname>Zou</surname><given-names>G</given-names></string-name>, <string-name><surname>Xin</surname><given-names>Y</given-names></string-name>, <string-name><surname>Guan</surname><given-names>J.</given-names></string-name></person-group><year>2018</year>. 
<article-title>Identification of cancer subtypes from single-cell RNA-seq data using a consensus clustering method</article-title>. <source>BMC Med Genomics</source>. <volume>11</volume>: <fpage>117</fpage>.<pub-id pub-id-type="pmid">30598115</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Liang</surname><given-names>S</given-names></string-name>, <string-name><surname>Wei</surname><given-names>Q</given-names></string-name>, <string-name><surname>Zou</surname><given-names>G.</given-names></string-name></person-group><year>2020</year>. 
<article-title>Identification of differential gene groups from single-cell transcriptomes using network entropy</article-title>. <source>Front Cell Dev Biol</source>. <volume>8</volume>:<fpage>588041</fpage>.<pub-id pub-id-type="pmid">33195248</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goolam</surname><given-names>M</given-names></string-name>, <string-name><surname>Scialdone</surname><given-names>A</given-names></string-name>, <string-name><surname>Graham</surname><given-names>SJL</given-names></string-name>, <string-name><surname>MacAulay</surname><given-names>IC</given-names></string-name>, <string-name><surname>Jedrusik</surname><given-names>A</given-names></string-name></person-group>, <etal>et al</etal><year>2016</year>. 
<article-title>Heterogeneity in Oct4 and Sox2 targets biases cell fate in 4-cell mouse embryos</article-title>. <source>Cell</source>. <volume>165</volume>:<fpage>61</fpage>–<lpage>74</lpage>.,<pub-id pub-id-type="pmid">27015307</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>L</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>C</given-names></string-name>, <string-name><surname>Song</surname><given-names>J</given-names></string-name></person-group>, <etal>et al</etal><year>2018</year>. 
<article-title>Global characterization of T cells in non-small-cell lung cancer by single-cell sequencing</article-title>. <source>Nat Med</source>. <volume>24</volume>:<fpage>978</fpage>–<lpage>985</lpage>.<pub-id pub-id-type="pmid">29942094</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B15">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Li</surname><given-names>B</given-names></string-name>, <string-name><surname>Liu</surname><given-names>N</given-names></string-name>, <string-name><surname>Cai</surname><given-names>P</given-names></string-name>, <string-name><surname>Chen</surname><given-names>F</given-names></string-name></person-group>, <etal>et al</etal><year>2021</year>. WEDGE: recovery of gene expression values for sparse single-cell RNA-seq datasets using matrix decomposition. Brief. Bioinform. bbab085.</mixed-citation>
    </ref>
    <ref id="jkab098-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>M</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Torre</surname><given-names>E</given-names></string-name>, <string-name><surname>Dueck</surname><given-names>H</given-names></string-name>, <string-name><surname>Shaffer</surname><given-names>S</given-names></string-name></person-group>, <etal>et al</etal><year>2018</year>. 
<article-title>SAVER: gene expression recovery for single-cell RNA sequencing</article-title>. <source>Nat Methods</source>. <volume>15</volume>:<fpage>539</fpage>–<lpage>542</lpage>.<pub-id pub-id-type="pmid">29941873</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>H</given-names></string-name>, <string-name><surname>Park</surname><given-names>H.</given-names></string-name></person-group><year>2007</year>. 
<article-title>Sparse non-negative matrix factorizations via alternating non-negativity-constrained least squares for microarray data analysis</article-title>. <source>Bioinformatics</source>. <volume>23</volume>:<fpage>1495</fpage>–<lpage>1502</lpage>.<pub-id pub-id-type="pmid">17483501</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Andrews</surname><given-names>TS</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M.</given-names></string-name></person-group><year>2019</year>. 
<article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>. <source>Nat Rev Genet</source>. <volume>20</volume>:<fpage>273</fpage>–<lpage>282</lpage>.<pub-id pub-id-type="pmid">30617341</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Kirschner</surname><given-names>K</given-names></string-name>, <string-name><surname>Schaub</surname><given-names>MT</given-names></string-name>, <string-name><surname>Andrews</surname><given-names>T</given-names></string-name>, <string-name><surname>Yiu</surname><given-names>A</given-names></string-name></person-group>, <etal>et al</etal><year>2017</year>. 
<article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat Methods</source>. <volume>14</volume>:<fpage>483</fpage>–<lpage>486</lpage>.<pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klein</surname><given-names>AM</given-names></string-name>, <string-name><surname>Mazutis</surname><given-names>L</given-names></string-name>, <string-name><surname>Akartuna</surname><given-names>I</given-names></string-name>, <string-name><surname>Tallapragada</surname><given-names>N</given-names></string-name>, <string-name><surname>Veres</surname><given-names>A</given-names></string-name></person-group>, <etal>et al</etal><year>2015</year>. 
<article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source>. <volume>161</volume>:<fpage>1187</fpage>–<lpage>1201</lpage>.<pub-id pub-id-type="pmid">26000487</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kolodziejczyk</surname><given-names>AA</given-names></string-name>, <string-name><surname>Kim</surname><given-names>JK</given-names></string-name>, <string-name><surname>Tsang</surname><given-names>JCH</given-names></string-name>, <string-name><surname>Ilicic</surname><given-names>T</given-names></string-name>, <string-name><surname>Henriksson</surname><given-names>J</given-names></string-name></person-group>, <etal>et al</etal><year>2015</year>. 
<article-title>Single cell RNA-sequencing of pluripotent states unlocks modular transcriptional variation</article-title>. <source>Cell Stem Cell</source>. <volume>17</volume>:<fpage>471</fpage>–<lpage>485</lpage>.<pub-id pub-id-type="pmid">26431182</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Courtois</surname><given-names>ET</given-names></string-name>, <string-name><surname>Sengupta</surname><given-names>D</given-names></string-name>, <string-name><surname>Tan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>KH</given-names></string-name></person-group>, <etal>et al</etal><year>2017</year>. 
<article-title>Reference component analysis of single-cell transcriptomes elucidates cellular heterogeneity in human colorectal tumors</article-title>. <source>Nat Genet</source>. <volume>49</volume>:<fpage>708</fpage>–<lpage>718</lpage>.<pub-id pub-id-type="pmid">28319088</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>B</given-names></string-name>, <string-name><surname>Gould</surname><given-names>J</given-names></string-name>, <string-name><surname>Yang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Sarkizova</surname><given-names>S</given-names></string-name>, <string-name><surname>Tabaka</surname><given-names>M</given-names></string-name></person-group>, <etal>et al</etal><year>2020a</year>. 
<article-title>Cumulus provides cloud-based data analysis for large-scale single-cell and single-nucleus RNA-seq</article-title>. <source>Nat Methods</source>. <volume>17</volume>:<fpage>793</fpage>–<lpage>798</lpage>.<pub-id pub-id-type="pmid">32719530</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>J</given-names></string-name>, <string-name><surname>Yu</surname><given-names>C</given-names></string-name>, <string-name><surname>Ma</surname><given-names>L</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Guo</surname><given-names>G.</given-names></string-name></person-group><year>2020b</year>. 
<article-title>Comparison of Scanpy-based algorithms to remove the batch effect from single-cell RNA-seq data</article-title>. <source>Cell Regen</source>. <volume>9</volume>:<fpage>10</fpage>.<pub-id pub-id-type="pmid">32632608</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Lou</surname><given-names>H</given-names></string-name>, <string-name><surname>Xie</surname><given-names>K</given-names></string-name>, <string-name><surname>Wang</surname><given-names>H</given-names></string-name>, <string-name><surname>Chen</surname><given-names>N</given-names></string-name></person-group>, <etal>et al</etal><year>2017</year>. 
<article-title>Reconstructing cell cycle pseudo time-series via single-cell transcriptome data</article-title>. <source>Nat Commun</source>. <volume>8</volume>:<fpage>1</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28232747</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B26">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Lu</surname><given-names>X</given-names></string-name>, <string-name><surname>Gao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Li</surname><given-names>J</given-names></string-name>, <string-name><surname>He</surname><given-names>K</given-names></string-name>, <string-name><surname>Chen</surname><given-names>G</given-names></string-name></person-group>, <etal>et al</etal><year>2020</year>. <part-title>Identification of cell types from single-cell transcriptomes using a novel clustering framework BT</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Huang</surname><given-names>D-S</given-names></string-name>, <string-name><surname>Bevilacqua</surname><given-names>V</given-names></string-name>, <string-name><surname>Hussain</surname><given-names>A</given-names></string-name></person-group>, editors. <source>Intelligent Computing Theories and Application</source>. 
<publisher-loc>Cham</publisher-loc>: 
<publisher-name>Springer International Publishing</publisher-name>, p. <fpage>17</fpage>–<lpage>27</lpage>.</mixed-citation>
    </ref>
    <ref id="jkab098-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pollen</surname><given-names>AA</given-names></string-name>, <string-name><surname>Nowakowski</surname><given-names>TJ</given-names></string-name>, <string-name><surname>Shuga</surname><given-names>J</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X</given-names></string-name>, <string-name><surname>Leyrat</surname><given-names>AA</given-names></string-name></person-group>, <etal>et al</etal><year>2014</year>. 
<article-title>Low-coverage single-cell mRNA sequencing reveals cellular heterogeneity and activated signaling pathways in developing cerebral cortex</article-title>. <source>Nat Biotechnol</source>. <volume>32</volume>:<fpage>1053</fpage>–<lpage>1058</lpage>.<pub-id pub-id-type="pmid">25086649</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qi</surname><given-names>R</given-names></string-name>, <string-name><surname>Ma</surname><given-names>A</given-names></string-name>, <string-name><surname>Ma</surname><given-names>Q</given-names></string-name>, <string-name><surname>Zou</surname><given-names>Q.</given-names></string-name></person-group><year>2020</year>. 
<article-title>Clustering and classification methods for single-cell RNA-sequencing data</article-title>. <source>Brief Bioinform</source>. <volume>21</volume>:<fpage>1196</fpage>–<lpage>1208</lpage>.<pub-id pub-id-type="pmid">31271412</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Soneson</surname><given-names>C</given-names></string-name>, <string-name><surname>Robinson</surname><given-names>MD.</given-names></string-name></person-group><year>2018</year>. 
<article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title>. <source>Nat Methods</source>. <volume>15</volume>:<fpage>255</fpage>–<lpage>261</lpage>.<pub-id pub-id-type="pmid">29481549</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T</given-names></string-name>, <string-name><surname>Butler</surname><given-names>A</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name>, <string-name><surname>Hafemeister</surname><given-names>C</given-names></string-name>, <string-name><surname>Papalexi</surname><given-names>E</given-names></string-name></person-group>, <etal>et al</etal><year>2019</year>. 
<article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source>. <volume>177</volume>:<fpage>1888</fpage>–<lpage>1902.e21</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname><given-names>L</given-names></string-name>, <string-name><surname>Dong</surname><given-names>X</given-names></string-name>, <string-name><surname>Freytag</surname><given-names>S</given-names></string-name>, <string-name><surname>Cao</surname><given-names>KAL</given-names></string-name>, <string-name><surname>Su</surname><given-names>S</given-names></string-name></person-group>, <etal>et al</etal><year>2019</year>. 
<article-title>Benchmarking single cell RNA-sequencing analysis pipelines using mixture control experiments</article-title>. <source>Nat Methods</source>. <volume>16</volume>:<fpage>479</fpage>–<lpage>487</lpage>.<pub-id pub-id-type="pmid">31133762</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tong</surname><given-names>W</given-names></string-name>, <string-name><surname>Yang</surname><given-names>X</given-names></string-name>, <string-name><surname>Pan</surname><given-names>M</given-names></string-name>, <string-name><surname>Chen</surname><given-names>F.</given-names></string-name></person-group><year>2020</year>. 
<article-title>Spectral mesh segmentation via l0 gradient minimization</article-title>. <source>IEEE Trans Vis Comput Graph</source>. <volume>26</volume>:<fpage>1807</fpage>–<lpage>1820</lpage>.<pub-id pub-id-type="pmid">30452373</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Treutlein</surname><given-names>B</given-names></string-name>, <string-name><surname>Brownfield</surname><given-names>DG</given-names></string-name>, <string-name><surname>Wu</surname><given-names>AR</given-names></string-name>, <string-name><surname>Neff</surname><given-names>NF</given-names></string-name>, <string-name><surname>Mantalas</surname><given-names>GL</given-names></string-name></person-group>, <etal>et al</etal><year>2014</year>. 
<article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>. <source>Nature</source>. <volume>509</volume>:<fpage>371</fpage>–<lpage>375</lpage>.<pub-id pub-id-type="pmid">24739965</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Usoskin</surname><given-names>D</given-names></string-name>, <string-name><surname>Furlan</surname><given-names>A</given-names></string-name>, <string-name><surname>Islam</surname><given-names>S</given-names></string-name>, <string-name><surname>Abdo</surname><given-names>H</given-names></string-name>, <string-name><surname>Lönnerberg</surname><given-names>P</given-names></string-name></person-group>, <etal>et al</etal><year>2015</year>. 
<article-title>Unbiased classification of sensory neuron types by large-scale single-cell RNA sequencing</article-title>. <source>Nat Neurosci</source>. <volume>18</volume>:<fpage>145</fpage>–<lpage>153</lpage>.<pub-id pub-id-type="pmid">25420068</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B36">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Vans</surname><given-names>E</given-names></string-name>, <string-name><surname>Sharma</surname><given-names>A</given-names></string-name>, <string-name><surname>Patil</surname><given-names>A</given-names></string-name>, <string-name><surname>Shigemizu</surname><given-names>D</given-names></string-name>, <string-name><surname>Tsunoda</surname><given-names>T.</given-names></string-name></person-group><year>2019</year>. <part-title>Clustering of small-sample single-cell rna-seq data via feature clustering and selection BT</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Nayak</surname><given-names>AC</given-names></string-name>, <string-name><surname>Sharma</surname><given-names>A</given-names></string-name></person-group>, editors. <source>PRICAI 2019: Trends in Artificial Intelligence</source>. 
<publisher-loc>Cham</publisher-loc>: 
<publisher-name>Springer International Publishing</publisher-name>, p. <fpage>445</fpage>–<lpage>456</lpage>.</mixed-citation>
    </ref>
    <ref id="jkab098-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>B</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>J</given-names></string-name>, <string-name><surname>Pierson</surname><given-names>E</given-names></string-name>, <string-name><surname>Ramazzotti</surname><given-names>D</given-names></string-name>, <string-name><surname>Batzoglou</surname><given-names>S.</given-names></string-name></person-group><year>2017</year>. 
<article-title>Visualization and analysis of single-cell RNA-seq data by kernel-based similarity learning</article-title>. <source>Nat Methods</source>. <volume>14</volume>:<fpage>414</fpage>–<lpage>416</lpage>.<pub-id pub-id-type="pmid">28263960</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Angerer</surname><given-names>P</given-names></string-name>, <string-name><surname>Theis</surname><given-names>FJ.</given-names></string-name></person-group><year>2018</year>. 
<article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source>. <volume>19</volume>:<fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>FA</given-names></string-name>, <string-name><surname>Hamey</surname><given-names>FK</given-names></string-name>, <string-name><surname>Plass</surname><given-names>M</given-names></string-name>, <string-name><surname>Solana</surname><given-names>J</given-names></string-name>, <string-name><surname>Dahlin</surname><given-names>JS</given-names></string-name></person-group>, <etal>et al</etal><year>2019</year>. 
<article-title>PAGA: graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title>. <source>Genome Biol</source>. <volume>20</volume>:<fpage>59</fpage>.<pub-id pub-id-type="pmid">30890159</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yan</surname><given-names>L</given-names></string-name>, <string-name><surname>Yang</surname><given-names>M</given-names></string-name>, <string-name><surname>Guo</surname><given-names>H</given-names></string-name>, <string-name><surname>Yang</surname><given-names>L</given-names></string-name>, <string-name><surname>Wu</surname><given-names>J</given-names></string-name></person-group>, <etal>et al</etal><year>2013</year>. 
<article-title>Single-cell RNA-Seq profiling of human preimplantation embryos and embryonic stem cells</article-title>. <source>Nat Struct Mol Biol</source>. <volume>20</volume>:<fpage>1131</fpage>–<lpage>1139</lpage>.<pub-id pub-id-type="pmid">23934149</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>F</given-names></string-name>, <string-name><surname>Wang</surname><given-names>M.</given-names></string-name></person-group><year>2020</year>. 
<article-title>A review of systematic evaluation and improvement in the big data environment</article-title>. <source>Front Eng Manag</source>. <volume>7</volume>:<fpage>27</fpage>–<lpage>46</lpage>.</mixed-citation>
    </ref>
    <ref id="jkab098-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ye</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>W</given-names></string-name>, <string-name><surname>Futamura</surname><given-names>Y</given-names></string-name>, <string-name><surname>Sakurai</surname><given-names>T.</given-names></string-name></person-group><year>2020</year>. 
<article-title>Detecting interactive gene groups for single-cell RNA-seq data based on co-expression network analysis and subgraph learning</article-title>. <source>Cells</source>. <volume>9</volume>:<fpage>1938</fpage>.</mixed-citation>
    </ref>
    <ref id="jkab098-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zappia</surname><given-names>L</given-names></string-name>, <string-name><surname>Phipson</surname><given-names>B</given-names></string-name>, <string-name><surname>Oshlack</surname><given-names>A.</given-names></string-name></person-group><year>2018</year>. 
<article-title>Exploring the single-cell RNA-seq analysis landscape with the scRNA-tools database</article-title>. <source>PLoS Comput Biol</source>. <volume>14</volume>:<fpage>e1006245</fpage>.<pub-id pub-id-type="pmid">29939984</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeisel</surname><given-names>A</given-names></string-name>, <string-name><surname>Munoz-Manchado</surname><given-names>AB</given-names></string-name>, <string-name><surname>Codeluppi</surname><given-names>S</given-names></string-name>, <string-name><surname>Lonnerberg</surname><given-names>P</given-names></string-name>, <string-name><surname>Manno</surname><given-names>GL</given-names></string-name></person-group>, <etal>et al</etal><year>2015</year>. 
<article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>. <source>Science</source>. <volume>347</volume>:<fpage>1138</fpage>–<lpage>1142</lpage>.<pub-id pub-id-type="pmid">25700174</pub-id></mixed-citation>
    </ref>
    <ref id="jkab098-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>L</given-names></string-name>, <string-name><surname>Yu</surname><given-names>X</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>L</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name></person-group>, <etal>et al</etal><year>2018</year>. 
<article-title>Lineage tracking reveals dynamic relationships of T cells in colorectal cancer</article-title>. <source>Nature</source>. <volume>564</volume>:<fpage>268</fpage>–<lpage>272</lpage>.<pub-id pub-id-type="pmid">30479382</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
