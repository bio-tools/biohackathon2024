<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName archivearticle.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Genet</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Genet.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-8021</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8024626</article-id>
    <article-id pub-id-type="doi">10.3389/fgene.2021.650795</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Genetics</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SMIXnorm: Fast and Accurate RNA-Seq Data Normalization for Formalin-Fixed Paraffin-Embedded Samples</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yin</surname>
          <given-names>Shen</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/1213279/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhan</surname>
          <given-names>Xiaowei</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/915576/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yao</surname>
          <given-names>Bo</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xiao</surname>
          <given-names>Guanghua</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/895082/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xinlei</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/1192983/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xie</surname>
          <given-names>Yang</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="c002">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Department of Population and Data Sciences, Quantitative Biomedical Research Center, The University of Texas Southwestern Medical Center</institution>, <addr-line>Dallas, TX</addr-line>, <country>United States</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Department of Statistical Science, Southern Methodist University</institution>, <addr-line>Dallas, TX</addr-line>, <country>United States</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Chaeyoung Lee, Soongsil University, South Korea</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Arpit Tandon, Sciome LLC, United States; Bruce Alex Merrick, National Institute of Environmental Health Sciences (NIEHS), United States</p>
      </fn>
      <corresp id="c001">*Correspondence: Xinlei Wang <email>swang@smu.edu</email></corresp>
      <corresp id="c002">Yang Xie <email>Yang.Xie@UTSouthwestern.edu</email></corresp>
      <fn fn-type="other" id="fn001">
        <p>This article was submitted to Statistical Genetics and Methodology, a section of the journal Frontiers in Genetics</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>12</volume>
    <elocation-id>650795</elocation-id>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>01</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2021 Yin, Zhan, Yao, Xiao, Wang and Xie.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Yin, Zhan, Yao, Xiao, Wang and Xie</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>RNA-sequencing (RNA-seq) provides a comprehensive quantification of transcriptomic activities in biological samples. Formalin-Fixed Paraffin-Embedded (FFPE) samples are collected as part of routine clinical procedure, and are the most widely available biological sample format in medical research and patient care. Normalization is an essential step in RNA-seq data analysis. A number of normalization methods, though developed for RNA-seq data from fresh frozen (FF) samples, can be used with FFPE samples as well. The only extant normalization method specifically designed for FFPE RNA-seq data, MIXnorm, which has been shown to outperform the normalization methods, but at the cost of a complex mixture model and a high computational burden. It is therefore important to adapt MIXnorm for simplicity and computational efficiency while maintaining superior performance. Furthermore, it is critical to develop an integrated tool that performs commonly used normalization methods for both FF and FFPE RNA-seq data. We developed a new normalization method for FFPE RNA-seq data, named SMIXnorm, based on a simplified two-component mixture model compared to MIXnorm to facilitate computation. The expression levels of expressed genes are modeled by normal distributions without truncation, and those of non-expressed genes are modeled by zero-inflated Poisson distributions. The maximum likelihood estimates of the model parameters are obtained by a nested Expectation-Maximization algorithm with a less complicated latent variable structure, and closed-form updates are available within each iteration. Real data applications and simulation studies show that SMIXnorm greatly reduces computing time compared to MIXnorm, without sacrificing the performance. More importantly, we developed a web-based tool, <italic>RNA-seq Normalization (RSeqNorm)</italic>, that offers a simple workflow to compute normalized RNA-seq data for both FFPE and FF samples. It includes SMIXnorm and MIXnorm for FFPE RNA-seq data, together with five commonly used normalization methods for FF RNA-seq data. Users can easily upload a raw RNA-seq count matrix and select one of the seven normalization methods to produce a downloadable normalized expression matrix for any downstream analysis. The R package is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/S-YIN/RSEQNORM">https://github.com/S-YIN/RSEQNORM</ext-link>. The web-based tool, <italic>RSeqNorm</italic> is available at <ext-link ext-link-type="uri" xlink:href="http://lce.biohpc.swmed.edu/rseqnorm">http://lce.biohpc.swmed.edu/rseqnorm</ext-link> with no restriction to use or redistribute.</p>
    </abstract>
    <kwd-group>
      <kwd>RNA-sequencing</kwd>
      <kwd>normalization</kwd>
      <kwd>FFPE</kwd>
      <kwd>formalin-fixed paraffin-embedded samples</kwd>
      <kwd>archived samples</kwd>
      <kwd>statistical methods</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source id="cn001">National Institute of General Medical Sciences<named-content content-type="fundref-id">10.13039/100000057</named-content></funding-source>
        <award-id rid="cn001">R01GM140012</award-id>
        <award-id rid="cn001">R15GM131390</award-id>
        <award-id rid="cn001">R35GM136375</award-id>
      </award-group>
    </funding-group>
    <counts>
      <fig-count count="6"/>
      <table-count count="4"/>
      <equation-count count="10"/>
      <ref-count count="23"/>
      <page-count count="11"/>
      <word-count count="7426"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>1. Introduction</title>
    <p>The application of next-generation sequencing (NGS) on measuring transcript abundance is widely known as RNA-seq. RNA-seq works by sequencing a library of cDNA fragments in a high-throughput manner in order to provide a comprehensive quantification of transcriptomic activities in biological samples (Quinn et al., <xref rid="B18" ref-type="bibr">2018</xref>). In practice, normalization is an important step in RNA-seq data analysis since raw counts are often not directly comparable between samples (Dillies et al., <xref rid="B4" ref-type="bibr">2013</xref>). Normalization brings out the biologically relevant information in gene expression by removing the systematic noise that arises from various experimental reasons (such as batch effect, lane effect, sequencing bias, etc.). Recent studies have shown that the raw sequencing data without normalization could cause invalid inference from many conventional statistical analyses and measurements (Quinn et al., <xref rid="B18" ref-type="bibr">2018</xref>).</p>
    <p>Fresh-frozen (FF) tissue biospecimens are considered the gold standard in molecular analysis using gene expression, as freezing preserves RNA well. A number of normalization methods have been well-studied on FF bulk RNA-seq data (Dillies et al., <xref rid="B4" ref-type="bibr">2013</xref>). Most existing methods, including Reads Per Million (RPM), Upper-Quartile (UQ), DESeq, Trimmed Mean of <italic>M</italic>-values (TMM), etc., are based on scaling factor estimation, where the normalized expression is obtained by dividing the raw count by an estimate of the sample-specific scaling factor. For example, RPM (Mortazavi et al., <xref rid="B15" ref-type="bibr">2008</xref>) estimates the scaling factor for each sample by the total number of reads divided by 1, 000, 000. Similarly, UQ (Bullard et al., <xref rid="B3" ref-type="bibr">2010</xref>) estimates the scaling factor by the upper quartile of counts across all genes for each sample. DESeq (Anders and Huber, <xref rid="B1" ref-type="bibr">2010</xref>) normalization first calculates the geometric means of the counts for all genes as an average reference library. Then the ratio of the count in each sample to that in the reference library is computed. The scaling factor for each sample is estimated as the median of this ratio across all genes. TMM (Robinson and Oshlack, <xref rid="B19" ref-type="bibr">2010</xref>) normalization selects one sample as a reference, and the <italic>M</italic>-values are calculated as the log ratios of the read count between each test sample and the reference for all genes. Then for each test sample, the scaling factor is estimated by the weighted mean of <italic>M</italic>-values after removing the genes with extreme average expression or <italic>M</italic>-values. On the other hand, normalization can be done implicitly by accounting for the size factor as a term in the RNA-seq data model. PoissonSeq (PS) (Li et al., <xref rid="B12" ref-type="bibr">2012</xref>) models RNA-seq data by a Poisson log-linear model, where a set of sample-specific parameters is included as offset parameters in the linear predictor to account for different sequencing depths.</p>
    <p>Recently, there has been increasing interest in performing transcriptome profiling on Formalin-Fixed Paraffin-Embedded (FFPE) tissues, as they are widely available from routine diagnostic sample preparation (Morton et al., <xref rid="B16" ref-type="bibr">2014</xref>). Being able to successfully measure mRNA abundance from FFPE samples could greatly facilitate biomarker discoveries and genomic studies of clinical samples (Graw et al., <xref rid="B7" ref-type="bibr">2015</xref>; Grenier et al., <xref rid="B8" ref-type="bibr">2017</xref>). The major challenge of adapting FFPE biospecimens in molecular analysis is that the chemical process is designed to preserve cellular proteins rather than preserving RNA. As a result, RNA from FFPE tissues is usually degraded, which could limit gene expression analysis. Studies have shown that the fixation process, storage time, specimen size and conditions play important roles in the RNA quality from FFPE samples (Von Ahlfen et al., <xref rid="B22" ref-type="bibr">2007</xref>). Although such samples may suffer from the chemical modifications and continued degradation over time, recent studies have shown that RNA-seq can measure the RNA expression from FFPE samples in sufficient quality (Li et al., <xref rid="B13" ref-type="bibr">2014</xref>). Due to chemical modifications and the RNA degradation, the RNA quality and abundance extracted from the FFPE samples vary a lot. Therefore, the normalization step is even more important for RNA-seq data measured from FFPE samples than those measured from FF samples. Though the forementioned existing methods are applicable to FFPE RNA-seq data, none of them were specifically designed and validated on FFPE samples. The mRNA expression measured from FFPE can have lower quality and higher sparsity (i.e., many zero counts occur), compared with FF samples. Consequently, the zero-inflation makes the assumption of model-based FF RNA-seq normalization invalid. For most scaling factor-based RNA-seq normalization, practitioners need to discard genes with many zeros beforehand, which may be a significant portion of the data when applied to FFPE samples. To the best of our knowledge, MIXnorm (Yin et al., <xref rid="B23" ref-type="bibr">2020</xref>) is the only method that is designed to normalize FFPE RNA-seq data but that is applicable to FF RNA-seq data as well. MIXnorm addresses the zero inflation by separately modeling the expressed genes and non-expressed genes in a mixture model. Yin et al. (<xref rid="B23" ref-type="bibr">2020</xref>) considered normalized expression from paired FF (or like) samples as a surrogate of the truth and showed quantitatively that MIXnorm consistently outperforms commonly used FF RNA-seq normalization methods when applied on FFPE samples by comparing the gene-wise correlations. In addition, it has been shown that after MIXnorm normalization, RNA-seq data from FFPE tissues enable us to detect important up- or down-regulated genes. However, MIXnorm relies on a complex latent variable structure for model fitting, which causes a heavy computational burden for large data sets. We show in this paper that the statistical model of MIXnorm can be properly simplified to still capture the main characteristics of the FFPE RNA-seq data. We propose a simplified version of MIXnorm, labeled SMIXnorm, for FFPE RNA-seq data normalization. The fitting of SMIXnorm requires a less complicated latent variable structure. We show through simulation studies and real data applications that SMIXnorm retains almost the same performance as MIXnorm, while greatly reducing the computing time.</p>
    <p>More importantly, there is a lack of platforms that integrate existing methods and produce normalized data by different methods. Evans et al. (<xref rid="B6" ref-type="bibr">2018</xref>) mentioned that the selection of normalization methods played an important role in downstream analysis due to the different assumptions those methods made. Furthermore, it is important to raise the awareness of the separate normalization methods for FFPE samples, as more and more applications involve RNA-seq data from such samples. We developed a web portal, <italic>RNA-seq Normalization (RSeqNorm)</italic> (<ext-link ext-link-type="uri" xlink:href="http://lce.biohpc.swmed.edu/rseqnorm/">http://lce.biohpc.swmed.edu/rseqnorm/</ext-link>), to conduct normalization for both FF and FFPE RNA-seq data. It offers seven normalization methods, with accompanying diagnostic plots for users to visually examine the RNA-seq data quality. Based on this platform, we compared different normalization methods using both comprehensive simulation studies and real data applications. These results, together with the <italic>RSeqNorm</italic> web portal, will facilitate users to select the best normalization method for their application.</p>
    <p>The paper is structured as follows. In section 2.1, we present the SMIXnorm method. The statistical model of SMIXnorm is simplified from that of MIXnorm. An efficient nested Expectation-Maximization (EM) algorithm is designed for model fitting. We further justify the simplifications by comparing SMIXnorm to MIXnorm from a technical point of view. An introduction of the web portal <italic>RSeqNorm</italic> is given in section 2.2. Section 3 reports simulation studies and real data analyses. Finally, a brief concluding discussion is made in section 4.</p>
  </sec>
  <sec sec-type="materials and methods" id="s2">
    <title>2. Materials and Methods</title>
    <sec>
      <title>2.1. The SMIXnorm Method</title>
      <sec>
        <title>2.1.1. The Simplified Statistical Model</title>
        <p>Assume the RNA-seq count data from FFPE samples can be summarized by a matrix <bold><italic>C</italic></bold><sub><italic>I</italic>× <italic>J</italic></sub>, where <italic>C</italic><sub><italic>ij</italic></sub> is the number of reads in sample <italic>i</italic> for gene <italic>j</italic>. We adopt a similar latent variable framework as in MIXnorm to address the zero inflation of such data. That is, the binary latent variable <italic>D</italic><sub><italic>j</italic></sub> = 1 indicates gene <italic>j</italic> is expressed and <italic>D</italic><sub><italic>j</italic></sub> = 0 indicates gene <italic>j</italic> is not expressed in the study for <italic>j</italic> = 1, ..., <italic>J</italic>. Then we model the count data as a mixture of zero-inflated Poisson (ZIP) and normal distributions,</p>
        <disp-formula id="E1">
          <label>(1)</label>
          <mml:math id="M1">
            <mml:mtable class="eqnarray" columnalign="right center left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>C</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>~</mml:mo>
                  <mml:mtext class="textrm" mathvariant="normal">ZIP</mml:mtext>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>π</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mi>δ</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mtext class="textrm" mathvariant="normal">if</mml:mtext>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <disp-formula id="E2">
          <label>(2)</label>
          <mml:math id="M2">
            <mml:mtable class="eqnarray" columnalign="right center left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>L</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>~</mml:mo>
                  <mml:mtext class="textrm" mathvariant="normal">N</mml:mtext>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>μ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mtext class="textrm" mathvariant="normal">if</mml:mtext>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <disp-formula id="E3">
          <label>(3)</label>
          <mml:math id="M3">
            <mml:mtable class="eqnarray" columnalign="right center left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>~</mml:mo>
                  <mml:mtext class="textrm" mathvariant="normal">Ber</mml:mtext>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>ϕ</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where <italic>L</italic><sub><italic>ij</italic></sub> = log(<italic>C</italic><sub><italic>ij</italic></sub>+1) denotes the log transformed count, 0 ≤ π<sub><italic>j</italic></sub>, ϕ ≤ 1, δ, μ<sub><italic>i</italic></sub>, σ<sub><italic>i</italic></sub>≥0 for <italic>i</italic> = 1, ..., <italic>I</italic> and <italic>j</italic> = 1, ...<italic>J</italic>. The model assumes an unobserved variable <italic>D</italic><sub><italic>j</italic></sub> which follows a Bernoulli distribution with parameter ϕ. Genes with <italic>D</italic><sub><italic>j</italic></sub> = 0 are considered not expressed. These include low-expression genes that have abundance below detection limit, or biologically non-expressed genes that are absent from the biological sample of interest, or genes that should have been expressed but suffer from high-level mRNA degradation. The observed counts from non-expressed genes are due to background noise and are modeled by a zero-inflated Poisson distribution with gene-specific probability of extra zeros π<sub><italic>j</italic></sub> and a common expected Poisson count δ. Genes with <italic>D</italic><sub><italic>j</italic></sub> = 1 are expressed genes and we model the log counts of those genes by a normal distribution with sample-specific location and scale parameters. Compared to the model of MIXnorm, we use the normal distribution in (2) instead of a truncated normal distribution and a common Poisson mean δ rather than the sample-specific mean δ<sub><italic>i</italic></sub>. As will be discussed in section 2.1.3, these would greatly facilitate the computation while not hurting much the performance. Note that the normal distribution assigns positive densities to negative log counts <italic>L</italic><sub><italic>ij</italic></sub>, which never occur in real data. However, it is reasonable to assume that the negative values only take a negligible portion of the density in modeling expressed genes as the mean (log) counts of such genes are usually well above zero. Further, SMIXnorm is directly applicable to FF or like samples based on the same argument in Yin et al. (<xref rid="B23" ref-type="bibr">2020</xref>) that FF samples may be considered a reduced case of FFPE samples.</p>
      </sec>
      <sec>
        <title>2.1.2. Model Fitting</title>
        <p>Let Θ = (<bold>μ</bold>, <bold>σ</bold>, <bold>π</bold>, δ, ϕ) denote the set of all parameters in the simplified model. The observed data likelihood as a function of Θ is defined as follow:</p>
        <disp-formula id="E5">
          <label>(4)</label>
          <mml:math id="M5">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>L</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>Θ</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mstyle mathvariant="bold-italic" mathsize="normal">
                    <mml:mi>C</mml:mi>
                  </mml:mstyle>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>J</mml:mi>
                    </mml:munderover>
                    <mml:mi>p</mml:mi>
                  </mml:mstyle>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mstyle mathvariant="bold-italic" mathsize="normal">
                      <mml:mi>C</mml:mi>
                    </mml:mstyle>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:mi>Θ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>                   </mml:mtext>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>J</mml:mi>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mo stretchy="false">[</mml:mo>
                      <mml:mi>p</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:msub>
                    <mml:mstyle mathvariant="bold-italic" mathsize="normal">
                      <mml:mi>C</mml:mi>
                    </mml:mstyle>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mi>D</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mstyle mathvariant="bold-italic" mathsize="normal">
                    <mml:mi>μ</mml:mi>
                  </mml:mstyle>
                  <mml:mo>,</mml:mo>
                  <mml:mstyle mathvariant="bold-italic" mathsize="normal">
                    <mml:mi>σ</mml:mi>
                  </mml:mstyle>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>p</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>D</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>|</mml:mo>
                  <mml:mi>ϕ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>                  </mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mi>p</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mstyle mathvariant="bold-italic" mathsize="normal">
                      <mml:mi>C</mml:mi>
                    </mml:mstyle>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mi>D</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mi>π</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:mi>δ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>p</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>D</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>|</mml:mo>
                  <mml:mi>ϕ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>                  </mml:mtext>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>J</mml:mi>
                    </mml:munderover>
                    <mml:mo stretchy="false">[</mml:mo>
                  </mml:mstyle>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>C</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:msub>
                    <mml:mi>D</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mi>μ</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mi>σ</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mtext> </mml:mtext>
                  <mml:mo>⋅</mml:mo>
                  <mml:mtext> </mml:mtext>
                  <mml:mi>ϕ</mml:mi>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>                  </mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>I</mml:mi>
                    </mml:munderover>
                    <mml:mi>p</mml:mi>
                  </mml:mstyle>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>C</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mi>D</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mi>π</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:mi>δ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>·</mml:mo>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>−</mml:mo>
                  <mml:mi>ϕ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">]</mml:mo>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where <italic>p</italic>(<italic>C</italic><sub><italic>ij</italic></sub>|<italic>D</italic><sub><italic>j</italic></sub> = 1, μ<sub><italic>i</italic></sub>, σ<sub><italic>i</italic></sub>) is the probability density function (pdf) of <italic>C</italic><sub><italic>ij</italic></sub> for expressed genes such that log(<italic>C</italic><sub><italic>ij</italic></sub>+1) follows the normal distribution in (2), and <italic>p</italic>(<italic>C</italic><sub><italic>ij</italic></sub>|<italic>D</italic><sub><italic>j</italic></sub> = 0, π<sub><italic>j</italic></sub>, δ) is the zero-inflated Poisson probability mass function (pmf) for non-expressed genes as described in (1). Note that a continuous distribution is used to approximately model the discrete random variable log(<italic>C</italic><sub><italic>ij</italic></sub>+1). See Yin et al. (<xref rid="B23" ref-type="bibr">2020</xref>) for a detailed justification for the approximation.</p>
        <p>A common approach to obtain the maximum likelihood estimate (MLE) of Θ is to treat (<bold>C</bold>, <bold>D</bold>) as the complete data and update the parameter estimates iteratively by an EM algorithm. However, direct implementation of the EM algorithm requires Newton-Raphson type maximization to update the parameters within the ZIP component, which may cause the EM algorithm fail to converge due to numerical instability. By a similar approach in Yin et al. (<xref rid="B23" ref-type="bibr">2020</xref>), we update the parameter estimates from the ZIP component by nesting another EM algorithm and avoid the Newton-Raphson type optimization. Specifically, we construct another latent variable <italic>Z</italic><sub><italic>ij</italic></sub> for genes not expressed so that the ZIP distribution can be treated as a mixture of two states, the perfect zero state and the Poisson state. Assume <italic>Z</italic><sub><italic>ij</italic></sub> = 1 when <italic>C</italic><sub><italic>ij</italic></sub> is from the perfect zero state and <italic>Z</italic><sub><italic>ij</italic></sub> = 0 when <italic>C</italic><sub><italic>ij</italic></sub> is from the Poisson state, satisfying <italic>Z</italic><sub><italic>ij</italic></sub>|<italic>D</italic><sub><italic>j</italic></sub> = 0 ~ Ber(π<sub><italic>j</italic></sub>). Let <bold><italic>Y</italic></bold><sub>com</sub> = (<bold><italic>C</italic></bold>, <bold><italic>D</italic></bold>, <bold><italic>Z</italic></bold>) denotes the complete data. The complete-data log-likelihood with latent variables <bold><italic>D</italic></bold> and <bold>Z</bold> is given by</p>
        <disp-formula id="E6">
          <label>(5)</label>
          <mml:math id="M6">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>ℓ</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>Θ</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mstyle mathvariant="bold-italic" mathsize="normal">
                    <mml:mi>C</mml:mi>
                  </mml:mstyle>
                  <mml:mo>,</mml:mo>
                  <mml:mstyle mathvariant="bold-italic" mathsize="normal">
                    <mml:mi>D</mml:mi>
                  </mml:mstyle>
                  <mml:mo>,</mml:mo>
                  <mml:mstyle mathvariant="bold-italic" mathsize="normal">
                    <mml:mi>Z</mml:mi>
                  </mml:mstyle>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>J</mml:mi>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munderover>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mi>I</mml:mi>
                        </mml:munderover>
                        <mml:mo>{</mml:mo>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:msub>
                    <mml:mi>D</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mi>log</mml:mi>
                      <mml:mi>ϕ</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mi>log</mml:mi>
                      <mml:mtext>N</mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mtext>L</mml:mtext>
                            <mml:mrow>
                              <mml:mtext>ij</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mtext>|</mml:mtext>
                          <mml:msub>
                            <mml:mi>μ</mml:mi>
                            <mml:mtext>i</mml:mtext>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:msub>
                            <mml:mi>σ</mml:mi>
                            <mml:mtext>i</mml:mtext>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mi>log</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msub>
                        <mml:mi>C</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>                                </mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mi>D</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mi>log</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:mi>ϕ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>Z</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mi>log</mml:mi>
                      <mml:msub>
                        <mml:mi>π</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mtext>                               </mml:mtext>
                      <mml:mo>+</mml:mo>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mi>Z</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mi>log</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mi>π</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>                              </mml:mtext>
                  <mml:mo>+</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mi>D</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mi>Z</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>C</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mi>log</mml:mi>
                      <mml:mi>δ</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mi>δ</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mi>log</mml:mi>
                      <mml:msub>
                        <mml:mi>C</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>!</mml:mo>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mo>}</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>The outer EM treats <bold>C</bold> as observed data and <bold>D</bold> as missing data. Let Θ<sup>(<italic>t</italic>)</sup> = (<bold>μ</bold><sup>(<italic>t</italic>)</sup>, <bold>σ</bold><sup>(<italic>t</italic>)</sup>, <bold>π</bold><sup>(<italic>t</italic>)</sup>, δ<sup>(<italic>t</italic>)</sup>, ϕ<sup>(<italic>t</italic>)</sup>) denote the set of current parameter estimates after <italic>t</italic> iterations of the algorithm. The distribution of <bold><italic>D</italic></bold> given the observed data and Θ<sup>(<italic>t</italic>)</sup> is</p>
        <disp-formula id="E8">
          <label>(6)</label>
          <mml:math id="M8">
            <mml:mtable class="eqnarray" columnalign="right center left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>p</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>D</mml:mi>
                      </mml:mstyle>
                      <mml:mo stretchy="false">|</mml:mo>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>C</mml:mi>
                      </mml:mstyle>
                      <mml:mo>,</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mo>Θ</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                            </mml:mrow>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mo>∏</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>J</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mstyle>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mi>C</mml:mi>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>D</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo stretchy="false">|</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>Θ</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mi>C</mml:mi>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo stretchy="false">|</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>Θ</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mo>∏</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>J</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mstyle>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="true">(</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>w</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo stretchy="true">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>D</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msup>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="true">(</mml:mo>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>-</mml:mo>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>w</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo stretchy="true">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>-</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>D</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where</p>
        <disp-formula id="E9">
          <label>(7)</label>
          <mml:math id="M9">
            <mml:mtable class="eqnarray" columnalign="right center left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>w</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>ϕ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                            </mml:mrow>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mi>p</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mi>C</mml:mi>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo stretchy="false">|</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>D</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>,</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mi>μ</mml:mi>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>,</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mi>σ</mml:mi>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>ϕ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mrow>
                              <mml:mi>t</mml:mi>
                            </mml:mrow>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mi>p</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mi>C</mml:mi>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo stretchy="false">|</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>D</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>,</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mi>μ</mml:mi>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>,</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mi>σ</mml:mi>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>-</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mi>ϕ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>p</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mi>C</mml:mi>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo stretchy="false">|</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>D</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:mn>0</mml:mn>
                          <mml:mo>,</mml:mo>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>π</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msubsup>
                          <mml:mo>,</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mi>δ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>Note that in (5), the complete-data log-likelihood is linear in <bold><italic>D</italic></bold>. Therefore, the outer E step, which calculates the conditional expectation of the complete-data log-likelihood with respect to the missing data <bold>D</bold>, is reduced to computing <inline-formula><mml:math id="M10"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mtext>E</mml:mtext></mml:mstyle><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>C</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> only once per iteration. Within each iteration of the outer EM, the inner EM repeats <italic>K</italic> cycles and treats <bold>Z</bold> as missing data and (<bold><italic>C</italic></bold>, <bold><italic>w</italic></bold><sup>(<italic>t</italic>)</sup>) as observed data, where <inline-formula><mml:math id="M11"><mml:msup><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>w</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. By the similar argument and that <inline-formula><mml:math id="M12"><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the complete-data sufficient statistic for π<sub><italic>j</italic></sub>, the <italic>k</italic>th cycle of the inner E step involving <bold><italic>Z</italic></bold> is reduced to calculating the conditional expectation of <italic>Z</italic><sub><italic>ij</italic></sub> given <inline-formula><mml:math id="M13"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>C</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>w</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p>Details of the nested EM algorithm are summarized in section 1 in <xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>. The convergence can be detected using the change of the observed-data log-likelihood ℓ(Θ|<bold><italic>C</italic></bold>) in two consecutive iterations which is trivial to obtain via (4). We set the number of inner EM cycles <italic>K</italic> = 5 within each iteration in our implementation as in Yin et al. (<xref rid="B23" ref-type="bibr">2020</xref>).</p>
        <p>Similar to MIXnorm, SMIXnorm normalization relies on the accurate classification of the genes that are expressed or not. This is indicated by the latent variable <italic>D</italic><sub><italic>j</italic></sub>. We estimate <italic>D</italic><sub><italic>j</italic></sub> by its conditional expectation given the observed data at the last E-step. Assume that the majority of genes are not differentially expressed across samples (Robinson and Oshlack, <xref rid="B19" ref-type="bibr">2010</xref>). Then the means of the normal distributions μ<sub><italic>i</italic></sub>'s can be treated as the sample-specific noises. The normalized expression for sample <italic>i</italic> and gene <italic>j</italic> can be given by</p>
        <disp-formula id="E10">
          <label>(8)</label>
          <mml:math id="M14">
            <mml:mtable class="eqnarray" columnalign="right center left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mtext>E</mml:mtext>
                  </mml:mstyle>
                  <mml:mrow>
                    <mml:mo stretchy="true">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>D</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo stretchy="false">|</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mstyle mathvariant="bold-italic">
                            <mml:mi>C</mml:mi>
                          </mml:mstyle>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mover accent="true">
                        <mml:mrow>
                          <mml:mo>Θ</mml:mo>
                        </mml:mrow>
                        <mml:mo>^</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mo stretchy="true">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>L</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>-</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mrow>
                              <mml:mi>μ</mml:mi>
                            </mml:mrow>
                            <mml:mo>^</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where <inline-formula><mml:math id="M15"><mml:mover accent="true"><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> denotes the MLE of Θ. In our numerical experiments, when gene <italic>j</italic> is not expressed, it is often the case that the conditional expectation <inline-formula><mml:math id="M16"><mml:mstyle mathvariant="bold-italic"><mml:mtext>E</mml:mtext></mml:mstyle><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>C</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, which makes <italic>N</italic><sub><italic>ij</italic></sub> ≈ 0; when gene <italic>j</italic> is expressed, <inline-formula><mml:math id="M17"><mml:mstyle mathvariant="bold-italic"><mml:mtext>E</mml:mtext></mml:mstyle><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>C</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is often close to 1. Thus, we may simply output zero for genes with <inline-formula><mml:math id="M18"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, and <inline-formula><mml:math id="M19"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for genes with <inline-formula><mml:math id="M20"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> in the actual implementation. The proposed method normalizes the data by subtracting the estimated sample-specific noise from the log count. Therefore, the normalized data are in the log scale.</p>
      </sec>
      <sec>
        <title>2.1.3. SMIXnorm vs. MIXnorm</title>
        <p>There are two major simplifications when comparing SMIXnorm to MIXnorm. First, SMIXnorm assumes a common Poisson mean δ for the non-expressed genes, where MIXnorm allows the sample-specific Poisson means δ<sub><italic>i</italic></sub>. Note that δ appears in the normalization step (8) through the conditional expectation of <italic>D</italic><sub><italic>j</italic></sub> that can be computed by Equation (7). We observe in practice that after the nested EM algorithm converges, the conditional expectation <inline-formula><mml:math id="M21"><mml:mstyle mathvariant="bold-italic"><mml:mtext>E</mml:mtext></mml:mstyle><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>C</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>Θ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> [i.e., <inline-formula><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> in Equation 7] is not sensitive to the choice of a common or sample specific Poisson mean. With the parameters set to their MLE, this conditional expectation mainly depends on the ratio between <inline-formula><mml:math id="M23"><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>C</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (or <inline-formula><mml:math id="M24"><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>C</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in MIXnorm) and <inline-formula><mml:math id="M25"><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>C</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>μ</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>σ</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The Poisson mean essentially reflects the background noise level and is supposed to be a small positive number. Thus, the former distribution, regardless of using <inline-formula><mml:math id="M26"><mml:mover accent="true"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> or <inline-formula><mml:math id="M27"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, puts most of its probability mass near 0, whereas the latter distribution in practice has negligible density around small values near 0. Consequently, the conditional expectation in Equation (7) is close to either 1 or 0 depending on whether the gene is expressed or not and reducing δ<sub><italic>i</italic></sub> to δ has little effect in the normalization step.</p>
        <p>We further simplify the model by ignoring the truncation on the normal distributions. Compared to MIXnorm, the sample-specific noise among expressed genes is captured by the mean of a normal distribution in SMIXnorm instead of the mean of a truncated normal distribution. However, we argue that these two estimates are asymptotically identical. Assume we model a set of continuous positive real numbers <bold><italic>X</italic></bold> = (<italic>X</italic><sub>1</sub>, ..., <italic>X</italic><sub><italic>J</italic></sub>) by a truncated normal distribution TN(θ, τ<sup>2</sup>, 0, +∞), where θ and τ are the mean and standard deviation of the corresponding normal distribution before truncation. To estimate the mean of the truncated normal distribution, which is a function of θ and τ, say <italic>m</italic>(θ, τ), one common approach is to first obtain the maximum likelihood estimates <inline-formula><mml:math id="M28"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, then the maximum likelihood estimate of the mean is <inline-formula><mml:math id="M29"><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> based on the invariance property of MLE. Another approach for a point estimate is the method of moments. The method of moments estimate of <italic>m</italic>(θ, τ) is simply the sample mean <inline-formula><mml:math id="M30"><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, which is essentially the MLE of μ if we ignore the truncation and model the data with N(μ, σ<sup>2</sup>). Under the large sample situation, as is often the case in RNA-seq data involving many genes from whole-genome experiments, both <inline-formula><mml:math id="M31"><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M32"><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> are asymptotically consistent estimators for <italic>m</italic>(θ, τ). The use of a normal distribution without truncation is appealing since it has closed-form parameter updates within the nested EM algorithm, while a truncated normal distribution requires additional latent variable structures and data augmentation to obtain closed-form parameter updates (Yin et al., <xref rid="B23" ref-type="bibr">2020</xref>). Overall, SMIXnorm produces similar normalized expression compared to MIXnorm whereas greatly simplifies the model fitting process, as will be confirmed in section 3 by numerical evidence.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2. <italic>RSeqNorm</italic> Web Portal</title>
      <p>The <italic>RSeqNorm</italic> web portal (<ext-link ext-link-type="uri" xlink:href="http://lce.biohpc.swmed.edu/rseqnorm">http://lce.biohpc.swmed.edu/rseqnorm</ext-link>) provides a set of analysis routines for normalization of RNA-seq data from either FF or FFPE samples. The workflow is illustrated in <xref ref-type="fig" rid="F1">Figure 1</xref>. Users provide raw sequence read count data (e.g., from RNA-seq experiments) in the form of an integer-valued matrix <bold>C</bold>. The web portal can compute the normalized expression as well as diagnostic information for download. We implement SMIXnorm, MIXnorm and five commonly used normalization methods, including Reads Per Million (RPM), Upper-Quartile (UQ), DESeq, Trimmed Mean of <italic>M</italic>-values (TMM) and PoissonSeq (PS). Though developed for FFPE data, SMIXnorm and MIXnorm are directly applicable to FF data normalization. For FF data normalization, there seems to have no unanimously best normalization method. We suggest using the methods offered by <italic>RSeqNorm</italic> and evaluating the normalization performance using prior information or known biological knowledge. For example, users may conduct a differential expression (DE) test following the normalization step and select the method that detects more genes that are known to be differentially expressed in the literature.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Summary of <italic>RSeqNorm</italic> web-portal process.</p>
        </caption>
        <graphic xlink:href="fgene-12-650795-g0001"/>
      </fig>
      <p><italic>RSeqNorm</italic> accepts the raw read count matrix in a comma-separated values (CSV) file. The (<italic>i, j</italic>) element of the count matrix records how many reads have been assigned to gene <italic>j</italic> in sample <italic>i</italic>. An example input file is downloadable from the <italic>RSeqNorm</italic> website. Detailed file requirements are shown in <xref ref-type="fig" rid="F2">Figure 2</xref>. SMIXnorm and MIXnorm require additional input arguments including the maximum number of iterations [range (10, 50), default value 15] and the convergence threshold [recommend range (1e−5, 1), default value 0.01] for the nested EM algorithm. We note that the observed-data log-likelihood as a function of all parameters may have a large curvature near the MLE. However, the SMIXnorm and MIXnorm normalized expression values are not sensitive to small variations of the parameter estimates. Therefore, the convergence criterion here is defined as the maximum absolute change in the parameter updates between the previous and current iterations, instead of using the change in the observed-data log-likelihood. The algorithm stops when the absolute change is smaller than the predetermined threshold value or the maximum number of iterations is reached. We mentioned in section 2.1.3 that the conditional probability of being expressed is often close to either 0 or 1. As a consequence, the normalized expression level for a non-expressed gene is usually a trivial number (&lt;10e−10 in our implementation to real data). Therefore, an approximate set of normalized expression is also available for SMIXnorm and MIXnorm, which normalizes genes with <inline-formula><mml:math id="M33"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> directly to 0 across all samples, where <inline-formula><mml:math id="M34"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> at convergence, <italic>I</italic>(·) is the indicator function and <italic>c</italic><sub><italic>w</italic></sub> is set to 0.5 in <italic>RSeqNorm</italic>. In practice, we observe that the choice of <italic>c</italic><sub><italic>w</italic></sub> is not sensitive in identifying expressed genes. The conditional probability of being expressed (<inline-formula><mml:math id="M35"><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula>) and the proportion of expressed genes identified (<inline-formula><mml:math id="M36"><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>) are returned in the R package <italic>RSEQNORM</italic>, which is downloadable from our website. Note that <inline-formula><mml:math id="M37"><mml:mover accent="true"><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> may reflect the overall data quality for an RNA-seq experiment (i.e., a value close to 1 indicates high quality).</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><italic>RSeqNorm</italic> upload file requirements.</p>
        </caption>
        <graphic xlink:href="fgene-12-650795-g0002"/>
      </fig>
      <p><italic>RSeqNorm</italic> returns the normalized expression in a CSV file with the same dimension as the user input file. User may leave the web portal after successfully submitting the job and an email notification will be sent to the user with a download link when the normalization is finished. A histogram of zero-count proportions is also returned as shown in <xref ref-type="fig" rid="F3">Figure 3</xref>, where SMIXnorm is used on the example data provided by <italic>RSeqNorm</italic>. The histogram shows the distribution of zero-count proportions among all samples (represented by the horizontal axis) over all input genes. High frequencies near 0 indicate that most biologically expressed genes are actually expressed in all samples in the experiment and so the data are of high quality. Ideally, one would expect that a gene is either expressed among all samples or not expressed in any of the samples. In this ideal case, the histogram shows frequencies only at 0 and 1 on the horizontal axis.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p>Diagnostic plot returned by <italic>RSeqNorm</italic> using SMIXnorm.</p>
        </caption>
        <graphic xlink:href="fgene-12-650795-g0003"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="results" id="s3">
    <title>3. Results</title>
    <sec>
      <title>3.1. Simulation</title>
      <p>We conducted simulation study to show that SMIXnorm greatly reduces computing time and maintains performance comparable to MIXnorm that is better than all FF RNA-seq normalization methods. Our simulation study evaluates the computing time of SMIXnorm and MIXnorm with different sample sizes. Note that the SMIXnorm model cannot be used to simulate the data since it permits negative log transformed counts that do not exist in practice. Here, a modified MIXnorm model was used to generate synthetic data sets (under the same settings as in Simulation VI in Yin et al., <xref rid="B23" ref-type="bibr">2020</xref>). The model parameters were set to their MLEs estimated from a public RNA-seq dataset for FFPE soft tissue sarcomas samples (Lesluyes et al., <xref rid="B11" ref-type="bibr">2016</xref>), which contains expression levels for 20, 242 protein-coding genes from 41 patients.</p>
      <p>The sample size was set to a multiple of 41 from 41 to 2, 050. The average computing time for SMIXnorm and MIXnorm over 50 replicates is plotted against sample size in <xref ref-type="fig" rid="F4">Figure 4</xref>. Both SMIXnorm and MIXnorm show a linear relationship between the average computing time and the sample size with Pearson correlations greater than 0.99. The linear regression fit of the SMIXnorm computing time against sample size results in a slope estimate of 0.051, compared to 0.297 from MIXnorm. To evaluate the performance of SMIXnorm and MIXnorm together with five commonly used FF RNA-seq normalization methods (PS, UQ, DESeq, RPM, and TMM), we calculated the gene-wise Pearson correlations for the 20, 242 genes between the normalized and true expression for each of the 50 simulated data set under the setting of 41 samples. The results are reported in <xref ref-type="supplementary-material" rid="SM1">Supplementary Figure 1</xref>, showing that SMIXnorm and MIXnorm have almost identical performance and they consistently beat the other methods.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p>Simulation study. Average computing time of SMIXnorm and MIXnorm vs. sample size.</p>
        </caption>
        <graphic xlink:href="fgene-12-650795-g0004"/>
      </fig>
    </sec>
    <sec>
      <title>3.2. Real Data Analysis</title>
      <p>When dealing with real data where true expression is unknown, researchers often consider frozen sections as the gold standard for most molecular assays. As mentioned in the introduction, the frozen process maintains RNA well, compared to the FFPE process. Therefore, we used the paired FF RNA-seq expression after normalization as a surrogate to the true gene expression in our three data examples, in order to evaluate the performance of different normalization methods.</p>
      <sec>
        <title>3.2.1. Colorectal Cancer Data</title>
        <p>The colorectal cancer data (Omolo et al., <xref rid="B17" ref-type="bibr">2016</xref>) contains 54 selected FFPE tumor specimens from a larger multi-center cohort with paired FF samples. Gene expression levels were measured by whole genome RNA-seq (RNA-Acc) assay and Affymetrix GeneChip (Affy) platform on the FFPE samples and FF samples, respectively.</p>
        <p>The activation of RAS signaling pathway is frequent in human cancer. Recent studies have shown that RAS mutations account for approximately 40% of colorectal cancers and lung cancers (Omolo et al., <xref rid="B17" ref-type="bibr">2016</xref>). A number of RAS pathway activation gene expression signatures have been identified using multiple types of cancer cell lines and human FF samples. Omolo et al. (<xref rid="B17" ref-type="bibr">2016</xref>) evaluated an 18-gene RAS pathway signature on FFPE samples in five technology platforms. We focus on the Illumina whole genome RNA-seq of FFPE samples and the gold standard FF samples measured by Affymetrix GeneChip. The Affy_FF samples were normalized using the RMA method (Irizarry et al., <xref rid="B9" ref-type="bibr">2003</xref>; Omolo et al., <xref rid="B17" ref-type="bibr">2016</xref>).</p>
        <p>To assess the performance of the translation of the gene signature from FF to FFPE samples, we considered the same metric as in Omolo et al. (<xref rid="B17" ref-type="bibr">2016</xref>). The RAS pathway activation score is defined as the mean normalized expression levels of the 18 RAS genes for each sample. We calculated the Spearman correlation using the 54 pairs of FF and FFPE RAS pathway activation scores for each normalization method and summarized the results in <xref rid="T1" ref-type="table">Table 1</xref>. The raw data give the lowest correlation as expected. SMIXnorm and MIXnorm give almost the same results and the highest correlations. The <italic>p</italic>-value based on a two-sided permutation test for the hypothesis <italic>H</italic><sub>0</sub>:ρ = 0 is reported in the parenthesis. SMIXnorm, MIXnorm, PS, DESeq, RPM and UQ report significant correlations at the significance level of 0.05. MIXnorm takes about 42 s to normalize the colorectal cancer data, while SMIXnorm only takes about 7.5 s.</p>
        <table-wrap id="T1" position="float">
          <label>Table 1</label>
          <caption>
            <p>Correlations ρ between normalized FF and FFPE RAS pathway activation scores.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>SMIXnorm</bold>
                </th>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>MIXnorm</bold>
                </th>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>PS</bold>
                </th>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>DESeq</bold>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">ρ</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.343 (0.012)</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.343 (0.011)</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.324 (0.017)</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.298 (0.029)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1"/>
                <td valign="top" align="center" rowspan="1" colspan="1">RPM</td>
                <td valign="top" align="center" rowspan="1" colspan="1">UQ</td>
                <td valign="top" align="center" rowspan="1" colspan="1">TMM</td>
                <td valign="top" align="center" rowspan="1" colspan="1">Raw</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">ρ</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.286 (0.036)</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.270 (0.049)</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.153 (0.269)</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.125 (0.366)</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p><italic>p-values in the parenthesis are based on a two-sided permutation test for the hypothesis H<sub>0</sub>:ρ = 0</italic>.</p>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec>
        <title>3.2.2. Soft Tissue Sarcomas Data</title>
        <p>The soft tissue sarcomas data (Lesluyes et al., <xref rid="B11" ref-type="bibr">2016</xref>) measure the expression levels of 20, 242 protein-coding genes from 41 patients with paired FF and FFPE samples. To evaluate the normalization performance, the gene-wise Pearson correlations between normalized FFPE and FF expression levels (in the log scale) were computed and compared among the seven different methods (SMIXnorm, MIXnorm, DESeq, RPM, TMM, PS, and UQ). A gene expression signature, Complexity INdex in SARComas (CINSARC), which contains 67 genes, has been identified as an important prognostic factor in sarcomas using fresh frozen samples. Lesluyes et al. (<xref rid="B11" ref-type="bibr">2016</xref>) showed that CINSARC remains a potential prognostic factor using the FFPE RNA-seq data. Therefore, we evaluated the performance of different normalization methods on all the 20, 242 genes as well as the 67 genes in the CINSARC gene signature.</p>
        <p><xref ref-type="fig" rid="F5">Figure 5</xref> shows the gene-wise Pearson correlations for all the 20, 242 genes using violin plots. The dot and line in each violin plot represent the mean and standard deviation of the gene-wise Pearson correlations. The gene-wise correlations from the 67 genes in the CINSARC signature are summarized in <xref rid="T2" ref-type="table">Table 2</xref> using the first, second, and third quartiles. Note that UQ failed to normalize the data as the scaling factor estimates equal 0 for some samples due to the excess zero counts. The genes in the gene signature have higher correlations than those calculated from the population of all protein-coding genes for all the normalization methods. The shapes of the violin plots suggest that SMIXnorm and MIXnorm have almost identical results and SMIXnorm gives the highest mean correlation while PS gives the lowest among all the methods. The three commonly used FF RNA-seq normalization methods, TMM, DESeq, and RPM, give similar results on all protein-coding genes and there is no clear improvement compared to the original correlations calculated without any normalization. However, DESeq and RPM show much higher correlations on the CINSARC gene signature compared to TMM. Overall, SMIXnorm and MIXnorm show similar results and are consistently better than the other methods. We further note that in this example, a poor choice of normalization method (e.g., UQ, TMM, or PS) may yield results worse than those from original unnormalized data. MIXnorm takes about 5 min to normalize the soft tissue sarcomas data and we note that the algorithm reaches the default maximum number of iterations before convergence. On the other hand, SMIXnorm converges in 6 iterations and takes about 10 s to normalize the data.</p>
        <fig id="F5" position="float">
          <label>Figure 5</label>
          <caption>
            <p>Gene-wise correlations between normalized FFPE and FF expression for soft tissue sarcomas data on all 20, 242 protein coding genes. The UQ method failed to normalize the data due to excess zero counts.</p>
          </caption>
          <graphic xlink:href="fgene-12-650795-g0005"/>
        </fig>
        <table-wrap id="T2" position="float">
          <label>Table 2</label>
          <caption>
            <p>Gene-wise correlations between normalized FFPE and FF expression for soft tissue sarcomas data on the CINSARC gene signature.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th valign="top" align="center" rowspan="1" colspan="1"><bold>First Qu</bold>.</th>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>Median</bold>
                </th>
                <th valign="top" align="center" rowspan="1" colspan="1"><bold>Third Qu</bold>.</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">SMIXnorm</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.344</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.465</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.529</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">MIXnorm</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.333</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.455</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.517</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">DESeq</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.165</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.260</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.354</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">RPM</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.146</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.243</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.350</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">TMM</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.010</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.098</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.161</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">PS</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−0.126</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.002</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.154</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">UQ</td>
                <td valign="top" align="center" rowspan="1" colspan="1">–</td>
                <td valign="top" align="center" rowspan="1" colspan="1">–</td>
                <td valign="top" align="center" rowspan="1" colspan="1">–</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">Original</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.020</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.107</td>
                <td valign="top" align="center" rowspan="1" colspan="1">0.181</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p><italic>The UQ method failed to normalize the data due to excess zero counts</italic>.</p>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec>
        <title>3.2.3. Clear Cell Renal Cell Carcinoma Data</title>
        <p>The clear cell renal cell carcinoma (ccRCC) data are available in the repository Gene Expression Omnibus from a published study (Eikrem et al., <xref rid="B5" ref-type="bibr">2016</xref>). ccRCC is the most common and aggressive histological type among the primary renal neoplasms. Metastasis is a major cause of ccRCC patient death due to the resistance to standard chemotherapy and radiotherapy. Hence, much effort has been made to unravel the underlying molecular mechanisms of ccRCC, for example, by applying gene expression analysis to develop molecular signatures of disease progression, which plays an important role in assessing the carcinogenesis and development of disease as well as guiding clinical decisions. The ccRCC RNA-seq data contain 32 pairs of FFPE and RNAlater samples with 18, 458 protein-coding genes converted from 64, 253 Ensembl annotated genes. Following Yin et al. (<xref rid="B23" ref-type="bibr">2020</xref>), the RNAlater samples were considered the gold standard in this study and gene-wise Pearson correlations were computed to compare the performance of the seven normalization methods. The results are shown via violin plots in <xref ref-type="fig" rid="F6">Figure 6</xref>. Again, we observe that SMIXnorm and MIXnorm give almost the same results and consistently perform the best among all methods. It is interesting to note that TMM, which performs the best among existing FF normalization methods in soft tissue sarcomas data on all protein-coding genes, gives worse results than DESeq, RPM, and UQ in this application. In fact, TMM and PS show no advantage compared to the original correlations without any normalization. MIXnorm takes about 10.5 s to normalize the ccRCC FFPE data, while SMIXnorm only takes about 3.3 s.</p>
        <fig id="F6" position="float">
          <label>Figure 6</label>
          <caption>
            <p>Gene-wise correlations between normalized FFPE and RNAlater for ccRCC data on 18, 458 protein coding genes.</p>
          </caption>
          <graphic xlink:href="fgene-12-650795-g0006"/>
        </fig>
        <p>The paired design of the ccRCC study allows us to conduct differential expression (DE) analysis between ccRCC and normal tissues. Specifically, two ccRCC and two adjacent normal tissues were obtained from each of the 16 patient. The two pairs were then stored in FFPE and RNAlater, respectively. We identified DE genes [Benjamini–Hochberg adjusted <italic>P</italic> &lt; 0.05 from paired <italic>t</italic>-tests and absolute log2 fold change (FC) &gt; 2] from FF and FFPE samples based on normalized expression levels and summarize results in <xref rid="T3" ref-type="table">Table 3</xref>. We find that SMIXnorm and MIXnorm give similar numbers of common DE genes from the two sources, and are much higher than the numbers from the other methods. Among the common DE genes identified from MIXnorm, SMIXnorm is able to identify 999 out of the 1, 036 genes (i.e., 96.4%). Furthermore, among the two sets of top 20 DE genes identified from RNAlater and FFPE samples, SMIXnorm and MIXnorm share the same common genes and show almost identical log2 FC (<xref rid="T4" ref-type="table">Table 4</xref>). Our analysis shows that using either SMIXnorm or MIXnorm for normalization, we are able to detect a set of up- or down-regulated genes from FFPE RNA-seq data that is similar to that from FF or like RNA-seq data.</p>
        <table-wrap id="T3" position="float">
          <label>Table 3</label>
          <caption>
            <p>Summary of differential expression analysis based on different normalization methods from the ccRCC data.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>FFPE</bold>
                </th>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>RNAlater</bold>
                </th>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>Common</bold>
                </th>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>Common</bold>
                </th>
              </tr>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>DE genes</bold>
                </th>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>DE genes</bold>
                </th>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>DE genes</bold>
                </th>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>top 20 DE</bold>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">SMIXnorm</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1,490</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1,486</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1,023</td>
                <td valign="top" align="center" rowspan="1" colspan="1">13</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">MIXnorm</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1,488</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1,482</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1,036</td>
                <td valign="top" align="center" rowspan="1" colspan="1">13</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">DESeq</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1,014</td>
                <td valign="top" align="center" rowspan="1" colspan="1">951</td>
                <td valign="top" align="center" rowspan="1" colspan="1">680</td>
                <td valign="top" align="center" rowspan="1" colspan="1">7</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">RPM</td>
                <td valign="top" align="center" rowspan="1" colspan="1">999</td>
                <td valign="top" align="center" rowspan="1" colspan="1">926</td>
                <td valign="top" align="center" rowspan="1" colspan="1">676</td>
                <td valign="top" align="center" rowspan="1" colspan="1">9</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">TMM</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1,073</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1,067</td>
                <td valign="top" align="center" rowspan="1" colspan="1">632</td>
                <td valign="top" align="center" rowspan="1" colspan="1">7</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">PS</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1,001</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1,300</td>
                <td valign="top" align="center" rowspan="1" colspan="1">652</td>
                <td valign="top" align="center" rowspan="1" colspan="1">8</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">UQ</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1,002</td>
                <td valign="top" align="center" rowspan="1" colspan="1">943</td>
                <td valign="top" align="center" rowspan="1" colspan="1">679</td>
                <td valign="top" align="center" rowspan="1" colspan="1">8</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">Original</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1,041</td>
                <td valign="top" align="center" rowspan="1" colspan="1">1,096</td>
                <td valign="top" align="center" rowspan="1" colspan="1">646</td>
                <td valign="top" align="center" rowspan="1" colspan="1">9</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p><italic>The second column is the number of DE genes identified from the FFPE data; the third column is the number of DE genes identified from the RNAlater data; the fourth column is the number of common genes between the two sets of DE genes; the last column is the number of common genes among the two sets of top 20 DE genes from FFPE and RNAlater</italic>.</p>
          </table-wrap-foot>
        </table-wrap>
        <table-wrap id="T4" position="float">
          <label>Table 4</label>
          <caption>
            <p>Shared DE genes among the two sets of top 20 DE genes from FFPE and RNAlater samples in the ccRCC data, ordered by the absolute value of the SMIXnorm normalized RNAlater log2 FC.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>SMIXnorm RNAlater log2 FC</bold>
                </th>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>MIXnorm RNAlater log2 FC</bold>
                </th>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>SMIXnorm FFPE log2 FC</bold>
                </th>
                <th valign="top" align="center" rowspan="1" colspan="1">
                  <bold>MIXnorm FFPE log2 FC</bold>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">CA9</td>
                <td valign="top" align="center" rowspan="1" colspan="1">8.02</td>
                <td valign="top" align="center" rowspan="1" colspan="1">8.04</td>
                <td valign="top" align="center" rowspan="1" colspan="1">5.66</td>
                <td valign="top" align="center" rowspan="1" colspan="1">5.66</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">SLC6A3</td>
                <td valign="top" align="center" rowspan="1" colspan="1">7.20</td>
                <td valign="top" align="center" rowspan="1" colspan="1">7.22</td>
                <td valign="top" align="center" rowspan="1" colspan="1">6.30</td>
                <td valign="top" align="center" rowspan="1" colspan="1">6.31</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">NDUFA4L2</td>
                <td valign="top" align="center" rowspan="1" colspan="1">6.38</td>
                <td valign="top" align="center" rowspan="1" colspan="1">6.39</td>
                <td valign="top" align="center" rowspan="1" colspan="1">4.88</td>
                <td valign="top" align="center" rowspan="1" colspan="1">4.89</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">UMOD</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−6.17</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−6.15</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.63</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.62</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">GP2</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.53</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.51</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−4.96</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−4.96</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">CLCNKA</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.29</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.28</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.70</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.69</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">CDCA2</td>
                <td valign="top" align="center" rowspan="1" colspan="1">5.21</td>
                <td valign="top" align="center" rowspan="1" colspan="1">5.23</td>
                <td valign="top" align="center" rowspan="1" colspan="1">5.04</td>
                <td valign="top" align="center" rowspan="1" colspan="1">5.05</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">TNFAIP6</td>
                <td valign="top" align="center" rowspan="1" colspan="1">5.16</td>
                <td valign="top" align="center" rowspan="1" colspan="1">5.17</td>
                <td valign="top" align="center" rowspan="1" colspan="1">5.45</td>
                <td valign="top" align="center" rowspan="1" colspan="1">5.45</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">SLC4A11</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.10</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.08</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.23</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.22</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">KNG1</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.04</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.02</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.04</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.03</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">SLC12A1</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−4.96</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−4.95</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−4.90</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−4.89</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">AQP2</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−4.94</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−4.92</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−4.90</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−4.89</td>
              </tr>
              <tr>
                <td valign="top" align="left" rowspan="1" colspan="1">NELL1</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−4.79</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−4.77</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.03</td>
                <td valign="top" align="center" rowspan="1" colspan="1">−5.02</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
      </sec>
    </sec>
  </sec>
  <sec id="s4">
    <title>4. Discussions</title>
    <p>We have developed an efficient normalization method, named SMIXnorm, for FFPE RNA-seq data normalization. Modified from the MIXnorm statistical model, we use a similar two-component mixture model to separately model the expressed and non-expressed genes. The simplifications of the statistical model avoid the complex likelihood function and the need of a complicated latent variable structure to invoke the nested EM algorithm. We have shown through real data applications and simulation studies that SMIXnorm greatly reduces the complexity of the likelihood function and the computing time without sacrificing the performance. Though other FF normalization methods take only about 1 s to normalize each dataset in our three data applications, their performance is not comparable to that of SMIXnorm and MIXnorm for FFPE samples. Some FF normalization methods perform even worse than the use of original data without any normalization.</p>
    <p>We mentioned in the soft tissue sarcomas application that MIXnorm failed to converge at the default maximum number of iterations and tolerance level. Due to the severely different RNA degradation levels among the 41 soft tissue sarcomas FFPE samples, 10 FFPE samples have more than 10, 000 zero counts and 9 FFPE samples have less than 3, 000 zero counts. Consequently, MIXnorm gives negative estimated sample-specific location parameters of the truncated normal distributions for those samples with a higher proportion of zero counts, which blurs the distinction between expressed and non-expressed genes. SMIXnorm models the expressed genes by normal distributions without truncation, which naturally constrains the location parameters to be non-negative in all the EM iterations as sample means are used for estimation. Thus, SMIXnorm seems to be more robust and converges faster than MIXnorm.</p>
    <p>Recently, single-cell RNA sequencing (scRNA-seq) becomes an important technology in molecular analysis. While bulk RNA-seq measures the expression in the population level across cells, scRNA-seq allows for the cell level resolution and therefore, reveals heterogeneity of cell subpopulations. Similar to FFPE RNA-seq data, a prominent feature of scRNA-seq data is the sparsity. The high proportion of zero count arises for both biological reasons and technical reasons (Lun et al., <xref rid="B14" ref-type="bibr">2016</xref>; Vallejos et al., <xref rid="B21" ref-type="bibr">2017</xref>). The most commonly used scRNA-seq normalization method is SCnorm (Bacher et al., <xref rid="B2" ref-type="bibr">2017</xref>), which uses quantile regression to group genes by estimated count-depth relationships, and then estimates different scaling factors within each group via a second quantile regression. Other popular scRNA-seq normalization methods, including BASiCS (Vallejos et al., <xref rid="B20" ref-type="bibr">2015</xref>), SAMstrt (Katayama et al., <xref rid="B10" ref-type="bibr">2013</xref>), and GRM (Vallejos et al., <xref rid="B21" ref-type="bibr">2017</xref>), rely on spike-ins. Therefore, most scRNA-seq normalization methods are not directly applicable to the FFPE RNA-seq data that typically do not have spike-ins.</p>
    <p>With the rapid adaption of FFPE samples in RNA-seq analysis, it is important for users to realize that different normalization procedures should be used for FFPE vs. FF data. We offer <italic>RSeqNorm</italic>, a comprehensive and user-friendly normalization toolkit for RNA-seq data. To the best of our knowledge, <italic>RSeqNorm</italic> is the only available web-based tool that integrates different normalization methods for both FFPE and FF RNA-seq data. It includes seven normalization methods, among which five are commonly used (RPM, UQ, DESeq, TMM, and PS) for FF or like RNA-seq data. Though MIXnorm and SMIXnorm are specifically designed for FFPE RNA-seq normalization, they can be applied to FF data directly. However, it is generally inappropriate to implement other existing methods on FFPE data. The input for all methods is a read count matrix at the gene level. The output is an expression matrix after normalization with the same dimension as the input data. The R package, RSEQNORM, which implements SMIXnorm and MIXnorm is downloadable from the website (<ext-link ext-link-type="uri" xlink:href="http://lce.biohpc.swmed.edu/rseqnorm">http://lce.biohpc.swmed.edu/rseqnorm</ext-link>).</p>
  </sec>
  <sec sec-type="data-availability" id="s5">
    <title>Data Availability Statement</title>
    <p>The original contributions presented in the study are included in the article/<xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>, further inquiries can be directed to the corresponding author/s.</p>
  </sec>
  <sec id="s6">
    <title>Author Contributions</title>
    <p>SY and XW proposed and implemented the SMIXnorm method. SY, XZ, XW, and GX performed data analysis and wrote the manuscript. XZ, GX, and YX provided resources and helpful discussions. SY, XZ, and BY developed the web portal <italic>RSeqNorm</italic>. All authors contributed to the article and approved the submitted version.</p>
  </sec>
  <sec sec-type="COI-statement" id="conf1">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
</body>
<back>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> This work has been partially supported by the NIH grant [R15GM131390, R35 GM136375, P50CA70907, P30CA142543, 1R01GM115473, and 1R01CA172211], and the Cancer Prevention and Research Institute of Texas [RP190107 and RP180805].</p>
    </fn>
  </fn-group>
  <sec sec-type="supplementary-material" id="s7">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fgene.2021.650795/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fgene.2021.650795/full#supplementary-material</ext-link></p>
    <supplementary-material content-type="local-data" id="SM1">
      <media xlink:href="Data_Sheet_1.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S.</given-names></name><name><surname>Huber</surname><given-names>W.</given-names></name></person-group> (<year>2010</year>). <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol.</source>
<volume>11</volume>:<fpage>R106</fpage>. <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id><pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bacher</surname><given-names>R.</given-names></name><name><surname>Chu</surname><given-names>L.-F.</given-names></name><name><surname>Leng</surname><given-names>N.</given-names></name><name><surname>Gasch</surname><given-names>A. P.</given-names></name><name><surname>Thomson</surname><given-names>J. A.</given-names></name><name><surname>Stewart</surname><given-names>R. M.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>SCnorm: robust normalization of single-cell RNA-seq data</article-title>. <source>Nat. Methods</source><volume>14</volume>, <fpage>584</fpage>–<lpage>586</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4263</pub-id><pub-id pub-id-type="pmid">28418000</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bullard</surname><given-names>J.</given-names></name><name><surname>Purdom</surname><given-names>E.</given-names></name><name><surname>Hansen</surname><given-names>K.</given-names></name><name><surname>Dudoit</surname><given-names>S.</given-names></name></person-group> (<year>2010</year>). <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-seq experiments</article-title>. <source>BMC Bioinformatics</source>
<volume>11</volume>:<fpage>94</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-11-94</pub-id><pub-id pub-id-type="pmid">20167110</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dillies</surname><given-names>M.-A.</given-names></name><name><surname>Rau</surname><given-names>A.</given-names></name><name><surname>Aubert</surname><given-names>J.</given-names></name><name><surname>Hennequet-Antier</surname><given-names>C.</given-names></name><name><surname>Jeanmougin</surname><given-names>M.</given-names></name><name><surname>Servant</surname><given-names>N.</given-names></name><etal/></person-group>. (<year>2013</year>). <article-title>A comprehensive evaluation of normalization methods for illumina high-throughput RNA sequencing data analysis</article-title>. <source>Brief. Bioinform.</source><volume>14</volume>, <fpage>671</fpage>–<lpage>683</lpage>. <pub-id pub-id-type="doi">10.1093/bib/bbs046</pub-id><pub-id pub-id-type="pmid">22988256</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Eikrem</surname><given-names>O.</given-names></name><name><surname>Beisland</surname><given-names>C.</given-names></name><name><surname>Hjelle</surname><given-names>K.</given-names></name><name><surname>Flatberg</surname><given-names>A.</given-names></name><name><surname>Scherer</surname><given-names>A.</given-names></name><name><surname>Landolt</surname><given-names>L.</given-names></name><etal/></person-group>. (<year>2016</year>). <article-title>Transcriptome sequencing (RNAseq) enables utilization of formalin-fixed, paraffin-embedded biopsies with clear cell renal cell carcinoma for exploration of disease biology and biomarker development</article-title>. <source>PLoS ONE</source><volume>11</volume>:<fpage>e0149743</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0149743</pub-id><pub-id pub-id-type="pmid">26901863</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Evans</surname><given-names>C.</given-names></name><name><surname>Hardin</surname><given-names>J.</given-names></name><name><surname>Stoebel</surname><given-names>D. M.</given-names></name></person-group> (<year>2018</year>). <article-title>Selecting between-sample RNA-seq normalization methods from the perspective of their assumptions</article-title>. <source>Brief. Bioinform.</source>
<volume>19</volume>, <fpage>776</fpage>–<lpage>792</lpage>. <pub-id pub-id-type="doi">10.1093/bib/bbx008</pub-id><pub-id pub-id-type="pmid">28334202</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graw</surname><given-names>S.</given-names></name><name><surname>Meier</surname><given-names>R.</given-names></name><name><surname>Minn</surname><given-names>K.</given-names></name><name><surname>Bloomer</surname><given-names>C.</given-names></name><name><surname>Godwin</surname><given-names>A. K.</given-names></name><name><surname>Fridley</surname><given-names>B.</given-names></name><etal/></person-group>. (<year>2015</year>). <article-title>Robust gene expression and mutation analyses of RNA-sequencing of formalin-fixed diagnostic tumor samples</article-title>. <source>Sci. Rep.</source><volume>5</volume>:<fpage>12335</fpage>. <pub-id pub-id-type="doi">10.1038/srep12335</pub-id><pub-id pub-id-type="pmid">26202458</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grenier</surname><given-names>J. K.</given-names></name><name><surname>Foureman</surname><given-names>P. A.</given-names></name><name><surname>Sloma</surname><given-names>E. A.</given-names></name><name><surname>Miller</surname><given-names>A. D.</given-names></name></person-group> (<year>2017</year>). <article-title>RNA-seq transcriptome analysis of formalin fixed, paraffin-embedded canine meningioma</article-title>. <source>PLoS ONE</source>
<volume>12</volume>:<fpage>e0187150</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0187150</pub-id><pub-id pub-id-type="pmid">29073243</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Irizarry</surname><given-names>R. A.</given-names></name><name><surname>Hobbs</surname><given-names>B.</given-names></name><name><surname>Collin</surname><given-names>F.</given-names></name><name><surname>Beazer-Barclay</surname><given-names>Y. D.</given-names></name><name><surname>Antonellis</surname><given-names>K. J.</given-names></name><name><surname>Scherf</surname><given-names>U.</given-names></name><etal/></person-group>. (<year>2003</year>). <article-title>Exploration, normalization, and summaries of high density oligonucleotide array probe level data</article-title>. <source>Biostatistics</source><volume>4</volume>, <fpage>249</fpage>–<lpage>264</lpage>. <pub-id pub-id-type="doi">10.1093/biostatistics/4.2.249</pub-id><pub-id pub-id-type="pmid">12925520</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katayama</surname><given-names>S.</given-names></name><name><surname>Töhönen</surname><given-names>V.</given-names></name><name><surname>Linnarsson</surname><given-names>S.</given-names></name><name><surname>Kere</surname><given-names>J.</given-names></name></person-group> (<year>2013</year>). <article-title>Samstrt: statistical test for differential expression in single-cell transcriptome with spike-in normalization</article-title>. <source>Bioinformatics</source>
<volume>29</volume>, <fpage>2943</fpage>–<lpage>2945</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt511</pub-id><pub-id pub-id-type="pmid">23995393</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lesluyes</surname><given-names>T.</given-names></name><name><surname>Pérot</surname><given-names>G.</given-names></name><name><surname>Largeau</surname><given-names>M. R.</given-names></name><name><surname>Brulard</surname><given-names>C.</given-names></name><name><surname>Lagarde</surname><given-names>P.</given-names></name><name><surname>Dapremont</surname><given-names>V.</given-names></name><etal/></person-group>. (<year>2016</year>). <article-title>RNA sequencing validation of the complexity index in sarcomas prognostic signature</article-title>. <source>Eur. J. Cancer</source><volume>57</volume>, <fpage>104</fpage>–<lpage>111</lpage>. <pub-id pub-id-type="doi">10.1016/j.ejca.2015.12.027</pub-id><pub-id pub-id-type="pmid">26916546</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>J.</given-names></name><name><surname>Witten</surname><given-names>D. M.</given-names></name><name><surname>Johnstone</surname><given-names>I. M.</given-names></name><name><surname>Tibshirani</surname><given-names>R.</given-names></name></person-group> (<year>2012</year>). <article-title>Normalization, testing, and false discovery rate estimation for RNA-sequencing data</article-title>. <source>Biostatistics</source>
<volume>13</volume>, <fpage>523</fpage>–<lpage>538</lpage>. <pub-id pub-id-type="doi">10.1093/biostatistics/kxr031</pub-id><pub-id pub-id-type="pmid">22003245</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>P.</given-names></name><name><surname>Conley</surname><given-names>A.</given-names></name><name><surname>Zhang</surname><given-names>H.</given-names></name><name><surname>Kim</surname><given-names>H. L.</given-names></name></person-group> (<year>2014</year>). <article-title>Whole-transcriptome profiling of formalin-fixed, paraffin-embedded renal cell carcinoma by RNA-seq</article-title>. <source>BMC Genomics</source>
<volume>15</volume>:<fpage>1087</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2164-15-1087</pub-id><pub-id pub-id-type="pmid">25495041</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lun</surname><given-names>A. T.</given-names></name><name><surname>Bach</surname><given-names>K.</given-names></name><name><surname>Marioni</surname><given-names>J. C.</given-names></name></person-group> (<year>2016</year>). <article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>. <source>Genome Biol.</source>
<volume>17</volume>:<fpage>75</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-016-0947-7</pub-id><pub-id pub-id-type="pmid">27122128</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mortazavi</surname><given-names>A.</given-names></name><name><surname>Williams</surname><given-names>B. A.</given-names></name><name><surname>McCue</surname><given-names>K.</given-names></name><name><surname>Schaeffer</surname><given-names>L.</given-names></name><name><surname>Wold</surname><given-names>B.</given-names></name></person-group> (<year>2008</year>). <article-title>Mapping and quantifying mammalian transcriptomes by RNA-seq</article-title>. <source>Nat. Methods</source>
<volume>5</volume>, <fpage>621</fpage>–<lpage>628</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1226</pub-id><pub-id pub-id-type="pmid">18516045</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morton</surname><given-names>M. L.</given-names></name><name><surname>Bai</surname><given-names>X.</given-names></name><name><surname>Merry</surname><given-names>C. R.</given-names></name><name><surname>Linden</surname><given-names>P. A.</given-names></name><name><surname>Khalil</surname><given-names>A. M.</given-names></name><name><surname>Leidner</surname><given-names>R. S.</given-names></name><etal/></person-group>. (<year>2014</year>). <article-title>Identification of mRNAs and lincrnas associated with lung cancer progression using next-generation RNA sequencing from laser micro-dissected archival FFPE tissue specimens</article-title>. <source>Lung Cancer</source><volume>85</volume>, <fpage>31</fpage>–<lpage>39</lpage>. <pub-id pub-id-type="doi">10.1016/j.lungcan.2014.03.020</pub-id><pub-id pub-id-type="pmid">24735754</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Omolo</surname><given-names>B.</given-names></name><name><surname>Yang</surname><given-names>M.</given-names></name><name><surname>Lo</surname><given-names>F. Y.</given-names></name><name><surname>Schell</surname><given-names>M. J.</given-names></name><name><surname>Austin</surname><given-names>S.</given-names></name><name><surname>Howard</surname><given-names>K.</given-names></name><etal/></person-group>. (<year>2016</year>). <article-title>Adaptation of a RAS pathway activation signature from FF to FFPE tissues in colorectal cancer</article-title>. <source>BMC Med. Genomics</source><volume>9</volume>:<fpage>65</fpage>. <pub-id pub-id-type="doi">10.1186/s12920-016-0225-2</pub-id><pub-id pub-id-type="pmid">27756306</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Quinn</surname><given-names>T. P.</given-names></name><name><surname>Erb</surname><given-names>I.</given-names></name><name><surname>Richardson</surname><given-names>M. F.</given-names></name><name><surname>Crowley</surname><given-names>T. M.</given-names></name></person-group> (<year>2018</year>). <article-title>Understanding sequencing data as compositions: an outlook and review</article-title>. <source>Bioinformatics</source>
<volume>34</volume>, <fpage>2870</fpage>–<lpage>2878</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty175</pub-id><pub-id pub-id-type="pmid">29608657</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>M. D.</given-names></name><name><surname>Oshlack</surname><given-names>A.</given-names></name></person-group> (<year>2010</year>). <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>. <source>Genome Biol.</source>
<volume>11</volume>:<fpage>R25</fpage>. <pub-id pub-id-type="doi">10.1186/gb-2010-11-3-r25</pub-id><pub-id pub-id-type="pmid">20196867</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vallejos</surname><given-names>C. A.</given-names></name><name><surname>Marioni</surname><given-names>J. C.</given-names></name><name><surname>Richardson</surname><given-names>S.</given-names></name></person-group> (<year>2015</year>). <article-title>Basics: Bayesian analysis of single-cell sequencing data</article-title>. <source>PLoS Comput. Biol.</source>
<volume>11</volume>:<fpage>e1004333</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004333</pub-id><pub-id pub-id-type="pmid">26107944</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vallejos</surname><given-names>C. A.</given-names></name><name><surname>Risso</surname><given-names>D.</given-names></name><name><surname>Scialdone</surname><given-names>A.</given-names></name><name><surname>Dudoit</surname><given-names>S.</given-names></name><name><surname>Marioni</surname><given-names>J. C.</given-names></name></person-group> (<year>2017</year>). <article-title>Normalizing single-cell RNA sequencing data: challenges and opportunities</article-title>. <source>Nat. Methods</source>
<volume>14</volume>:<fpage>565</fpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4292</pub-id><pub-id pub-id-type="pmid">28504683</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Von Ahlfen</surname><given-names>S.</given-names></name><name><surname>Missel</surname><given-names>A.</given-names></name><name><surname>Bendrat</surname><given-names>K.</given-names></name><name><surname>Schlumpberger</surname><given-names>M.</given-names></name></person-group> (<year>2007</year>). <article-title>Determinants of RNA quality from FFPE samples</article-title>. <source>PLoS ONE</source>
<volume>2</volume>:<fpage>e1261</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0001261</pub-id><pub-id pub-id-type="pmid">18060057</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yin</surname><given-names>S.</given-names></name><name><surname>Wang</surname><given-names>X.</given-names></name><name><surname>Jia</surname><given-names>G.</given-names></name><name><surname>Xie</surname><given-names>Y.</given-names></name></person-group> (<year>2020</year>). <article-title>MIXnorm: normalizing RNA-seq data from formalin-fixed paraffin-embedded samples</article-title>. <source>Bioinformatics</source>
<volume>36</volume>,<fpage>3401</fpage>–<lpage>3408</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa153</pub-id><pub-id pub-id-type="pmid">32134470</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
