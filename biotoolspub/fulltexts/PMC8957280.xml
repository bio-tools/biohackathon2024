<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PeerJ</journal-id>
    <journal-id journal-id-type="iso-abbrev">PeerJ</journal-id>
    <journal-id journal-id-type="publisher-id">PeerJ</journal-id>
    <journal-title-group>
      <journal-title>PeerJ</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2167-8359</issn>
    <publisher>
      <publisher-name>PeerJ Inc.</publisher-name>
      <publisher-loc>San Diego, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8957280</article-id>
    <article-id pub-id-type="publisher-id">13147</article-id>
    <article-id pub-id-type="doi">10.7717/peerj.13147</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Bioinformatics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Neuroscience</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Statistics</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Data Science</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RapidHRV: an open-source toolbox for extracting heart rate and heart rate variability</article-title>
    </title-group>
    <contrib-group>
      <contrib id="author-1" contrib-type="author" corresp="yes">
        <name>
          <surname>Kirk</surname>
          <given-names>Peter A.</given-names>
        </name>
        <xref rid="aff-1" ref-type="aff">1</xref>
        <xref rid="aff-2" ref-type="aff">2</xref>
        <email>p.kirk@ucl.ac.uk</email>
      </contrib>
      <contrib id="author-2" contrib-type="author">
        <name>
          <surname>Davidson Bryan</surname>
          <given-names>Alexander</given-names>
        </name>
        <xref rid="aff-3" ref-type="aff">3</xref>
      </contrib>
      <contrib id="author-3" contrib-type="author">
        <name>
          <surname>Garfinkel</surname>
          <given-names>Sarah N.</given-names>
        </name>
        <xref rid="aff-1" ref-type="aff">1</xref>
      </contrib>
      <contrib id="author-4" contrib-type="author">
        <name>
          <surname>Robinson</surname>
          <given-names>Oliver J.</given-names>
        </name>
        <xref rid="aff-1" ref-type="aff">1</xref>
        <xref rid="aff-4" ref-type="aff">4</xref>
      </contrib>
      <aff id="aff-1"><label>1</label><institution>Institute of Cognitive Neuroscience, University College London, University of London</institution>, <addr-line>London</addr-line>, <country>United Kingdom</country></aff>
      <aff id="aff-2"><label>2</label><institution>Experimental Psychology, University College London, University of London</institution>, <addr-line>London</addr-line>, <country>United Kingdom</country></aff>
      <aff id="aff-3"><label>3</label><institution>Independent Scholar</institution>, <addr-line>London</addr-line>, <country>United Kingdom</country></aff>
      <aff id="aff-4"><label>4</label><institution>Clinical, Educational and Health Psychology, University College London, University of London</institution>, <addr-line>London</addr-line>, <country>United Kingdom</country></aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Piccolo</surname>
          <given-names>Stephen</given-names>
        </name>
      </contrib>
    </contrib-group>
    <pub-date pub-type="epub" date-type="pub" iso-8601-date="2022-03-23">
      <day>23</day>
      <month>3</month>
      <year iso-8601-date="2022">2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>e13147</elocation-id>
    <history>
      <date date-type="received" iso-8601-date="2021-05-11">
        <day>11</day>
        <month>5</month>
        <year iso-8601-date="2021">2021</year>
      </date>
      <date date-type="accepted" iso-8601-date="2022-03-01">
        <day>1</day>
        <month>3</month>
        <year iso-8601-date="2022">2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2022 Kirk et al.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Kirk et al.</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, reproduction and adaptation in any medium and for any purpose provided that it is properly attributed. For attribution, the original author(s), title, publication source (PeerJ) and either DOI or URL of the article must be cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="https://peerj.com/articles/13147"/>
    <abstract>
      <p>Heart rate and heart rate variability have enabled insight into a myriad of psychophysiological phenomena. There is now an influx of research attempting using these metrics within both laboratory settings (typically derived through electrocardiography or pulse oximetry) and ecologically-rich contexts (<italic toggle="yes">via</italic> wearable photoplethysmography, <italic toggle="yes">i.e.</italic>, smartwatches). However, these signals can be prone to artifacts and a low signal to noise ratio, which traditionally are detected and removed through visual inspection. Here, we developed an open-source Python package, RapidHRV, dedicated to the preprocessing, analysis, and visualization of heart rate and heart rate variability. Each of these modules can be executed with one line of code and includes automated cleaning. In simulated data, RapidHRV demonstrated excellent recovery of heart rate across most levels of noise (&gt;=10 dB) and moderate-to-excellent recovery of heart rate variability even at relatively low signal to noise ratios (&gt;=20 dB) and sampling rates (&gt;=20 Hz). Validation in real datasets shows good-to-excellent recovery of heart rate and heart rate variability in electrocardiography and finger photoplethysmography recordings. Validation in wrist photoplethysmography demonstrated RapidHRV estimations were sensitive to heart rate and its variability under low motion conditions, but estimates were less stable under higher movement settings.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <kwd>Heart rate variability</kwd>
      <kwd>Remote sensing</kwd>
      <kwd>Python</kwd>
      <kwd>Toolbox</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="fund-1">
        <funding-source>Leverhulme Trust as part of the Doctoral Training Program for the Ecological Study of the Brain</funding-source>
        <award-id>DS-2017-026</award-id>
      </award-group>
      <award-group id="fund-2">
        <funding-source>MRC and NIHR CARP award</funding-source>
        <award-id>MR/V037676/1</award-id>
      </award-group>
      <award-group id="fund-3">
        <funding-source>MRC Senior Non Clinical Fellowship award</funding-source>
        <award-id>MR/R020817/1</award-id>
      </award-group>
      <funding-statement>This work was supported by the Leverhulme Trust as part of the Doctoral Training Program for the Ecological Study of the Brain (DS-2017-026, to Peter A. Kirk), MRC and NIHR CARP award (MR/V037676/1, to Sarah N. Garfinkel), and MRC Senior Non Clinical Fellowship award (MR/R020817/1, to Oliver J. Robinson). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>RAPIDHRV: an Open-Source Toolbox for Extracting Heart Rate and Heart Rate Variability</title>
    <p>Evidence has outlined a link between heart rate, heart rate variability, and health-related risks, ranging from cardiac mortality to mental illness (<xref rid="ref-13" ref-type="bibr">Hillebrand et al., 2013</xref>; <xref rid="ref-16" ref-type="bibr">Jandackova et al., 2016</xref>; <xref rid="ref-22" ref-type="bibr">Makovac et al., 2016a</xref>; <xref rid="ref-29" ref-type="bibr">Pham et al., 2021</xref>). Consequently, there is now an influx of research looking into whether these measures can be derived in naturalistic settings to track clinically-relevant outcomes, namely through wearable devices (<xref rid="ref-9" ref-type="bibr">Georgiou et al., 2018</xref>; <xref rid="ref-25" ref-type="bibr">Mulcahy et al., 2019</xref>). However, a key issue when opting to use the measures in naturalistic settings are the low signal to noise ratios (<italic toggle="yes">e.g.</italic>, photoplethysmography (PPG), a typical measure for cardiac monitoring in wrist wearables, <xref rid="ref-4" ref-type="bibr">Caizzone, Boukhayma &amp; Enz, 2017</xref>). Moreover, heart rate variability measures generally require relatively longer windows for extraction compared to heart rate (<xref rid="ref-42" ref-type="bibr">Baek et al., 2015</xref>). Thus, significant noise poses a problem for out-of-laboratory applications, as point estimates can contain large errors from technological limitations and motion artifacts within windows of extraction. In experimental settings, noise has often been dealt with through visual inspection of data (<xref rid="ref-23" ref-type="bibr">Makovac et al., 2016b</xref>; <xref rid="ref-33" ref-type="bibr">Rae et al., 2020</xref>); but when approaching time courses in relatively larger-scale samples, manual outlier detection is not a pragmatic solution.</p>
    <p>Whilst some open-source packages are already available for the analysis of heart rate and heart rate variability, these are typically modality-specific, and not targeted at wrist-worn measures (<italic toggle="yes">e.g., pyVHR</italic> for video-based estimation, <xref rid="ref-3" ref-type="bibr">Boccignone et al., 2020</xref>). Some modality-general packages do exist, but these often still require manual visual inspection and/or can require custom scripting on the users end for tailoring to <italic toggle="yes">e.g.</italic>, noisy, wrist-worn PPG measures (‘Analysing_Smartwatch_Data’ in <italic toggle="yes">HeartPy</italic>, <xref rid="ref-43" ref-type="bibr">van Gent et al., 2019</xref>; <italic toggle="yes">NeuroKit2</italic>, <xref rid="ref-29" ref-type="bibr">Pham et al., 2021</xref>). As such, these are often less suited for dealing with datasets collected across large time frames. Consequently, we set out to develop a simple yet flexible toolbox for the extraction of time-domain heart rate and heart rate variability measures with automated artifact rejection applicable across recording modalities, including wrist-worn PPG. Here, we present the development and validation of an open-source Python package, ‘RapidHRV’.</p>
  </sec>
  <sec>
    <title>Pipeline</title>
    <p>RapidHRV was developed in Python (V 3.9). RapidHRV source code and tutorials are available to download through PyPi (<uri xlink:href="https://pypi.org/project/rapidhrv/">https://pypi.org/project/rapidhrv/</uri>) and GitHub (<uri xlink:href="https://github.com/peterakirk/RapidHRV">https://github.com/peterakirk/RapidHRV</uri>). Below we provide an overview of RapidHRVs preprocessing, analysis (<xref rid="fig-1" ref-type="fig">Fig. 1</xref>), and visualization. Each of the three modules only requires one function (one line of code) to run, for which we have embedded examples at the end of the relevant sections below.</p>
    <fig position="float" id="fig-1">
      <object-id pub-id-type="doi">10.7717/peerj.13147/fig-1</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Overview of RapidHRV pipeline.</title>
        <p>Across an entire block, the pipeline initially processes data with high-pass filtering, upsampling, and smoothing. RapidHRV then applies a sliding window across the entire block. Within each window, the data are scaled. Heart rate (beats per minute) and heart rate variability (root mean squared of successive differences + standard deviation of intervals) are calculated for each window, and data is submitted to outlier rejection. RapidHRV produces both a cleaned and uncleaned time series of heart rate and heart rate variability.</p>
      </caption>
      <graphic xlink:href="peerj-10-13147-g001" position="float"/>
    </fig>
    <sec>
      <title>Preprocessing</title>
      <p>First, data is upsampled with cubic spline interpolation (3rd order polynomial; default = 1 kHz) to increase temporal accuracy of peak detection. To mitigate potential long-term drifts in the signal, the pipeline then applies a high pass butterworth filter (0.5 Hz) across the input data. Finally smoothing with a savitzky-golay filter (3<sup>rd</sup> order polynomial; default = 100 ms) is applied to reduce spiking (sharp increases in the signal caused by artifacts such as motion) whilst retaining temporal precision.</p>
    </sec>
  </sec>
  <sec>
    <title>Extracting Heart Rate and Heart Rate Variability</title>
    <p>Following preprocessing, the pipeline scales the data (between 0 and 100) and runs peak detection on every window (default width = 10 s; for a methodological discussion and prior validation of using ultra-short, 10 s windows in heart rate variability estimation, see <xref rid="ref-26" ref-type="bibr">Munoz et al., 2015</xref>). This outputs peaks and their properties (<italic toggle="yes">e.g.</italic>, heights, amplitudes, width; <italic toggle="yes">SciPy</italic> ‘find_peaks’, <xref rid="ref-40" ref-type="bibr">Virtanen et al., 2020</xref>). For ECG data however, peak detection is vulnerable to irrelevant prominent P and T waves. Specifically, traditional amplitude-based analyses may occasionally detect non-R wave peaks that demonstrate a similar or greater amplitude than R waves. Consequently, for ECG data, RapidHRV can implement k-means clustering (k = 3) to discern R waves from P and T waves prevalent in the signal (<italic toggle="yes">scikit-learn</italic> ‘KMeans’, <xref rid="ref-28" ref-type="bibr">Pedregosa et al., 2011</xref>). This is implemented by reducing the minimum amplitude threshold to near-zero (<italic toggle="yes">i.e.</italic>, 5%), running amplitude-based peak detection, then sorting peaks into three clusters using relevant properties (<italic toggle="yes">i.e.</italic>, peak widths, heights, and prominences). R waves are then determined based on cluster centroids for peak properties, expecting R waves to hold higher prominences and lower widths compared to P and T waves. <xref rid="fig-2" ref-type="fig">Figure 2</xref> demonstrates an example (from dataset 3, see <italic toggle="yes">Validation Methods</italic>) wherein amplitude-based analyses may incorrectly identify T waves as R waves in an atypical ECG signal, and how RapidHRV’s peak clustering helps mitigate this.</p>
    <fig position="float" id="fig-2">
      <object-id pub-id-type="doi">10.7717/peerj.13147/fig-2</object-id>
      <label>Figure 2</label>
      <caption>
        <title>Example of how the implementation of traditional amplitude-based analyses may be insufficient for peak detection, particularly for atypical ECG signals.</title>
        <p>Traditional amplitude-based peak detection (top) incorrectly identifies T waves as the relevant peak of interest. However, using RapidHRV’s implementation of k-means clustering (bottom), we are able to derive measures based on the correct peaks (<italic toggle="yes">i.e.</italic>, R waves).</p>
      </caption>
      <graphic xlink:href="peerj-10-13147-g002" position="float"/>
    </fig>
    <p>As RapidHRV uses fixed movements for the sliding window, a window can start or end at any point during the cardiac signal. This can occasionally result in underestimation of the first/last peak’s amplitude as the baseline value may—for example—be set during the P wave. Therefore, RapidHRV recalculates amplitudes of the first/last peaks using baseline imputation from the neighboring peaks.</p>
    <p>For extracting beats per minute (BPM) the number of peaks, k − 1, is multiplied by 60 (seconds), and divided by the difference in time between the first and last peaks, i and j:</p>
    <p>
      <disp-formula id="ueqn-1">
        <alternatives>
          <graphic xlink:href="peerj-10-13147-e001.jpg" position="float"/>
          <tex-math id="tex-ueqn-1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol {\rm BPM}=((k-{\bf 1})*{\bf 60})/(j-i)}$\end{document}</tex-math>
          <mml:math id="mml-ueqn-1" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="bold">B</mml:mi>
                <mml:mi mathvariant="bold">P</mml:mi>
                <mml:mi mathvariant="bold">M</mml:mi>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>k</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mrow>
                <mml:mn mathvariant="bold">1</mml:mn>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>∗</mml:mo>
              <mml:mrow>
                <mml:mn mathvariant="bold">60</mml:mn>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mrow>
                <mml:mo>/</mml:mo>
              </mml:mrow>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi mathvariant="bold-italic">j</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mi mathvariant="bold-italic">i</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
          </mml:math>
        </alternatives>
      </disp-formula>
    </p>
    <p>The root mean square of successive differences is calculated by obtaining: (1) the interbeat interval, IBI<sub>i</sub>, between neighboring peaks; (2) the successive differences in interbeat intervals, IBI<sub>i</sub> − IBI<sub>i+1</sub>; (3) the square of differences; (4) the mean of squared differences (dividing by the number peaks, N − 1); and (5) the root of the mean square of successive differences (RMSSD):</p>
    <p>
      <disp-formula id="ueqn-2">
        <alternatives>
          <graphic xlink:href="peerj-10-13147-e002.jpg" position="float"/>
          <tex-math id="tex-ueqn-2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol {\rm RMSSD}={ 2} \sqrt {\sum_{\it i={\boldsymbol 1}}^{\it N-{\boldsymbol 1}}({{\rm IBI}_{\it i}-{\rm IBI}_{\it i+{\boldsymbol 1}})}^2\over{\boldsymbol N-{\boldsymbol 1}}}}$\end{document}</tex-math>
          <mml:math id="mml-ueqn-2" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtext>RMSSD</mml:mtext>
              <mml:mo>=</mml:mo>
              <mml:mn>2</mml:mn>
              <mml:msqrt>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munderover>
                          <mml:mo>∑</mml:mo>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mstyle mathvariant="bold" mathsize="normal">
                              <mml:mn>1</mml:mn>
                            </mml:mstyle>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>N</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mstyle mathvariant="bold" mathsize="normal">
                              <mml:mn>1</mml:mn>
                            </mml:mstyle>
                          </mml:mrow>
                        </mml:munderover>
                        <mml:mo stretchy="false">(</mml:mo>
                      </mml:mstyle>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mtext>IBI</mml:mtext>
                        </mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mtext>IBI</mml:mtext>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mstyle mathvariant="bold" mathsize="normal">
                            <mml:mn>1</mml:mn>
                          </mml:mstyle>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msup>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mn>2</mml:mn>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold" mathsize="normal">
                        <mml:mi>N</mml:mi>
                      </mml:mstyle>
                      <mml:mo>−</mml:mo>
                      <mml:mstyle mathvariant="bold" mathsize="normal">
                        <mml:mn>1</mml:mn>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:msqrt>
            </mml:mrow>
          </mml:math>
        </alternatives>
      </disp-formula>
    </p>
    <p>BPM and RMSSD were selected as the primary measures as they appear to be the most stable metrics when derived from ulta-short recordings (<xref rid="ref-42" ref-type="bibr">Baek et al., 2015</xref>). RapidHRV also supplements these measures with the standard deviation of N-N intervals (SDNN), standard deviation of successive differences (SDSD), proportion of successive differences greater than 20 ms (PNN20), proportion of successive differences greater than 50 ms (PNN50), and high-frequency power (HF; note: as this requires more data points than time-domain analyses NaN is returned if there is insufficient data).</p>
    <sec>
      <title>Outlier detection</title>
      <p>The last phase of the pipeline is to pass measures derived from peak extraction to outlier rejection (<xref rid="fig-3" ref-type="fig">Fig. 3</xref>). This is applied at the level of the sliding window. If a window is declared an outlier, heart rate and heart rate variability measures are removed from the cleaned time series. By default, RapidHRV returns both the cleaned and the uncleaned time series. In addition to default parameters listed below, the package has optional arguments embedded to allow users to override these presets. Given that not all users may be entirely comfortable manually adjusting these, RapidHRV additionally contains semantically-labeled arguments as inputs for outlier constraints (‘liberal’, ‘moderate’ [default], and ‘conservative’; corresponding parameters are parenthesized under <italic toggle="yes">Biological Constraints</italic> and <italic toggle="yes">Statistical Constraints</italic>).</p>
      <fig position="float" id="fig-3">
        <object-id pub-id-type="doi">10.7717/peerj.13147/fig-3</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Outlier rejection methods for Rapid HRV.</title>
          <p>The only outlier rejection method applied to the uncleaned time series is screening for a sufficient number of peaks to derive metrics. The cleaned time series then goes through a battery of biological constraints (thresholding minimum/maximum beats per minute (BPM) and root mean square of successive differences (RMSSD)) and statistical constraints (median absolute deviation (MAD) of peak heights, prominences, and intervals; ensuring adequate duration from first to last peaks).</p>
        </caption>
        <graphic xlink:href="peerj-10-13147-g003" position="float"/>
      </fig>
      <p><bold>Biological Constraints</bold>. RapidHRV first applies restrictions to exclude data that are highly unlikely given known physiology:
<list list-type="order"><list-item><p>Screening for sufficient peaks in a window (default: number of peaks &gt; (window width/5) + 2), floored at 3; default at 10 s = 3 peaks). This is primarily for computational applicability and efficacy, screening data prior to further processing. The minimum number of peaks required to enable calculation of RMSSD is 3. As such, this is also applied to the uncleaned time series.</p></list-item><list-item><p>Minimal and maximal heart rate (‘moderate’ [default]: 30 &gt; BPM &gt; 190; ‘liberal’: 20 &gt; BPM &gt; 200; ‘conservative’: 40 BPM &gt; 180). These boundaries were based on typical heart rate at rest and during exercise in the healthy population (<xref rid="ref-30" ref-type="bibr">Pierpont &amp; Voth, 2004</xref>; <xref rid="ref-36" ref-type="bibr">Sandvik et al., 1995</xref>; <xref rid="ref-37" ref-type="bibr">Savonen et al., 2006</xref>).</p></list-item><list-item><p>Minimal and maximal heart rate variability (‘moderate’ [default]: 5 &gt; RMSSD &gt; 262; ‘liberal’: 0 &gt; RMSSD &gt; 300; ‘conservative’: 10 &gt; RMSSD &gt; 200). Default arguments correspond to the minimum/maximum 2nd/98th percentiles of resting RMSSD across ages 16–89 years (<xref rid="ref-39" ref-type="bibr">van den Berg et al., 2018</xref>).</p></list-item></list></p>
      <p><bold>Statistical constraints</bold>. RapidHRV next applies statistical constraints to account for noisy data that may otherwise appear to provide measures within the range of known physiology:
<list list-type="simple"><list-item><p>4. Median absolute deviation (MAD) of peak heights (distance from minimum value of signal in window; <italic toggle="yes">i.e.</italic>, 0) and prominence (amplitude from baseline height; ‘moderate’ [default] = 5 MAD units; ‘liberal’ = 7; ‘conservative’ = 4). Unlike Z-scoring, this quantifies each peak’s height and prominence in a given window in terms of its deviation from the median value in the same window (for a discussion of median absolute deviation see <xref rid="ref-20" ref-type="bibr">Leys et al., 2013</xref>). Applying these constraints to height and prominence helps exclude windows with noise-driven inaccuracies in peak detection.</p></list-item><list-item><p>5. Median absolute deviation of interbeat intervals (‘moderate’ [default] = 5 MAD units; ‘liberal’ = 7; ‘conservative’ = 4). This was also implemented to account for inaccuracies in peak detection, either where spiking may cause detection of an irrelevant peak shortly after <italic toggle="yes">e.g.</italic>, an R wave, or low signal to noise ratio may result in missing relevant peaks.</p></list-item><list-item><p>6. Time from the first peak to the last peak does not recede 50% of the fixed window width. This is to ensure the user that the <italic toggle="yes">actual</italic> length of time for extracting HR/HRV is not less than half of that which is specified in the window width argument. Given debates surrounding adequacy of different window lengths for HRV extraction (<xref rid="ref-42" ref-type="bibr">Baek et al., 2015</xref>; <xref rid="ref-26" ref-type="bibr">Munoz et al., 2015</xref>), this was implemented primarily as a theoretical constraint (rather than for just cleaning <italic toggle="yes">per se</italic>) to ensure the user is not provided data that deviated significantly from their specified window.</p></list-item></list></p>
      <p>Analysis can be executed with one line of code, which returns a pandas DataFrame (<xref rid="ref-24" ref-type="bibr">McKinney, 2012</xref>; <xref rid="ref-34" ref-type="bibr">Reback et al., 2022</xref>) containing the analyzed data.</p>
    </sec>
    <sec>
      <title>Visualization</title>
      <p>To allow for selected manual inspection, we have also implemented optional interactive visualizations <italic toggle="yes">via</italic> matplotlib (<xref rid="ref-14" ref-type="bibr">Hunter, 2007</xref>) which allow the user to plot the time course of heart rate and heart rate variability. The user can then select and view specific data points to see the window of extraction (<xref rid="fig-4" ref-type="fig">Fig. 4</xref>). We have provided an example pipeline below:</p>
      <fig position="float" id="fig-4">
        <object-id pub-id-type="doi">10.7717/peerj.13147/fig-4</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Interactive visualization.</title>
          <p>The user is presented with the timeseries of HR/HRV metric (specific measure can be selected from the top tab; <italic toggle="yes">i.e.</italic>, RMSSD has been selected). Users can click on specific timepoints to view extraction windows (top right; foreground).</p>
        </caption>
        <graphic xlink:href="peerj-10-13147-g004" position="float"/>
      </fig>
      <p>
        <monospace>import rapidhrv as rhv</monospace>
      </p>
      <p>
        <monospace>example_signal = rhv.get_example_data() # Load example data</monospace>
      </p>
      <p>
        <monospace>preprocessed = rhv.preprocess(example_signal) # Preprocess data</monospace>
      </p>
      <p>
        <monospace>analyzed = rhv.analyze(preprocessed) # Analyze data</monospace>
      </p>
      <p>
        <monospace>rhv.visualize(analyzed) # Visualize data</monospace>
      </p>
    </sec>
  </sec>
  <sec>
    <title>Validation Methods</title>
    <sec>
      <title>Datasets</title>
      <p>To validate the above pipeline we subjected it to a series of tests across both simulated and real data (<xref rid="table-1" ref-type="table">Table 1</xref>). We first started by testing RapidHRV’s estimations in two sets of simulated data (PPGSynth; <xref rid="ref-38" ref-type="bibr">Tang et al., 2020</xref>). Next, we ran validation in real data across successively noisier modalities: electrocardiography (ECG), finger infrared photoplethysmography (IR PPG), and wrist PPG data. Database information and code generated in validation tests are available through the open science framework (<uri xlink:href="https://osf.io/7zvn9/">https://osf.io/7zvn9/</uri>).</p>
      <table-wrap position="float" id="table-1">
        <object-id pub-id-type="doi">10.7717/peerj.13147/table-1</object-id>
        <label>Table 1</label>
        <caption>
          <title>Simulated and real datasets used for validation of RapidHRV.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-10-13147-g011" position="float"/>
          <table frame="hsides" rules="groups" content-type="text">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Dataset</th>
                <th rowspan="1" colspan="1">Modality</th>
                <th rowspan="1" colspan="1">
                  <italic toggle="yes">N</italic>
                </th>
                <th rowspan="1" colspan="1">Conditions</th>
                <th rowspan="1" colspan="1">Duration</th>
                <th rowspan="1" colspan="1">Hz</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">1. Simulation</td>
                <td rowspan="1" colspan="1">PPGSynth</td>
                <td rowspan="1" colspan="1">273</td>
                <td rowspan="1" colspan="1">None (noise)</td>
                <td rowspan="1" colspan="1">5 min</td>
                <td rowspan="1" colspan="1">20–250 Hz</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">2. Simulation</td>
                <td rowspan="1" colspan="1">PPGSynth</td>
                <td rowspan="1" colspan="1">172 (10 repeats)</td>
                <td rowspan="1" colspan="1">‘Anxiety’</td>
                <td rowspan="1" colspan="1">5 min</td>
                <td rowspan="1" colspan="1">20–250 Hz</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">3. <xref rid="ref-15" ref-type="bibr">Iyengar et al. (1996)</xref></td>
                <td rowspan="1" colspan="1">ECG</td>
                <td rowspan="1" colspan="1">40</td>
                <td rowspan="1" colspan="1">Movie</td>
                <td rowspan="1" colspan="1">~2 h</td>
                <td rowspan="1" colspan="1">250 Hz</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">4. <xref rid="ref-7" ref-type="bibr">de Groot, Kirk &amp; Gottfried (2020)</xref></td>
                <td rowspan="1" colspan="1">Finger IR PPG</td>
                <td rowspan="1" colspan="1">39</td>
                <td rowspan="1" colspan="1">Anxiety (sitting)</td>
                <td rowspan="1" colspan="1">2 × 28 min</td>
                <td rowspan="1" colspan="1">1,000 Hz</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">5. <xref rid="ref-35" ref-type="bibr">Reiss et al. (2019)</xref></td>
                <td rowspan="1" colspan="1">Wrist PPG</td>
                <td rowspan="1" colspan="1">15</td>
                <td rowspan="1" colspan="1">Varying activities</td>
                <td rowspan="1" colspan="1">~2.5 h</td>
                <td rowspan="1" colspan="1">64 Hz</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p><bold>1. Simulations Across Noise and Sampling Rates</bold>. We first took the pipeline forward to validation using simulated photoplethysmography (PPG) data from PPGSynth (<xref rid="ref-38" ref-type="bibr">Tang et al., 2020</xref>) in MATLAB. This allowed us to test how well RapidHRV recovered known parameters under specified conditions, such as sampling rate and noise. We produced 5 min long synthetic datasets (1,000 Hz), each of which varied according to the following cardiac features:
<list list-type="bullet"><list-item><p>Mean heart rate (BPM range 60–120, increments of 5). These were selected to allow us to check the sensitivity of the pipeline for detecting values across typical resting heart rate, as well as elevations of these values.</p></list-item><list-item><p>Heart rate variability (RMSSD range 0–100, increments of 5). Again, these were selected based on typical resting heart rate variability and moderate increases/decreases.</p></list-item></list></p>
      <p>Following simulation of the data, we introduced noise <italic toggle="yes">via</italic>:
<list list-type="bullet"><list-item><p>White gaussian noise filtering (signal to noise ratios = 0.01, 10, 20, 30, 40, 50, and 60 dB). Here, we selected a range of values starting from near-zero to ascertain at which level of noise the pipeline could no longer recover parameters (with near-zero expected to prevent the extraction of any meaningful metrics).</p></list-item><list-item><p>Downsampling (frequencies = 20, 50, 100, and 250 Hz). These were selected: (A) to capture the range of sampling rates currently used in photoplethysmography studies (typically &gt;= 20 Hz); and (B) because prior work has suggested sensitivity to RMSSD deteriorates dramatically between 20–100 Hz (<xref rid="ref-6" ref-type="bibr">Choi &amp; Shin, 2017</xref>). This offered the opportunity to test the effects of cleaning on what would otherwise be considered poor quality data.</p></list-item></list></p>
      <p><bold>2. Simulated ‘Anxiety’</bold>. Again, we simulated data using PPGSynth. However, simulations were based on prior anxiety literature to emulate experiment-specific effects. We wanted to validate the sensitivity of the pipeline across specified sampling rates and levels of noise but in the context of a known psychophysiological effect. For this, we used an estimated Cohen’s <italic toggle="yes">d</italic> of 0.384, which was derived from a previous within-subjects threat-of-shock study (RMSSD, t<sub>25</sub> = 1.96, polarity flipped for readability; <xref rid="ref-10" ref-type="bibr">Gold, Morey &amp; McCarthy, 2015</xref>). To reflect decisions in experimental design, we ran a power calculation using the ‘pwr’ package (<xref rid="ref-5" ref-type="bibr">Champely et al., 2017</xref>) in R (<xref rid="ref-32" ref-type="bibr">R Core Team, 2013</xref>), leading us to simulate a sample of <italic toggle="yes">N</italic> = 171 (α = 0.001, 1 − β = 0.95). These ‘experiments’ were simulated 10 times to ascertain confidence intervals around estimated effect sizes.</p>
      <p>For each ‘subject’, we generated a 5 min simulated time series (1 kHz) using typical resting heart rate and heart rate variability (BPM: μ = 74, σ = 13, <xref rid="ref-37" ref-type="bibr">Savonen et al., 2006</xref>; RMSSD: μ = 23, σ = 7, bounded between 5–262, <xref rid="ref-27" ref-type="bibr">Nunan, Sandercock &amp; Brodie, 2010</xref>). These simulations were intended to emulate the ‘safe’ condition (no anxiety induction) in a threat-of-shock study. Next, we simulated another time series for each subject that deviated from their ‘safe’ RMSSD (heart rate held constant) based on our effect size estimate (<italic toggle="yes">d</italic> = 0.384). This emulated our ‘threat’ (anxiety induction) condition and contained general reductions in heart rate variability. Each time series was finally submitted to downsampling and noise filtering using the same parameters as in the previous simulations (white gaussian noise filtering to 0.01, 10, 20, 30, 40, 50, 60 dB; downsampling to 20, 50, 100, and 250 Hz).</p>
      <p><bold>3. Estimation <italic toggle="yes">via</italic> ECG</bold>. Following simulations, we wanted to clarify that our package was able to adequately extract measures from one of the highest standards for heart rate variability recordings, ECG. Here, we tested whether our package was able to recapitulate known age-related effects of heart rate variability. For this, we used the <italic toggle="yes">Fantasia</italic> database (<xref rid="ref-15" ref-type="bibr">Iyengar et al., 1996</xref>). This consisted of 40 subjects (20 ‘Young’ Age Range = 21–34 years; 20 ‘Old’ Age Range = 68–81 years) watching the movie ‘Fantasia’ (duration ≈ 2 h) whilst undergoing ECG recordings. Automated peak detection was previously run on this dataset, with every beat annotation verified by visual inspection. The full dataset and description is available on PhysioNet (<uri xlink:href="https://physionet.org/content/fantasia/1.0.0/">https://physionet.org/content/fantasia/1.0.0/</uri>; <xref rid="ref-11" ref-type="bibr">Goldberger et al., 2000</xref>).</p>
      <p><bold>4. Estimation <italic toggle="yes">via</italic> finger PPG</bold>. We next took the pipeline forward to validation in a modality considered relatively noisier than ECG, finger photoplethysmography. Here, we used a dataset of 39 subjects (Age: Mean = 22.67; Range = 18–38 years; demographics reported prior to <italic toggle="yes">N</italic> = 1 exclusion) watching 2 × 28 min blocks of documentary and horror video clips undergoing finger IR PPG recording (1,000 Hz, <xref rid="ref-7" ref-type="bibr">de Groot, Kirk &amp; Gottfried, 2020</xref>). This allowed us to contrast psychological conditions of the experiment, testing whether RapidHRV was able to detect effects of anxiety. Moreover, in the original study, data had been preprocessed and analyzed using a commercially available software (Labchart; ADInstruments, Sydney, Australia; analyzed using built-in ‘Peak Analysis’ module). This allowed us to benchmark RapidHRV against another software. The full dataset and description is available <italic toggle="yes">via</italic> the Open Science Framework (<uri xlink:href="https://osf.io/y76p2/">https://osf.io/y76p2/</uri>).</p>
      <p><bold>5. Estimation <italic toggle="yes">via</italic> wrist PPG</bold>. Finally, we analyzed the <italic toggle="yes">PPG-DaLiA</italic> dataset, which consists of 15 subjects (Age: Mean = 30.60 years; Range = 21–55) completing various activities whilst having wrist PPG recorded with an Empatica E4 device (Hz = 64) and simultaneous ECG measures with a RespiBAN (Hz = 700, <xref rid="ref-35" ref-type="bibr">Reiss et al., 2019</xref>). Over the course of 2.5 h, participants engaged in a range of activities designed to elicit low and high motion. These were: sitting and reading; ascending/descending stairs; 1 v 1 table soccer; cycling on pavements and gravel; driving a car; lunch break (queuing, purchasing, and eating food in a cafeteria); walking; and working at a desk (typically on a computer). This allowed us to test whether RapidHRV was able to extract heart rate and variability measures from wrist PPG and how these compared to ECG measurements. Moreover, this enabled us to highlight under what conditions estimations are optimal. For the full dataset and description, see <xref rid="ref-35" ref-type="bibr">Reiss et al. (2019)</xref>.</p>
    </sec>
    <sec>
      <title>Analyses</title>
      <p>Unless otherwise stated, all analyses were conducted using RapidHRV’s default arguments: window width = 10 s; window movement = 10 s; outlier method = ‘moderate’ ((peak/height median absolute deviation = 5, interbeat interval median absolute deviation = 5, BPM range = 30–190, RMSSD range = 5–262); minimum window successful extraction = 5 s, minimum amplitude for peak detection = 50, minimum distance between peaks = 250 ms; for ECG data, ecg_prt_clustering = True). To assess performance across datasets, we used: visualizations; intraclass correlation coefficients (ICC; two-way mixed effects, absolute agreement, single measure); root-mean-square-error (RMSE); and sensitivity to experimental effects (Cohen’s <italic toggle="yes">d</italic>). For ICC values, we used the following semantic labels for interpretation: ICC &lt; 0.5 as ‘poor’, 0.5 &lt; ICC &lt; 0.75 as ‘moderate’; 0.75 &lt; ICC &lt; 0.90 as ‘good’, and 0.90 &lt; ICC as ‘excellent’ (<xref rid="ref-17" ref-type="bibr">Koo &amp; Li, 2016</xref>).</p>
      <p>In our wrist PPG dataset, we also calculated motion estimates as a proxy for the severity of noise present in PPG across conditions. We derived mean jerk magnitude (square root of the sum of squared changes in acceleration; <xref rid="ref-8" ref-type="bibr">Eager, Pendrill &amp; Reistad, 2016</xref>), which aimed to pick up on oscillatory (‘jerk’) motions in the wrist for each condition. Across all axes (x, y, and z; m/s^2), jerk vector, j, was calculated as the change in acceleration, a, divided by the change in time, t, between samples:</p>
      <p>
        <disp-formula id="ueqn-3">
          <alternatives>
            <graphic xlink:href="peerj-10-13147-e003.jpg" position="float"/>
            <tex-math id="tex-ueqn-3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol{{\vec j}(t)}={\Delta{{\vec a}(t)}\over\Delta{t}}}$\end{document}</tex-math>
            <mml:math id="mml-ueqn-3" display="block" overflow="scroll">
              <mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mover>
                        <mml:mi mathvariant="bold-italic">j</mml:mi>
                        <mml:mo mathvariant="bold" stretchy="false">→</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo mathvariant="bold" stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold-italic">t</mml:mi>
                  <mml:mo mathvariant="bold" stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">Δ</mml:mi>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mover>
                              <mml:mi>a</mml:mi>
                              <mml:mo stretchy="false">→</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>t</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="normal">Δ</mml:mi>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>Finally, we derived jerk magnitudes by calculating the square root of the sum of squared jerks, j, for axes x, y, and z:</p>
      <p>
        <disp-formula id="ueqn-4">
          <alternatives>
            <graphic xlink:href="peerj-10-13147-e004.jpg" position="float"/>
            <tex-math id="tex-ueqn-4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\boldsymbol {|\vec j|}={\sqrt{{j_x^{\bf 2}}+{j_y^{\bf 2}}+{j_z^{\bf 2}}}}}$\end{document}</tex-math>
            <mml:math id="mml-ueqn-4" display="block" overflow="scroll">
              <mml:mrow>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">|</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mover>
                      <mml:mi mathvariant="bold-italic">j</mml:mi>
                      <mml:mo mathvariant="bold" stretchy="false">→</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">|</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:msqrt>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>j</mml:mi>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mn mathvariant="bold">2</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                    <mml:mo>+</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>j</mml:mi>
                        <mml:mi>y</mml:mi>
                        <mml:mrow>
                          <mml:mn mathvariant="bold">2</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                    <mml:mo>+</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>j</mml:mi>
                        <mml:mi>z</mml:mi>
                        <mml:mrow>
                          <mml:mn mathvariant="bold">2</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:msqrt>
                </mml:mrow>
              </mml:mrow>
            </mml:math>
          </alternatives>
        </disp-formula>
      </p>
      <p>For each subject, jerk magnitudes were averaged across time for each condition.</p>
    </sec>
  </sec>
  <sec>
    <title>Validation Results</title>
    <sec>
      <title>Parameter recovery in simulated PPG</title>
      <p>RapidHRV was able to accurately recover heart rate across most sampling frequencies and noise in our initial simulations. Accurate detection of BPM primarily started to degrade when signal to noise ratios were less than 10 dB (<xref rid="fig-5" ref-type="fig">Fig. 5</xref>; <xref rid="table-2" ref-type="table">Table 2</xref>). RapidHRV cleaning provided improvements in simulations with a signal to noise ratio of 10 dB.</p>
      <fig position="float" id="fig-5">
        <object-id pub-id-type="doi">10.7717/peerj.13147/fig-5</object-id>
        <label>Figure 5</label>
        <caption>
          <title>Parameter recovery of simulated PPG data as a function of heart rate variability.</title>
          <p>Parameter recovery of simulated PPG data as a function of heart rate variability (Intraclass Correlations (ICC) and Root Mean Square Error (RMSE) against ground truth). Y axes reflect the true RMSSD in the data, whilst the X axes reflect RapidHRV’s estimation. For readability, data is only plotted in a key range of performance (subplots: 10–40 dB noise left-to-right; 20–250 Hz top-to-bottom).</p>
        </caption>
        <graphic xlink:href="peerj-10-13147-g005" position="float"/>
      </fig>
      <table-wrap position="float" id="table-2">
        <object-id pub-id-type="doi">10.7717/peerj.13147/table-2</object-id>
        <label>Table 2</label>
        <caption>
          <title>Intraclass correlations between simulated BPM and RapidHRV for uncleaned (and cleaned) data as a function of sampling rate and noise.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-10-13147-g012" position="float"/>
          <table frame="hsides" rules="groups" content-type="text">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Sampling rate</th>
                <th rowspan="1" colspan="1">0.01 dB</th>
                <th rowspan="1" colspan="1">10 dB</th>
                <th rowspan="1" colspan="1">20 dB</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">20 Hz</td>
                <td rowspan="1" colspan="1">0.06 (0<italic toggle="yes">.18</italic>)</td>
                <td rowspan="1" colspan="1">0.37 (0<italic toggle="yes">.80</italic>)</td>
                <td rowspan="1" colspan="1">0.98 (<italic toggle="yes">1.0</italic>)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">50 Hz</td>
                <td rowspan="1" colspan="1">0.18 (0<italic toggle="yes">.13</italic>)</td>
                <td rowspan="1" colspan="1">0.80 (0<italic toggle="yes">.96</italic>)</td>
                <td rowspan="1" colspan="1">1.0 (<italic toggle="yes">1.0</italic>)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">100 Hz</td>
                <td rowspan="1" colspan="1">0.33 (0<italic toggle="yes">.26</italic>)</td>
                <td rowspan="1" colspan="1">0.96 (<italic toggle="yes">1.0</italic>)</td>
                <td rowspan="1" colspan="1">1.0 (<italic toggle="yes">1.0</italic>)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">250 Hz</td>
                <td rowspan="1" colspan="1">0.62 (0<italic toggle="yes">.7</italic>)</td>
                <td rowspan="1" colspan="1">1.0 (<italic toggle="yes">1.0</italic>)</td>
                <td rowspan="1" colspan="1">1.0 (<italic toggle="yes">1.0</italic>)</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="table-2fn">
            <p>
              <bold>Note:</bold>
            </p>
          </fn>
          <fn id="table-2fn1" fn-type="other">
            <p>Higher values indicate better performance. For readability, data is only reported in a key range of performance (0.01–20 dB noise) where ICC had plateaued at ~0 and ~1.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Performance in recovery of heart rate variability was again primarily based on signal to noise ratio. At 20 dB RapidHRV recovery of RMSSD was good-to-excellent for higher sampling rates (&gt;=100 Hz), whereas lower sampling rates (&lt;100 Hz) required slightly lower levels of noise (&gt;30 dB) for excellent recovery. RapidHRV cleaning provided clear improvements when signal to noise ratio was below 30 dB (<xref rid="fig-3" ref-type="fig">Fig. 3</xref>).</p>
      <sec>
        <title>Key points</title>
        <p>
          <list list-type="bullet">
            <list-item>
              <p>RapidHRV’s estimation of simulated BPM was good-to-excellent when signal to noise ratio was 10 dB or above.</p>
            </list-item>
            <list-item>
              <p>RapidHRV’s estimation of simulated RMSSD was good-to-excellent when signal to noise ratio was 20 dB and sampling rate was 100 Hz or higher. Across all sampling rates, RMSSD recovery was excellent at 30 dB or above.</p>
            </list-item>
            <list-item>
              <p>Cleaning appeared particularly helpful when noise was high and/or sampling rate was low.</p>
            </list-item>
          </list>
        </p>
      </sec>
    </sec>
    <sec>
      <title>Sensitivity to ‘Anxiety’ in simulated PPG</title>
      <p>RapidHRV’s ability to estimate simulated effects was again primarily impacted by the level of SNR, where changes in RMSSD were not reliably detected at 0.01 and 10 dB (<xref rid="fig-6" ref-type="fig">Fig. 6</xref>; <xref rid="table-3" ref-type="table">Table 3</xref>). Effects were detected at signal to noise ratios of 20 and 30 dB, but this was estimated at around half that of the true value. Maximal effect sizes plateaued following 40 dB for uncleaned data and 30 dB for cleaned data. Moreover, reliable detection of effects in some scenarios (<italic toggle="yes">e.g.</italic>, 50 Hz, 10 dB) appeared dependent on cleaning. This was consistent with our previous validation results, in that cleaning was beneficial at lower signal to noise ratios and sampling rates, but was not necessary (or could be relaxed) in cleaner data.</p>
      <table-wrap position="float" id="table-3">
        <object-id pub-id-type="doi">10.7717/peerj.13147/table-3</object-id>
        <label>Table 3</label>
        <caption>
          <title>RMSE between ground truth and RapidHRV RMSSD collapsed across conditions.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-10-13147-g013" position="float"/>
          <table frame="hsides" rules="groups" content-type="text">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th rowspan="1" colspan="1">0.01 dB</th>
                <th rowspan="1" colspan="1">10 dB</th>
                <th rowspan="1" colspan="1">20 dB</th>
                <th rowspan="1" colspan="1">30 dB</th>
                <th rowspan="1" colspan="1">40 dB</th>
                <th rowspan="1" colspan="1">50 dB</th>
                <th rowspan="1" colspan="1">60 dB</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">20 Hz</td>
                <td rowspan="1" colspan="1">194</td>
                <td rowspan="1" colspan="1">155</td>
                <td rowspan="1" colspan="1">37</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">50 Hz</td>
                <td rowspan="1" colspan="1">189</td>
                <td rowspan="1" colspan="1">110</td>
                <td rowspan="1" colspan="1">29</td>
                <td rowspan="1" colspan="1">8</td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">100 Hz</td>
                <td rowspan="1" colspan="1">187</td>
                <td rowspan="1" colspan="1">21</td>
                <td rowspan="1" colspan="1">21</td>
                <td rowspan="1" colspan="1">6</td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">250 Hz</td>
                <td rowspan="1" colspan="1">171</td>
                <td rowspan="1" colspan="1">14</td>
                <td rowspan="1" colspan="1">14</td>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">2</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <fig position="float" id="fig-6">
        <object-id pub-id-type="doi">10.7717/peerj.13147/fig-6</object-id>
        <label>Figure 6</label>
        <caption>
          <title>Average estimated effect size of simulated ‘anxiety’.</title>
          <p>Average estimated effect size (+95% Confidence Intervals) of simulated ‘anxiety’ on the root mean square of successive differences as a function of signal to noise ratio (SNR), sampling rate, and cleaning. Higher values indicate greater sensitivity. This suggested RapidHRV was able to estimate true effect sizes in data when signal to noise ratio was &gt;=30 dB. Visualized with ggplo2 (<xref rid="ref-41" ref-type="bibr">Wickham, 2016</xref>).</p>
        </caption>
        <graphic xlink:href="peerj-10-13147-g006" position="float"/>
      </fig>
      <sec>
        <title>Key points</title>
        <p>
          <list list-type="bullet">
            <list-item>
              <p>RapidHRV’s estimation for simulated effects of Anxiety on RMSSD was excellent when signal to noise ratio was 30 dB or above. Moreover, this estimation was robust at a low sampling rate (<italic toggle="yes">i.e.</italic>, 20 Hz).</p>
            </list-item>
            <list-item>
              <p>Cleaning was beneficial when noise was high, but was not necessary when noise was low.</p>
            </list-item>
          </list>
        </p>
      </sec>
    </sec>
    <sec>
      <title>Estimation <italic toggle="yes">via</italic> ECG</title>
      <p>As expected, visual inspection suggested ECG data to hold a high signal to noise ratio. In line with our simulation findings, we adjusted the outlier rejection method accordingly so as not to excessively exclude data (<italic toggle="yes">i.e.</italic>, ‘liberal’). The dataset had previously been analyzed using an automated peak detection algorithm, with every beat annotation verified by visual inspection (<xref rid="ref-15" ref-type="bibr">Iyengar et al., 1996</xref>). Subject-specific heart rate estimates were not available from the original database. However, RapidHRV heart rate estimations were able to recapitulate sample-wide summary statistics (<xref rid="fig-7" ref-type="fig">Fig. 7</xref>; <xref rid="table-4" ref-type="table">Table 4</xref>).</p>
      <fig position="float" id="fig-7">
        <object-id pub-id-type="doi">10.7717/peerj.13147/fig-7</object-id>
        <label>Figure 7</label>
        <caption>
          <title>Effects of age on RapidHRV-estimated RMSSD.</title>
          <p>RainCloud plot (<xref rid="ref-1" ref-type="bibr">Allen et al., 2019</xref>) demonstrating effects of age on RapidHRV-estimated RMSSD (cleaned) derived from movie-watching ECG (<italic toggle="yes">N</italic> = 40). As expected, older participants typically had lower heart rate variability than younger participants.</p>
        </caption>
        <graphic xlink:href="peerj-10-13147-g007" position="float"/>
      </fig>
      <table-wrap position="float" id="table-4">
        <object-id pub-id-type="doi">10.7717/peerj.13147/table-4</object-id>
        <label>Table 4</label>
        <caption>
          <title>Mean heart rate (and standard deviation) by age group and analysis.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-10-13147-g014" position="float"/>
          <table frame="hsides" rules="groups" content-type="text">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th rowspan="1" colspan="1">
                  <xref rid="ref-15" ref-type="bibr">Iyengar et al. (1996)</xref>
                </th>
                <th rowspan="1" colspan="1">RapidHRV (Cleaned)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Young</td>
                <td rowspan="1" colspan="1">60.55 (8.77)</td>
                <td rowspan="1" colspan="1">63.54 (9.51)</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Old</td>
                <td rowspan="1" colspan="1">57.22 (8.60)</td>
                <td rowspan="1" colspan="1">58.50 (9.17)</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The analytical method used for extraction of heart rate variability in the original database (power spectral density analysis) was inconsistent with RapidHRV’s time-domain heart rate variability measure (RMSSD). Despite this discrepancy, RapidHRV was able to capture previously reported effects of age on heart rate variability (<xref rid="ref-15" ref-type="bibr">Iyengar et al., 1996</xref>; estimated Cohen’s <italic toggle="yes">d</italic> of short-term heart rate variability (<italic toggle="yes">i.e.</italic>, α<sub>s</sub>) ≈ 1.32), such that—in cleaned data—younger participants demonstrated higher RMSSD (<italic toggle="yes">M</italic> = 58.94, <italic toggle="yes">SD</italic> = 28.82) than older participants (<italic toggle="yes">M</italic> = 25.54, <italic toggle="yes">SD</italic> = 13.02, Cohen’s <italic toggle="yes">d</italic> = 1.49; <xref rid="fig-6" ref-type="fig">Fig. 6</xref>). Effects were not apparent in the uncleaned data (Cohen’s <italic toggle="yes">d</italic> = −0.31).</p>
      <sec>
        <title>Key points</title>
        <p>
          <list list-type="bullet">
            <list-item>
              <p>In a movie-watching ECG dataset, RapidHRV was able to recapitulate previously reported summary statistics of BPM.</p>
            </list-item>
            <list-item>
              <p>RapidHRV was able to reproduce previously reported effects of age on RMSSD as measured by ECG.</p>
            </list-item>
            <list-item>
              <p>Cleaning was vital for detecting effects of age on RMSSD in ECG.</p>
            </list-item>
          </list>
        </p>
      </sec>
    </sec>
    <sec>
      <title>Estimation <italic toggle="yes">via</italic> finger PPG</title>
      <sec>
        <title>Sensitivity to anxiety</title>
        <p>In our finger IR PPG data, RapidHRV was able to capture previously reported (<xref rid="ref-7" ref-type="bibr">de Groot, Kirk &amp; Gottfried, 2020</xref>) effects of anxiety on BPM (<xref rid="table-5" ref-type="table">Table 5</xref>). RapidHRV additionally demonstrated an influence of anxiety on RMSSD. Effects on BPM were greater following cleaning, whereas detection of effects on RMSSD was entirely dependent on cleaning.</p>
        <table-wrap position="float" id="table-5">
          <object-id pub-id-type="doi">10.7717/peerj.13147/table-5</object-id>
          <label>Table 5</label>
          <caption>
            <title>Effect size (Cohen’s <italic toggle="yes">d</italic>) of heart rate and variability between conditions as a function of software and cleaning method.</title>
          </caption>
          <alternatives>
            <graphic xlink:href="peerj-10-13147-g015" position="float"/>
            <table frame="hsides" rules="groups" content-type="text">
              <colgroup span="1">
                <col span="1"/>
                <col span="1"/>
                <col span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <th rowspan="1" colspan="1">Software</th>
                  <th rowspan="1" colspan="1">BPM effect (<italic toggle="yes">d</italic>)</th>
                  <th rowspan="1" colspan="1">RMSSD effect (<italic toggle="yes">d</italic>)</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td rowspan="1" colspan="1">Labchart</td>
                  <td rowspan="1" colspan="1">0.52</td>
                  <td rowspan="1" colspan="1">0.19</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">RapidHRV (Uncleaned)</td>
                  <td rowspan="1" colspan="1">0.45</td>
                  <td rowspan="1" colspan="1">−0.04</td>
                </tr>
                <tr>
                  <td rowspan="1" colspan="1">RapidHRV (Cleaned)</td>
                  <td rowspan="1" colspan="1">0.54</td>
                  <td rowspan="1" colspan="1">0.35</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
      </sec>
      <sec>
        <title>Benchmarking</title>
        <p>Overall, there was excellent agreement between RapidHRV and previous estimates (<xref rid="ref-7" ref-type="bibr">de Groot, Kirk &amp; Gottfried, 2020</xref>; implemented using LabChart, ADInstruments, Sydney, Australia) of BPM (ICC &gt; 0.99; <xref rid="fig-8" ref-type="fig">Fig. 8</xref>). For heart rate variability, there was good agreement between the two when using the cleaned time series (ICC = 0.89), but poor agreement when using the uncleaned time series (ICC = 0.32).</p>
        <fig position="float" id="fig-8">
          <object-id pub-id-type="doi">10.7717/peerj.13147/fig-8</object-id>
          <label>Figure 8</label>
          <caption>
            <title>Agreement between RapidHRV and a previous Labchart analysis.</title>
            <p>Agreement between RapidHRV and a previous Labchart analysis (<xref rid="ref-7" ref-type="bibr">de Groot, Kirk &amp; Gottfried, 2020</xref>) of heart rate and variability in a finger IR PPG dataset (<italic toggle="yes">N</italic> = 39).</p>
          </caption>
          <graphic xlink:href="peerj-10-13147-g008" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>Key points</title>
        <p>
          <list list-type="bullet">
            <list-item>
              <p>RapidHRV was able to recapitulate previously reported effects of anxiety on BPM and RMSSD as measured by finger IR PPG.</p>
            </list-item>
            <list-item>
              <p>Cleaning was vital to the detection of effects of anxiety on RMSSD.</p>
            </list-item>
          </list>
        </p>
      </sec>
    </sec>
    <sec>
      <title>Estimation <italic toggle="yes">via</italic> wrist PPG during activities</title>
      <p>We first derived motion estimates (mean jerk magnitude; <xref rid="ref-8" ref-type="bibr">Eager, Pendrill &amp; Reistad, 2016</xref>) as a proxy for the severity of noise present in PPG. This enabled us to split conditions into low (Reading, Working, Lunch Break, Driving) and high motion activities (Table Soccer, Stairs, Walking, Cycling; <xref rid="fig-9" ref-type="fig">Fig. 9</xref>).</p>
      <fig position="float" id="fig-9">
        <object-id pub-id-type="doi">10.7717/peerj.13147/fig-9</object-id>
        <label>Figure 9</label>
        <caption>
          <title>Motion across wrist PPG activities.</title>
          <p>RainCloud plot (<xref rid="ref-1" ref-type="bibr">Allen et al., 2019</xref>) of motion across activities. Each datapoint represents an individual subject’s mean momentary jerk magnitude within a condition. Curves demonstrate distribution density across the sample (kernel density plot).</p>
        </caption>
        <graphic xlink:href="peerj-10-13147-g009" position="float"/>
      </fig>
      <p>In our initial analysis using default arguments, RapidHRV was not able to produce estimates across many of the activities for both cleaned and uncleaned data (conditions estimated: <italic toggle="yes">M</italic> = 22.5%, <italic toggle="yes">SD</italic> = 5.18%). Visual inspection confirmed this was due to high levels of noise and variable peak amplitude present in the signal. Therefore, we adjusted window movement to 1 s (to increase the number of extraction windows in each condition), reduced minimum amplitude threshold for peak detection (30), and—in line with our simulation results above (<xref rid="fig-3" ref-type="fig">Fig. 3</xref>)—tightened outlier rejection (‘conservative’). Following this, RapidHRV was able to produce estimates for all conditions in the uncleaned data and across most activities for cleaned data (conditions estimated: <italic toggle="yes">M</italic> = 87.5%, <italic toggle="yes">SD</italic> = 11.57%). Missing estimates from the latter were predominantly limited to high motion activities (1 missing estimate for a single subject in the driving condition).</p>
      <p>Across low motion activities, RapidHRV PPG-based estimates converged with simultaneous (visually verified) ECG measures (<xref rid="ref-35" ref-type="bibr">Reiss et al., 2019</xref>). Agreement with low motion activities was excellent for BPM (ICC &gt; 0.90) and agreement with RMSSD was moderate-to-good (0.57 &lt; ICC &lt; 0.82; <xref rid="table-6" ref-type="table">Table 6</xref>; <xref rid="fig-10" ref-type="fig">Fig. 10</xref>). Under high motion conditions, heart rate and heart rate variability estimates showed poor agreement (ICC &lt; 0.32), except for heart rate within the cycling condition (ICC = 0.75).</p>
      <fig position="float" id="fig-10">
        <object-id pub-id-type="doi">10.7717/peerj.13147/fig-10</object-id>
        <label>Figure 10</label>
        <caption>
          <title>Agreement between PPG-based RapidHRV-estimates and visually inspected ECG-based estimates across different activities.</title>
        </caption>
        <graphic xlink:href="peerj-10-13147-g010" position="float"/>
      </fig>
      <table-wrap position="float" id="table-6">
        <object-id pub-id-type="doi">10.7717/peerj.13147/table-6</object-id>
        <label>Table 6</label>
        <caption>
          <title>Intraclass correlations and RMSE between cleaned heart rate and variability measured derived from ECG R-R intervals (visually inspected) and RapidHRV PPG-based estimation.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-10-13147-g016" position="float"/>
          <table frame="hsides" rules="groups" content-type="text">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Activity</th>
                <th colspan="2" rowspan="1">BPM</th>
                <th colspan="2" rowspan="1">RMSSD</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Low motion</td>
                <td rowspan="1" colspan="1">ICC</td>
                <td rowspan="1" colspan="1">RMSE</td>
                <td rowspan="1" colspan="1">ICC</td>
                <td rowspan="1" colspan="1">RMSE</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Reading</td>
                <td rowspan="1" colspan="1">1.00</td>
                <td rowspan="1" colspan="1">0.57</td>
                <td rowspan="1" colspan="1">0.61</td>
                <td rowspan="1" colspan="1">30.02</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Driving</td>
                <td rowspan="1" colspan="1">0.99</td>
                <td rowspan="1" colspan="1">2.81</td>
                <td rowspan="1" colspan="1">0.68</td>
                <td rowspan="1" colspan="1">24.68</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Lunch break</td>
                <td rowspan="1" colspan="1">0.94</td>
                <td rowspan="1" colspan="1">4.45</td>
                <td rowspan="1" colspan="1">0.58</td>
                <td rowspan="1" colspan="1">31.88</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Working</td>
                <td rowspan="1" colspan="1">0.90</td>
                <td rowspan="1" colspan="1">5.16</td>
                <td rowspan="1" colspan="1">0.82</td>
                <td rowspan="1" colspan="1">18.26</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">High motion</td>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
                <td rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Walking</td>
                <td rowspan="1" colspan="1">−0.15</td>
                <td rowspan="1" colspan="1">30.01</td>
                <td rowspan="1" colspan="1">−0.12</td>
                <td rowspan="1" colspan="1">87.34</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Cycling</td>
                <td rowspan="1" colspan="1">0.75</td>
                <td rowspan="1" colspan="1">17.83</td>
                <td rowspan="1" colspan="1">0.27</td>
                <td rowspan="1" colspan="1">46.93</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Table soccer</td>
                <td rowspan="1" colspan="1">0.04</td>
                <td rowspan="1" colspan="1">25.29</td>
                <td rowspan="1" colspan="1">0.32</td>
                <td rowspan="1" colspan="1">45.97</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Stairs</td>
                <td rowspan="1" colspan="1">0.39</td>
                <td rowspan="1" colspan="1">28.95</td>
                <td rowspan="1" colspan="1">−0.18</td>
                <td rowspan="1" colspan="1">55.13</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <sec>
        <title>Key point</title>
        <p>
          <list list-type="bullet">
            <list-item>
              <p>Following calibration to the data, cleaned RapidHRV wrist PPG-based estimates demonstrated moderate-to-excellent convergence with a simultaneous ECG-based analysis whilst under low motion conditions. Agreement was generally poor under high motion conditions.</p>
            </list-item>
          </list>
        </p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <p>RapidHRV is an open-source toolbox for extracting heart rate and heart rate variability measures. RapidHRV was developed in response to the need for software dedicated to dealing with extensive cardiac data collected across large time frames, such as out-of-laboratory PPG recordings, which may require point estimates from very short time windows (~10 s). Python packages currently exist which can analyze cardiac data (<italic toggle="yes">e.g., Systole</italic>, <xref rid="ref-19" ref-type="bibr">Legrand &amp; Allen, 2020</xref>; <italic toggle="yes">NeuroKit2</italic>, <xref rid="ref-29" ref-type="bibr">Pham et al., 2021</xref>; <italic toggle="yes">pyHRV</italic>, <xref rid="ref-12" ref-type="bibr">Gomes, Margaritoff &amp; da Silva, 2019</xref>). However, outlier rejection algorithms often require visual inspection and/or extensive scripting on the user’s end. While suitable for the cardiac data collected during laboratory experiments, this may not be feasible when dealing with data collected across large time-scales, such as weeks or months. Here, we have attempted to fill this gap by developing a programmatically easy-to-use toolbox which extracts HRV measures from ultra-short windows and automates artifact detection and rejection. In general, this is applied <italic toggle="yes">via</italic> a series of biological and statistical constraints. Moreover, for ECG data, we have also implemented a k-means clustering algorithm for delineating P, R, and T waves. Across simulated and real datasets, we scrutinized RapidHRV, testing scenarios where it was and was not able to extract meaningful metrics. We show that signal to noise ratio, sampling rate, and recording modality had a clear impact on sensitivity of estimation. Here, we summarize these validation tests and make modality-specific recommendations for users.</p>
    <sec>
      <title>Simulations</title>
      <p>Within simulated data, RapidHRV was able to recover heart rate across most levels of noise (white gaussian noise filter &gt;= 10 dB), even at relatively low sampling rates (&gt;=20 Hz). RapidHRV’s recovery of heart rate variability was excellent at relatively low levels of signal to noise ratio (&gt;=20 dB), though there was degradation of performance as sampling rate decreased. Additional simulations of cardiac responses to an anxiety induction demonstrated RapidHRV estimations fully captured effects at moderate levels of noise (&gt;=30 dB) even at relatively low sampling rates (<italic toggle="yes">i.e.</italic>, 20 Hz). RapidHRV was able to partially capture effects (~50% reduction in effect size) at very high levels of noise (&gt;=10 dB when Hz &gt;50). Simulations revealed RapidHRV cleaning was particularly beneficial at lower sampling rates and higher levels of noise, but was not necessary (or could be relaxed) when signal and sampling rates were high. Moreover, these simulations were able to clarify the validity of RapidHRV’s default window (10 s) for estimation of heart rate variability across a longer time period (<italic toggle="yes">i.e.</italic>, 5 min).</p>
    </sec>
    <sec>
      <title>Electrocardiography</title>
      <p>In our electrocardiography analyses, we were able to recapitulate previously reported effects of age on heart rate and heart rate variability. In line with previous analyses (<xref rid="ref-15" ref-type="bibr">Iyengar et al., 1996</xref>), RapidHRV-estimates suggested older participants had lower heart rate variability than younger participants during movie-watching. Importantly, cleaning was vital to this detection.</p>
    </sec>
    <sec>
      <title>Finger PPG</title>
      <p>Using RapidHRV estimates, we noted effects of anxiety on heart rate and heart rate variability in a database of participants watching horror and documentary videos while undergoing finger infrared PPG recordings. Notably, the estimated effect size was analogous to that noted in threat-of-shock studies (<xref rid="ref-10" ref-type="bibr">Gold, Morey &amp; McCarthy, 2015</xref>). Moreover, when contrasting subject-specific estimates, we found good-to-excellent agreement between RapidHRV and a previous analysis using a commercially available software. Effect sizes between conditions and convergence of estimates between softwares was significantly improved following RapidHRV cleaning.</p>
    </sec>
    <sec>
      <title>Wrist PPG</title>
      <p>In our wrist PPG validation, we noted RapidHRV was not able to produce estimates for the majority of conditions due to limitations of the default arguments. Despite applying scaling (0–100) at the level of a sliding window, PPG signals showed variable peaks amplitudes. Following alterations [rhv.analyze(preprocessed, outlier_detection_settings = “conservative”, amplitude_threshold = 30, window_overlap = 9)], RapidHRV-estimates during low motion activities (<italic toggle="yes">e.g.</italic>, reading, eating lunch) demonstrated good-to-excellent agreement with a manually-verified analysis of ECG data. During high wrist-movement activities (<italic toggle="yes">e.g.</italic>, table soccer), estimates were generally poor-to-moderate. We do note however that in one of the high motion conditions, cycling, RapidHRV-estimation of heart rate was good (though heart rate variability estimation was poor). This may reflect our proxy for motion-related artifacts (jerk magnitude), which may not always be as good an estimator of artifacts during activities which involve changes in acceleration but relatively low movements in the wrists (<italic toggle="yes">i.e.</italic>, cycling, as hands are gripping the handle bars). Future work should seek to correlate RapidHRV quality assurance metrics with a wider range of motion estimation methods. Overall, we found adjustments to parameter arguments beneficial to PPG data, but we also note there are contextual factors and limitations (<italic toggle="yes">i.e.</italic>, motion-related artifacts) influencing the feasibility of accurate estimation.</p>
    </sec>
    <sec>
      <title>Overall user recommendations</title>
      <p>For ECG data, users may find traditional, amplitude-based analyses will not work for subjects who demonstrate atypical signal morphologies (<italic toggle="yes">e.g.</italic>, particularly prominent P and T waves). RapidHRV includes the use of k-means clustering to help discern these components of the ECG signal, though this is not enabled by default (ecg_prt_clustering = False). Additionally, the cleanliness of signal, namely the stability of peak prominences, means the data may be low in artifacts, and that minor deviations could be detected as outliers. As such, when dealing with already-clean data, users may find that outlier rejection can be omitted or relaxed (<italic toggle="yes">e.g.</italic>, outlier method = ‘liberal’).</p>
      <p>Results from the finger IR PPG data used in the present study did not suggest the need for alterations to default RapidHRV arguments, but did suggest that automated cleaning should be used.</p>
      <p>Lastly, PPG data collected from naturalistic settings is typically low in signal to noise ratio, which can constrain peak detection. Consequently, lowering the minimum amplitude threshold for peak detection and decreasing window movement may help improve extraction. Furthermore, given the large amount of motion-related artifacts and the results from our simulation analyses, we recommend: (a) the use of relatively conservative cleaning (<italic toggle="yes">e.g.</italic>, outlier method = ‘conservative’), and (b) inspection of motion across conditions as an indicator of estimation accuracy (<xref rid="table-7" ref-type="table">Table 7</xref>).</p>
      <table-wrap position="float" id="table-7">
        <object-id pub-id-type="doi">10.7717/peerj.13147/table-7</object-id>
        <label>Table 7</label>
        <caption>
          <title>Summary of recommendations for RapidHRV argument inputs across recording modalities.</title>
        </caption>
        <alternatives>
          <graphic xlink:href="peerj-10-13147-g017" position="float"/>
          <table frame="hsides" rules="groups" content-type="text">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Modality</th>
                <th rowspan="1" colspan="1">Relative noise</th>
                <th rowspan="1" colspan="1">Min. Amplitude threshold</th>
                <th rowspan="1" colspan="1">Outlier rejection</th>
                <th rowspan="1" colspan="1">Other</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">ECG</td>
                <td rowspan="1" colspan="1">Cleaner</td>
                <td rowspan="1" colspan="1">–</td>
                <td rowspan="1" colspan="1">‘liberal’</td>
                <td rowspan="1" colspan="1">ecg_prt_clustering = True</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Finger IR PPG (still)</td>
                <td rowspan="1" colspan="1">Moderate</td>
                <td rowspan="1" colspan="1">50 (default)</td>
                <td rowspan="1" colspan="1">‘moderate’ (default)</td>
                <td rowspan="1" colspan="1">–</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Wrist PPG</td>
                <td rowspan="1" colspan="1">Noisier</td>
                <td rowspan="1" colspan="1">30</td>
                <td rowspan="1" colspan="1">‘conservative’</td>
                <td rowspan="1" colspan="1">window_overlap = 9<xref rid="table-7fn1" ref-type="table-fn">*</xref></td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="table-7fn">
            <p>
              <bold>Note:</bold>
            </p>
          </fn>
          <fn id="table-7fn1" fn-type="other">
            <label>*</label>
            <p>Overlapping windows guarantees non-independence between data points. This should be taken into consideration during statistical testing.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusion</title>
    <p>In the present paper, we have outlined RapidHRV: an open-source Python pipeline for the estimation of heart rate and heart rate variability. Across simulated datasets, RapidHRV showed good-to-excellent recovery of heart rate and heart rate variability at relatively high levels of noise. Estimates in electrocardiography and finger IR PPG demonstrated RapidHRV was able to recapitulate known effects of age and anxiety, and showed excellent agreement with visually-inspected analyses and commercial software. Lastly, performance in wrist photoplethysmography data was good-to-excellent when participants were engaged in low motion activities, but we noted poor-to-moderate estimations when motion was high. Given the increased interest in the use of wearable measures of heart rate metrics and how they relate to other domains such as mental health, we hope that this toolbox will be of wide use to the community, and that the simulation and benchmarking tests provided may help inform the design and analysis of such studies.</p>
  </sec>
</body>
<back>
  <ack>
    <p>Thank you to Kaarina Aho for statistical consultation; Nicolas Legrand for allowing us to use <italic toggle="yes">Systole</italic>’s code for deriving high frequency power; and Russell Kirk for helping derive motion estimates from smartwatch data. Appreciation goes to other open-source analysis software, namely <italic toggle="yes">Systole</italic> (<xref rid="ref-19" ref-type="bibr">Legrand &amp; Allen, 2020</xref>) and <italic toggle="yes">HeartPy</italic> (<xref rid="ref-43" ref-type="bibr">van Gent et al., 2019</xref>), which helped inspire the development of RapidHRV.</p>
  </ack>
  <sec sec-type="additional-information">
    <title>Additional Information and Declarations</title>
    <fn-group content-type="competing-interests">
      <title>Competing Interests</title>
      <fn fn-type="COI-statement" id="conflict-1">
        <p>Oliver J. Robinson’s MRC senior fellowship is partially in collaboration with Cambridge Cognition (who plan to provide in-kind contribution) and he is running an investigator-initiated trial with medication donated by Lundbeck (escitalopram and placebo, no financial contribution). He also holds an MRC-Proximity to discovery award with Roche (who provide in-kind contributions and have sponsored travel for ACP) regarding work on heart rate variability and anxiety. He has also completed consultancy work on affective bias modification for Peak and online CBT for IESO digital health. Oliver J. Robinson sits on the committee of the British Association of Psychopharmacology.</p>
      </fn>
    </fn-group>
    <fn-group content-type="author-contributions">
      <title>Author Contributions</title>
      <fn fn-type="con" id="contribution-1">
        <p><xref rid="author-1" ref-type="contrib">Peter A. Kirk</xref> conceived and designed the experiments, performed the experiments, analyzed the data, prepared figures and/or tables, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
      <fn fn-type="con" id="contribution-2">
        <p><xref rid="author-2" ref-type="contrib">Alexander Davidson Bryan</xref> analyzed the data, prepared figures and/or tables, authored or reviewed drafts of the paper, revised toolbox code, and approved the final draft.</p>
      </fn>
      <fn fn-type="con" id="contribution-3">
        <p><xref rid="author-3" ref-type="contrib">Sarah N. Garfinkel</xref> conceived and designed the experiments, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
      <fn fn-type="con" id="contribution-4">
        <p><xref rid="author-4" ref-type="contrib">Oliver J. Robinson</xref> conceived and designed the experiments, authored or reviewed drafts of the paper, and approved the final draft.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Human Ethics</title>
      <fn id="addinfo-1">
        <p>The following information was supplied relating to ethical approvals (<italic toggle="yes">i.e</italic>., approving body and any reference numbers):</p>
        <p>N/a: reanalysis of publicly available data.</p>
      </fn>
    </fn-group>
    <fn-group content-type="other">
      <title>Data Availability</title>
      <fn id="addinfo-2">
        <p>The following information was supplied regarding data availability:</p>
        <p>RapidHRV can be downloaded from PyPi (<uri xlink:href="https://pypi.org/project/rapidhrv/">https://pypi.org/project/rapidhrv/</uri>) or GitHub (<uri xlink:href="https://github.com/peterakirk/rapidhrv">https://github.com/peterakirk/rapidhrv</uri>).</p>
        <p>Information on the data and code are available at OSF: <uri xlink:href="https://osf.io/7zvn9/">https://osf.io/7zvn9/</uri>.</p>
      </fn>
    </fn-group>
  </sec>
  <ref-list content-type="authoryear">
    <title>References</title>
    <ref id="ref-1">
      <label>Allen et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Allen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Poggiali</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Whitaker</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Kievit</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Raincloud plots: a multi-platform tool for robust data visualization</article-title>
        <source>Wellcome Open Research</source>
        <year iso-8601-date="2019">2019</year>
        <volume>4</volume>
        <fpage>63</fpage>
        <pub-id pub-id-type="doi">10.12688/wellcomeopenres.15191.1</pub-id>
        <pub-id pub-id-type="pmid">31069261</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-42">
      <label>Baek et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baek</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Woo</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>Reliability of ultra-short-term analysis as a surrogate of standard 5-min analysis of heart rate variability</article-title>
        <source>Telemedicine Journal and e-health</source>
        <year iso-8601-date="2015">2015</year>
        <volume>21</volume>
        <issue>5</issue>
        <fpage>404</fpage>
        <lpage>414</lpage>
        <pub-id pub-id-type="doi">10.1089/tmj.2014.0104</pub-id>
        <pub-id pub-id-type="pmid">25807067</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-3">
      <label>Boccignone et al. (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boccignone</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Conte</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Cuculo</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>D’Amelio</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grossi</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Lanzarotti</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>An open framework for remote-PPG methods and their assessment</article-title>
        <source>IEEE Access</source>
        <year iso-8601-date="2020">2020</year>
        <volume>8</volume>
        <fpage>216083</fpage>
        <lpage>216103</lpage>
        <pub-id pub-id-type="doi">10.1109/ACCESS.2020.3040936</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-4">
      <label>Caizzone, Boukhayma &amp; Enz (2017)</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Caizzone</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Boukhayma</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Enz</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive noise analysis in PPG read-out chains</article-title>
        <year iso-8601-date="2017">2017</year>
        <conf-name>International Conference on Noise and Fluctuations (ICNF)</conf-name>
        <fpage>1</fpage>
        <lpage>4</lpage>
      </element-citation>
    </ref>
    <ref id="ref-5">
      <label>Champely et al. (2017)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Champely</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ekstrom</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Dalgaard</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gill</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weibelzahl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Anandkumar</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ford</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Volcic</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rosario</surname>
            <given-names>HD</given-names>
          </name>
        </person-group>
        <article-title>pwr: basic functions for power analysis</article-title>
        <year iso-8601-date="2017">2017</year>
        <uri xlink:href="https://nyuscholars.nyu.edu/en/publications/pwr-basic-functions-for-power-analysis">https://nyuscholars.nyu.edu/en/publications/pwr-basic-functions-for-power-analysis</uri>
      </element-citation>
    </ref>
    <ref id="ref-6">
      <label>Choi &amp; Shin (2017)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Choi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shin</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Photoplethysmography sampling frequency: pilot assessment of how low can we go to analyze pulse rate variability with reliability?</article-title>
        <source>Physiological Measurement</source>
        <year iso-8601-date="2017">2017</year>
        <volume>38</volume>
        <issue>3</issue>
        <fpage>586</fpage>
        <lpage>600</lpage>
        <pub-id pub-id-type="doi">10.1088/1361-6579/aa5efa</pub-id>
        <pub-id pub-id-type="pmid">28169836</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-7">
      <label>de Groot, Kirk &amp; Gottfried (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Groot</surname>
            <given-names>JHB</given-names>
          </name>
          <name>
            <surname>Kirk</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Gottfried</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Encoding fear intensity in human sweat</article-title>
        <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source>
        <year iso-8601-date="2020">2020</year>
        <volume>375</volume>
        <issue>1800</issue>
        <fpage>20190271</fpage>
        <pub-id pub-id-type="doi">10.1098/rstb.2019.0271</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-8">
      <label>Eager, Pendrill &amp; Reistad (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eager</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Pendrill</surname>
            <given-names>A-M</given-names>
          </name>
          <name>
            <surname>Reistad</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Beyond velocity and acceleration: jerk, snap and higher derivatives</article-title>
        <source>European Journal of Physics</source>
        <year iso-8601-date="2016">2016</year>
        <volume>37</volume>
        <issue>6</issue>
        <fpage>065008</fpage>
        <pub-id pub-id-type="doi">10.1088/0143-0807/37/6/065008</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-9">
      <label>Georgiou et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Georgiou</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Larentzakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Khamis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Alsuhaibani</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Alaska</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Giallafos</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Can wearable devices accurately measure heart rate variability? A systematic review</article-title>
        <source>Folia Medica</source>
        <year iso-8601-date="2018">2018</year>
        <volume>60</volume>
        <issue>1</issue>
        <fpage>425</fpage>
        <pub-id pub-id-type="doi">10.2478/folmed-2018-0012</pub-id>
        <pub-id pub-id-type="pmid">30355846</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-10">
      <label>Gold, Morey &amp; McCarthy (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gold</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Morey</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Amygdala-prefrontal cortex functional connectivity during threat-induced anxiety and goal distraction</article-title>
        <source>Biological Psychiatry</source>
        <year iso-8601-date="2015">2015</year>
        <volume>77</volume>
        <issue>4</issue>
        <fpage>394</fpage>
        <lpage>403</lpage>
        <pub-id pub-id-type="doi">10.1016/j.biopsych.2014.03.030</pub-id>
        <pub-id pub-id-type="pmid">24882566</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-11">
      <label>Goldberger et al. (2000)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goldberger</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Amaral</surname>
            <given-names>LAN</given-names>
          </name>
          <name>
            <surname>Glass</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hausdorff</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Ivanov</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Mark</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Mietus</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Moody</surname>
            <given-names>GB</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>C-K</given-names>
          </name>
          <name>
            <surname>Stanley</surname>
            <given-names>HE</given-names>
          </name>
        </person-group>
        <article-title>PhysioBank, physioToolkit, and physioNet</article-title>
        <source>Circulation</source>
        <year iso-8601-date="2000">2000</year>
        <volume>101</volume>
        <issue>23</issue>
        <fpage>e215</fpage>
        <lpage>e220</lpage>
        <pub-id pub-id-type="doi">10.1161/01.CIR.101.23.e215</pub-id>
        <pub-id pub-id-type="pmid">10851218</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-12">
      <label>Gomes, Margaritoff &amp; da Silva (2019)</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Gomes</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Margaritoff</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>da Silva</surname>
            <given-names>HP</given-names>
          </name>
        </person-group>
        <article-title>pyHRV: development and evaluation of an open-source python toolbox for heart rate variability (HRV)</article-title>
        <year iso-8601-date="2019">2019</year>
        <conf-name>Proceedings of the Int’l Conference on Electrical, Electronic and Computing Engineering (IcETRAN)</conf-name>
        <fpage>822</fpage>
        <lpage>828</lpage>
      </element-citation>
    </ref>
    <ref id="ref-13">
      <label>Hillebrand et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hillebrand</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gast</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>de Mutsert</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Swenne</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Jukema</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Middeldorp</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rosendaal</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Dekkers</surname>
            <given-names>OM</given-names>
          </name>
        </person-group>
        <article-title>Heart rate variability and first cardiovascular event in populations without known cardiovascular disease: meta-analysis and dose-response meta-regression</article-title>
        <source>EP Europace</source>
        <year iso-8601-date="2013">2013</year>
        <volume>15</volume>
        <issue>5</issue>
        <fpage>742</fpage>
        <lpage>749</lpage>
        <pub-id pub-id-type="doi">10.1093/europace/eus341</pub-id>
        <pub-id pub-id-type="pmid">23370966</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-14">
      <label>Hunter (2007)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hunter</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Matplotlib: a 2D gaphics environment</article-title>
        <source>Computing in Science Engineering</source>
        <year iso-8601-date="2007">2007</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>90</fpage>
        <lpage>95</lpage>
        <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-15">
      <label>Iyengar et al. (1996)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Iyengar</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Morin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Goldberger</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Lipsitz</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Age-related alterations in the fractal scaling of cardiac interbeat interval dynamics</article-title>
        <source>American Journal of Physiology-Regulatory, Integrative and Comparative Physiology</source>
        <year iso-8601-date="1996">1996</year>
        <volume>271</volume>
        <issue>4</issue>
        <fpage>R1078</fpage>
        <lpage>R1084</lpage>
        <pub-id pub-id-type="doi">10.1152/ajpregu.1996.271.4.R1078</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-16">
      <label>Jandackova et al. (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jandackova</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Britton</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Malik</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Steptoe</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Heart rate variability and depressive symptoms: a cross-lagged analysis over a 10-year period in the Whitehall II study</article-title>
        <source>Psychological Medicine</source>
        <year iso-8601-date="2016">2016</year>
        <volume>46</volume>
        <issue>10</issue>
        <fpage>2121</fpage>
        <lpage>2131</lpage>
        <pub-id pub-id-type="doi">10.1017/S003329171600060X</pub-id>
        <pub-id pub-id-type="pmid">27181276</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-17">
      <label>Koo &amp; Li (2016)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koo</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>MY</given-names>
          </name>
        </person-group>
        <article-title>A guideline of selecting and reporting intraclass correlation coefficients for reliability research</article-title>
        <source>Journal of Chiropractic Medicine</source>
        <year iso-8601-date="2016">2016</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>155</fpage>
        <lpage>163</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jcm.2016.02.012</pub-id>
        <pub-id pub-id-type="pmid">27330520</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-19">
      <label>Legrand &amp; Allen (2020)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Legrand</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Systole: a python toolbox for preprocessing, analyzing, and synchronizing cardiac data</article-title>
        <year iso-8601-date="2020">2020</year>
        <uri xlink:href="https://github.com/embodied-computation-group/systole">https://github.com/embodied-computation-group/systole</uri>
      </element-citation>
    </ref>
    <ref id="ref-20">
      <label>Leys et al. (2013)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leys</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Bernard</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Licata</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Detecting outliers: do not use standard deviation around the mean, use absolute deviation around the median</article-title>
        <source>Journal of Experimental Social Psychology</source>
        <year iso-8601-date="2013">2013</year>
        <volume>49</volume>
        <issue>4</issue>
        <fpage>764</fpage>
        <lpage>766</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jesp.2013.03.013</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-22">
      <label>Makovac et al. (2016a)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Makovac</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Meeten</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Watson</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Garfinkel</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Critchley</surname>
            <given-names>HD</given-names>
          </name>
          <name>
            <surname>Ottaviani</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Neurostructural abnormalities associated with axes of emotion dysregulation in generalized anxiety</article-title>
        <source>NeuroImage: Clinical</source>
        <year iso-8601-date="2016">2016a</year>
        <volume>10</volume>
        <fpage>172</fpage>
        <lpage>181</lpage>
        <pub-id pub-id-type="doi">10.1016/j.nicl.2015.11.022</pub-id>
        <pub-id pub-id-type="pmid">26759791</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-23">
      <label>Makovac et al. (2016b)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Makovac</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Watson</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Meeten</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Garfinkel</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Cercignani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Critchley</surname>
            <given-names>HD</given-names>
          </name>
          <name>
            <surname>Ottaviani</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Amygdala functional connectivity as a longitudinal biomarker of symptom changes in generalized anxiety</article-title>
        <source>Social Cognitive and Affective Neuroscience</source>
        <year iso-8601-date="2016">2016b</year>
        <volume>11</volume>
        <issue>11</issue>
        <fpage>1719</fpage>
        <lpage>1728</lpage>
        <pub-id pub-id-type="doi">10.1093/scan/nsw091</pub-id>
        <pub-id pub-id-type="pmid">27369066</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-24">
      <label>McKinney (2012)</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>McKinney</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <source>Pandas: a foundational python library for data analysis and statistics</source>
        <year iso-8601-date="2012">2012</year>
        <publisher-loc>San Francisco</publisher-loc>
        <publisher-name>O’Reilly Media, Inc</publisher-name>
      </element-citation>
    </ref>
    <ref id="ref-25">
      <label>Mulcahy et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mulcahy</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Larsson</surname>
            <given-names>DEO</given-names>
          </name>
          <name>
            <surname>Garfinkel</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Critchley</surname>
            <given-names>HD</given-names>
          </name>
        </person-group>
        <article-title>Heart rate variability as a biomarker in health and affective disorders: a perspective on neuroimaging studies</article-title>
        <source>NeuroImage</source>
        <year iso-8601-date="2019">2019</year>
        <volume>202</volume>
        <issue>5</issue>
        <fpage>116072</fpage>
        <pub-id pub-id-type="doi">10.1016/j.neuroimage.2019.116072</pub-id>
        <pub-id pub-id-type="pmid">31386920</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-26">
      <label>Munoz et al. (2015)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Munoz</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>van Roon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Riese</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Thio</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Oostenbroek</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Westrik</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>de Geus</surname>
            <given-names>EJC</given-names>
          </name>
          <name>
            <surname>Gansevoort</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lefrandt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nolte</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Snieder</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Validity of (ultra-)short recordings for heart rate variability measurements</article-title>
        <source>PLOS ONE</source>
        <year iso-8601-date="2015">2015</year>
        <volume>10</volume>
        <issue>9</issue>
        <elocation-id>e0138921</elocation-id>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0138921</pub-id>
        <pub-id pub-id-type="pmid">26414314</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-27">
      <label>Nunan, Sandercock &amp; Brodie (2010)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nunan</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sandercock</surname>
            <given-names>GRH</given-names>
          </name>
          <name>
            <surname>Brodie</surname>
            <given-names>DA</given-names>
          </name>
        </person-group>
        <article-title>A quantitative systematic review of normal values for short-term heart rate variability in healthy adults</article-title>
        <source>Pacing and Clinical Electrophysiology</source>
        <year iso-8601-date="2010">2010</year>
        <volume>33</volume>
        <issue>11</issue>
        <fpage>1407</fpage>
        <lpage>1417</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1540-8159.2010.02841.x</pub-id>
        <pub-id pub-id-type="pmid">20663071</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-28">
      <label>Pedregosa et al. (2011)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Varoquaux</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gramfort</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Michel</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Thirion</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Grisel</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Blondel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Prettenhofer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dubourg</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vanderplas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Passos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cournapeau</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Brucher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Perrot</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Duchesnay</surname>
            <given-names>É</given-names>
          </name>
        </person-group>
        <article-title>Scikit-learn: machine learning in python</article-title>
        <source>Journal of Machine Learning Research</source>
        <year iso-8601-date="2011">2011</year>
        <volume>12</volume>
        <issue>85</issue>
        <fpage>2825</fpage>
        <lpage>2830</lpage>
      </element-citation>
    </ref>
    <ref id="ref-29">
      <label>Pham et al. (2021)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pham</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lau</surname>
            <given-names>ZJ</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>SHA</given-names>
          </name>
          <name>
            <surname>Makowski</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Heart rate variability in psychology: a review of HRV indices and an analysis tutorial</article-title>
        <source>Sensors</source>
        <year iso-8601-date="2021">2021</year>
        <volume>21</volume>
        <issue>12</issue>
        <fpage>3998</fpage>
        <pub-id pub-id-type="doi">10.3390/s21123998</pub-id>
        <pub-id pub-id-type="pmid">34207927</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-30">
      <label>Pierpont &amp; Voth (2004)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pierpont</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Voth</surname>
            <given-names>EJ</given-names>
          </name>
        </person-group>
        <article-title>Assessing autonomic function by analysis of heart rate recovery from exercise in healthy subjects</article-title>
        <source>The American Journal of Cardiology</source>
        <year iso-8601-date="2004">2004</year>
        <volume>94</volume>
        <issue>1</issue>
        <fpage>64</fpage>
        <lpage>68</lpage>
        <pub-id pub-id-type="doi">10.1016/j.amjcard.2004.03.032</pub-id>
        <pub-id pub-id-type="pmid">15219511</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-32">
      <label>R Core Team (2013)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <collab>
            <institution>R Core Team</institution>
          </collab>
        </person-group>
        <article-title>R: a language and environment for statistical computing</article-title>
        <year iso-8601-date="2013">2013</year>
        <comment>R Foundation for Statistical Computing, Vienna, Austria</comment>
        <uri xlink:href="http://www.R-project.org/">http://www.R-project.org/</uri>
      </element-citation>
    </ref>
    <ref id="ref-33">
      <label>Rae et al. (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rae</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Ahmad</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Larsson</surname>
            <given-names>DEO</given-names>
          </name>
          <name>
            <surname>Silva</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Praag</surname>
            <given-names>CDGvan</given-names>
          </name>
          <name>
            <surname>Garfinkel</surname>
            <given-names>SN</given-names>
          </name>
          <name>
            <surname>Critchley</surname>
            <given-names>HD</given-names>
          </name>
        </person-group>
        <article-title>Impact of cardiac interoception cues and confidence on voluntary decisions to make or withhold action in an intentional inhibition task</article-title>
        <source>Scientific Reports</source>
        <year iso-8601-date="2020">2020</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>4184</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-020-60405-8</pub-id>
        <pub-id pub-id-type="pmid">32144304</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-34">
      <label>Reback et al. (2022)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Reback</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jbrockmendel</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Van Den Bossche</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Augspurger</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cloud</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hawkins</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Roeschke</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gfyoung</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sinhrks</surname>
            <given-names>Klein</given-names>
          </name>
          <name>
            <surname>Hoefler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Terji Petersen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Tratner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>She</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ayd</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Naveh</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Darbyshire</surname>
            <given-names>JHM</given-names>
          </name>
          <name>
            <surname>Garcia</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shadrach</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schendel</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hayden</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saxton</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gorelli</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zeitlin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jancauskas</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>McMaster</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Battiston</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Seabold</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Pandas-dev/pandas: Pandas 1.4.1 (v1.4.1)</article-title>
        <year iso-8601-date="2022">2022</year>
        <comment>Zenodo</comment>
        <uri xlink:href="https://doi.org/10.5281/ZENODO.3509134">https://doi.org/10.5281/ZENODO.3509134</uri>
      </element-citation>
    </ref>
    <ref id="ref-35">
      <label>Reiss et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reiss</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Indlekofer</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Schmidt</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Van Laerhoven</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Deep PPG: large-scale heart rate estimation with convolutional neural networks</article-title>
        <source>Sensors</source>
        <year iso-8601-date="2019">2019</year>
        <volume>19</volume>
        <issue>14</issue>
        <fpage>3079</fpage>
        <pub-id pub-id-type="doi">10.3390/s19143079</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-36">
      <label>Sandvik et al. (1995)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sandvik</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Erikssen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ellestad</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Erikssen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Thaulow</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mundal</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Rodahl</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Heart rate increase and maximal heart rate during exercise as predictors of cardiovascular mortality: a 16-year follow-up study of 1960 healthy men</article-title>
        <source>Coronary Artery Disease</source>
        <year iso-8601-date="1995">1995</year>
        <volume>6</volume>
        <issue>8</issue>
        <fpage>667</fpage>
        <lpage>679</lpage>
        <pub-id pub-id-type="doi">10.1097/00019501-199508000-00012</pub-id>
        <pub-id pub-id-type="pmid">8574463</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-37">
      <label>Savonen et al. (2006)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Savonen</surname>
            <given-names>KP</given-names>
          </name>
          <name>
            <surname>Lakka</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Laukkanen</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Halonen</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Rauramaa</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Salonen</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Rauramaa</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Heart rate response during exercise test and cardiovascular mortality in middle-aged men</article-title>
        <source>European Heart Journal</source>
        <year iso-8601-date="2006">2006</year>
        <volume>27</volume>
        <issue>5</issue>
        <fpage>582</fpage>
        <lpage>588</lpage>
        <pub-id pub-id-type="doi">10.1093/eurheartj/ehi708</pub-id>
        <pub-id pub-id-type="pmid">16399774</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-38">
      <label>Tang et al. (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Alian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Menon</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Elgendi</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>PPGSynth: an innovative toolbox for synthesizing regular and irregular photoplethysmography waveforms</article-title>
        <source>Frontiers in Medicine</source>
        <year iso-8601-date="2020">2020</year>
        <volume>7</volume>
        <fpage>R1</fpage>
        <pub-id pub-id-type="doi">10.3389/fmed.2020.597774</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-39">
      <label>van den Berg et al. (2018)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van den Berg</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Rijnbeek</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Niemeijer</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Hofman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>van Herpen</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bots</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Hillege</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Swenne</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Eijgelsheim</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stricker</surname>
            <given-names>BH</given-names>
          </name>
          <name>
            <surname>Kors</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>Normal values of corrected heart-rate variability in 10-second electrocardiograms for all ages</article-title>
        <source>Frontiers in Physiology</source>
        <year iso-8601-date="2018">2018</year>
        <volume>9</volume>
        <fpage>414</fpage>
        <pub-id pub-id-type="doi">10.3389/fphys.2018.00424</pub-id>
        <pub-id pub-id-type="pmid">29725307</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-43">
      <label>van Gent et al. (2019)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Gent</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Farah</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>van Nes</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>van Arem</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>HeartPy: A novel heart rate algorithm for the analysis of noisy signals</article-title>
        <source>Transportation Research Part F: Traffic Psychology and Behaviour</source>
        <year iso-8601-date="2019">2019</year>
        <volume>66</volume>
        <fpage>368</fpage>
        <lpage>378</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trf.2019.09.015</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-40">
      <label>Virtanen et al. (2020)</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Virtanen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gommers</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Oliphant</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Haberland</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Cournapeau</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Burovski</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Weckesser</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Bright</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>van der Walt</surname>
            <given-names>Séfan J</given-names>
          </name>
          <name>
            <surname>Brett</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Millman</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Mayorov</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nelson</surname>
            <given-names>ARJ</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kern</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>CJ</given-names>
          </name>
          <name>
            <surname>Polat</surname>
            <given-names>İ</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>VanderPlas</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Laxalde</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Perktold</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cimrman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Henriksen</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Quintero</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Archibald</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Ribeiro</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Pedregosa</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>van Mulbregt</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bardelli</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Rothberg</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Hilboll</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kloeckner</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Scopatz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rokem</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Woods</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Fulton</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Masson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Häggström</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fitzgerald</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nicholson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Hagen</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Pasechnik</surname>
            <given-names>DV</given-names>
          </name>
          <name>
            <surname>Olivetti</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Wieser</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Silva</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Lenders</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wilhelm</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Price</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Ingold</surname>
            <given-names>G-L</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>GR</given-names>
          </name>
          <name>
            <surname>Audren</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Probst</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Dietrich</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Silterra</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Webber</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Slavič</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nothman</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Buchner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kulick</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schönberger</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>de Miranda Cardoso</surname>
            <given-names>JV</given-names>
          </name>
          <name>
            <surname>Reimer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Harrington</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rodríguez</surname>
            <given-names>JLC</given-names>
          </name>
          <name>
            <surname>Nunez-Iglesias</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kuczynski</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tritz</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Thoma</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Newville</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kümmerer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bolingbroke</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tartre</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pak</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Nowaczyk</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Shebanov</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Pavlyk</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Brodtkorb</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>McGibbon</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Feldbauer</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Tygier</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sievert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Vigna</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Peterson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>More</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Pudlik</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Oshima</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Pingel</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Robitaille</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Spura</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Cera</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Leslie</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zito</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Krauss</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Upadhyay</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Halchenko</surname>
            <given-names>YO</given-names>
          </name>
          <name>
            <surname>Vázquez-Baeza</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>
        <source>Nature Methods</source>
        <year iso-8601-date="2020">2020</year>
        <volume>17</volume>
        <issue>3</issue>
        <fpage>261</fpage>
        <lpage>272</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>
        <pub-id pub-id-type="pmid">32015543</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-41">
      <label>Wickham (2016)</label>
      <element-citation publication-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Wickham</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>ggplot2: elegant graphics for data analysis</article-title>
        <year iso-8601-date="2016">2016</year>
        <comment>Springer-Verlag New York</comment>
        <uri xlink:href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</uri>
      </element-citation>
    </ref>
  </ref-list>
</back>
