<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8058767</article-id>
    <article-id pub-id-type="pmid">32805010</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa722</article-id>
    <article-id pub-id-type="publisher-id">btaa722</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Inferring cancer progression from Single-Cell Sequencing while allowing mutation losses</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6469-4887</contrib-id>
        <name>
          <surname>Ciccolella</surname>
          <given-names>Simone</given-names>
        </name>
        <aff><institution>Department of Informatics, Systems and Communication, University of Milano-Bicocca</institution>, Milan, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ricketts</surname>
          <given-names>Camir</given-names>
        </name>
        <aff><institution>Department of Physiology and Biophysics, Tri-I Computational Biology &amp; Medicine Graduate Program, Weill Cornell Medicine of Cornell University</institution>, New York, NY 10021, <country country="US">USA</country></aff>
        <aff><institution>Institute for Computational Biomedicine, Englander Institute for Precision Medicine, The Meyer Cancer Center, Department of Physiology and Biophysics, Weill Cornell Medicine of Cornell University</institution>, New York City, NY 10021, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Soto Gomez</surname>
          <given-names>Mauricio</given-names>
        </name>
        <aff><institution>Department of Informatics, Systems and Communication, University of Milano-Bicocca</institution>, Milan, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Patterson</surname>
          <given-names>Murray</given-names>
        </name>
        <aff><institution>Department of Informatics, Systems and Communication, University of Milano-Bicocca</institution>, Milan, <country country="IT">Italy</country></aff>
        <aff><institution>Department of Computer Science, College of Arts and Sciences, Georgia State University</institution>, Atlanta, GA 30303, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Silverbush</surname>
          <given-names>Dana</given-names>
        </name>
        <aff><institution>Department of Pathology and Center for Cancer Research, Massachusetts General Hospital and Harvard Medical School</institution>, Boston, MA 02114, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bonizzoni</surname>
          <given-names>Paola</given-names>
        </name>
        <aff><institution>Department of Informatics, Systems and Communication, University of Milano-Bicocca</institution>, Milan, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Hajirasouliha</surname>
          <given-names>Iman</given-names>
        </name>
        <xref rid="btaa722-cor1" ref-type="corresp"/>
        <aff><institution>Institute for Computational Biomedicine, Englander Institute for Precision Medicine, The Meyer Cancer Center, Department of Physiology and Biophysics, Weill Cornell Medicine of Cornell University</institution>, New York City, NY 10021, <country country="US">USA</country></aff>
        <!--imh2003@med.cornell.edu-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5584-3089</contrib-id>
        <name>
          <surname>Della Vedova</surname>
          <given-names>Gianluca</given-names>
        </name>
        <aff><institution>Department of Informatics, Systems and Communication, University of Milano-Bicocca</institution>, Milan, <country country="IT">Italy</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Luigi Martelli</surname>
          <given-names>Pier</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa722-cor1">To whom correspondence should be addressed. <email>imh2003@med.cornell.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-08-17">
      <day>17</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>8</month>
      <year>2020</year>
    </pub-date>
    <volume>37</volume>
    <issue>3</issue>
    <fpage>326</fpage>
    <lpage>333</lpage>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>06</day>
        <month>8</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>07</day>
        <month>8</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>8</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa722.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>In recent years, the well-known Infinite Sites Assumption has been a fundamental feature of computational methods devised for reconstructing tumor phylogenies and inferring cancer progressions. However, recent studies leveraging single-cell sequencing (SCS) techniques have shown evidence of the widespread recurrence and, especially, loss of mutations in several tumor samples. While there exist established computational methods that infer phylogenies with mutation losses, there remain some advancements to be made.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present Simulated Annealing Single-Cell inference (SASC): a new and robust approach based on simulated annealing for the inference of cancer progression from SCS datasets. In particular, we introduce an extension of the model of evolution where mutations are only accumulated, by allowing also a limited amount of mutation loss in the evolutionary history of the tumor: the Dollo-<italic toggle="yes">k</italic> model. We demonstrate that SASC achieves high levels of accuracy when tested on both simulated and real datasets and in comparison with some other available methods.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The SASC tool is open source and available at <ext-link xlink:href="https://github.com/sciccolella/sasc" ext-link-type="uri">https://github.com/sciccolella/sasc</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>European Union’s Horizon 2020 research and innovation programme</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Marie Skłodowska-Curie</institution>
          </institution-wrap>
        </funding-source>
        <award-id>872539</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>1T32GM083937</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>US National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>IIS-1840275</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Recent developments in targeted therapies for cancer treatment rely on the accurate inference of the clonal evolution and progression of the disease. As discussed in several recent studies (<xref rid="btaa722-B25" ref-type="bibr">Morrissy <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa722-B37" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2016</xref>), understanding the order of accumulation and the prevalence of somatic mutations during cancer progression can help better devise these treatment strategies.</p>
    <p>Most of the available techniques for inferring cancer progression rely on data from next-generation bulk sequencing experiments, where only a proportion of observable mutations from a large amount of cells is obtained, without the distinction of the cells that carry them. In recent years, many computational approaches have been developed for the analysis of bulk sequencing data with the purpose of inferring tumoral subclonal decomposition and reconstructing tumor phylogenies (evolutionary trees) (<xref rid="btaa722-B3" ref-type="bibr">Bonizzoni <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa722-B8" ref-type="bibr">El-Kebir <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa722-B13" ref-type="bibr">Hajirasouliha <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btaa722-B16" ref-type="bibr">Jiao <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btaa722-B21" ref-type="bibr">Malikic <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btaa722-B24" ref-type="bibr">Marass <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa722-B26" ref-type="bibr">Popic <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btaa722-B32" ref-type="bibr">Satas and Raphael, 2017</xref>; <xref rid="btaa722-B34" ref-type="bibr">Strino <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btaa722-B36" ref-type="bibr">Toosi <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa722-B39" ref-type="bibr">Yuan <italic toggle="yes">et al.</italic>, 2015</xref>). The main drawback of this technique is that a bulk sequencing sample contains a mixture of both healthy and cancerous cells—and this clonal evolution can only be estimated by the proportions of observable mutations.</p>
    <p>Single-cell sequencing (SCS) technologies promise to deliver the best resolution for understanding the underlying causes of cancer progression. However, it is still difficult and expensive to perform SCS experiments with a high degree of confidence or robustness. The techniques currently available are producing datasets, which contain a sizeable amount of noise in the form of false negatives from allelic dropout, and missing values due to low coverage. Another issue that these technologies suffer from is the presence of doublet cell captures. However, such issues are slowly fading away and the state-of-the-art in preprocessing steps for removing such artifacts is quite advanced (<xref rid="btaa722-B6" ref-type="bibr">DePasquale <italic toggle="yes">et al.</italic>, 2019</xref>). Hence, we believe that more immediate issues, such as the lack of accuracy reflected in the high dropout and false-negative rates inherent to the technology, call for methods that are able to infer cancer progression from this data produced by current SCS techniques.</p>
    <p>Various methods have been recently developed for this purpose (<xref rid="btaa722-B15" ref-type="bibr">Jahn <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa722-B29" ref-type="bibr">Ross and Markowetz, 2016</xref>; <xref rid="btaa722-B41" ref-type="bibr">Zafar <italic toggle="yes">et al.</italic>, 2017</xref>, <xref rid="btaa722-B42" ref-type="bibr">2019</xref>), some of them introducing a hybrid approach of combining both SCS and VAF (bulk sequencing) data (<xref rid="btaa722-B22" ref-type="bibr">Malikic <italic toggle="yes">et al.</italic>, 2019a</xref>; <xref rid="btaa722-B27" ref-type="bibr">Ramazzotti <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa722-B31" ref-type="bibr">Salehi <italic toggle="yes">et al.</italic>, 2017</xref>). Most of these methods, however, rely on the Infinite Sites Assumption (ISA), which essentially states that each mutation is acquired at most once in the phylogeny and is never lost. One reason being that such a simplifying assumption leads to a computationally tractable model of evolution, namely, the problem of finding a perfect phylogeny (<xref rid="btaa722-B12" ref-type="bibr">Gusfield, 1991</xref>). This model is safe to use in settings, such as the evolution of natural populations, and tends to be the norm more than the exception in this setting (<xref rid="btaa722-B18" ref-type="bibr">Kimura, 1969</xref>). Cancer progression, however, is a fairly extreme situation, where the evolution is very fast, under attack from the immune system, and with a high mutation rate. As a result, studies of SCS data are beginning to reveal phenomena that cannot always be explained with a perfect phylogeny (<xref rid="btaa722-B4" ref-type="bibr">Brown <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btaa722-B20" ref-type="bibr">Kuipers <italic toggle="yes">et al.</italic>, 2017</xref>). Some articles (<xref rid="btaa722-B20" ref-type="bibr">Kuipers <italic toggle="yes">et al.</italic>, 2017</xref>) reveal widespread recurrence and loss of mutations, while large deletions on several branches of a tree can span a shared locus (<xref rid="btaa722-B4" ref-type="bibr">Brown <italic toggle="yes">et al.</italic>, 2017</xref>), thus, a given mutation may be deleted independently multiple times.</p>
    <p>In this work, we propose a novel and more general model to explain the above phenomena, which is not unnecessarily held back by strict adherence to the ISA. Some recent methods are beginning to appear, which have the same objective in mind, such as TRaIT (<xref rid="btaa722-B27" ref-type="bibr">Ramazzotti <italic toggle="yes">et al.</italic>, 2019</xref>), SiFit (<xref rid="btaa722-B41" ref-type="bibr">Zafar <italic toggle="yes">et al.</italic>, 2017</xref>) and SPhyR (<xref rid="btaa722-B7" ref-type="bibr">El-Kebir, 2018</xref>): in detail, TRaIT accounts for violations of the ISA by accommodating for convergent evolution; SiFit accounts for both mutation recurrence and loss without specifying a particular model of evolution; and, on the other hand, SPhyR (independently from our article) utilizes the same phylogeny model used in this work, thus allowing deletions of mutations.</p>
    <p>In our approach, we use the Dollo model (<xref rid="btaa722-B9" ref-type="bibr">Farris, 1977</xref>; <xref rid="btaa722-B28" ref-type="bibr">Rogozin <italic toggle="yes">et al.</italic>, 2006</xref>), one of the models that is more general than the perfect phylogeny model, to allow the loss of point mutations. In particular, while the Dollo model still constrains that a mutation can only be <italic toggle="yes">acquired</italic> at most once, it allows any number of independent losses of the mutation. Once we depart from an ideal, error-free, perfect phylogeny model (<xref rid="btaa722-B12" ref-type="bibr">Gusfield, 1991</xref>), we lose its convenient computational tractability: in fact allowing errors or missing data results in an NP-hard problem. Adopting the more general Dollo model is only going to exacerbate the problem. However, if we restrict the number of losses of any mutation to 1 or 2 (rather than strictly 0), the resulting solution space is still small enough to explore a sizable portion of it in a reasonable amount of time, in practice. Moreover, from a biological point of view, one would not expect a mutation to be lost more than a few times, since it is not likely that mutations are widely lost (<xref rid="btaa722-B4" ref-type="bibr">Brown <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btaa722-B20" ref-type="bibr">Kuipers <italic toggle="yes">et al.</italic>, 2017</xref>). Furthermore, all the currently available methods assume that the false-negative rate is the same for all mutations. While this is suitable for samples coming from DNA (i.e. scDNA-seq) data, the false-negative rate of the mutations in samples coming from RNA (i.e. scRNA-seq) data can vary a because of differing levels of gene expression. Since our approach is suitable for both types of data, i.e. a suitable parameter setting can be found for modeling the progression of cancer from samples coming from either DNA or RNA data, to accommodate the latter, our approach also allows a different false-negative rate for each mutation: it is one of the first methods with this feature. In fact, to the best of our knowledge, the only other article with a similar feature has appeared very recently (<xref rid="btaa722-B38" ref-type="bibr">Wu, 2019</xref>); in that article, different false negative and false-positive rates are allowed for each mutation and for each cell. At the same time, mutation losses are not allowed. Sci<inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mo>Φ</mml:mo></mml:math></inline-formula> (<xref rid="btaa722-B33" ref-type="bibr">Singer <italic toggle="yes">et al.</italic>, 2018</xref>) also allows different rates, but it is essentially a phylogeny-aware mutation caller, not a tool designed to infer tumor phylogenies.</p>
    <p>Here, we introduce the Simulated Annealing Single-Cell inference (SASC) tool, a maximum likelihood phylogeny search framework that allows deletion of mutations, by incorporating the Dollo parsimony model (<xref rid="btaa722-B9" ref-type="bibr">Farris, 1977</xref>; <xref rid="btaa722-B28" ref-type="bibr">Rogozin <italic toggle="yes">et al.</italic>, 2006</xref>). We show that our approach is competitive with the state-of-the art tools for inferring cancer progression from SCS data, while being the only tool to correctly identify important driver mutations in some real datasets, as verified by the manually curated progression scenarios for these data.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Formulation of the tree reconstruction problem</title>
      <p>As mentioned before, cancer progression reconstruction can be modeled as the construction of a character-based incomplete phylogeny on a set of (cancer) cells, where each character represents a mutation.</p>
      <p>In this framework, we consider the input as an <italic toggle="yes">n</italic> ×<italic toggle="yes"> m</italic> ternary matrix <italic toggle="yes">I<sub>ij</sub></italic>, where an entry <italic toggle="yes">I<sub>ij</sub></italic>=0 indicates that the sequence of cell <italic toggle="yes">i</italic> does not have mutation <italic toggle="yes">j</italic>, <italic toggle="yes">I<sub>ij</sub></italic>=1 indicates the presence of mutation <italic toggle="yes">j</italic> in the sequence of cell <italic toggle="yes">i</italic>, and a <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mo>?</mml:mo></mml:math></inline-formula> indicates that there is not enough information on the presence/absence of mutation <italic toggle="yes">j</italic> in cell <italic toggle="yes">i</italic>. This uncertainty about the presence of a mutation in a cell is a consequence of insufficient coverage in the sequencing, a common scenario in SCS experiments.</p>
      <p>However, the uncertainty of some entries is not the only issue that results from the sequencing process. In fact, entries of the input matrix <italic toggle="yes">I</italic> can also contain false positives and false negatives—while the false-positive rate is usually very low, the false-negative rate can be high and can also vary depending on different factors. In particular, for scRNA-seq data, the varying expression levels of different genes can easily lead to different false-negative rates for each mutation, since a highly expressed gene will have significantly higher coverage than an under-expressed gene, resulting in a more accurate single-nucleotide variant (SNV) call for that particular gene. On the other hand, a gene, which is less expressed is likely to have a lower coverage, leading to a less accurate presence/absence estimation in the cells. We assume that these errors occur independently across all the (known) entries of <italic toggle="yes">I</italic>. Namely, if <italic toggle="yes">E<sub>ij</sub></italic> denotes the final <italic toggle="yes">n</italic> ×<italic toggle="yes"> m</italic> output matrix, i.e. the binary matrix without errors and noise estimated by the algorithm, then α<sub><italic toggle="yes">j</italic></sub> denotes the false-negative rate of mutation <italic toggle="yes">j</italic>, and β denotes the false-positive rate, similarly to <xref rid="btaa722-B7" ref-type="bibr">El-Kebir (2018)</xref>, <xref rid="btaa722-B15" ref-type="bibr">Jahn <italic toggle="yes">et al.</italic> (2016)</xref>, <xref rid="btaa722-B29" ref-type="bibr">Ross and Markowetz (2016)</xref> and <xref rid="btaa722-B41" ref-type="bibr">Zafar <italic toggle="yes">et al.</italic> (2017)</xref>. Hence, for each entry of <italic toggle="yes">E<sub>ij</sub></italic> the following holds:
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>β</mml:mo><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>β</mml:mo><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p>We aim to find a matrix, which maximizes the likelihood of the observed matrix <italic toggle="yes">I</italic> (<xref rid="btaa722-B15" ref-type="bibr">Jahn <italic toggle="yes">et al.</italic>, 2016</xref>) under the probabilities of false positives/negative and missing entries. Differently from previous works, our model also accounts for losses of mutations, thus, we define the prior probability <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>—independent from the previous ones—of losing mutation <italic toggle="yes">j</italic> and the set of variables <italic toggle="yes">c<sub>j</sub></italic> for <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> that denotes the total number of losses for mutation <italic toggle="yes">j</italic> in the evolutionary history. In practice, we expect that a researcher might able to determine that some mutations <italic toggle="yes">j</italic> are very unlikely be lost, therefore setting <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      <p>However, we are interested in the reconstruction of the evolutionary history of the input cells, thus the resulting matrix <italic toggle="yes">E</italic> should contain clones (groups of cells with the same mutations) that can be explained by an evolutionary process of the mutations. This restriction motivates the introduction of the concept of phylogenetic tree, or simply phylogeny.</p>
      <p>A (cancer) phylogeny <italic toggle="yes">T</italic> on a set <italic toggle="yes">C</italic> of <italic toggle="yes">m</italic> mutations and <italic toggle="yes">n</italic> cells (affected by these mutations) is defined as a rooted tree whose internal nodes are labeled by the mutations of <italic toggle="yes">C</italic>, while the leaves are labeled by the cells (see <xref rid="btaa722-F1" ref-type="fig">Fig. 1A</xref>). Notice that the labeling must satisfy some restrictions depending on the evolutionary model that we consider. For example, in a perfect phylogeny, no two nodes have the same label. This is an alternative, but essentially equivalent, definition of classical character-based phylogeny, where the tree <italic toggle="yes">T</italic> is defined on a set of characters and where leaves have no label and represent different species.
</p>
      <fig position="float" id="btaa722-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Example of a binary matrix <italic toggle="yes">E</italic> (right) representing a sample of the (<italic toggle="yes">n</italic> = 4) cells <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> affected by the set <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>a</mml:mi><mml:mo>…</mml:mo><mml:mi>g</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> of mutations. The tree (left) is a cancer phylogeny <italic toggle="yes">T</italic> explaining this matrix. Note that, the state of the internal node in the tree (left) labeled with (mutation) <italic toggle="yes">f</italic> has state {<italic toggle="yes">b</italic>, <italic toggle="yes">d</italic>, <italic toggle="yes">f</italic>} (mutation <italic toggle="yes">a</italic> appears in the root, but was lost in the path to this node), hence the genotype profile <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of leaf <italic toggle="yes">s</italic><sub>3</sub> in the tree is 0101010. Note that <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> holds for the (trivial) mapping <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, hence <italic toggle="yes">T</italic> (left) encodes <italic toggle="yes">E</italic> (right). Informally, leaf <italic toggle="yes">s</italic><sub>1</sub> was ‘attached’ to the internal node labeled by <italic toggle="yes">f</italic> because genotype profile <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of leaf <italic toggle="yes">s</italic><sub>3</sub> in <italic toggle="yes">T</italic> matches the row for <italic toggle="yes">s</italic><sub>3</sub> in <italic toggle="yes">E</italic>, e.g. Observe that the matrix (right) does not allow a perfect phylogeny, and that the tree (left) is a Dollo-1 phylogeny</p>
        </caption>
        <graphic xlink:href="btaa722f1" position="float"/>
      </fig>
      <p>The <italic toggle="yes">state</italic> of a node <italic toggle="yes">x</italic> is defined as the set of mutations that have been acquired but not lost in the path from the root to <italic toggle="yes">x</italic>. The state of each leaf <italic toggle="yes">l</italic> of <italic toggle="yes">T</italic> is naturally represented by a binary vector of length <italic toggle="yes">m</italic>, called genotype profile, that we denote <italic toggle="yes">D</italic>(<italic toggle="yes">T</italic>, <italic toggle="yes">l</italic>), where <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if and only if the leaf <italic toggle="yes">l</italic> has the mutation <italic toggle="yes">j</italic> and 0 otherwise (see <xref rid="btaa722-F1" ref-type="fig">Fig. 1B</xref>).</p>
      <p>We say that the tree <italic toggle="yes">T encodes</italic> a matrix <italic toggle="yes">E</italic> if there exists a mapping σ of the rows (cells) of <italic toggle="yes">E</italic> to the leaves of <italic toggle="yes">T</italic> such that <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for each row <italic toggle="yes">i</italic> of <italic toggle="yes">E</italic>, where σ<sub><italic toggle="yes">i</italic></sub> denotes the image of row <italic toggle="yes">i</italic> through the mapping σ. Informally, σ<sub><italic toggle="yes">i</italic></sub> is the node in the phylogenetic tree corresponding to the node where the cell <italic toggle="yes">i</italic> is attached. Notice that the matrix <italic toggle="yes">E</italic> is fully characterized by the pair <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (see <xref rid="btaa722-F1" ref-type="fig">Fig. 1C</xref>). Thus, our problem can be expressed as finding the tree <italic toggle="yes">T</italic> that maximizes the following objective function:
<disp-formula id="E2"><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>max</mml:mi><mml:munderover><mml:mo>∑</mml:mo><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:munderover><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>We point out that the values assigned to the unknown entries of the input matrix do not factor into the objective function, i.e. <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>?</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>?</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. To simplify the computation of the likelihood, we slightly abuse notation in supposing that <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>?</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>?</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. Furthermore, σ can be computed directly from <italic toggle="yes">T</italic>; for each tree, we can obtain the best assignment using an exact mapping; leaving <italic toggle="yes">T</italic> as the only variable to optimize.</p>
    </sec>
    <sec>
      <title>2.2 Introduction of the Dollo-k model</title>
      <p>The Dollo parsimony rule assumes that, in a phylogeny, any single mutation is uniquely introduced in the evolutionary history, but deletions of the mutation can occur any number of times. A restricted version of the Dollo model can be obtained by bounding the number of deletions for each mutation. We denote as Dollo-<italic toggle="yes">k</italic> the evolutionary model in which each mutation can be acquired exactly once and can be lost at most <italic toggle="yes">k</italic> times. The special cases, Dollo-0 and Dollo-1, correspond to the perfect (<xref rid="btaa722-B12" ref-type="bibr">Gusfield, 1991</xref>) and persistent (<xref rid="btaa722-B1" ref-type="bibr">Bonizzoni <italic toggle="yes">et al.</italic>, 2012</xref>, <xref rid="btaa722-B2" ref-type="bibr">2017</xref>; <xref rid="btaa722-B5" ref-type="bibr">Della Vedova <italic toggle="yes">et al.</italic>, 2017</xref>) phylogeny models, respectively. The phylogeny reconstruction problem under a Dollo-<italic toggle="yes">k</italic> model is NP-complete (<xref rid="btaa722-B11" ref-type="bibr">Goldberg <italic toggle="yes">et al.</italic>, 1996</xref>) for any <italic toggle="yes">k</italic> &gt; 1.</p>
      <p>Since the Dollo evolutionary model allows back mutations, we introduce a new type of node label in the phylogenetic tree, to express mutational losses. For each mutation <italic toggle="yes">p</italic>, we create <italic toggle="yes">k</italic> new mutations <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>l</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, representing the possible losses of mutation <italic toggle="yes">p</italic>. As in the perfect case, we require that no two different nodes have the same label. Additionally, we impose that all nodes labeled by a mutation loss <italic toggle="yes">p</italic><sup>–</sup> are descendants of the node labeled by the gain of mutation <italic toggle="yes">p</italic>. Consequently, the vector <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which expresses the genotype profile of a row <italic toggle="yes">i</italic> will have a 1 in mutations acquired but never lost in the path from the root to the parent σ<sub><italic toggle="yes">i</italic></sub> of the leaf <italic toggle="yes">i</italic>. Note that, the tree of <xref rid="btaa722-F1" ref-type="fig">Figure 1D</xref> is a Dollo-1 phylogeny. We stress that, unlike the case of the perfect phylogeny, when deletions are introduced, we might have more than one tree that is a solution. For example, switching the labels of nodes <italic toggle="yes">b</italic><sup>–</sup> and <italic toggle="yes">d</italic><sup>–</sup> in <xref rid="btaa722-F1" ref-type="fig">Figure 1</xref> produces a different tree, which is still a solution of the proposed input matrix when the Dollo model is considered. Moreover, the set of ancestral relationships between those two mutations is opposite in both representations. An increase of the number of cells and mutations, coupled with the noise caused by false calls and missing entries, expands the solution space of this problem, increasing the number of different cancer progression phylogenies which equally explain the same input.</p>
      <sec>
        <label>2.2.1</label>
        <title>Our model</title>
        <p>The model, we employ in this work is the Dollo-<italic toggle="yes">k</italic> model, with the added restriction that there are at most <italic toggle="yes">d</italic> total mutation losses in the entire progression. In addition to <italic toggle="yes">k</italic>, this <italic toggle="yes">d</italic> is a user supplied parameter. Note that, with a maximum <italic toggle="yes">d</italic> of total losses in the progression, it means that the variable <italic toggle="yes">c</italic> is subject to (i) <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo> </mml:mo><mml:mo>∀</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math></inline-formula> and (ii) <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>≤</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></inline-formula>. Only a small number of mutation losses in each tumor have been reported (<xref rid="btaa722-B20" ref-type="bibr">Kuipers <italic toggle="yes">et al.</italic>, 2017</xref>), therefore we expect small values of <italic toggle="yes">k</italic> and <italic toggle="yes">d</italic> to be used in practice. Most precisely, we believe that <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi><mml:mo>≤</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> in almost all cases. If the number of mutation is not too small, setting <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi><mml:mo>≤</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula> essentially implies <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, hence making the parameter <italic toggle="yes">k</italic> mostly irrelevant. Still, we have decided to keep it because it guarantees that some degenerate trees are never computed. We recall that our model also has the γ<sub><italic toggle="yes">j</italic></sub> parameters, i.e. the prior probability of losing mutation <italic toggle="yes">j</italic>.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Simulated annealing</title>
      <p>As mentioned before, the fact that (i) we can flip entries and that (ii), we want to find the maximum likelihood tree, makes the phylogeny reconstruction problem under the Dollo-<italic toggle="yes">k</italic> model computationally hard for any <italic toggle="yes">k</italic> &gt; 0. For this reason, in this article, we consider the Simulated Annealing (<xref rid="btaa722-B19" ref-type="bibr">Kirkpatrick <italic toggle="yes">et al.</italic>, 1983</xref>) (SA) approach in order to find a tree which maximizes the likelihood of an incomplete input matrix and that satisfies the Dollo-<italic toggle="yes">k</italic> phylogeny model, where <italic toggle="yes">k</italic> is given as input.</p>
      <p>SA is a random search technique, which explores the region of feasible solutions, searching for an optimal one. As all other meta-heuristic strategies, it is not guaranteed that SA finds the optimal value of the objective function in a finite number of steps; nevertheless, unlike other deterministic search methods, which can be trapped into local optima, SA has been designed to overcome this drawback and converge to a global optimum. The basic idea of the algorithm is to perform a random search, which accepts, with some probability, changes that do not necessarily improve the objective function. At each step, the probability of moving to some state with a smaller value changes according to a parameter called the <italic toggle="yes">temperature</italic>, which continuously decreases as the exploration evolves. In the first iterations of the algorithm execution, the temperature is very high, and it is possible (with a fairly high probability) to accept a move into a state with a lower objective value, but as temperature decreases, the probability of moving also decreases. At the end, when the temperature is sufficiently low, the algorithm becomes a local search method, hence unable to escape a local optimum.</p>
      <sec>
        <label>2.3.1</label>
        <title>Neighborhood topology</title>
        <p>An essential element of a SA approach that we must provide how the algorithm search process can move from a given state to another. In our particular framework, we attempt to find a tree, thus, we must define the neighborhood of a phylogenetic tree in the feasible region, and the algorithm moves from a tree to one of its neighbors. The choice of neighborhood is crucial in the algorithm definition since it determines how feasible solutions are explored, hence, ultimately determining whether or not the algorithm converges.</p>
        <p>In our approach, the notion of neighborhood is operational, i.e. two phylogenetic trees are neighbors if one can obtained from the other via some operation from a set we will define shortly. For the sake of clarity, we introduce some notation: given a phylogenetic tree <italic toggle="yes">T</italic> and a node (labeled as) <italic toggle="yes">i</italic>, <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mo>ρ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denotes the parent of <italic toggle="yes">i</italic> in <italic toggle="yes">T</italic>.
</p>
        <list list-type="bullet">
          <list-item>
            <p>Subtree Prune and Reattach: given a tree <italic toggle="yes">T</italic> and two internal nodes <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> such that neither is an ancestor of the other, we prune the subtree rooted in <italic toggle="yes">u</italic> by removing the edge <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mo>ρ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and we reattach it as a new child of <italic toggle="yes">v</italic> by adding the edge <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mo>ρ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
          </list-item>
          <list-item>
            <p>Add a deletion: given two nodes <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula> such that <italic toggle="yes">v</italic> is an ancestor of <italic toggle="yes">u</italic>, we insert a node <italic toggle="yes">v</italic><sup>–</sup> that represents a loss of mutation <italic toggle="yes">v</italic>. The new node is made the parent of <italic toggle="yes">u</italic>. We remark that this operation takes place only if the resulting tree satisfies the desired phylogeny model. More precisely, for the Dollo-<italic toggle="yes">k</italic> we must check that the mutation <italic toggle="yes">v</italic> has been previously lost in the tree at most <italic toggle="yes">k</italic> – 1 times, and never lost in any ancestor or descendant of <italic toggle="yes">v</italic><sup>–</sup>.</p>
          </list-item>
          <list-item>
            <p>Remove a deletion: given a node <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, labeled as a loss, we simply remove it from the tree <italic toggle="yes">T</italic>: all children of <italic toggle="yes">u</italic> are added as children of <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mo>ρ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and the node <italic toggle="yes">u</italic> is then deleted.</p>
          </list-item>
          <list-item>
            <p>Swap node labels: given two internal nodes <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, the labels of <italic toggle="yes">u</italic> and <italic toggle="yes">v</italic> are swapped. If a previously added loss becomes invalid due to this operation—because a mutation <italic toggle="yes">c</italic> is lost in a node <italic toggle="yes">c</italic><sup>–</sup>, but the node where the mutation <italic toggle="yes">c</italic> is acquired is not an ancestor of <italic toggle="yes">c</italic><sup>–</sup> anymore—then we remove the deletion <italic toggle="yes">c</italic><sup>–</sup>.</p>
          </list-item>
        </list>
      </sec>
      <sec>
        <label>2.3.2</label>
        <title>The algorithm</title>
        <p>The goal of the algorithm is to find a maximum likelihood Dollo-<italic toggle="yes">k</italic> phylogeny tree; a SA process is performed using the previously defined set of valid operations according to the same temperature decay process—in each iteration, one of these operations is performed, chosen uniformly among all possible candidate operations. Finally, after a new neighbor is generated, cells are optimally attached to the tree, maximizing its likelihood, resulting in the score of the new solution.</p>
        <p>Moreover, in the SA search processes, we have that, given a tree and a valid tree operation, the probability of accepting the new solution is <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mi>min</mml:mi><mml:mo>{</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>v</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math></inline-formula> is the possible change in the likelihood function after performing the operation, and <italic toggle="yes">T</italic> is the current temperature. The cooling process follows a geometric decay with a factor (cooling rate) <italic toggle="yes">cr</italic> of <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, i.e. the temperature at the <italic toggle="yes">i</italic>-th iteration is equal to <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>. The SA process stops when the temperature drops below a lower bound set at <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>.</p>
        <p>Since mutation losses are not as frequent as mutation gains, our approach allows to set an upper bound on <italic toggle="yes">d</italic>: the total number of deletions of the resulting tree. For example, in a Dollo-<italic toggle="yes">k</italic> model, we can consider only trees where each mutation is lost at most <italic toggle="yes">k</italic> times, but there are at most <italic toggle="yes">d</italic> nodes associated to mutation losses.</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Visualization</title>
      <p>Alongside the main tool, we produced a post-processing tool, called SASC-viz, that can be used to perform processing and filtering operations after the computation of the main tool. Notice that the following operations do not change the actual evolutionary history computed but only how it is displayed.</p>
      <list list-type="bullet">
        <list-item>
          <p>Collapsing simple paths: when this option is activated, all simple non-branching paths are collapsed, i.e. if a node has only one child, then such node is merged with its child;</p>
        </list-item>
        <list-item>
          <p>Collapsing low-support paths: when this option is activated, if the support of a node <italic toggle="yes">i</italic> is lower than a specified value, then <italic toggle="yes">i</italic> is merged with its parent <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mo>ρ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where the support <italic toggle="yes">s<sub>i</sub></italic> of a mutation <italic toggle="yes">i</italic> is computed on the output tree as follows: let <italic toggle="yes">st</italic>(<italic toggle="yes">i</italic>) be the set of nodes in the subtree rooted at <italic toggle="yes">i</italic>, and let <italic toggle="yes">C</italic>(<italic toggle="yes">i</italic>) be the number of cells assigned to the node <italic toggle="yes">i</italic>. Then, the mutation support <italic toggle="yes">s<sub>i</sub></italic> is:</p>
        </list-item>
        <list-item>
          <p>
            <inline-formula id="IE45">
              <mml:math id="IM41" display="inline" overflow="scroll">
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:munder>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>u</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:mi>s</mml:mi>
                          <mml:mi>t</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mi>C</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>u</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:munder>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>v</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:mi>s</mml:mi>
                          <mml:mi>t</mml:mi>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mo>π</mml:mo>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:mi>i</mml:mi>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mi>C</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>v</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mi>C</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mo>ρ</mml:mo>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
              </mml:math>
            </inline-formula>
          </p>
        </list-item>
      </list>
      <p>We used SASC-viz to produce the pictures of the real dataset analyzed. In particular, <xref rid="btaa722-F6" ref-type="fig">Figures 6</xref> and <xref rid="btaa722-F7" ref-type="fig">7</xref> are obtained by activating the collapsing simple paths option. <xref rid="btaa722-F5" ref-type="fig">Figure 5</xref> was produced with more enabled options: by collapsing simple paths and collapsing low-support paths with threshold 5%.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Results on simulated data</title>
      <p>We have tested our method on simulated data, where the ground truth phylogeny is known. We recall that it is possible, however, that a completely different tree achieves a better likelihood on the input data than the one obtained via simulation. This problem is essentially unavoidable, since generating a progression that is the unique solution for the corresponding SCS input matrix would require the contrived addition of artifacts to both the desired tree and the input matrix. These artifacts would likely be so artificial that the resulting instance would not satisfy even the basic assumptions on cancer progression.</p>
      <sec>
        <label>3.1.1</label>
        <title>Generating simulated datasets</title>
        <p>To test the methods, we run three different experiments with increasingly sophisticated models, according to the parameter settings of <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. In the first experiment, we explore a model with the possibility of mutation losses, a phenomenon, which has been evidenced by (<xref rid="btaa722-B20" ref-type="bibr">Kuipers <italic toggle="yes">et al.</italic>, 2017</xref>); the second experiment is produced with a model using only different (mutation-specific) false-negative rates, as seen in the real data we use. For the third experiment, we combine the previous two to extend the simulation to the most general model in which mutations have the possibility to be lost, and each have a specific false-negative rate.</p>
        <p>The false negative error rate distribution of the real datasets are obtained by analyzing the raw data of MGH36 and MGH64 from <xref rid="btaa722-B35" ref-type="bibr">Tirosh <italic toggle="yes">et al.</italic> (2016)</xref> and comparing the mutation frequencies in the scRNA-seq data to the matching Whole-Exome Sequencing (WES) from bulk RNA sequencing, to deduce the drop-out frequency. We have analyzed more than 2000 mutations and observed that the distribution of the real data is consistent with a Beta distribution, which we have used as a base for the generation of our simulated data.</p>
        <p>The values of different false-negative rates are randomly chosen from a <italic toggle="yes">Beta distribution</italic> <inline-formula id="IE41"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with parameters <inline-formula id="IE42"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, to better simulate the values found in real datasets; the different values of the prior probabilities of mutation losses are produced using a <italic toggle="yes">Triangular distribution</italic> with lower limit <italic toggle="yes">a</italic>, upper limit <italic toggle="yes">b</italic> and mean <italic toggle="yes">c</italic>, indicated as <inline-formula id="IE43"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Such distribution is usually used when only the mode, upper and lower bounds are known in a population as proxy for a fair estimation of real-case scenarios. A detailed description of the method used to simulate the datasets is available in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
      </sec>
      <sec>
        <label>3.1.2</label>
        <title>Evaluating the simulated datasets</title>
        <p>For each of the three experiments, we measure the accuracy of SASC with two scores based on standard cancer progression measures used in various studies (<xref rid="btaa722-B15" ref-type="bibr">Jahn <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa722-B22" ref-type="bibr">Malikic <italic toggle="yes">et al.</italic>, 2019a</xref>), i.e. <italic toggle="yes">Ancestor–Descendant</italic> and <italic toggle="yes">Different-Lineage</italic> accuracies; a novel parsimony-based score based on the difference between the number of flips, i.e. changes from 0 to 1 and from 1 to 0, estimated by some tool to correct the input; and the actual number of flips introduced by the simulation process to induce the noise. Lastly, we evaluate the trees using the edit distance measure of <xref rid="btaa722-B17" ref-type="bibr">Karpov <italic toggle="yes">et al.</italic> (2018)</xref>. A detailed explanation of all the measures is available in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. Note that none of the above mentioned metrics explicitly measures the ability of tools to correctly infer ISA violations.</p>
        <p>Additionally to the aforementioned measures, we provide two accuracy measures for the estimation of false negatives: (i) an accuracy of the estimation of the average false-negative rate in the simulations and (ii) the value of the average, over the 50 trees, of the mean squared error (MSE) over the set of estimations, for each mutation, of the mutation-specific false-negative rates. Note that (ii) gives an indication also of the <italic toggle="yes">variance</italic> of the estimation of false-negative rates, which is important when these rates are heterogeneous, and far from being normally distributed—something we see in real data that we use here and that is due to varying gene amplification and expression levels.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 Results of the simulation experiments</title>
      <p>We now detail the evaluation of the last experiment, which shows the most interesting results. Due to lack of space, we refer to the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref> for a detailed discussion on the other two, less general, experiments.</p>
      <p>We decided to compare SASC against SCITE (<xref rid="btaa722-B15" ref-type="bibr">Jahn <italic toggle="yes">et al.</italic>, 2016</xref>), SiFit (<xref rid="btaa722-B41" ref-type="bibr">Zafar <italic toggle="yes">et al.</italic>, 2017</xref>) and SPhyR (<xref rid="btaa722-B7" ref-type="bibr">El-Kebir, 2018</xref>). While B-SCITE (<xref rid="btaa722-B22" ref-type="bibr">Malikic <italic toggle="yes">et al.</italic>, 2019a</xref>) is a clear improvement over SCITE, it combines single-cell data with bulk sequencing data—since we do not manage the latter kind of data, a fair comparison is not feasible. For the same reason, we do not compare against TRaIT (<xref rid="btaa722-B27" ref-type="bibr">Ramazzotti <italic toggle="yes">et al.</italic>, 2019</xref>) and PhISCS (<xref rid="btaa722-B23" ref-type="bibr">Malikic <italic toggle="yes">et al.</italic>, 2019a</xref>). OncoNEM (<xref rid="btaa722-B29" ref-type="bibr">Ross and Markowetz, 2016</xref>) was excluded because it is not able to complete the execution on datasets as large as the ones used in the simulations. Each of the tools is properly run with millions of iterations and multiple restarts; the complete settings are available in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
      <p>This experiment shows the results when the datasets contain both heterogeneous false negatives and deletions based on scRNA-seq error model, thus complementing the other experiments. SASC outperforms any other tool in every considered measure (<xref rid="btaa722-F2" ref-type="fig">Figs 2 and 3</xref>) and it also shows the best estimation of the false-negative rates in terms of average and MSE (<xref rid="btaa722-F4" ref-type="fig">Fig. 4</xref>). It is particularly interesting to notice the drop in performance of SPhyR when it is forced to employ the Dollo model, since this is the only experiment with mutation losses involved. It is also very clear that SASC outperforms all the available methods when it deals with heterogeneous false-negative rates and mutation losses. It also interesting to notice that SASC shows a much higher accuracy than the other two tools that allow mutational losses—SiFit and SPhyR—when such losses are present in the dataset.
</p>
      <fig position="float" id="btaa722-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Accuracy results for the simulated experiment. In this experiment, SASC scores better than any other tool in these measures. Once again SiFit is the poorest scoring method. The accuracy of SPhyR lowers when mutation losses are included into the dataset and it is forced to employ a Dollo model. To the contrary, SASC performs the best when it utilizes the full extent of its capabilities, i.e. the handling of heterogeneous false-negative rates and mutation losses. Notice that larger values in both measures are better</p>
        </caption>
        <graphic xlink:href="btaa722f2" position="float"/>
      </fig>
      <fig position="float" id="btaa722-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Accuracy results for the simulated experiment. According to these two measures, SASC scores better than any other tool. A clear performance drop is noticed when SPhyR is forced to employ a Dollo model. We represent the results of the parsimony score with and without SiFit, since its results are much different from the other ones. Notice that smaller values of both measures are better</p>
        </caption>
        <graphic xlink:href="btaa722f3" position="float"/>
      </fig>
      <fig position="float" id="btaa722-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>False-negative rates estimation for the simulated experiment. SASC estimates the false-negative rates better than the other tools, both in terms of average estimation, as well as MSE of the single rates for each mutation. Especially in the latter measure, we can notice a vast discrepancy in the accuracy of the estimation of false-negative rates. The thick red line is the average of the individual false-negative rates of the mutations in the ground truth</p>
        </caption>
        <graphic xlink:href="btaa722f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Results on real cancer data</title>
      <p>We test and compare SASC on four different datasets, comprising both scDNA-seq and scRNA-seq sequencing data. Due to lack of space, the figures of the trees inferred by the other methods are displayed in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. Since SiFit exhibited poor performances on the simulated datasets, it is excluded in the comparison on real datasets.</p>
      <sec>
        <label>3.3.1</label>
        <title>Oligodendroglioma IDH-mutated tumor</title>
        <p>We test SASC on an oligodendroglioma IDH-mutated tumor; in particular, on cancer MGH36 (<xref rid="btaa722-B35" ref-type="bibr">Tirosh <italic toggle="yes">et al.</italic>, 2016</xref>), consisting of 77 SNVs, distinguished from PCR false positives using matched WES, over 579 cells. <xref rid="btaa722-F5" ref-type="fig">Figure 5</xref> shows the tree computed by SASC and the distribution of the false-negative rates (shown in the bottom-right corner plot). The distribution stresses the necessity of a method that considers heterogeneous false-negative rates, since there are two spikes of rates (at roughly 0.1 and 0.9), i.e. it is highly bimodal, and using the average of the rates would not be an accurate representation. In this particular tumor, no deletion was expected: this is confirmed by the inferred tree.
</p>
        <fig position="float" id="btaa722-F5">
          <label>Fig. 5.</label>
          <caption>
            <p>Tree inferred by SASC for the oligodendroglioma IDH-mutated MGH36 from <xref rid="btaa722-B35" ref-type="bibr">Tirosh <italic toggle="yes">et al.</italic> (2016)</xref>. The tree was computed using as input different false-negative rates for each mutation, whose distribution can be seen in the bottom-right corner plot. The picture was drawn using the SASC-viz post-processing tool</p>
          </caption>
          <graphic xlink:href="btaa722f5" position="float"/>
        </fig>
        <p>For the dataset MGH36 from <xref rid="btaa722-B35" ref-type="bibr">Tirosh <italic toggle="yes">et al.</italic> (2016)</xref>, there is no manually curated tree to compare the results of the tools, thus, we report the number of false negatives and false positives inferred by the methods, this is the number of flips from 0 to 1 and from 1 to 0, respectively, from the input to the output. The rationale for this score is to report a parsimony score of the algorithms; a comparison of the likelihood values will not be fair, since SASC uses a different formula than the other tools. Such score is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>; SASC introduces the lowest number of false negatives to obtain the solution, albeit being very close to SCITE (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>), while SPhyR (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S14</xref>) infers the highest number.</p>
      </sec>
      <sec>
        <label>3.3.2</label>
        <title>Childhood acute lymphoblastic leukemia</title>
        <p>Furthermore, we test SASC on Childhood Acute Lymphoblastic Leukemia data from <xref rid="btaa722-B10" ref-type="bibr">Gawad <italic toggle="yes">et al.</italic> (2014)</xref>. In particular, we focus on Patients 4 and 5 of this study, given their large amount of both cells and mutations, as well as their complexity. Data on Patient 4 consist of 78 somatic SNVs over 143 cells, while Patient 5 is affected by 104 somatic SNVs over 96 cells. The original study estimated an allelic drop-out rate of &lt;30%. Since the trees in <xref rid="btaa722-B10" ref-type="bibr">Gawad <italic toggle="yes">et al.</italic> (2014)</xref> determined using expectation–maximization on a multivariate Bernoulli distribution model, are manually curated and of high quality, we select them as the ground truth.</p>
        <p>To ensure the absence of doublets, i.e. noise produced by error due to the fact that two cells are sequenced instead of a unique cell, we preprocess the input using the <italic toggle="yes">Single-Cell Genotyper</italic> (SCG) tool (<xref rid="btaa722-B30" ref-type="bibr">Roth <italic toggle="yes">et al.</italic>, 2016</xref>). SCG is a statistical model, which removes all cells of the datasets that are likely to be doublets.</p>
        <p><xref rid="btaa722-F6" ref-type="fig">Figure 6</xref> shows the tree inferred by SASC for Patient 4; SASC correctly infers the tree structure obtained in the study, as well as the size of the subclonal population. The driver mutations are correctly detected, and mutations COL5A2, SDPR and TRHR are inferred as deletions. Furthermore, bold-faced and colored mutations indicate the correctly placed specific driver mutations for the subclone of the same color. It is interesting to notice that, in the original study, the violet subclone does not have mutations COL5A2 and TRHR: these particular mutations are in fact deleted in the clone. This solution was found assuming a Dollo-1 phylogeny model with no restriction on the total number of deletions in the cancer progression.
</p>
        <fig position="float" id="btaa722-F6">
          <label>Fig. 6.</label>
          <caption>
            <p>The tree inferred by SASC for Patient 4 of the Childhood Lymphoblastic Leukemia data from <xref rid="btaa722-B10" ref-type="bibr">Gawad <italic toggle="yes">et al.</italic> (2014)</xref>. Different clones are indicated with different colors. Red nodes indicate deletions of mutations, while bold-faced mutations are the mutations indicated as driver in the original sequencing study. Mutations in bold and colored are driver mutations for the clone with the same color. Mutations are clustered by collapsing simple linear paths. The picture was drawn using the SASC-viz post-processing tool</p>
          </caption>
          <graphic xlink:href="btaa722f6" position="float"/>
        </fig>
        <p>In <xref rid="btaa722-F7" ref-type="fig">Figure 7</xref>, the inferred solution for Patient 5 of the same study is shown. As in the previous dataset, our inferred tree perfectly supports the hypotheses proposed in the original sequencing study: in fact, it correctly infers the topology of the tree, as well as the placement of driver mutations. Bold-faced mutations are the driver mutations for the tree or the subclone with the same color. This solution was found assuming a Dollo-1 phylogeny model with a restriction of 10 deletions in the cancer progression. As described in the Section 2.3, such values for <italic toggle="yes">k</italic> and <italic toggle="yes">d</italic> were empirically found to give the best likelihood.
</p>
        <fig position="float" id="btaa722-F7">
          <label>Fig. 7.</label>
          <caption>
            <p>Tree inferred by SASC for Patient 5 of the Childhood Lymphoblastic Leukemia data from <xref rid="btaa722-B10" ref-type="bibr">Gawad <italic toggle="yes">et al.</italic> (2014)</xref>. Different clones are indicated with different colors, while the red-colored nodes indicate deletions of mutations, and mutations highlighted in bold are the mutations indicated as driver in the original sequencing study. Mutations bold-faced and colored are driver mutations for the same colored clone. Mutations are clustered by collapsing simple linear paths. The picture was drawn using the SASC-viz post-processing tool</p>
          </caption>
          <graphic xlink:href="btaa722f7" position="float"/>
        </fig>
        <p>Since the original study (<xref rid="btaa722-B10" ref-type="bibr">Gawad <italic toggle="yes">et al.</italic>, 2014</xref>) provides manually curated trees, we can compare SASC, SCITE and SPHyR to them.</p>
        <p>SCITE is run using the same setting used for SASC, i.e. the proposed values of false positive and false-negative rates. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S9</xref> shows the tree inferred by SCITE for Patient 4; the tree structure is similar to the one proposed in the article but it presents more clones. Furthermore, we highlighted in red all driver mutations that were not correctly detected, and in blue mutations that define a subclone and should be in the same subtree. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S10</xref> shows the tree inferred by SCITE for Patient 5 of the same study; the tree topology is correctly inferred, however mutations highlighted in red are driver mutations that were not correctly detected.</p>
        <p>SPhyR is run using the same setting used for SASC, i.e. the proposed values of false positive and false-negative rates and assuming a Dollo-1 model. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12</xref> shows the tree inferred by SPhyR for Patient 4; the tree structure is similar to the one proposed in the article. The drivers and distinct subclones are also correctly placed. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S13</xref> shows the tree inferred by SPhyR for Patient 5 of the same study; the tree topology is correctly inferred, however, it infers a large number of mutation losses, which is very unlikely and it is probably due to the fact that deletions are used, in this case, to correct false negatives at no cost in terms of likelihood function.</p>
      </sec>
      <sec>
        <label>3.3.3</label>
        <title>Medulloblastoma</title>
        <p>Lastly, we test the methods on Medulloblastoma patient BCH1031 from <xref rid="btaa722-B14" ref-type="bibr">Hovestadt <italic toggle="yes">et al.</italic> (2019)</xref> consisting of 96 mutations over 330 cells. Given the complexity and the dimensions of the trees, we display them in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>. SASC and SPhyR computed the solution using a Dollo-2 phylogeny model.</p>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S15</xref> shows the tree inferred by SASC, which reported a total of two mutation losses. Both trees inferred by SASC and SCITE (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S16</xref>) express, as expected, various mutations correlated to the TUBB gene. On the other hand, SPhyR (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S17</xref>) inferred a total of 56 mutations over the 96 present in the sample. Furthermore, similarly to the previous experiment, SPhyR inferred a total of 24 mutational losses, which is very unlikely for so many losses to be present in a single sample, since evidence from <xref rid="btaa722-B20" ref-type="bibr">Kuipers <italic toggle="yes">et al.</italic> (2017)</xref> suggests that this phenomenon is extremely rare. It is more likely that, also in this case, deletions are used to correct false negatives at no cost in terms of likelihood. Lastly, while SASC and SCITE each finished its computation in &lt;2 h, SPhyR took more than 24 h.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>We have presented SASC and we have shown that it is an accurate tool for inferring intra-tumor progression and subclonal composition from both scDNA-seq and scRNA-seq data. SASC manages cases with mutation losses and is robust to various sources of noise in all data.</p>
    <p>We have tested SASC on three simulated datasets, and we have shown that SASC is able to outperform all tools when there are mutation losses, while being competitive with SCITE and SPhyR when there are no mutation losses.</p>
    <p>We have tested SASC on three real datasets. SASC has inferred a likely phylogeny tree structure, correctly identifying the driver mutations and the decomposition of the clones. Furthermore, it has solved those large datasets in adequate runtime.</p>
    <p>A particularly interesting example is given by the inferred tree in <xref rid="btaa722-F7" ref-type="fig">Figure 7</xref>. The corresponding input dataset in this case contains more than 5000 conflicts between mutations—each conflict is a pair of mutations witnessing a violation of the ISA. With only a slight relaxation of the ISA—the Dollo-1 model—SASC is able to infer an accurate solution with a total of only eight deletions, while perfect phylogeny methods would require a large number of changes to the entries in the input just to produce a feasible solution.</p>
    <p>A future extension could be the inclusion of coverage information from the reads, as in Monovar (<xref rid="btaa722-B40" ref-type="bibr">Zafar <italic toggle="yes">et al.</italic>, 2016</xref>) and Sci<inline-formula id="IE44"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mo>Φ</mml:mo></mml:math></inline-formula> (<xref rid="btaa722-B33" ref-type="bibr">Singer <italic toggle="yes">et al.</italic>, 2018</xref>), since it will also have an impact on the false-negative rates. Another direction is toward even more general models, e.g. allowing each mutation to appear more than once in the tree. Also in this case, special attention must be paid to keeping the model sufficiently restricted so that computation time does not explode, and inferred trees are still relevant from a biological point of view.</p>
    <p>The need for a model that allows mutation losses has been established in <xref rid="btaa722-B20" ref-type="bibr">Kuipers <italic toggle="yes">et al.</italic> (2017)</xref>, but no clear consensus on the model that is most suited to represent the true evolution of tumors has been reached so far, to the best of our knowledge. In our article, we introduce and follow a restricted version of the Dollo-<italic toggle="yes">k</italic> model, where the number of mutations in each site and the number of overall mutations is limited—even though our method can be used also in a more relaxed setting. Determining which of the possible models is going to be the basis for effective and efficient tumor phylogeny inference is something that needs to be explored in the future, but it will likely need the development of different methods, and a deeper understanding of the models.</p>
    <p>All the data produced and the experimental settings are publicly available and reproducible at SASC’s repository <ext-link xlink:href="https://github.com/sciccolella/sasc" ext-link-type="uri">https://github.com/sciccolella/sasc</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa722_Supplementary_Data</label>
      <media xlink:href="btaa722_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>Part of this work has been done during a visit by S.C. to Weill Cornell Medicine. We want to acknowledge Mario Suvà (Massachussets General Hospital) for several illuminating discussions on tumor evolution, especially on the brain tumors that have been used to assess the quality of the predictions computed by SASC on real data.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by Mobility Exchange Fellowship from the University of Milano – Bicocca (to S.C.). This project has received funding from the European Union’s Horizon 2020 research and innovation programme under the Marie Skłodowska-Curie grant [872539]. C.R. is supported by the Tri-Institutional Training Program in Computational Biology and Medicine via NIH training grant [1T32GM083937]. This work was also supported by start-up funds (Weill Cornell Medicine) and a US National Science Foundation (NSF) grant [IIS-1840275 to I.H.].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa722-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonizzoni</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) 
<article-title>The binary perfect phylogeny with persistent characters</article-title>. <source>Theor. Comput. Sci</source>., <volume>454</volume>, <fpage>51</fpage>–<lpage>63</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa722-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonizzoni</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>A colored graph approach to perfect phylogeny with persistent characters</article-title>. <source>Theor. Comput. Sci</source>., <volume>658</volume>, <fpage>60</fpage>–<lpage>73</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa722-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonizzoni</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Does relaxing the infinite sites assumption give better tumor phylogenies? An ILP-based comparative approach</article-title>. <source>IEEE/ACM Trans. Comput. Biol. Bioinform</source>., <volume>16</volume>, <fpage>1410</fpage>–<lpage>1423</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa722-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brown</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Phylogenetic analysis of metastatic progression in breast cancer using somatic mutations and copy number aberrations</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>14944</fpage>.<pub-id pub-id-type="pmid">28429735</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Della Vedova</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <italic toggle="yes">Character-based Phylogeny Construction and Its Application to Tumor Evolution.</italic> Lecture Notes in Computer Science. Unveiling Dynamics and Complexity - 13th Conference on Computability in Europe, CiE 2017, Turku, Finland, June 12-16, 2017, Proceedings. Vol. <volume>10307</volume>, pp. <fpage>3</fpage>–<lpage>13</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa722-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DePasquale</surname><given-names>E.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Doubletdecon: deconvoluting doublets from single-cell RNA-sequencing data</article-title>. <source>Cell Rep</source>., <volume>29</volume>, <fpage>1718</fpage>–<lpage>1727.e8</lpage>.<pub-id pub-id-type="pmid">31693907</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>El-Kebir</surname><given-names>M.</given-names></string-name></person-group> (<year>2018</year>) 
<article-title>SphyR: tumor phylogeny estimation from single-cell sequencing data under loss and error</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>i671</fpage>–<lpage>i679</lpage>.<pub-id pub-id-type="pmid">30423070</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>El-Kebir</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Inferring the mutational history of a tumor using multi-state perfect phylogeny mixtures</article-title>. <source>Cell Syst</source>., <volume>3</volume>, <fpage>43</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">27467246</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Farris</surname><given-names>J.S.</given-names></string-name></person-group> (<year>1977</year>) 
<article-title>Phylogenetic analysis under Dollo’s law</article-title>. <source>Syst. Biol</source>., <volume>26</volume>, <fpage>77</fpage>–<lpage>88</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa722-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gawad</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Dissecting the clonal origins of childhood acute lymphoblastic leukemia by single-cell genomics</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>111</volume>, <fpage>17947</fpage>–<lpage>17952</lpage>.<pub-id pub-id-type="pmid">25425670</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goldberg</surname><given-names>L.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1996</year>) 
<article-title>Minimizing phylogenetic number to find good evolutionary trees</article-title>. <source>Discrete Appl. Math</source>., <volume>71</volume>, <fpage>111</fpage>–<lpage>136</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa722-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gusfield</surname><given-names>D.</given-names></string-name></person-group> (<year>1991</year>) 
<article-title>Efficient algorithms for inferring evolutionary trees</article-title>. <source>Networks</source>, <volume>21</volume>, <fpage>19</fpage>–<lpage>28</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa722-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hajirasouliha</surname><given-names>I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>A combinatorial approach for analyzing intra-tumor heterogeneity from high-throughput sequencing data</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>i78</fpage>–<lpage>i86</lpage><pub-id pub-id-type="pmid">24932008</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hovestadt</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Resolving medulloblastoma cellular architecture by single-cell genomics</article-title>. <source>Nature</source>, <volume>572</volume>, <fpage>74</fpage>–<lpage>79</lpage>.<pub-id pub-id-type="pmid">31341285</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jahn</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Tree inference for single-cell data</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>86</fpage>.<pub-id pub-id-type="pmid">27149953</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiao</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Inferring clonal evolution of tumors from single nucleotide somatic mutations</article-title>. <source>BMC Bioinformatics</source>, <volume>15</volume>, <fpage>35</fpage>.<pub-id pub-id-type="pmid">24484323</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B17">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Karpov</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) A multi-labeled tree edit distance for comparing “Clonal Trees” of tumor progression. In: <person-group person-group-type="editor"><string-name><surname>Parida</surname><given-names>L.</given-names></string-name>, <string-name><surname>Ukkonen</surname><given-names>E.</given-names></string-name></person-group> (eds). <source>18th International Workshop on Algorithms in Bioinformatics (WABI 2018). Leibniz International Proceedings in Informatics (LIPIcs)</source>. <volume>Vol. 113</volume>, 
<publisher-name>Schloss Dagstuhl–Leibniz-Zentrum fuer Informatik</publisher-name>, 
<publisher-loc>Dagstuhl, Germany</publisher-loc>, pp. <fpage>22:1</fpage>–<lpage>22:19</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa722-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kimura</surname><given-names>M.</given-names></string-name></person-group> (<year>1969</year>) 
<article-title>The number of heterozygous nucleotide sites maintained in a finite population due to steady flux of mutations</article-title>. <source>Genetics</source>, <volume>61</volume>, <fpage>893</fpage>–<lpage>903</lpage>.<pub-id pub-id-type="pmid">5364968</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kirkpatrick</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1983</year>) 
<article-title>Optimization by simulated annealing</article-title>. <source>Science</source>, <volume>220</volume>, <fpage>671</fpage>–<lpage>680</lpage>.<pub-id pub-id-type="pmid">17813860</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuipers</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Single-cell sequencing data reveal widespread recurrence and loss of mutational hits in the life histories of tumors</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>1885</fpage>–<lpage>1894</lpage>.<pub-id pub-id-type="pmid">29030470</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Malikic</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Clonality inference in multiple tumor samples using phylogeny</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>1349</fpage>–<lpage>1356</lpage>.<pub-id pub-id-type="pmid">25568283</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B22">
      <mixed-citation publication-type="journal">Malikic, S. <source><italic toggle="yes">et al.</italic></source> (2019a) Integrative inference of subclonal tumour evolution from single-cell and bulk sequencing data. <italic toggle="yes">Nat. Commun.</italic> <bold>10, </bold>2750.</mixed-citation>
    </ref>
    <ref id="btaa722-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Malikic</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>b) 
<article-title>PhISCS: a combinatorial approach for subperfect tumor phylogeny reconstruction via integrative use of single-cell and bulk sequencing data</article-title>. <source>Genome Res</source>., <volume>29</volume>, <fpage>1860</fpage>–<lpage>1877</lpage>.<pub-id pub-id-type="pmid">31628256</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marass</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>A phylogenetic latent feature model for clonal deconvolution</article-title>. <source>Ann. Appl. Stat</source>, <volume>10</volume>, <fpage>2377</fpage>–<lpage>2404</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa722-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morrissy</surname><given-names>A.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Divergent clonal selection dominates medulloblastoma at recurrence</article-title>. <source>Nature</source>, <volume>529</volume>, <fpage>351</fpage>– <lpage>357</lpage>.<pub-id pub-id-type="pmid">26760213</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Popic</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Fast and scalable inference of multi-sample cancer lineages</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>91</fpage>–<lpage>647</lpage>.<pub-id pub-id-type="pmid">25944252</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramazzotti</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Learning mutational graphs of individual tumor evolution from multi-sample sequencing data</article-title>. <source>BMC Bioinformatics.,</source>  <volume>20</volume>, 210.</mixed-citation>
    </ref>
    <ref id="btaa722-B28">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Rogozin</surname><given-names>I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2006</year>) <source>Dollo Parsimony and the Reconstruction of Genome Evolution</source>. 
<publisher-name>Oxford University Press</publisher-name>, 
<publisher-loc>UK</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btaa722-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ross</surname><given-names>E.M.</given-names></string-name>, <string-name><surname>Markowetz</surname><given-names>F.</given-names></string-name></person-group> (<year>2016</year>) 
<article-title>OncoNEM: inferring tumor evolution from single-cell sequencing data</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>69</fpage>.<pub-id pub-id-type="pmid">27083415</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roth</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Clonal genotype and population structure inference from single-cell tumor sequencing</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>573</fpage>–<lpage>576</lpage>.<pub-id pub-id-type="pmid">27183439</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salehi</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>ddClone: joint statistical inference of clonal populations from single cell and bulk tumour sequencing data</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>44</fpage>.<pub-id pub-id-type="pmid">28249593</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satas</surname><given-names>G.</given-names></string-name>, <string-name><surname>Raphael</surname><given-names>B.J.</given-names></string-name></person-group> (<year>2017</year>) 
<article-title>Tumor phylogeny inference using tree-constrained importance sampling</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>i152</fpage>–<lpage>i160</lpage>.<pub-id pub-id-type="pmid">28882002</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Singer</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Single-cell mutation identification via phylogenetic inference</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>5144</fpage>.<pub-id pub-id-type="pmid">30514897</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strino</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>TrAp: a tree approach for fingerprinting subclonal tumor composition</article-title>. <source>Nucleic Acids Res</source>., <volume>41</volume>, <fpage>e165</fpage>.<pub-id pub-id-type="pmid">23892400</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tirosh</surname><given-names>I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Single-cell RNA-seq supports a developmental hierarchy in human oligodendroglioma</article-title>. <source>Nature</source>, <volume>539</volume>, <fpage>309</fpage>.<pub-id pub-id-type="pmid">27806376</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Toosi</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>BAMSE: Bayesian model selection for tumor phylogeny inference among multiple samples</article-title>. <source>BMC Bioinformatics</source>, <volume>20</volume>, <fpage>282</fpage>.<pub-id pub-id-type="pmid">31167637</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Clonal evolution of glioblastoma under therapy</article-title>. <source>Nat. Genet</source>., <volume>48</volume>, <fpage>768</fpage>–<lpage>776</lpage>.<pub-id pub-id-type="pmid">27270107</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>Y.</given-names></string-name></person-group> (<year>2019</year>) 
<article-title>Accurate and efficient cell lineage tree inference from noisy single cell data: the maximum likelihood perfect phylogeny approach</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>742</fpage>–<lpage>750</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa722-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yuan</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Bitphylogeny: a probabilistic framework for reconstructing intra-tumor phylogenies</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>36</fpage>.<pub-id pub-id-type="pmid">25786108</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zafar</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Monovar: single-nucleotide variant detection in single cells</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>505</fpage>– <lpage>507</lpage>.<pub-id pub-id-type="pmid">27088313</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zafar</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>SiFit: inferring tumor trees from single-cell sequencing data under finite-sites models</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>178</fpage>.<pub-id pub-id-type="pmid">28927434</pub-id></mixed-citation>
    </ref>
    <ref id="btaa722-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zafar</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>SiCloneFit: Bayesian inference of population structure, genotype, and phylogeny of tumor clones from single-cell genome sequencing data</article-title>. <source>Genome Res</source>., <volume>29</volume>, <fpage>1847</fpage>–<lpage>1859</lpage>.<pub-id pub-id-type="pmid">31628257</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
