<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7722316</article-id>
    <article-id pub-id-type="pmid">33292397</article-id>
    <article-id pub-id-type="publisher-id">2194</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-020-02194-x</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>STARRPeaker: uniform processing and accurate identification of STARR-seq active regions</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Donghoon</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shi</surname>
          <given-names>Manman</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moran</surname>
          <given-names>Jennifer</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wall</surname>
          <given-names>Martha</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Jing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Jason</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fitzgerald</surname>
          <given-names>Dominic</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kyono</surname>
          <given-names>Yasuhiro</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Lijia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>White</surname>
          <given-names>Kevin P.</given-names>
        </name>
        <address>
          <email>kevin@tempus.com</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9746-3719</contrib-id>
        <name>
          <surname>Gerstein</surname>
          <given-names>Mark</given-names>
        </name>
        <address>
          <email>mark@gersteinlab.org</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
        <xref ref-type="aff" rid="Aff10">10</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.59734.3c</institution-id><institution-id institution-id-type="ISNI">0000 0001 0670 2351</institution-id><institution>Department of Genetics and Genomic Science, </institution><institution>Icahn School of Medicine at Mount Sinai, </institution></institution-wrap>New York, NY 10029 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.59734.3c</institution-id><institution-id institution-id-type="ISNI">0000 0001 0670 2351</institution-id><institution>Department of Psychiatry, </institution><institution>Icahn School of Medicine at Mount Sinai, </institution></institution-wrap>New York, NY 10029 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution>Program in Computational Biology and Bioinformatics, </institution><institution>Yale University, </institution></institution-wrap>New Haven, CT 06520 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution>Department of Molecular Biophysics and Biochemistry, </institution><institution>Yale University, </institution></institution-wrap>New Haven, CT 06520 USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.170205.1</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 7822</institution-id><institution>Institute for Genomics and System Biology, </institution><institution>University of Chicago, </institution></institution-wrap>Chicago, IL 60637 USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.511425.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 9346 3636</institution-id><institution>Tempus Labs, Inc., </institution></institution-wrap>Chicago, IL 60654 USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.266093.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 0668 7243</institution-id><institution>School of Information and Computer Sciences, </institution><institution>University of California, </institution></institution-wrap>Irvine, CA 92697 USA </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="GRID">grid.494629.4</institution-id><institution-id institution-id-type="ISNI">0000 0004 8008 9315</institution-id><institution>School of Life Sciences, Westlake University, </institution></institution-wrap>Hangzhou, 310024 Zhejiang China </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution>Department of Computer Science, </institution><institution>Yale University, </institution></institution-wrap>New Haven, CT 06520 USA </aff>
      <aff id="Aff10"><label>10</label><institution-wrap><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution>Department of Statistics and Data Science, </institution><institution>Yale University, </institution></institution-wrap>New Haven, CT 06520 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>8</day>
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>8</day>
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>298</elocation-id>
    <history>
      <date date-type="received">
        <day>2</day>
        <month>8</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>11</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020, corrected publication 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">STARR-seq technology has employed progressively more complex genomic libraries and increased sequencing depths. An issue with the increased complexity and depth is that the coverage in STARR-seq experiments is non-uniform, overdispersed, and often confounded by sequencing biases, such as GC content. Furthermore, STARR-seq readout is confounded by RNA secondary structure and thermodynamic stability. To address these potential confounders, we developed a negative binomial regression framework for uniformly processing STARR-seq data, called STARRPeaker. Moreover, to aid our effort, we generated whole-genome STARR-seq data from the HepG2 and K562 human cell lines and applied STARRPeaker to comprehensively and unbiasedly call enhancers in them.</p>
      <sec>
        <title>Supplementary information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-020-02194-x.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U24HG009446</award-id>
        <award-id>UM1HG009426</award-id>
        <principal-award-recipient>
          <name>
            <surname>White</surname>
            <given-names>Kevin P.</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>Mark</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000025</institution-id>
            <institution>National Institute of Mental Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>K01MH123896</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhang</surname>
            <given-names>Jing</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">The transcription of eukaryotic genes is precisely coordinated by an interplay between <italic>cis-</italic>regulatory elements. For example, enhancers and promoters serve as binding platforms for transcription factors (TFs) and allow them to interact with each other via three-dimensional looping of chromatin. Their interactions are often required to initiate transcription [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Enhancers, which are often distant from the transcribed gene body itself, play critical roles in the upregulation of gene transcription. Enhancers are cell-type-specific and can be epigenetically activated or silenced to modulate transcriptional dynamics over the course of development. Enhancers can be found upstream or downstream of genes, or even within introns [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. They function independent of their orientation, do not necessarily regulate the closest genes, and sometimes regulate multiple genes at once [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>]. In addition, several recent studies have demonstrated that some promoters—termed E-promoters—may act as enhancers of distal genes [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>].</p>
    <p id="Par3">Consensus sequences (or canonical sequences) have been identified at certain protein binding sites, splice sites, and boundaries of protein-coding genes. However, there are no known consensus sequences that characterize enhancer function, making it challenging to identify enhancers based on sequence alone in an unbiased fashion. The noncoding territory occupies over 98% of the genome landscape, making the search space very broad. Moreover, the activity of enhancers depends on the physiological condition and epigenetic landscape of the cellular environment, complicating a fair assessment of enhancer function.</p>
    <p id="Par4">Previously, putative regulatory elements were computationally predicted, indirectly, by profiling DNA accessibility (using DNase-seq, FAIRE-seq, or ATAC-seq) as well as histone modifications (ChIP-seq) that are linked to regulatory functions [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref>]. More recently, researchers have developed high-throughput episomal (exogenous) reporter assays to directly measure enhancer activity across the whole genome, specifically massively parallel reporter assays (MPRA) [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR14">14</xref>] and self-transcribing active regulatory region sequencing (STARR-seq) [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. These assays allow for quantitative assessment of enhancer activity in a high-throughput fashion.</p>
    <p id="Par5">In STARR-seq, candidate DNA fragments are cloned downstream of a reporter gene into the 3′ untranslated region (UTR). After transfecting the plasmid pool into host cells, one can measure the regulatory potential by high-throughput sequencing of the 3′ UTR of the expressed reporter gene mRNA. These exogenous reporters enable accurate and unbiased assessment of enhancer activity at the whole-genome level, independent of chromatin context. Unlike MPRA—which utilizes barcodes—STARR-seq produces self-transcribed RNA fragments that can be directly mapped onto the genome (we call this STARR-seq output hereafter). The activities of enhancers are measured by comparing the amount of RNA produced from the relative amount of genomic DNA in the STARR-seq library (we call this STARR-seq input hereafter). STARR-seq has several technical advantages over MPRA. Library construction is relatively simple because barcodes are not needed. In addition, candidate enhancers are cloned instead of synthesized, allowing the assay to test extended sequence contexts (&gt; 500 bp) for enhancer activity, which studies have shown to be critical for functional activity [<xref ref-type="bibr" rid="CR17">17</xref>]. Importantly, STARR-seq can be scaled to the whole-genome level for unbiased scanning of functional activities. However, scaling STARR-seq to the human genome is still very challenging, primarily due to its massive size. A more complex genomic DNA library, a higher sequencing depth, and increased transfection efficiency are required to cover the whole human genome [<xref ref-type="bibr" rid="CR16">16</xref>], which could ultimately introduce biases. Furthermore, inserting a large fragment of DNA into the 3′ UTR of the reporter gene could inadvertently introduce regulatory sequences that might affect mRNA abundance and stability, which could lead to both false positives and false negatives. MPRA is more robust in this regard because the activity of each candidate enhancer is quantified by multiple molecular barcodes associated with the fragment, making it less prone to such artifacts than STARR-seq. Generally, STARR-seq can be genome-wide and unbiased, but the technique is limited to sequences that already exist in the genome. Although MPRA is more limited in scale, it enables testing of multiple perturbed synthetic sequences in the same system.</p>
    <p id="Par6">The processing of STARR-seq data is somewhat similar to that of ChIP-seq, where protein-crosslinked DNA is immunoprecipitated and sequenced. A typical ChIP-seq processing pipeline identifies genomic regions over-represented by sequencing tags in a ChIP sample compared to a control sample. STARR-seq data is compatible with most ChIP-seq peak callers. Hence, previous studies on STARR-seq have largely relied on peak-calling software developed for ChIP-seq such as MACS2 [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>]. However, one must be cautious using ChIP-seq peak callers, at least without re-tuning the default parameters optimized for processing TF ChIP-seq [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    <p id="Par7">In this paper, we describe key differences in the processing of STARR-seq versus ChIP-seq data. Due to increased complexity of the genomic screening library and sequencing depth requirements, STARR-seq coverage is highly non-uniform. This leads to a lower signal-to-noise ratio than a typical ChIP-seq experiment and makes estimating the background model more challenging, which could ultimately lead to false-positive peaks. In addition, STARR-seq measures more of a continuous activity, similar to quantification in RNA-seq, than a discrete binding event. Therefore, STARR-seq peaks should be further evaluated using a notion of activity score. These differences necessitate a unique approach to processing STARR-seq data.</p>
    <p id="Par8">We propose an algorithm optimized for processing and identifying functionally active enhancers from STARR-seq data, which we call STARRPeaker. This approach statistically models the basal level of transcription, accounting for potential confounding factors, and accurately identifies reproducible enhancers. We applied our method to two whole human STARR-seq datasets and evaluated its performance against previous methods. We also compared an R package, BasicSTARRseq, developed to process peaks from the first STARR-seq data [<xref ref-type="bibr" rid="CR15">15</xref>], which models enrichment of sequencing reads using a binomial distribution. We benchmarked our peak calls against known human enhancers. Thus, our findings support that STARRPeaker will be a useful tool for uniformly processing STARR-seq data.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <sec id="Sec3">
      <title>Precise measurement of STARR-seq coverage</title>
      <p id="Par9">We binned the genome using a sliding window of length, <italic>l</italic>, and step size, <italic>s</italic>. Based on the average size of the STARR-seq library, we defined a 500-bp window length with a 100-bp step size to be the default parameter. Based on the generated genomic bins, we calculated the coverage of both STARR-seq input and output mapped to each bin. For calculating the sequence coverage, other peak callers and many visualization tools commonly use the start position of the read [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. However, given that the average size of the fragments inserted into the STARR-seq libraries were approximately 500 bp, we expected that the read coverage using the read start position may shift the estimate of the summit of signal and dilute the enrichment. Some peak callers have used read densities of forward and reverse strands separately to overcome this issue [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. To precisely measure the coverage of STARR-seq input and output, we first inferred the size of the fragment insert from paired-end reads and used the center of the fragment insert, instead of start position of the read, to calculate coverage. For inferring the size of the fragment insert, we first strictly filtered out reads that were not properly paired and chimeric. Chimeric alignments are reads that cannot be linearly aligned to a reference genome, implying a potential discrepancy between the sequenced genome and the reference genome and indicative of a structural variation or a PCR artifact [<xref ref-type="bibr" rid="CR25">25</xref>]. We also filtered out read pairs that had a fragment insert size greater than <italic>l</italic><sub>max</sub> and less than <italic>l</italic><sub>min</sub>. By default, we filtered out fragment insert sizes less than 200 bp and greater than 1000 bp. After filtering out spurious read pairs, we estimated the center of the fragment insert and counted the fragment depth for each genomic bin. To assess the benefit of using fragment-based coverage, we compared the coverage calculated using the center of fragment insert to an alternate model using the start position of the sequencing read. We found that the position of the peaks shifted up approximately 200 bp when we used the alternate model (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1A). Such a shift caused by the read-based coverage could lead to the omission of TF binding sites located at the boundary. Moreover, we observed that the read-based coverage diluted the overall STARR-seq signal; as a result, peaks calculated based on the alternate model had lower fold enrichment (ratio of STARR-seq output to input) and were less confident (based on statistical significance of the identified peaks) and broader in size (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b–d, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1B-D). Overall, the fragment-based coverage offered a more accurate representation of the STARR-seq readout compared to the read-based coverage counting scheme. We illustrated the benefits of using the center of the fragment in Fig. <xref rid="Fig1" ref-type="fig">1</xref>e, which compares the average size of peaks and fold enrichments using alternate coverage counting methods.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Comparison of STARR-seq output coverage calculated using the center of the fragment to using the start position of the sequencing read. <bold>a</bold> Distribution of the shift in final peak locations resulting from using two alternative coverage counting schemes in HepG2. Comparison of <bold>b</bold> overall fold enrichment level, <bold>c</bold>
<italic>P</italic> value, and <bold>d</bold> size of resulting peaks. <bold>e</bold> Example highlighting the difference between fragment-based and read-based coverage counting schemes and their resulting peak calls from HepG2 STARR-seq data. Asterisks represents statistical significance using the Mann-Whitney-Wilcoxon test two-sided with Bonferroni correction; *<italic>P</italic> ≤ 0.05, **<italic>P</italic> ≤ 0.01, ***<italic>P</italic> ≤ 0.001, ****<italic>P</italic> ≤ 0.0001</p></caption><graphic xlink:href="13059_2020_2194_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Controlling for potential systemic bias in the STARR-seq assay</title>
      <p id="Par10">To unbiasedly test for the regulatory activity, a model needs to control for potential systemic biases inherent to generating STARR-seq data. STARR-seq measures the ratio of transcribed RNA to DNA for a given test region and determines whether the test region can facilitate transcription at a higher rate than the basal level. This is based on the assumption that (1) the basal transcriptional level stays relatively constant across the genome and (2) the transcriptional rate is a reflection of the regulatory activity of the DNA insert. However, these assumptions may not always be true, and one needs to consider potential systemic biases that can interfere with the quantification of regulatory activity when analyzing the data.</p>
      <p id="Par11">We next tested whether potential sequencing biases and other covariates confounded STARR-seq readouts (Fig. <xref rid="Fig2" ref-type="fig">2</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). We found that STARR-seq RNA coverage was significantly correlated with GC content (PCC 0.61; <italic>P</italic> value 1E−299) and mappability (PCC 0.45; <italic>P</italic> value 2.9E−148). This could be attributed to intrinsic sequencing biases in library preparation. A genome-wide reporter library is made from randomly sheared genomic DNA, but DNA fragmentation is often non-random [<xref ref-type="bibr" rid="CR26">26</xref>]. Studies also have suggested that epigenetic mechanisms and CpG methylation may influence fragmentation [<xref ref-type="bibr" rid="CR27">27</xref>]. Furthermore, the isolated polyadenylated RNAs are reverse transcribed and PCR-amplified before sequencing, and this process can further confound the sequenced candidate fragments.
<fig id="Fig2"><label>Fig. 2</label><caption><p>Confounding factors in the STARR-seq assay. STARR-seq output and input coverages are significantly correlated with <bold>a</bold> input coverage, <bold>b</bold> GC content, <bold>c</bold> mappability, and <bold>d</bold> RNA structure folding. PCC: Pearson correlation coefficient. Plots were from a sampling of 5000 random genomic bins. The HepG2 dataset was used for the plot</p></caption><graphic xlink:href="13059_2020_2194_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par12">Notably, we found that STARR-seq coverage was also significantly confounded by RNA thermodynamic stability (PCC − 0.55; <italic>P</italic> value 0). Unlike ChIP-seq, where both the experiment and input controls derive from the same DNA origin, STARR-seq experiments measure the regulatory potential from the abundance of transcribed RNA, which adds a layer of complexity. For example, RNA structure and co-transcriptional folding might potentially influence the readout of STARR-seq experiments [<xref ref-type="bibr" rid="CR28">28</xref>]. Single-stranded RNA starts to fold upon transcription and the resulting RNA structure might influence the measurement of regulatory activity. Previously, researchers suggested a potential linkage between RNA secondary structure and transcriptional regulation [<xref ref-type="bibr" rid="CR29">29</xref>]. In addition, the resulting transcribed RNA undergoes a series of post-transcriptional regulation, and RNA stability might play a critical role. Moreover, previous reports have shown that the degradation rates—the main determinant of cellular RNA levels [<xref ref-type="bibr" rid="CR30">30</xref>]—vary significantly across the genome and that RNA stability correlates with functionality [<xref ref-type="bibr" rid="CR31">31</xref>, <xref ref-type="bibr" rid="CR32">32</xref>].</p>
      <p id="Par13">Based on these findings, we built a regression-based model that accounts for various confounding variables of test sequence fragments to unbiasedly identify potential enhancer regions from STARR-seq data. Note that many of the covariates have appreciable correlation with each other. However, we did find, using stepwise forward selection, that each of them contributes substantially and independently to the model fit as assessed by Akaike information criterion (AIC) and Bayesian information criterion (BIC) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3).</p>
    </sec>
    <sec id="Sec5">
      <title>Accurate modeling of STARR-seq using negative binomial regression</title>
      <p id="Par14">To model the fragment coverage data from STARR-seq using discrete probability distribution, we assumed that each genomic bin is independent and identically distributed, as specified in the Bernoulli trials [<xref ref-type="bibr" rid="CR33">33</xref>]. That is, each test fragment can only map to a single fixed-length bin. Therefore, we only considered a non-overlapping subset of bins for modeling and fitting the distribution. We also excluded bins not covered by any genomic input or those in which the normalized input coverage was less than a minimum quantile <italic>t</italic><sub>min</sub>, since these regions do not have sufficient power to detect enrichment. We selected the bin size and the minimum coverage based on the experimental design of STARR-seq. We simulated and fit various discrete probability distributions to STARR-seq output coverage. We observed that the STARR-seq output coverage data was overdispersed and fit the best with a negative binomial distribution (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). Moreover, a Q-Q plot of expected coverage against observed coverage further demonstrated that the negative binomial model provides the best fit for the STARR-seq readout (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). To demonstrate the generalizability of the method and assumptions, we tested the model fit against previously published datasets that utilized different STARR-seq protocols (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4). We observed consistent properties of the STARR-seq data across the different STARR-seq protocols and datasets.
<fig id="Fig3"><label>Fig. 3</label><caption><p>STARR-seq output coverage is fit against simulated coverage using three distribution models; negative binomial, binomial, and Poisson. <bold>a</bold> Density histogram of simulated distribution against STARR-seq output coverage. <bold>b</bold> Q-Q plot of simulated distribution against STARR-seq output coverage. The red solid line represents where the observed count equals the expected count</p></caption><graphic xlink:href="13059_2020_2194_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par15">In principle, we can also detect negative enrichments in the STARR-seq output coverage, suggesting that some candidate fragments can repress the basal transcriptional activity. However, these regions may contain sequences that can destabilize mRNAs. In addition, additional experiments are necessary to demonstrate that STARR-seq can reliably detect silencers. Therefore, we focus on positive enrichments in this study, and we defer to a systemic method specifically designed for identifying silencers for this task [<xref ref-type="bibr" rid="CR34">34</xref>].</p>
    </sec>
    <sec id="Sec6">
      <title>Peak-calling algorithm</title>
      <p id="Par16">To accurately model the ratio of STARR-seq output fragment coverage (RNA) to input fragment coverage (DNA) while controlling for potential confounding factors, we applied a negative binomial regression. The overview of our model is outlined in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. Our model starts by fitting an analytical distribution to the observed fragment coverage across fixed non-overlapping genomic bins. In doing so, we use covariates to model expected counts in the form of multiple regression. Subsequently, once a model is fit, we evaluate the likelihood of obtaining the observed fragment counts and assign <italic>P</italic> values using the null negative binomial distribution. In this testing phase, we use flexible genomic bins with a sliding window in order to find enrichment peaks at a higher resolution. Genomic bins with significant enrichments are selected based on their adjusted <italic>P</italic> values using multiple testing correction. Finally, peak locations are fine-tuned to the summit of the direct fragment coverage. Note that the adjusted <italic>P</italic> value only refers to the unlikelihood of a candidate region being an enhancer by chance while the fold enrichment can be directly interpreted as a quantitative measure of enhancer activity.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Overview of STARRPeaker peak-calling scheme. <bold>a</bold> In contrast to using read depth (gray), fragment depth (red) offers more precise and sharper STARR-seq output coverage. Fragment inserts are directly inferred from properly paired reads. <bold>b</bold> Workflow of STARRPeaker describing how coverage is calculated for each genomic bin and modeled using a negative binomial regression model. The analysis pipeline can largely be divided into four steps: (1) binning the genome; (2) calculating coverage and computing covariate matrix; (3) fitting the STARR-seq data to the NB regression model; and (4) peak calling, multiple hypothesis testing correction, and adjustment of the center of peaks</p></caption><graphic xlink:href="13059_2020_2194_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par17">Let <italic>Y</italic> be a vector of STARR-seq output (RNA) coverage, then <italic>y</italic><sub><italic>i</italic></sub> for 1 ≤ <italic>i</italic> ≤ <italic>n</italic> denotes the number of RNA fragments from a STARR-seq experiment mapped to the <italic>i</italic>th bin from the total of <italic>n</italic> genomic bins. Let <italic>t</italic><sub><italic>i</italic></sub> be the number of input library fragments (DNA) mapped to the <italic>i</italic>th bin. We define <italic>X</italic> to be the matrix of covariates, where <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overrightarrow{x_i} $$\end{document}</tex-math><mml:math id="M2" display="inline"><mml:mover accent="true"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2020_2194_Article_IEq1.gif"/></alternatives></inline-formula> is the vector of covariates corresponding to the <italic>i</italic>th bin and <italic>x</italic><sub><italic>ij</italic></sub> is the <italic>j</italic>th covariate for the <italic>i</italic>th bin.</p>
      <sec id="Sec7">
        <title>Negative binomial distribution</title>
        <p id="Par18">A negative binomial distribution, which arises from a Gamma-Poisson mixture, can be parameterized as follows [<xref ref-type="bibr" rid="CR35">35</xref>–<xref ref-type="bibr" rid="CR37">37</xref>] (see “<xref rid="Sec19" ref-type="sec">Methods</xref>” for derivation).</p>
        <p id="Par19">
          <disp-formula id="Equ1">
            <label>1</label>
            <alternatives>
              <tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {f}_Y\left({y}_i|{\mu}_i,\theta \right)=\frac{\Gamma \left({y}_i+\theta \right)}{\Gamma \left({y}_i+1\right)\bullet \Gamma \left(\theta \right)}\bullet {\left(\frac{\theta }{\theta +{\mu}_i}\right)}^{\theta}\bullet {\left(\frac{\mu_i}{\theta +{\mu}_i}\right)}^{y_i} $$\end{document}</tex-math>
              <mml:math id="M4" display="block">
                <mml:msub>
                  <mml:mi>f</mml:mi>
                  <mml:mi>Y</mml:mi>
                </mml:msub>
                <mml:mfenced close=")" open="(" separators="|,">
                  <mml:msub>
                    <mml:mi>y</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:msub>
                    <mml:mi>μ</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mi>θ</mml:mi>
                </mml:mfenced>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">Γ</mml:mi>
                    <mml:mfenced close=")" open="(">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">Γ</mml:mi>
                    <mml:mfenced close=")" open="(">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:mfenced>
                    <mml:mo>∙</mml:mo>
                    <mml:mi mathvariant="normal">Γ</mml:mi>
                    <mml:mfenced close=")" open="(">
                      <mml:mi>θ</mml:mi>
                    </mml:mfenced>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>∙</mml:mo>
                <mml:msup>
                  <mml:mfenced close=")" open="(">
                    <mml:mfrac>
                      <mml:mi>θ</mml:mi>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>μ</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mfenced>
                  <mml:mi>θ</mml:mi>
                </mml:msup>
                <mml:mo>∙</mml:mo>
                <mml:msup>
                  <mml:mfenced close=")" open="(">
                    <mml:mfrac>
                      <mml:msub>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mi>θ</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mi>μ</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mfenced>
                  <mml:msub>
                    <mml:mi>y</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                </mml:msup>
              </mml:math>
              <graphic xlink:href="13059_2020_2194_Article_Equ1.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p id="Par20">A negative binomial is a generalization of a Poisson regression that allows the variance to be different from the mean, shaped by the dispersion parameter <italic>θ</italic>. There are two alternative forms of parameterization for a negative binomial—NB1 and NB2—which were first introduced by Cameron and Trivedi [<xref ref-type="bibr" rid="CR36">36</xref>]. The difference between NB1 and NB2 is in the conditional variance of <italic>y</italic><sub><italic>i</italic></sub>. Assuming <italic>y</italic><sub><italic>i</italic></sub> has mean <italic>λ</italic><sub><italic>i</italic></sub>, the general variance function follows the form <italic>ω</italic><sub><italic>i</italic></sub> = <italic>λ</italic><sub><italic>i</italic></sub> + <italic>αλ</italic><sub><italic>i</italic></sub><sup><italic>p</italic></sup>, where <italic>α</italic> is a scalar parameter. NB1 uses <italic>p</italic> = 1, whereas NB2 uses the quadratic form of variance with <italic>p</italic> = 2. We use the most common implementation of the negative binomial, NB2, hereafter. The variance for the NB2 model is given as</p>
        <p id="Par21">
          <disp-formula id="Equ2">
            <label>2</label>
            <alternatives>
              <tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\sigma}^2=\mu +\frac{\mu^2}{\theta } $$\end{document}</tex-math>
              <mml:math id="M6" display="block">
                <mml:msup>
                  <mml:mi>σ</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:msup>
                <mml:mo>=</mml:mo>
                <mml:mi>μ</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mfrac>
                  <mml:msup>
                    <mml:mi>μ</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                  <mml:mi>θ</mml:mi>
                </mml:mfrac>
              </mml:math>
              <graphic xlink:href="13059_2020_2194_Article_Equ2.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p id="Par22">We assume that the majority of genomic bins will have a basal level of transcription, the expected fragment counts at each <italic>i</italic>th bin, <italic>E</italic>(<italic>y</italic><sub><italic>i</italic></sub>), represents the mean incidence, <italic>μ</italic><sub><italic>i</italic></sub>, and the count of RNA fragments <italic>Y</italic> follows the traditional negative binomial (NB2) distribution.
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{c}E\left({y}_i\right)={\mu}_i\\ {}Y\sim \mathrm{NB}\left(\mu, \theta \right)\end{array}} $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mtable columnalign="center" displaystyle="true"><mml:mtr><mml:mtd><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>Y</mml:mi><mml:mo>∼</mml:mo><mml:mi>NB</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mi>μ</mml:mi><mml:mi>θ</mml:mi></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="13059_2020_2194_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
      </sec>
      <sec id="Sec8">
        <title>Negative binomial regression model</title>
        <p id="Par23">The regression term for the expected RNA fragment count can be expressed in terms of a linear combination of explanatory variables, a set of <italic>m</italic> covariates (<inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overrightarrow{x} $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2020_2194_Article_IEq2.gif"/></alternatives></inline-formula>). We use the input library variable <italic>t</italic><sub><italic>i</italic></sub> as one covariate. For simplicity, we denote <italic>t</italic><sub><italic>i</italic></sub> as <italic>x</italic><sub>0<italic>i</italic></sub> hereafter.
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{c}\ln {\mu}_i={\beta}_0{x}_{0i}+{\beta}_1{x}_{1i}+\cdots +{\beta}_m{x}_{mi}\\ {}{\mu}_i=\exp \left({\beta}_0{x}_{0i}+{\beta}_1{x}_{1i}+\cdots {\beta}_m{x}_{mi}\right)\\ {}{\mu}_i=\exp \left({\overrightarrow{x}}_i^{\intercal}\beta \right)\end{array}} $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mi>ln</mml:mi><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>⋯</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>⊺</mml:mo></mml:mrow></mml:msubsup><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:mrow></mml:math><graphic xlink:href="13059_2020_2194_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par24">Alternatively, instead of using the input library variable <italic>t</italic><sub><italic>i</italic></sub> as one covariate, we can directly use it as an offset variable. Generally, a fractional observation cannot be modeled using discrete probability. However, an offset variable in a generalized linear model can be used to correct the response term to behave like a fraction. One advantage of using the input variable as an “exposure” to the RNA output coverage is that it allows us to directly model the basal transcription rate (the ratio of RNA to DNA) as a rate response variable. This mode could be beneficial in multiple scenarios. First, for a STARR-seq dataset in which the guide DNA library only contains discrete elements, direct modeling of the basal transcription rate would provide a more accurate measure of activity, especially in the absence of readouts from adjacent regions. Second, if a user ignores the effect of covariate, this mode simplifies the model and provides peaks purely based on the ratio of RNA to DNA. More details on this alternative parameterization are included in the “<xref rid="Sec19" ref-type="sec">Methods</xref>” section. In our STARRPeaker model, we used four covariates; fragment coverage of input genomic libraries, GC content, mappability, and the thermodynamic stability of genomic libraries.</p>
      </sec>
      <sec id="Sec9">
        <title>Maximum likelihood estimation</title>
        <p id="Par25">We fit the model and estimate regression coefficients using the maximum likelihood method, where log-likelihood function is shown as follows.
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathcal{L}}_{\mathrm{NB}}\left(\mu |y,\theta \right)=\sum \limits_{i=1}^n{y}_i\ln \left(\frac{\mu_i}{\theta +{\mu}_i}\right)+\theta \ln \left(\frac{\theta }{\theta +{\mu}_i}\right)+\ln \left(\frac{\Gamma \left({y}_i+\theta \right)}{\Gamma \left({y}_i+1\right)\bullet \Gamma \left(\theta \right)}\right) $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>NB</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators="|"><mml:mi>μ</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mi>θ</mml:mi><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>θ</mml:mi><mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>∙</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>θ</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mfenced></mml:math><graphic xlink:href="13059_2020_2194_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par26">Substituting <italic>μ</italic><sub><italic>i</italic></sub> with the regression term, the log-likelihood function can be parameterized in terms of regression coefficients, <italic>β</italic>.
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathcal{L}}_{\mathrm{NB}}\left(\beta |y,\theta \right)=\sum \limits_{i=1}^n{y}_i\ln \left(\frac{{\mathrm{e}}^{{\overrightarrow{x_i}}^{\intercal}\beta }}{\theta +{\mathrm{e}}^{{\overrightarrow{x_i}}^{\intercal}\beta }}\right)+\theta \ln \left(\frac{\theta }{\theta +{\mathrm{e}}^{{\overrightarrow{x_i}}^{\intercal}\beta }}\right)+\ln \left(\frac{\Gamma \left({y}_i+\theta \right)}{\Gamma \left({y}_i+1\right)\bullet \Gamma \left(\theta \right)}\right) $$\end{document}</tex-math><mml:math id="M16" display="block"><mml:msub><mml:mi mathvariant="script">L</mml:mi><mml:mi>NB</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators="|"><mml:mi>β</mml:mi><mml:mrow><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:msup><mml:mover accent="true"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>⊺</mml:mo></mml:msup><mml:mi>β</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:msup><mml:mover accent="true"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>⊺</mml:mo></mml:msup><mml:mi>β</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mi>θ</mml:mi><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>θ</mml:mi><mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="normal">e</mml:mi><mml:mrow><mml:msup><mml:mover accent="true"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">→</mml:mo></mml:mover><mml:mo>⊺</mml:mo></mml:msup><mml:mi>β</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>+</mml:mo><mml:mo>ln</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>∙</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>θ</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mfenced></mml:math><graphic xlink:href="13059_2020_2194_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par27">We can determine the maximum likelihood estimates of the model parameters by setting the first derivative of the log-likelihood with respect to <italic>β</italic>, the gradient, to zero, and there is no analytical solution for <italic>β</italic>. Numerically, we iteratively solve for the regression coefficients <italic>β</italic> and the dispersion parameter <italic>θ</italic>, alternatively, until both parameters converge.</p>
      </sec>
      <sec id="Sec10">
        <title>Estimation of <italic>P</italic> value</title>
        <p id="Par28">The <italic>P</italic> value is defined as the probability of observing equal or more extreme value than the observed value at the <italic>i</italic>th bin, <italic>y</italic><sub><italic>i</italic></sub>, under the null hypothesis.</p>
        <p id="Par29">
          <disp-formula id="Equ7">
            <label>7</label>
            <alternatives>
              <tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ P\ {\mathrm{value}}_i=\Pr \left(Y\ge {y}_i|H\right) $$\end{document}</tex-math>
              <mml:math id="M18" display="block">
                <mml:mi>P</mml:mi>
                <mml:mspace width="0.25em"/>
                <mml:msub>
                  <mml:mtext>value</mml:mtext>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mo>Pr</mml:mo>
                <mml:mfenced close=")" open="(" separators="|">
                  <mml:mrow>
                    <mml:mi>Y</mml:mi>
                    <mml:mo>≥</mml:mo>
                    <mml:msub>
                      <mml:mi>y</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mi>H</mml:mi>
                </mml:mfenced>
              </mml:math>
              <graphic xlink:href="13059_2020_2194_Article_Equ7.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p id="Par30">As defined earlier, we assume the random variable Y comes from a negative binomial distribution with the fit mean at the <italic>i</italic>th bin, <italic>μ</italic><sub><italic>i</italic></sub>, as the expected value, and <italic>θ</italic> as the dispersion parameter. Then, we can estimate the <italic>P</italic> value from the cumulative distribution function CDF, which is the sum of the probability mass function <italic>f</italic><sub><italic>Y</italic></sub> from 0 to <italic>y</italic><sub><italic>i</italic></sub> − 1.</p>
        <p id="Par31">
          <disp-formula id="Equ8">
            <label>8</label>
            <alternatives>
              <tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \Pr \left(Y\ge {y}_i\left|H\right.\right)=1- CDF\left({y}_i-1\right)=1-\sum \limits_{k=0}^{y_i-1}{f}_Y\left(k\left|{\mu}_{i,}\theta \right.\right) $$\end{document}</tex-math>
              <mml:math id="M20" display="block">
                <mml:mo>Pr</mml:mo>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mi>Y</mml:mi>
                    <mml:mo>≥</mml:mo>
                    <mml:msub>
                      <mml:mi>y</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mfenced open="|">
                      <mml:mi>H</mml:mi>
                    </mml:mfenced>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>−</mml:mo>
                <mml:mi mathvariant="italic">CDF</mml:mi>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>y</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:mfenced>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>−</mml:mo>
                <mml:munderover>
                  <mml:mo movablelimits="false">∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>y</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:munderover>
                <mml:msub>
                  <mml:mi>f</mml:mi>
                  <mml:mi>Y</mml:mi>
                </mml:msub>
                <mml:mfenced close=")" open="(">
                  <mml:mrow>
                    <mml:mi>k</mml:mi>
                    <mml:mfenced open="|">
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>μ</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mrow>
                </mml:mfenced>
              </mml:math>
              <graphic xlink:href="13059_2020_2194_Article_Equ8.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p id="Par32">Substituting (1) gives
<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ P\ {\mathrm{value}}_i=1-\sum \limits_{k=0}^{y_i-1}\frac{\Gamma \left(k+\theta \right)}{\Gamma \left(k+1\right)\cdot \Gamma \left(\theta \right)}\cdot {\left(\frac{\theta }{\theta +{\mu}_i}\right)}^{\theta}\cdot {\left(\frac{\mu_i}{\theta +{\mu}_i}\right)}^k $$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mi>P</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mtext>value</mml:mtext><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>⋅</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>θ</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>θ</mml:mi><mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mi>θ</mml:mi></mml:msup><mml:mo>⋅</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mi>k</mml:mi></mml:msup></mml:math><graphic xlink:href="13059_2020_2194_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par33">Finally, we calculate the false discovery rate using the Benjamini and Hochberg method [<xref ref-type="bibr" rid="CR38">38</xref>].</p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Application of STARRPeaker</title>
      <p id="Par34">We applied STARRPeaker to two whole human genome STARR-seq experiments, K562 and HepG2, utilizing origin of replication (ORI)-based plasmids [<xref ref-type="bibr" rid="CR39">39</xref>]. Based on peaks identified from these datasets, we evaluated the quality and characteristics of the identified enhancers as well as the performance of the peak caller by comparing to external enhancer resources.</p>
      <sec id="Sec12">
        <title>Initial evaluation of STARRPeaker enhancers</title>
        <p id="Par35">Our model assumes that most genomic regions have a basal level of transcription activity. To validate that our model is well calibrated under this assumption, we examined the <italic>P</italic> value distribution against a theoretical uniform distribution. As expected, most observed <italic>P</italic> values followed the null distribution, and the <italic>P</italic> values only deviated from expectation for very low values (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5).</p>
        <p id="Par36">We processed two biological replicates from each cell type independently and assessed the correlation between each pair (see “<xref rid="Sec19" ref-type="sec">Methods</xref>” for detail). We identified 50,389 and 52,927 candidate enhancers from HepG2 replicates 1 and 2, and by consolidating peaks from both replicates, we identified 32,929 (65.3% of rep 1; 62.2% of rep2) reproducible candidate enhancers from the HepG2 cell line. Similarly, by consolidating 30,194 and 41,810 candidate enhancers from K562 replicates 1 and 2, we identified 20,471 (67.8% of rep 1; 49.0% of rep 2) reproducible candidate enhancers from the K562 cell line (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1). Overall, we observed high correlation of RNA fragment coverage between two replicates (PCC = 0.99 for both HepG2 and K562; see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6). This result indicates the correlation is dominated by negatives. Although the total number of peaks varied between HepG2 and K562, we observed a comparable number of peaks within the accessible region of the genome. We found 12,019 (36.5%) and 11,420 (55.8%) candidate enhancers from HepG2 and K562, respectively, within the open chromatin defined by ENCODE DNase-seq hotspots. Consistent with previous findings [<xref ref-type="bibr" rid="CR39">39</xref>], a substantial fraction of candidate enhancers was epigenetically silenced at the chromatin level. However, as demonstrated previously using a histone deacetylase inhibitor (HDAC) [<xref ref-type="bibr" rid="CR16">16</xref>], these poised enhancers can become functional under a more transcriptionally permissive environment. Therefore, episomal reporter assays like STARR-seq have the unique advantage of detecting potential enhancer activity independent from chromatin context. We would like to note that it is important to identify poised enhancers located in heterochromatic regions of the genome, which could become functional during developmental or pathological time courses.</p>
      </sec>
      <sec id="Sec13">
        <title>Assessment of robustness and reproducibility of the method</title>
        <p id="Par37">A reliable peak-calling method allows one to identify stable peaks from suboptimal datasets. To evaluate the robustness of the STARRPeaker method, we generated random subsets of HepG2 whole-genome STARR-seq library after aligning the reads and compared the quality of the peak calls. We subsampled randomly at various rates from 20 to 80% of the total dataset. We found that STARRPeaker was able to reliably identify approximately 90% of the candidate enhancers (consolidated) using 80% of the original sequencing library and 80% of the candidate enhancers using 40% of the original sequencing library (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7A). When we focused on strong enhancer candidates, approximately 98% of the top 5000 enhancers were recovered using only 60% of the original sequencing library (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7B). However, the quality of the peak calls started to deteriorate when 40% or less were used.</p>
      </sec>
      <sec id="Sec14">
        <title>Evaluation of potential orientation bias in candidate enhancers</title>
        <p id="Par38">In general, enhancers are thought to function independent of orientation [<xref ref-type="bibr" rid="CR40">40</xref>]. However, the fragment counts in one orientation could be skewed over the other due to orientation-specific activities, PCR, or sequencing artifacts. To test for potential orientation-based biases, we ran a series of binomial tests on the candidate enhancers we identified and evaluated for possible orientation-specific activities (see “<xref rid="Sec19" ref-type="sec">Methods</xref>”). We observed a small fraction of candidate enhancers showing orientation bias [2.58% for HepG2 (<italic>n</italic> = 850); 4.49% for K562 (<italic>n</italic> = 919); FDR ≤ 0.01] in both replicates (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8). Furthermore, only a few candidates showed extreme bias [<italic>n</italic> = 3 for HepG2; <italic>n</italic> = 4 for K562; &gt; 90% fragments on one strand]. Thus, true orientation-dependent activities are unlikely in our STARR-seq data, but that the orientation may have an effect on the efficiency. These findings provide further support that enhancers function independent of orientation.</p>
      </sec>
      <sec id="Sec15">
        <title>Performance comparison to other peak-calling algorithms</title>
        <p id="Par39">We evaluated the performance of STARRPeaker by comparing it to previously used alternative methods, namely BasicSTARRseq and MACS2.</p>
        <p id="Par40">First, we qualitatively assessed the peak-calling algorithms using a simulated dataset where the ground truth exists. The simulation was primarily designed for positives in the dataset, and as a result, it emphasizes the sensitivity (as opposed to specificity) of each method. We created an artificial STARR-seq dataset that contains 28 spike-in controls; a hybrid of DNA input and RNA output libraries with active elements at pre-defined loci (Additional file <xref rid="MOESM7" ref-type="media">7</xref>: Table S6; see “<xref rid="Sec19" ref-type="sec">Methods</xref>” for details). All three methods successfully identified peaks at 28 control regions (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9). However, we noticed that BasicSTARRseq peaks were fragmented and off-centered from the controls due to its limitations of fixed peak size and read-based coverage calculation. As a result, several false-positive peaks were called adjacent to the controls. We calculated the sensitivity and specificity of each method using 28 controls as the gold standard (Additional file <xref rid="MOESM8" ref-type="media">8</xref>: Table S7). We considered a result positive if at least 80% of the peak overlapped with the control, and we assumed the presence of approximately 1000 true negative regions. Both STARRPeaker and MACS2 had 100% sensitivity and specificity, whereas BasicSTARRseq had 75% sensitivity and 94.9% specificity.</p>
        <p id="Par41">Second, we quantitatively assessed the peak-calling algorithms using the whole human genome STARR-seq dataset. After uniformly calling peaks from each method using the recommended default settings, we evaluated the quality of the candidate enhancers identified. We found that both BasicSTARRseq and MACS2 called significantly more peaks (4- to 20-fold higher) than STARRPeaker (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S4). While it is uncertain how many true enhancers were present in each sample, we had to ensure that we make a fair comparison across different methods due to the tradeoff between sensitivity and specificity. An increase in sensitivity is generally achieved at the expense of a decrease in specificity, as described in receiver operating characteristic curves. In our context, a method having higher specificity suffers from having less overlap with open chromatin and previously identified enhancers from other assays. Suppose each method is generating a set of randomized peaks, then the method with the greater number of peaks is likely to have more overlap solely by chance. To eliminate this artifact, we used a uniform <italic>P</italic> value threshold of 0.001 and subsampled the peaks down to the same number before the comparison. After uniformly processing the dataset using each method, we measured the level of epigenetic profile enrichment around the peaks. We observed higher enrichment of DNase-hypersensitive sites, as well as more distinct double-peak patterns of H3K27ac and H3K4me1, using STARRPeaker compared to BasicSTARRseq or MACS2 (Fig. <xref rid="Fig5" ref-type="fig">5</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10). Furthermore, STARRPeaker peaks had significantly higher enrichment of TF binding events (based on the number of TF ChIP-seq binding sites) compared to the peaks identified using other methods.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Enrichment of epigenetic signals around peaks in HepG2. All peaks were centered at the summit, uniformly thresholded using <italic>P</italic> value &lt; 0.001, and 10,000 peaks were randomly selected. Aggregated read depth at 2000 bp upstream and downstream were plotted for <bold>a</bold> DNase I hypersensitive sites (DHS), <bold>b</bold> H3K27ac, <bold>c</bold> H3K4me1, and <bold>d</bold> aggregated TF ChIP-seq profile. For DNase-seq, enrichment indicates unique read depth. For histone ChIP-seq, enrichment indicates fold change over control. For TF ChIP-seq aggregate, enrichment indicates the number of TFs binding</p></caption><graphic xlink:href="13059_2020_2194_Fig5_HTML" id="MO5"/></fig></p>
      </sec>
      <sec id="Sec16">
        <title>Comparison to previously characterized enhancers</title>
        <p id="Par42">First, we compared the peaks identified by STARRPeaker to previously characterized enhancers from HepG2 or K562 cell lines by CAGE [<xref ref-type="bibr" rid="CR41">41</xref>], MPRA [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR42">42</xref>], and STARR-seq [<xref ref-type="bibr" rid="CR19">19</xref>] (Fig. <xref rid="Fig6" ref-type="fig">6</xref>, Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2). Since most of the previous enhancer assays were not at a genome-wide scale and were limited in scope to specific loci, we focused on how many previously characterized enhancers were recovered using different methods. Overall, we observed a higher fraction of STARRPeaker peaks overlapping with external datasets compare to other methods. Moreover, we found higher overlaps when peaks from both replicates were merged, due to fewer but more precise candidate enhancers from merging replicates. However, we noticed reduced agreement across different types of enhancer assays. Low overlap between assays may arise from different formats or layouts of reporter plasmids, such as differing enhancer cloning sites or promoters, or differences in the complexity of the screening library. Furthermore, CAGE is an entirely different assay from episomal reporter assays like MPRA and STARR-seq, with enhancers defined based on bidirectional transcripts originating from an eRNA.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Comparison of peaks using an external dataset for <bold>a</bold> HepG2 or <bold>b</bold> K562 cell lines. Peaks identified from STARRPeaker as well as BasicSTARRseq and MACS2 were compared against a published dataset. For a fair comparison, all peaks were centered at the summit, uniformly thresholded using <italic>P</italic> value &lt; 0.001, and 20,000 peaks were randomly drawn from peaks identified by each peak caller using the recommended settings. The fraction of overlap was computed for each replicate. We used the total number of peaks in each dataset as the denominator. We considered it an overlap when at least 50% of peaks intersected each other</p></caption><graphic xlink:href="13059_2020_2194_Fig6_HTML" id="MO6"/></fig></p>
        <p id="Par43">Second, we examined the nine distal enhancers from the GATA1 and MYC loci characterized in depth by a CRISPRi tiling screen [<xref ref-type="bibr" rid="CR43">43</xref>]. Using the nine enhancers as the ground truth and assuming there are approximately 1300 potential negative elements in the span of a 1.3-Mb genomic sequence, we performed sensitivity and specificity analyses of three competing methods. We think this is a substantial dataset to benchmark the performance as it provides an orthogonal line of evidence for true in vivo enhancers and highlights that the most genomic regions are dominated by negatives. As speculated, we found that STARRPeaker had the highest specificity. While both BasicSTARRseq and MACS2 identified a few more enhancers, their false-positive rate was much higher than that of STARRPeaker (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S11, Additional file <xref rid="MOESM9" ref-type="media">9</xref>: Table S8). Furthermore, upon close examination of three enhancers that were missed by STARRPeaker, we observed the coverage was much lower than other regions identified as enhancers.</p>
      </sec>
      <sec id="Sec17">
        <title>Application to external STARR-seq datasets</title>
        <p id="Par44">To ensure that STARRPeaker can be generally applied to different variants of STARR-seq assays, we tested STARRPeaker on previously published STARR-seq datasets.</p>
        <p id="Par45">First, we applied STARRPeaker to the whole-genome ORI-STARR-seq dataset on HeLa-S3 [<xref ref-type="bibr" rid="CR39">39</xref>] and assessed the quality of the peaks identified. Consistent with the previous claim that IFN-I signaling may induce false-positive enhancers, we identified more peaks in untreated HeLa-S3 samples (<italic>n</italic> = 28,381) compared to inhibitor-treated samples (<italic>n</italic> = 16,150). Furthermore, peaks from untreated samples had lower enrichment of chromatin accessibility (DNase-seq) than those from inhibitor-treated samples, supporting that TBK1/IKK/PKR inhibition reduces false-positive enhancer signals related to IFN-I signaling (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12A). Moreover, STARRPeaker recovered 77.5% (<italic>n</italic> = 7451) of published peaks, which were called using BasicSTARRseq and then further shortlisted using a stringent threshold (<italic>P</italic> value 1E−5 with corrected enrichment ≥ 4). When we compared the quality of STARRPeaker peaks (<italic>n</italic> = 16,150) to the published post hoc filtered peaks (<italic>n</italic> = 9610), we found that STARRPeaker peaks were highly enriched with chromatin accessibility signals despite having 6540 additional peaks from the same HeLa-S3 dataset (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12B). When we applied the same post hoc filtering approach to STARRPeaker peaks, the chromatin accessibility enrichment was further improved (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S12C).</p>
        <p id="Par46">Second, we tested if STARRPeaker can be reliably applied to captured STARR-seq datasets (Cap-STARR-seq). We applied STARRPeaker to a previously characterized GM12878 STARR-seq dataset based on an ATAC-seq-capture technique called HiDRA [<xref ref-type="bibr" rid="CR44">44</xref>] and compared its performance with published results. The HiDRA dataset was reported to have ~ 65,000 regions with enhancer function. In the STARRPeaker run, we identified 52,857 regions with significant enhancer activities from the five replicates they produced. Approximately half of STARRPeaker peaks overlapped with the published results (<italic>n</italic> = 26,318). While it is debatable to claim that one method is superior to the other, this result clearly demonstrates that STARRPeaker can be applied to the Cap-STARR-seq dataset.</p>
        <p id="Par47">Third, we further evaluated the performance of the peak-calling methods by applying STARRPeaker and two other peak-calling methods to another published Cap-STARR-seq dataset on K562 [<xref ref-type="bibr" rid="CR19">19</xref>]. The dataset covers approximately 91% of the surrounding 3 Mb of the MYC locus. Consistent with the earlier analysis, we observed that STARRPeaker is highly specific and identifies fewer candidate enhancers (<italic>n</italic> = 26) compared to the other methods (BasicSTARRseq <italic>n</italic> = 223; MACS2 <italic>n</italic> = 136). Furthermore, a four-way comparison (STARRPeaker, BasicSTARRseq, MACS2, and published peaks) showed that all of the STARRPeaker peaks overlapped with peaks from other methods but not the other way around (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S13). These results indicate that STARRPeaker is more robust and reliable at identifying reproducible candidate enhancers from various STARR-seq datasets than previous methods.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec18">
    <title>Conclusions</title>
    <p id="Par48">In summary, we developed a reliable peak-calling analysis pipeline named STARRPeaker that is optimized for large-scale STARR-seq experiments. To illustrate the utility of our method, we applied it to two whole human genome STARR-seq datasets from K562 and HepG2 cell lines, utilizing ORI-based plasmids.</p>
    <p id="Par49">STARRPeaker has several key improvements over previous approaches including (1) precise and efficient calculation of fragment coverage; (2) accurate modeling of the basal transcription rate using negative binomial regression; and (3) accounting for potential confounding factors, such as GC content, mappability, and the thermodynamic stability of genomic libraries. We demonstrate the superiority of our method over previously used peak callers, supported by strong enrichment of epigenetic marks relevant to enhancers and overlap with previously known enhancers.</p>
    <p id="Par50">To fully understand how noncoding regulatory elements can modulate transcriptional programs in human, STARR-seq active regions must be further characterized and validated within different cellular contexts. For example, recent applications of CRISPR-dCas9 to genome editing have allowed researchers to epigenetically perturb and test these elements in their native genomic context [<xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR46">46</xref>]. The next step for CRISPR-based functional screens is to overcome the current limitation of a small scale by leveraging barcodes and single-cell sequencing technology [<xref ref-type="bibr" rid="CR47">47</xref>]. In the meantime, we envision that the STARRPeaker framework could be utilized to detect and quantify enhancers at the whole-genome level, thereby aiding in prioritizing candidate regions in an unbiased fashion to maximize functional characterization efforts.</p>
  </sec>
  <sec id="Sec19">
    <title>Methods</title>
    <sec id="Sec20">
      <title>Cell culture</title>
      <p id="Par51">We cultured K562 cells (ATCC) in IMDM (Gibco #12440) supplemented with 10% fetal bovine serum (FBS) and 1% pen/strep and maintained in a humidified chamber at 37 °C with 5% CO<sub>2</sub>. We cultured HepG2 cells (ATCC) in EMEM (ATCC #30-2003) supplemented with 10% FBS and 1% pen/strep, maintained in a humidified chamber at 37 °C with 5% CO<sub>2</sub>.</p>
    </sec>
    <sec id="Sec21">
      <title>Generating an ORI-STARR-seq input plasmid library</title>
      <p id="Par52">We sonicated human male genomic DNA (Promega #G1471) using a Covaris S220 sonicator (duty factor, 5%; cycle per burst, 200; 40 s) and ran it on a 0.8% agarose gel to size-select 500-bp fragments. After gel purification using a MinElute Gel Extraction kit (Qiagen), we end-repaired, ligated custom adaptors, and PCR-amplified DNA fragments using Q5 Hot Start High-Fidelity DNA polymerase (NEB) (98 °C for 30 s; 10 cycles of 98 °C for 10 s, 65 °C for 30 s, and 72 °C for 30 s; 72 °C for 2 min) to add homology arms for Gibson assembly cloning.</p>
      <p id="Par53">We used AgeI-HF (NEB) and SalI-HF (NEB) to linearize the hSTARR-seq_ORI plasmid (gift from Alexander Stark; Addgene plasmid #99296) and cloned the PCR products into the vector using Gibson Assembly Master Mix (NEB); we set up 60 replicate reactions to maintain complexity. We purified the assembly reactions using SPRI beads (Beckman Coulter), dialyzed them using Slide-A-Lyzer MINI dialysis devices (Thermo Scientific), and concentrated them using an Amicon Ultra-0.5 device (Amicon). We transformed the reaction into MegaX DH10BTM T1 electrocompetent cells (Thermo Fisher Scientific) (with 25 replicate transformations to maintain complexity) and let them grow in 12.5-L LB-Amp medium until they reached an optical density of ~ 1.0. We extracted the plasmids using a Plasmid Gigaprep Kit (Qiagen) and dialyzed the plasmid prep using Slide-A-Lyzer MINI dialysis devices before electroporation.</p>
    </sec>
    <sec id="Sec22">
      <title>Electroporation-mediated transfection of ORI-STARR-seq input plasmid library into K562 and HepG2 cell lines</title>
      <p id="Par54">We electroporated the ORI-STARR-seq library using an AgilePulse Max (Harvard Apparatus) and generated two biological replicates for each cell line. For K562 cells, we electroporated 5.6 mg of input plasmid library into 700 million cells per biological replicate by delivering three 500-V pulses (1 ms duration with a 20-ms interval). For HepG2 cells, we electroporated 8 mg of input plasmid library into one billion cells in one replicate, and 5.6 mg into 700 million cells in another replicate by delivering three 300-V pulses (5 ms duration with a 20-ms interval).</p>
    </sec>
    <sec id="Sec23">
      <title>Generation of an Illumina sequencing library</title>
      <sec id="Sec24">
        <title>Output RNA library</title>
        <p id="Par55">We harvested cells 24 h after electroporation and extracted total RNA using an RNeasy Maxi kit (Qiagen). We further isolated polyA-plus mRNA using Dynabeads® Oligo (dT) kit (Thermo Fisher Scientific), treated it with TURBO DNase (Invitrogen), and purified the reaction using an RNeasy MinElute Kit (Qiagen). We synthesized cDNA using SuperScript III (Thermo Fisher Scientific) with a custom primer that specifically recognizes mRNAs that had been transcribed from the ORI-STARR-seq library. After reverse transcription, we treated the reactions with a cocktail of RNase A and RNase T1 (Thermo Fisher Scientific). We split cDNA samples into 160 replicate sub-reactions, and PCR-amplified each sub-reaction with a primer with a unique index (helping to identify PCR duplicates) using Q5 Hot Start High-Fidelity DNA polymerase (NEB) with the following program: 98 °C for 30 s; cycles of 98 °C for 10 s, 65 °C for 30 s, 72 °C for 30 s (until they reached mid-log amplification phase; we cycled 18 cycles for K562 Rep.1; 16 cycles for K562 Rep. 2; 18 cycles for HepG2 Rep. 1; and 15 cycles for HepG2 Rep2); 72 °C for 2 min). After PCR, we re-combined all sub-reactions into one and purified it with Agencourt Beads. We generated 100-bp paired-end reads for each biological replicate on an Illumina Hiseq4000 at the University of Chicago Genome Facility.</p>
      </sec>
      <sec id="Sec25">
        <title>Input DNA library</title>
        <p id="Par56">We PCR-amplified a total of 200 ng of input plasmid library (in 16 replicate reactions) using Q5 Hot Start High-Fidelity DNA polymerase (NEB) with the following program: 98 °C for 30 s; 4 cycles of 98 °C for 10 s, 65 °C for 30 s, and 72 °C for 20 s; 8 cycles of 98 °C for 10 s and 72 °C for 50 s; 72 °C for 2 min. After PCR, we combined all products into one and purified it with Agencourt Beads. We generated 100-bp paired-end reads on an Illumina Hiseq4000 at the University of Chicago Genome Facility.</p>
      </sec>
    </sec>
    <sec id="Sec26">
      <title>Sequencing and preprocessing</title>
      <p id="Par57">For each of 160 replicates, paired-end sequencing reads were aligned to the human reference genome GRCh38 downloaded from the ENCODE portal (ENCSR425FOI) using BWA-mem (v0.7.17). Alignments were filtered against unmapped, secondary alignments, mapping quality score less than 30, and PCR duplicates using SAMtools (v1.9) and Picard (v2.9.0). All of the replicates were pooled and sorted for downstream analysis.</p>
    </sec>
    <sec id="Sec27">
      <title>Fitting of distributions to the STARR-seq dataset</title>
      <p id="Par58">To build a statistical model that best describes the STARR-seq readout, we tested fitting of various univariate distributions to the output coverages of the STARR-seq dataset. To eliminate the influence of input coverage on output coverage, we subsampled bins with an input coverage value of 20 (approximately a median input coverage for both the HepG2 and K562 datasets) and used their output coverage values for the underlying observed distribution. We fit binomial, Poisson, and negative binomial distributions and estimated parameters using MLE. For binomial distributions, we assumed the number of the trial as the sum of the STARR-seq input and output coverage, and the probability of success as the sum of the STARR-seq output coverage divided by the total input and output coverage, as described previously [<xref ref-type="bibr" rid="CR15">15</xref>]. The Poisson distribution is described by a single parameter <italic>λ</italic>, whereas the negative binomial distribution is described by both <italic>μ</italic> and the shape parameter <italic>θ</italic>. For example, we found <italic>λ</italic> = 41.6, <italic>μ</italic> = 41.6, and <italic>θ</italic> = 8.9 for the HepG2 dataset. Based on estimated parameters, we plotted the expected distribution quantiles from 0 to 100 percentiles against the actual observed quantiles. We plotted a straight diagonal line to show how well each distribution fit with the actual observed data.</p>
    </sec>
    <sec id="Sec28">
      <title>Negative binomial distribution</title>
      <p id="Par59">A negative binomial distribution, which arises from Gamma-Poisson mixture, can be parameterized for <italic>y</italic> ≥ 0 as follows.</p>
      <p id="Par60"><disp-formula id="Equa"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathit{\Pr}\left(Y={y}_i|{\mu}_i,\theta \right)={f}_Y\left({y}_i;{\mu}_i,\theta \right)=\left(\genfrac{}{}{0pt}{}{y_i+\theta -1}{y_i}\right)\bullet {\left(\frac{\theta }{\theta +{\mu}_i}\right)}^{\theta}\bullet {\left(\frac{\mu_i}{\theta +{\mu}_i}\right)}^{y_i} $$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mo mathvariant="italic">Pr</mml:mo><mml:mfenced close=")" open="(" separators="|,"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>θ</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=";,"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>θ</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>θ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>∙</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>θ</mml:mi><mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mi>θ</mml:mi></mml:msup><mml:mo>∙</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:math><graphic xlink:href="13059_2020_2194_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where
<disp-formula id="Equb"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left(\genfrac{}{}{0pt}{}{y_i+\theta -1}{y_i}\right)=\frac{\Gamma \left({y}_i+\theta \right)}{y_i!\bullet \Gamma \left(\theta \right)}=\frac{\Gamma \left({y}_i+\theta \right)}{\Gamma \left({y}_i+1\right)\bullet \Gamma \left(\theta \right)} $$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mfenced close=")" open="("><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>θ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>!</mml:mo><mml:mo>∙</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>θ</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>∙</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>θ</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2020_2194_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par61">Substituting gives:
<disp-formula id="Equc"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {f}_Y\left({y}_i;{\mu}_i,\theta \right)=\frac{\Gamma \left({y}_i+\theta \right)}{\Gamma \left({y}_i+1\right)\bullet \Gamma \left(\theta \right)}\bullet {\left(\frac{\theta }{\theta +{\mu}_i}\right)}^{\theta}\bullet {\left(\frac{\mu_i}{\theta +{\mu}_i}\right)}^{y_i} $$\end{document}</tex-math><mml:math id="M28" display="block"><mml:msub><mml:mi>f</mml:mi><mml:mi>Y</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=";,"><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>θ</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>∙</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mfenced close=")" open="("><mml:mi>θ</mml:mi></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>∙</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:mi>θ</mml:mi><mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mi>θ</mml:mi></mml:msup><mml:mo>∙</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:mfrac><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mi>θ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msup></mml:math><graphic xlink:href="13059_2020_2194_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par62">Rearranging gives:</p>
      <p id="Par63">
        <disp-formula id="Equd">
          <alternatives>
            <tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {f}_Y\left({y}_i;{\mu}_i,\theta \right)=\frac{\Gamma \left({y}_i+\theta \right)}{\Gamma \left({y}_i+1\right)\bullet \Gamma \left(\theta \right)}\bullet {\left(\frac{1}{1+\frac{\mu_i}{\theta }}\right)}^{\theta}\bullet {\left(\frac{\frac{\mu_i}{\theta }}{1+\frac{\mu_i}{\theta }}\right)}^{y_i} $$\end{document}</tex-math>
            <mml:math id="M30" display="block">
              <mml:msub>
                <mml:mi>f</mml:mi>
                <mml:mi>Y</mml:mi>
              </mml:msub>
              <mml:mfenced close=")" open="(" separators=";,">
                <mml:msub>
                  <mml:mi>y</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:msub>
                  <mml:mi>μ</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mi>θ</mml:mi>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi mathvariant="normal">Γ</mml:mi>
                  <mml:mfenced close=")" open="(">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mi>θ</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">Γ</mml:mi>
                  <mml:mfenced close=")" open="(">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>∙</mml:mo>
                  <mml:mi mathvariant="normal">Γ</mml:mi>
                  <mml:mfenced close=")" open="(">
                    <mml:mi>θ</mml:mi>
                  </mml:mfenced>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>∙</mml:mo>
              <mml:msup>
                <mml:mfenced close=")" open="(">
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>+</mml:mo>
                      <mml:mfrac>
                        <mml:msub>
                          <mml:mi>μ</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mi>θ</mml:mi>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mfenced>
                <mml:mi>θ</mml:mi>
              </mml:msup>
              <mml:mo>∙</mml:mo>
              <mml:msup>
                <mml:mfenced close=")" open="(">
                  <mml:mfrac>
                    <mml:mfrac>
                      <mml:msub>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mi>θ</mml:mi>
                    </mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>+</mml:mo>
                      <mml:mfrac>
                        <mml:msub>
                          <mml:mi>μ</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mi>θ</mml:mi>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mfenced>
                <mml:msub>
                  <mml:mi>y</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
              </mml:msup>
            </mml:math>
            <graphic xlink:href="13059_2020_2194_Article_Equd.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <disp-formula id="Eque">
          <alternatives>
            <tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {f}_Y\left({y}_i;\theta, {\mu}_i\right)=\frac{\Gamma \left({y}_i+\theta \right)}{\Gamma \left({y}_i+1\right)\bullet \Gamma \left(\theta \right)}\bullet {\left(\frac{\mu_i}{\theta}\right)}^{y_i}{\left(\frac{1}{1+\frac{\mu_i}{\theta }}\right)}^{\theta +{y}_i} $$\end{document}</tex-math>
            <mml:math id="M32" display="block">
              <mml:msub>
                <mml:mi>f</mml:mi>
                <mml:mi>Y</mml:mi>
              </mml:msub>
              <mml:mfenced close=")" open="(" separators=";,">
                <mml:msub>
                  <mml:mi>y</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mi>θ</mml:mi>
                <mml:msub>
                  <mml:mi>μ</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi mathvariant="normal">Γ</mml:mi>
                  <mml:mfenced close=")" open="(">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mi>θ</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">Γ</mml:mi>
                  <mml:mfenced close=")" open="(">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>∙</mml:mo>
                  <mml:mi mathvariant="normal">Γ</mml:mi>
                  <mml:mfenced close=")" open="(">
                    <mml:mi>θ</mml:mi>
                  </mml:mfenced>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>∙</mml:mo>
              <mml:msup>
                <mml:mfenced close=")" open="(">
                  <mml:mfrac>
                    <mml:msub>
                      <mml:mi>μ</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mi>θ</mml:mi>
                  </mml:mfrac>
                </mml:mfenced>
                <mml:msub>
                  <mml:mi>y</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
              </mml:msup>
              <mml:msup>
                <mml:mfenced close=")" open="(">
                  <mml:mfrac>
                    <mml:mn>1</mml:mn>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>+</mml:mo>
                      <mml:mfrac>
                        <mml:msub>
                          <mml:mi>μ</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mi>θ</mml:mi>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mfenced>
                <mml:mrow>
                  <mml:mi>θ</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>y</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                </mml:mrow>
              </mml:msup>
            </mml:math>
            <graphic xlink:href="13059_2020_2194_Article_Eque.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <disp-formula id="Equf">
          <alternatives>
            <tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {f}_Y\left({y}_i;\theta, {\mu}_i\right)=\frac{\Gamma \left({y}_i+\theta \right)}{\Gamma \left({y}_i+1\right)\bullet \Gamma \left(\theta \right)}\bullet {\left(\frac{\mu_i}{\theta}\right)}^{y_i}{\left(\frac{\theta }{\theta +{\mu}_i}\right)}^{\theta +{y}_i} $$\end{document}</tex-math>
            <mml:math id="M34" display="block">
              <mml:msub>
                <mml:mi>f</mml:mi>
                <mml:mi>Y</mml:mi>
              </mml:msub>
              <mml:mfenced close=")" open="(" separators=";,">
                <mml:msub>
                  <mml:mi>y</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mi>θ</mml:mi>
                <mml:msub>
                  <mml:mi>μ</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi mathvariant="normal">Γ</mml:mi>
                  <mml:mfenced close=")" open="(">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mi>θ</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">Γ</mml:mi>
                  <mml:mfenced close=")" open="(">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>∙</mml:mo>
                  <mml:mi mathvariant="normal">Γ</mml:mi>
                  <mml:mfenced close=")" open="(">
                    <mml:mi>θ</mml:mi>
                  </mml:mfenced>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>∙</mml:mo>
              <mml:msup>
                <mml:mfenced close=")" open="(">
                  <mml:mfrac>
                    <mml:msub>
                      <mml:mi>μ</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mi>θ</mml:mi>
                  </mml:mfrac>
                </mml:mfenced>
                <mml:msub>
                  <mml:mi>y</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
              </mml:msup>
              <mml:msup>
                <mml:mfenced close=")" open="(">
                  <mml:mfrac>
                    <mml:mi>θ</mml:mi>
                    <mml:mrow>
                      <mml:mi>θ</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mfenced>
                <mml:mrow>
                  <mml:mi>θ</mml:mi>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>y</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                </mml:mrow>
              </mml:msup>
            </mml:math>
            <graphic xlink:href="13059_2020_2194_Article_Equf.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <disp-formula id="Equg">
          <alternatives>
            <tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {f}_Y\left({y}_i;\theta, {\mu}_i\right)=\frac{\Gamma \left({y}_i+\theta \right)}{\Gamma \left({y}_i+1\right)\bullet \Gamma \left(\theta \right)}\bullet \frac{{\mu_i}^{y_i}{\theta}^{\theta }}{{\left(\theta +{\mu}_i\right)}^{\theta +{y}_i}} $$\end{document}</tex-math>
            <mml:math id="M36" display="block">
              <mml:msub>
                <mml:mi>f</mml:mi>
                <mml:mi>Y</mml:mi>
              </mml:msub>
              <mml:mfenced close=")" open="(" separators=";,">
                <mml:msub>
                  <mml:mi>y</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mi>θ</mml:mi>
                <mml:msub>
                  <mml:mi>μ</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi mathvariant="normal">Γ</mml:mi>
                  <mml:mfenced close=")" open="(">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mi>θ</mml:mi>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">Γ</mml:mi>
                  <mml:mfenced close=")" open="(">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>∙</mml:mo>
                  <mml:mi mathvariant="normal">Γ</mml:mi>
                  <mml:mfenced close=")" open="(">
                    <mml:mi>θ</mml:mi>
                  </mml:mfenced>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>∙</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msup>
                    <mml:msub>
                      <mml:mi>μ</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:msub>
                      <mml:mi>y</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:msup>
                  <mml:msup>
                    <mml:mi>θ</mml:mi>
                    <mml:mi>θ</mml:mi>
                  </mml:msup>
                </mml:mrow>
                <mml:msup>
                  <mml:mfenced close=")" open="(">
                    <mml:mrow>
                      <mml:mi>θ</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>μ</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mrow>
                    <mml:mi>θ</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:msub>
                      <mml:mi>y</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:msup>
              </mml:mfrac>
            </mml:math>
            <graphic xlink:href="13059_2020_2194_Article_Equg.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
    </sec>
    <sec id="Sec29">
      <title>Alternative parameterization of negative binomial regression using a rate model</title>
      <p id="Par64">Alternative parameterization allows STARR-seq data to be modeled as a rate model. In contrast to using input coverage as one of the covariates, we can consider it as “exposure” to output coverage. This “trick” allows us to directly model the basal transcription rate (the ratio of RNA to DNA) as a rate response variable. We defined the transcription rate (RNA to DNA ratio) as a new variable, <italic>π</italic><sub><italic>i</italic></sub>.</p>
      <p id="Par65">
        <disp-formula id="Equh">
          <alternatives>
            <tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \frac{y_i}{t_i}={\pi}_i $$\end{document}</tex-math>
            <mml:math id="M38" display="block">
              <mml:mfrac>
                <mml:msub>
                  <mml:mi>y</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
              </mml:mfrac>
              <mml:mo>=</mml:mo>
              <mml:msub>
                <mml:mi>π</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:msub>
            </mml:math>
            <graphic xlink:href="13059_2020_2194_Article_Equh.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par66">If we assume the majority of genomic bins will have the basal transcription rate, we can model the transcription rate at each <italic>i</italic>th bin following the traditional negative binomial (NB2) distribution.</p>
      <p id="Par67">
        <disp-formula id="Equi">
          <alternatives>
            <tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\pi}_i\sim NB\left(\frac{\mu_i}{t_i},\theta \right) $$\end{document}</tex-math>
            <mml:math id="M40" display="block">
              <mml:msub>
                <mml:mi>π</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:msub>
              <mml:mo>~</mml:mo>
              <mml:mi mathvariant="italic">NB</mml:mi>
              <mml:mfenced close=")" open="(" separators=",">
                <mml:mfrac>
                  <mml:msub>
                    <mml:mi>μ</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                </mml:mfrac>
                <mml:mi>θ</mml:mi>
              </mml:mfenced>
            </mml:math>
            <graphic xlink:href="13059_2020_2194_Article_Equi.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par68">The expected basal transcription, <italic>E</italic>(<italic>π</italic><sub><italic>i</italic></sub>), becomes the mean incidence rate of <italic>y</italic><sub><italic>i</italic></sub> per unit of exposure, <italic>t</italic><sub><italic>i</italic></sub>.</p>
      <p id="Par69">
        <disp-formula id="Equj">
          <alternatives>
            <tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ E\left(\frac{y_i}{t_i}\right)=\frac{\mu_i}{t_i} $$\end{document}</tex-math>
            <mml:math id="M42" display="block">
              <mml:mi>E</mml:mi>
              <mml:mfenced close=")" open="(">
                <mml:mfrac>
                  <mml:msub>
                    <mml:mi>y</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                </mml:mfrac>
              </mml:mfenced>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:msub>
                  <mml:mi>μ</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
              </mml:mfrac>
            </mml:math>
            <graphic xlink:href="13059_2020_2194_Article_Equj.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par70">By normalizing <italic>μ</italic><sub><italic>i</italic></sub> by <italic>t</italic><sub><italic>i</italic></sub>, we are modeling a rate instead of a discrete count using the negative binomial distribution. The regression term for the expected transcription rate can be expressed in terms of a linear combination of explanatory variables, <italic>j</italic> covariates (<inline-formula id="IEq3"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overrightarrow{x} $$\end{document}</tex-math><mml:math id="M44" display="inline"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2020_2194_Article_IEq3.gif"/></alternatives></inline-formula>).</p>
      <p id="Par71">
        <disp-formula id="Equk">
          <alternatives>
            <tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \ln \frac{\mu_i}{t_i}={\beta}_1{x}_{i1}+{\beta}_2{x}_{i2}+\cdots +{\beta}_j{x}_{ij} $$\end{document}</tex-math>
            <mml:math id="M46" display="block">
              <mml:mo>ln</mml:mo>
              <mml:mfrac>
                <mml:msub>
                  <mml:mi>μ</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
              </mml:mfrac>
              <mml:mo>=</mml:mo>
              <mml:msub>
                <mml:mi>β</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mi>β</mml:mi>
                <mml:mn>2</mml:mn>
              </mml:msub>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:mo>⋯</mml:mo>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mi>β</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:msub>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mi mathvariant="italic">ij</mml:mi>
              </mml:msub>
            </mml:math>
            <graphic xlink:href="13059_2020_2194_Article_Equk.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par72">Rearranging in terms of the expected value of <italic>y</italic>, or <italic>μ</italic>, gives</p>
      <p id="Par73">
        <disp-formula id="Equl">
          <alternatives>
            <tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \ln {\mu}_i-\ln {t}_i={\beta}_1{x}_{i1}+{\beta}_2{x}_{i2}+\cdots +{\beta}_j{x}_{ij} $$\end{document}</tex-math>
            <mml:math id="M48" display="block">
              <mml:mo>ln</mml:mo>
              <mml:msub>
                <mml:mi>μ</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:msub>
              <mml:mo>−</mml:mo>
              <mml:mo>ln</mml:mo>
              <mml:msub>
                <mml:mi>t</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:msub>
                <mml:mi>β</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mi>β</mml:mi>
                <mml:mn>2</mml:mn>
              </mml:msub>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:mo>⋯</mml:mo>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mi>β</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:msub>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mi mathvariant="italic">ij</mml:mi>
              </mml:msub>
            </mml:math>
            <graphic xlink:href="13059_2020_2194_Article_Equl.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <disp-formula id="Equm">
          <alternatives>
            <tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \ln {\mu}_i=\ln {t}_i+{\beta}_1{x}_{i1}+{\beta}_2{x}_{i2}+\cdots +{\beta}_j{x}_{ij} $$\end{document}</tex-math>
            <mml:math id="M50" display="block">
              <mml:mo>ln</mml:mo>
              <mml:msub>
                <mml:mi>μ</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mo>ln</mml:mo>
              <mml:msub>
                <mml:mi>t</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mi>β</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mi>β</mml:mi>
                <mml:mn>2</mml:mn>
              </mml:msub>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:mo>⋯</mml:mo>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mi>β</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:msub>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mi mathvariant="italic">ij</mml:mi>
              </mml:msub>
            </mml:math>
            <graphic xlink:href="13059_2020_2194_Article_Equm.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
        <disp-formula id="Equn">
          <alternatives>
            <tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mu}_i=\exp \left(\ln {t}_i+{\beta}_1{x}_{i1}+{\beta}_2{x}_{i2}+\cdots +{\beta}_j{x}_{ij}\right) $$\end{document}</tex-math>
            <mml:math id="M52" display="block">
              <mml:msub>
                <mml:mi>μ</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mo>exp</mml:mo>
              <mml:mfenced close=")" open="(">
                <mml:mrow>
                  <mml:mo>ln</mml:mo>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>β</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>β</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:mo>⋯</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>β</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mi mathvariant="italic">ij</mml:mi>
                  </mml:msub>
                </mml:mrow>
              </mml:mfenced>
            </mml:math>
            <graphic xlink:href="13059_2020_2194_Article_Equn.gif" position="anchor"/>
          </alternatives>
        </disp-formula>
      </p>
      <p id="Par74">The natural log of <italic>t</italic><sub><italic>i</italic></sub> on the RHS ensures <italic>μ</italic><sub><italic>i</italic></sub> is normalized in the model, acting as an offset variable. In STARRPeaker software, we allow users to optionally choose this alternative rate model (implemented as “mode 2”) instead of the default covariate model described in the main text. This alternate model is useful if constant basal transcription is expected throughout the genome or if covariates are available for directly modeling the basal transcription rate <italic>π</italic>.</p>
    </sec>
    <sec id="Sec30">
      <title>Evaluation of potential orientation bias</title>
      <p id="Par75">For all enhancer peaks identified from both the HepG2 and K562 cell lines, we evaluated if there was an overrepresentation of fragments in a specific orientation. If there is no orientation bias, the STARR-seq active region should be equally represented by both forward- and reverse-stranded fragments. We performed a binomial test for the statistical significance on how unlikely it is to have a fragment distribution skewed on one strand.
<disp-formula id="Equo"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left(\begin{array}{c}n\\ {}k\end{array}\right){p}^k{\left(1-p\right)}^{n-k} $$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mfenced close=")" open="("><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:msup><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:math><graphic xlink:href="13059_2020_2194_Article_Equo.gif" position="anchor"/></alternatives></disp-formula>where <italic>p</italic> is 0.5 (equal chance of being either forward or reverse stranded), <italic>n</italic> is number of all supporting fragments, and <italic>k</italic> is the number of forward-stranded fragments. We adjusted <italic>P</italic> values using FDR (BH) and used 0.01 as a cutoff. We ran binomial tests for both replicates. To call a region orientation-biased, we ensured that genomic DNA fragments were equally represented in both forward and reverse strands, and we checked for significant strand bias in both replicates. If strand bias is already present in a genomic DNA library, it is more likely that the bias will be due to amplification by PCR rather than being a result of orientation-specific activity.</p>
    </sec>
    <sec id="Sec31">
      <title>BasicSTARRseq</title>
      <p id="Par76">We used BasicSTARRseq R package version 1.10.0 downloaded from Bioconductor (<ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/release/bioc/html/BasicSTARRseq.html">https://bioconductor.org/packages/release/bioc/html/BasicSTARRseq.html</ext-link>). We used the default settings as described in the software manual, except for disabling deduplication (minQuantile = 0.9, peakWidth = 500, maxPval = 0.001, deduplicate = FALSE, model = 1), to call peaks.</p>
    </sec>
    <sec id="Sec32">
      <title>MACS2</title>
      <p id="Par77">We used MACS2 version 2.1.1 [<xref ref-type="bibr" rid="CR23">23</xref>] with the optimal parameters suggested for a human STARR-seq dataset (-f BAMPE -g hs). We also used an option to allow duplicates in read (--keep-dup all), since our STARR-seq dataset was multiplexed. We called peaks with an FDR cutoff of 0.05 (-q 0.05), as recommended by the author of the software.</p>
    </sec>
    <sec id="Sec33">
      <title>Calculating folding free energy</title>
      <p id="Par78">We used the LinearFold [<xref ref-type="bibr" rid="CR48">48</xref>] algorithm to estimate the folding energy of each genomic bin iteratively across the whole genome. Specifically, we used the Vienna RNAfold thermodynamic model [<xref ref-type="bibr" rid="CR49">49</xref>] with parameters from Mathews et al. [<xref ref-type="bibr" rid="CR50">50</xref>]. We implemented a parallel processing scheme to leverage multicore processors to expedite the calculation of folding free energy.</p>
    </sec>
    <sec id="Sec34">
      <title>Recommended parameters for the model</title>
      <p id="Par79">We determined the model parameters from the experimental design of the STARR-seq assay. Our STARR-seq input library was based on DNA fragments that were size-selected on an agarose gel for 500 bp. Therefore, we defined the bin size to be 500 bp with a step size of 100 bp. Furthermore, we chose the minimum and maximum template size to be 200 and 1000 bp, respectively, to recover RNA generated from the STARR-seq input library. We recommend setting the minimum template size no less than 200 bp, as a shorter template can become more prone to PCR bias during sequencing. Based on the sequencing depth, we determined the minimum coverage for the whole genome to be 10. To guide users on how to choose these parameters, we provide a sensitivity analysis of how changing the parameters affects the results (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table S5). Overall, more than 80% of peaks were consistent regardless of varying the parameters. We found that changing the bin size affected the average peak size and changing the step size affected the resolution. However, we found that using a 50-bp step size approximately doubled the processing time.</p>
    </sec>
    <sec id="Sec35">
      <title>Simulation of the STARR-seq dataset</title>
      <p id="Par80">We created an artificial STARR-seq dataset where the ground truth exists. We used the original STARR-seq input library as the base of the simulation. We focused on an approximately 2.6-Mbp region spanning the MYC locus (chr8:127128459-129731914). We artificially selected 28 control regions equally sized at 500 bp. Among these control regions, we included coordinates of four in vivo MYC enhancers identified from Fulco et al. (MYC-e1, chr8:127898897-127898963; MYC-e2, chr8:127960392-127960502; MYC-e5, chr8:129581781-129582461; MYC-e6, chr8:129689361-129689694) [<xref ref-type="bibr" rid="CR43">43</xref>]. We selectively generated paired-end reads that only support control regions. Since we expect the background regions to have a basal level of transcription, we matched the read distribution of the input library to make the transcription rate equal to 1. All 28 control regions were then merged to create an artificial STARR-seq output library, and finally, the read coverage was visually inspected to ensure that it resembles one from the actual STARR-seq dataset.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec36">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2020_2194_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: </bold><bold>Supplementary Figure S1.</bold> Comparison of STARR-seq output coverage calculated using the center of the fragment to using the start position of the sequencing read. (A) Distribution of shift in final peak locations resulting from using two alternative coverage counting schemes in HepG2. Comparison of (B) overall fold enrichment level, (C) <italic>P</italic> value, and (D) size of resulting peaks. <bold>Supplementary Figure S2.</bold> (Shadow figure of Fig. <xref rid="Fig2" ref-type="fig">2</xref>) Correlation of STARR-seq output coverage with covariates (STARR-seq input coverage, GC content, mappability, and RNA structure) in various STARR-seq datasets, including (A) K562, (B) HeLa-S3 untreated WG-STARR-seq (Muerdter 2018), (C) GM12878 HiDRA ATAC-STARR-seq (Wang 2018), and (D) K562 Cap-STARR-seq (Rathert 2015). PCC: Pearson Correlation Coefficient. <bold>Supplementary Figure S3.</bold> Contribution of covariates and model selection. (A) Q-Q plots of residuals for various models with different sets of covariates showing the goodness of fit. (B) Both AIC and BIC measure relative qualities of statistical models considering the trade-off between the goodness of fit and the simplicity of the model. DNA: genomic DNA fragment coverage; GC: GC-bias; MAP: mappability, FOLD: folding free energy; AIC: Akaike information criterion; BIC: Bayesian information criterion. <bold>Supplementary Figure S4.</bold> (Shadow figure of Fig. <xref rid="Fig3" ref-type="fig">3</xref>) Fitting of various STARR-seq datasets using three distribution models: negative binomial, binomial, and Poisson. Datasets included (A) K562, (B) HeLa-S3 untreated WG-STARR-seq (Muerdter 2018), (C) GM12878 HiDRA ATAC-STARR-seq (Wang 2018), and (D) K562 Cap-STARR-seq (Rathert 2015). <bold>Supplementary Figure S5.</bold> Q-Q plots of the <italic>P</italic> value distribution. (A) HepG2 and (B) K562. The red line is a reference line where the expected <italic>P</italic> values match the observed ones. <bold>Supplementary Figure S6.</bold> Correlation of RNA fragment coverage between replicates for (A) HepG2 or (B) K562 cell lines. Pairwise coverage was calculated using 1000 bp bins across the genome. The X- and Y-axis represent the natural log of fragment counts. A pseudo count of 1 was added to the fragment counts for plotting only. Bins with abnormally high fragment counts were removed to avoid inflation of the Pearson correlation. We used the median absolute deviation method with a scaling factor of 200 to filter extremely large deviations from the median. <bold>Supplementary Figure S7.</bold> Comparison of peaks called from subsamples of the original STARR-seq library, highlighting the robustness of STARRPeaker using (A) the whole dataset and (B) 5000 subset of peaks. <bold>Supplementary Figure S8.</bold> Orientation biases analysis for (A-B) HepG2 or (C-D) K562 cell lines. The ratio between forward and reverse stranded fragments was tested for statistical significance using a binomial test. Orange dots represent peaks with significant strand bias (FDR q-value &lt; 0.01). <bold>Supplementary Figure S9.</bold> Comparison of peaks identified by various methods using a simulated STARR-seq dataset containing 28 spike-in control regions. <bold>Supplementary Figure S10.</bold> Enrichment of epigenetic signals around peaks in K562. All peaks were centered at the summit, uniformly thresholded using <italic>P</italic> value &lt; 0.001, and 10,000 peaks were randomly selected. Aggregated read depth at 2000 bp upstream and downstream were plotted for (A) DNase I hypersensitive sites (DHS), (B) H3K27ac, (C) H3K4me1, and (D) aggregated TF ChIP-seq profile. For DNase-seq, enrichment indicates unique read depth. For histone ChIP-seq, enrichment indicates fold change over control. For TF ChIP-seq aggregate, enrichment indicates the number of TFs binding. <bold>Supplementary Figure S11.</bold> (A-C) Genome browser session comparing STARRPeaker to other peak-calling methods at validated distal enhancers from CRISPRi tiling screen. <bold>Supplementary Figure S12.</bold> Application of STARRPeaker on an external HeLa-S3 dataset. (A) Comparison of chromatin accessibility (DNase-seq) for STARRPeaker peaks between untreated and inhibitor-treated samples. (B) Comparison of STARRPeaker peaks to published results without post-hoc filtering. STARRPeaker found 6540 additional peaks that were equally enriched with chromatin accessibility signals. (C) Comparison of STARRPeaker peaks to published results with the same post-hoc filtering approach (P-value ≤1E-5 with corrected enrichment ≥4). <bold>Supplementary Figure S13.</bold> Venn diagram for four-way comparison of peaks identified by various methods using a published dataset from Rathert et al. 2015.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2020_2194_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2:</bold><bold>Supplementary Table S1.</bold> Peaks identified by STARRPeaker in each replicate and merged replicate from HepG2 and K562 cell lines.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2020_2194_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3:</bold><bold>Supplementary Table S2.</bold> Number of overlaps between peaks from various peak callers (STARRPeaker, BasicSTARRseq, and MACS2) and previously published enhancers identified using alternative enhancer assays.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2020_2194_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4:</bold><bold>Supplementary Table S3.</bold> List of data sources and accession numbers used for the analysis.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2020_2194_MOESM5_ESM.xlsx">
            <caption>
              <p><bold>Additional file 5:</bold><bold>Supplementary Table S4.</bold> Comparison of peaks identified from various peak callers (STARRPeaker, BasicSTARRseq, and MACS2).</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="13059_2020_2194_MOESM6_ESM.xlsx">
            <caption>
              <p><bold>Additional file 6:</bold><bold>Supplementary Table S5.</bold> Sensitivity analysis of using alternative parameters against default parameters (bin 500 bp, step 100 bp, min 200 bp, max 1000 bp) using the HepG2 rep1 dataset.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="13059_2020_2194_MOESM7_ESM.xlsx">
            <caption>
              <p><bold>Additional file 7:</bold><bold>Supplementary Table S6.</bold> List of control regions in the MYC locus for simulation.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM8">
          <media xlink:href="13059_2020_2194_MOESM8_ESM.xlsx">
            <caption>
              <p><bold>Additional file 8:</bold><bold>Supplementary Table S7.</bold> Sensitivity and specificity analysis using simulated STARR-seq data.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM9">
          <media xlink:href="13059_2020_2194_MOESM9_ESM.xlsx">
            <caption>
              <p><bold>Additional file 9:</bold><bold>Supplementary Table S8.</bold> Sensitivity and specificity analysis using the Fulco 2016 CRISPRi dataset.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM10">
          <media xlink:href="13059_2020_2194_MOESM10_ESM.docx">
            <caption>
              <p><bold>Additional file 10.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Jinrui Xu and Joel Rozowsky for thoughtful discussion about ChIP-seq processing, Michael Rutenberg Schoenberg and Zhen Chen for thoughtful discussion about RNA-folding biology, and all other members of the Gerstein and White laboratories for advice and critical feedback on the manuscript.</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par81">The review history is available as Additional file <xref rid="MOESM10" ref-type="media">10</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par82">Tim Sands was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>D.L., M.S., K.W., and M.G. conceived the project. D.L. and M.G. drafted the manuscript. D.L. developed the STARRPeaker software package. M.S., J.M., M.W., D.F., Y.K., and L.M. performed experimental works. M.W. and Y.K. performed experimental validations. D.L., J.Z., and J.L. performed the downstream analyses. M.G. and K.W. provided funding and supervised the project. The authors read and approved the final manuscript.</p>
    <sec id="FPar3">
      <title>Authors’ information</title>
      <p id="Par83">Twitter handles: @hoondy (Donghoon Lee), @MarkGerstein (Mark Gerstein).</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>We acknowledge support from the National Institutes of Health (U24HG009446, UM1HG009426, K01MH123896) and from the AL Williams Professorship funds. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>We implemented the method described in this article as a Python software package called STARRPeaker. The software package can be downloaded, installed, and readily used to call peaks from any STARR-seq dataset. The STARRPeaker package, as well as source code and documentation, is freely available at <ext-link ext-link-type="uri" xlink:href="http://github.com/gersteinlab/starrpeaker">http://github.com/gersteinlab/starrpeaker</ext-link> [<xref ref-type="bibr" rid="CR51">51</xref>]. All raw data used in the analysis as well as derived resources are available to download from the ENCODE portal (<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/">https://www.encodeproject.org/</ext-link>) with accession code ENCSR135NXN for HepG2 and ENCSR858MPS for K562 [<xref ref-type="bibr" rid="CR52">52</xref>]. DNase-seq and ChIP-seq data used for the analysis is also publicly available from the ENCODE portal. The specific accession codes used for the analysis are listed in Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S3. GC content was downloaded from the UCSC Genome Browser (<ext-link ext-link-type="uri" xlink:href="http://hgdownload.cse.ucsc.edu/gbdb/hg38/bbi/gc5BaseBw/">http://hgdownload.cse.ucsc.edu/gbdb/hg38/bbi/gc5BaseBw/</ext-link>), and the mappability track was created using gem-library software [<xref ref-type="bibr" rid="CR53">53</xref>] with a k-mer size of 100 bp and the reference human genome build hg38.</p>
  </notes>
  <notes id="FPar4">
    <title>Ethics approval and consent to participate</title>
    <p id="Par84">Not applicable.</p>
  </notes>
  <notes id="FPar5" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par85">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muerdter</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Boryń</surname>
            <given-names>ŁM</given-names>
          </name>
          <name>
            <surname>Arnold</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>STARR-seq—principles and applications</article-title>
        <source>Genomics.</source>
        <year>2015</year>
        <volume>106</volume>
        <fpage>145</fpage>
        <lpage>150</lpage>
        <pub-id pub-id-type="doi">10.1016/J.YGENO.2015.06.001</pub-id>
        <?supplied-pmid 26072434?>
        <pub-id pub-id-type="pmid">26072434</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yáñez-Cuna</surname>
            <given-names>JO</given-names>
          </name>
          <name>
            <surname>Kvon</surname>
            <given-names>EZ</given-names>
          </name>
          <name>
            <surname>Stark</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Deciphering the transcriptional cis-regulatory code</article-title>
        <source>Trends Genet</source>
        <year>2013</year>
        <volume>29</volume>
        <fpage>11</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2012.09.007</pub-id>
        <?supplied-pmid 23102583?>
        <pub-id pub-id-type="pmid">23102583</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lettice</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Heaney</surname>
            <given-names>SJH</given-names>
          </name>
          <name>
            <surname>Purdie</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>de Beer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Oostra</surname>
            <given-names>BA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A long-range Shh enhancer regulates expression in the developing limb and fin and is associated with preaxial polydactyly</article-title>
        <source>Hum Mol Genet</source>
        <year>2003</year>
        <volume>12</volume>
        <fpage>1725</fpage>
        <lpage>1735</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddg180</pub-id>
        <?supplied-pmid 12837695?>
        <pub-id pub-id-type="pmid">12837695</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Banerji</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Rusconi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schaffner</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Expression of a beta-globin gene is enhanced by remote SV40 DNA sequences</article-title>
        <source>Cell.</source>
        <year>1981</year>
        <volume>27</volume>
        <issue>2 Pt 1</issue>
        <fpage>299</fpage>
        <lpage>308</lpage>
        <pub-id pub-id-type="doi">10.1016/0092-8674(81)90413-x</pub-id>
        <?supplied-pmid 6277502?>
        <pub-id pub-id-type="pmid">6277502</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sagai</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hosoya</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mizushina</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tamura</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shiroishi</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Elimination of a long-range cis-regulatory module causes complete loss of limb-specific Shh expression and truncation of the mouse limb</article-title>
        <source>Development.</source>
        <year>2005</year>
        <volume>132</volume>
        <fpage>797</fpage>
        <lpage>803</lpage>
        <pub-id pub-id-type="doi">10.1242/dev.01613</pub-id>
        <?supplied-pmid 15677727?>
        <pub-id pub-id-type="pmid">15677727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Melo</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Drost</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wijchers</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>van de Werken</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>de Wit</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vrielink</surname>
            <given-names>JAFO</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>eRNAs are required for p53-dependent enhancer activity and gene transcription</article-title>
        <source>Mol Cell</source>
        <year>2013</year>
        <volume>49</volume>
        <fpage>524</fpage>
        <lpage>535</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2012.11.021</pub-id>
        <?supplied-pmid 23273978?>
        <pub-id pub-id-type="pmid">23273978</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanyal</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The long-range interaction landscape of gene promoters</article-title>
        <source>Nature.</source>
        <year>2012</year>
        <volume>489</volume>
        <fpage>109</fpage>
        <lpage>113</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11279</pub-id>
        <?supplied-pmid 22955621?>
        <pub-id pub-id-type="pmid">22955621</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dao</surname>
            <given-names>LTM</given-names>
          </name>
          <name>
            <surname>Galindo-Albarrán</surname>
            <given-names>AO</given-names>
          </name>
          <name>
            <surname>Castro-Mondragon</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Andrieu-Soler</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Medina-Rivera</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Souaid</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide characterization of mammalian promoters with distal enhancer functions</article-title>
        <source>Nat Genet</source>
        <year>2017</year>
        <volume>49</volume>
        <fpage>1073</fpage>
        <lpage>1081</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3884</pub-id>
        <?supplied-pmid 28581502?>
        <pub-id pub-id-type="pmid">28581502</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Diao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Fang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Meng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A tiling-deletion-based genetic screen for cis-regulatory element identification in mammalian cells</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>629</fpage>
        <lpage>635</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4264</pub-id>
        <?supplied-pmid 28417999?>
        <pub-id pub-id-type="pmid">28417999</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ChromHMM: automating chromatin-state discovery and characterization</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>215</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1906</pub-id>
        <?supplied-pmid 22373907?>
        <pub-id pub-id-type="pmid">22373907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffman</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Buske</surname>
            <given-names>OJ</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Bilmes</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Unsupervised pattern discovery in human chromatin structure through genomic segmentation</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>473</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1937</pub-id>
        <?supplied-pmid 22426492?>
        <pub-id pub-id-type="pmid">22426492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <mixed-citation publication-type="other">Sethi A, Gu M, Gumusgoz E, Chan L, Yan K-K, Rozowsky J, et al. A cross-organism framework for supervised enhancer prediction with epigenetic pattern recognition and targeted validation. bioRxiv. 2018:385237. 10.1101/385237.</mixed-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patwardhan</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Hiatt</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Witten</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>May</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel functional dissection of mammalian enhancers in vivo</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>30</volume>
        <fpage>265</fpage>
        <lpage>270</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2136</pub-id>
        <?supplied-pmid 22371081?>
        <pub-id pub-id-type="pmid">22371081</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Melnikov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Murugan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Tesileanu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rogov</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Systematic dissection and optimization of inducible enhancers in human cells using a massively parallel reporter assay</article-title>
        <source>Nat Biotechnol</source>
        <year>2012</year>
        <volume>30</volume>
        <fpage>271</fpage>
        <lpage>277</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2137</pub-id>
        <?supplied-pmid 22371084?>
        <pub-id pub-id-type="pmid">22371084</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arnold</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Gerlach</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Stelzer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Boryń</surname>
            <given-names>ŁM</given-names>
          </name>
          <name>
            <surname>Rath</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stark</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide quantitative enhancer activity maps identified by STARR-seq</article-title>
        <source>Science (80- )</source>
        <year>2013</year>
        <volume>339</volume>
        <fpage>1074</fpage>
        <lpage>1077</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1232542</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dhiman</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Brunetti</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Eckart</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>KP</given-names>
          </name>
        </person-group>
        <article-title>Functional assessment of human enhancer activities using whole-genome STARR-sequencing</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>219</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1345-5</pub-id>
        <?supplied-pmid 29151363?>
        <pub-id pub-id-type="pmid">29151363</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Klein JC, Agarwal V, Inoue F, Keith A, Martin B, Kircher M, et al. A systematic evaluation of the design, orientation, and sequence context dependencies of massively parallel reporter assays. bioRxiv. 2019:576405. 10.1101/576405.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Barrera</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McDowell</surname>
            <given-names>IC</given-names>
          </name>
          <name>
            <surname>D’Ippolito</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Majoros</surname>
            <given-names>WH</given-names>
          </name>
          <name>
            <surname>Vockley</surname>
            <given-names>CM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Human genome-wide measurement of drug-responsive regulatory activity</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-02088-w</pub-id>
        <pub-id pub-id-type="pmid">29317637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rathert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Neumann</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Muerdter</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Roe</surname>
            <given-names>J-S</given-names>
          </name>
          <name>
            <surname>Muhar</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional plasticity promotes primary and acquired resistance to BET inhibition</article-title>
        <source>Nature.</source>
        <year>2015</year>
        <volume>525</volume>
        <fpage>543</fpage>
        <lpage>547</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14898</pub-id>
        <?supplied-pmid 26367798?>
        <pub-id pub-id-type="pmid">26367798</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koohy</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Down</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Spivakov</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hubbard</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A comparison of peak callers used for DNase-Seq data</article-title>
        <source>PLoS One</source>
        <year>2014</year>
        <volume>9</volume>
        <fpage>e96303</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0096303</pub-id>
        <?supplied-pmid 24810143?>
        <pub-id pub-id-type="pmid">24810143</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Uren</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Bahrami-Samani</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Burns</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Qiao</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Karginov</surname>
            <given-names>FV</given-names>
          </name>
          <name>
            <surname>Hodges</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Site identification in high-throughput RNA-protein interaction data</article-title>
        <source>Bioinformatics.</source>
        <year>2012</year>
        <volume>28</volume>
        <fpage>3013</fpage>
        <lpage>3020</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts569</pub-id>
        <?supplied-pmid 23024010?>
        <pub-id pub-id-type="pmid">23024010</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strbenac</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Armstrong</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>JYH</given-names>
          </name>
        </person-group>
        <article-title>Detection and classification of peaks in 5′ cap RNA sequencing data</article-title>
        <source>BMC Genomics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>Suppl 5</issue>
        <fpage>S9</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2164-14-S5-S9</pub-id>
        <?supplied-pmid 24564843?>
        <pub-id pub-id-type="pmid">24564843</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Eeckhoute</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>
        <source>Genome Biol</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>R137</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2008-9-9-r137</pub-id>
        <?supplied-pmid 18798982?>
        <pub-id pub-id-type="pmid">18798982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Tolstorukov</surname>
            <given-names>MY</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Design and analysis of ChIP-seq experiments for DNA-binding proteins</article-title>
        <source>Nat Biotechnol</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>1351</fpage>
        <lpage>1359</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1508</pub-id>
        <?supplied-pmid 19029915?>
        <pub-id pub-id-type="pmid">19029915</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Handsaker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wysoker</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fennell</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Homer</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics.</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poptsova</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Il’icheva</surname>
            <given-names>IA</given-names>
          </name>
          <name>
            <surname>Nechipurenko</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Panchenko</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Khodikov</surname>
            <given-names>MV</given-names>
          </name>
          <name>
            <surname>Oparina</surname>
            <given-names>NY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Non-random DNA fragmentation in next-generation sequencing</article-title>
        <source>Sci Rep</source>
        <year>2014</year>
        <volume>4</volume>
        <fpage>4532</fpage>
        <pub-id pub-id-type="doi">10.1038/srep04532</pub-id>
        <?supplied-pmid 24681819?>
        <pub-id pub-id-type="pmid">24681819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lazarovici</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Shafer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dantas Machado</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Riley</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Sandstrom</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probing DNA shape and methylation state on a genomic scale with DNase I</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2013</year>
        <volume>110</volume>
        <fpage>6376</fpage>
        <lpage>6381</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1216822110</pub-id>
        <?supplied-pmid 23576721?>
        <pub-id pub-id-type="pmid">23576721</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lai</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Proctor</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>On the importance of cotranscriptional RNA structure formation</article-title>
        <source>RNA.</source>
        <year>2013</year>
        <volume>19</volume>
        <fpage>1461</fpage>
        <lpage>1473</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.037390.112</pub-id>
        <?supplied-pmid 24131802?>
        <pub-id pub-id-type="pmid">24131802</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ringnér</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Folding free energies of 5′-UTRs impact post-transcriptional regulation on a genomic scale in yeast</article-title>
        <source>PLoS Comput Biol</source>
        <year>2005</year>
        <volume>1</volume>
        <fpage>e72</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0010072</pub-id>
        <?supplied-pmid 16355254?>
        <pub-id pub-id-type="pmid">16355254</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rabani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Levin</surname>
            <given-names>JZ</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Adiconis</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Raychowdhury</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Garber</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metabolic labeling of RNA uncovers principles of RNA production and degradation dynamics in mammalian cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2011</year>
        <volume>29</volume>
        <fpage>436</fpage>
        <lpage>442</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1861</pub-id>
        <?supplied-pmid 21516085?>
        <pub-id pub-id-type="pmid">21516085</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>van Nimwegen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zavolan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rajewsky</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Schroeder</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Magnasco</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Decay rates of human mRNAs: correlation with functional characteristics and sequence attributes</article-title>
        <source>Genome Res</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>1863</fpage>
        <lpage>1872</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.1272403</pub-id>
        <?supplied-pmid 12902380?>
        <pub-id pub-id-type="pmid">12902380</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tani</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mizutani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Salam</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Tano</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ijiri</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Wakamatsu</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-wide determination of RNA stability reveals hundreds of short-lived noncoding transcripts in mammals</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>947</fpage>
        <lpage>956</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.130559.111</pub-id>
        <?supplied-pmid 22369889?>
        <pub-id pub-id-type="pmid">22369889</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Papoulis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Probability, random variables and stochastic processes</source>
        <year>1984</year>
        <edition>2</edition>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>McGraw-Hill</publisher-name>
        <fpage>1984</fpage>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>MP</given-names>
          </name>
        </person-group>
        <article-title>Systematic identification of silencers in human cells</article-title>
        <source>Nat Genet</source>
        <year>2020</year>
        <volume>52</volume>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-020-0578-5</pub-id>
        <pub-id pub-id-type="pmid">31911675</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hilbe</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <source>Negative Binomial Regression</source>
        <year>2011</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cameron</surname>
            <given-names>ACA</given-names>
          </name>
          <name>
            <surname>Trivedi</surname>
            <given-names>PK</given-names>
          </name>
        </person-group>
        <source>Regression analysis of count data</source>
        <year>2013</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hilbe</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <source>Modeling count data</source>
        <year>2014</year>
        <publisher-loc>Cambridge</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc Ser B</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
        <pub-id pub-id-type="doi">10.1111/j.2517-6161.1995.tb02031.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muerdter</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Boryń</surname>
            <given-names>ŁM</given-names>
          </name>
          <name>
            <surname>Woodfin</surname>
            <given-names>AR</given-names>
          </name>
          <name>
            <surname>Neumayr</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Rath</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zabidi</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Resolving systematic errors in widely used enhancer activity assays in human cells</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>141</fpage>
        <lpage>149</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4534</pub-id>
        <?supplied-pmid 29256496?>
        <pub-id pub-id-type="pmid">29256496</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pennacchio</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Bickmore</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Dean</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Nobrega</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Bejerano</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Enhancers: five essential questions</article-title>
        <source>Nat Rev Genet</source>
        <year>2013</year>
        <volume>14</volume>
        <fpage>288</fpage>
        <lpage>295</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3458</pub-id>
        <?supplied-pmid 23503198?>
        <pub-id pub-id-type="pmid">23503198</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Kawaji H, Kasukawa T, Forrest A, Carninci P. The FANTOM 5 collection, a data series underpinning mammalian transcriptome atlases in diverse cell types. Sci Data. 2017;4. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5574373/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5574373/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Inoue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kircher</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Witten</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>McManus</surname>
            <given-names>MT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A systematic comparison reveals substantial differences in chromosomal versus episomal encoding of enhancer activity</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>38</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.212092.116</pub-id>
        <?supplied-pmid 27831498?>
        <pub-id pub-id-type="pmid">27831498</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Fulco CP, Munschauer M, Anyoha R, Munson G, Grossman SR, Perez EM, et al. Systematic mapping of functional enhancer-promoter connections with CRISPR interference. Science (80- ). 2016; <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/early/2016/10/05/science.aag2445">http://science.sciencemag.org/content/early/2016/10/05/science.aag2445</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Goggin</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Saadat</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sinnott-Armstrong</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-resolution genome-wide functional dissection of transcriptional regulatory regions and nucleotides in human</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-02088-w</pub-id>
        <pub-id pub-id-type="pmid">29317637</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixit</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Parnas</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fulco</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Jerby-Arnon</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Perturb-Seq: dissecting molecular circuits with scalable single-cell RNA profiling of pooled genetic screens</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>167</volume>
        <fpage>1853</fpage>
        <lpage>1866.e17</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.11.038</pub-id>
        <pub-id pub-id-type="pmid">27984732</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xie</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Duan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Hon</surname>
            <given-names>GC</given-names>
          </name>
        </person-group>
        <article-title>Multiplexed engineering and analysis of combinatorial enhancer activity in single cells</article-title>
        <source>Mol Cell</source>
        <year>2017</year>
        <volume>66</volume>
        <fpage>285</fpage>
        <lpage>299.e5</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2017.03.007</pub-id>
        <pub-id pub-id-type="pmid">28416141</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gasperini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>McFaline-Figueroa</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>MD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A genome-wide framework for mapping gene regulation via cellular genetic screens</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>176</volume>
        <fpage>377</fpage>
        <lpage>390.e19</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.11.029</pub-id>
        <pub-id pub-id-type="pmid">30612741</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hendrix</surname>
            <given-names>DA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>LinearFold: linear-time approximate RNA folding by 5′-to-3′ dynamic programming and beam search</article-title>
        <source>Bioinformatics.</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>i295</fpage>
        <lpage>i304</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz375</pub-id>
        <?supplied-pmid 31510672?>
        <pub-id pub-id-type="pmid">31510672</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lorenz</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Höner zu Siederdissen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Tafer</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Flamm</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ViennaRNA Package 2.0</article-title>
        <source>Algorithms Mol Biol</source>
        <year>2011</year>
        <volume>6</volume>
        <fpage>26</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-6-26</pub-id>
        <?supplied-pmid 22115189?>
        <pub-id pub-id-type="pmid">22115189</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Disney</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Childs</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Schroeder</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Zuker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Incorporating chemical modification constraints into a dynamic programming algorithm for prediction of RNA secondary structure</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2004</year>
        <volume>101</volume>
        <fpage>7287</fpage>
        <lpage>7292</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0401799101</pub-id>
        <pub-id pub-id-type="pmid">15123812</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Lee D. STARRPeaker: uniform processing and accurate identification of STARR-seq active regions. Github. 2020; <ext-link ext-link-type="uri" xlink:href="http://github.com/gersteinlab/starrpeaker">http://github.com/gersteinlab/starrpeaker</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <mixed-citation publication-type="other">Lee D, Shi M, Moran J, Wall M, Zhang J, Liu J, et al. STARRPeaker: uniform processing and accurate identification of STARR-seq active regions. ENCODE Project. 2020; <ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/functional-characterization-experiments">https://www.encodeproject.org/functional-characterization-experiments</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Derrien</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Estellé</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Marco Sola</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Knowles</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Raineri</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Guigó</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast computation and applications of genome mappability</article-title>
        <source>PLoS One</source>
        <year>2012</year>
        <volume>7</volume>
        <fpage>e30377</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0030377</pub-id>
        <?supplied-pmid 22276185?>
        <pub-id pub-id-type="pmid">22276185</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
