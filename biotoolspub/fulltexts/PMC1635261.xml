<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">Nucleic Acids Research</journal-id>
    <journal-title>Nucleic Acids Research</journal-title>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1635261</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkl585</article-id>
    <article-id pub-id-type="pmid">17041233</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Computational Biology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A graph-based motif detection algorithm models complex nucleotide dependencies in transcription factor binding sites</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Naughton</surname>
          <given-names>Brian T.</given-names>
        </name>
        <xref ref-type="corresp" rid="cor1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fratkin</surname>
          <given-names>Eugene</given-names>
        </name>
        <xref rid="au1" ref-type="aff">1</xref>
        <xref ref-type="corresp" rid="cor1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Batzoglou</surname>
          <given-names>Serafim</given-names>
        </name>
        <xref rid="au1" ref-type="aff">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brutlag</surname>
          <given-names>Douglas L.</given-names>
        </name>
      </contrib>
      <aff>
        <institution>Department of Biochemistry</institution>
        <addr-line>CA 94305, USA</addr-line>
      </aff>
      <aff id="au1">
        <sup>1</sup>
        <institution>Department of Computer Science, Stanford University</institution>
        <addr-line>CA 94305, USA</addr-line>
      </aff>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><sup>*</sup>To whom correspondence should be addressed. Tel: 650 723 5976; Fax: 650 723 6783; Email: <email>briannau@stanford.edu</email></corresp>
      <fn>
        <p><sup>*</sup>Correspondence may also be addressed to Eugene Fratkin. Email: <email>fratkin@cs.stanford.edu</email></p>
      </fn>
    </author-notes>
    <!--For NAR: both ppub and collection dates generated for PMC processing 1/27/05 beck-->
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2006</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>11</month>
      <year>2006</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>11</month>
      <year>2006</year>
    </pub-date>
    <volume>34</volume>
    <issue>20</issue>
    <fpage>5730</fpage>
    <lpage>5739</lpage>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>6</month>
        <year>2006</year>
      </date>
      <date date-type="rev-recd">
        <day>25</day>
        <month>7</month>
        <year>2006</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>7</month>
        <year>2006</year>
      </date>
    </history>
    <copyright-statement>© 2006 The Author(s)</copyright-statement>
    <copyright-year>2006</copyright-year>
    <license license-type="openaccess">
      <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
    </license>
    <abstract>
      <p>Given a set of known binding sites for a specific transcription factor, it is possible to build a model of the transcription factor binding site, usually called a motif model, and use this model to search for other sites that bind the same transcription factor. Typically, this search is performed using a position-specific scoring matrix (PSSM), also known as a position weight matrix. In this paper we analyze a set of eukaryotic transcription factor binding sites and show that there is extensive clustering of similar <italic>k</italic>-mers in eukaryotic motifs, owing to both functional and evolutionary constraints. The apparent limitations of probabilistic models in representing complex nucleotide dependencies lead us to a graph-based representation of motifs. When deciding whether a candidate <italic>k</italic>-mer is part of a motif or not, we base our decision not on how well the <italic>k</italic>-mer conforms to a model of the motif as a whole, but how similar it is to specific, known <italic>k</italic>-mers in the motif. We elucidate the reasons why we expect graph-based methods to perform well on motif data. Our MotifScan algorithm shows greatly improved performance over the prevalent PSSM-based method for the detection of eukaryotic motifs.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>A transcription factor is a protein that binds to a transcription factor binding site, and, in doing so, regulates the expression of a nearby gene. Transcription factor binding sites (TFBS) are short DNA sequences (usually between 5 and 20 bp) that generally conform to a consensus but individually may exhibit considerable variability. These short sequences are also called DNA motifs. In this paper, we will refer to the models representing a set of transcription factor binding sites as motifs, and the individual <italic>k</italic>-mers that comprise them as motif occurrences. Finding these binding sites is an important biological problem stymied by the lack of practical experimental methods to assay transcription factor binding under a wide variety of conditions (<xref ref-type="bibr" rid="b1">1</xref>). The development of more accurate computational methods for detecting these binding sites would lead to deeper insights into complex biological processes such as development, differentiation, and oncogenesis.</p>
    <p>To date, most computational biologists working in the area of DNA motifs have focused on the problem of <italic>de novo</italic> motif detection. This problem can be summarized as follows: given a set of DNA sequences that are thought to utilize a common binding site, identify these sites by searching for a set of similar <italic>k</italic>-mers that are statistically over-represented in these sequences. The canonical example of this problem is searching for transcription factor binding sites in the promoters of co-expressed genes. This problem is often referred to as the motif-finding problem. This problem has been addressed dozens of times, and has led to the development of numerous algorithms, including MEME (<xref ref-type="bibr" rid="b2">2</xref>) AlignAce (<xref ref-type="bibr" rid="b3">3</xref>), Weeder (<xref ref-type="bibr" rid="b4">4</xref>) and BioProspector (<xref ref-type="bibr" rid="b5">5</xref>). We have developed a <italic>de novo</italic> motif-finding algorithm based on similar principles to this manuscript (<xref ref-type="bibr" rid="b6">6</xref>).</p>
    <p>An equally important, but relatively unappreciated problem, is the detection of new occurrences of known motifs. This problem is crucial to many biologists. Whenever a novel gene or transcript is detected, one of the first questions that will be asked is whether there are known binding sites in its promoter. Thanks to the recent development of tiling arrays (<xref ref-type="bibr" rid="b7">7</xref>) and other high-throughput technologies, we are on the verge of detecting huge numbers of new transcripts in all eukaryotic model organisms, yet sensitive methods for detecting the binding sites that control the expression of these transcripts are lacking.</p>
    <p>Typically, methods tackling this problem have focused on weight matrix-based methods, or more complex probabilistic models that also model nucleotide dependencies. In this paper, we analyze the distribution of <italic>k</italic>-mers in a large number of eukaryotic motifs, and find complex dependencies that are not easily modeled probabilistically. We show that the inherent complexities in <italic>k</italic>-mer distribution are due to both functional and evolutionary effects, and leverage this analysis to develop a novel, graph-based algorithm for the detection of transcription factor binding sites.</p>
    <sec>
      <title>The position-specific scoring matrix</title>
      <p>By far the most common representation of DNA motifs is the position-specific scoring matrix (PSSM), also known as a position weight matrix (PWM). Stormo describes the PSSM in detail (<xref ref-type="bibr" rid="b8">8</xref>). In a PSSM, the motif is of fixed size. Each position in themotif has four associated probabilities: the probability of an A, G, C and T at that position. The positions are assumed to be independent, so a PSSM defines a product multinomial model: one can calculate a score for a <italic>k</italic>-mer given a motif model by simply multiplying the probabilities of each nucleotide in the <italic>k</italic>-mer at each position (or, more typically, summing the logs of the probabilities). The most popular motif scanning method, TESS (<xref ref-type="bibr" rid="b9">9</xref>), uses a PSSM representation of motifs.</p>
    </sec>
    <sec>
      <title>Modeling nucleotide dependencies in motifs</title>
      <p>Though the PSSM assumes the independence of positions in the motif, it has been noted several times that some motifs exhibit significant dependencies between positions (<xref ref-type="bibr" rid="b10">10</xref>–<xref ref-type="bibr" rid="b12">12</xref>). There are two principal ways that nucleotide dependencies could emerge. First, a change in the sequence of a binding site could require a compensatory change elsewhere in the site, modifying its protein binding characteristics. Alternatively, if the occurrences of the motif are related to one another through evolution, and not created anew each time, then we expect to see a phylogeny of <italic>k</italic>-mers within the motif. These intramotif relationships could result in significant dependencies, even in the absence of selection pressure. There have been several attempts to use richer representations of the motif to model nucleotide dependencies between positions, some of which we describe below.</p>
      <p>Barash <italic>et al</italic>. (<xref ref-type="bibr" rid="b13">13</xref>) developed a number of Bayesian network representations of varying complexity for modeling motifs, with the intent of relaxing the independence assumption of the PSSM, and described methods for learning these models. They developed an Expectation Maximization method that could learn the structure of the model while performing <italic>de novo</italic> motif finding. The authors showed that their expressive motif models improve upon the sensitivity and specificity of PSSM-based motif detection for simulated data and yeast regulatory sequences. As is typical with Bayesian networks, there is a crucial issue of how complex the network should be. If there are too many parameters, then the model requires a lot of data to train; too few, and the model falls short of its potential expressive power.</p>
      <p>Zhou and Liu (<xref ref-type="bibr" rid="b12">12</xref>) described another, simpler extension to the PSSM model. In their formulation, they incorporate only pairs of non-overlapping correlated positions. They then learn the model using a Markov chain Monte Carlo method. By their estimation, 25% of experimentally verified motifs in the TRANSFAC database show statistically significant correlations between positions. They incorporated this method into a Gibbs sampling algorithm and showed improved performance in <italic>de novo</italic> motif finding.</p>
      <p>Other analyses, such as that of Xing and Karp (<xref ref-type="bibr" rid="b14">14</xref>), have incorporated prior experimental data on the characteristics of certain transcription factor binding domain interactions into a Bayesian framework. Their MotifPrototyper models incorporate generic structural signatures from classes of transcription factor binding sites, which they can generalize to novel motifs belonging to the same family. This approach shows great promise, since most transcription factors use one of a small number of types of DNA binding domains.</p>
      <p>Relying on complex, heavily parameterized models can be problematic, especially if their underlying assumptions do not hold. King and Roth (<xref ref-type="bibr" rid="b15">15</xref>) developed a simple non-parametric method for motif detection, based on the PSSM. Their method interpolates between a standard PSSM, based on all of the occurrences of the motif, and a mixture of PSSMs, where each occurrence of the motif is modeled by its own PSSM. Their model can identify members of the motif that would be outliers using a PSSM model. The authors note that this non-parametric framework can model arbitrary dependencies, albeit without describing what those dependencies are.</p>
    </sec>
    <sec>
      <title>Motivation for a graph-based method of motif detection</title>
      <p>As motivation for the development of this algorithm, we offer an example of how a PSSM model can act contrary to our expectations, even for a very simple motif. This example applies analogously to more complex probabilistic models. We imagine a motif model comprised of three <italic>k</italic>-mers: AAA, AAA and AGG. Using a PSSM, a candidate <italic>k</italic>-mer, AGG, gets a score of 1.0 × 0.33 × 0.33. A candidate AAG <italic>k</italic>-mer scores 1.0 × 0.67 × 0.33. Therefore AAG scores higher than AGG, despite the fact that we have evidence that the protein binds AGG, but no such evidence exists for AAG. Using a probabilistic model, we cannot ensure that an exact match always scores higher than an inexact match. This is a desirable property if we believe the known <italic>k</italic>-mers from the motif are an unbiased sample of the true motif.</p>
      <p>Many biologists would be surprised to learn that an exact match to a known transcription factor binding site may be missed when they use a PSSM to search a DNA sequence. We also note that the addition of new AGG <italic>k</italic>-mers to the model significantly reduces the score that a candidate AAA will achieve. Therefore, with a probabilistic model, these additional AGG <italic>k</italic>-mers act not only as evidence for AGG, but also as evidence against AAA.</p>
      <p>We can think of the PSSM approach as measuring the distance of a candidate <italic>k</italic>-mer from the ‘centroid’ of the motif model. In the case of a mixture of PSSMs, it would be a weighted average distance between the candidate <italic>k</italic>-mer and a number of PSSM ‘centroids’. However, a candidate <italic>k</italic>-mer that is close in sequence to a subset of <italic>k</italic>-mers in the motif, but not necessarily its ‘centroid’ is still likely to be a true member of the motif. For this reason, it makes more sense to evaluate a candidate <italic>k</italic>-mer based on its nearest neighbors, rather than a model of the entire motif.</p>
    </sec>
  </sec>
  <sec sec-type="materials|methods">
    <title>MATERIALS AND METHODS</title>
    <sec>
      <title>Calculating pairwise nucleotide dependencies in motifs</title>
      <p>We gauged the degree of correlation between two columns in a motif alignment using chi-square values, and used a Monte Carlo simulation to estimate <italic>P</italic>-values.</p>
      <p>The formula for the chi-square value is given below.
<disp-formula id="e1"><label>1</label><mml:math id="M1"><mml:mrow><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>O</mml:mi><mml:mo>−</mml:mo><mml:mi>E</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mi>E</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
For a pair of positions in a motif, the observed frequency of a pair of nucleotides is simply the number of times that pair occurs together in the <italic>k</italic>-mers of the motif. The expected frequency of a pair of nucleotides is the product of the frequency of each nucleotide in its respective column. For each motif in each dataset we calculated a chi-square value for every pair of positions, and noted the maximum chi-square value for that motif. We also generated a distribution of maximum chi-square values for this motif. We randomly permuted the columns of the motif alignment at each position, removing all positional dependencies, and calculated the maximum chi-square value for all pairs of positions. After one million iterations, we obtain a null distribution of maximum chi-square values, with which we can assign a <italic>P</italic>-value to our original motif. There are two reasons we did not directly use the chi-square <italic>P</italic>-value. First, there are a number of hypothesis tests being performed in each motif, one for each pair of positions, which must be corrected for. Furthermore, the accuracy of this <italic>P</italic>-value is in doubt if the number of motif members is small. By randomly generating a distribution of these minimum <italic>P</italic>-values for each motif, we ameliorate these problems.</p>
      <p>Since we tested a number of motifs for significant dependencies, we also required a multiple hypothesis test correction. Here we used the R package q-value (<xref ref-type="bibr" rid="b16">16</xref>) and its default parameters to turn our <italic>P</italic>-values into q-values, and so control the false discovery rate (FDR).</p>
    </sec>
    <sec>
      <title>Nucleotide substitution rates</title>
      <p>Given a <italic>k</italic>-mer from a motif, we calculated the prior probability that another randomly chosen <italic>k</italic>-mer from the motif will have a substitute nucleotide at each position. As an example, we consider a motif where the first column in the alignment has nine As and two Gs. For a <italic>k</italic>-mer in the motif with an A at this position, the probability that another <italic>k</italic>-mer in the motif chosen at random will have a G as a substitute is 20%. Here, we use the notation <inline-formula><mml:math id="M2"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>∣</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula>; similarly, <inline-formula><mml:math id="M3"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>∣</mml:mo><mml:mi>A</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M4"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>G</mml:mi><mml:mo>∣</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M5"><mml:mrow><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>A</mml:mi><mml:mo>∣</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>. These probabilities apply to one position in one motif, but we would like to know the expected probabilities over all positions in all motifs. For each position in each motif, we calculated the probability that nucleotide β was a substitute for nucleotide α. We weighted this probability by the probability that this nucleotide came from this position, given α. For example, if there is an A at this position, then it is more likely to have come from an A-rich position. The formula, along with the necessary normalization, is given in <xref ref-type="disp-formula" rid="e2">Equation 2</xref> below.</p>
      <p>For α, β, γ ∈{<italic>A, C, G, T</italic>}, and given <italic>N</italic> columns in total, then
<disp-formula id="e2"><label>2</label><mml:math id="M6"><mml:mrow><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>∣</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover></mml:mstyle><mml:mtext> </mml:mtext><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>∣</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover></mml:mstyle><mml:mtext> </mml:mtext><mml:munder><mml:mo>∑</mml:mo><mml:mi>γ</mml:mi></mml:munder><mml:mtext> </mml:mtext><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>γ</mml:mi><mml:mo>∣</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>α</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></disp-formula>
By averaging the values for all of the columns in all of the motif alignments, we obtain a 4 × 4 matrix, where each column in the matrix contains the probability that given a specific nucleotide in a motif, we will see each of the 4 nt at the same position in another <italic>k</italic>-mer in the motif. The matrices for yeast and JASPAR are given in <xref ref-type="table" rid="tbl1">Table 1</xref>.</p>
      <sec>
        <title>Training the algorithm on simulated motifs</title>
        <p>We trained the two parameters of our algorithm, Θ<italic><sub>SS</sub></italic> and Θ<italic><sub>IK</sub></italic>, as follows. We randomly generated a set of 1000 motifs, where the information content and length of the motif is sampled from the averaged distributions from yeast and JASPARmotifs. These simulated motifs had no specific dependencies introduced. We used a simple hill-climbing algorithm to train, and the same ROC curve as described in the Testing the Algorithm on Real Data as a measure of performance. Finally, we trained the same parameters on the yeast and JASPAR motifs individually. Gratifyingly, the parameter values were the same for all three experiments. For the three experiments, Θ<italic><sub>SS</sub></italic> and Θ<italic><sub>IK</sub></italic> came out to be 0.7 and 0.3, respectively. These values are robust to small changes in value. For fairness, the optimal number of pseudocounts used by the PSSM (the sole adjustable parameter of the PSSM) was also trained based on the same set of motifs and the same conditions.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>RESULTS</title>
    <sec>
      <title>The motif data set</title>
      <p>The complete dataset we use consists of a set of yeast motifs, and a set of motifs from multicellular eukaryotes. The yeast data comes from a genome-wide study by Harbison <italic>et al</italic>. (<xref ref-type="bibr" rid="b17">17</xref>) We retrieved occurrences from 102 motifs identified in <italic>Saccharomyces cerevisiae</italic> as having a <italic>P</italic>-value of &lt;0.001 and as being conserved in at least one other yeast genome (<ext-link ext-link-type="uri" xlink:href="http://jura.wi.mit.edu/fraenkel/download/release_v24/GFF"/>). The authors discovered these motifs by analysis of ChIp–chip data with a number of different motif-finding algorithms, a literature review and comparative genomics. We also retrieved occurrences from 95 of 106 motifs from the JASPAR database (<xref ref-type="bibr" rid="b18">18</xref>) for which <italic>k</italic>-mers as well as weight matrices are available. The JASPAR database is a curated set of motifs from multicellular eukaryotes, 49 of which are human. For all of the following experiments, we use 63 yeast motifs and 90 JASPAR motifs that contain 10 or more <italic>k</italic>-mers and &gt;1 unique <italic>k</italic>-mer.</p>
      <sec>
        <title>Complex nucleotide dependencies in motifs</title>
        <p>In this section we analyze the distribution of <italic>k</italic>-mers in eukaryotic motifs, and show that there are extensive nucleotide dependencies, which we identify as clusters of <italic>k</italic>-mers in a graphical representation of the motif. This clustering makes motifs inherently difficult to model probabilistically. Specifically, we demonstrate how the PSSM falls short in modeling these motifs.</p>
        <p><italic>Pairwise dependencies</italic>: First, like Zhou and Liu (<xref ref-type="bibr" rid="b12">12</xref>), we calculated how many motifs have at least one pair of positions with a statistically significant nucleotide dependency (for more details see Materials and Methods). At a FDR of 5%, we find 18 out of 63 yeast motifs tested, or ∼29%, show significant pairwise dependencies. In the JASPAR database, we find 24 of 90 motifs, or ∼27%, with significant dependencies. These values are in agreement with Zhou and Liu's findings for TRANSFAC motifs (<xref ref-type="bibr" rid="b12">12</xref>,<xref ref-type="bibr" rid="b19">19</xref>).</p>
        <p>Pairwise dependencies like these can be modeled fairly easily in a weight matrix model, by simply including the conditional probabilities at each correlated position. However, pairwise dependencies are not the only possible type of dependency. In order to analyze more complex dependencies, we use a graph-based representation of motifs. Here, <italic>k</italic>-mers are represented as nodes in the graph, and edges connect nodes if the Hamming distance (number of mutations) between the two <italic>k</italic>-mers is below a certain threshold. A pairwise dependency will make a cluster in the graph for each correlated nucleotide pair; other types of dependencies will result in different clustering patterns. For instance, a set of exact matches in the motif may not produce a significant pairwise dependency, but will appear as a clique in the graph. A combination of dependencies that individually may not be statistically significant may still alter the graph structure in identifiable ways. We call these dependencies due to <italic>k</italic>-mer clustering complex dependencies to differentiate them from pairwise dependencies.</p>
        <p><italic>Complex dependencies</italic>: The PSSM representation of the motif maintains the correct nucleotide distribution at each position in the motif but eliminates any other structural information. Therefore comparing real motif graphs with graphs generated using PSSMs serves two purposes: it gives us a baseline against which we can compare the structure of real motif graphs, and highlights areas where the PSSM fails to correctly model the motifs. For each motif in the dataset, we constructed a PSSM. We then randomly generated 10 000 motifs using this PSSM as a basis, each with the same number of <italic>k</italic>-mers as the original motif, and constructed a graph for each. This population of graphs is the benchmark against which we compare the true motif graphs.</p>
        <p>To measure the overall amount of clustering in each graph we use the clustering coefficient (<xref ref-type="bibr" rid="b20">20</xref>). If we define the neighborhood of a vertex as the vertices directly connected to it, then the clustering coefficient of this vertex is simply the number of edges in its neighborhood, divided by the total number of possible edges in the neighborhood. The clustering coefficient for the graph is the average value for all vertices. The higher the clustering coefficient, the more clustered the graph is, and generally, the more dependencies there are in the motif. Duplicate <italic>k</italic>-mers are a common source of clustering in the graph, and will turn out to be useful in our experiments, therefore as another measure of clustering we count the number of <italic>k</italic>-mers in each motif that are duplicates of any other <italic>k</italic>-mer in the same motif.</p>
        <p>We find that in yeast, the clustering coefficient of real motifs is greater than the average clustering coefficient in the PSSM-generated motifs in 32 cases, and fewer in 9 cases. The average clustering coefficient is ∼1.25 times greater in real motifs than in the PSSM-generated motifs. For the JASPAR motifs, the clustering coefficient is greater in real motifs in 33 cases, and fewer in 4 cases, and the average clustering coefficient is ∼1.5 times greater in real motifs than in the PSSM-generated motifs. Therefore there is significantly more clustering in real motifs than in the PSSM-generated motifs, and the difference is much more significant than a measure of pairwise dependencies alone would indicate.</p>
        <p>The number of duplicate <italic>k</italic>-mers is greater in real yeast motifs than the average PSSM-generated motif in 40 cases, and fewer in only 6 cases. In JASPAR, the number of duplicate <italic>k</italic>-mers is greater in real motifs in 42 cases, and fewer in only 8 cases. The high number of duplicate <italic>k</italic>-mers will not come as a surprise to many biologists. However, when attempting to describe a <italic>k</italic>-mer distribution probabilistically, a group of duplicate <italic>k</italic>-mers will act like a spike of probability density for this particular sequence. Large deviations in probability density like this are inherently difficult to parameterize. It follows that if there are more duplicate <italic>k</italic>-mers in real motifs, then the number of unique <italic>k</italic>-mers is necessarily fewer in these motifs, so that the sequence of these motifs is more constrained than the nucleotide distribution alone indicates.</p>
        <p>In sum, these experiments demonstrate that the distribution of <italic>k</italic>-mers in motifs deviates from the distribution implied by the nucleotide distribution in highly significant, and sometimes surprising ways. These complex dependencies manifest as clusters in the graph. For a given motif, it is difficult to predict how the distribution of <italic>k</italic>-mers will behave, and because of this, parameterizing these distributions is difficult. The wide variety of possible motif structures is evident in <xref ref-type="fig" rid="fig1">Figure 1</xref>.</p>
      </sec>
    </sec>
    <sec>
      <title>Motif clustering and gene expression</title>
      <p>The non-random distribution of <italic>k</italic>-mers in motifs we observed, and especially the overabundance of duplicate <italic>k</italic>-mers, is evidence that there may be selection pressure acting to maintain particular motif sequences. If a motif sequence is specifically selected for, then it is possible that this sequence affects the expression of its associated genes (<xref ref-type="bibr" rid="b21">21</xref>). If this is the case, then clusters in the motif graph correspond to clusters of gene expression.</p>
      <p>To investigate this effect in more depth, we used three yeast microarray experiments downloaded from the Stanford Microarray Database (<ext-link ext-link-type="uri" xlink:href="http://smd.stanford.edu"/>), from the papers Segal <italic>et al</italic>. (<xref ref-type="bibr" rid="b22">22</xref>), Brauer <italic>et al</italic>. (<xref ref-type="bibr" rid="b23">23</xref>) and Wang <italic>et al</italic>. (<xref ref-type="bibr" rid="b24">24</xref>). Brauer <italic>et al</italic>. (<xref ref-type="bibr" rid="b23">23</xref>) measured gene expression in response to glucose limitation, Segal <italic>et al</italic>. (<xref ref-type="bibr" rid="b22">22</xref>) measured gene expression under a broad set of conditions, and Wang <italic>et al</italic>. (<xref ref-type="bibr" rid="b24">24</xref>) measured the rate of mRNA decay. We limited our investigation to motif occurrences that were present alone in the promoters of genes. Including promoters that contain several different motifs would make it difficult to infer expression changes due to the sequence of the individual motif. For each pair of <italic>k</italic>-mers in each motif that fulfill this criterion, we calculated the Hamming distance, and measured the co-expression of their respective genes using a Pearson correlation. Then, for each motif, we have a list of Hamming distances and the associated gene expression correlation.</p>
      <p>As one might expect, the data are noisy, so to improve the specificity of these results we combined data from all three microarray experiments. We tested to see if there was a statistically significant correlation (<italic>P</italic> &lt; 0.01) between Hamming distance and co-expression using Kendall's tau, a rank-based measure of correlation. We find that out of a total of 33 motifs for which there is sufficient data available, 7 have statistically significant negative correlations in all three microarray experiments. In other words, for these motifs, similar <italic>k</italic>-mers have similar expression patterns and clusters of <italic>k</italic>-mers in the motif graph correlate with clusters of gene expression. The seven motifs are YDR026c, DAL82, BAS1, SPT23, HAP4, ADR1 and MBP1. No motifs were foundto have statistically significant positive correlations in all three experiments. The most obvious example of clustering affecting gene expression is ADR1 (<xref ref-type="fig" rid="fig1">Figure 1b</xref>), which has two unconnected clusters.</p>
      <p>The eventual goal of the analysis of transcription factor binding sites is to understand the expression of the genes that are under their control. Most current analyses of gene expression that utilize motifs note the presence or absence of motifs in the promoter of a gene, but do not pay heed to the actual sequence of the motifs. Here we have shown that the <italic>k</italic>-mer clusters we see in the motifs graphs are functionally relevant in some cases, perhaps gaining the cell finer control over gene expression.</p>
    </sec>
    <sec>
      <title>Motif clustering and DNA duplication</title>
      <p>The clustering of <italic>k</italic>-mers with similar gene expression patterns explains a fraction of the clustering we see in yeast motifs. Here we show how evolution may also play a significant role. Clusters of <italic>k</italic>-mers could occur due to selection pressure and convergent evolution, as suggested by the gene expression example above; these clusters could also be due to <italic>k</italic>-mers being related through relatively recent duplication events.</p>
      <p>To test whether <italic>k</italic>-mers in yeast motifs could be related through recent DNA duplications, we analyzed the conservation of nearby motif occurrences and the DNA flanking these occurrences. For each motif, we took every pair of <italic>k</italic>-mers located fewer than 100 nt apart (but not overlapping), and calculated the probability of these <italic>k</italic>-mers being identical, compared with <italic>k</italic>-mers &gt;100 nt apart. We find that motif occurrences 100 bases or fewer apart are 25% more likely to be identical than those &gt;100 bases apart, indicating that these cases might be due to tandem DNA duplications. However, this similarity may also be explained by variations in GC content.</p>
      <p>We calculated the amount of conservation in the 10 nt flanking each side of the motif occurrences. We find that for a pair of identical <italic>k</italic>-mers fewer than 100 nt apart, the DNA flanking these <italic>k</italic>-mers is significantly more conserved than for a pair of non-identical <italic>k</italic>-mers from the same motif. The results of this experiment are shown in <xref ref-type="fig" rid="fig2">Figure 2</xref>. This data again suggest that some nearby, identical motif occurrences are related through duplication events. The alternative, that the flanking DNA has functional significance, requires that the conserved flanking positions be dependent on other positions in the motif. This is certainly possible, particularly for the nearest flanking positions (i.e. the motif is 1 nt longer than reported, and dependent on another nucleotide within the motif), but is more unlikely for positions further away.</p>
      <p>Therefore we believe that clusters in the motif graphs emerge partly due to evolutionary effects, where some binding sites are the product of DNA duplication events that generate a phylogeny of <italic>k</italic>-mers in the graph. These relationships naturally leads to more clustering, and more exact matches in the graph. There is some evidence that short DNA duplications are common in eukaryotic genomes (<xref ref-type="bibr" rid="b25">25</xref>). In yeast, tandem duplications followed by chromosomal rearrangements have been suggested as a common evolutionary mechanism (<xref ref-type="bibr" rid="b26">26</xref>,<xref ref-type="bibr" rid="b27">27</xref>), and gene duplications are also common (<xref ref-type="bibr" rid="b28">28</xref>). However, unlike the evolution of genes, motif evolution need not rely on DNA duplications (<xref ref-type="bibr" rid="b29">29</xref>).</p>
    </sec>
    <sec>
      <title>Nucleotide substitution rates in motifs</title>
      <p>Before we describe the algorithm itself, there is one final analysis that will prove important. One major advantage of a graph-based method over a probabilistic method for the motif detection problem is that because we retain all known motif occurrences in the model, we can identify the individual substitutions that would be required for the candidate <italic>k</italic>-mer to become a known motif <italic>k</italic>-mer. The rate of nucleotide substitution in motifs is significantly non-uniform, so this information becomes extremely useful for motif detection. Accordingly, we calculated empirical nucleotide substitution frequencies in eukaryotic motifs for use in our algorithm. Specifically, we calculated the likelihood of each nucleotide substituting for every other in each motif in the dataset. These frequencies are shown in <xref ref-type="table" rid="tbl1">Table 1</xref>. For details of how the table was generated see Materials and Methods.</p>
      <p>Under neutral selection pressure, transitions are more common than transversions (<xref ref-type="bibr" rid="b30">30</xref>). We also see this trend in nucleotide substitution rates in motifs. This is not surprising since purines are biochemically similar to purines and pyrimidines to pyrimidines, which we expect to make a difference for protein binding. This effect is significant in yeast and JASPAR motifs, with some substitutions being up to 50% more likely than others. One might also expect that a nucleotide's complement would be a likely substitute since the base pair at that position would remain the same; however, unlike the transition–transversion effect, this is not always the case. We can leverage the data in these matrices in our algorithm. For instance, for a JASPAR motif comprised of CAA <italic>k</italic>-mers, we know that the prior probability that TAA is also a <italic>k</italic>-mer in the motif is 50% higher than GAA. In a weight matrix, this information is absent.</p>
    </sec>
    <sec>
      <title>The motif detection algorithm</title>
      <p>Our method differs from those discussed in the introduction in a two key ways, which are justified by our analysis of transcription factor binding sites. First, our scheme takes a nearest-neighbor approach to motif detection. Similar to the <italic>k</italic>-nearest neighbors classification method, a candidate <italic>k</italic>-mer's score is based on a comparison with the most similar members of the motif, not on a model based on the motif as a whole. Therefore we do not abstract the <italic>k</italic>-mers of the motif to another representation, but retain all known motif members in our model. Second, we incorporate prior probabilities of nucleotide substitutions within motifs into our score. Our experiments have demonstrated significant differences in these probabilities.</p>
      <sec>
        <title>MotifScan's scoring system</title>
        <p>To score a candidate <italic>k</italic>-mer with our model, we first define what it means to be a good candidate <italic>k</italic>-mer for a motif, and outline a heuristic based on that. We describe three desiderata here:
<list list-type="roman-lower"><list-item><p><italic>Sequence Similarity (SS)</italic>: The candidate should be close in sequence to at least one member of the motif. The fewer mutations it is from this matching <italic>k</italic>-mer, the higher the score should be.</p></list-item><list-item><p><italic>Identical k-mers (IK)</italic>: The more copies of this matching <italic>k</italic>-mer there are in the motif, the higher the score should be. The more times a <italic>k</italic>-mer appears, the more likely it is that a closely related <italic>k</italic>-mer is also part of the motif. We refer to a number of duplicate copies of a <italic>k</italic>-mer in the motif as an ‘identity group’.</p></list-item><list-item><p><italic>Identity group similarity (IGS)</italic>: The greater the number of identity groups of <italic>k</italic>-mers in the motif similar to the candidate, the higher the score should be. Each new identity group is evidence in favor of this candidate.</p></list-item></list></p>
        <p>In total, there are two parameters to train, corresponding to the first two desiderata. The third desideratum is omitted, since the optimal value was found to be very close to unity. Each parameter is raised to an exponent, which depends on properties of the motif (see <xref ref-type="disp-formula" rid="e3">Equation 3</xref> below). The first parameter, Θ<italic><sub>SS</sub></italic>, determines the relative score of zero mutations versus one, two or more mutations. We score successive numbers of mutations as <inline-formula><mml:math id="M7"><mml:mrow><mml:msubsup><mml:mo>Θ</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <italic>d</italic> is the number of mutations. For example, if we choose Θ<italic><sub>SS</sub></italic> to be 0.5, then a motif <italic>k</italic>-mer two mutations from the candidate <italic>k</italic>-mer contributes 0.25 (0.5<sup>2</sup>) as much to the final score as an exact match. The second parameter, Θ<italic><sub>IK</sub></italic>, determines how much we value additional <italic>k</italic>-mers in an identity group. Here the exponent is the number of <italic>k</italic>-mers in the identity group. If we choose Θ<italic><sub>IK</sub></italic> to be 0.5, then an identity group of two members contributes 1.5 times (0.5 + 0.25) as much to our score as an identity group of one member (0.5), and an identity group of three members contributes 1.75 times as much (0.5 + 0.25 + 0.125). For details on how these parameters were trained see Materials and Methods.</p>
        <p>he <italic>k</italic>-mer with more likely substitutions. Then the score for the candidate is calculated according to <xref ref-type="disp-formula" rid="e3">Equation 3</xref>. A simple example in <xref ref-type="fig" rid="fig3">Figure 3</xref> illustrates the process. The score for a candidate <italic>k</italic>-mer is calculated according to <xref ref-type="disp-formula" rid="e3">Equation 3</xref>. A simple example in <xref ref-type="fig" rid="fig3">Figure 3</xref> illustrates the process.
<disp-formula id="e3"><label>3</label><mml:math id="M8"><mml:mrow><mml:mtext>Score</mml:mtext><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover></mml:mstyle><mml:mtext> </mml:mtext><mml:msubsup><mml:mo>Θ</mml:mo><mml:mrow><mml:mtext>SS</mml:mtext></mml:mrow><mml:mi>d</mml:mi></mml:msubsup><mml:msub><mml:mo>Θ</mml:mo><mml:mrow><mml:mtext>NS</mml:mtext><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover></mml:mstyle><mml:mtext> </mml:mtext><mml:msubsup><mml:mo>Θ</mml:mo><mml:mrow><mml:mtext>IK</mml:mtext></mml:mrow><mml:mi>j</mml:mi></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Here <italic>N</italic> is the total number of unique <italic>k</italic>-mers, <italic>d</italic> is the Hamming distance and <italic>n<sub>i</sub></italic> is the number of <italic>k</italic>-mers in identity group <italic>i</italic>. Θ<sub>NS(<italic>b1,b2</italic>)</sub> (the nucleotide substitution parameter) is the appropriate value from our nucleotide substitution matrix, where <italic>b</italic>1 (the nucleotide in the candidate <italic>k</italic>-mer) is substituting for <italic>b</italic>2 (the nucleotide in the motif <italic>k</italic>-mer). If <italic>d</italic> is greater than 1, then Θ<sub>NS(<italic>b1,b2</italic>)</sub> is the average of all of the substitution probabilities (given in <xref ref-type="table" rid="tbl1">Table 1, a and c</xref>).</p>
      </sec>
      <sec>
        <title>Pseudo-k-mers</title>
        <p>One advantage that probabilistic methods have over enumerative is the ability to generalize based on small sample sizes, owing to the inherently probabilistic nature of the model, and the addition of pseudocounts, which act as a regularizer (<xref ref-type="bibr" rid="b31">31</xref>). In a similar vein, we attempted to improve our algorithm by generating a small number of ‘pseudo-<italic>k</italic>-mers’ based on the distribution of nucleotides in our motif. The distribution of nucleotides itself uses a small pseudocount (0.1). These ‘pseudo-<italic>k</italic>-mers’ act just like pseudocounts in a PSSM, i.e. as regularizers to make small datasets ‘smoother’. After cross-validation on simulated motifs, we found that the addition of pseudo-<italic>k</italic>-mers did not improve performance.</p>
      </sec>
      <sec>
        <title>Significance tests: P-values and the false discovery rate</title>
        <p>To gauge whether a particular score is significant, we need to transform the heuristic score into a <italic>P</italic>-value. Here we describe several ways of doing this. For each of the yeast motifs, we use the probes from Harbison <italic>et al</italic>.'s (<xref ref-type="bibr" rid="b17">17</xref>) ChIp–chip experiments in which the motif did not appear to generate a null distribution of scores, which we can use to assign a <italic>P</italic>-value to any given score. These <italic>P</italic>-values will be conservative since our assumption is that the sequences used to generate the null distribution do not contain any real motif occurrences. If they do, then the resulting <italic>P</italic>-values will be less significant.</p>
        <p>For the JASPAR motifs, we use scores based on a null distribution from a uniformly random sequence of DNA. The resulting <italic>P</italic>-values are then corrected for based on the calculated GC content in the input DNA sequences, and their associated Markov dependencies. The length of the Markov chain depends on the length of the input sequences, with 20 data points required per parameter. This method is not nearly as reliable as using real data, therefore for more accurate results using these motifs, we advise using a precomputed table of Markov dependencies based on DNA similar to the input sequences (e.g. a collection of promoter DNA from the appropriate species). An even better option is to use real data to directly generate the <italic>P</italic>-value tables, as we did for yeast motifs. The appropriate background DNA to use is context-specific, depending on where in the genome one is searching.</p>
        <p>We set an upper limit on the FDR of our results using the sequential method of Benjamini and Hochberg (<xref ref-type="bibr" rid="b32">32</xref>). Although the positive FDR (pFDR) method of Storey (<xref ref-type="bibr" rid="b33">33</xref>) is more powerful, Storey states that as π<sub>0</sub>, the proportion of null hypotheses that are true, tends to 1, this method and Benjamini's methods become identical. In our case, we expect π<sub>0</sub> (the fraction of <italic>k</italic>-mers not in the motif) to be close to 1.</p>
      </sec>
      <sec>
        <title>Testing the algorithm on real data</title>
        <p>We evaluated the performance of our motif detection using leave-one-out cross-validation: (i) For every <italic>k</italic>-mer in every motif in the dataset, we generated a random DNA sequence 5000 bases long, and seeded this sequence with the <italic>k</italic>-mer. (ii) We built a PSSM model and a MotifScan model using all of the <italic>k</italic>-mers in the motif except the seeded <italic>k</italic>-mer and assigned scores to all of the positions in the sequence. Note that identical <italic>k</italic>-mers to that seeded may still exist in the motif. (iii) We sorted all of the resulting scores from all of the sequences from best to worst. As we traversed this list, we flagged each result as a true positive or a false positive.</p>
        <p>To gauge performance, we used a modified version of a receiver operating characteristic curve (<xref ref-type="bibr" rid="b34">34</xref>) (ROC curve). The ROC curve is a plot of the true positive fraction (sensitivity) versus the true negative fraction (1-specificity). The area under this curve is a measure of performance over a range of sensitivities. A modification of the ROC curve, known as the ROC<sup>50</sup>, is often used for database searching. This curve plots true positives against false positives, but only up to the first 50 false positives. The reason for doing this is that most of the ROC curve is uninformative, as there can be orders of magnitude more true negatives than true positives. We use an ROC<italic><sup>N</sup></italic> curve, which is very similar to an ROC<sup>50</sup>, with the sole change that we use <italic>N</italic> as the number of allowed false positives instead of 50, where <italic>N</italic> is the total number of <italic>k</italic>-mers in the motif. This way the number of false positives allowed scales linearly with the number of true positives in the dataset.</p>
        <p>We compared the performance of MotifScan and the PSSM by identifying motifs where one of the two methods significantly outperformed the other, and ignoring those motifs where the results were comparable. If the area under the ROC curve for a certain motif was 5% more, or greater, for one method than the other, this was counted as a win for that algorithm.</p>
        <p>With the yeast dataset, we find that 25 of 63 motifs have an area under the ROC curve at least 5% greater with our algorithm than with a PSSM. Only 1 of 63 motifs has an area at least 5% greater with a PSSM than with our algorithm. With the JASPAR dataset, the figures are 46 of 90 and 8 of 90, respectively. A list of the most significantly different motifs in each database is given in <xref ref-type="table" rid="tbl2">Table 2</xref>. The greatest improvements in ROC<italic><sup>N</sup></italic> area for MotifScan over the PSSM were 69 and 74% for the yeast and JASPAR motifs, respectively. The greatest improvements in ROC<italic><sup>N</sup></italic> area for the PSSM over MotifScan were only 6 and 13%, respectively. An Excel file containing the complete list of ROC areas is available at <ext-link ext-link-type="uri" xlink:href="http://motifscan.stanford.edu/roc_results.xls"/>.</p>
        <p><xref ref-type="fig" rid="fig1">Figure 1</xref> includes graphs of four yeast motifs and four JASPAR motifs where MotifScan performs well relative to the PSSM; specifically, for each of these graphs, the area under the ROC curve is at least 5% greater using MotifScan than using a PSSM. The graphs were chosen to be a representative subset of the complete set. There are a number of notable features in these graphs. In general, we can see that motifs have diverse structures, that clustering is prevalent, and that exact matches are common. In ADR1, we see two unconnected clusters, owing to a significant pairwise dependency. Accordingly, few of these <italic>k</italic>-mers are generated by the PSSM. MA0063, MA0082 and MA0103 have central regions where the mass of the PSSM is concentrated, and clusters of nodes at the peripheries that the PSSM rarely generates. MA0077, RCS1 and SOK2 all show significant numbers of subclusters and especially groups of exact matches. Some of these subclusters are generated by the PSSM, but many neighboring clusters are not. The yeast motif that MotifScan performs best on relative to the PSSM, SKN7, has a diffuse structure, with no obvious center. Almost none of the <italic>k</italic>-mers in this graph are generated sufficiently often by the PSSM.</p>
      </sec>
      <sec>
        <title>Using MotifScan</title>
        <p>The MotifScan algorithm can be accessed through a web-application, at <ext-link ext-link-type="uri" xlink:href="http://motifscan.stanford.edu"/>. The user may scan a DNA sequence for any or all of the yeast motifs or JASPAR motifs described above. The algorithm is also available for download at the same location. It is coded in Python (<ext-link ext-link-type="uri" xlink:href="http://www.python.org"/>), and requires Python version 2.3 or newer. MotifScan will use psyco (<ext-link ext-link-type="uri" xlink:href="http://psyco.sourceforge.net"/>) for a performance gain, if it is installed.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>DISCUSSION</title>
    <p>We have developed a novel, graph-based supervised motif detection algorithm, which addresses apparent limitations in current probabilistic models. We compared the performance of our method to that of the PSSM, the <italic>de facto</italic> standard for motif detection, for the detection of both yeast and multicellular eukaryote motifs, and showed greatly improved performance. Our experiments indicate that the PSSM, and probabilistic methods in general, are a poor fit to many eukaryotic motifs, and that enumerative methods such as ours have many advantages. We find that there is extensive clustering of <italic>k</italic>-mers in eukaryotic motifs, which is substantially different from the prevailing ‘diffused consensus’ (or consensuses) model. There are two major reasons why this is the case.</p>
    <p>We find that the <italic>k</italic>-mer clusters have functional significance. For a significant fraction of yeast motifs, the sequence of the motif, and not simply its presence or absence, affects the expression levels of the associated genes. Therefore, assigning a binding site to the appropriate motif subcluster may be an important step in understanding its gene expression. This observation is useful for future, integrative analyses of transcription factor binding sites and gene expression, and affirms the utility of a graph-based model in other aspects of transcription factor binding site analysis.</p>
    <p>We showed that there is an evolutionary cause for <italic>k</italic>-mer clusters in motifs. Identical <italic>k</italic>-mers are more likely to be located in the same intergenic regions than non-identical <italic>k</italic>-mers, and clusters of identical <italic>k</italic>-mers within a motif are more likely to share conservation in flanking nucleotides. This makes it likely that DNA duplications are producing some of these motif occurrences.</p>
    <p>In general, probabilistic methods suffer in motif detection because they assume that the <italic>k</italic>-mers in the motif are random samples from a smooth distribution, with consensus sequences as the modes of the distribution. In fact, as is evident in the graphs in <xref ref-type="fig" rid="fig1">Figure 1</xref>, the distribution may have many ‘spikes’ of probability density due to small subclusters, particularly clusters of duplicated <italic>k</italic>-mers. Conversely, there are also regions of negligible probability density, i.e. <italic>k</italic>-mers that we would expect to appear in the motif given the nucleotide composition, that never do. Irregularly shaped distributions like these are naturally difficult to model parametrically. Since virtually all <italic>de novo</italic> motif-finding algorithms are based around the PSSM, or a diffused consensus model, it is not unreasonable to suggest that currently known motifs could be missing <italic>k</italic>-mers that become statistically significant if analyzed with the model we propose.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We thank Serge Saxonov, Zachary Pincus, Jeffrey Chang and Devin Scannell for useful discussions. B. N. is supported by the Stanford Biochemistry Department. Work in the Batzoglou laboratory is supported in part by NSF grant EF-0312459, NIH grant U01-HG003162, the NSF CAREER Award and the Alfred P. Sloan Fellowship. Funding to pay the Open Access publication charges for this article has been waivered by Oxford University Press.</p>
    <p><italic>Conflict of interest statement.</italic> None declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="b1">
      <label>1</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garten</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Kaplan</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Pilpel</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Extraction of transcription regulatory signals from genome-wide DNA–protein interaction data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>605</fpage>
        <lpage>615</lpage>
        <pub-id pub-id-type="pmid">15684410</pub-id>
      </citation>
    </ref>
    <ref id="b2">
      <label>2</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bailey</surname>
            <given-names>T.L.</given-names>
          </name>
          <name>
            <surname>Elkan</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Fitting a mixture model by expectation maximization to discover motifs in biopolymers</article-title>
        <source>Proc. Int. Conf. Intell. Syst. Mol Biol.</source>
        <year>1994</year>
        <volume>2</volume>
        <fpage>28</fpage>
        <lpage>36</lpage>
        <pub-id pub-id-type="pmid">7584402</pub-id>
      </citation>
    </ref>
    <ref id="b3">
      <label>3</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hughes</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Estep</surname>
            <given-names>P.W.</given-names>
          </name>
          <name>
            <surname>Tavazoie</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>G.M.</given-names>
          </name>
        </person-group>
        <article-title>Computational identification of cis-regulatory elements associated with groups of functionally related genes in <italic>Saccharomyces cerevisiae</italic></article-title>
        <source>J. Mol. Biol.</source>
        <year>2000</year>
        <volume>296</volume>
        <fpage>1205</fpage>
        <lpage>1214</lpage>
        <pub-id pub-id-type="pmid">10698627</pub-id>
      </citation>
    </ref>
    <ref id="b4">
      <label>4</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pavesi</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Mereghetti</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Mauri</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Pesole</surname>
            <given-names>G.</given-names>
          </name>
        </person-group>
        <article-title>Weeder Web: discovery of transcription factor binding sites in a set of sequences from co-regulated genes</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>W199</fpage>
        <lpage>W203</lpage>
        <pub-id pub-id-type="pmid">15215380</pub-id>
      </citation>
    </ref>
    <ref id="b5">
      <label>5</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Brutlag</surname>
            <given-names>D.L.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J.S.</given-names>
          </name>
        </person-group>
        <article-title>BioProspector: discovering conserved DNA motifs in upstream regulatory regions of co-expressed genes</article-title>
        <source>Pac. Symp. Biocomput.</source>
        <year>2001</year>
        <fpage>127</fpage>
        <lpage>138</lpage>
        <pub-id pub-id-type="pmid">11262934</pub-id>
      </citation>
    </ref>
    <ref id="b6">
      <label>6</label>
      <citation citation-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Fratkin</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Naughton</surname>
            <given-names>B.T.</given-names>
          </name>
          <name>
            <surname>Brutlag</surname>
            <given-names>D.L.</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>S.</given-names>
          </name>
        </person-group>
        <article-title>MotifCut: regulatory motif finding with maximum density subgraphs bioinformatics</article-title>
        <year>2006</year>
        <conf-name>Proceedings of International Conference on Intelligent Systems and Molecular Biology</conf-name>
        <conf-loc>Fortaleza, Brazil</conf-loc>
      </citation>
    </ref>
    <ref id="b7">
      <label>7</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bertone</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Stolc</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Royce</surname>
            <given-names>T.E.</given-names>
          </name>
          <name>
            <surname>Rozowsky</surname>
            <given-names>J.S.</given-names>
          </name>
          <name>
            <surname>Urban</surname>
            <given-names>A.E.</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Rinn</surname>
            <given-names>J.L.</given-names>
          </name>
          <name>
            <surname>Tongprasit</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Samanta</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>S.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Global identification of human transcribed sequences with genome tiling arrays</article-title>
        <source>Science</source>
        <year>2004</year>
        <volume>306</volume>
        <fpage>2242</fpage>
        <lpage>2246</lpage>
        <pub-id pub-id-type="pmid">15539566</pub-id>
      </citation>
    </ref>
    <ref id="b8">
      <label>8</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stormo</surname>
            <given-names>G.D.</given-names>
          </name>
        </person-group>
        <article-title>DNA binding sites: representation and discovery</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>16</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="pmid">10812473</pub-id>
      </citation>
    </ref>
    <ref id="b9">
      <label>9</label>
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Schug</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Overton</surname>
            <given-names>G.C.</given-names>
          </name>
        </person-group>
        <article-title>TESS: Transcription Element Search Software on the WWW Technical Report CBIL-TR-1997–1001-v0.0</article-title>
        <year>1997</year>
        <publisher-loc>PA</publisher-loc>
        <publisher-name>Computational Biology and Informatics Laboratory, School of Medicine, University of Pennsylvania</publisher-name>
      </citation>
    </ref>
    <ref id="b10">
      <label>10</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benos</surname>
            <given-names>P.V.</given-names>
          </name>
          <name>
            <surname>Lapedes</surname>
            <given-names>A.S.</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>G.D.</given-names>
          </name>
        </person-group>
        <article-title>Probabilistic code for DNA recognition by proteins of the EGR family</article-title>
        <source>J. Mol. Biol.</source>
        <year>2002</year>
        <volume>323</volume>
        <fpage>701</fpage>
        <lpage>727</lpage>
        <pub-id pub-id-type="pmid">12419259</pub-id>
      </citation>
    </ref>
    <ref id="b11">
      <label>11</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bulyk</surname>
            <given-names>M.L.</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>P.L.F.</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>G.M.</given-names>
          </name>
        </person-group>
        <article-title>Nucleotides of transcription factor binding sites exert interdependent effects on the binding affinities of transcription factors</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>1255</fpage>
        <lpage>1261</lpage>
        <pub-id pub-id-type="pmid">11861919</pub-id>
      </citation>
    </ref>
    <ref id="b12">
      <label>12</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>Q.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J.S.</given-names>
          </name>
        </person-group>
        <article-title>Modeling within-motif dependence for transcription factor binding site predictions</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>909</fpage>
        <lpage>916</lpage>
        <pub-id pub-id-type="pmid">14751969</pub-id>
      </citation>
    </ref>
    <ref id="b13">
      <label>13</label>
      <citation citation-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Barash</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Elidan</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Kaplan</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Modeling dependencies in protein–DNA binding sites</article-title>
        <year>2003</year>
        <conf-name>Proceedings of the Seventh International Conference on Research in Computational Molecular Biology</conf-name>
        <conf-loc>Berlin, Germany</conf-loc>
      </citation>
    </ref>
    <ref id="b14">
      <label>14</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xing</surname>
            <given-names>E.P.</given-names>
          </name>
          <name>
            <surname>Karp</surname>
            <given-names>R.M.</given-names>
          </name>
        </person-group>
        <article-title>MotifPrototyper: a Bayesian profile model for motif families</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2004</year>
        <volume>101</volume>
        <fpage>10523</fpage>
        <lpage>10528</lpage>
        <pub-id pub-id-type="pmid">15252200</pub-id>
      </citation>
    </ref>
    <ref id="b15">
      <label>15</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>King</surname>
            <given-names>O.D.</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>F.P.</given-names>
          </name>
        </person-group>
        <article-title>A non-parametric model for transcription factor binding sites</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>e116</fpage>
        <pub-id pub-id-type="pmid">14500844</pub-id>
      </citation>
    </ref>
    <ref id="b16">
      <label>16</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>Statistical significance for genomewide studies</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>9440</fpage>
        <lpage>9445</lpage>
        <pub-id pub-id-type="pmid">12883005</pub-id>
      </citation>
    </ref>
    <ref id="b17">
      <label>17</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harbison</surname>
            <given-names>C.T.</given-names>
          </name>
          <name>
            <surname>Gordon</surname>
            <given-names>D.B.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>T.I.</given-names>
          </name>
          <name>
            <surname>Rinaldi</surname>
            <given-names>N.J.</given-names>
          </name>
          <name>
            <surname>Macisaac</surname>
            <given-names>K.D.</given-names>
          </name>
          <name>
            <surname>Danford</surname>
            <given-names>T.W.</given-names>
          </name>
          <name>
            <surname>Hannett</surname>
            <given-names>N.M.</given-names>
          </name>
          <name>
            <surname>Tagne</surname>
            <given-names>J.B.</given-names>
          </name>
          <name>
            <surname>Reynolds</surname>
            <given-names>D.B.</given-names>
          </name>
          <name>
            <surname>Yoo</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional regulatory code of a eukaryotic genome</article-title>
        <source>Nature</source>
        <year>2004</year>
        <volume>431</volume>
        <fpage>99</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="pmid">15343339</pub-id>
      </citation>
    </ref>
    <ref id="b18">
      <label>18</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sandelin</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Alkema</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Engstršm</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Wasserman</surname>
            <given-names>W.</given-names>
          </name>
          <name>
            <surname>Lenhard</surname>
            <given-names>B.</given-names>
          </name>
        </person-group>
        <article-title>JASPAR: an open access database for eukaryotic transcription factor binding profiles</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>D91</fpage>
        <lpage>D94</lpage>
        <pub-id pub-id-type="pmid">14681366</pub-id>
      </citation>
    </ref>
    <ref id="b19">
      <label>19</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Matys</surname>
            <given-names>V.</given-names>
          </name>
          <name>
            <surname>Fricke</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Geffers</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Gossling</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Haubrock</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Hehl</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Hornischer</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Karas</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Kel</surname>
            <given-names>A.E.</given-names>
          </name>
          <name>
            <surname>Kel-Margoulis</surname>
            <given-names>O.V.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>TRANSFAC: transcriptional regulation, from patterns to profiles</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>374</fpage>
        <lpage>378</lpage>
        <pub-id pub-id-type="pmid">12520026</pub-id>
      </citation>
    </ref>
    <ref id="b20">
      <label>20</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Watts</surname>
            <given-names>D.J.</given-names>
          </name>
          <name>
            <surname>Strogatz</surname>
            <given-names>S.H.</given-names>
          </name>
        </person-group>
        <article-title>Collective dynamics of ‘small-world’ networks</article-title>
        <source>Nature</source>
        <year>1998</year>
        <volume>393</volume>
        <fpage>440</fpage>
        <lpage>442</lpage>
        <pub-id pub-id-type="pmid">9623998</pub-id>
      </citation>
    </ref>
    <ref id="b21">
      <label>21</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lapidot</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Pilpel</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive quantitative analyses of the effects of promoter sequence elements on mRNA transcription</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>3824</fpage>
        <lpage>3828</lpage>
        <pub-id pub-id-type="pmid">12824429</pub-id>
      </citation>
    </ref>
    <ref id="b22">
      <label>22</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segal</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Shapira</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Pe'er</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Koller</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Friedman</surname>
            <given-names>N.</given-names>
          </name>
        </person-group>
        <article-title>Module networks: identifying regulatory modules and their condition-specific regulators from gene expression data</article-title>
        <source>Nature Genet.</source>
        <year>2003</year>
        <volume>34</volume>
        <fpage>166</fpage>
        <lpage>176</lpage>
        <pub-id pub-id-type="pmid">12740579</pub-id>
      </citation>
    </ref>
    <ref id="b23">
      <label>23</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brauer</surname>
            <given-names>M.J.</given-names>
          </name>
          <name>
            <surname>Saldanha</surname>
            <given-names>A.J.</given-names>
          </name>
          <name>
            <surname>Dolinski</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Homeostatic adjustment and metabolic remodeling in glucose-limited yeast cultures</article-title>
        <source>Mol. Biol. Cell.</source>
        <year>2005</year>
        <volume>16</volume>
        <fpage>2503</fpage>
        <lpage>2517</lpage>
        <pub-id pub-id-type="pmid">15758028</pub-id>
      </citation>
    </ref>
    <ref id="b24">
      <label>24</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C.L.</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>J.D.</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R.J.</given-names>
          </name>
          <name>
            <surname>Herschlag</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>P.O.</given-names>
          </name>
        </person-group>
        <article-title>Precision and functional specificity in mRNA decay</article-title>
        <source>Proc. Natl Acad. Sci. USA</source>
        <year>2002</year>
        <volume>99</volume>
        <fpage>5860</fpage>
        <lpage>5865</lpage>
        <pub-id pub-id-type="pmid">11972065</pub-id>
      </citation>
    </ref>
    <ref id="b25">
      <label>25</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thomas</surname>
            <given-names>E.E.</given-names>
          </name>
        </person-group>
        <article-title>Short, local duplications in eukaryotic genomes</article-title>
        <source>Curr. Opin. Genet. Dev.</source>
        <year>2005</year>
        <volume>15</volume>
        <fpage>640</fpage>
        <lpage>644</lpage>
        <pub-id pub-id-type="pmid">16214334</pub-id>
      </citation>
    </ref>
    <ref id="b26">
      <label>26</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Achaz</surname>
            <given-names>G.</given-names>
          </name>
          <name>
            <surname>Coissac</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Viari</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Netter</surname>
            <given-names>P.</given-names>
          </name>
        </person-group>
        <article-title>Analysis of intrachromosomal duplications in yeast <italic>Saccharomyces cerevisiae</italic>: a possible model for their origin</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2000</year>
        <volume>17</volume>
        <fpage>1268</fpage>
        <lpage>1275</lpage>
        <pub-id pub-id-type="pmid">10908647</pub-id>
      </citation>
    </ref>
    <ref id="b27">
      <label>27</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stolovicki</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Dror</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Brenner</surname>
            <given-names>N.</given-names>
          </name>
          <name>
            <surname>Braun</surname>
            <given-names>E.</given-names>
          </name>
        </person-group>
        <article-title>Synthetic gene recruitment reveals adaptive reprogramming of gene regulation in yeast</article-title>
        <source>Genetics</source>
        <year>2006</year>
        <volume>173</volume>
        <fpage>75</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="pmid">16510783</pub-id>
      </citation>
    </ref>
    <ref id="b28">
      <label>28</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Cavalcanti</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>F.C.</given-names>
          </name>
          <name>
            <surname>Bouman</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W.H.</given-names>
          </name>
        </person-group>
        <article-title>Extent of gene duplication in the genomes of <italic>Drosophila</italic>, nematode, and yeast</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2002</year>
        <volume>19</volume>
        <fpage>256</fpage>
        <lpage>262</lpage>
        <pub-id pub-id-type="pmid">11861885</pub-id>
      </citation>
    </ref>
    <ref id="b29">
      <label>29</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stone</surname>
            <given-names>J.R.</given-names>
          </name>
          <name>
            <surname>Wray</surname>
            <given-names>G.A.</given-names>
          </name>
        </person-group>
        <article-title>Rapid evolution of <italic>cis</italic>-regulatory sequences via local point mutations</article-title>
        <source>Mol. Biol. Evol.</source>
        <year>2001</year>
        <volume>18</volume>
        <fpage>1764</fpage>
        <lpage>1770</lpage>
        <pub-id pub-id-type="pmid">11504856</pub-id>
      </citation>
    </ref>
    <ref id="b30">
      <label>30</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gojobori</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W.H.</given-names>
          </name>
          <name>
            <surname>Graur</surname>
            <given-names>D.</given-names>
          </name>
        </person-group>
        <article-title>Patterns of nucleotide substitution in pseudogenes and functional genes</article-title>
        <source>J. Mol. Evol.</source>
        <year>1982</year>
        <volume>18</volume>
        <fpage>360</fpage>
        <lpage>369</lpage>
        <pub-id pub-id-type="pmid">7120431</pub-id>
      </citation>
    </ref>
    <ref id="b31">
      <label>31</label>
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>S.R.</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Mitchison</surname>
            <given-names>G.J.</given-names>
          </name>
        </person-group>
        <source>Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids</source>
        <year>1998</year>
        <publisher-loc>Cambridge, UK</publisher-loc>
        <publisher-name>Cambridge University Press</publisher-name>
      </citation>
    </ref>
    <ref id="b32">
      <label>32</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benjamini</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Hochberg</surname>
            <given-names>Y.</given-names>
          </name>
        </person-group>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J. R Stat. Soc. Ser B</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </citation>
    </ref>
    <ref id="b33">
      <label>33</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Story</surname>
            <given-names>J.D.</given-names>
          </name>
        </person-group>
        <article-title>The positive false discovery rate: a Bayesian interpretation and the q-value</article-title>
        <source>Ann. Stat.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>2013</fpage>
        <lpage>2035</lpage>
      </citation>
    </ref>
    <ref id="b34">
      <label>34</label>
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gribskov</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>N.L.</given-names>
          </name>
        </person-group>
        <article-title>The use of receiver operating characteristic (ROC) analysis to evaluate sequence matching</article-title>
        <source>Comput. Chem.</source>
        <year>1996</year>
        <volume>20</volume>
        <fpage>25</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="pmid">16718863</pub-id>
      </citation>
    </ref>
  </ref-list>
  <sec sec-type="display-objects">
    <title>Figures and Tables</title>
    <fig id="fig1" position="float">
      <label>Figure 1</label>
      <caption>
        <p>Graphs of four yeast motifs (<bold>a</bold>–<bold>d</bold>) and four JASPAR motifs (<bold>e</bold>–<bold>h</bold>) where MotifScan performed better than a PSSM. Each node represents a <italic>k</italic>-mer in the motif; gray edges represent a Hamming distance of one, green edges represent a Hamming distance of zero. The color of the nodes represents the ratio of the expected number of this <italic>k</italic>-mer in a motif randomly generated from a PSSM to the number in the real motif. A red node indicates that the PSSM generates this <italic>k</italic>-mer too frequently, a blue node indicates that it generates it too infrequently. If the PSSM were a perfect model of the motif, all nodes would be magenta (i.e. 50% red, 50% blue).</p>
      </caption>
      <graphic xlink:href="gkl585f1"/>
    </fig>
    <fig id="fig2" position="float">
      <label>Figure 2</label>
      <caption>
        <p>Conservation of flanking DNA for identical and different <italic>k</italic>-mers in yeast motifs. This graph shows the average conservation of flanking nucleotides for pairs of <italic>k</italic>-mers located within 100 bases of each other from all yeast motifs in <italic>S.cerevisiae</italic>. The length of <italic>k</italic>-mers varies from 5 to 19 nt. Nucleotides surrounding groups of identical <italic>k</italic>-mers are more likely to be identical than nucleotides surrounding groups of different <italic>k</italic>-mers from the same motif. The two sides of the binding site are symmetrical since transcription factor binding sites do not have 5′–3′ directionality. Note that given the background nucleotide distribution, we expect a value of ∼26% identity to indicate no conservation. Error bars represent 1 SD and were estimated with the bootstrap.</p>
      </caption>
      <graphic xlink:href="gkl585f2"/>
    </fig>
    <fig id="fig3" position="float">
      <label>Figure 3</label>
      <caption>
        <p>An example of the MotifScan algorithm assessing two candidate <italic>k</italic>-mers. Gray edges represent a Hamming distance of one, green edges represent exact matches. The thickness of the arrows represents the amount of weight the algorithm places on each match. The Hamming distance of each candidate-motif match is noted above the arrows. Even though for both candidates, the average Hamming distance to the motif is the same, the high scoring candidate is an exact match to a cluster of three <italic>k</italic>-mers, which contributes the majority of its score, whereas the low scoring candidate is two mutations away from each of the clusters of three <italic>k</italic>-mers.</p>
      </caption>
      <graphic xlink:href="gkl585f3"/>
    </fig>
    <table-wrap id="tbl1" position="float">
      <label>Table 1</label>
      <caption>
        <p>Nucleotide substitution rates in motifs</p>
      </caption>
      <graphic xlink:href="gkl585t1"/>
      <table-wrap-foot>
        <fn>
          <p>1a and 1c show substitution probabilities for yeast and JASPAR motifs. Each column in the matrix represents the probability that the nucleotide at the head of the column will have each of the other nucleotides as a substitute. 1b and 1d show the same probabilities, but conditioned on the fact that a substitution has occurred. This highlights the differences in substitution probabilities.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap id="tbl2" position="float">
      <label>Table 2</label>
      <caption>
        <p>A table of results comparing the performance of MotifScan and a PSSM for the detection of yeast and multicellular eukaryotic motifs</p>
      </caption>
      <graphic xlink:href="gkl585t2"/>
      <table-wrap-foot>
        <fn>
          <p>We show only those motifs where the performance of the two algorithms is significantly different. The number of motifs where MotifScan outperforms the PSSM is significantly greater in both yeast and JASPAR motifs.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
</back>
