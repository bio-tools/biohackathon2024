<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-title>Genome Biology</journal-title>
    <issn pub-type="ppub">1465-6906</issn>
    <issn pub-type="epub">1465-6914</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2375008</article-id>
    <article-id pub-id-type="publisher-id">gb-2007-8-8-r178</article-id>
    <article-id pub-id-type="pmid">17727723</article-id>
    <article-id pub-id-type="doi">10.1186/gb-2007-8-8-r178</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Model-based analysis of two-color arrays (MA2C)</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" equal-contrib="yes" contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Jun S</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>jssong@jimmy.harvard.edu</email>
      </contrib>
      <contrib id="A2" equal-contrib="yes" contrib-type="author">
        <name>
          <surname>Johnson</surname>
          <given-names>W Evan</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>evan@stat.byu.edu</email>
      </contrib>
      <contrib id="A3" equal-contrib="yes" contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xiaopeng</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>zhuxp@jimmy.harvard.edu</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Xinmin</given-names>
        </name>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>xzhang@nimblegen.com</email>
      </contrib>
      <contrib id="A5" contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Wei</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>weili@jimmy.harvard.edu</email>
      </contrib>
      <contrib id="A6" contrib-type="author">
        <name>
          <surname>Manrai</surname>
          <given-names>Arjun K</given-names>
        </name>
        <xref ref-type="aff" rid="I5">5</xref>
        <email>manrai@fas.harvard.edu</email>
      </contrib>
      <contrib id="A7" contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Jun S</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I6">6</xref>
        <email>jliu@stat.harvard.edu</email>
      </contrib>
      <contrib id="A8" contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Runsheng</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>crs@sun5.ibp.ac.cn</email>
      </contrib>
      <contrib id="A9" corresp="yes" contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>X Shirley</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>xsliu@jimmy.harvard.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Biostatistics and Computational Biology, Dana-Farber Cancer Institute, 44 Binney Street, Boston, MA 02115, USA</aff>
    <aff id="I2"><label>2</label>Department of Biostatistics, Harvard School of Public Health, Boston, MA 02115, USA</aff>
    <aff id="I3"><label>3</label>Bioinformatics Laboratory, Institute of Biophysics, Chinese Academy of Sciences, Beijing 100101, China</aff>
    <aff id="I4"><label>4</label>NimbleGen Systems, Inc., Science Court, Madison, Wisconsin 53711, USA</aff>
    <aff id="I5"><label>5</label>Department of Physics, Harvard University, Cambridge, MA 02138, USA</aff>
    <aff id="I6"><label>6</label>Department of Statistics, Harvard University, 1 Oxford Street, Cambridge, MA 02138, USA</aff>
    <pub-date pub-type="ppub">
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>8</month>
      <year>2007</year>
    </pub-date>
    <volume>8</volume>
    <issue>8</issue>
    <fpage>R178</fpage>
    <lpage>R178</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://genomebiology.com/2007/8/8/R178"/>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>4</month>
        <year>2007</year>
      </date>
      <date date-type="rev-recd">
        <day>2</day>
        <month>7</month>
        <year>2007</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>8</month>
        <year>2007</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2007 Song et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2007</copyright-year>
      <copyright-holder>Song et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an open access article distributed under the terms of the Creative Commons Attribution License <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Song
               S
               Jun
               
               
               jssong@jimmy.harvard.edu
            </dc:author><dc:title>
            Model-based analysis of two-color arrays (MA2C)
         </dc:title><dc:date>2007</dc:date><dcterms:bibliographicCitation>Genome Biology 8(8): R178-. (2007)</dcterms:bibliographicCitation><dc:identifier type="sici">1465-6906(2007)8:8&#x0003c;R178&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1465-6906</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract abstract-type="short">
      <p>A normalization method based on probe GC content for two-color tiling arrays and an algorithm for detecting peak regions are presented. They are available in a stand-alone Java program.</p>
    </abstract>
    <abstract>
      <p>A novel normalization method based on the GC content of probes is developed for two-color tiling arrays. The proposed method, together with robust estimates of the model parameters, is shown to perform superbly on published data sets. A robust algorithm for detecting peak regions is also formulated and shown to perform well compared to other approaches. The tools have been implemented as a stand-alone Java program called MA2C, which can display various plots of statistical analysis for quality control.</p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>High-density oligonucleotide tiling-microarrays currently provide the most powerful method of investigating genome-wide protein-DNA interactions and chromatin structure <italic>in vivo</italic>. As illustrated in Figure <xref ref-type="fig" rid="F1">1</xref>, the technology allows tiling regions of interest on DNA with probes separated by short chromosome distances. A typical NimbleGen array has about 400,000 probes that are 40-60 nucleotides long and separated by 10-100 base-pairs (bp) in the genome. Both NimbleGen and Agilent provide two-color microarrays with flexible designs where one can choose probes that are partially overlapping for high resolution studies of chromatin structure. The experimental protocol requires labeling the treatment and control samples with fluorescent dyes, usually green and red, and then hybridizing them on a microarray. Each probe's intensity of fluorescence upon scanning the microarray will give an approximate measure of the abundance of DNA that hybridized to the probe. Because each probe has an associated genomic coordinate, one can plot the intensities as a function of chromosome locations and then reconstruct the enrichment of particular DNA or RNA fragments compared to the genomic background. As in Figure <xref ref-type="fig" rid="F1">1</xref>, the enriched regions appear as peaks, which can represent protein-bound DNA fragments.</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p>ChIP-chip. Regions of interest on DNA are densely tiled, with probes separated by short distances. In this figure, each bar corresponds to the log-ratio hybridization signals of two channels measured by a probe. Small sub-regions that are over-represented compared to the genomic background will appear as pronounced peaks (in this example, the middle peak represents the DNA fragments containing a protein-binding site). The computational challenge is to normalize the data properly and to detect confident enriched regions by filtering out false peaks (left and right peaks in this example).</p>
      </caption>
      <graphic xlink:href="gb-2007-8-8-r178-1"/>
    </fig>
    <p>The technology is continuing to develop rapidly, but certainly not without difficulties that are imposed by the inherent complexity of biological systems and, as such, must be addressed by computational means for the foreseeable future. The main computational challenge lies in properly normalizing the data and distinguishing true peaks from the noisy background. Many problems that confound this type of microarray data actually arise from probe-specific biases, such as differential sequence copy numbers in the genome or variable melting temperature dependent upon the GC content. For Affymetrix tiling arrays, several good model-based methods already exist to account for probe biases and, thus, to adjust for probe-specific baseline signals. The recently introduced MAT [<xref ref-type="bibr" rid="B1">1</xref>], for instance, estimates probe affinity from probe sequence and copy number and provides a powerful tool for finding enriched regions in chromatin immunoprecipitation (ChIP) and other applications on Affymetrix tiling-array experiments. Incidentally, similar problems are also found in Affymetrix expression arrays, for which extensive effort has been previously exerted by various groups to develop robust methods for background correction and probe-level normalization (for example, [<xref ref-type="bibr" rid="B2">2</xref>-<xref ref-type="bibr" rid="B5">5</xref>]). It is relatively hard and expensive for Affymetrix to provide custom designed microarrays.</p>
    <p>Commercial custom tiling arrays are relatively new in the field of microarray biotechnology and, just as expression arrays allow global assays of gene expression, provide an invaluable tool for investigating the locations and roles of DNA-binding proteins in the whole genome at high resolution. All currently available custom tiling arrays use the two-color technology. Considering the utility and power of high-resolution tiling arrays, it is thus imperative that reliable computational methods be developed now to facilitate the extraction of precise and accurate conclusions from such experiments.</p>
    <p>It turns out that two-color arrays also exhibit a sequence bias, particularly dependent upon the GC content of probes. More precisely, probes with high GC counts tend to have high intensity; furthermore, as Figure <xref ref-type="fig" rid="F2">2</xref> indicates, the two channels show a higher correlation in the high-GC probes than in the low-GC probes. However, no satisfactory normalization and peak-detection methods are yet available for two-color tiling arrays. For example, even though NimbleGen provides flexible custom designs, with long probes to minimize cross-hybridization and variable probe spacing to allow dense tiling, a robust method of analysis has not been hitherto developed for the platform. Indeed, NimbleGen currently uses a simple method of globally scaling all probe ratios by the median, attempting to remove any dye-bias across arrays but neglecting other probe-specific biases. As illustrated in Figure <xref ref-type="fig" rid="F3">3</xref>, the median scaled ratios retain the bimodal distribution attributable to GC probe effects and, thus, this approach is inadequate in removing all dye and sample biases from the data.</p>
    <fig position="float" id="F2">
      <label>Figure 2</label>
      <caption>
        <p>Scatter plots of the Cy5 versus Cy3 channels for 50-mer probes from [12] with <bold>(a) </bold>28256_Input versus 28256_ChIP for <italic>G</italic>+<italic>C </italic>= 11 bases and <bold>(b) </bold>28256_Input versus 28256_ChIP for <italic>G</italic>+<italic>C </italic>= 39 bases. The correlation is 0.364 in (a) and 0.860 in (b). <bold>(c) </bold>Plot of the inter-channel correlation (28256_Input, 28256_ChIP) across GC bins within the same array. The higher GC-count probes are more correlated and, therefore, should be more reliable in detecting differentially expressed or enriched probes. That is, in ChIP-chip, more than 99% of probes just measure the background and, thus, should ideally give similar results for the two channels. The correlation between the two channels, however, depends on the GC content of the probes. Since the two-channel correlation for high-GC probes is much higher than that for low-GC probes, significant two-channel fold-changes in the former category are much more reliable than those in the latter category, where large fold-changes may readily occur by chance.</p>
      </caption>
      <graphic xlink:href="gb-2007-8-8-r178-2"/>
    </fig>
    <fig position="float" id="F3">
      <label>Figure 3</label>
      <caption>
        <p>Histograms of intensities. <bold>(a) </bold>Histogram of single-channel log-intensity values for a single array from 28256_Input [12]. The red bars represent the log-intensities for the probes with <italic>G</italic>+<italic>C </italic>less than 20, indicating that the bimodal behavior is caused by the GC content of probes. <bold>(b) </bold>Density plot of single channel log-intensities for two channels on the same array (28256_ChIP, black; 28256_Input, red). Notice that both the scale and the mean of the individual channels must be adjusted to properly normalize the arrays. <bold>(c) </bold>The raw data log-ratio values (28256_ChIP/28256_Input) for the same array in (b). Note that the 'bump' at 0 is not caused by enrichment but by lack of channel specific normalization of the data.</p>
      </caption>
      <graphic xlink:href="gb-2007-8-8-r178-3"/>
    </fig>
    <p>For dual-channel cDNA arrays, several normalization methods have been proposed (for example, [<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B6">6</xref>]), but these procedures typically utilize methods that neglect probe sequence information and are also computationally expensive and, thus, unsuitable for currently available high-density tiling arrays. One common way of locally normalizing two-color arrays is the so-called <italic>M</italic>-<italic>A </italic>loess normalization. The fundamental assumption behind this procedure is that most probes should have similar values between the two-channels, an assumption violated in studies of chromatin structure such as nucleosome mapping described in [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>]. This method also does not account for sequence-specific effects, which may be significant in high-density tiling arrays, and also does not normalize the variance of <italic>M</italic>.</p>
    <p>Single-channel normalization methods can be also applied to two-color arrays, such as those proposed by [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B9">9</xref>], but they ignore the fact that the two channels are paired, and such approaches are thus likely to retain residual effects or correlation. Recently, Dabney and Storey [<xref ref-type="bibr" rid="B10">10</xref>] have introduced a normalization method that adjusts for intensity-dependent dye bias and array-to-array variations. However, their method, which was developed for expression arrays, does not model sequence-specific probe effects and is based on smoothing procedures that can be computationally demanding for tiling arrays; the approach also requires a dye swap and, thus, cannot be applied to single array experiments, which are often performed as test runs. In fact, as far as we are aware, there are, to date, only two published tools, MPeak [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>] and ChIPOTle [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B14">14</xref>] for analyzing two-color high-density tiling arrays, but neither considers probe-specific normalization or is able to combine replicate experiments directly. This problem is rather serious since biological replicate experiments are perceived to be indispensable in any sound research utilizing microarrays.</p>
    <p>In this paper, we address many of the issues discussed above and present robust algorithms for normalizing the raw data at probe-level and detecting peaks, implemented as a Java program called MA2C (model-based analysis of two-color arrays). Because our normalization method standardizes the probe intensities, our peak-detection algorithm naturally generalizes to combine replicate arrays.</p>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <sec>
      <title>Comparison of normalization methods</title>
      <p>To test the effectiveness of the MA2C normalization procedure, we compared the MA2C normalized data using the non-robust and robust <italic>C </italic>= 2 methods with the raw and median scaled log-ratio data; Figure <xref ref-type="fig" rid="F4">4</xref> shows the corresponding density plots of log ratios for eight samples published in [<xref ref-type="bibr" rid="B12">12</xref>]. Figure <xref ref-type="fig" rid="F4">4</xref> illustrates that our method standardizes the data much more effectively than median scaling and removes much of the GC-effect discussed in Figure <xref ref-type="fig" rid="F3">3</xref>. In particular, Figure <xref ref-type="fig" rid="F4">4d</xref> shows that the log-ratios normalized with MA2C's robust option follow a normal distribution.</p>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p>Log-ratio density plots. All samples are from [12]: <bold>(a) </bold>raw data; <bold>(b) </bold>median adjusted data; <bold>(c) </bold>QQ normalized data; <bold>(d) </bold>Lowess normalized data; <bold>(e) </bold>MA2C (Simple) normalized data; <bold>(f) </bold>MA2C (Robust <italic>C </italic>= 2) normalized data. Different colors correspond to different samples.</p>
        </caption>
        <graphic xlink:href="gb-2007-8-8-r178-4"/>
      </fig>
    </sec>
    <sec>
      <title>Spike-in experiment</title>
      <p>We used the data (GEO GSE7523) from a recent spike-in experiment to test MA2C. The spike-in samples contained 96 clones in the ENCODE region of approximately 500 bp, at 8 different concentrations corresponding to (2<sup>n </sup>+ 1)-fold enrichment compared to the human genomic DNA, for <italic>n </italic>= 1,...,8, and 12 different clones per concentration. The control sample contained sonicated genomic DNA without spike-ins. The spike-in and control samples were differentially labeled and hybridized to a NimbleGen ENCODE tiling array in triplicates, and the resulting data were used to assess the performance of MA2C against other currently available algorithms.</p>
      <p>MA2C and MPeak Version 2.0 [<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B12">12</xref>] were run using default parameters, and ChIPOTle v1.0 [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B14">14</xref>] using window size 500, step length 100, <italic>p </italic>value cutoff 10<sup>-4 </sup>and Gaussian background distribution. As seen in Table <xref ref-type="table" rid="T1">1</xref>, while having a comparable sensitivity, MA2C has a higher positive predictive value and, thus, fewer false negative peaks than ChIPOTle. After removing ambiguous overlapping regions from the 96 spike-in regions, we used the remaining 47 unique regions to measure the correlation between spike-in fold-changes and the corresponding algorithm-assigned scores for detected peaks. MA2C not only found all the unique sites but also showed a better correlation than ChIPOTle, which missed some of the sites in the first sample.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Comparison of MA2C with other algorithms using a spike-in experiment with a total of 96 regions and 47 unique non-overlapping regions</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">Algorithm</td>
              <td align="center">CHIP_ID</td>
              <td align="center">PPV</td>
              <td align="center">Sensitivity</td>
              <td align="center">Unique</td>
              <td align="center">Correlation</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">ChIPOTle</td>
              <td align="center">49875</td>
              <td align="center">71%</td>
              <td align="center">85%</td>
              <td align="center">40</td>
              <td align="center">0.72</td>
            </tr>
            <tr>
              <td/>
              <td align="center">49880</td>
              <td align="center">69%</td>
              <td align="center">98%</td>
              <td align="center">47</td>
              <td align="center">0.76</td>
            </tr>
            <tr>
              <td/>
              <td align="center">49883</td>
              <td align="center">73%</td>
              <td align="center">98%</td>
              <td align="center">47</td>
              <td align="center">0.79</td>
            </tr>
            <tr>
              <td align="left">MPeak</td>
              <td align="center">49875</td>
              <td align="center">100%</td>
              <td align="center">91%</td>
              <td align="center">46</td>
              <td align="center">0.74</td>
            </tr>
            <tr>
              <td/>
              <td align="center">49880</td>
              <td align="center">96%</td>
              <td align="center">89%</td>
              <td align="center">46</td>
              <td align="center">0.71</td>
            </tr>
            <tr>
              <td/>
              <td align="center">49883</td>
              <td align="center">98%</td>
              <td align="center">89%</td>
              <td align="center">46</td>
              <td align="center">0.79</td>
            </tr>
            <tr>
              <td align="left">MA2C</td>
              <td align="center">49875</td>
              <td align="center">99%</td>
              <td align="center">91%</td>
              <td align="center">47</td>
              <td align="center">0.78</td>
            </tr>
            <tr>
              <td align="left">(<italic>C </italic>= 2 normalized)</td>
              <td align="center">49880</td>
              <td align="center">96%</td>
              <td align="center">94%</td>
              <td align="center">47</td>
              <td align="center">0.79</td>
            </tr>
            <tr>
              <td/>
              <td align="center">49883</td>
              <td align="center">99%</td>
              <td align="center">95%</td>
              <td align="center">47</td>
              <td align="center">0.81</td>
            </tr>
            <tr>
              <td/>
              <td align="center">All 3</td>
              <td align="center">96%</td>
              <td align="center">96%</td>
              <td align="center">47</td>
              <td align="center">0.81</td>
            </tr>
            <tr>
              <td align="left">MA2C</td>
              <td align="center">49875</td>
              <td align="center">99%</td>
              <td align="center">92%</td>
              <td align="center">46</td>
              <td align="center">0.77</td>
            </tr>
            <tr>
              <td align="left">(Global median-scaled)</td>
              <td align="center">49880</td>
              <td align="center">100%</td>
              <td align="center">93%</td>
              <td align="center">46</td>
              <td align="center">0.79</td>
            </tr>
            <tr>
              <td/>
              <td align="center">49883</td>
              <td align="center">99%</td>
              <td align="center">92%</td>
              <td align="center">46</td>
              <td align="center">0.81</td>
            </tr>
            <tr>
              <td/>
              <td align="center">All 3</td>
              <td align="center">100%</td>
              <td align="center">95%</td>
              <td align="center">47</td>
              <td align="center">0.80</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>PPV (positive predictive value) = no. of true positive peaks/no. of total peaks. Sensitivity = no. of detected true positive regions/96. Unique = number of unique regions found. Correlation = correlation coefficient of the spike-in log fold-changes and algorithm-assigned scores for the 47 unique regions.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>The positive predictive value of MPeak was comparable to MA2C, but MA2C was more sensitive and also found more unique sites. MA2C again showed a better correlation with spike-in fold-changes than MPeak and, thus, provided better quantitative information about the enriched regions than both ChIPOTle and MPeak. We also tested the MA2C peak detection algorithm on the global median-scaled data without any GC-correction (the same data analyzed with MPeak and ChIPOTle) and still found MA2C to be more sensitive and to have a higher positive predictive value, indicating that MA2C can outperform other available algorithms even without its GC-specific normalization step (Table <xref ref-type="table" rid="T1">1</xref>).</p>
      <p>Furthermore, neither MPeak nor ChIPOTle can combine replicate data in a single test. As seen in Table <xref ref-type="table" rid="T1">1</xref>, pooling data from replicate experiments can often increase the sensitivity and quantitativeness of analysis, and this option implemented in MA2C will prove to be useful. Since ChIP-chip experiments require biological replicates, which are much noisier than the technical triplicate spike-ins presented here, the ability to combine replicates at the probe-level will provide more sensitive and robust peak predictions than other methods of combining peaks. In addition, ChIP-chip experiments contain a PCR amplification step that often increases the GC bias of probes; in this regard, MA2C's GC-based probe normalization shows distinct advantages over ChIPOTle and MPeak on PCR amplified samples, as observed in a separate PCR amplified spike-in experiment (unpublished data).</p>
    </sec>
    <sec>
      <title>ChIP-chip data in <italic>Caenorhabditis elegans</italic></title>
      <p>The protein DPY-27 functions as an essential dosage-compensator that suppresses the expression of genes on each X chromosome in hermaphrodite XX embryos of <italic>Caenorhabditis elegans</italic>, thereby reducing the expression level of the X-linked genes by half to the level in XO (male) counterparts. Chuang <italic>et al</italic>. [<xref ref-type="bibr" rid="B15">15</xref>] have shown that the basic suppression mechanism involves localization of DPY-27 to X chromosomes, likely leading to a subsequent modification of the chromatin structure of X chromosomes mediated by DPY-27. Davis and Meyer [<xref ref-type="bibr" rid="B16">16</xref>] later showed that SDC-3 also localizes to X chromosomes in XX hermaphrodites and associates with a dosage compensating complex involving DPY-27.</p>
      <p>A recent study [<xref ref-type="bibr" rid="B17">17</xref>] suggests that SDC-3 in fact preferentially binds in the promoter regions of active genes. This observation has the important biological implication that SDC-3 and DPY-27 may modulate transcriptional activities and that the mechanism by which the dosage compensating complex spreads along the X chromosome may involve initial localization to promoters followed by RNA polymerase-coupled dispersion. Their conclusion thus relies on the fact that a significant fraction of the total SDC-3 binding sites resides in proximal promoter regions. We tested MA2C and MPeak on their triplicate data to see whether we can improve the fraction and number of SDC-3 binding sites in promoters - a finding that could strengthen the claim made in [<xref ref-type="bibr" rid="B17">17</xref>]. We compared the results with the ChIPOTle analysis provided to us by Ercan <italic>et al</italic>. [<xref ref-type="bibr" rid="B17">17</xref>]; as previously mentioned, ChIPOTle cannot directly combine replicate experiments, so the authors first found peaks from median <italic>z</italic>-scores and selected the peaks that occur in two of the three replicates. It should be noted that the number of SDC-3 binding sites quoted here is different from that reported in [<xref ref-type="bibr" rid="B17">17</xref>] because, in that paper, the peaks that appeared in negative control experiments without antibody were removed from the list. We ran MA2C using a window-size of 600 bp at <italic>p </italic>value cutoffs of 10<sup>-5 </sup>and 10<sup>-4</sup>; all other parameters were set to default settings. MPeak was run using default parameters. As seen in Table <xref ref-type="table" rid="T2">2</xref>, compared to both programs, MA2C could find not only a greater number but a higher fraction of SDC-3 binding sites in promoter regions, further strengthening the conclusion propounded in [<xref ref-type="bibr" rid="B17">17</xref>]. In addition, Table <xref ref-type="table" rid="T3">3</xref> shows that MA2C can also detect almost all the regions found by ChIPOTLe and MPeak. MA2C's high sensitivity and power can thus provide a valuable tool for discovering novel biological phenomena.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Numbers and annotation of SDC-3 binding sites detected by different methods</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">Algorithm</td>
              <td align="left">Sample</td>
              <td align="center">No. of peaks</td>
              <td align="center">In promoter</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">ChIPOTle</td>
              <td align="left">Combined triplicate</td>
              <td align="center">1,219</td>
              <td align="center">33.63%</td>
            </tr>
            <tr>
              <td align="left">MPeak</td>
              <td align="left">Replicate 1</td>
              <td align="center">1,819</td>
              <td align="center">30.35%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">Replicate 2</td>
              <td align="center">921</td>
              <td align="center">29.32%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">Replicate 3</td>
              <td align="center">557</td>
              <td align="center">34.11%</td>
            </tr>
            <tr>
              <td align="left">MA2C</td>
              <td align="left">Combined triplicate (<italic>p </italic>= 10<sup>-5</sup>)</td>
              <td align="center">1,181</td>
              <td align="center">38.5%</td>
            </tr>
            <tr>
              <td align="left">MA2C</td>
              <td align="left">Combined triplicate (<italic>p </italic>= 10<sup>-4</sup>)</td>
              <td align="center">1,588</td>
              <td align="center">35.1%</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>For annotation, promoter regions 1 kb upstream from translation start sites of genes were used, because the annotation of transcription start sites in <italic>C. elegans </italic>has not yet been well established.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Overlap of binding sites of SDC-3</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">ChIPOTle</td>
              <td align="center">MPeak 1</td>
              <td align="center">MPeak 2</td>
              <td align="center">MPeak 3</td>
              <td align="center">MA2C (<italic>p </italic>= 10<sup>-5</sup>)</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">ChIPOTle</td>
              <td align="center">100%</td>
              <td align="center">65.97%</td>
              <td align="center">87.08%</td>
              <td align="center">92.28%</td>
              <td align="center">67.06%</td>
            </tr>
            <tr>
              <td align="left">MPeak 1</td>
              <td align="center">56.69%</td>
              <td align="center">100%</td>
              <td align="center">17.26%</td>
              <td align="center">26.57%</td>
              <td align="center">68.25%</td>
            </tr>
            <tr>
              <td align="left">MPeak 2</td>
              <td align="center">37.16%</td>
              <td align="center">8.74%</td>
              <td align="center">100%</td>
              <td align="center">21.01%</td>
              <td align="center">36.07%</td>
            </tr>
            <tr>
              <td align="left">MPeak 3</td>
              <td align="center">25.84%</td>
              <td align="center">8.14%</td>
              <td align="center">12.70%</td>
              <td align="center">100%</td>
              <td align="center">24.72%</td>
            </tr>
            <tr>
              <td align="left">MA2C (<italic>p </italic>= 10<sup>-5</sup>)</td>
              <td align="center">97.54%</td>
              <td align="center">97.91%</td>
              <td align="center">98.05%</td>
              <td align="center">99.64%</td>
              <td align="center">100%</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Percentages of SDC-3 binding sites from a method in columns overlapping with those from a method in rows (MPeak 1 denotes MPeak results from replicate 1, and so forth; two regions were considered to be overlapping if they shared at least 1 bp).</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <sec>
      <title>Novel applications</title>
      <p>ChIP-chip technology has quickly become popular among biologists, and high-density tiling microarrays are increasingly being used in novel genomic research. Some of the interesting applications involve finding novel transcripts in the genome, DNA methylation sites, nucleosome positions, DNA hypersensitivity regions, and alternative splicing events [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B18">18</xref>-<xref ref-type="bibr" rid="B21">21</xref>].</p>
      <p>In all of these studies, which tend to combine experiments performed at various time points and under different conditions, the variability of array performance and sequence-specific effects must be addressed properly in order to remove any technical artifacts and to be able to formulate biologically sound conclusions. The problem of probe effects becomes more pronounced as the density of tiling increases, as one does not have the option of selecting probe sequences for similar melting temperature, or when the tiled regions predominantly cover promoter regions, which are known to be GC-rich. Our method of standardization explicitly accounts for such sequence-specific biases and inter-array variability. Together with the accompanying robust peak-detection algorithm, MA2C's standardization procedure is especially important for data sets with a significant noise level - for instance, stemming from PCR amplification, which tends to increase probe effects.</p>
    </sec>
    <sec>
      <title>Normalization revisited</title>
      <p>One issue we have not discussed so far is adjusting for the copy-number of probes or cross-hybridization of DNA with similar sequences. We chose not to model the sequence copy-number because both NimbleGen and Agilent use sufficiently long probes and also usually exclude repeat regions from their array design.</p>
      <p>It is also instructive to note why our normalization method in equation 1 or equation 3 (See Materials and methods) gives a higher weight to the probes that are highly correlated between the two channels. Relying on the fact that the probes are long, NimbleGen tends to wash their arrays rather harshly after hybridization, minimizing cross-hybridization but also possibly leaving behind only random noise and causing a low correlation in low-GC probes between the two channels. Thus, as illustrated in Figures <xref ref-type="fig" rid="F2">2</xref> and <xref ref-type="fig" rid="F3">3a</xref>, the low-GC probes are mostly measuring the background noise and also show a low inter-channel correlation; this relation between low intensity distribution and low inter-channel correlation in low-GC bins is the motivation behind MA2C's normalization method.</p>
    </sec>
    <sec>
      <title>Epilogue</title>
      <p>MA2C is a novel model-based approach to analyzing two-color tiling microarray data, incorporating sequence-specific probe effects and powerful peak detection algorithms. The organization of MA2C's core functions is summarized in Figure <xref ref-type="fig" rid="F5">5</xref>. The GC-based normalization method can also be generalized to other long-oligonucleotide microarray applications, such as array-CGH and expression profiling. MA2C is also compatible with isothermal designs, where probe bias may be reduced but nevertheless still present. We have shown that the overall performance of MA2C is better than other currently available software. In addition to an easy, user-friendly interface, MA2C also provides informative graphical summaries of statistical analyses for array quality control. As ChIP-chip and other ways of studying chromatin structure become widespread common tools in biology, a program that can reliably analyze single or replicate experiment data from two-color microarrays will be a welcome contribution to the growing field.</p>
      <fig position="float" id="F5">
        <label>Figure 5</label>
        <caption>
          <p>Workflow chart of MA2C. MA2C is fully automated and performs the tasks as shown.</p>
        </caption>
        <graphic xlink:href="gb-2007-8-8-r178-5"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="materials|methods">
    <title>Materials and methods</title>
    <sec>
      <title>Normalization</title>
      <p>We propose a normalization procedure that standardizes the data by modeling the GC-specific background hybridization intensities. Given an array, let <italic>p</italic><sub><italic>i </italic></sub>denote its <italic>i</italic><sup>th</sup>-probe and define <italic>GC</italic><sub><italic>i </italic></sub>to be the total number of G and C nucleotides in <italic>p</italic><sub><italic>i</italic></sub>. Denote the paired single channel log-intensities of <italic>p</italic><sub><italic>i </italic></sub>as (<italic>x</italic><sub><italic>i</italic>1</sub>, <italic>x</italic><sub><italic>i</italic>2</sub>), where <italic>x</italic><sub><italic>i</italic>1 </sub>corresponds to the control and <italic>x</italic><sub><italic>i</italic>2 </sub>the treatment. Henceforth, let <italic>i </italic>index the probes, <italic>j </italic>the channels, and <italic>k </italic>the GC content bins. Then, our model assumes that the log-intensities (<italic>x</italic><sub><italic>i</italic>1</sub>, <italic>x</italic><sub><italic>i</italic>2</sub>), <italic>i </italic>∈ {<italic>i</italic>|<italic>GC</italic><sub><italic>i </italic></sub>= <italic>k</italic>}, follow a bivariate distribution with GC-specific means (<italic>μ</italic><sub>1<italic>k</italic></sub>, <italic>μ</italic><sub>2<italic>k</italic></sub>), variances (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="gb-2007-8-8-r178-i1" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="gb-2007-8-8-r178-i2" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>), and covariance <italic>ξ</italic><sub><italic>k </italic></sub>between the two channels. Also implicit in the model is that although different GC bins are allowed to have different proportions of non-background probes, the signals of non-background probes are shifted across GC bins by the same mean, variance, and covariance as the background. Based on these assumptions, our model combines the single channel log-intensities to form a normalized, correlation weighted log-ratio <italic>t</italic><sub><italic>i </italic></sub>as follows:</p>
      <p>
        <disp-formula id="bmcM1">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="gb-2007-8-8-r178-i3" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mover accent="true">
                        <mml:mi>μ</mml:mi>
                        <mml:mo>^</mml:mo>
                      </mml:mover>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:msub>
                      <mml:mover accent="true">
                        <mml:mi>μ</mml:mi>
                        <mml:mo>^</mml:mo>
                      </mml:mover>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msqrt>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mover accent="true">
                            <mml:mi>σ</mml:mi>
                            <mml:mo>^</mml:mo>
                          </mml:mover>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msubsup>
                        <mml:mo>+</mml:mo>
                        <mml:msubsup>
                          <mml:mover accent="true">
                            <mml:mi>σ</mml:mi>
                            <mml:mo>^</mml:mo>
                          </mml:mover>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:mi>k</mml:mi>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msubsup>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:msub>
                          <mml:mover accent="true">
                            <mml:mi>ξ</mml:mi>
                            <mml:mo>^</mml:mo>
                          </mml:mover>
                          <mml:mi>k</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msqrt>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where the parameters can be simply estimated as:</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="gb-2007-8-8-r178-i4" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>μ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>|</mml:mo>
                        <mml:mi>G</mml:mi>
                        <mml:msub>
                          <mml:mi>C</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mi>j</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mo>,</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="gb-2007-8-8-r178-i5" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mover accent="true">
                    <mml:mi>σ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>|</mml:mo>
                        <mml:mi>G</mml:mi>
                        <mml:msub>
                          <mml:mi>C</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:msub>
                                <mml:mi>x</mml:mi>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mi>j</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mover accent="true">
                                  <mml:mi>μ</mml:mi>
                                  <mml:mo>^</mml:mo>
                                </mml:mover>
                                <mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mi>k</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mo>,</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>and</p>
      <p>
        <disp-formula id="bmcM2">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="gb-2007-8-8-r178-i6" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>ξ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mi>k</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>|</mml:mo>
                        <mml:mi>G</mml:mi>
                        <mml:msub>
                          <mml:mi>C</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:mo>=</mml:mo>
                        <mml:mi>k</mml:mi>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mover accent="true">
                              <mml:mi>μ</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:mi>k</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo stretchy="false">)</mml:mo>
                          <mml:mo stretchy="false">(</mml:mo>
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mover accent="true">
                              <mml:mi>μ</mml:mi>
                              <mml:mo>^</mml:mo>
                            </mml:mover>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mi>k</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo stretchy="false">)</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>n</italic><sub><italic>k </italic></sub>is the number of probes with <italic>GC </italic>= <italic>k</italic>. We further scale the <italic>t</italic>-values globally so that the rescaled <italic>t</italic>-values have variance 1.</p>
      <p>This method has the following geometrical interpretation as seen in Figure <xref ref-type="fig" rid="F6">6</xref>: assuming that Cy3 is the control and Cy5 the treatment channel, let {<italic>e</italic><sub>1</sub>, <italic>e</italic><sub>2</sub>} define an orthonormal basis of <italic>R</italic><sup>2</sup>, where each probe <italic>p</italic><sub><italic>i</italic></sub>, with log intensities <italic>x</italic><sub><italic>i</italic>1 </sub>= <italic>log </italic>(<italic>Cy</italic>3<sub><italic>i</italic></sub>) and <italic>x</italic><sub><italic>i</italic>2 </sub>= <italic>log </italic>(<italic>Cy</italic>5<sub><italic>i</italic></sub>), corresponds to a point <italic>X</italic><sub><italic>i </italic></sub>= <italic>x</italic><sub><italic>x</italic>1 </sub><italic>e</italic><sub>1 </sub>+ <italic>x</italic><sub><italic>i</italic>2 </sub><italic>e</italic><sub>2 </sub>∈ <italic>R</italic><sup>2</sup>. Define a new orthonormal basis {<italic>u</italic>, <italic>v</italic>}, where <italic>u </italic>= (<italic>e</italic><sub>1 </sub>+ <italic>e</italic><sub>2</sub>)/<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="gb-2007-8-8-r178-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:semantics></mml:math></inline-formula> and <italic>v </italic>= (<italic>e</italic><sub>2 </sub>- <italic>e</italic><sub>1</sub>)/<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="gb-2007-8-8-r178-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:semantics></mml:math></inline-formula> are obtained by rotating the original coordinate system by 45 degrees; and, define a projection operator <italic>P</italic><sub><italic>v</italic></sub>: <italic>R</italic><sup>2 </sup>→ <italic>R </italic>onto <italic>v</italic>-axis as <italic>P</italic><sub><italic>v </italic></sub>(<italic>X</italic><sub><italic>i</italic></sub>) = (<italic>x</italic><sub><italic>i</italic>2 </sub>- <italic>i</italic><sub><italic>x</italic>1</sub>)<italic>v</italic>/<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="gb-2007-8-8-r178-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:mrow></mml:semantics></mml:math></inline-formula>. The projected vector thus measures the difference between log control and treatment signals. Let <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="gb-2007-8-8-r178-i8" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula> be the average of all vectors in the GC bin to which <italic>p</italic><sub><italic>i </italic></sub>belongs. We now consider <italic>Z</italic><sub><italic>i </italic></sub>: = <italic>P</italic><sub><italic>v </italic></sub>(<italic>X</italic><sub><italic>i </italic></sub>- <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="gb-2007-8-8-r178-i8" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:semantics></mml:math></inline-formula>), which is just a dye-bias adjusted log-ratio, and finally define our normalized score as:</p>
      <fig position="float" id="F6">
        <label>Figure 6</label>
        <caption>
          <p>Geometrical interpretation of the normalization method. Our method first subtracts the baseline from log intensity vectors within each GC bin and then projects the adjusted vectors onto <italic>v</italic>-axis, yielding log mean-scaled ratios of the Cy5 and Cy3 signals within each GC bin. Finally, the projected values are adjusted for variance.</p>
        </caption>
        <graphic xlink:href="gb-2007-8-8-r178-6"/>
      </fig>
      <p>
        <disp-formula id="bmcM3">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="gb-2007-8-8-r178-i9" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>t</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mi>Z</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>/</mml:mo>
                <mml:msqrt>
                  <mml:mrow>
                    <mml:mi>v</mml:mi>
                    <mml:mi>a</mml:mi>
                    <mml:mi>r</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>Z</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msqrt>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>The <italic>t</italic>-values thus yield log-ratios adjusted by the mean and normalized by the standard deviation within each GC bin.</p>
      <p>Note that in equation 1, the covariance term <italic>ξ</italic><sub><italic>k </italic></sub>has the effect of amplifying the difference between experiment and control probe intensities in GC bins that have a high baseline correlation between the two channels, while suppressing the difference in GC bins with low correlation. Therefore, the log-fold changes <italic>x</italic><sub><italic>i</italic>2 </sub>- <italic>x</italic><sub><italic>i</italic>1 </sub>are given more weight in GC bins with high correlation <italic>ξ</italic><sub><italic>k </italic></sub>between the two channels than in low-correlation GC bins.</p>
      <p>We have checked that more complicated normalization methods based on position-specific ACGT effects, as in [<xref ref-type="bibr" rid="B1">1</xref>], dinucleotides or individual G and C counts yield results that are quite similar to the above simple and effective method (Figure <xref ref-type="fig" rid="F7">7</xref>).</p>
      <fig position="float" id="F7">
        <label>Figure 7</label>
        <caption>
          <p>Average intensities of the control channel data from [12] as a function of position-specific GC counts. Each 50-mer probe is partitioned into 5 equal parts of 10 nucleotides, and average intensities are computed as a function of GC counts in each part. Different colors represent different samples. The GC-related variations of intensities behave similarly across the five locations on probes, and we thus see that the GC effect is not position specific.</p>
        </caption>
        <graphic xlink:href="gb-2007-8-8-r178-7"/>
      </fig>
    </sec>
    <sec>
      <title>Robust estimation of parameters</title>
      <p>With data symmetric in the two channels, the estimators given in equation 2 for <italic>μ</italic><sub><italic>jk</italic></sub>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="gb-2007-8-8-r178-i10" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>, and <italic>ξ</italic><sub><italic>k </italic></sub>should work very well. However, microarray data often tend to be skewed in one channel, even on the log scale, and the simple estimators can be sensitive to outliers. For this reason, we have developed a robust method for estimating these parameters. Our method generalizes Tukey's theory of bi-weight estimation, which is very robust for skewed data and has been successfully applied to microarray data previously [<xref ref-type="bibr" rid="B22">22</xref>]. In one dimension, Tukey's bi-weight estimation proceeds as follows: define a scaled distance <italic>d</italic><sub><italic>i </italic></sub>between each data point <italic>x</italic><sub><italic>i </italic></sub>and the current mean estimate <italic>μ</italic>* as:</p>
      <p>
        <disp-formula id="bmcM4">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="gb-2007-8-8-r178-i11" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>d</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:msup>
                      <mml:mi>μ</mml:mi>
                      <mml:mo>∗</mml:mo>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>C</mml:mi>
                    <mml:mo>×</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>C </italic>is a fixed constant and <italic>M </italic>= median<sub><italic>i </italic></sub>|<italic>x</italic><sub><italic>i </italic></sub>- <italic>μ</italic>*|, the median absolute distance. We then calculate the bi-weight for each data point as <italic>w</italic><sub>i </sub>= (1 - <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="gb-2007-8-8-r178-i12" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>)<sup>2 </sup>for -1 ≤ <italic>d</italic><sub><italic>i </italic></sub>≤ 1 and <italic>w</italic><sub><italic>i </italic></sub>= 0 otherwise. Then, the mean is re-estimated as <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="gb-2007-8-8-r178-i13" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mi>μ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mstyle><mml:mo>/</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>, and the process is repeated until a certain convergence criterion is satisfied.</p>
      <p>We generalize the above approach to two dimensions and develop a similar procedure for estimating the parameters in equation 1 within each GC bin by using the elliptical or Mahalanobis distance given by:</p>
      <p>
        <disp-formula id="bmcM5">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="gb-2007-8-8-r178-i14" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>d</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>Z</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:msubsup>
                    <mml:msup>
                      <mml:mi>Σ</mml:mi>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msub>
                      <mml:mi>Z</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msubsup>
                      <mml:mi>σ</mml:mi>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>*</mml:mo>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:msubsup>
                      <mml:mi>σ</mml:mi>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>*</mml:mo>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>−</mml:mo>
                    <mml:msubsup>
                      <mml:mi>ξ</mml:mi>
                      <mml:mi>k</mml:mi>
                      <mml:mrow>
                        <mml:mo>*</mml:mo>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mo>×</mml:mo>
                    <mml:mi>C</mml:mi>
                    <mml:mo>×</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where:</p>
      <p>
        <disp-formula id="bmcM16">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="gb-2007-8-8-r178-i15" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>Z</mml:mi>
                  <mml:mi>i</mml:mi>
                  <mml:mi>t</mml:mi>
                </mml:msubsup>
                <mml:msup>
                  <mml:mi>Σ</mml:mi>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:msub>
                  <mml:mi>Z</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>:</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:msubsup>
                  <mml:mi>σ</mml:mi>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>*</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msubsup>
                <mml:msup>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:msubsup>
                      <mml:mi>μ</mml:mi>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                      <mml:mo>*</mml:mo>
                    </mml:msubsup>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:msup>
                <mml:mo>+</mml:mo>
                <mml:msubsup>
                  <mml:mi>σ</mml:mi>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo>*</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msubsup>
                <mml:msup>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>−</mml:mo>
                    <mml:msubsup>
                      <mml:mi>μ</mml:mi>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                        <mml:mi>k</mml:mi>
                      </mml:mrow>
                      <mml:mo>*</mml:mo>
                    </mml:msubsup>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:msup>
                <mml:mo>−</mml:mo>
                <mml:mn>2</mml:mn>
                <mml:msubsup>
                  <mml:mi>ξ</mml:mi>
                  <mml:mi>k</mml:mi>
                  <mml:mo>*</mml:mo>
                </mml:msubsup>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>x</mml:mi>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>−</mml:mo>
                <mml:msubsup>
                  <mml:mi>μ</mml:mi>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mo>*</mml:mo>
                </mml:msubsup>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>x</mml:mi>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>−</mml:mo>
                <mml:msubsup>
                  <mml:mi>μ</mml:mi>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                    <mml:mi>k</mml:mi>
                  </mml:mrow>
                  <mml:mo>*</mml:mo>
                </mml:msubsup>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="gb-2007-8-8-r178-i16" overflow="scroll"><mml:semantics><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:msup><mml:mi>Σ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:semantics></mml:math></inline-formula>. Here, <italic>Z</italic><sub><italic>i </italic></sub>is the projected vector previously described and Σ its variance matrix. In each iteration step, the mean is estimated as before, the variance as <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="gb-2007-8-8-r178-i17" overflow="scroll"><mml:semantics><mml:mrow><mml:msup><mml:mi>σ</mml:mi><mml:mrow><mml:mo>∗</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mstyle><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>μ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:semantics></mml:math></inline-formula>, and likewise for the covariance. Strictly speaking, the variance and covariance computed in this way are not consistent estimators, but as shown in the Results section, they do provide reasonable estimates of the parameters requisite for standardizing the data within and across arrays.</p>
    </sec>
    <sec>
      <title>Detection of peak regions</title>
      <p>To detect peak regions, we have implemented several adaptations of the powerful window-based approach proposed by Johnson <italic>et al</italic>. [<xref ref-type="bibr" rid="B1">1</xref>] for Affymetrix tiling arrays. More precisely, we consider a sliding window of some user-defined length (400 bp to 1,000 bp) centered at each probe. A MA2Cscore is assigned using a user-selected scoring function based on median, pseudo-median, median polish, or trimmed mean of the probes in the window. The median and trimmed mean options are implemented by calculating the median or trimmed mean of all the probes in the window; when replicates are available, the median <italic>t</italic>-value or trimmed mean of all pooled probes in identical windows across replicates is used. The pseudo-median of a distribution is the median of all pairwise arithmetic means, as discussed in [<xref ref-type="bibr" rid="B23">23</xref>]. Median polish has been successfully applied in robust multi-chip analysis for Affymetrix gene expression arrays [<xref ref-type="bibr" rid="B24">24</xref>]. We recommend using median polish for experiments with a large number of replicate samples, while trimmed mean is recommended for arrays with densely tiled probes. The pseudo-median and median provide robust alternatives that can be applied in experiments that are not densely tiled and have few available replicates.</p>
      <p>To compare the performance of different scoring functions, the triplicate H3 acetylation data at 38 bp spacing from [<xref ref-type="bibr" rid="B25">25</xref>] were analyzed using a window size of 1,000 bp and a <italic>p </italic>value cutoff of 10<sup>-3</sup>. Median polish gave the most number of peaks while trimmed mean gave the least, the difference in number being around 3%. The agreement among median, pseudo-median and trimmed mean was around 97-99%, while median polish agreed with other methods by 93-97%. Comparable results were obtained, with 1-2% less agreement, when the data were re-analyzed at 76 bp spacing by skipping probes. The best agreement was found between trimmed mean and pseudo-median at 99-100% while the worst agreement was between median and median polish at 90-93%.</p>
      <p>To increase reliability, windows containing less than <italic>k </italic>probes are discarded, where <italic>k </italic>is again defined by the user. Just like MATscores, MA2Cscores approximately follow a normal distribution, with the representative scores of peak regions corresponding to the right tail. This fact easily allows us to assign a <italic>p </italic>value to each MA2Cscore using the normal probability distribution. The lower-bound of MA2Cscores for determining peaks may be based on either false discovery rate (FDR) or <italic>p </italic>value computations. As in [<xref ref-type="bibr" rid="B1">1</xref>], we empirically estimate FDR as follows: for a given cutoff value <italic>M </italic>&gt; 0 of MA2Cscore, we find all peaks with MA2Cscore greater than <italic>M </italic>and all peaks with MA2Cscore less than -<italic>M</italic>. Then, FDR is estimated as #(negative MA2Cscore peaks)/#(positive MA2Cscore peaks), and the number of true positive peaks as #(positive MA2Cscore peaks) - #(negative MA2Cscore peaks). The FDR table, along with other informative histograms, is generated by MA2C.</p>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>We have implemented our method as a user-friendly, stand-alone Java package called MA2C, which is fully automated and only requires the user to select the directory path and treatment channels.</p>
      <p>The file structure of NimbleGen data consists of three main components, <italic>DesignFiles/, PairData/</italic>, and <italic>SampleKey.txt</italic>, which should all reside in the same parent directory. The text file <italic>SampleKey.txt </italic>contains the relevant design information about individual arrays; in particular, the file must contain DESIGN_ID, CHIP_ID and DYE for each array. The directory <italic>DesignFiles/</italic>contains the sequence and position files corresponding to each DESIGN_ID, while <italic>PairData/</italic>contains the single channel data for each CHIP_ID. Even though MA2C is primarily designed for NimbleGen arrays, we have also successfully tested the program on Agilent data by reformatting the necessary files and obtained excellent results.</p>
      <p>When the user begins by selecting <italic>SampleKey.txt</italic>, MA2C reads the file and displays the content in a table. If <italic>DesignFiles/</italic>and <italic>PairData/</italic>are present in the parent path, MA2C also automatically lists the directory contents in two separate tables; otherwise, the user has to choose the corresponding folder locations. The user then selects the treatment channel for each experiment to be analyzed and clicks the Run button, which prompts MA2C to perform the normalization and peak detection steps as follows.</p>
      <sec>
        <title>Step 1: <italic>DesignFiles</italic>/</title>
        <p>For each DESIGN_ID, MA2C automatically reads the corresponding <italic>.ndf </italic>and <italic>.pos </italic>files and generates a <italic>.tpmap </italic>file containing the sequence, chromosome, position, and array coordinate information of probes.</p>
      </sec>
      <sec>
        <title>Step 2: <italic>PairData</italic>/</title>
        <p>For each chosen treatment channel with given CHIP_ID and DYE, MA2C searches for the correct two-channel data files. It is thus important that the pair data files contain a column corresponding to IMAGE_ID. For fast future access and also for compressed storage, the program combines each two-channel data into a single file named <italic>MA2C_CHIP_ID_raw.txt</italic>. Normalized data are similarly stored in files with the extension <italic>_normalized.txt</italic>.</p>
      </sec>
      <sec>
        <title>Step 3: <italic>MA2C_output</italic>/</title>
        <p>MA2C automatically creates this directory for writing files used in quality control of normalization and peak detection steps. The enriched regions are output in both <italic>.xls </italic>and <italic>.bed </italic>files that contain the chromosome, start, end, <italic>p </italic>value, MA2Cscore and peak-center information for each detected peak. <italic>MA2Cscore.bar </italic>and <italic>ratio.bar </italic>files are created for visualization using Affymetrix's Integrated Genome Browser [<xref ref-type="bibr" rid="B26">26</xref>].</p>
        <p>MA2C is an open source Java package that can be downloaded from [<xref ref-type="bibr" rid="B27">27</xref>]. MA2C runs on all platforms that support Java Runtime Environment 5.0 or higher and has been successfully tested on OS X, Linux and Windows operating systems. The program is written so as to economize the size of required files; once the <italic>.tpmap </italic>and <italic>_raw.txt </italic>files have been created, the subsequent runs of MA2C will use only those files and the user may remove the <italic>.ndf</italic>, <italic>.pos</italic>, and other pair data files. This approach can save hundreds of megabytes of disk space. In addition, our program is fast, the total execution time being usually less than a couple of minutes for multiple arrays. For example, on a laptop with a 2.13 GHz Intel M processor and 2 GB RAM, it takes 18 seconds to build a sequence file for 370,000 probes, 16 seconds to normalize the raw data, and 14 seconds to find peaks.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>bp, base-pairs; ChIP, chromatin immunoprecipitation; FDR, false discovery rate.</p>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>We thank Nathan Trinklein and Rick Myers' lab for generating the spike-in sample. We also thank the laboratories of Jason D Lieb and Bing Ren for their data and Xihong Lin and Nan Jiang for their insights on methodology. This project was partially funded by NIH grants 1R01 HG004069-01 and 1U01 HG004270-01.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gottardo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Carroll</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Model-based analysis of tiling-arrays for ChIP-chip.</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>2006</year>
        <volume>103</volume>
        <fpage>12457</fpage>
        <lpage>12462</lpage>
        <pub-id pub-id-type="pmid">16895995</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.0601180103</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Luu</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Peng</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ngai</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Normalization for cDNA microarray data: a robust composite method addressing single and multiple slide systematic variation.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2002</year>
        <volume>30</volume>
        <fpage>e15</fpage>
        <pub-id pub-id-type="pmid">11842121</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/30.4.e15</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolstad</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Astrand</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>A comparison of normalization methods for high density oligonucleotide array data based on variance and bias.</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>185</fpage>
        <lpage>193</lpage>
        <pub-id pub-id-type="pmid">12538238</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/19.2.185</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Martinez Murillo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Spencer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A model based background adjustment for oligonucleotide expression arrays.</article-title>
        <source>JASA</source>
        <year>2004</year>
        <volume>99</volume>
        <fpage>909</fpage>
        <lpage>917</lpage>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffmann</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Seidl</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Dugas</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Profound effect of normalization on detection of differentially expressed genes in oligonucleotide microarray data analysis.</article-title>
        <source>Genome Biol</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>RESEARCH0033</fpage>
        <pub-id pub-id-type="pmid">12184807</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tseng</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Oh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rohlin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Issues in cDNA microarray analysis: quality filtering, channel normalization, models of variations and assessment of gene effects.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>2549</fpage>
        <lpage>2557</lpage>
        <pub-id pub-id-type="pmid">11410663</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/29.12.2549</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dion</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Slack</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Altschuler</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rando</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Genome-scale identification of nucleosome positions in <italic>S. cerevisiae</italic>.</article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>309</volume>
        <fpage>626</fpage>
        <lpage>630</lpage>
        <pub-id pub-id-type="pmid">15961632</pub-id>
        <pub-id pub-id-type="doi">10.1126/science.1112178</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ozsolak</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>High-throughput mapping of the chromatin structure of human promoters.</article-title>
        <source>Nat Biotech</source>
        <year>2007</year>
        <volume>25</volume>
        <fpage>244</fpage>
        <lpage>248</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1279</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schadt</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Feature extraction and normalization algorithms for high-density oligonucleotide gene expression array data.</article-title>
        <source>J Cell Biochem Suppl</source>
        <year>2001</year>
        <issue>Suppl 37</issue>
        <fpage>120</fpage>
        <lpage>125</lpage>
        <pub-id pub-id-type="pmid">11842437</pub-id>
        <pub-id pub-id-type="doi">10.1002/jcb.10073</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dabney</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A new approach to intensity-dependent normalization of two-channel microarrays.</article-title>
        <source>Biostatistics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>128</fpage>
        <lpage>139</lpage>
        <pub-id pub-id-type="pmid">16636140</pub-id>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxj038</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Glynn</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Megee</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mistrot</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Unal</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Koshland</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>DeRisi</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gerton</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Genome-wide mapping of the cohesin complex in the yeast <italic>Saccharomyces cerevisiae</italic>.</article-title>
        <source>PLoS Biol</source>
        <year>2004</year>
        <volume>2</volume>
        <fpage>E259</fpage>
        <pub-id pub-id-type="pmid">15309048</pub-id>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0020259</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Barrera</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Qu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Singer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Richmond</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A high-resolution map of active promoters in the human genome.</article-title>
        <source>Nature</source>
        <year>2005</year>
        <volume>436</volume>
        <fpage>876</fpage>
        <lpage>880</lpage>
        <pub-id pub-id-type="pmid">15988478</pub-id>
        <pub-id pub-id-type="doi">10.1038/nature03877</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buck</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Nobel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lieb</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>ChIPOTle: a user-friendly tool for the analysis of ChIP-chip data.</article-title>
        <source>Genome Biol</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>R97</fpage>
        <pub-id pub-id-type="pmid">16277752</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2005-6-11-r97</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="other">
        <article-title>ChIPOTle</article-title>
        <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/chipotle-perl/"/>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chuang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Albertson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>DPY-27: A chromosome condensation protein homolog that regulates <italic>C. elegans </italic>dosage compensation through association with the X chromosome.</article-title>
        <source>Cell</source>
        <year>1994</year>
        <volume>79</volume>
        <fpage>459</fpage>
        <lpage>474</lpage>
        <pub-id pub-id-type="pmid">7954812</pub-id>
        <pub-id pub-id-type="doi">10.1016/0092-8674(94)90255-0</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Davis</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>SDC-3 coordinates the assembly of a dosage compensation complex on the nematode X chromosome.</article-title>
        <source>Development</source>
        <year>1997</year>
        <volume>124</volume>
        <fpage>1019</fpage>
        <lpage>1031</lpage>
        <pub-id pub-id-type="pmid">9056777</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ercan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Giresi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Whittle</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lieb</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>X-chromosome repression by localization of the <italic>C. elegans </italic>dosage compensation machinery to sites of transcription initiation.</article-title>
        <source>Nat Genet</source>
        <year>2007</year>
        <volume>39</volume>
        <fpage>403</fpage>
        <lpage>408</lpage>
        <pub-id pub-id-type="pmid">17293863</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1983</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kapranov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Drenkow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dike</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Brubaker</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Patel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Stern</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tammana</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Helt</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional maps of 10 human chromosomes at 5-nucleotide resolution.</article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>308</volume>
        <fpage>1149</fpage>
        <lpage>1154</lpage>
        <pub-id pub-id-type="pmid">15790807</pub-id>
        <pub-id pub-id-type="doi">10.1126/science.1108625</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schumacher</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kapranov</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kaminsky</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Flanagan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Assadzadeh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Yau</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Virtanen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Winegarden</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Gingeras</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Microarray-based DNA methylation profiling: technology and applications.</article-title>
        <source>Nucleic Acids Res</source>
        <year>2006</year>
        <volume>34</volume>
        <fpage>528</fpage>
        <lpage>542</lpage>
        <pub-id pub-id-type="pmid">16428248</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/gkj461</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giresi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lieb</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>How to find an opening (or lots of them).</article-title>
        <source>Nat Methods</source>
        <year>2006</year>
        <volume>3</volume>
        <fpage>501</fpage>
        <lpage>502</lpage>
        <pub-id pub-id-type="pmid">16791206</pub-id>
        <pub-id pub-id-type="doi">10.1038/nmeth0706-501</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sabo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kuehn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Thurman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rosenzweig</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Goldy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Haydock</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genome-scale mapping of DNase I sensitivity <italic>in vivo </italic>using tiling DNA microarrays.</article-title>
        <source>Nat Methods</source>
        <year>2006</year>
        <volume>3</volume>
        <fpage>511</fpage>
        <lpage>518</lpage>
        <pub-id pub-id-type="pmid">16791208</pub-id>
        <pub-id pub-id-type="doi">10.1038/nmeth890</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubbell</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Robust estimators for expression analysis.</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>1585</fpage>
        <lpage>1592</lpage>
        <pub-id pub-id-type="pmid">12490442</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.12.1585</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Emanuelsson</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Nagalakshmi</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Rozowsky</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Urban</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lian</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Stolc</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Gerstein</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Assessing the performance of different high-density tiling microarray strategies for mapping transcribed regions of the human genome.</article-title>
        <source>Genome Res</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>886</fpage>
        <lpage>897</lpage>
        <pub-id pub-id-type="pmid">17119069</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.5014606</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hobbs</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Collin</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beazer-Barclay</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Antonellis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Scherf</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Exploration, normalization, and summaries of high density oligonucleotide array probe level data.</article-title>
        <source>Biostatistics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>249</fpage>
        <lpage>264</lpage>
        <pub-id pub-id-type="pmid">12925520</pub-id>
        <pub-id pub-id-type="doi">10.1093/biostatistics/4.2.249</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heintzman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Stuart</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hon</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ching</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hawkins</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Barrera</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Van Calcar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Qu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Ching</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Distinct and predictive chromatin signatures of transcriptional promoters and enhancers in the human genome.</article-title>
        <source>Nat Genet</source>
        <year>2007</year>
        <volume>39</volume>
        <fpage>311</fpage>
        <lpage>318</lpage>
        <pub-id pub-id-type="pmid">17277777</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1966</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="other">
        <article-title>Affymetrix IGB</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.affymetrix.com"/>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="other">
        <article-title>MA2C</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://liulab.dfci.harvard.edu/MA2C/MA2C.htm"/>
      </citation>
    </ref>
  </ref-list>
</back>
