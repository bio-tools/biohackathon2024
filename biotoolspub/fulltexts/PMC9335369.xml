<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Archiving and Interchange DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName archivearticle.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName nlm2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Genet</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Genet.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-8021</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9335369</article-id>
    <article-id pub-id-type="publisher-id">954024</article-id>
    <article-id pub-id-type="doi">10.3389/fgene.2022.954024</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Genetics</subject>
        <subj-group>
          <subject>Methods</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Selecting Representative Samples From Complex Biological Datasets Using K-Medoids Clustering</article-title>
      <alt-title alt-title-type="left-running-head">Li et al.</alt-title>
      <alt-title alt-title-type="right-running-head">An Effective Representative Sampling Method</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Lei</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1270657/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lan</surname>
          <given-names>Linda Yu-Ling</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Huang</surname>
          <given-names>Lei</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ye</surname>
          <given-names>Congting</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">
          <sup>4</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/515298/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Andrade</surname>
          <given-names>Jorge</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">
          <sup>3</sup>
        </xref>
        <xref rid="aff5" ref-type="aff">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wilson</surname>
          <given-names>Patrick C.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <xref rid="c001" ref-type="corresp">*</xref>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>University of Chicago Department of Medicine</institution>, <institution>Section of Rheumatology</institution>, <institution>University of Chicago</institution>, <addr-line>Chicago</addr-line>, <addr-line>IL</addr-line>, <country>United States</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Knapp Center for Lupus and Immunology Research</institution>, <institution>University of Chicago</institution>, <addr-line>Chicago</addr-line>, <addr-line>IL</addr-line>, <country>United States</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Center for Research Informatics</institution>, <institution>University of Chicago</institution>, <addr-line>Chicago</addr-line>, <addr-line>IL</addr-line>, <country>United States</country></aff>
    <aff id="aff4"><sup>4</sup><institution>Key Laboratory of the Ministry of Education for Coastal and Wetland Ecosystems</institution>, <institution>College of the Environment and Ecology</institution>, <institution>Xiamen University</institution>, <addr-line>Xiamen</addr-line>, <country>China</country></aff>
    <aff id="aff5"><sup>5</sup><institution>Department of Pediatrics</institution>, <institution>University of Chicago</institution>, <addr-line>Chicago</addr-line>, <addr-line>IL</addr-line>, <country>United States</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p><bold>Edited by:</bold><ext-link xlink:href="https://loop.frontiersin.org/people/531759/overview" ext-link-type="uri">Quan Zou</ext-link>, University of Electronic Science and Technology of China, China</p>
      </fn>
      <fn fn-type="edited-by">
        <p><bold>Reviewed by:</bold><ext-link xlink:href="https://loop.frontiersin.org/people/1836667/overview" ext-link-type="uri">Weksi Budiaji</ext-link>, Sultan Ageng Tirtayasa University, Indonesia</p>
        <p><ext-link xlink:href="https://loop.frontiersin.org/people/1432518/overview" ext-link-type="uri">Sammed Mandape</ext-link>, University of North Texas Health Science Center, United States</p>
      </fn>
      <corresp id="c001">*Correspondence: Patrick C. Wilson, <email>pcw4001@med.cornell.edu</email>
</corresp>
      <fn fn-type="other">
        <p>This article was submitted to Computational Genomics, a section of the journal Frontiers in Genetics</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>7</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>954024</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="publishedonline">
        <day>20</day>
        <month>6</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2022 Li, Lan, Huang, Ye, Andrade and Wilson.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Li, Lan, Huang, Ye, Andrade and Wilson</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Rapid growth of single-cell sequencing techniques enables researchers to investigate almost millions of cells with diverse properties in a single experiment. Meanwhile, it also presents great challenges for selecting representative samples from massive single-cell populations for further experimental characterization, which requires a robust and compact sampling with balancing diverse properties of different priority levels. The conventional sampling methods fail to generate representative and generalizable subsets from a massive single-cell population or more complicated ensembles. Here, we present a toolkit called Cookie which can efficiently select out the most representative samples from a massive single-cell population with diverse properties. This method quantifies the relationships/similarities among samples using their Manhattan distances by vectorizing all given properties and then determines an appropriate sample size by evaluating the coverage of key properties from multiple candidate sizes, following by a k-medoids clustering to group samples into several clusters and selects centers from each cluster as the most representatives. Comparison of Cookie with conventional sampling methods using a single-cell atlas dataset, epidemiology surveillance data, and a simulated dataset shows the high efficacy, efficiency, and flexibly of Cookie. The Cookie toolkit is implemented in R and is freely available at <ext-link xlink:href="https://wilsonimmunologylab.github.io/Cookie/" ext-link-type="uri">https://wilsonimmunologylab.github.io/Cookie/</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>single cell</kwd>
      <kwd>sampling</kwd>
      <kwd>k-medoids</kwd>
      <kwd>R</kwd>
      <kwd>antibody candidate selection</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source id="cn001">
          <institution-wrap>
            <institution>National Institutes of Health
</institution>
            <institution-id institution-id-type="doi">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id award-type="contract" rid="cn001">2P01AI097092-06A1 U19AI109946 U19AI057266</award-id>
      </award-group>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Single-cell sequencing techniques grew extensively by developing higher cell throughput, improved sensitivity, better reliability, and more modalities in the last decade (<xref rid="B29" ref-type="bibr">Tang et al., 2009</xref>; <xref rid="B21" ref-type="bibr">Peterson et al., 2017</xref>; <xref rid="B28" ref-type="bibr">Svensson et al., 2018</xref>; <xref rid="B26" ref-type="bibr">Stuart and Satija, 2019</xref>). Among all biological topics and contexts, the immune system contains a massive amount of highly diverse cells in phenotype and function, and therefore has benefited enormously from the application of novel single-cell RNA sequencing (scRNA-seq) in order to investigate the development and activation of immune cells (<xref rid="B1" ref-type="bibr">Bendall et al., 2014</xref>; <xref rid="B7" ref-type="bibr">Goldstein et al., 2019</xref>; <xref rid="B35" ref-type="bibr">Winkels et al., 2018</xref>; <xref rid="B36" ref-type="bibr">Zhang et al., 2019</xref>). In detail, people are able to characterize diverse properties, for example, transcriptome expression, B cell repertoire (BCR), and surface protein expression, for a massive amount of single immune cells in a single experiment (<xref rid="B21" ref-type="bibr">Peterson et al., 2017</xref>; <xref rid="B7" ref-type="bibr">Goldstein et al., 2019</xref>; <xref rid="B16" ref-type="bibr">Li et al., 2021</xref>). This gives people immense power to comprehensively scan a whole population of immune cells in order to identify candidates for further experimental characterization (e.g., neutralizing and antibody binding) (<xref rid="B4" ref-type="bibr">Dugan et al., 2021</xref>). Since experimental characterizations are usually resource and human labor intensive, the number of candidates is usually limited by budget. Therefore, a sampling strategy that is capable to effectively select compact and representative samples from a massive population with diverse properties is highly demanded.</p>
    <p>The selection of representative samples to reflect the properties and maxima proportion of a large population is a common problem (<xref rid="B19" ref-type="bibr">McCarty et al., 1997</xref>; <xref rid="B32" ref-type="bibr">Tominaga, 1998</xref>; <xref rid="B24" ref-type="bibr">Siddiqui et al., 2006</xref>; <xref rid="B2" ref-type="bibr">Chen et al., 2016</xref>). Compared to conventional sampling problems, it imposes even more challenges when selecting samples from a massive biological dataset, for example, single-cell atlas dataset, as biological sample selections are often size sensitive and have diverse properties with different types and importance, and all properties need to be balanced in the selection. More specifically, novel biological data, represented by single-cell atlas data, proposed three specific requirements to representative sampling. First, the selected samples should be able to maximally represent the distribution of original population. Second, the sample size should be as compact as possible in order to save human labor and reagents. Third, randomness of selected samples is not preferred in those cases because subsequent experimental design requires robust and repeatable results. In general, a sampling strategy that can achieve the balance between scientific sufficiency and expense economy with high efficiency is preferred, which can effectively address the contradiction between growing detection capabilities and limited experimental capabilities.</p>
    <p>Sampling from a large population has been well studied, and multiple probability and nonprobability sampling methods, including simple random sampling, systematic sampling, cluster sampling, stratified sampling, quota sampling, and snowball sampling, have been proposed for practical sampling problems (<xref rid="B3" ref-type="bibr">Cochran, 2007</xref>; <xref rid="B5" ref-type="bibr">Fricker, 2008</xref>). Two implementations of probability sampling methods, R package “sampling” and “survey,” have been developed and widely used in the community (<xref rid="B31" ref-type="bibr">Tillé and Matei, 2006</xref>; <xref rid="B30" ref-type="bibr">Tillé et al., 2016</xref>; <xref rid="B18" ref-type="bibr">Lumley and Lumley, 2019</xref>). Those conventional methods do not or rarely use data structure in sampling; therefore, they fail to maximally balance the given properties. Some minor groups maybe ignored causing samples in those groups being rejected. Furthermore, the randomness in the results of probability sampling methods is not preferred or even strictly prohibited in candidates sampling of single-cell atlas data and some other contexts (e.g., influenza surveillance) because robust and repeatable results of each step are crucial for these studies. In addition, a group of Markov chain Monte Carlo (MCMC)–based sampling methods, for example, Metropolis–Hastings sampling and Gibbs Sampling, were proposed to solve sampling problem from high-dimensional population (Geman and GemanHastings, 1970;, 1984). These MCMC-based methods select samples by using data distribution on multiple properties of whole population, and therefore can generate much more representative results than conventional sampling methods. However, MCMC-based sampling methods are usually used to estimate parameters of unknown distribution by constructing a big stochastic process from a given population, or to generate representative samples from a known probability distribution. For single-cell datasets, the joint probability distributions of multiple properties are usually unknown and incalculable, which makes MCMC-based sampling unavailable. Moreover, after algorithms reach a convergence, MCMC-based methods prefer to select more samples for better estimation, which contradicts the requirement of compatibility of single-cell data selection. In practice, compatibility, stability, and representativeness on massive population are three priorities that may not be easily achieved by existing sampling methods. Meanwhile, a systematic approach to determine an appropriate sample size is required.</p>
    <p>To overcome these challenges, we developed a k-medoids clustering-based sampling strategy. This method achieves both stable and representative results and allows users to determine an optimized sample size by evaluating the coverage of key properties. We have made Cookie available on a public repository for users worldwide: <ext-link xlink:href="https://wilsonimmunologylab.github.io/Cookie/" ext-link-type="uri">https://wilsonimmunologylab.github.io/Cookie/</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="s2">
    <title>Materials and Methods</title>
    <sec id="s2-1">
      <title>Datasets</title>
      <p><bold>Simulated dataset:</bold> We generated a simulated dataset with 10,000 samples and five factors. We generated three-character type factors (Factors 1–3) and two numerical type factors (Factors 4 and 5). Factor 1 is a character factor with levels from 1—20; Factor 2 is a character factor with levels from 1—50; Factor 3 is a character factor with levels from group 1—group 9; Factor 4 is a numerical factor with integer values within the range of 1–20; and Factor 5 is a numerical factor with floating number values that follow a normal distribution (mean = 0, standard deviation = 1). There are a total of 10,000 records in this dataset, and we also extract different size subsets (1,000, 2,500, and 5,000) from this dataset to test the efficiency of our method on different data sizes.</p>
      <p><bold>Single-cell B cell dataset:</bold> In the vaccine clinical trial, we applied Cookie to unbiasedly select representative monoclonal antibodies for expression/characterization from 1,937 antibodies from 19 subjects, seven transcriptional clusters, four isotypes (IgA, IgG, IgM, and IgD), various V locus gene usages, and various CDR3 peptide lengths. We generated these monoclonal antibodies using single-cell B cell receptor cloning of a pair of the heavy chain and light chain genes followed by <italic>in vitro</italic> expression to further characterize mAb specificity and function to evaluate the vaccine response.</p>
      <p><bold>Human influenza H1N1 surveillance viral sample dataset:</bold> We downloaded all data records of human influenza H1N1 viruses collected between August 1, 2018 and August 1, 2019 from GISAID database (<ext-link xlink:href="https://www.gisaid.org/" ext-link-type="uri">https://www.gisaid.org/</ext-link>) (<xref rid="B23" ref-type="bibr">Shu and McCauley, 2017</xref>). A total of 8,449 viruses were retained after removing the redundant records. By comparing the sequences to the WHO recommended H1N1 vaccine strain A/Michigan/45/2015 (H1N1) (<ext-link xlink:href="https://www.cdc.gov/flu/season/flu-season-2018-2019.htm" ext-link-type="uri">https://www.cdc.gov/flu/season/flu-season-2018-2019.htm</ext-link>), we calculated mutation numbers of the HA1 protein for all H1N1 viruses. Mutation numbers of H1 epitopes was also calculated for all H1N1 viruses. The protein sequences were aligned using MAFFT v7.427 (<xref rid="B10" ref-type="bibr">Katoh and Standley, 2013</xref>). Positions of five epitopes of H1 protein were adopted from the literature (<xref rid="B15" ref-type="bibr">Li et al., 2020</xref>). In this dataset, there are four factors: month, continent, mutations, and mutations on epitopes. The month factor is a character factor with 12 levels (2018-08 to 2019-07); the continent factor is a character factor with six levels (Africa, Asia, Europe, North America, Oceania, and South America); mutations is a numerical factor with integer values within the range of 0–14; and mutation on epitope is a numerical factor with integer values within the range of 0–3. The dataset was downloaded on August 29, 2019.</p>
    </sec>
    <sec id="s2-2">
      <title>Data Vectorization</title>
      <p>Each sample was represented by a vector, and dimensions of the vector are factors from the original data (e.g., subject, transcriptional cluster or just “cluster,” gender, and antibody isotype). All factors can be divided into two groups: character factors and numerical factors. Character factors usually have multiple (two or more) discrete values, representing clusters, subjects, groups, batches, and so on. Numerical factors have continuous numerical values with either integers or floating numbers, and different levels can be quantified by the difference of these values. To clarify, character factors also have numerical levels. The difference between numerical factors and character factors is that the levels of character factors are none-quantifiable labels and the levels of numerical factors are quantifiable values. The difference between any two levels can be quantified by the difference of their values. For example, for a character factor (e.g., a cluster) which has three levels, the difference between levels 1 and 2 is equal to that between levels 1 and 3. For a numerical factor (e.g., number of mutations) which has three levels, the difference between levels 1 and 2 is smaller than that between levels 1 and 3.</p>
    </sec>
    <sec id="s2-3">
      <title>Linearization</title>
      <p>In biological datasets, logarithmic values are a commonly used data type (e.g., HI titers in Influenza hemagglutination inhibition assays, <ext-link xlink:href="https://www.cdc.gov/flu/about/professionals/antigenic.htm" ext-link-type="uri">https://www.cdc.gov/flu/about/professionals/antigenic.htm</ext-link>). In order to compare values within a factor, values of all the numerical factors should be linear (<xref rid="B27" ref-type="bibr">Sun et al., 2013</xref>). All of the nonlinear factors should be linearized in advance of further normalization. A logarithm will transfer logarithmic values into linear values. Users should choose the base number of the logarithm according to their dataset. For example, original HI titers are equal to <inline-formula id="inf1"><mml:math id="m1" overflow="scroll"><mml:mrow><mml:mi>H</mml:mi><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula id="inf2"><mml:math id="m2" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> is the number of dilutions, so the base of logarithm will be two for HI data; thus, the linearized HI titer should be: <inline-formula id="inf3"><mml:math id="m3" overflow="scroll"><mml:mrow><mml:mi>H</mml:mi><mml:mi>I</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>H</mml:mi><mml:mi>I</mml:mi><mml:mo>/</mml:mo><mml:mn>10</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec id="s2-4">
      <title>Normalization</title>
      <p>Data normalization is essential for numerical factors in order to be comparable with other factors (<xref rid="B8" ref-type="bibr">Hancock et al., 1988</xref>; <xref rid="B25" ref-type="bibr">Singh and Singh, 2020</xref>). Here, we adopted a min–max normalization method to scale a numerical factor such that all values are within the range of [0,1]. The normalized value <inline-formula id="inf4"><mml:math id="m4" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> can be calculated by the following equation:<disp-formula id="equ1"><mml:math id="m5" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="inf5"><mml:math id="m6" overflow="scroll"><mml:mi>x</mml:mi></mml:math></inline-formula>, <inline-formula id="inf6"><mml:math id="m7" overflow="scroll"><mml:mrow><mml:mo> </mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula id="inf7"><mml:math id="m8" overflow="scroll"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo></mml:mrow></mml:math></inline-formula> are the original values, the minimum value of original samples, and the maximum value of original samples, respectively.</p>
    </sec>
    <sec id="s2-5">
      <title>Distance Calculation</title>
      <p>For any two samples, we calculated pairwise distances following a two-step strategy, that is, (1) compute the differences between two samples on individual factors and 2) calculate the overall distance by integrating the differences from all factors. We applied binary distance coding to represent the difference among character factors (0 for equal and 1 for difference). For numerical factors, the distance is equal to the absolute value of the difference. Then, overall distance <inline-formula id="inf8"><mml:math id="m9" overflow="scroll"><mml:mi>D</mml:mi></mml:math></inline-formula> was calculated by integrating differences on all factors <inline-formula id="inf9"><mml:math id="m10" overflow="scroll"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> using a weighted <inline-formula id="inf10"><mml:math id="m11" overflow="scroll"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> norm (summary of their absolute values with weights). <inline-formula id="inf11"><mml:math id="m12" overflow="scroll"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> denotes weight of the <inline-formula id="inf12"><mml:math id="m13" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>-th factor:<disp-formula id="equ2"><mml:math id="m14" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mo>|</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
      <p>In case of missing values in the dataset, we consider the difference between missing values and any other value as 0. This strategy prevents introducing biases from comparing missing values with real values.</p>
    </sec>
    <sec id="s2-6">
      <title>Embedding</title>
      <p>To visualize the sampling results, we utilized two state-of-the-art nonlinear dimensional reduction methods, that is, uniform manifold approximation and projection (UMAP) and t-distributed stochastic neighbor embedding (t-SNE) (<xref rid="B20" ref-type="bibr">McInnes et al., 2018</xref>; <xref rid="B33" ref-type="bibr">Van der Maaten and Hinton, 2012</xref>). Both embedding methods accept pairwise distances as input and render a 2D projection of the samples.</p>
    </sec>
    <sec id="s2-7">
      <title>Roles of Factors</title>
      <p>In this workflow, we designed three different roles for factors which are as follows: prime factor, important factors, and regular factors. All factors contribute to the distance calculation. The prime factor and important factor are optional in a sampling. The prime factor is unique in a dataset, and the representative samples were selected evenly from each element of prime factor (e.g., subject and animal) instead of selecting from the entire dataset. Important factor indicates a 100% coverage requirement and can be multiple. Regular factors contribute to the distance calculation as other factors do but without any specific requirement to the sampling. The determination of prime factor and important factor is up to users own choice. Users can determine each factor from their dataset to any role (prime, important, or regular) according to their sampling needs and domain knowledge. For example, in the sampling from our single-cell B cell dataset, we would like to select samples from each subject (donors), so that “subject” was set as the prime factor. We would also like to investigate all transcriptional clusters, so that “cluster” was set as an important factor. The rest of the factors were set as regular factors.</p>
    </sec>
    <sec id="s2-8">
      <title>Clustering-Based Two-step Sampling Strategy</title>
      <p>To achieve a high sampling coverage with good representativeness, we designed a two-step sampling strategy. The first step is to select N samples from the entire dataset or from each subject if the prime factor was set using a k-medoids clustering method. The cost function in k-medoids algorithm is given as (<xref rid="B11" ref-type="bibr">Kaufman et al., 1987</xref>)<disp-formula id="equ3"><mml:math id="m15" overflow="scroll"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mo>|</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="inf13"><mml:math id="m16" overflow="scroll"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> denotes the medoid and <inline-formula id="inf14"><mml:math id="m17" overflow="scroll"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> denotes the sample. The most common implementation of k-medoids clustering is the partitioning around medoids (PAM) algorithm. More specifically, samples can be clustered into multiple evenly distributed clusters using the k-medoids clustering method. The medoid for each cluster can be considered as the most representative samples of the corresponding cluster. This step guarantees the representativeness of selected samples.</p>
      <p>The second step is to investigate the coverage rate of all important factors (defined by users) from the representative candidates picked by k-medoids clustering from last step. If any important factor has a coverage rate lower than 100%, then an additional selection will be performed to pick the proper samples from the unpicked population to cover all the levels/categories of the important factor. The strategy for adding qualified samples is as follows: for a category of an important factor that has not been covered by samples selected in step 1, if there is more than one candidate, we select the one that has the largest local distances with all selected samples in the first step. We define local distance as<disp-formula id="equ4"><mml:math id="m18" overflow="scroll"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="inf15"><mml:math id="m19" overflow="scroll"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> denotes the distance between the current sample and the <inline-formula id="inf16"><mml:math id="m20" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>-th selected samples. <inline-formula id="inf17"><mml:math id="m21" overflow="scroll"><mml:mi>S</mml:mi></mml:math></inline-formula> denotes the set of selected samples.</p>
    </sec>
    <sec id="s2-9">
      <title>Evaluation of Sampling</title>
      <p>The quality of sampling can be evaluated and quantified by coverage rate on each single factor. Here, for character factors, we define the coverage rate as<disp-formula id="equ5"><mml:math id="m22" overflow="scroll"><mml:mrow><mml:mtext>Coverage rate </mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo> </mml:mo><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo> </mml:mo><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo> </mml:mo><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mo> </mml:mo><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo> </mml:mo><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
      <p>To be consistent, for numerical factors, since they have been scaled into [0,1], we assigned them to ten evenly divided bins ([0, 0.1] [0.1, 0.2], … [0.9, 1]); and then the coverage rate of numerical factors can be defined as<disp-formula id="equ6"><mml:math id="m23" overflow="scroll"><mml:mrow><mml:mtext>Coverage rate </mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo> </mml:mo><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo> </mml:mo><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>u</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mo> </mml:mo><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mo> </mml:mo><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mo> </mml:mo><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mo> </mml:mo><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mo> </mml:mo><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
      <p>Of note, a statistical test between original population and selected population can also be used to evaluate the sampling quality for a numerical factor.</p>
      <p>Using the quantified coverage rate on each single factor, users can determine an optimized sample size that balances both factor coverage and cost.</p>
      <p>Users can also check the distribution of selected samples on each factor. For example, if the distribution of selected samples is identical to that of the original samples, it indicates that the sampling is of high quality. The similarity of distribution on each factor between the original population and selected samples can also be approximately quantified by Pearson correlation coefficient.<disp-formula id="equ7"><mml:math id="m24" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msubsup><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:msqrt><mml:mrow><mml:msubsup><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="inf18"><mml:math id="m25" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> is the number of levels in this factor and <inline-formula id="inf19"><mml:math id="m26" overflow="scroll"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="inf20"><mml:math id="m27" overflow="scroll"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are the number of samples of the <inline-formula id="inf21"><mml:math id="m28" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>-th level of this factor for two sets of samples; <inline-formula id="inf22"><mml:math id="m29" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and analogously for <inline-formula id="inf23"><mml:math id="m30" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s3">
    <title>Results</title>
    <sec id="s3-1">
      <title>Cookie: Representative Sample Selection From a Massive Population Using K-Medoids Clustering</title>
      <p>Here, we present Cookie, a user-friendly toolkit, to select representative samples from massive populations (especially single-cell sequencing data). The prime idea of this method is quantifying and vectorizing all samples in order to quantify their dissimilarity by their Manhattan distances, and then samples can be classified into several clusters by k-medoids clustering according to their dissimilarity and centers of those clusters are representative samples (<xref rid="F1" ref-type="fig">Figure 1</xref>). In detail, each sample is presented as a numerical vector, and the elements of the vector are attributes of the original data (e.g., subject, transcriptional cluster, and gender). The relationships/dissimilarity among all samples were quantified by calculating a pairwise Manhattan distance matrix. Based on that, a two-step sampling strategy was performed as follows: 1) classify samples into k clusters by k-medoids clustering and select centers of the k clusters and 2) add proper samples to qualify the coverage requirement on specified factors. This method is composed of four steps: normalization, distance calculation, sampling, and embedding (<xref rid="F1" ref-type="fig">Figure 1A</xref>). In this toolkit, we defined three roles of factors, prime, important, and regular, to help users better describe their sampling goal. To achieve better representativeness, we designed a two-step sampling strategy (<xref rid="F1" ref-type="fig">Figure 1B</xref>). The first step is to select k samples using k-medoids method from the entire population or from each subject of prime factor (<xref rid="B11" ref-type="bibr">Kaufman et al., 1987</xref>; <xref rid="B22" ref-type="bibr">Schubert and Rousseeuw, 2018</xref>). The second step is to add qualified samples to cover all the categories/levels of important factors (see <italic>Results</italic> for details). Cookie calculated the summary of distances between candidates and selected samples and always picks the one with largest distance if there is more than one candidate.</p>
      <fig position="float" id="F1">
        <label>FIGURE 1</label>
        <caption>
          <p>Workflow of k-medoids–based sampling. <bold>(A)</bold> Workflow of Cookie pipeline and <bold>(B)</bold> selecting representative samples using k-medoid clustering method.</p>
        </caption>
        <graphic xlink:href="fgene-13-954024-g001" position="float"/>
      </fig>
    </sec>
    <sec id="s3-2">
      <title>Application of Cookie on Single-Cell Atlas Data to Select Candidates of Monoclonal Antibody for Further Experimental Characterization</title>
      <p>We applied this method to select candidates of monoclonal antibody from the isolated genes for 1,937 antibodies for laborious protein expression and downstream analysis. The single-cell atlas dataset consists of seven transcriptional clusters, 19 subjects, a variety of V gene usages, four major isotypes, and a variety of complementarity-determining region 3 (CDR3) lengths among the genes for 1,937 antibodies. Our goal was to 1) select representative samples for laborious protein expression from the genes of 1,937 antibodies and 2) determine the optimized sample size that can balance sampling coverage on all factors and economy. For this dataset, we wanted to evenly select samples from each subject, and a 100% coverage is required for transcriptional clusters. We set “Subject” as the prime factor and “transcriptional cluster” as an important factor. As shown in <xref rid="F2" ref-type="fig">Figure 2A</xref>, coverage of all factors is positively correlated with sample sizes from each subject, and N = 7 is the optimal sample size from each subject because 100% coverage of three key factors (subject, cluster, and isotype) and high coverage of other two factors have been achieved. After determining the sample size to seven per subject, we selected 133 samples from 1,937 antibodies with a 100% coverage on subject, cell cluster, and isotype (<xref rid="F2" ref-type="fig">Figure 2B</xref>). We observed highly similar distributions between selected 133 samples and the original population by comparing the distribution of five factors (<xref rid="F2" ref-type="fig">Figure 2C</xref>). Moreover, the total runtime of sample size determination and sampling is less than ten seconds. In conclusion, results on real single-cell B cell dataset showed that Cookie toolkit is effective and efficient in selecting candidate antibodies for further experimental characterization from massive single-cell population.</p>
      <fig position="float" id="F2">
        <label>FIGURE 2</label>
        <caption>
          <p>Select representative samples from a large single-cell population. <bold>(A)</bold> Determine appropriate sample size by quantifying coverage on all factors. Line of subject factor was indicated by dash line to avoid overlap. <bold>(B)</bold> Coverage on each factor of selected samples. <bold>(C)</bold> Compare distributions on each factor between original population and select samples.</p>
        </caption>
        <graphic xlink:href="fgene-13-954024-g002" position="float"/>
      </fig>
    </sec>
    <sec id="s3-3">
      <title>Application of Cookie on Human Influenza Virus Surveillance Data</title>
      <p>Beside single-cell sequencing data, Cookie toolkit is also compatible with more biological applications. Here, we examined the flexibility of our method on a different type of biological dataset. Influenza virus has a highly mutable replication process allowing it to escape from immunity, often on an annual basis (<xref rid="B13" ref-type="bibr">Kosikova et al., 2018</xref>). In order to control this escape, each influenza season, tens of thousands of samples of influenza viruses are collected from surveillance programs across six continents (<xref rid="B14" ref-type="bibr">Lackenby et al., 2018</xref>). Identifying antigenic variants from those viral samples is the key to a successful vaccine strain selection to generate a vaccine protective against the most common viral variants (<xref rid="B12" ref-type="bibr">Koel et al., 2013</xref>). The main challenge is that people can only investigate antigenic profiles for a small proportion of all viral samples using HI assay, which is time- and labor-intensive. An efficient sampling method that can balance samples with genetic variations, locations, and times of sampling (month) is required. The k-medoids sampling method proposed in this study is capable of addressing this problem. We performed the k-medoids sampling on a human H1N1 influenza dataset with 8,449 viral samples (see dataset section for details) using Cookie toolkit. To identify the earliest antigenic variant, we set “Month” as a prime factor to balance samples from different time periods. The sample size test indicates that a sample size of five (setting sample size to seven will slightly increase the coverage of mutation, if budget allows) is an appropriate choice for this dataset (<xref rid="F3" ref-type="fig">Figure 3A</xref>). With the sample size of five, the selected samples covered all the clusters, and therefore are able to represent all of the genetic-temporal-spatial combined variances (<xref rid="F3" ref-type="fig">Figure 3B</xref>). The distribution of each factor also shows that the selected samples have a highly similar distribution as the original population (<xref rid="F3" ref-type="fig">Figure 3C</xref>). In general, results on two real datasets showed that Cookie specializes in solving contradiction between large detective capabilities and limited experimental capabilities and is compatible with multiple biological contexts.</p>
      <fig position="float" id="F3">
        <label>FIGURE 3</label>
        <caption>
          <p>Selected representative samples from human Influenza H1N1 surveillance data. <bold>(A)</bold> Testing coverage rate on each factor of different sample sizes. <bold>(B)</bold> Selected samples and unselected samples on 2D visualization (t-SNE). <bold>(C)</bold> Distributions of each factor of original population and selected samples.</p>
        </caption>
        <graphic xlink:href="fgene-13-954024-g003" position="float"/>
      </fig>
    </sec>
    <sec id="s3-4">
      <title>Evaluation of Cookie Performance Using Simulated Data of Different Population Sizes</title>
      <p>To evaluate the efficiency and compatibility of this method, we generated a simulated dataset (see datasets section for details) and tested our method on this simulated dataset. We compared the runtime of our method on four different data sizes: 1,000, 2,500, 5,000, and 10,000 samples. As shown in <xref rid="T1" ref-type="table">table 1</xref>, with increasing population sizes, the runtime of the four major steps (distance calculation, nonlinear reduction, sample size test, and sampling) increased exponentially. In addition, sampling from the levels of prime factor is much faster than sampling from the entire population, especially for large populations. That is because the runtime complexity of the k-medoids clustering algorithm (also called as PAM algorithm) is <inline-formula id="inf24"><mml:math id="m31" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula>, and the runtime is proportional to population size <inline-formula id="inf25"><mml:math id="m32" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> and cluster number <inline-formula id="inf26"><mml:math id="m33" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula>. A recent study proposed an optimized k-medoids clustering algorithm called FastPAM that reduces the runtime complexity to <inline-formula id="inf27"><mml:math id="m34" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (<xref rid="B22" ref-type="bibr">Schubert and Rousseeuw, 2018</xref>). By adopting the FastPAM algorithm, the runtime was largely reduced (<xref rid="T1" ref-type="table">Table 1</xref>). Of note, conventional probability sampling methods are much faster than k-medoids sampling because such methods do not (or rarely) use data structure and distribution of the original population as seen in k-medoids. In conclusion, our results indicate that k-medoids sampling is able to effectively and efficiently select representative samples from large populations (<xref rid="T1" ref-type="table">Tables 1</xref>, <xref rid="T2" ref-type="table">2</xref>). These results also demonstrate that sampling from levels of a prime factor or using algorithm acceleration (FastPAM) could significantly reduce the sampling time.</p>
      <table-wrap position="float" id="T1">
        <label>TABLE 1</label>
        <caption>
          <p>Runtime of major steps of Cookie pipeline on different population sizes. All the tests were performed on a simulated dataset using a 2015 Apple MacBook Pro (Core i5, 2.7GHZ, 8 GB DDR3 memory). N denotes population size.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead valign="top">
            <tr>
              <th rowspan="2" colspan="2" align="left">Processing Step</th>
              <th colspan="4" align="center" rowspan="1">Runtime (seconds)</th>
            </tr>
            <tr>
              <th align="center" rowspan="1" colspan="1">N = 1,000</th>
              <th align="center" rowspan="1" colspan="1">N = 2,500</th>
              <th align="center" rowspan="1" colspan="1">N = 5,000</th>
              <th align="center" rowspan="1" colspan="1">N = 10,000</th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td rowspan="4" align="left" colspan="1">Preprocess</td>
              <td align="left" rowspan="1" colspan="1">Create object</td>
              <td align="char" char="." rowspan="1" colspan="1">0.001</td>
              <td align="char" char="." rowspan="1" colspan="1">0.004</td>
              <td align="char" char="." rowspan="1" colspan="1">0.004</td>
              <td align="char" char="." rowspan="1" colspan="1">0.05</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Normalization</td>
              <td align="char" char="." rowspan="1" colspan="1">0.003</td>
              <td align="char" char="." rowspan="1" colspan="1">0.005</td>
              <td align="char" char="." rowspan="1" colspan="1">0.012</td>
              <td align="char" char="." rowspan="1" colspan="1">0.027</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Distance calculation</td>
              <td align="char" char="." rowspan="1" colspan="1">0.347</td>
              <td align="char" char="." rowspan="1" colspan="1">1.77</td>
              <td align="char" char="." rowspan="1" colspan="1">7.375</td>
              <td align="char" char="." rowspan="1" colspan="1">32.511</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Nonlinear reduction (t-SNE)</td>
              <td align="char" char="." rowspan="1" colspan="1">6.759</td>
              <td align="char" char="." rowspan="1" colspan="1">13.731</td>
              <td align="char" char="." rowspan="1" colspan="1">50.701</td>
              <td align="char" char="." rowspan="1" colspan="1">142.668</td>
            </tr>
            <tr>
              <td rowspan="2" align="left" colspan="1">Prime factor mode* (PAM algorithm)</td>
              <td align="left" rowspan="1" colspan="1">Sample size test</td>
              <td align="char" char="." rowspan="1" colspan="1">0.279</td>
              <td align="char" char="." rowspan="1" colspan="1">1.414</td>
              <td align="char" char="." rowspan="1" colspan="1">9.097</td>
              <td align="char" char="." rowspan="1" colspan="1">54.703</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Sampling</td>
              <td align="char" char="." rowspan="1" colspan="1">0.04</td>
              <td align="char" char="." rowspan="1" colspan="1">0.195</td>
              <td align="char" char="." rowspan="1" colspan="1">1.523</td>
              <td align="char" char="." rowspan="1" colspan="1">6.134</td>
            </tr>
            <tr>
              <td rowspan="2" align="left" colspan="1">Prime factor mode* (FastPAM algorithm)</td>
              <td align="left" rowspan="1" colspan="1">Sample size test</td>
              <td align="char" char="." rowspan="1" colspan="1">0.663</td>
              <td align="char" char="." rowspan="1" colspan="1">1.036</td>
              <td align="char" char="." rowspan="1" colspan="1">4.276</td>
              <td align="char" char="." rowspan="1" colspan="1">43.047</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Sampling</td>
              <td align="char" char="." rowspan="1" colspan="1">0.123</td>
              <td align="char" char="." rowspan="1" colspan="1">0.154</td>
              <td align="char" char="." rowspan="1" colspan="1">0.578</td>
              <td align="char" char="." rowspan="1" colspan="1">3.089</td>
            </tr>
            <tr>
              <td rowspan="2" align="left" colspan="1">Nonprime factor mode** (PAM algorithm)</td>
              <td align="left" rowspan="1" colspan="1">Sample size test</td>
              <td align="char" char="." rowspan="1" colspan="1">26.258</td>
              <td align="char" char="." rowspan="1" colspan="1">301.05</td>
              <td align="char" char="." rowspan="1" colspan="1">1750.68</td>
              <td align="char" char="." rowspan="1" colspan="1">&gt;3,000</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Sampling</td>
              <td align="char" char="." rowspan="1" colspan="1">3.517</td>
              <td align="char" char="." rowspan="1" colspan="1">36.251</td>
              <td align="char" char="." rowspan="1" colspan="1">261.614</td>
              <td align="char" char="." rowspan="1" colspan="1">&gt;3,000</td>
            </tr>
            <tr>
              <td rowspan="2" align="left" colspan="1">Non-prime factor mode** (FastPAM algorithm)</td>
              <td align="left" rowspan="1" colspan="1">Sample size test</td>
              <td align="char" char="." rowspan="1" colspan="1">4.403</td>
              <td align="char" char="." rowspan="1" colspan="1">27.656</td>
              <td align="char" char="." rowspan="1" colspan="1">115.79</td>
              <td align="char" char="." rowspan="1" colspan="1">598.854</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Sampling</td>
              <td align="char" char="." rowspan="1" colspan="1">0.493</td>
              <td align="char" char="." rowspan="1" colspan="1">3.31</td>
              <td align="char" char="." rowspan="1" colspan="1">13.522</td>
              <td align="char" char="." rowspan="1" colspan="1">68.22</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="Tfn1">
            <label>*</label>
            <p>A prime factor is determined in this run. Algorithms for k-medoids clustering are indicated in the brackets.</p>
          </fn>
          <fn id="Tfn2">
            <label>**</label>
            <p>No prime factor is determined in this run. Algorithms for k-medoids clustering are indicated in the brackets.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="T2">
        <label>TABLE 2</label>
        <caption>
          <p>Coverage rates of k-medoids sampling on different population sizes. All the tests were performed on a simulated dataset using a 2015 Apple MacBook Pro (Core i5, 2.7GHZ, 8 GB DDR3 memory). N denotes population size. Tests were generated using the Cookie package with the FastPAM method. The sample size for prime factor mode is set to 10 (from each level of prime factor) and that for no-prime factor mode is set to 100.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead valign="top">
            <tr>
              <th rowspan="2" colspan="2" align="left">Factor</th>
              <th colspan="4" align="center" rowspan="1">Coverage Rate (%)</th>
            </tr>
            <tr>
              <th align="center" rowspan="1" colspan="1">N = 1,000</th>
              <th align="center" rowspan="1" colspan="1">N = 2,500</th>
              <th align="center" rowspan="1" colspan="1">N = 5,000</th>
              <th align="center" rowspan="1" colspan="1">N = 10,000</th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td rowspan="5" align="left" colspan="1">Prime factor</td>
              <td align="left" rowspan="1" colspan="1">Factor 1</td>
              <td align="char" char="." rowspan="1" colspan="1">84.00</td>
              <td align="char" char="." rowspan="1" colspan="1">82.00</td>
              <td align="char" char="." rowspan="1" colspan="1">78.00</td>
              <td align="char" char="." rowspan="1" colspan="1">80.00</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Factor 2</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Factor 3</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Factor 4</td>
              <td align="char" char="." rowspan="1" colspan="1">90.91</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">90.91</td>
              <td align="char" char="." rowspan="1" colspan="1">90.91</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Factor 5</td>
              <td align="char" char="." rowspan="1" colspan="1">81.82</td>
              <td align="char" char="." rowspan="1" colspan="1">72.7</td>
              <td align="char" char="." rowspan="1" colspan="1">72.7</td>
              <td align="char" char="." rowspan="1" colspan="1">72.73</td>
            </tr>
            <tr>
              <td rowspan="5" align="left" colspan="1">Nonprime factor</td>
              <td align="left" rowspan="1" colspan="1">Factor 1</td>
              <td align="char" char="." rowspan="1" colspan="1">92.00</td>
              <td align="char" char="." rowspan="1" colspan="1">86.00</td>
              <td align="char" char="." rowspan="1" colspan="1">88.00</td>
              <td align="char" char="." rowspan="1" colspan="1">84.00</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Factor 2</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Factor 3</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Factor 4</td>
              <td align="char" char="." rowspan="1" colspan="1">90.91</td>
              <td align="char" char="." rowspan="1" colspan="1">100.00</td>
              <td align="char" char="." rowspan="1" colspan="1">90.91</td>
              <td align="char" char="." rowspan="1" colspan="1">90.91</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Factor 5</td>
              <td align="char" char="." rowspan="1" colspan="1">81.82</td>
              <td align="char" char="." rowspan="1" colspan="1">72.73</td>
              <td align="char" char="." rowspan="1" colspan="1">72.7</td>
              <td align="char" char="." rowspan="1" colspan="1">72.73</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="s3-5">
      <title>Comparison With a Conventional Probability Sampling Method</title>
      <p>The randomness of probability sampling methods is not preferred in antibody selection from single-cell data and some other biological studies. In these cases, distributions and importance of factors are well known. The top priority of sampling is to select the most representative samples based on those factors. Randomness will help less to establish representativeness and may result in inconvenience for further experimental design. Another issue with probability sampling is that the results from two independent probability samplings may be different. Nevertheless, we compared our method to probability sampling methods. We used stratified sampling, the most suitable method for this single-cell dataset among all probability sampling methods, as an example of probability sampling methods. This comparison was performed on our single-cell dataset (see dataset section for details). As shown in <xref rid="F4" ref-type="fig">Figure 4</xref>, we compared our method to the stratified sampling method with the same sampling size (select 133 samples from 1,937 cells). Samples were stratified according to “Subject” in stratified sampling. “Subject” was set as the prime factor and “Cluster” was set as an important factor in our method. We performed ten independent runs of stratified sampling on the single-cell dataset, and the results showed that the coverage rates of each factor among ten runs vary (<xref rid="F4" ref-type="fig">Figure 4A</xref>), with two runs not even covering all cell clusters (run5 and run6). We picked two from the ten runs (run4 the best and run5 the worst) and compared the results to Cookie selection and the original population (<xref rid="F4" ref-type="fig">Figure 4B</xref>). The results show that both k-medoids clustering selection and run4 of stratified sampling are able to represent the original population while run5 fails (fail to select any sample from a small cluster, “Cluster 7”). The results prove that the k-medoids clustering method is not only effective for the selection of representative samples but also able to avoid potential bias caused by the randomness of probability sampling.</p>
      <fig position="float" id="F4">
        <label>FIGURE 4</label>
        <caption>
          <p>Compare k-medoid sampling with probability sampling method (stratified sampling). <bold>(A)</bold> Coverage rate on each factor of ten independent runs of stratified sampling. <bold>(B)</bold> Distributions of each factor of original population and samples selected by k-medoid sampling and stratified sampling.</p>
        </caption>
        <graphic xlink:href="fgene-13-954024-g004" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s4">
    <title>Discussion</title>
    <p>Based on a k-medoids clustering strategy, we developed a method to select representative samples from a large population. A similar approach for geographical sampling using a k-means clustering method was developed in a prior study (<xref rid="B34" ref-type="bibr">Walvoort et al., 2010</xref>). Their results also proved the representativeness and practicability of application of clustering methods in sampling. Of note, their method requires an existing distance measurement among the original samples. It limited the application range of the method since most of biological/clinical datasets do not satisfy the requirement. By developing a workflow consisting of data vectorization and distance calculation steps, our method normalizes different types of factors into the same scale and quantifies the distances among samples based on those normalized factors. This workflow can quantify relationships among samples for all the populations with multiple numerical and non-numerical factors and greatly expand the range of application of our method. Compared to the previous clustering-based sampling approach, our method is advantageous for single-cell populations with complicated structures (multiple factors with different types and priority levels) and compatible with most of the biological datasets.</p>
    <p>Conventional probabilistic/nonprobabilistic sampling methods do not or rarely use data structure in sampling. While it highly improves efficiency of sampling process by not using data structure however, the representativeness of samples through random selections usually cannot be guaranteed. By contrast, our method uses the entire data structure when selecting samples. It generates pairwise distance matrix by considering all factors with different priority levels to quantify relationships among samples. Then our method selects samples using k-medoids clustering method by dividing entire population into k clusters. Since the clustering results are subject to pairwise distance that considers all factors, factors of selected samples are therefore maximumly balanced. In other words, the representativeness of selected samples is achieved by balancing all factors of original population. Of note, considering all details in data structure will result in inefficiency, especially for large populations due to the exponential growth of running time as the sample number increases. By introducing a recent proposed method FastPAM, the runtime complexity was greatly reduced. Simulation results showed that Cookie toolkit is capable for robust and efficient sample selection from large populations.</p>
    <p>In practice, the number of candidates to be experimentally characterized is usually limited; therefore, selected sample size should be optimized to balance the representativeness and economy. Conventional methods usually do not offer an effective method to determine an appropriate sample size. Furthermore, the representativeness of a sample selection is usually difficult to evaluate. To overcome this challenge, Cookie implemented coverage rate of factors to quantify and evaluate the representativeness of a sample selection. The method also allows users to determine an appropriate sampling size by comparing coverage rates of different sample sizes. In addition, our framework is highly modularized and extendable; other evaluation metrics, for example, Pearson’s correlation coefficient, can also be incorporated to the evaluation process. By evaluating on different population sizes using both experimental data and simulated data, our method was proven to be effective and efficient.</p>
    <p>In conclusion, we proposed a sampling method that achieved representativeness, stability, economy, and universality. The method is implemented in an R package Cookie and is freely accessible on GitHub. We hope this toolkit (package) will help biologists select representative samples in an unbiased manner from large-scale datasets.</p>
    <sec id="s4-1">
      <title>Limitations</title>
      <p>There are two major limitations of this workflow. First, there is only one distance metric (Manhattan distance) in current model. Since different distance measurements can highly affect the clustering results, therefore affecting the final sampling results, investigating effects of different distance measurements is promising to improve the clustering and sampling in the future work. The second limitation is that the time complex of calculating the pairwise distance matrix increases exponentially as the sample number increases. It limits the application of this method on future massive datasets (e.g., datasets have more than 50,000 samples). Furthermore, in current model, we approximately quantify the differences between any two levels of a character factor as the same. A more precise strategy for differences quantification of character factors is also needed to improve the sampling results.</p>
    </sec>
    <sec id="s4-2">
      <title>Code Availability</title>
      <p>The method is implemented in R and is freely available on GitHub <ext-link xlink:href="https://github.com/WilsonImmunologyLab/Cookie" ext-link-type="uri">https://github.com/WilsonImmunologyLab/Cookie</ext-link>. The source is also available at Zenodo: <ext-link xlink:href="https://zenodo.org/record/6639035" ext-link-type="uri">https://zenodo.org/record/6639035#.YqdqBRPMIvo</ext-link>. Tutorials and documents are available at <ext-link xlink:href="https://wilsonimmunologylab.github.io/Cookie/" ext-link-type="uri">https://wilsonimmunologylab.github.io/Cookie/</ext-link>.</p>
      <p>The package has been tested under 1) macOS Mojave version 10.14.6 with R version 3.6.0 and RStudio Version 1.2.1335 and 2) ubuntu 18.04 64bit with R version 3.5.</p>
    </sec>
  </sec>
</body>
<back>
  <sec sec-type="data-availability" id="s5">
    <title>Data Availability Statement</title>
    <p>The original contributions presented in the study are included in the article/Supplementary Material; further inquiries can be directed to the corresponding author.</p>
  </sec>
  <sec id="s6">
    <title>Author Contributions</title>
    <p>LL designed the computational model, wrote the pipeline, performed the analysis, and wrote the manuscript. LY-LL generated the single-cell data and performed the analysis. LH revised the pipeline. CY revised the manuscript. JA revised the manuscript. PW supervised the work and wrote the manuscript.</p>
  </sec>
  <sec id="s7">
    <title>Funding</title>
    <p>This project was funded in part by the National Institute of Allergy and Infectious Disease, National Institutes of Health grant numbers 2P01AI097092-06A1, U19AI109946, and U19AI057266, the NIAID Centers of Excellence for Influenza Research and Surveillance (CEIRS) grant numbers HHSN272201400005C, and Bill and Melinda Gates Foundation (OPP1084518). The Center for Research Informatics was funded by the Biological Sciences Division at the University of Chicago with additional funding provided by the Institute for Translational Medicine/Clinical and Translational Award (NIH5UL1TR002389-02) and the University of Chicago Comprehensive Cancer Center Support Grant (NIH P30CA014599).</p>
  </sec>
  <sec sec-type="COI-statement" id="s8">
    <title>Conflict of Interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
  <sec sec-type="disclaimer" id="s9">
    <title>Publisher’s Note</title>
    <p>All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated organizations, or those of the publisher, the editors, and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher.</p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bendall</surname><given-names>S. C.</given-names></name><name><surname>Davis</surname><given-names>K. L.</given-names></name><name><surname>Amir</surname><given-names>E.-A. D.</given-names></name><name><surname>Tadmor</surname><given-names>M. D.</given-names></name><name><surname>Simonds</surname><given-names>E. F.</given-names></name><name><surname>Chen</surname><given-names>T. J.</given-names></name><etal/></person-group> (<year>2014</year>). <article-title>Single-cell Trajectory Detection Uncovers Progression and Regulatory Coordination in Human B Cell Development</article-title>. <source>Cell.</source>
<volume>157</volume>, <fpage>714</fpage>–<lpage>725</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2014.04.005</pub-id>
<pub-id pub-id-type="pmid">24766814</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>W.-R.</given-names></name><name><surname>Yun</surname><given-names>Y.-H.</given-names></name><name><surname>Wen</surname><given-names>M.</given-names></name><name><surname>Lu</surname><given-names>H.-M.</given-names></name><name><surname>Zhang</surname><given-names>Z.-M.</given-names></name><name><surname>Liang</surname><given-names>Y.-Z.</given-names></name></person-group> (<year>2016</year>). <article-title>Representative Subset Selection and Outlier Detection via Isolation Forest</article-title>. <source>Anal. Methods</source>
<volume>8</volume>, <fpage>7225</fpage>–<lpage>7231</lpage>. <pub-id pub-id-type="doi">10.1039/c6ay01574c</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Cochran</surname><given-names>W. G.</given-names></name></person-group> (<year>2007</year>). <source>Sampling Techniques</source>. <publisher-loc>Hoboken, NJ, United States</publisher-loc>: <publisher-name>John Wiley &amp; Sons</publisher-name>. </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dugan</surname><given-names>H. L.</given-names></name><name><surname>Stamper</surname><given-names>C. T.</given-names></name><name><surname>Li</surname><given-names>L.</given-names></name><name><surname>Changrob</surname><given-names>S.</given-names></name><name><surname>Asby</surname><given-names>N. W.</given-names></name><name><surname>Halfmann</surname><given-names>P. J.</given-names></name><etal/></person-group> (<year>2021</year>). <article-title>Profiling B Cell Immunodominance after SARS-CoV-2 Infection Reveals Antibody Evolution to Non-neutralizing Viral Targets</article-title>. <source>Immunity</source>
<volume>54</volume>, <fpage>1290</fpage>–<lpage>1303</lpage>. <comment>e7</comment>. <pub-id pub-id-type="doi">10.1016/j.immuni.2021.05.001</pub-id>
<pub-id pub-id-type="pmid">34022127</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Fricker</surname><given-names>R. D.</given-names></name></person-group> (<year>2008</year>). “<article-title>Sampling Methods for Web and E-Mail Surveys</article-title>,” in <source>The SAGE Handbook of Online Research Methods</source>. <publisher-loc>London</publisher-loc>: <publisher-name>SAGE Publications Ltd</publisher-name>, <fpage>195</fpage>–<lpage>216</lpage>. <pub-id pub-id-type="doi">10.4135/9780857020055.n11</pub-id>
</mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Geman</surname><given-names>S.</given-names></name><name><surname>Geman</surname><given-names>D.</given-names></name></person-group> (<year>1984</year>). <article-title>Stochastic Relaxation, Gibbs Distributions, and the Bayesian Restoration of Images</article-title>. <source>IEEE Trans. Pattern Anal. Mach. Intell.</source>
<volume>PAMI-6</volume>, <fpage>721</fpage>–<lpage>741</lpage>. <pub-id pub-id-type="doi">10.1109/tpami.1984.4767596</pub-id>
</mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Goldstein</surname><given-names>L. D.</given-names></name><name><surname>Chen</surname><given-names>Y. J.</given-names></name><name><surname>Wu</surname><given-names>J.</given-names></name><name><surname>Chaudhuri</surname><given-names>S.</given-names></name><name><surname>Hsiao</surname><given-names>Y. C.</given-names></name><name><surname>Schneider</surname><given-names>K.</given-names></name><etal/></person-group> (<year>2019</year>). <article-title>Massively Parallel Single-Cell B-Cell Receptor Sequencing Enables Rapid Discovery of Diverse Antigen-Reactive Antibodies</article-title>. <source>Commun. Biol.</source>
<volume>2</volume>, <fpage>304</fpage>–<lpage>310</lpage>. <pub-id pub-id-type="doi">10.1038/s42003-019-0551-y</pub-id>
<pub-id pub-id-type="pmid">31428692</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hancock</surname><given-names>A. A.</given-names></name><name><surname>Bush</surname><given-names>E. N.</given-names></name><name><surname>Stanisic</surname><given-names>D.</given-names></name><name><surname>Kyncl</surname><given-names>J. J.</given-names></name><name><surname>Lin</surname><given-names>C. T.</given-names></name></person-group> (<year>1988</year>). <article-title>Data Normalization before Statistical Analysis: Keeping the Horse before the Cart</article-title>. <source>Trends Pharmacol. Sci.</source>
<volume>9</volume>, <fpage>29</fpage>–<lpage>32</lpage>. <pub-id pub-id-type="doi">10.1016/0165-6147(88)90239-8</pub-id>
<pub-id pub-id-type="pmid">3245075</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hastings</surname><given-names>W. K.</given-names></name></person-group> (<year>1970</year>). <article-title>Monte Carlo Sampling Methods Using Markov Chains and Their Applications</article-title>. <source>Biometrika</source>
<volume>57</volume>, <fpage>97</fpage>–<lpage>109</lpage>. <pub-id pub-id-type="doi">10.2307/2334940</pub-id>
</mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Katoh</surname><given-names>K.</given-names></name><name><surname>Standley</surname><given-names>D. M.</given-names></name></person-group> (<year>2013</year>). <article-title>MAFFT Multiple Sequence Alignment Software Version 7: Improvements in Performance and Usability</article-title>. <source>Mol. Biol. Evol.</source>
<volume>30</volume>, <fpage>772</fpage>–<lpage>780</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>
<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kaufman</surname><given-names>L.</given-names></name><name><surname>Rousseeuw</surname><given-names>P.</given-names></name><name><surname>Dodge</surname><given-names>Y.</given-names></name></person-group> (<year>1987</year>). <source>Clustering by Means of Medoids in Statistical Data Analysis Based on the. L1 Norm</source>. <publisher-loc>North-Holland, Amsterdam</publisher-loc>. </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koel</surname><given-names>B. F.</given-names></name><name><surname>Burke</surname><given-names>D. F.</given-names></name><name><surname>Bestebroer</surname><given-names>T. M.</given-names></name><name><surname>van der Vliet</surname><given-names>S.</given-names></name><name><surname>Zondag</surname><given-names>G. C. M.</given-names></name><name><surname>Vervaet</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>Substitutions Near the Receptor Binding Site Determine Major Antigenic Change during Influenza Virus Evolution</article-title>. <source>Science</source>
<volume>342</volume>, <fpage>976</fpage>–<lpage>979</lpage>. <pub-id pub-id-type="doi">10.1126/science.1244730</pub-id>
<pub-id pub-id-type="pmid">24264991</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kosikova</surname><given-names>M.</given-names></name><name><surname>Li</surname><given-names>L.</given-names></name><name><surname>Radvak</surname><given-names>P.</given-names></name><name><surname>Ye</surname><given-names>Z.</given-names></name><name><surname>Wan</surname><given-names>X.-F.</given-names></name><name><surname>Xie</surname><given-names>H.</given-names></name></person-group> (<year>2018</year>). <article-title>Imprinting of Repeated Influenza A/H3 Exposures on Antibody Quantity and Antibody Quality: Implications for Seasonal Vaccine Strain Selection and Vaccine Performance</article-title>. <source>Clin. Infect. Dis.</source>
<volume>67</volume>, <fpage>1523</fpage>–<lpage>1532</lpage>. <pub-id pub-id-type="doi">10.1093/cid/ciy327</pub-id>
<pub-id pub-id-type="pmid">29672713</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lackenby</surname><given-names>A.</given-names></name><name><surname>Besselaar</surname><given-names>T. G.</given-names></name><name><surname>Daniels</surname><given-names>R. S.</given-names></name><name><surname>Fry</surname><given-names>A.</given-names></name><name><surname>Gregory</surname><given-names>V.</given-names></name><name><surname>Gubareva</surname><given-names>L. V.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>Global Update on the Susceptibility of Human Influenza Viruses to Neuraminidase Inhibitors and Status of Novel Antivirals, 2016-2017</article-title>. <source>Antivir. Res.</source>
<volume>157</volume>, <fpage>38</fpage>–<lpage>46</lpage>. <pub-id pub-id-type="doi">10.1016/j.antiviral.2018.07.001</pub-id>
<pub-id pub-id-type="pmid">29981793</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>L.</given-names></name><name><surname>Chang</surname><given-names>D.</given-names></name><name><surname>Han</surname><given-names>L.</given-names></name><name><surname>Zhang</surname><given-names>X.</given-names></name><name><surname>Zaia</surname><given-names>J.</given-names></name><name><surname>Wan</surname><given-names>X. F.</given-names></name></person-group> (<year>2020</year>). <article-title>Multi-task Learning Sparse Group Lasso: a Method for Quantifying Antigenicity of Influenza A(H1N1) Virus Using Mutations and Variations in Glycosylation of Hemagglutinin</article-title>. <source>BMC Bioinforma.</source>
<volume>21</volume>, <fpage>182</fpage>. <pub-id pub-id-type="doi">10.1186/s12859-020-3527-5</pub-id>
</mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>L.</given-names></name><name><surname>Dugan</surname><given-names>H. L.</given-names></name><name><surname>Stamper</surname><given-names>C. T.</given-names></name><name><surname>Lan</surname><given-names>L. Y.-L.</given-names></name><name><surname>Asby</surname><given-names>N. W.</given-names></name><name><surname>Knight</surname><given-names>M.</given-names></name><etal/></person-group> (<year>2021</year>). <article-title>Improved Integration of Single-Cell Transcriptome and Surface Protein Expression by LinQ-View</article-title>. <source>Cell. Rep. Methods</source>
<volume>1</volume>, <fpage>100056</fpage>. <pub-id pub-id-type="doi">10.1016/j.crmeth.2021.100056</pub-id>
<pub-id pub-id-type="pmid">35475142</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lumley</surname><given-names>T.</given-names></name><name><surname>Lumley</surname><given-names>M. T.</given-names></name></person-group> (<year>2019</year>). <article-title>Package ‘survey’</article-title>. </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McCarty</surname><given-names>C.</given-names></name><name><surname>Bernard</surname><given-names>H. R.</given-names></name><name><surname>Killworth</surname><given-names>P. D.</given-names></name><name><surname>Shelley</surname><given-names>G. A.</given-names></name><name><surname>Johnsen</surname><given-names>E. C.</given-names></name></person-group> (<year>1997</year>). <article-title>Eliciting Representative Samples of Personal Networks</article-title>. <source>Soc. Netw.</source>
<volume>19</volume>, <fpage>303</fpage>–<lpage>323</lpage>. <pub-id pub-id-type="doi">10.1016/s0378-8733(96)00302-4</pub-id>
</mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McInnes</surname><given-names>L.</given-names></name><name><surname>Healy</surname><given-names>J.</given-names></name><name><surname>Melville</surname><given-names>J.</given-names></name></person-group> (<year>2018</year>). <article-title>Umap: Uniform Manifold Approximation and Projection for Dimension Reduction</article-title>. <comment><italic>arXiv preprint arXiv:1802.03426</italic></comment>. </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peterson</surname><given-names>V. M.</given-names></name><name><surname>Zhang</surname><given-names>K. X.</given-names></name><name><surname>Kumar</surname><given-names>N.</given-names></name><name><surname>Wong</surname><given-names>J.</given-names></name><name><surname>Li</surname><given-names>L.</given-names></name><name><surname>Wilson</surname><given-names>D. C.</given-names></name><etal/></person-group> (<year>2017</year>). <article-title>Multiplexed Quantification of Proteins and Transcripts in Single Cells</article-title>. <source>Nat. Biotechnol.</source>
<volume>35</volume>, <fpage>936</fpage>–<lpage>939</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.3973</pub-id>
<pub-id pub-id-type="pmid">28854175</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schubert</surname><given-names>E.</given-names></name><name><surname>Rousseeuw</surname><given-names>P. J.</given-names></name></person-group> (<year>2018</year>). <article-title>Faster K-Medoids Clustering: Improving the PAM, CLARA, and CLARANS Algorithms</article-title>. <comment><italic>arXiv preprint arXiv:1810.05691</italic></comment>. </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shu</surname><given-names>Y.</given-names></name><name><surname>McCauley</surname><given-names>J.</given-names></name></person-group> (<year>2017</year>). <article-title>GISAID: Global Initiative on Sharing All Influenza Data - from Vision to Reality</article-title>. <source>Eurosurveillance</source>
<volume>22</volume>, <fpage>30494</fpage>. <pub-id pub-id-type="doi">10.2807/1560-7917.es.2017.22.13.30494</pub-id>
<pub-id pub-id-type="pmid">28382917</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Siddiqui</surname><given-names>S.</given-names></name><name><surname>Okasha</surname><given-names>T. M.</given-names></name><name><surname>Funk</surname><given-names>J. J.</given-names></name><name><surname>Al-Harbi</surname><given-names>A. M.</given-names></name></person-group> (<year>2006</year>). <article-title>Improvements in the Selection Criteria for the Representative Special Core Analysis Samples</article-title>. <source>SPE Reserv. Eval. Eng.</source>
<volume>9</volume>, <fpage>647</fpage>–<lpage>653</lpage>. <pub-id pub-id-type="doi">10.2118/84302-pa</pub-id>
</mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Singh</surname><given-names>D.</given-names></name><name><surname>Singh</surname><given-names>B.</given-names></name></person-group> (<year>2020</year>). <article-title>Investigating the Impact of Data Normalization on Classification Performance</article-title>. <source>Appl. Soft Comput.</source>
<volume>97</volume>, <fpage>105524</fpage>. <pub-id pub-id-type="doi">10.1016/j.asoc.2019.105524</pub-id>
</mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Stuart</surname><given-names>T.</given-names></name><name><surname>Satija</surname><given-names>R.</given-names></name></person-group> (<year>2019</year>). <article-title>Integrative Single-Cell Analysis</article-title>. <source>Nat. Rev. Genet.</source>
<volume>20</volume>, <fpage>257</fpage>–<lpage>272</lpage>. <pub-id pub-id-type="doi">10.1038/s41576-019-0093-7</pub-id>
<pub-id pub-id-type="pmid">30696980</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>H.</given-names></name><name><surname>Yang</surname><given-names>J.</given-names></name><name><surname>Zhang</surname><given-names>T.</given-names></name><name><surname>Long</surname><given-names>L. P.</given-names></name><name><surname>Jia</surname><given-names>K.</given-names></name><name><surname>Yang</surname><given-names>G.</given-names></name><etal/></person-group> (<year>2013</year>). <article-title>Using Sequence Data to Infer the Antigenicity of Influenza Virus</article-title>. <source>MBio</source>
<volume>4</volume>, <fpage>e00230</fpage>–<lpage>13</lpage>. <pub-id pub-id-type="doi">10.1128/mBio.00230-13</pub-id>
<pub-id pub-id-type="pmid">23820391</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Svensson</surname><given-names>V.</given-names></name><name><surname>Vento-Tormo</surname><given-names>R.</given-names></name><name><surname>Teichmann</surname><given-names>S. A.</given-names></name></person-group> (<year>2018</year>). <article-title>Exponential Scaling of Single-Cell RNA-Seq in the Past Decade</article-title>. <source>Nat. Protoc.</source>
<volume>13</volume>, <fpage>599</fpage>–<lpage>604</lpage>. <pub-id pub-id-type="doi">10.1038/nprot.2017.149</pub-id>
<pub-id pub-id-type="pmid">29494575</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>F.</given-names></name><name><surname>Barbacioru</surname><given-names>C.</given-names></name><name><surname>Wang</surname><given-names>Y.</given-names></name><name><surname>Nordman</surname><given-names>E.</given-names></name><name><surname>Lee</surname><given-names>C.</given-names></name><name><surname>Xu</surname><given-names>N.</given-names></name><etal/></person-group> (<year>2009</year>). <article-title>mRNA-Seq Whole-Transcriptome Analysis of a Single Cell</article-title>. <source>Nat. Methods</source>
<volume>6</volume>, <fpage>377</fpage>–<lpage>382</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1315</pub-id>
<pub-id pub-id-type="pmid">19349980</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tillé</surname><given-names>Y.</given-names></name><name><surname>Matei</surname><given-names>A.</given-names></name><name><surname>Matei</surname><given-names>M. A.</given-names></name><name><surname>Imports</surname><given-names>M. A. S. S.</given-names></name></person-group> (<year>2016</year>). <article-title>Package ‘sampling’. Survey Sampling</article-title>. <source>Kasutatud</source>
<volume>23</volume>, <fpage>2017</fpage>. </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tillé</surname><given-names>Y.</given-names></name><name><surname>Matei</surname><given-names>A.</given-names></name></person-group> (<year>2006</year>). <article-title>The R Package Sampling, a Software Tool for Training in Official Statistics and Survey Sampling</article-title>, <fpage>1473</fpage>–<lpage>1482</lpage>. </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tominaga</surname><given-names>Y.</given-names></name></person-group> (<year>1998</year>). <article-title>Representative Subset Selection Using Genetic Algorithms</article-title>. <source>Chemom. Intelligent Laboratory Syst.</source>
<volume>43</volume>, <fpage>157</fpage>–<lpage>163</lpage>. <pub-id pub-id-type="doi">10.1016/s0169-7439(98)00085-9</pub-id>
</mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van der Maaten</surname><given-names>L.</given-names></name><name><surname>Hinton</surname><given-names>G.</given-names></name></person-group> (<year>2012</year>). <article-title>Visualizing Non-metric Similarities in Multiple Maps</article-title>. <source>Mach. Learn.</source>
<volume>87</volume>, <fpage>33</fpage>–<lpage>55</lpage>. </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Walvoort</surname><given-names>D. J. J.</given-names></name><name><surname>Brus</surname><given-names>D. J.</given-names></name><name><surname>de Gruijter</surname><given-names>J. J.</given-names></name></person-group> (<year>2010</year>). <article-title>An R Package for Spatial Coverage Sampling and Random Sampling from Compact Geographical Strata by K-Means</article-title>. <source>Comput. Geosciences</source>
<volume>36</volume>, <fpage>1261</fpage>–<lpage>1267</lpage>. <pub-id pub-id-type="doi">10.1016/j.cageo.2010.04.005</pub-id>
</mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Winkels</surname><given-names>H.</given-names></name><name><surname>Ehinger</surname><given-names>E.</given-names></name><name><surname>Vassallo</surname><given-names>M.</given-names></name><name><surname>Buscher</surname><given-names>K.</given-names></name><name><surname>Dinh</surname><given-names>H. Q.</given-names></name><name><surname>Kobiyama</surname><given-names>K.</given-names></name><etal/></person-group> (<year>2018</year>). <article-title>Atlas of the Immune Cell Repertoire in Mouse Atherosclerosis Defined by Single-Cell RNA-Sequencing and Mass Cytometry</article-title>. <source>Circ. Res.</source>
<volume>122</volume>, <fpage>1675</fpage>–<lpage>1688</lpage>. <pub-id pub-id-type="doi">10.1161/circresaha.117.312513</pub-id>
<pub-id pub-id-type="pmid">29545366</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>L.</given-names></name><name><surname>Dong</surname><given-names>X.</given-names></name><name><surname>Lee</surname><given-names>M.</given-names></name><name><surname>Maslov</surname><given-names>A. Y.</given-names></name><name><surname>Wang</surname><given-names>T.</given-names></name><name><surname>Vijg</surname><given-names>J.</given-names></name></person-group> (<year>2019</year>). <article-title>Single-cell Whole-Genome Sequencing Reveals the Functional Landscape of Somatic Mutations in B Lymphocytes across the Human Lifespan</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source>
<volume>116</volume>, <fpage>9014</fpage>–<lpage>9019</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1902510116</pub-id>
<pub-id pub-id-type="pmid">30992375</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
