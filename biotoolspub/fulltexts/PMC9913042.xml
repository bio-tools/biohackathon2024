<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9913042</article-id>
    <article-id pub-id-type="pmid">36702456</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad058</article-id>
    <article-id pub-id-type="publisher-id">btad058</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MS1Connect: a mass spectrometry run similarity measure</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Andy</given-names>
        </name>
        <aff><institution>Chemical and Biological Signatures, Pacific Northwest National Laboratory</institution>, Richland, WA 99354, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Deatherage Kaiser</surname>
          <given-names>Brooke L</given-names>
        </name>
        <aff><institution>Chemical and Biological Signatures, Pacific Northwest National Laboratory</institution>, Richland, WA 99354, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hutchison</surname>
          <given-names>Janine R</given-names>
        </name>
        <aff><institution>Chemical and Biological Signatures, Pacific Northwest National Laboratory</institution>, Richland, WA 99354, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bilmes</surname>
          <given-names>Jeffrey A</given-names>
        </name>
        <aff><institution>Department of Electrical and Computer Engineering, University of Washington</institution>, Seattle, WA 98195, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7283-4715</contrib-id>
        <name>
          <surname>Noble</surname>
          <given-names>William Stafford</given-names>
        </name>
        <aff><institution>Department of Genome Sciences, University of Washington</institution>, Seattle, WA 98195, <country country="US">USA</country></aff>
        <aff><institution>Paul G. Allen School of Computer Science and Engineering, University of Washington</institution>, Seattle, WA 98195, <country country="US">USA</country></aff>
        <xref rid="btad058-cor1" ref-type="corresp"/>
        <!--william-noble@uw.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad058-cor1">To whom correspondence should be addressed. <email>william-noble@uw.edu</email>.</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-01-25">
      <day>25</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>2</issue>
    <elocation-id>btad058</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>05</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>20</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>10</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad058.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Interpretation of newly acquired mass spectrometry data can be improved by identifying, from an online repository, previous mass spectrometry runs that resemble the new data. However, this retrieval task requires computing the similarity between an arbitrary pair of mass spectrometry runs. This is particularly challenging for runs acquired using different experimental protocols.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We propose a method, MS1Connect, that calculates the similarity between a pair of runs by examining only the intact peptide (MS1) scans, and we show evidence that the MS1Connect score is accurate. Specifically, we show that MS1Connect outperforms several baseline methods on the task of predicting the species from which a given proteomics sample originated. In addition, we show that MS1Connect scores are highly correlated with similarities computed from fragment (MS2) scans, even though these data are not used by MS1Connect.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The MS1Connect software is available at <ext-link xlink:href="https://github.com/bmx8177/MS1Connect" ext-link-type="uri">https://github.com/bmx8177/MS1Connect</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01GM121818</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Laboratory Directed Research and Development Program at Pacific Northwest National Laboratory</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Battelle for the U.S. Department of Energy</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Linus Pauling Distinguished Postdoctoral Fellowship</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Pacific Northwest National Laboratory</institution>
            <institution-id institution-id-type="DOI">10.13039/100011661</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Battelle Memorial Institute for the United States Department of Energy</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DE-AC06-76RLO</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Over the years, a wealth of proteomics data has been deposited into online repositories such as PRIDE (<xref rid="btad058-B19" ref-type="bibr">Perez-Riverol <italic toggle="yes">et al.</italic>, 2019</xref>) and MassIVE (<xref rid="btad058-B5" ref-type="bibr">Choi <italic toggle="yes">et al.</italic>, 2020</xref>). Researchers may be interested in finding data in these online repositories that are similar to their own data in order to perform some joint analysis. However, it is difficult to identify which repository runs should be analyzed with your data. This is because it is hard to measure the similarity of a pair of runs, especially across different studies. Specifically, biologically irrelevant differences in sample preparation, liquid chromatography and instrument parameters all affect the resulting data.</p>
    <p>Currently, few methods exist for measuring the similarity of a pair of proteomics runs. One metric is to count the number of confidently detected peptides in common (<xref rid="btad058-B25" ref-type="bibr">Tabb <italic toggle="yes">et al.</italic>, 2010</xref>). Unfortunately, this method requires knowing the species composition of the samples, which is not always known, and requires a database search. Another previously developed method for measuring the similarity between a pair of mass spectrometry runs directly compares the set of peptide fragment spectra (MS2 scans) from each run. Conceptually this method works by calculating the spectra dot product for all pairs of spectra in two runs and then counting the fraction of scores above a threshold (<xref rid="btad058-B21" ref-type="bibr">Rieder <italic toggle="yes">et al.</italic>, 2017</xref>). This approach has been successfully used for species identification (<xref rid="btad058-B3" ref-type="bibr">Belghit <italic toggle="yes">et al.</italic>, 2019</xref>), molecular phylogenetics (<xref rid="btad058-B17" ref-type="bibr">Palmblad and Deelder, 2012</xref>) and differentiating between experimental protocols (<xref rid="btad058-B27" ref-type="bibr">van der Plas-Duivesteijn <italic toggle="yes">et al.</italic>, 2016</xref>).</p>
    <p>Unfortunately, these MS2-based methods do not account for differences in how MS2 scans are collected. MS2 spectra collected by data-independent acquisition (DIA), data-dependent acquisition (DDA) and targeted analyses are all different from each other. Therefore, new methods are needed that can measure the similarity between a pair of proteomics runs regardless of how the data were acquired.</p>
    <p>In this work, we describe a new method, MS1Connect, that only uses intact peptide scans (MS1 scans) to calculate the similarity between a pair of runs. Since MS1 scans are always collected in the same way, these data can be used to compare targeted, DDA and DIA data. To our knowledge, MS1 data have not been used to measure the overall similarity between a pair of proteomics runs. However, several methods have been developed to align MS1 features maps of a pair of proteomics runs (<xref rid="btad058-B7" ref-type="bibr">Cox and Mann, 2008</xref>; <xref rid="btad058-B23" ref-type="bibr">Röst <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btad058-B28" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2019</xref>), but these methods do not report an overall similarity score.</p>
    <p>Our method, MS1Connect, frames scoring the similarity between a pair of proteomics runs as a maximum bipartite matching problem. A bipartite graph consists of two disjoint sets of vertices and a set of edges that connect the two sets of vertices. In a maximum bipartite matching problem, the goal is to select a subset of edges in a bipartite graph that maximizes some objective value subject to some constraint. In our setting, each of the two disjoint sets of vertices represents the set of MS1 features found in a run, and edges link MS1 features, in different runs, whose masses match within some tolerance. In addition, we require that every MS1 feature be associated with at most one edge in the set of selected edges.</p>
    <p>The MS1Connect objective function consists of a weighted combination of three modular terms and a fourth supermodular term. Modular and supermodular functions are both types of set functions. In a modular function, the sum is equal to the sum of its parts. More specifically, given two sets of disjoint items <italic toggle="yes">X</italic> and <italic toggle="yes">Y</italic> and a scoring function <italic toggle="yes">f</italic>, <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>∪</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. On the other hand, for a supermodular function, the sum is greater than the sum of its parts. In this case, <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo>∪</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. While there exists a robust set of literature dedicated to the theory of supermodular maximization (<xref rid="btad058-B1" ref-type="bibr">Bai and Bilmes, 2018</xref>; <xref rid="btad058-B9" ref-type="bibr">Feige, 1998</xref>; <xref rid="btad058-B10" ref-type="bibr">Ji <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btad058-B13" ref-type="bibr">Lin and Bilmes, 2011</xref>), these functions have rarely been applied to the analysis of biological data. The one example we are aware of uses a surrogate function to estimate the supermodular relationship between fragment ions in database searching (<xref rid="btad058-B2" ref-type="bibr">Bai <italic toggle="yes">et al.</italic>, 2016</xref>).</p>
    <p>Each of the MS1Connect terms measures a different aspect of proteomics run similarity. The first modular term (<inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) favors solutions with a large number of edges. The second modular term (<inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) favors selection of edges with high-intensity values. The third modular term (<inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) favors edges with small normalized retention time shifts. We define the normalized retention time shift as the difference in normalized retention times between the two MS1 features in an edge. Finally, the fourth supermodular term (<inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) favors solutions with pairs of edges that are similar to each other. Two edges are similar if they have similar normalized retention time shifts and if the normalized retention times of the MS1 features, in the same run, are similar to each other.</p>
    <p>We show evidence that the MS1Connect score accurately measures the similarity between two proteomics runs. There are many ways to define whether two runs are similar to each other. For this work, we focus on the task of species prediction. We show that MS1Connect scores outperform baselines for predicting the species a sample originated from. In addition, we show that MS1Connect scores are able to recapitulate similarities based on MS2 spectra. Specifically, we show a high correlation between MS1Connect scores and the Jaccard index between the sets of confidently detected peptides for a pair of runs.</p>
  </sec>
  <sec>
    <title>2 Approach</title>
    <sec>
      <title>2.1 Representation of a mass spectrometry run</title>
      <p>We represented each tandem mass spectrometry run as a bag of MS1 features, where each feature nominally corresponds to a peptide detected in a set of precursor scans. However, we note that not every MS1 feature will be a peptide and could instead be a chemical contaminant or other analyte. Each MS1 feature is represented as a tuple of four values: <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula>, intensity, charge and retention time (in seconds). All four of these values are reported by pyOpenMS (<xref rid="btad058-B22" ref-type="bibr">Röst <italic toggle="yes">et al.</italic>, 2014</xref>), the tool we use for MS1 feature detection. To generate the input files for pyOpenMS, we used Proteowizard version 3.0 (<xref rid="btad058-B4" ref-type="bibr">Chambers <italic toggle="yes">et al.</italic>, 2012</xref>) to convert Thermo RAW files to .mzML format (<xref rid="btad058-B14" ref-type="bibr">Martens <italic toggle="yes">et al.</italic>, 2011</xref>). We use the <italic toggle="yes">N</italic> most intense MS1 features to represent each run, where <italic toggle="yes">N</italic> is a hyperparameter. In <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1.1</xref>, we discuss how we normalized the values returned by pyOpenMS.</p>
    </sec>
    <sec>
      <title>2.2 Mass spectrometry run matching as a maximum bipartite matching problem</title>
      <p>We frame the measurement of the similarity between a pair of mass spectrometry runs as a maximum bipartite matching problem. In this approach, we aim to select a set of edges in a given bipartite graph that achieves a maximum objective value.</p>
      <p>A generic bipartite graph <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> consists of two disjoint sets of vertices, <italic toggle="yes">U</italic> and <italic toggle="yes">V</italic>, and a set of edges <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi><mml:mo>⊆</mml:mo><mml:mi>U</mml:mi><mml:mo>×</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula>, where each edge <italic toggle="yes">e</italic> connects a vertex <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mi>U</mml:mi></mml:mrow></mml:math></inline-formula> to a vertex <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></inline-formula>. For our specific formulation, <italic toggle="yes">U</italic> and <italic toggle="yes">V</italic> are the sets of MS1 features from two different mass spectrometry runs, <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, and the edges <italic toggle="yes">E</italic> link MS1 features between <italic toggle="yes">U</italic> and <italic toggle="yes">V</italic> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). For this reason, we have one bipartite graph <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> associated with every run pair <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>⊆</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. For notational simplicity, we drop the <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> subscripts except when they are needed for run-pair disambiguation.</p>
      <p>We include in the graph edges between all pairs of MS1 features whose charges match and whose <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> values match within some tolerance <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (in units of ppm):
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>6</mml:mn></mml:msup></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>∧</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>⊆</mml:mo><mml:mi>U</mml:mi><mml:mo>×</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> of <italic toggle="yes">u</italic>, <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> of <italic toggle="yes">v</italic>, <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the charge of MS1 feature <italic toggle="yes">v</italic>, and <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the charge of <italic toggle="yes">u</italic>. By connecting MS1 features with the same charge and similar <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:math></inline-formula>, these edges attempt to connect the same peptide precursor.</p>
      <p>The goal in maximum bipartite matching is to select a set of edges <italic toggle="yes">A</italic> that achieves a maximum score, as measured by a specified objective function <italic toggle="yes">S</italic>, subject to some matching constraints. Specifically, because we expect that each peptide precursor will be detected at most once per run, we require that a valid matching connects each feature in <italic toggle="yes">U</italic> to at most one feature in <italic toggle="yes">V</italic> and vice versa. More formally, for two runs <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, we want to choose a subset of edges <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi><mml:mo>⊆</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:math></inline-formula> that achieves a maximum value of the objective defined below subject to the following constraints: <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mo>∀</mml:mo><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mtext>degree</mml:mtext><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mtext>and degree </mml:mtext><mml:mo>(</mml:mo><mml:mi>v</mml:mi><mml:mo>(</mml:mo><mml:mi>e</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:math></inline-formula> where <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> retrieves the relevant MS1 feature from <italic toggle="yes">U</italic> and <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> retrieves the corresponding MS1 feature in <italic toggle="yes">V</italic>. To designate these constraints, we define <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">E</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>⊆</mml:mo><mml:mi>E</mml:mi><mml:mo>:</mml:mo><mml:mo>∀</mml:mo><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>∩</mml:mo><mml:mtext>IncidentEdges</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> which is the set of all subsets of edges that satisfy by the required degree constraint of the corresponding nodes on the <italic toggle="yes">U</italic> side, and we correspondingly define <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">E</mml:mi></mml:mrow><mml:mi>V</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>⊆</mml:mo><mml:mi>E</mml:mi><mml:mo>:</mml:mo><mml:mo>∀</mml:mo><mml:mi>e</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>∩</mml:mo><mml:mtext>IncidentEdges</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> for the <italic toggle="yes">V</italic> side. Note that <italic toggle="yes">A</italic> represents any possible subset of <italic toggle="yes">E</italic>, whereas <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">E</mml:mi></mml:mrow><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represents any possible subset of <italic toggle="yes">E</italic> that fulfills the degree constraint on the <italic toggle="yes">V</italic> side. Also, <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mtext>IncidentEdges</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> gives the set of edges that are incident to the vertex <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.3 Scoring a candidate matching</title>
      <p>Our handcrafted score function <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> uses a maximum matching approach which maximizes an objective that consists of a weighted combination of four terms. The score for two runs <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is defined as follows:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>×</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>⊆</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mi>A</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> through <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are terms that are defined in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1.3</xref>, <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> through <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are convex mixture hyperparameters that weight the relative importance of each term, and <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the set of valid edges between runs <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. Each term in the inner maximization is normalized by the score for the full set <italic toggle="yes">E</italic> with no matching constraints. The inner maximization maximizes over all subsets of edges that satisfy by both degree constraints, and that is indicated via <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> since if <italic toggle="yes">A</italic> is a member of both <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">E</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, then no node incident to any edge has more than degree one in the matching. The leading summation serves to un-normalize the objective value via a multiplicative <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>-dependent constant. This two-step normalization and un-normalization process is used to make the <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mo>λ</mml:mo></mml:math></inline-formula> hyperparameters interpretable (i.e. each <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> indicates the relative contribution of each term) and also to ensure that the scores are calibrated over multiple distinct pairs of runs. As a result of the normalization process, the four <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mo>λ</mml:mo></mml:math></inline-formula> values must sum to 1 and range between 0 and 1, inclusive. We describe the <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> terms, each of which measures a different aspect of proteomics run similarity in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1.3</xref> (<xref rid="btad058-F1" ref-type="fig">Fig. 1</xref>).</p>
      <fig position="float" id="btad058-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Schematic of four MS1Connect terms. This figure illustrates what each term of the MS1Connect objective function focuses on when scoring a matching. Each subplot shows bipartite graph formed by a pair of mass spectrometry runs. The red and gray lines are edges that link MS1 features with similar <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula>. Note that the <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> axis is not shown. In addition, note that, in a specific matching, each MS1 feature is associated with at most one edge. (<bold>A</bold>) The <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> term favors solutions that contain a large number of edges. (<bold>B</bold>) The <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> term favors solutions that select edges with high-intensity values. Note that values above and below the MS1 features are intensity values. (<bold>C</bold>) The <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> term favors edges that have small normalized retention time shifts. Note that the values above and below the MS1 features are normalized retention time values. Also, note that we assume, for the purposes of this schematic, that <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:mo>α</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. (<bold>D</bold>) The <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> term favors solutions that contain many similar pairs of edges. The best solution chooses the three red edges in the middle instead of the gray edge because these three edges are similar to each other. This similarity indicates that the large retention time difference is correct and due to systematic differences in chromatography conditions</p>
        </caption>
        <graphic xlink:href="btad058f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.4 Selecting the best matching</title>
      <p>In order to choose the best matching, we must choose a feasible subset of edges that maximizes our objective function, that is, we must compute
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>⊆</mml:mo><mml:mi>E</mml:mi><mml:mo>:</mml:mo><mml:mi>A</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">E</mml:mi></mml:mrow><mml:mi>U</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script" class="calligraphy">E</mml:mi></mml:mrow><mml:mi>V</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. The first thing to note is that <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the summation over entries of a <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>U</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:mo>|</mml:mo><mml:mo>×</mml:mo><mml:mo>|</mml:mo><mml:mi>U</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>V</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> matrix. That is, <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:msub><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and where <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the element of the corresponding sub-objective <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> defined above (i.e. <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>). Note that for <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, we have that <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> whenever <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. We also note that <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> whenever <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. Hence, we can define <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as follows:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p>
      <p>Ordinarily, computing such a maximization over an exponential number of subsets would be intractable. It turns out, however, that this maximization problem exhibits useful structure that allows an efficient algorithm to be used to obtain an approximate solution. Specifically, we use the greedy algorithm to solve an instance of supermodular maximization subject to matroid constraints. In <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1.2</xref>, we discuss our approach to select the best matching as well as the approximation bound of the solution provided by the greedy algorithm (<xref rid="btad058-B1" ref-type="bibr">Bai and Bilmes, 2018</xref>; <xref rid="btad058-B8" ref-type="bibr">Edmonds, 1970</xref>; <xref rid="btad058-B9" ref-type="bibr">Feige, 1998</xref>; <xref rid="btad058-B13" ref-type="bibr">Lin and Bilmes, 2011</xref>; <xref rid="btad058-B16" ref-type="bibr">Oxley, 2011</xref>).</p>
      <p>Lastly, we note again that the above is described for a generic bipartite graph <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In practice, we have one distinct bipartite graph for each pair <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> of runs; hence, the greedy algorithm is run for each run pair.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Materials and methods</title>
    <p>Detailed descriptions of the representation of a mass spectrometry run, selection of the best bipartite matching (<xref rid="btad058-B1" ref-type="bibr">Bai and Bilmes, 2018</xref>; <xref rid="btad058-B8" ref-type="bibr">Edmonds, 1970</xref>; <xref rid="btad058-B9" ref-type="bibr">Feige, 1998</xref>; <xref rid="btad058-B13" ref-type="bibr">Lin and Bilmes, 2011</xref>; <xref rid="btad058-B16" ref-type="bibr">Oxley, 2011</xref>), baseline similarity scores, database searching (<xref rid="btad058-B12" ref-type="bibr">Lin <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btad058-B15" ref-type="bibr">McIlwain <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btad058-B18" ref-type="bibr">Park <italic toggle="yes">et al.</italic>, 2008</xref>; <xref rid="btad058-B26" ref-type="bibr">The UniProt Consortium, 2019</xref>), hyperparameter searching and sample generation (<xref rid="btad058-B6" ref-type="bibr">Cole <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btad058-B11" ref-type="bibr">Kelly <italic toggle="yes">et al.</italic>, 2006</xref>) can be found in the Supplementary material. In addition, the Supplementary material contains a table of notation used in this manuscript (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). Finally, information regarding datasets used in this study can be found in the Supplementary material as well as <xref rid="sup1" ref-type="supplementary-material">Supplementary Files S1–S4</xref>.</p>
    <sec>
      <title>3.1 MS1Connect versions</title>
      <p>Since the objective function of MS1Connect contains four terms, we compared five different versions of MS1Connect against each other. Four of the versions used a single term of the objective function while the fifth version used all four terms of the objective function. We notate the version of MS1Connect that only uses the <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> term as ‘MS1Connect (<inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> only)’, and we notate the version of MS1Connect that uses all four terms as ‘MS1Connect (<inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> – <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>)’.</p>
    </sec>
    <sec>
      <title>3.2 Evaluation metrics</title>
      <p>We use two different measures to quantify the performance of a given MS1 similarity score at predicting the metadata label of a query run given a repository of runs with known metadata labels.</p>
      <p>The first performance measure is the per-query average precision (QAP), defined as the average precision across all queries <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math></inline-formula>:
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>QAP</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>C</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>∖</mml:mo><mml:mo>{</mml:mo><mml:mi>q</mml:mi><mml:mo>}</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>∖</mml:mo><mml:mo>{</mml:mo><mml:mi>q</mml:mi><mml:mo>}</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>∖</mml:mo><mml:mo>{</mml:mo><mml:mi>q</mml:mi><mml:mo>}</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are the precision and recall, respectively, after <italic toggle="yes">k</italic> repository runs have been retrieved from <italic toggle="yes">R</italic> using query <italic toggle="yes">q</italic> and similarity <italic toggle="yes">S</italic>. Note that the query run <italic toggle="yes">q</italic> is not included in the ranking when computing the precision and recall.</p>
      <p>The second measure, aggregate average precision (AAP), is similar to QAP except that the average precision is calculated once on an aggregated list of similarity scores. This aggregated list is produced by sorting together all pairs of runs, considering only the upper triangle of the run-by-run matrix. In this work, we focused on the QAP because these two performance metrics are highly correlated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Results</title>
    <sec>
      <title>4.1 MS1Connect scores can be used for species prediction</title>
      <p>To determine whether the MS1Connect score successfully measures the similarity of a pair of runs, we investigated whether these scores can be used to predict the species label of a proteomics run. Given a set of runs, we designated a single run as the query run and the remaining runs as the repository. The repository runs were then ordered by their similarity to the query run. Then, the average precision was calculated based on whether the repository runs had the same species label as the query run. We repeated this process for each of the runs in the dataset to calculate our two metrics, QAP and AAP. MS1Connect has nine different hyperparameters (<xref rid="btad058-T1" ref-type="table">Table 1</xref>), and to determine which set of hyperparameters achieved the best performance on the training set, as measured by QAP, we sampled the hyperparameter space using a random grid search.</p>
      <table-wrap position="float" id="btad058-T1">
        <label>Table 1.</label>
        <caption>
          <p>QAP and AAP</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1"/>
              <th colspan="2" rowspan="1">Species training set<hr/></th>
              <th colspan="2" rowspan="1">Species test set<hr/></th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">Method</th>
              <th rowspan="1" colspan="1">QAP</th>
              <th rowspan="1" colspan="1">AAP</th>
              <th rowspan="1" colspan="1">QAP</th>
              <th rowspan="1" colspan="1">AAP</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">MS1Connect (<inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> − <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>)</td>
              <td rowspan="1" colspan="1">
                <bold>0.8115</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.7301</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.8483</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.7983</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MS1Connect (<inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> only)</td>
              <td rowspan="1" colspan="1">0.7873</td>
              <td rowspan="1" colspan="1">0.6992</td>
              <td rowspan="1" colspan="1">0.8112</td>
              <td rowspan="1" colspan="1">0.7672</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MS1Connect (<inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> only)</td>
              <td rowspan="1" colspan="1">0.7096</td>
              <td rowspan="1" colspan="1">0.5801</td>
              <td rowspan="1" colspan="1">0.6686</td>
              <td rowspan="1" colspan="1">0.5806</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MS1Connect (<inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> only)</td>
              <td rowspan="1" colspan="1">0.7891</td>
              <td rowspan="1" colspan="1">0.7000</td>
              <td rowspan="1" colspan="1">0.8130</td>
              <td rowspan="1" colspan="1">0.7675</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MS1Connect (<inline-formula id="IE90"><mml:math id="IM90" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> only)</td>
              <td rowspan="1" colspan="1">
                <bold>0.8076</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.7322</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.8497</bold>
              </td>
              <td rowspan="1" colspan="1">
                <bold>0.7993</bold>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">No. of <inline-formula id="IE91"><mml:math id="IM91" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> bins in common (indicator)</td>
              <td rowspan="1" colspan="1">0.7847</td>
              <td rowspan="1" colspan="1">0.6978</td>
              <td rowspan="1" colspan="1">0.8211</td>
              <td rowspan="1" colspan="1">0.7855</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">No. of <inline-formula id="IE92"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> + RT bins in common (indicator)</td>
              <td rowspan="1" colspan="1">0.7677</td>
              <td rowspan="1" colspan="1">0.6856</td>
              <td rowspan="1" colspan="1">0.8083</td>
              <td rowspan="1" colspan="1">0.7509</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">No. of <inline-formula id="IE93"><mml:math id="IM93" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> bins in common (product)</td>
              <td rowspan="1" colspan="1">0.7771</td>
              <td rowspan="1" colspan="1">0.7062</td>
              <td rowspan="1" colspan="1">0.7951</td>
              <td rowspan="1" colspan="1">0.7529</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">No. of <inline-formula id="IE94"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> + RT bins in common (product)</td>
              <td rowspan="1" colspan="1">0.7591</td>
              <td rowspan="1" colspan="1">0.6838</td>
              <td rowspan="1" colspan="1">0.8107</td>
              <td rowspan="1" colspan="1">0.7532</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">No. of <inline-formula id="IE95"><mml:math id="IM95" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> bins in common (min)</td>
              <td rowspan="1" colspan="1">0.7831</td>
              <td rowspan="1" colspan="1">0.6979</td>
              <td rowspan="1" colspan="1">0.8225</td>
              <td rowspan="1" colspan="1">0.7868</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">No. of <inline-formula id="IE96"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> + RT bins in common (min)</td>
              <td rowspan="1" colspan="1">0.7665</td>
              <td rowspan="1" colspan="1">0.6857</td>
              <td rowspan="1" colspan="1">0.8092</td>
              <td rowspan="1" colspan="1">0.7514</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Continuous baseline (<inline-formula id="IE97"><mml:math id="IM97" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> only)</td>
              <td rowspan="1" colspan="1">0.7781</td>
              <td rowspan="1" colspan="1">0.6912</td>
              <td rowspan="1" colspan="1">0.8132</td>
              <td rowspan="1" colspan="1">0.7661</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Continuous baseline (<inline-formula id="IE98"><mml:math id="IM98" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> + RT)</td>
              <td rowspan="1" colspan="1">0.7725</td>
              <td rowspan="1" colspan="1">0.6844</td>
              <td rowspan="1" colspan="1">0.8092</td>
              <td rowspan="1" colspan="1">0.7573</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic toggle="yes">Note</italic>: A table of the per-query average precision (QAP) and the aggregate average precision (AAP) of the best performing hyperparameter set for each method in the species training and test datasets. Bold values denote the best and second best performance for each column. MS1Connect (<inline-formula id="IE99"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> – <inline-formula id="IE100"><mml:math id="IM100" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) and MS1Connect (<inline-formula id="IE101"><mml:math id="IM101" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> only) had the overall best performance. Note that the two supermodular methods outperformed all other methods.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>We found that MS1Connect scores can be successfully used for predicting what species a sample was generated from (<xref rid="btad058-T1" ref-type="table">Table 1</xref>). Comparing the various versions of MS1Connect against each other, we discovered that the two supermodular versions of MS1Connect, MS1Connect (<inline-formula id="IE102"><mml:math id="IM102" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> – <inline-formula id="IE103"><mml:math id="IM103" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) and MS1Connect (<inline-formula id="IE104"><mml:math id="IM104" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> only), had the best performance. Specifically, these two versions had the best or second best performance, as measured by QAP or AAP, in both the training and test data. These two versions are supermodular because they incorporate the supermodular <inline-formula id="IE105"><mml:math id="IM105" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> term. The higher performance of these two supermodular versions of MS1Connect, compared to the three modular versions of MS1Connect, suggests that using supermodularity may lead to higher performance. In <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S3.1</xref>, we discuss a possible reason why supermodular methods outperform modular methods.</p>
      <p>Next, we compared the performance of MS1Connect against our baseline similarity methods (<xref rid="btad058-T1" ref-type="table">Table 1</xref>). We found that the supermodular MS1Connect methods outperformed all of the baselines. In addition, we found the performance of MS1Connect (<inline-formula id="IE106"><mml:math id="IM106" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> only) and MS1Connect (<inline-formula id="IE107"><mml:math id="IM107" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> only) to be similar to the performance of the baselines while MS1Connect (<inline-formula id="IE108"><mml:math id="IM108" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> only) under-performed the baselines. Note that <xref rid="btad058-T1" ref-type="table">Table 1</xref> does not include the performance of the two baselines where <italic toggle="yes">G</italic> is the maximum of the two input values as these methods exhibited poor performance (<inline-formula id="IE109"><mml:math id="IM109" display="inline" overflow="scroll"><mml:mo>≤</mml:mo></mml:math></inline-formula>0.13 for both QAP and AAP in the training set).</p>
      <p>After we compared MS1Connect against the baselines, we compared the various baselines against each other. We found that performance generally decreased when retention time was considered (<xref rid="btad058-T1" ref-type="table">Table 1</xref>). This result may seem unexpected because retention times, in principle, should improve the specificity of a matching. However, binning retention times could lead to a significant number of edge effects because of systemic retention time shifts that reflect differences in chromatography conditions. As an example, the number of MS1 features in common between two <italic toggle="yes">Candida albicans</italic> runs, 1512006-2-TRIS1-10-Calbicans.raw and Control-60min_R3.raw, decreased by 30.8% when retention time is considered (<inline-formula id="IE110"><mml:math id="IM110" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>) compared to when retention time is not considered (<inline-formula id="IE111"><mml:math id="IM111" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>).</p>
      <p>Following the quantitative comparison, we examined the MS1Connect scores in the species training data to understand whether these scores made qualitative sense. We expected that runs generated by the same experiment should be highly similar to each other. Beyond that, we also expected runs from the same species to also be similar with each other.</p>
      <p>Using the hyperparameter set that yielded the best performance, as measured by QAP on the training data, we visualized the MS1Connect scores between all pairwise runs in the species training dataset as a heatmap (<xref rid="btad058-F2" ref-type="fig">Fig. 2</xref>). In this heatmap, the rows and columns are ordered by expected similarity. In general, the resulting heatmap matched our expectation. For example, the strong diagonal component in the heatmap resulted from runs that were generated by the same experiment. In addition, the block-diagonal structure (delimited in the figure by the solid white lines) showed that runs generated from the same species tend to have high scores. For example, all the runs generated by <italic toggle="yes">Staphylococcus aureus</italic> and <italic toggle="yes">C. albicans</italic> generally only have high scores with each other. On the other hand, we also found a few examples of runs whose similarity profile did not match our expectation. One prominent example is a set of five <italic toggle="yes">Escherichia coli</italic> runs from the same experiment that only had high MS1Connect scores when comparing the same run to itself. A second example is a set of five <italic toggle="yes">Arabidopsis thaliana</italic> runs from the same experiment where a run often did not have a high MS1Connect score to itself. This result occurred because these 10 runs have few MS1 features. In general, larger MS1Connect scores can be achieved when a run has a larger number of MS1 features. In this specific situation, these 10 runs have the fewest number of MS1 features in the overall dataset.</p>
      <fig position="float" id="btad058-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>MS1Connect for species prediction. A heatmap and dendrogram of MS1Connect scores showing the structure of our species training dataset. Each cell is colored by the MS1Connect score between a pair of runs. The solid white lines denote the border between different species while the dotted gray lines delineate the border between different experiments (PRIDE ID). The denodrogram shown is the phylogenetic tree of the nine species found in the training dataset</p>
        </caption>
        <graphic xlink:href="btad058f2" position="float"/>
      </fig>
      <p>In addition, we found that MS1Connect scores may be sensitive enough to detect inter-species relationships. Considering the human and mouse runs, the MS1Connect scores indicated that these two species have some degree of similarity. This finding fits with our phylogenetic understanding of these two species, as human and mice are both mammals. These two species are highly similar to each other in the context of our dataset, which also included bacteria, fungi and plants. Another example is that <italic toggle="yes">Bacillus anthracis</italic> and <italic toggle="yes">Bacillus cereus</italic> runs are similar to each other, which is expected since these two species are in the same genus. In the species test data, we saw comparable results with the two gram-negative bacterial species, <italic toggle="yes">E. coli</italic> and <italic toggle="yes">Salmonella enterica</italic>, being similar to each other (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>).</p>
      <p>A close inspection of the heatmap showed an unexpectedly high similarity between a group of <italic toggle="yes">S.aureus</italic> runs and all the <italic toggle="yes">Homo sapiens</italic> runs (<xref rid="btad058-F2" ref-type="fig">Fig. 2</xref>). The <italic toggle="yes">S. aureus</italic> runs originated from a study that used both cultures and clinical samples of <italic toggle="yes">S. aureus</italic>. We hypothesized that these runs originated from clinical samples and therefore contained a large number of human peptides. This type of contamination would cause these bacterial runs to be similar to human runs. We were unable to confirm this information from the PRIDE metadata, because the submission did not track which samples were cultured-based and which samples were clinically based. However, a database search of the <italic toggle="yes">S.aureus</italic> runs against a concatenated <italic toggle="yes">S. aureus</italic> and <italic toggle="yes">H.sapiens</italic> proteome detected a large number of human peptides, supporting our hypothesis.</p>
      <p><xref rid="btad058-F2" ref-type="fig">Figure 2</xref> also suggested that that the second set of human runs was unexpectedly dissimilar to all other human and mouse runs. We do not have access to metadata that might explain this phenomenon, but we speculate that the dissimilarity may arise because the second set of human runs originated from single cell data, whereas the remaining runs were derived from bulk samples. Note that these human runs are most similar to the previously discussed human contaminated <italic toggle="yes">S. aureus</italic> samples. The high similarity between these runs is expected since the MS1Connect score is symmetric.</p>
    </sec>
    <sec>
      <title>4.2 MS1Connect scores replicate database search results</title>
      <p>Our analyses so far suggest that MS1Connect scores can successfully measure the similarity between pairs of proteomics runs. Next, we compared whether our MS1-based similarity method replicates similarities generated from MS2 data. We expect that these two methods should generally agree with each other.</p>
      <p>To test this hypothesis, we compared the MS1Connect scores against the similarities generated by a MS2-based method on a set of samples with known species composition. For the MS2-based method, we calculated the Jaccard index between the sets of confidently detected peptides at a 1% FDR threshold for a pair of runs. The dataset we used contained a set of 16 samples, labeled ‘A’ through ‘P’, where each sample contained one, two or three different organisms (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S7</xref>). Each sample, except for the sample labeled ‘P’ was run on a mass spectrometer four times. Three of the runs were analyzed by a single instrument in one laboratory while the fourth run was analyzed on a different instrument in a second laboratory. The two laboratories are independent from each other, and therefore the samples were run with differing instrument parameters and chromatography conditions.</p>
      <p>Our results showed that MS1Connect scores indeed have a high correspondence to similarities measured from MS2 data. A heatmap where the upper triangle is MS1Connect scores and the lower triangle is the Jaccard index showed that these two methods are highly consistent with each other (<xref rid="btad058-F3" ref-type="fig">Fig. 3</xref>). In addition, we found that these two scores are highly correlated, with a Spearman rank correlation of 0.91. Overall, this result showed that MS1Connect scores can replicate MS2-based analyses. In addition, our result suggested that MS1Connect scores can measure the similarity between runs that contain multiple species in the face of differing chromatography conditions and instrumentation.</p>
      <fig position="float" id="btad058-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Similarity between MS1Connect scores and MS2-based Jaccard index. A heatmap of similarities scores where the upper triangle is MS1Connect scores and the lower triangle is the Jaccard index between the two sets of confidently detected peptides at a 1% FDR threshold for the multi-species dataset. These two methods are highly correlated with a Spearman rank correlation of 0.91. The solid white lines denote the border between samples. A description of what species are in each sample can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S7</xref>. Within a box delineated by the white lines, the first three rows are the runs from one laboratory while the fourth row is the run from a second laboratory</p>
        </caption>
        <graphic xlink:href="btad058f3" position="float"/>
      </fig>
      <p>A distinct checkerboard pattern in the lower triangle of the heatmap occurred because three out of the four runs from each sample are run on a single instrument while the fourth is run on a second instrument (<xref rid="btad058-F3" ref-type="fig">Fig. 3</xref>). This result matched our expectation since the three runs from the same instrument should be more similar to each other than the run from the second instrument. This pattern, while not as prominent, also exists on the MS1Connect side of the heatmap and further showed that MS1Connect scores can replicate database search results.</p>
    </sec>
    <sec>
      <title>4.3 MS1Connect scores can identify mislabeled runs</title>
      <p>Having shown the ability of MS1Connect to accurately measure the similarity between pairs of proteomics runs, we hypothesized that our method could be used to identify runs with mislabeled metadata. To this end, we analyzed data collected from seven different <italic toggle="yes">Bacillus</italic> species (<xref rid="btad058-B20" ref-type="bibr">Pfrunder <italic toggle="yes">et al.</italic>, 2016</xref>). Each species was analyzed by mass spectrometry six times. We calculated the MS1Connect scores between all of the runs. In addition, we calculated the Jaccard index between the sets of confidently detected peptides at 1% FDR threshold for all pairs of runs.</p>
      <p>We found that MS1Connect scores identify runs whose metadata may have been mislabeled. Specifically, when visualizing a heatmap of the MS1Connect scores between all pairs of runs (upper triangle of <xref rid="btad058-F4" ref-type="fig">Fig. 4</xref>), we observed that one of the runs labeled as <italic toggle="yes">Bacillus tonyonesis</italic> exhibits low similarity with other <italic toggle="yes">B.tonyonesis</italic> runs but has high similarity with other <italic toggle="yes">Bacillus cytotoxicus</italic> runs (last row/column of the heatmap). A database search also confirmed this result (lower triangle of <xref rid="btad058-F4" ref-type="fig">Fig. 4</xref>). Together, these results strongly suggest that a single run labeled as <italic toggle="yes">B.tonyonesis</italic> should instead be labeled <italic toggle="yes">B.cytotoxicus</italic>. This mislabeling could have occurred in many ways. For example, during the sample preparation process a vial could have been mislabeled or there could have been an error during some pipetting step. Alternatively, when placing samples into an autosampler, a vial could have been placed incorrectly onto the tray or the vial position could have been incorrectly recorded into the instrument.</p>
      <fig position="float" id="btad058-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Possible identification of a mislabeled run. The figure is a heatmap of pairwise similarity scores, where the upper triangle is MS1Connect scores and the lower triangle is the Jaccard index between the two sets of confidently detected peptides at 1% FDR threshold for the <italic toggle="yes">Bacillus</italic> genus dataset. The x- and y-axis show the species labels of each run, as described by the PRIDE repository, with six runs per species. The solid white lines denote the border between species. Both the MS1Connect scores and the Jaccard index indicate that a run labeled as <italic toggle="yes">B.tonyonesis</italic> (last row/column of the matrix) was mislabeled and should be labeled <italic toggle="yes">B.cytotoxicus</italic></p>
        </caption>
        <graphic xlink:href="btad058f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>4.4 Analysis of hyperparameters</title>
      <p>After the assessment of our method, we investigated the performance of MS1Connect as a function of the hyperparameters to determine if any of the hyperparameters were correlated with performance. Specifically, we studied the performance of the 2500 different hyperparameterizations of MS1Connect, as described in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2.2</xref>, with respect to each hyperparameter.</p>
      <p>This analysis revealed trends in the performance of various hyperparameterizations of MS1Connect as a function of <italic toggle="yes">N</italic> and <inline-formula id="IE112"><mml:math id="IM112" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> (<xref rid="btad058-F5" ref-type="fig">Fig. 5</xref>). Specifically, we found that the best performance, as measured by QAP on the training dataset, occurred when the number of MS1 features used to generate the bipartite graph <italic toggle="yes">N</italic> was set to 4000 and when the <inline-formula id="IE113"><mml:math id="IM113" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> tolerance <inline-formula id="IE114"><mml:math id="IM114" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> was set to 4 ppm. We note that 4 ppm is within the range of precursor mass tolerances researchers typically use for database searching. On the other hand, we found no trends in the performance of MS1Connect as a function of the remaining hyperparameters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S6 and S7</xref>).</p>
      <fig position="float" id="btad058-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Performance as a function of by no. of MS1 features or <inline-formula id="IE115"><mml:math id="IM115" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> tolerance. These figures plot the performance of 2500 different hyperparameterizations of MS1Connect as a function of (<bold>A</bold>) no. of MS1 features or (<bold>B</bold>) <inline-formula id="IE116"><mml:math id="IM116" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> tolerance. The best performance occurs when <inline-formula id="IE117"><mml:math id="IM117" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> tolerance is set to 4 ppm and no. of MS1 features is set to 4000. Note that the values near the top are the number of points found in each column</p>
        </caption>
        <graphic xlink:href="btad058f5" position="float"/>
      </fig>
      <p>Given that best performance occurred when <inline-formula id="IE118"><mml:math id="IM118" display="inline" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>4000</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE119"><mml:math id="IM119" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> tolerance = 4 ppm, we fixed these two hyperparameters and then asked whether there were any trends in the performance as a function of the remaining hyperparameters. We found that <inline-formula id="IE120"><mml:math id="IM120" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> was correlated with performance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8A</xref>). The performance increased as <inline-formula id="IE121"><mml:math id="IM121" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> increased from 0.0 to 0.9, then performance decreased as <inline-formula id="IE122"><mml:math id="IM122" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> approached 1.0. This trend suggested that larger <inline-formula id="IE123"><mml:math id="IM123" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> may lead to higher performance and hence that supermodularity is important for achieving high performance. This is also shown by the fact that the best performing hyperparameterizations of MS1Connect occurred when <inline-formula id="IE124"><mml:math id="IM124" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>. In addition to <inline-formula id="IE125"><mml:math id="IM125" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula id="IE126"><mml:math id="IM126" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> was also found to be correlated with performance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8B</xref>). In general, the performance MS1Connect decreased as <inline-formula id="IE127"><mml:math id="IM127" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> increased from 0.0 to 1.0. This result indicated that <inline-formula id="IE128"><mml:math id="IM128" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, which measures intensity, is not useful for achieving high performance. However, we note that another hyperparameter, <italic toggle="yes">N</italic>, limits MS1 features in the bipartite graph to high-intensity features. None of the remaining hyperparameters were correlated with performance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S9 and S10</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>5 Discussion</title>
    <p>In this work, we introduced a new method, MS1Connect, that measures the similarity between pairs of proteomics runs. We showed evidence that MS1Connect successfully measures proteomics run similarity. Specifically, we showed that MS1Connect scores can be used for classifying what species a sample was generated from, and we showed evidence that MS1Connect scores can replicate database search results.</p>
    <p>We also considered including in our empirical comparison a method based on dynamic time warping, but this approach turned out to be computationally infeasible. For this approach, we used FastDTW (<xref rid="btad058-B24" ref-type="bibr">Salvador and Chan, 2004</xref>), with a cosine distance as the distance metric, to score the warping between two runs. We estimated that running dynamic time warping between all pairs of runs in our training dataset for the largest <inline-formula id="IE129"><mml:math id="IM129" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> bin width (0.01 Da) in our hyperparameter range would take ∼3 weeks and 300 Gb of memory. The large memory requirement is due to the large matrices being compared to each other. For example, the run with the largest matrix had ∼30 000 time bins and 700 000 <inline-formula id="IE130"><mml:math id="IM130" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> bins (<inline-formula id="IE131"><mml:math id="IM131" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>z</mml:mi></mml:mrow></mml:math></inline-formula> bin width of 0.0035 Da). The long time requirement resulted from having to calculate the warping between all pairs of runs (&gt;13 000 warpings).</p>
    <p>Because MS1Connect only uses MS1 data, it is agnostic to acquisition style. Therefore, MS1Connect can calculate the similarity between runs that have been collected in different ways. Although we did not specifically test this idea, we note that our training set contained data collected by various means. For example, three of the human runs did not contain any MS2 data. As a result, standard MS2-based methods cannot be applied to these runs. In addition, we note that one set of five <italic toggle="yes">S.aureus</italic> runs in the training data was collected by DIA, whereas the remaining runs were collected by DDA. Our results suggested that MS1Connect scores can measure the similarity between DIA and DDA runs. In turn, this ability to measure similarity is the first step for allowing joint analysis of DDA and DIA data.</p>
    <p>While we have shown that MS1Connect scores can be used to predict metadata labels of runs, future works needs to be conducted to determine the limits of our method. For example, none of the data used in this study was isobarically labeled. MS1Connect could be extended to include these types of samples. In addition, MS1Connect has not been tested on a wide variety of samples, such as fractionated samples. Additional work could be pursued to test the applicability of MS1Connect in these scenarios.</p>
    <p>Finally, we note that while we developed MS1Connect for use in proteomics our method can be used to analyze data from other mass spectrometry-based fields such as metabolomics and lipidomics. Our method may be especially useful in these fields because MS2-based identifications are frequently missing. Therefore, MS2-based methods may not be as valuable. In the future, MS1Connect could be applied to data generated by metabolomics and lipidomics.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad058_Supplementary_Data</label>
      <media xlink:href="btad058_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>Pacific Northwest National Laboratory is a multiprogram national laboratory operated by Battelle Memorial Institute for the United States Department of Energy under contract [DE-AC06-76RLO].</p>
  </ack>
  <sec>
    <title>Funding</title>
    <p>This work was supported by National Institutes of Health [R01GM121818 to W.S.] and the Laboratory Directed Research and Development Program at Pacific Northwest National Laboratory, a multiprogram national laboratory operated by Battelle for the U.S. Department of Energy. Andy Lin is grateful for the support of the Linus Pauling Distinguished Postdoctoral Fellowship program. Pacific Northwest National Laboratory is a multiprogram national laboratory operated by Battelle Memorial Institute for the United States Department of Energy under contract [DE-AC06-76RLO].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: The authors have no conflict of interests to declare.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>Data generated for this project are available in PRIDE with identifier PXD027791. Information regarding publicly available data used in this study can be found in Supplementary material as well as <xref rid="sup1" ref-type="supplementary-material">Supplementary Files S1–S4</xref>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad058-B1">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Bai</surname><given-names>W.</given-names></string-name>, <string-name><surname>Bilmes</surname><given-names>J.</given-names></string-name></person-group> (<year>2018</year>) Greed is still good: maximizing monotone submodular+ supermodular (BP) functions. In: <italic toggle="yes">International Conference on Machine Learning</italic>, Stockholm, Sweden, PMLR, pp. <fpage>304</fpage>–<lpage>313</lpage>.</mixed-citation>
    </ref>
    <ref id="btad058-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Bai</surname><given-names>W.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) Bipartite matching generalizations for peptide identification in tandem mass spectrometry. In: <italic toggle="yes">ACM Conference on Bioinformatics, Computational Biology, and Health Informatics</italic>, pp. <fpage>327</fpage>–<lpage>336</lpage>. Seattle, WA.</mixed-citation>
    </ref>
    <ref id="btad058-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Belghit</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Species-specific discrimination of insect meals for aquafeeds by direct comparison of tandem mass spectra</article-title>. <source>Animals (Basel)</source>, <volume>9</volume>, <fpage>222</fpage>.<pub-id pub-id-type="pmid">31067722</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chambers</surname><given-names>M. C.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>A cross-platform toolkit for mass spectrometry and proteomics</article-title>. <source>Nat. Biotechnol</source>., <volume>30</volume>, <fpage>918</fpage>–<lpage>920</lpage>.<pub-id pub-id-type="pmid">23051804</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Choi</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>MassIVE.quant: a community resource of quantitative mass spectrometry-based proteomics datasets</article-title>. <source>Nat. Methods</source>, <volume>17</volume>, <fpage>981</fpage>–<lpage>984</lpage>.<pub-id pub-id-type="pmid">32929271</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cole</surname><given-names>J. K.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Phototrophic biofilm assembly in microbial-mat-derived unicyanobacterial consortia: model systems for the study of autotroph-heterotroph interactions</article-title>. <source>Front. Microbiol</source>., <volume>5</volume>, <fpage>109</fpage>.<pub-id pub-id-type="pmid">24778628</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cox</surname><given-names>J.</given-names></string-name>, <string-name><surname>Mann</surname><given-names>M.</given-names></string-name></person-group> (<year>2008</year>) <article-title>MaxQuant enables high peptide identification rates, individualized p.p.b.-range mass accuracies and proteome-wide protein quantification</article-title>. <source>Nat. Biotechnol</source>., <volume>26</volume>, <fpage>1367</fpage>–<lpage>1372</lpage>.<pub-id pub-id-type="pmid">19029910</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B8">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Edmonds</surname><given-names>J.</given-names></string-name></person-group> (<year>1970</year>) <part-title>Matroids, submodular functions, and certain polyhedra</part-title>. <source>Combinatorial Structures and Their Applications</source>. Oxford University Press, Oxford, United Kingdom. pp. <fpage>69</fpage>–<lpage>87</lpage>.</mixed-citation>
    </ref>
    <ref id="btad058-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Feige</surname><given-names>U.</given-names></string-name></person-group> (<year>1998</year>) <article-title>A threshold of <italic toggle="yes">ln n</italic> for approximating set cover</article-title>. <source>J. ACM</source>, <volume>45</volume>, <fpage>634</fpage>–<lpage>652</lpage>.</mixed-citation>
    </ref>
    <ref id="btad058-B10">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Ji</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>). <part-title>Stochastic greedy algorithm is still good: maximizing submodular + supermodular functions</part-title>. In: <person-group person-group-type="editor"><string-name><surname>Le Thi</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (ed.) <source>Optimization of Complex Systems: Theory, Models, Algorithms and Applications</source>. <publisher-name>Springer International Publishing</publisher-name>, <publisher-loc>Cham</publisher-loc>, pp. <fpage>488</fpage>–<lpage>497</lpage>.</mixed-citation>
    </ref>
    <ref id="btad058-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kelly</surname><given-names>R. T.</given-names></string-name></person-group><etal>et al</etal> (<year>2006</year>) <article-title>Chemically etched open tubular and monolithic emitters for nanoelectrospray ionization mass spectrometry</article-title>. <source>Anal. Chem</source>., <volume>78</volume>, <fpage>7796</fpage>–<lpage>7801</lpage>.<pub-id pub-id-type="pmid">17105173</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Combining high-resolution and exact calibration to boost statistical power: a well-calibrated score function for high-resolution MS2 data</article-title>. <source>J. Proteome Res</source>., <volume>17</volume>, <fpage>3644</fpage>–<lpage>3656</lpage>.<pub-id pub-id-type="pmid">30221945</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>H.</given-names></string-name>, <string-name><surname>Bilmes</surname><given-names>J. A.</given-names></string-name></person-group> (<year>2011</year>). Optimal selection of limited vocabulary speech corpora. In: <italic toggle="yes">Proceedings of Annual Conference of the International Speech Communication Association (INTERSPEECH)</italic>, Florence, Italy.</mixed-citation>
    </ref>
    <ref id="btad058-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martens</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2011</year>) <article-title>mzML–a community standard for mass spectrometry data</article-title>. <source>Mol. Cell. Proteomics</source>, <volume>10</volume>, <fpage>R110.000133</fpage>.</mixed-citation>
    </ref>
    <ref id="btad058-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McIlwain</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Crux: rapid open source protein tandem mass spectrometry analysis</article-title>. <source>J. Proteome Res</source>., <volume>13</volume>, <fpage>4488</fpage>–<lpage>4491</lpage>.<pub-id pub-id-type="pmid">25182276</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B16">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Oxley</surname><given-names>J.</given-names></string-name></person-group> (<year>2011</year>) <source>Matroid Theory</source>, <edition>2nd edn</edition>. <publisher-name>Oxford University Press, Oxford, UK</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btad058-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Palmblad</surname><given-names>M.</given-names></string-name>, <string-name><surname>Deelder</surname><given-names>A. M.</given-names></string-name></person-group> (<year>2012</year>) <article-title>Molecular phylogenetics by direct comparison of tandem mass spectra</article-title>. <source>Rapid Commun. Mass Spectrom</source>., <volume>26</volume>, <fpage>728</fpage>–<lpage>732</lpage>.<pub-id pub-id-type="pmid">22368051</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Park</surname><given-names>C. Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2008</year>) <article-title>Rapid and accurate peptide identification from tandem mass spectra</article-title>. <source>J. Proteome Res</source>., <volume>7</volume>, <fpage>3022</fpage>–<lpage>3027</lpage>.<pub-id pub-id-type="pmid">18505281</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Perez-Riverol</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>The PRIDE database and related tools and resources in 2019: improving support for quantification data</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>D442</fpage>–<lpage>D450</lpage>.<pub-id pub-id-type="pmid">30395289</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pfrunder</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Bacillus cereus group-type strain-specific diagnostic peptides</article-title>. <source>J. Proteome Res</source>., <volume>15</volume>, <fpage>3098</fpage>–<lpage>3107</lpage>.<pub-id pub-id-type="pmid">27432653</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rieder</surname><given-names>V.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>DISMS2: a flexible algorithm for direct proteome- wide distance calculation of LC-MS/MS runs</article-title>. <source>BMC Bioinformatics</source>, <volume>18</volume>, <fpage>148</fpage>.<pub-id pub-id-type="pmid">28253837</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Röst</surname><given-names>H. L.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>pyOpenMS: a python-based interface to the OpenMS mass-spectrometry algorithm library</article-title>. <source>Proteomics</source>, <volume>14</volume>, <fpage>74</fpage>–<lpage>77</lpage>.<pub-id pub-id-type="pmid">24420968</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Röst</surname><given-names>H. L.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>OpenMS: a flexible open-source software platform for mass spectrometry data analysis</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>741</fpage>–<lpage>748</lpage>.<pub-id pub-id-type="pmid">27575624</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B24">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Salvador</surname><given-names>S.</given-names></string-name>, <string-name><surname>Chan</surname><given-names>P.</given-names></string-name></person-group> (<year>2007</year>) Toward accurate dynamic time warping in linear time and space. <italic toggle="yes">Intell. Data Anal.</italic>, <bold>11</bold>(5), <fpage>561</fpage>–<lpage>580</lpage>.</mixed-citation>
    </ref>
    <ref id="btad058-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tabb</surname><given-names>D. L.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Repeatability and reproducibility in proteomic identifications by liquid chromatography-tandem mass spectrometry</article-title>. <source>J. Proteome Res</source>., <volume>9</volume>, <fpage>761</fpage>–<lpage>776</lpage>.<pub-id pub-id-type="pmid">19921851</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B26">
      <mixed-citation publication-type="journal"><collab>The UniProt Consortium</collab> (<year>2019</year>) <article-title>UniProt: a worldwide hub for protein knowledge</article-title>. <source>Nucleic Acids Res</source>.,<bold> 47</bold>, <fpage>D506</fpage>–<lpage>D515</lpage>.<pub-id pub-id-type="pmid">30395287</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van der Plas-Duivesteijn</surname><given-names>S. J.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Differentiating samples and experimental protocols by direct comparison of tandem mass spectra</article-title>. <source>Rapid Commun. Mass Spectrom</source>., <volume>30</volume>, <fpage>731</fpage>–<lpage>738</lpage>.<pub-id pub-id-type="pmid">26864526</pub-id></mixed-citation>
    </ref>
    <ref id="btad058-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>MS1 ion current-based quantitative proteomics: a promising solution for reliable analysis of large biological cohorts</article-title>. <source>Mass Spectrom. Rev</source>., <volume>38</volume>, <fpage>461</fpage>–<lpage>482</lpage>.<pub-id pub-id-type="pmid">30920002</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
