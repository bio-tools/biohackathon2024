<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8254361</article-id>
    <article-id pub-id-type="publisher-id">4277</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04277-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PhyliCS: a Python library to explore scCNA data and quantify spatial tumor heterogeneity</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5643-1385</contrib-id>
        <name>
          <surname>Montemurro</surname>
          <given-names>Marilisa</given-names>
        </name>
        <address>
          <email>marilisa.montemurro@polito.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Grassi</surname>
          <given-names>Elena</given-names>
        </name>
        <address>
          <email>elena.grassi@irccs.it</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pizzino</surname>
          <given-names>Carmelo Gabriele</given-names>
        </name>
        <address>
          <email>carmelogabriele.pizzino@irccs.it</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bertotti</surname>
          <given-names>Andrea</given-names>
        </name>
        <address>
          <email>andrea.bertotti@irccs.it</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ficarra</surname>
          <given-names>Elisa</given-names>
        </name>
        <address>
          <email>elisa.ficarra@unimore.it</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Urgese</surname>
          <given-names>Gianvito</given-names>
        </name>
        <address>
          <email>gianvito.urgese@polito.it</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.4800.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 0343</institution-id><institution>Department of Control and Computer Science, </institution><institution>Politecnico di Torino, </institution></institution-wrap>C.so Duca degli Abruzzi 24, 10129 Turin, Italy </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.4800.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 0343</institution-id><institution>Interuniversity Department of Regional and Urban Studies and Planning, </institution><institution>Politecnico di Torino, </institution></institution-wrap>C.so Duca degli Abruzzi 24, 10129 Turin, Italy </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.7605.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2336 6580</institution-id><institution>Department of Oncology, </institution><institution>University of Torino, </institution></institution-wrap>Strada Provinciale, 142 - KM 3.95, 10060 Candiolo, Turin, Italy </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.419555.9</institution-id><institution-id institution-id-type="ISNI">0000 0004 1759 7675</institution-id><institution>Candiolo Cancer Institute - FPO IRCCS, </institution></institution-wrap>Strada Provinciale, 142 - KM 3.95, 10060 Candiolo, TO Italy </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.7548.e</institution-id><institution-id institution-id-type="ISNI">0000000121697570</institution-id><institution>Enzo Ferrari Engineering Dept, </institution><institution>University of Modena and Reggio Emilia, </institution></institution-wrap>Via Vivarelli 10/1, 41125 Modena, Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>3</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>360</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>6</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Tumors are composed by a number of cancer cell subpopulations (subclones), characterized by a distinguishable set of mutations. This phenomenon, known as intra-tumor heterogeneity (ITH), may be studied using Copy Number Aberrations (CNAs). Nowadays ITH can be assessed at the highest possible resolution using single-cell DNA (scDNA) sequencing technology. Additionally, single-cell CNA (scCNA) profiles from multiple samples of the same tumor can in principle be exploited to study the spatial distribution of subclones within a tumor mass. However, since the technology required to generate large scDNA sequencing datasets is relatively recent, dedicated analytical approaches are still lacking.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We present PhyliCS, the first tool which exploits scCNA data from multiple samples from the same tumor to estimate whether the different clones of a tumor are well mixed or spatially separated. Starting from the CNA data produced with third party instruments, it computes a score, the Spatial Heterogeneity score, aimed at distinguishing spatially intermixed cell populations from spatially segregated ones. Additionally, it provides functionalities to facilitate scDNA analysis, such as feature selection and dimensionality reduction methods, visualization tools and a flexible clustering module.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">PhyliCS represents a valuable instrument to explore the extent of spatial heterogeneity in multi-regional tumour sampling, exploiting the potential of scCNA data.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-021-04277-3.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell sequencing</kwd>
      <kwd>Intra-tumor heterogeneity</kwd>
      <kwd>Cancer evolution</kwd>
      <kwd>Clones</kwd>
      <kwd>DNA</kwd>
      <kwd>Algorithms</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>SmartData@PoliTO center on Big Data and Data Science</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100005010</institution-id>
            <institution>Associazione Italiana per la Ricerca sul Cancro</institution>
          </institution-wrap>
        </funding-source>
        <award-id>21091</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bertotti</surname>
            <given-names>Andrea</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>European Research Council Consolidator</institution>
        </funding-source>
        <award-id>724748 BEAT</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bertotti</surname>
            <given-names>Andrea</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par10">Tumors are caused by the accumulation of somatic mutations. The set of mutations accumulated by the founder cell of a tumor is defined as clonal and inherited by its entire progeny. The mutations arising in an already existing tumor are passed on only to sub-populations of cells and are defined as subclonal [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. As a result, cancer cells are characterized by an intrinsic genetic diversity, known as intra-tumor heterogeneity (ITH) [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par11">ITH is a major topic of interest for the cancer research community, since it has been recognized as one of the major responsible for tumor relapse and treatment failure [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. The most common way to assess ITH is to use deconvolution techniques on bulk DNA sequencing data [<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR9">9</xref>]. Such techniques are generally based on machine learning models, used to cluster the mutations into subclones based on their prevalence and exploit such clusters to infer the tumor phylogenetic structure [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR18">18</xref>]. Some studies have proposed methods to evaluate ITH based on gene expression [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR21">21</xref>] or protein-protein interactions [<xref ref-type="bibr" rid="CR22">22</xref>].</p>
    <p id="Par12">Several studies have shown that using multiple samples taken from distinct regions of the same lesion improves the ability to infer the subclonal structure of tumors [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR28">28</xref>] and assess ITH. For example, a study conducted by Jamal-Hanjani et al. [<xref ref-type="bibr" rid="CR29">29</xref>], sampling 327 regions from 100 early stage non-small-cell lung cancers, revealed that 30% of the somatic mutations were subclonal and stated that if fewer regions had been sampled, many of those mutations would have misinterpreted as clonal.</p>
    <p id="Par13">In this context, emerging single-cell DNA sequencing (scDNA-seq) technologies offer an extraordinary opportunity to tackle such issues, as they allow to study tumor heterogeneity with unprecedented resolution. In particular, single-cell low-coverage whole genome sequencing is suited for detecting chromosomal aberrations, which can be exploited to reconstruct cell population subclonal structure [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
    <p id="Par14">However, the existing methods for single-cell CNA (scCNA) analysis are still limited. Many of them [<xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR38">38</xref>] only identify the total copy-number, which indicates the sum of the number of copies at each locus, by analyzing differences between the observed and expected number of sequences aligned to a locus, or the read-depth ratio. A few of them, also, infer the tumor phylogeny using the CNAs they computed [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
    <p id="Par15">However, to our knowledge, an instrument capable of exploiting both the granularity of single-cell DNA data and multi-sample analysis to quantify ITH still does not exist.</p>
    <p id="Par16">Therefore we present PhyliCS, a flexible Python library that explores CNA calls obtained with third-party tools and exploits them to compute a new metric, the Spatial-Heterogeneity score (SHscore). This score is useful to evaluate the spatial heterogeneity of tumors when multiple regional samplings are available, quantifying how much cells from different samples from the same patient have diverged in their CN landscapes. This evaluation allows both to rank different tumors based on their heterogeneity and identify the most divergent spatial samples of a given tumor. Additionally, it may help to explore different tumors without a huge number of sequenced cells and/or regional samplings to select only the most heterogeneous ones for further analyses.</p>
    <p id="Par17">Moreover, PhyliCS provides easy access to several clustering methods for both single and multiple samples to users, making it easy to compare results and tailor each analysis to each specific experiment. We show its potential by running it on 300 simulated datasets, to validate the SHscore on some selected ideal scenarios where it compares sets of cells with known relationships. After that, we demonstrate the correlation between the proposed SHscore and the evolutionary distance between the cells of the samples in analysis, through a more extensive simulation experiment. Lastly, we present the results of the analysis on three publicly available scDNA datasets, one with multiple spatial samplings from a breast tumor, another comprised of a primary lung tumor and its derived metastases and a third one with a cell line and two clonal expansions of two single cells, using the SHscore to describe how their CN profiles differ when considering the fine grained single cell level in the bigger context of multiple sampling.</p>
    <sec id="Sec2">
      <title>Implementation</title>
      <p id="Par18">In this section we will first describe the main modules of PhyliCS; then we will present the mathematical details of the SHscore and its interpretation.</p>
      <sec id="Sec3">
        <title>PhyliCS</title>
        <p id="Par19">PhyliCS is a comprehensive toolkit that integrates scCNA calls analysis procedures into a single and modular Python package.</p>
        <p id="Par20">As Fig. <xref rid="Fig1" ref-type="fig">1</xref> shows, PhyliCS takes as input the scCNA calls produced by one of the existing scCNA callers [<xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR39">39</xref>] and allows the users to perform:<list list-type="bullet"><list-item><p id="Par21">data preprocessing (feature selection, PCA, UMAP, data filtering),</p></list-item><list-item><p id="Par22">data visualization (UMAP-based scatterplots, heatmaps),</p></list-item><list-item><p id="Par23">data clustering (Affinity Propagation [<xref ref-type="bibr" rid="CR40">40</xref>], Birch [<xref ref-type="bibr" rid="CR41">41</xref>], DBSCAN [<xref ref-type="bibr" rid="CR42">42</xref>], HDBSCAN [<xref ref-type="bibr" rid="CR43">43</xref>], Hierarchical Agglomerative [<xref ref-type="bibr" rid="CR44">44</xref>], KMeans [<xref ref-type="bibr" rid="CR45">45</xref>], OPTICS [<xref ref-type="bibr" rid="CR46">46</xref>], Spectral [<xref ref-type="bibr" rid="CR47">47</xref>]),</p></list-item><list-item><p id="Par24">clustering algorithms evaluation (Silhouette Coefficient, Davies-Bouldin Index, Calinski-Harabasz Index, Adjusted Rand Index, V-Measure, Fowlkes-Mallows Score, Mutual Information),</p></list-item><list-item><p id="Par25">multi-sample clustering, visualization and spatial intra-tumor heterogeneity estimation (SHscore).</p></list-item></list><fig id="Fig1"><label>Fig. 1</label><caption><p>PhyliCS logical schema. PhyliCS allows to perform downstream analysis on the scCNA profiles computed with scCNA third party callers. Specifically, it accepts tabular data and allows to perform data filtering, feature selection, dimensionality reduction, to prepare the data before executing one of the multiple available clustering algorithms. It also allows to perform clustering result quality evaluation by means of both internal and external evaluation metrics. But, most importantly, it provides the possibility to aggregrate scCNA data from multiple samples, to jointly cluster and visualize them, estimating their spatial ITH through the SHscore</p></caption><graphic xlink:href="12859_2021_4277_Fig1_HTML" id="MO1"/></fig></p>
        <p id="Par26">PhyliCS multi-sample analysis module works on the aggregation of input sample data and produces two main results: a graphical representation and a numerical quantification of spatial intra-tumor heterogeneity, the SHscore. Specifically, it generates an aggregated heatmap with a dendrogram computed performing hierarchical clustering of the cells. Heatmap rows, representing the cells from the different samples, are identified by different colored labels. In this way, it is possible to assess whether the clustering algorithm segregated cells originating from different samples into different branches of the dendrogram or if generated mixed clusters: the former case would indicate that, despite originating from the same tumor, the genomic make-up of the cells belonging to different samples is different (spatial intra-tumor heterogeneity); the latter case, instead, would denote that different samples are populated by cells with a similar genomic variance.</p>
        <p id="Par27">PhyliCS implementation is based on a dedicated class, named <italic>CnvData</italic>, which is a modular data structure storing all data annotations (e.g. cell ploidy, cell MAD, etc.) and the results of each analytical step (e.g. PCA, clustering results, etc.) without affecting the data matrix. On the one side, this implementation choice simplifies and speeds up computation; on the other side, it allows experienced developers to extend the framework and add new functionalities with a low programming effort.</p>
        <p id="Par28">PhyliCS does not represent an alternative to the existing scCNA tools developed for identifying scCNA events [<xref ref-type="bibr" rid="CR31">31</xref>–<xref ref-type="bibr" rid="CR38">38</xref>] or tools designed for the phylogenetic analysis [<xref ref-type="bibr" rid="CR39">39</xref>]. Indeed, PhyliCS offers an API to work on scCNA data, leveraging outputs of different third-party tools, and implements a method to characterize spatial ITH.</p>
      </sec>
      <sec id="Sec4">
        <title>Spatial Heterogeity Score</title>
        <p id="Par29">The Spatial-Heterogeneity score (SHscore) is a relative measure of how much the genomic make-up of different samples taken from the same patient diverges with respect to the internal variance of each sample.</p>
        <p id="Par30"><italic>Definition</italic> The principles underlying the SHscore are inspired to those of the Silhouette score, an index used in classical Data Science, to estimate the quality clustering results [<xref ref-type="bibr" rid="CR48">48</xref>]. In fact, we can think of cells as data-points, described by their CNA profile, and of the samples as the cluster they belong to. It is possible to compute for each cell, <italic>p</italic>, the average distance from all other cells belonging to its own cluster, <italic>a</italic>(<italic>p</italic>), and then compare it to the average distance from the cells belonging to the “nearest”, or most similar, cluster, <italic>b</italic>(<italic>p</italic>). Figure <xref rid="Fig2" ref-type="fig">2</xref> shows a conceptual schema of a tumor divided into two subsamples: green arrows represent the pairwise distance between a given cell, <italic>p</italic>, and all cells of its sample; the orange ones, the distance between the same cell and cells of the nearest sample. The average computed on these distances are <italic>a</italic>(<italic>p</italic>) and <italic>b</italic>(<italic>p</italic>).<fig id="Fig2"><label>Fig. 2</label><caption><p>Intra and inter-sample pairwise distance. Given the cell <italic>p</italic>, <italic>a</italic>(<italic>p</italic>), is the average pairwise distance between <italic>p</italic> and all other cells from its own sample, while <italic>b</italic>(<italic>p</italic>) is the average pairwise distance between <italic>p</italic> and the cells from the “nearest” sample</p></caption><graphic xlink:href="12859_2021_4277_Fig2_HTML" id="MO2"/></fig></p>
        <p id="Par31">These distances are the same used to compute the Silhouette score, so we can re-use its implementation and adapt it for our purposes.</p>
        <p id="Par32">For each cell <italic>p</italic> and sample <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_p$$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi>S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq1.gif"/></alternatives></inline-formula>, such that <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p \in S_p$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq2.gif"/></alternatives></inline-formula>, let <italic>a</italic>(<italic>p</italic>) (Eq. <xref rid="Equ1" ref-type="">1</xref>) be the average pairwise-distance between <italic>p</italic> and the other cells belonging to its sample and <italic>b</italic>(<italic>p</italic>) (Eq. <xref rid="Equ2" ref-type="">2</xref>) be the minimum average pairwise-distance between <italic>p</italic> and other sample cells. Now, we can compute <italic>sh</italic>(<italic>p</italic>) (Eq. <xref rid="Equ3" ref-type="">3</xref>) which measures the difference between the average pairwise-distance between <italic>p</italic> and the cells of the sample, nearest to the one it belongs to, and the average pairwise-distance between <italic>p</italic> and the cells of its own sample.<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} a(p)= &amp; {} \frac{1}{\mid S_p \mid - 1}\sum _{p \in S_p, q \ne p}d(p,q) \end{aligned}$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>∣</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>≠</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:munder><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4277_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} b(p)= &amp; {} min_{k \ne p}\frac{1}{\mid S_k \mid }\sum _{q \in S_k} d(p,q) \end{aligned}$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>≠</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mo>∣</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mi>d</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4277_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} sh(p)= &amp; {} \frac{b(p) - a(p)}{max\{a(p), b(p)\}} \end{aligned}$$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4277_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>Dividing it by <inline-formula id="IEq3"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$max\{a(p), b(p)\}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq3.gif"/></alternatives></inline-formula> makes <italic>sh</italic>(<italic>p</italic>) a relative difference.</p>
        <p id="Par33">In order to mitigate the negative impact of the high dimensionality of scCNA data, we adopted <italic>L1</italic>, or <italic>Manhattan</italic>, norm to compute pairwise distances. In fact, it has been demonstrated that, for dimensionalities of 20 or higher, <italic>LK</italic> norms, with <inline-formula id="IEq4"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K \le 1$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>K</mml:mi><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq4.gif"/></alternatives></inline-formula>, better discriminate [<xref ref-type="bibr" rid="CR49">49</xref>, <xref ref-type="bibr" rid="CR50">50</xref>] between the nearest and the furthest neighbors compared to higher level norms (e.g. <italic>L2</italic>, or <italic>Euclidean</italic> norm).</p>
        <p id="Par34">From Eq. <xref rid="Equ3" ref-type="">3</xref> it is clear that <inline-formula id="IEq5"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-1 \le sh(p) \le +1$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq5.gif"/></alternatives></inline-formula>.</p>
        <p id="Par35">For <italic>sh</italic>(<italic>i</italic>) to be close to 1 we require <inline-formula id="IEq6"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a(p)&lt;&lt; b(p)$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq6.gif"/></alternatives></inline-formula>. As <italic>a</italic>(<italic>p</italic>) is a measure of how much the genomic profile of <italic>p</italic> is dissimilar to the average profile of its own sample, a small value means a high level of similarity. Furthermore, a large <italic>b</italic>(<italic>p</italic>) indicates that <italic>p</italic> CNA profile is highly different from the average profile of the most similar among the samples in analysis. Thus, a <italic>sh</italic>(<italic>p</italic>) close to 1 means that <italic>p</italic> CNA profile matches the average genomic profile of the sample it belongs to. If <italic>sh</italic>(<italic>p</italic>) is close to −1, then by the same logic we can state that <italic>p</italic> CNA profile is more similar to the genomic profile of the neighboring sample than to the genomic profile of the other cells of its own sample. An <italic>sh</italic>(<italic>p</italic>) close to 0 means that the CNA profile is on the border of two natural clusters, so <italic>p</italic> may belong to both of them.</p>
        <p id="Par36">Mathematically, the SHscore, <inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$SHscore(S_1, S_2, \ldots , S_n)$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>S</mml:mi><mml:mi>H</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq7.gif"/></alternatives></inline-formula>, for the set of samples <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_1, S_2, \ldots , S_n$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq8.gif"/></alternatives></inline-formula>, is a measure of how well-separated the samples are and is defined as the mean <italic>sh</italic>(<italic>p</italic>) over all cells in the entire dataset, <inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D = [S_1 \cup S_2 \cup \cdots \cup S_n]$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>∪</mml:mo><mml:mo>⋯</mml:mo><mml:mo>∪</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq9.gif"/></alternatives></inline-formula> (Eq. <xref rid="Equ4" ref-type="">4</xref>).<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} SHscore(S_1, S_2, \ldots , S_n) = \frac{\sum _{p, p \in D} sh(p)}{\mid D \mid }. \end{aligned}$$\end{document}</tex-math><mml:math id="M26" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi><mml:mi>H</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mi>s</mml:mi><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∣</mml:mo><mml:mi>D</mml:mi><mml:mo>∣</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4277_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>From Eq. <xref rid="Equ4" ref-type="">4</xref>, it is clear that also the SHscore may assume values in the interval <inline-formula id="IEq10"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[-1, 1]$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq10.gif"/></alternatives></inline-formula> and its interpretation may be derived from the interpretation of single-cell scores. Specifically, a SHscore close to 1 indicates that many cells, in the various samples, are characterized by a <italic>sh</italic>(<italic>p</italic>) close to 1, denoting that samples are internally homogeneous and segregated with respect to the others. Similarly, a SHscore close to −1 indicates that many cells, in the dataset, look more similar to the cells of another sample than to those of their own sample; this, could denote problems with the sequencing quality or data pre-processing. Finally, a SHscore close to 0 implies that many cells may indistinctly belong to their own sample or to another, which may indicate two scenarios: the samples are internally homogeneous, but very similar among each other, thus they share the same subclonal structure and cells may belong to one or another; or that the samples are internally heterogeneous, so that the CN profiles of their cells cannot be clearly assigned to any one of them.</p>
        <p id="Par37">
          <italic>Application scenario</italic>
        </p>
        <p id="Par38">Let us suppose that three single-cell data-sets, <inline-formula id="IEq11"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_1, s_2, s_3$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq11.gif"/></alternatives></inline-formula>, originated from three different regions of the same tumor, have been provided as input samples to PhyliCS. The SHscore evaluation phase will proceed as follows: <list list-type="order"><list-item><p id="Par39">The cells are assigned to three predefined clusters, <inline-formula id="IEq12"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_1, S_2, S_3$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq12.gif"/></alternatives></inline-formula>, in the following way: <inline-formula id="IEq13"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{p : p \in s_i\} \Rightarrow p \in S_i$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>p</mml:mi><mml:mo>:</mml:mo><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">⇒</mml:mo><mml:mi>p</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq13.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq14"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in [1,2,3]$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq14.gif"/></alternatives></inline-formula>. The SHscore is computed as <inline-formula id="IEq15"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$hs_{1,2,3} = SHscore(S_1, S_2, S_3)$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>h</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>H</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq15.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par40">The cells from <inline-formula id="IEq16"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_1$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_2$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq17.gif"/></alternatives></inline-formula> are combined in a single cluster, <inline-formula id="IEq18"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{12}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>S</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq18.gif"/></alternatives></inline-formula>, and those from <inline-formula id="IEq19"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_3$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq19.gif"/></alternatives></inline-formula> are assigned to a separate cluster, <inline-formula id="IEq20"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_3$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq20.gif"/></alternatives></inline-formula>. The SHscore is computed again as <inline-formula id="IEq21"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$hs_{12,3} = SHscore(S_{12}, S_3)$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi>h</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>12</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>H</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq21.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par41">The cells from <inline-formula id="IEq22"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_1$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq22.gif"/></alternatives></inline-formula> and <inline-formula id="IEq23"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_3$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq23.gif"/></alternatives></inline-formula> are combined in a single cluster, <inline-formula id="IEq24"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{13}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>S</mml:mi><mml:mn>13</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq24.gif"/></alternatives></inline-formula>, and those from <inline-formula id="IEq25"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_2$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq25.gif"/></alternatives></inline-formula> are assigned to a separate cluster, <inline-formula id="IEq26"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_2$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq26.gif"/></alternatives></inline-formula>. The SHscore is computed again as <inline-formula id="IEq27"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$sh_{13,2} = SHscore(S_{13}, S_2)$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mn>13</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>H</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>13</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq27.gif"/></alternatives></inline-formula></p></list-item><list-item><p id="Par42">The cells from <inline-formula id="IEq28"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_2$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq28.gif"/></alternatives></inline-formula> and <inline-formula id="IEq29"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_3$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq29.gif"/></alternatives></inline-formula> are combined in a single cluster, <inline-formula id="IEq30"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{23}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>S</mml:mi><mml:mn>23</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq30.gif"/></alternatives></inline-formula>, and those from <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_1$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq31.gif"/></alternatives></inline-formula> are assigned to a separate cluster, <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_1$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq32.gif"/></alternatives></inline-formula>. The SHscore is computed again as <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$sh_{23,1} = SHscore(S_{23}, S_1)$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mn>23</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mi>H</mml:mi><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>23</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq33.gif"/></alternatives></inline-formula>.</p></list-item></list>Let us suppose, now, that <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$hs_{23,1}$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>h</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mn>23</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq34.gif"/></alternatives></inline-formula> is the maximum computed score. Specifically, we suppose that:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} sh_{23,1} &gt; sh_{1,2,3}. \end{aligned}$$\end{document}</tex-math><mml:math id="M78" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mn>23</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4277_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>This means that samples <inline-formula id="IEq35"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_2$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq35.gif"/></alternatives></inline-formula> and <inline-formula id="IEq36"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_3$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq36.gif"/></alternatives></inline-formula> are similar to each other and, in some measure, different from sample <inline-formula id="IEq37"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_1$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq37.gif"/></alternatives></inline-formula> and that considering their cells together resulted in a better clustering.</p>
        <p id="Par43">To conclude, the SHscore represents a way to quantify numerically the genomic distance, in terms of CNAs, between different samples of the same tumor and to investigate spatial intra-tumor heterogeneity.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec5">
    <title>Results and Discussion</title>
    <p id="Par44">Here, the experiments conducted to study the SHscore behaviour in different contexts are introduced. Additionally, the procedures executed to generate the simulated datasets are described.</p>
    <p id="Par45">In details, the SHscore has been used on 200 simulated datasets representing some ideal scenarios (spatial segregation, spatial intermixing, early metastasis spreading and late metastasis spreading), to check if it correctly reflects the heterogeneity in the clonal structure of multiple samples. After that, the score has been tested on a set of 100 simulations to analyze its behaviour when the mean CNA size and the mean number of copies gained varies in a controlled way. Then, a more extensive simulation was conducted to verify the correlation between the SHscore and the divergence accumulated during the evolution of the samples. Finally, the SHScore has been tested on 3 publicly available scCNA datasets to study its behaviour in some real-world scenarios.</p>
    <sec id="Sec6">
      <title>Experiment 1: SHscore on synthetic data</title>
      <sec id="Sec7">
        <title>Data generation</title>
        <p id="Par46">We conducted a simulation study to analyze the SHscore behaviour under four different scenarios (spatial subclone segregation, spatial subclone intermixing, early and late metastasis spreading) and to study if and how it correlates with some features of the CN profiles of cells (CNA region size, CN level).</p>
        <p id="Par47">To this purpose, we extended the model presented by Fan et al. [<xref ref-type="bibr" rid="CR51">51</xref>] which generates a phylogenetic tree starting from a reference genome, using a generalization of the Beta-Splitting model [<xref ref-type="bibr" rid="CR52">52</xref>]. At the end of the simulation process, the leaves of the generated tree represent the cells sampled from the patient, while the internal nodes represent intermediate CN states, which do not exist anymore.</p>
        <p id="Par48"><italic>Spatial segregation</italic> To simulate the extreme case in which subclones segregate in isolated niches very early during tumor evolution, we tracked the progeny of the first 5 cells (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a) generated by the simulator. We let the trees grow until they contained 2500 leaves. At that point, we were able to distinguish groups of cells phylogenetically separated and to consider them as our subsamples, each containing a distinct subclone (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). So, in the end, we divided each dataset into 5 subsamples corresponding to the 5 groups of cells deriving from the first 5 generated cell. From now on, we refer to this scenario as <italic>hom-scenario</italic>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Spatial subclonal segregation and intermixing simulation. We generated 50 phylogenetic trees (<bold>a</bold>) made of 2500 cells. For each tree we simulatated: (I) early segregation of subclones (<italic>hom</italic>) by tracking the progeny of the first five generated cells and assigned the leaves to five distinct subsamples, corresponding to the five subclones (<bold>b</bold>); (II) spatial intermixing of subclones (<italic>het</italic>) by shuffling the leaves and assigning them randomly to five subsamples (<bold>c</bold>)</p></caption><graphic xlink:href="12859_2021_4277_Fig3_HTML" id="MO8"/></fig></p>
        <p id="Par49"><italic>Spatial intermixing</italic> We also simulated the scenario in which the tumor cells subpopulations are spatially well-mixed, so a regional subsampling would produce very similar samples. This was done by shuffling the leaves of the previously generated trees and randomly assigned them to 5 subsamples (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). From now on, we refer to this scenario as <italic>het-scenario</italic>.</p>
        <p id="Par50"><italic>Metastasis spreading</italic> We simulated another different case of spatial segregation, which is the scenario in which a cell seeds a metastasis, initiating a completely isolated clonal expansion. To that purpose we generated new phylogenetic trees: when the trees had generated 1/4 or 3/4 of the final number of cells, we randomly selected one cell and seeded another tree to model early or late metastatic spreading during the primary tumor evolution, respectively. We let the tree generation proceed in parallel until all of them contained 500 leaves (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). From now on, we refer to these scenarios, respectively, as <italic>early-met-scenario</italic> and <italic>late-met-scenario</italic>.<fig id="Fig4"><label>Fig. 4</label><caption><p>Metastasis seeding and expansion simulation. We generated 100 pairs of primary-metastasis samples (50 <italic>early</italic> metastasising, 50 <italic>late</italic> metastasising). Each pair was obtained by seeding the primary tumor tree and successively initiating a new tree with a cell randomly selected when the primary tree had generated 1/3 (early) or 3/4 (late) of the final number of desired cells. The simulation was stopped when both trees had generated 500 leaves</p></caption><graphic xlink:href="12859_2021_4277_Fig4_HTML" id="MO9"/></fig></p>
        <p id="Par51">For each of the four scenarios described so far, we generated 50 synthetic datasets for a total of 200 simulations.</p>
        <p id="Par52"><italic>Simulations with varying parameters</italic> 100 datasets were simulated with varying parameters to generate CN profiles characterized by different structural features and check if and how those features correlate to the SHscore. Precisely, we varied the expected CNA size (<inline-formula id="IEq38"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M86"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq38.gif"/></alternatives></inline-formula>), which is used by the simulator to sample from an exponential distribution, and the reciprocal of the expected number of gained copies (<italic>p</italic>), which is used to sample from a geometrical distribution. In details, for each simulation, <inline-formula id="IEq39"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M88"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq39.gif"/></alternatives></inline-formula> was chosen by randomly sampling from a uniform distribution defined in the interval [500, 5000000], while <italic>p</italic> was sampled from a uniform distribution defined in the interval [0.1, 0.9] (Supplementary Material: Supplementary Figures 1a and 1b). Each simulated tree had 1000 leaves and was splitted into two subtrees, each representing a tumor subsample. From now on, we refer to this scenario as <italic>var-scenario</italic>.</p>
      </sec>
      <sec id="Sec8">
        <title>SHscore statistics</title>
        <p id="Par53">SHscore was computed on the synthetic datasets, built to represent the previously described heterogeneity scenarios, to evaluate its ability to capture their differences.</p>
        <p id="Par54"><italic>Spatial heterogeneity at the same disease site</italic> First, we computed the SHscore on the 100 sets of samples simulating the regional subsampling from the same disease site (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, c). Figure <xref rid="Fig5" ref-type="fig">5</xref>a shows the SHscores computed on the <italic>hom-scenario</italic> (spatial segregation) and the <italic>het-scenario</italic> (intermixing). The scores, in the two scenarios, are different (unpaired wilcoxon p value <inline-formula id="IEq40"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3.5 \times 10^{-18}$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mn>3.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>18</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq40.gif"/></alternatives></inline-formula>): in the <italic>het-scenario</italic> values fall into a very small interval (min: -0.020, max: -0.004, median: -0.010, IQR: 0.004); the <italic>hom-scenario</italic>, instead, produced scores ranging on a broader interval (min: 0.043, max: 0.295, median: 0.151, IQR: 0.064), reflecting a higher heterogeneity between the simulated samples with different “clones” (the progenies of the first five cells) evenly distributed among them (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b).<fig id="Fig5"><label>Fig. 5</label><caption><p>SHscore distribution. We computed the SHscore on 100 synthetic datasets simulating regional subsampling (<bold>a</bold>) (Mann–Whitney U test p-value <inline-formula id="IEq41"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3.5 \times 10^{-18}$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mn>3.5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>18</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq41.gif"/></alternatives></inline-formula>). Het-scenario =  min: -0.020, max: -0.004, median: -0.010, IQR: 0.004. Hom-scenario = min: 0.043, max: 0.295, median: 0.151, IQR: 0.064. We also computed the SHscore on 100 synthetic dataset simulating metastasis spreading (<bold>b</bold>)(Mann–Whitney U p-value 0.0029). EarlyMet scenario = min: 0.103, max: 0.461, median: 0.267, IQR: 0.124; LateMet scenario = min: 0.195, max: 0.547, median: 0.320, IQR: 0.084</p></caption><graphic xlink:href="12859_2021_4277_Fig5_HTML" id="MO10"/></fig></p>
        <p id="Par55">The results obtained by this experiment demonstrated that our score is able to discriminate between the two described scenarios.</p>
        <p id="Par56"><italic>Spatial heterogeneity at different disease sites</italic> Figure <xref rid="Fig5" ref-type="fig">5</xref>b shows the results for the two metastatic scenarios: here too the difference is significant (Mann–Whitney U p value 0.0029), albeit less pronounced, underlying how different seeding histories can result in different SHscores; even if with the parameters chosen for our simulations the difference is small and the intra-scenario variability between different simulation is high (<italic>early-met</italic>: min: 0.103, max: 0.461, median: 0.267, IQR: 0.124; <italic>late-met</italic>: min: 0.195, max: 0.547, median: 0.320, IQR: 0.084).</p>
        <p id="Par57"><italic>SHscore indipendence from CNA size and gained copy number</italic> In order to study if the SHscore correlates with the mean CNA size and the mean number of gained copies, we computed the SHscore for each pair of samples generated in the <italic>var-scenario</italic>. Then, we calculated the Pearson correlation coefficient between the SHscores and the parameters <inline-formula id="IEq43"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M94"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq43.gif"/></alternatives></inline-formula> (mean CNA size) and <italic>p</italic> (reciprocal of mean number of gained copies), for each simulation. The results (<inline-formula id="IEq44"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M96"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq44.gif"/></alternatives></inline-formula>: Pearson correlation coefficient = −0.101, p value = 0.319; <italic>p</italic>: Pearson correlation coefficient = −0.109, p value = 0.282), indicated that there were no significant correlations, suggesting that SHscore is robust with respect to different rates of CN accumulation and to the size of events (Fig. <xref rid="Fig6" ref-type="fig">6</xref>).<fig id="Fig6"><label>Fig. 6</label><caption><p>SHscore independence from mean CNA size and mean gained copies. We tested the SHscore on multiple simulated sample pairs, characterized by a different and known mean CNA size <inline-formula id="IEq42"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M98"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq42.gif"/></alternatives></inline-formula> and mean number of gained copies <italic>p</italic>. We found out that the SHscore is uncorrelated to those features with a Pearson correlation coefficient c = −0.101 (p value =  0.319), for the mean CNA size, and c = −0.109 (p value = 0.282), for the mean number of gained copies</p></caption><graphic xlink:href="12859_2021_4277_Fig6_HTML" id="MO11"/></fig></p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>Experiment 2: SHscore and evolutionary distance</title>
      <p id="Par58">The heterogeneity quantified by the SHscore reflects the evolutionary distance between the cells of the samples analyzed. Another simulation experiment was designed to verify the existence of a correlation between SHscore and the distance between the copy-number states which originated the mutational profile of the samples. Such CN states may be thought as the most recent common ancestor (MRCA) of the existing CN profiles.</p>
      <sec id="Sec10">
        <title>Data generation</title>
        <p id="Par59"><italic>100Kcells and 10Kcells.</italic> In order to generate a deep evolutionary history and, consequently, a more heterogeneous dataset, a cell-division tree with 100K final leaves was simulated. The subtrees rooted in the first 200 generated cells were tracked, simulating the complete spatial segregation of the subclones originating from those cells (see Spatial heterogeneity at the same disease site). The cardinality of the generated datasets was quite homogeneous (mean cell number = 500 cells) with some exceptions (min cell number = 91, max cell number = 3112). In order to have a balanced dataset, only the subtrees with a cardinality between the 1st and the 3rd quartile (208.75 and 746.50 leaves, respectively) were retained. For each subtree, the leaves were extracted and the CNA matrix was generated; additionally, the position of their roots within the parental tree was tracked. From now on, we refer to this scenario as the <italic>100Kcells</italic> experiment.</p>
        <p id="Par60">The same procedure was executed to generate trees with 10K leaves, tracking subtrees for the first 20 generated cells. Also in this case, only the datasets with a cardinality between the 1st and the 3rd quartile (318 and 623.75 leaves, respectively) were kept. From now on, we refer to this scenario as the <italic>10Kcells</italic> experiment.</p>
      </sec>
      <sec id="Sec11">
        <title>SHscore and MRCA distance correlation</title>
        <p id="Par61">In order to investigate the correlation between the SHscore and the distance between the MRCAs of the sample cells, we used the dataset generated in the <italic>100Kcells</italic> experiment. First, we computed the SHscores for the 4950 possible pairs of samples. After that, we randomly sampled 1000 pairs and computed the distance between their MRCAs, represented by the number of edges connecting the single cells that originated the two subtrees. We verified that the random selection was representative of the whole set of pairs (Supplementary Material: Supplementary Figure 2).</p>
        <p id="Par62">Finally, we were able to demonstrate that the two quantities are positively correlated, with a Pearson correlation coefficient c = 0.628 (p value = 1e−11, Fig. <xref rid="Fig7" ref-type="fig">7</xref>a).<fig id="Fig7"><label>Fig. 7</label><caption><p>SHscore versus evolutionary distance. We executed a Pearson correlation test on the SHscores and the MRCA distances, demonstrating that the two quantities are positively correlated (coef = 0.628, p value = 1e−11) (<bold>a</bold>). We aggregated the SHscores computed on datasets deriving from from trees which growth was stopped at a different height. The scores in the three scenarios are distributed around a different median (2.5 K cells = median: 0.151, IQR: 0.064, 10 K cells = median: 0.278, IQR: 0.061, 100 K cells = median: 0.498, IQR: 0.092), which value increases as the mean distance between the MRCAs of the sample increases (<bold>b</bold>)</p></caption><graphic xlink:href="12859_2021_4277_Fig7_HTML" id="MO12"/></fig></p>
        <p id="Par63">This result verified the hypothesis that the heterogeneity measured by the SHscore captures the evolutionary distance of the cells belonging to the samples analyzed.</p>
      </sec>
      <sec id="Sec12">
        <title>SHscore for different evolutionary spans</title>
        <p id="Par64">We computed the SHscores between the 45 pairs of samples generated from the <italic>10Kcells</italic> experiment and combined the results with those obtained in the <italic>hom_scenario</italic> and in the <italic>100Kcells</italic> experiment. The samples in the three scenarios contain a comparable number of cells (<inline-formula id="IEq45"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M100"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq45.gif"/></alternatives></inline-formula> 500) but derive from trees which growth was stopped at a different height. This means that the sample history, in the three scenarios, diverged at different heights on the parental tree and kept on growing for a comparable number of doublings, at the same mutation rate, which is fixed by the generating model. Therefore, sample cells, in the three different scenarios, are likely to have accumulated the same amount of heterogeneity, starting from their MRCAs, while their divergence is mainly due to the heterogeneity accumulated by their MRCAs, which are located at different distances on the parental tree (very close on 2.5K cell trees, very distant on the 100K cell tree, intermediate distance on the 10K cell tree). Figure <xref rid="Fig7" ref-type="fig">7</xref>b shows that the scores in the three scenarios are distributed around a different median (2.5<italic>K</italic> cells = median: 0.151, IQR: 0.064, 10K cells = median: 0.278, IQR: 0.061, 100K cells = median: 0.498, IQR: 0.092), which value increases as the mean distance between the MRCAs of the sample increases.</p>
        <p id="Par65">This is an additional proof of what was shown before: the closer the MRCAs, the higher the score.</p>
        <p id="Par66">The results shown in this section lead us to conclude that a score lower than 0.2 indicates that the subclones are well-mixed in the tumor sample or that they are segregated in space, but spatial differences are so small that the tumor may be considered homogeneous. A score greater or equal to 0.2, instead suggests that different regions of the same tumors are separated by a non-negligible evolutionary distance which made them quite different and this should be considered for eventual further analyses.</p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>Experiment 3: SHscore on tumor data</title>
      <p id="Par67">Here, we present three examples of application of PhyliCS on real scCNA public datasets.</p>
      <sec id="Sec14">
        <title>Spatial subsamples from the same disease site</title>
        <p id="Par68">This example shows how PhyliCS may be used to investigate spatial intra-tumor heterogeneity at a single disease site.</p>
        <p id="Par69">We have used PhyliCS on five single-cell CNA datasets produced with Cell Ranger DNA and published on 10x Genomics website [<xref ref-type="bibr" rid="CR53">53</xref>]. The datasets derive from five sections (S_A, S_B, S_C, S_D, S_E), of the same frozen breast tumor tissue and contain data related to 2137, 2224, 1722, 1916 and 2053 cells, respectively.</p>
        <p id="Par70"><italic>scCNA calling</italic> We performed a few preliminary steps to produce PhyliCS input files. Specifically, we demultiplexed 10x multi-cell alignment files to get single-cell .bam files, using a C++ based tool, <italic>SCtools</italic>, we developed with the SeqAn library [<xref ref-type="bibr" rid="CR54">54</xref>]. After that we performed some quality checks and computed CNA events using Ginkgo [<xref ref-type="bibr" rid="CR34">34</xref>]. At this point, we were ready to load scCNA datasets into PhyliCS.</p>
        <p><italic>Data Pre-processing</italic> Using the preprocessing module, we removed diploid or pseudo-diploid cells (ploidy ranging in the interval [1.6, 2.9]), which are uninformative, and those which CNA profile was characterized by a high (&gt;95th percentile) median absolute deviation (MAD), because they are considered noisy, due to single cell amplification issues or ongoing DNA replication. As a result, the cells left for the five samples were 110, 1172, 1040, 1137 and 1473. Since S_A contained very few tumor cells compared to the other samples, we did not include it in the following analysis steps.</p>
        <p id="Par71"><italic>Multi-Sample Analysis</italic> Figure <xref rid="Fig8" ref-type="fig">8</xref>a shows the graphical results produced after the aggregation phase. The cells from the four samples share a similar CNA profile and have been mixed-up by the clustering algorithm.<fig id="Fig8"><label>Fig. 8</label><caption><p>Test case: breast tumor data. We tested PhyliCS on a scCNA dataset containing the data of five sections (S_A, S_B, S_C, S_D, S_E) of the same breast tumor. After some preliminary operations, we discarded S_A and kept the others for further analysis. We obtained the evidence that the sections share similar genomic patterns (<bold>a</bold>), with the exception of S_B; this is confirmed by the SHscore (<bold>b</bold>), which best value (0.1824) is obtained by by aggregating S_C, S_D, S_E against S_B</p></caption><graphic xlink:href="12859_2021_4277_Fig8_HTML" id="MO13"/></fig></p>
        <p id="Par72">Figure <xref rid="Fig8" ref-type="fig">8</xref>b, instead, presents a diagram containing the SHscores computed for different sample aggregations. The value indicated as ’S_B vs S_C vs S_D vs S_E’ indicates how much the samples are different from each other. According to what we have seen with the simulation experiment, the value −0.0201 indicates that the four samples show a very similar genomic make-up, which makes them almost indistinguishable. Additionally, it can be noticed that by combining the samples S_C, S_D and S_E and testing them against S_B, the SHscore grows to <inline-formula id="IEq46"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt {0.182388}$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mn mathvariant="monospace">0.182388</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4277_Article_IEq46.gif"/></alternatives></inline-formula>, indicating that its genomic make-up may be clonally separated from that of the other samples. SHscores confirm the graphical results shown in Fig. <xref rid="Fig8" ref-type="fig">8</xref>a, highlighting S_B as the more divergent sample, a results that is backed up by the clonal reconstruction made by CHISEL [<xref ref-type="bibr" rid="CR39">39</xref>], which reveals a subclone (J-I) that is almost private to that sample.</p>
      </sec>
      <sec id="Sec15">
        <title>Spatial subsamples from the different disease sites</title>
        <p id="Par73">We also applied our method to a pair of samples derived from a primary tumor and a matched metastasis. To do this, we exploited the results of the CNA analysis performed by Garvin et al. on a dataset to validate Ginkgo [<xref ref-type="bibr" rid="CR34">34</xref>]. The dataset corresponds to a primary breast tumor and its liver metastasis (T16P/M) and was used by Navin et al. [<xref ref-type="bibr" rid="CR55">55</xref>] for their study on intra-tumor heterogeneity characterization. Since the CNA calls were available on Ginkgo website, we were able to directly load data into PhyliCS.</p>
        <p id="Par74"><italic>Data Pre-processing</italic> Also in this case, we filtered out diploid and pseudo-diploid cells and those with a high MAD, reducing the aggregated dataset cardinality from 100 to 42 cells.</p>
        <p id="Par75"><italic>Multi-Sample Analysis</italic> Figure <xref rid="Fig9" ref-type="fig">9</xref> presents the results obtained from the analysis performed on this dataset. It shows that, apparently, the same cell-population which initiated the tumor also seeded the metastasis, confirming the findings of the original publication [<xref ref-type="bibr" rid="CR55">55</xref>]. The hierarchical clustering algorithm, this time, has organized cells in two separate blocks, corresponding to the two populations from the primary tumor and the metastasis. This underlines a certain degree of separation between the two samples, that is also represented by the SHscore. Even if we cannot compare scores for different sample arrangements, the SHscore (0.5361) is consistent with the results we obtained on metastatic scenarios simulations. The high SHscore means that although the primary and metastatic sample share a common mutational pattern, their following, independent, evolution made them clearly distinguishable. This suggests that the differences between primary and metastatic pairs that have always been measured with bulk sequencing can be further studied with scDNA approaches [<xref ref-type="bibr" rid="CR56">56</xref>, <xref ref-type="bibr" rid="CR57">57</xref>].<fig id="Fig9"><label>Fig. 9</label><caption><p>Test case: lung tumor data. We tested PhyliCS on pair of samples derived from a primary lung tumor and a matched liver metastasis. This time, the two samples shown a certain degree of genetic diversity and where characterized by a high SHscore (0.5361)</p></caption><graphic xlink:href="12859_2021_4277_Fig9_HTML" id="MO14"/></fig></p>
      </sec>
      <sec id="Sec16">
        <title>Clonal expansion of a cell line</title>
        <p id="Par76">This example presents an extended use-case which shows how PhyliCS may be used to investigate the heterogeneity gained by a clonally expanded cell line.</p>
        <p id="Par77">In details, we exploited a single-cell dataset, recently published by Minussi et al. [<xref ref-type="bibr" rid="CR58">58</xref>] on NCBI Sequence Read Archive (accession number PRJNA629885), containing the sequencing reads of cells from a triple-negative breast cancer cell line (MDA-MB-231) (508 cells) and those resulting from the clonal expansion of 2 single daughter cells (MDA231-EX1 and MDA231-EX2) from the parental cell line for 19 cell doublings (995 and 897 cells, respectively). From the sequencing reads, aligned to the GRCh38 reference genome, we called the CNA events using Ginkgo [<xref ref-type="bibr" rid="CR34">34</xref>] (additional details on the alignment and CNA calling procedures are available at Supplementary Material: Supplementary Method 1).</p>
        <p id="Par78"><italic>Multi-Sample Analysis</italic> We provided CNA matrices to PhyliCS and computed the SHscores for all possible partitions of the three datasets. Figure <xref rid="Fig10" ref-type="fig">10</xref>b shows that the best SHscore (0.7102) was obtained when aggregating MDA-MB-231-EX1 dataset with the parental one. This result indicates that MDA-MB-231-EX1 cells share a common genomic pattern with the parental cell line. This is confirmed by the results of the hierarchical clustering performed on the aggregated dataset, graphically shown in Fig. <xref rid="Fig10" ref-type="fig">10</xref>a: cells from MDA-MB-231-EX1 are well mixed with the parental ones, while the cells from MDA-MB-231-EX2 are put into a completely separate block. This may due to two reasons: the clonal expansion from MDA-MB-231-EX2 originating cell generated more heterogeneity than the other one or the clonal subpopulation which MDA-MB-231-EX2 originating cell was sampled from is not represented in the parental dataset (Supplementary Material: Supplementary Method 1). Anyhow, we can state that the proposed score is capable of capturing the different levels of diversity among multiple samples and when using it in a comparative way it is highly informative.<fig id="Fig10"><label>Fig. 10</label><caption><p>Test case: MDA-MB-231 cell line data. We tested PhyliCS on MDA-MB-231 cell line. In details, we compared the parental cell-line the the datasets resulting from the clonal expansion of two dauther cells, MDA-MB-231-EX1 and MDA-MB-231-EX2, for 19 doublings. The datasets contain 508, 995 and 897 cells respectively. We obtained the evidence that the dataset deriving from the expansion of MDA-MB-231-EX1 was more similar to the parental line, with respect to the genomic profile of the data deriving from MDA-MB-231-EX2 (<bold>a</bold>). In fact, the best SHscore (0.7102) was obtained when aggregating MDA-MB-231-EX1 dataset with the parental against the other one (<bold>b</bold>)</p></caption><graphic xlink:href="12859_2021_4277_Fig10_HTML" id="MO15"/></fig></p>
        <p id="Par79">We exploited this dataset to present other PhyliCS features, analyzing separately the parental and derived cell lines. In particular we were able to demonstrate that the SHscore is robust when comparing two samples with different number of cells; specifically the heterogeneity measured between the derived cell lines does not significantly change when sampling different fractions of cells for the two samples (Supplementary Material: Supplementary Methods 2 and 3, Supplementary Figures 3, 4, 5 and 6).</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Conclusion</title>
    <p id="Par80">In this work we presented PhyliCS, a flexible and user-friendly package which allows to process scCNA calls and evaluate spatial ITH through the Spatial Heterogeneity Score. This score combines the high resolution of scDNA sequencing data and the information provided by multi-regional sampling to indicate how much different sets of cells have diverged in their CN landscapes, allowing to get fast and easy-to-interpret information about a single tumor.</p>
    <p id="Par81">PhyliCS has been implemented as a modular and flexible Python library, with many functionalities, which guides bioinformaticians who want to explore their datasets to use a single API specific for scDNA and tailored to its analysis.</p>
    <p id="Par82">We have tested the SHscore in different scenarios. First, we computed it on 200 synthetic datasets to study its behaviour in four different scenarios (spatial segregation, spatial intermixing, early metastasis spreading and late metastasis spreading). Results obtained on this set of simulations show that SHscore correctly reflects the heterogeneity in the clonal composition of multiple samples, and can therefore be used to reliably compare the heterogeneity of real tumors with different spatial samplings available. After that, we tested the SHscore on a set of 100 simulations, which were generated by randomly varying the mean CNA size and the mean number of gained copies, and found out that the score is not correlated to such structural features of the CN profiles. We conducted a more extensive simulation experiment, generating two big cell-division trees, to produce datasets with a significant evolutionary history. We got evidence that the SHscore is strongly correlated to the distance between the copy-number states which generated the cells of the samples in analysis. This confirmed that the SHscore captures the evolutionary history of the tumor subsamples. We used our score to analyze three real scDNA datasets, reaching conclusions in agreement with state of the art phylogenetic approaches [<xref ref-type="bibr" rid="CR39">39</xref>] and the original papers [<xref ref-type="bibr" rid="CR55">55</xref>, <xref ref-type="bibr" rid="CR58">58</xref>] that presented them. Finally we conducted a downsampling experiment on two cell line data to demonstrate that the SHscore is robust to sample cardinality and may be used in on unbalanced sets.</p>
    <p id="Par83">We have also demonstrated some of the analytical functionalities of the library, which allow the user to seamlessly perform tasks, which would generally require using different libraries and managing data flow between them.</p>
    <p id="Par84">We believe that trying to define clinically relevant thresholds for the SHscore is premature. Indeed, large cohorts of clinically annotated single-cell datasets, from patients affected by different tumors, would be required to correlate the evolutionary features of each tumor with its clinical characteristics and subsequently define thresholds to discriminate between “spatially segregated” and “spatially well-mixed” scenarios of of clinical relevance. Unfortunately, such single-cell DNA datasets are not yet available. However, from our extended simulation study, we got the evidence that a score lower than 0.2 indicates that the subclones are well-mixed in the tumor sample or that they are segregated in space, but spatial differences are so small that the tumor may be considered homogeneous. A score greater or equal to 0.2, instead suggests that different regions of the same tumors are separated by a non-negligible evolutionary distance which made them quite different and this should be considered for eventual further analyses.</p>
    <p id="Par85">One of the current limitations of PhyliCS is that all its results regarding evolutionary distances are derived from samples relationships and clustering based metrics. We opted for this approach in order to draw conclusions that, albeit simplistic, are based on less assumptions on the mechanisms driving CN accumulation, than the ones needed to perform phylogenetic reconstruction. Being the infinite site assumption not valid for CNs we think that phylogenetic reconstruction is still an open issue for single cell data; but we foresee that in the future there will be more reliable methods to call SNVs on single cells, opening new avenues to exploit the theoretical knowledge built upon bulk sequencing.</p>
    <p id="Par86">In summary, PhyliCS represents a valuable instrument to explore the extent of spatial heterogeneity in multi-regional tumour sampling, exploiting the potential of scCNA data.</p>
    <p id="Par87">In the future, scDNA sequencing should gain popularity, and more data will be available on public repositories; at that point, we would like to test and improve our score on large scale datasets. Additionally, it will be interesting to integrate different single cell measurements, such as ATACseq or scRNA, to extend its capabilities. The choice to develop a library should ease future endeavours in this direction.</p>
  </sec>
  <sec id="Sec18">
    <title>Availability and requirements</title>
    <p id="Par88">Project name: PhyliCS</p>
    <p id="Par89">Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/bioinformatics-polito/PhyliCS">https://github.com/bioinformatics-polito/PhyliCS</ext-link></p>
    <p id="Par90">Operating systems: GNU/Linux, MacOS and Windows</p>
    <p id="Par91">Programming language: Python</p>
    <p id="Par92">Other requirements: gcc to install HDBSCAN Python library</p>
    <p id="Par93">Licence: GNU Affero General Public License v3 (AGPL3)</p>
    <p id="Par94">Any restrictions to use by non-academics: None</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec19">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4277_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary Material containing the supplementary figures and methods cited in the main text.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>ITH</term>
        <def>
          <p id="Par4">Intra-tumor heterogeneity</p>
        </def>
      </def-item>
      <def-item>
        <term>scDNA</term>
        <def>
          <p id="Par5">Single-cell DNA</p>
        </def>
      </def-item>
      <def-item>
        <term>CNA</term>
        <def>
          <p id="Par6">Copy-number aberration</p>
        </def>
      </def-item>
      <def-item>
        <term>scCNA</term>
        <def>
          <p id="Par7">Single-cell copy-number aberration</p>
        </def>
      </def-item>
      <def-item>
        <term>scDNA-seq</term>
        <def>
          <p id="Par8">Single-cell DNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>SHscore</term>
        <def>
          <p id="Par9">Spatial-Heterogeneity score</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Computational resources were provided by HPC@POLITO, a project of Academic Computing within the Department of Control and Computer Engineering at the Politecnico di Torino (<ext-link ext-link-type="uri" xlink:href="http://www.hpc.polito.it">http://www.hpc.polito.it</ext-link>).</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>MM implemented PhyliCS; MM perfomed the tests with major contributions from EG, GU and AB; MM wrote the publication with major contributions from EG, GU and AB; CGP and AB supervised the biological side of the publication; AB and EF designed and supervised the project. All authors reviewed, read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work has been supported by the SmartData@PoliTO center on Big Data and Data Science, the AIRC 5x1000 Grant (21091) and the European Research Council Consolidator Grant (724748 - BEAT). None of the funding bodies participated in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>PhyliCS is distributed via PyPI (<ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/phylics/">https://pypi.org/project/phylics/</ext-link>) and Bioconda (<ext-link ext-link-type="uri" xlink:href="https://anaconda.org/bioconda/phylics">https://anaconda.org/bioconda/phylics</ext-link>).</p>
    <p>Its source code and a minimal documentation are available on GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/bioinformatics-polito/PhyliCS">https://github.com/bioinformatics-polito/PhyliCS</ext-link>.</p>
    <p>Data and results discussed in the paper are all stored in a dedicated repository and summarized by means of jupyter notebooks accessible through: <ext-link ext-link-type="uri" xlink:href="https://github.com/bioinformatics-polito/PhyliCS_usage">https://github.com/bioinformatics-polito/PhyliCS_usage</ext-link>.</p>
    <p>The datasets used in benchmarks have been obtained by simulations.</p>
    <p>The datasets used in demostrations are publicly available on 10x Genomics (<ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-dna/datasets">https://support.10xgenomics.com/single-cell-dna/datasets</ext-link>), Ginkgo (<ext-link ext-link-type="uri" xlink:href="http://qb.cshl.edu/ginkgo/%3Fq=/igjlK8I6pGAWvGWeqS9P">http://qb.cshl.edu/ginkgo/?q=/igjlK8I6pGAWvGWeqS9P</ext-link>) websites and on NCBI Sequence Read Archive(PRJNA629885).</p>
    <p>SCtools source code is available on Github at <ext-link ext-link-type="uri" xlink:href="https://github.com/bioinformatics-polito/SCTools">https://github.com/bioinformatics-polito/SCTools</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par95">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par96">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par97">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nowell</surname>
            <given-names>PC</given-names>
          </name>
        </person-group>
        <article-title>The clonal evolution of tumor cell populations</article-title>
        <source>Science</source>
        <year>1976</year>
        <volume>194</volume>
        <issue>4260</issue>
        <fpage>23</fpage>
        <lpage>28</lpage>
        <pub-id pub-id-type="doi">10.1126/science.959840</pub-id>
        <?supplied-pmid 959840?>
        <pub-id pub-id-type="pmid">959840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Greaves</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Maley</surname>
            <given-names>CC</given-names>
          </name>
        </person-group>
        <article-title>Clonal evolution in cancer</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>481</volume>
        <issue>7381</issue>
        <fpage>306</fpage>
        <lpage>313</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10762</pub-id>
        <?supplied-pmid 22258609?>
        <pub-id pub-id-type="pmid">22258609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerlinger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Swanton</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>How Darwinian models inform therapeutic failure initiated by clonal heterogeneity in cancer medicine</article-title>
        <source>Brit J Cancer</source>
        <year>2010</year>
        <volume>103</volume>
        <issue>8</issue>
        <fpage>1139</fpage>
        <lpage>1143</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.bjc.6605912</pub-id>
        <?supplied-pmid 20877357?>
        <pub-id pub-id-type="pmid">20877357</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yap</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Gerlinger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Futreal</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Pusztai</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Swanton</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Intratumor heterogeneity: seeing the wood for the trees</article-title>
        <source>Sci Trans Med</source>
        <year>2012</year>
        <volume>4</volume>
        <issue>127</issue>
        <fpage>127ps10</fpage>
        <lpage>127ps10</lpage>
        <pub-id pub-id-type="doi">10.1126/scitranslmed.3003854</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fisher</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pusztai</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Swanton</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Cancer heterogeneity: implications for targeted therapeutics</article-title>
        <source>Brit J Cancer</source>
        <year>2013</year>
        <volume>108</volume>
        <issue>3</issue>
        <fpage>479</fpage>
        <lpage>485</lpage>
        <pub-id pub-id-type="doi">10.1038/bjc.2012.581</pub-id>
        <?supplied-pmid 23299535?>
        <pub-id pub-id-type="pmid">23299535</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Burrell</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Swanton</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Tumour heterogeneity and the evolution of polyclonal drug resistance</article-title>
        <source>Mol Oncol</source>
        <year>2014</year>
        <volume>8</volume>
        <issue>6</issue>
        <fpage>1095</fpage>
        <lpage>1111</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molonc.2014.06.005</pub-id>
        <?supplied-pmid 25087573?>
        <pub-id pub-id-type="pmid">25087573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Maley</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Galipeau</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Finley</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Wongsurawat</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Sanchez</surname>
            <given-names>CA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Genetic clonal diversity predicts progression to esophageal adenocarcinoma</article-title>
        <source>Nat Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <issue>4</issue>
        <fpage>468</fpage>
        <lpage>473</lpage>
        <pub-id pub-id-type="doi">10.1038/ng1768</pub-id>
        <?supplied-pmid 16565718?>
        <pub-id pub-id-type="pmid">16565718</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ding</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ley</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Larson</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Koboldt</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>JS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clonal evolution in relapsed acute myeloid leukaemia revealed by whole-genome sequencing</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>481</volume>
        <issue>7382</issue>
        <fpage>506</fpage>
        <lpage>510</lpage>
        <pub-id pub-id-type="doi">10.1038/nature10738</pub-id>
        <?supplied-pmid 22237025?>
        <pub-id pub-id-type="pmid">22237025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ulintz</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Guan</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>FastClone is a probabilistic tool for deconvoluting tumor heterogeneity in bulk-sequencing samples</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-13993-7</pub-id>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schröder</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hsu</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Boyle</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Macintyre</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Cmero</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tothill</surname>
            <given-names>RW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Socrates: identification of genomic rearrangements in tumour genomes by re-aligning soft clipped reads</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>8</issue>
        <fpage>1064</fpage>
        <lpage>1072</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt767</pub-id>
        <?supplied-pmid 24389656?>
        <pub-id pub-id-type="pmid">24389656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Strino</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Parisi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Micsinai</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kluger</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>TrAp: a tree approach for fingerprinting subclonal tumor composition</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>17</issue>
        <fpage>e165</fpage>
        <lpage>e165</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt641</pub-id>
        <?supplied-pmid 23892400?>
        <pub-id pub-id-type="pmid">23892400</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiao</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Vembu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Deshwar</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Inferring clonal evolution of tumors from single nucleotide somatic mutations</article-title>
        <source>BMC Bioinform</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-15-35</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwarz</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Trinh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sipos</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Brenton</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Goldman</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Markowetz</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Phylogenetic quantification of intra-tumour heterogeneity</article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>4</issue>
        <fpage>e1003535</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003535</pub-id>
        <?supplied-pmid 24743184?>
        <pub-id pub-id-type="pmid">24743184</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deshwar</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Vembu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yung</surname>
            <given-names>CK</given-names>
          </name>
          <name>
            <surname>Jang</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>PhyloWGS: reconstructing subclonal composition and evolution from whole-genome sequencing of tumors</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0602-8</pub-id>
        <pub-id pub-id-type="pmid">25583448</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sakoparnig</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Markowetz</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>BitPhylogeny: a probabilistic framework for reconstructing intra-tumor phylogenies</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>16</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0592-6</pub-id>
        <pub-id pub-id-type="pmid">25583448</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eaton</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Deconvolution and phylogeny inference of structural variations in tumor genomic samples</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>13</issue>
        <fpage>i357</fpage>
        <lpage>i365</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty270</pub-id>
        <?supplied-pmid 29950001?>
        <pub-id pub-id-type="pmid">29950001</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Urrutia</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>NR</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Integrative pipeline for profiling DNA copy number and inferring tumor phylogeny</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>12</issue>
        <fpage>2126</fpage>
        <lpage>2128</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty057</pub-id>
        <?supplied-pmid 29415173?>
        <pub-id pub-id-type="pmid">29415173</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malikic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuipers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sahinalp</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Integrative inference of subclonal tumour evolution from single-cell and bulk sequencing data</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-10737-5</pub-id>
        <pub-id pub-id-type="pmid">30602773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>An algorithm to quantify intratumor heterogeneity based on alterations of gene expression profiles</article-title>
        <source>Commun Biol</source>
        <year>2020</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1038/s42003-019-0734-6</pub-id>
        <?supplied-pmid 31925316?>
        <pub-id pub-id-type="pmid">31925316</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Norton</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Advani</surname>
            <given-names>PP</given-names>
          </name>
          <name>
            <surname>Serie</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Geiger</surname>
            <given-names>XJ</given-names>
          </name>
          <name>
            <surname>Necela</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Axenfeld</surname>
            <given-names>BC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Assessment of tumor heterogeneity, as evidenced by gene expression profiles, pathway activation, and gene copy number, in patients with multifocal invasive lobular breast tumors</article-title>
        <source>PLoS ONE</source>
        <year>2016</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>e0153411</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0153411</pub-id>
        <?supplied-pmid 27078887?>
        <pub-id pub-id-type="pmid">27078887</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>WC</given-names>
          </name>
          <name>
            <surname>Diao</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Roarty</surname>
            <given-names>EB</given-names>
          </name>
          <name>
            <surname>Varghese</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiregion gene expression profiling reveals heterogeneity in molecular subtypes and immunotherapy response signatures in lung cancer</article-title>
        <source>Mod Pathol</source>
        <year>2018</year>
        <volume>31</volume>
        <issue>6</issue>
        <fpage>947</fpage>
        <lpage>955</lpage>
        <pub-id pub-id-type="doi">10.1038/s41379-018-0029-3</pub-id>
        <?supplied-pmid 29410488?>
        <pub-id pub-id-type="pmid">29410488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nam</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Measuring intratumor heterogeneity by network entropy using RNA-seq data</article-title>
        <source>Sci Rep</source>
        <year>2016</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-016-0001-8</pub-id>
        <pub-id pub-id-type="pmid">28442746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zaccaria</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Accurate quantification of copy-number aberrations and whole-genome duplications in multi-sample tumor sequencing data</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-17967-y</pub-id>
        <pub-id pub-id-type="pmid">31911652</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manica</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>HR</given-names>
          </name>
          <name>
            <surname>Mathis</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chouvarine</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rutishauser</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Roditi</surname>
            <given-names>LDV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inferring clonal composition from multiple tumor biopsies</article-title>
        <source>NPJ Syst Biol Appl</source>
        <year>2020</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>13</lpage>
        <pub-id pub-id-type="doi">10.1038/s41540-020-00147-5</pub-id>
        <pub-id pub-id-type="pmid">32001719</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Khattra</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yap</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Biele</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PyClone: statistical inference of clonal population structure in cancer</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>4</issue>
        <fpage>396</fpage>
        <lpage>398</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2883</pub-id>
        <?supplied-pmid 24633410?>
        <pub-id pub-id-type="pmid">24633410</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miller</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Dees</surname>
            <given-names>ND</given-names>
          </name>
          <name>
            <surname>Griffith</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Welch</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Griffith</surname>
            <given-names>OL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SciClone: inferring clonal architecture and tracking the spatial and temporal patterns of tumor evolution</article-title>
        <source>PLoS Comput Biol</source>
        <year>2014</year>
        <volume>10</volume>
        <issue>8</issue>
        <fpage>e1003665</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1003665</pub-id>
        <?supplied-pmid 25102416?>
        <pub-id pub-id-type="pmid">25102416</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nieboer</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Dorssers</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Straver</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Looijenga</surname>
            <given-names>LH</given-names>
          </name>
          <name>
            <surname>de Ridder</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>TargetClone: a multi-sample approach for reconstructing subclonal evolution of tumors</article-title>
        <source>PLoS ONE</source>
        <year>2018</year>
        <volume>13</volume>
        <issue>11</issue>
        <fpage>e0208002</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0208002</pub-id>
        <?supplied-pmid 30496231?>
        <pub-id pub-id-type="pmid">30496231</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dagogo-Jack</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Shaw</surname>
            <given-names>AT</given-names>
          </name>
        </person-group>
        <article-title>Tumour heterogeneity and resistance to cancer therapies</article-title>
        <source>Nat Rev Clin Oncol</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>81</fpage>
        <pub-id pub-id-type="doi">10.1038/nrclinonc.2017.166</pub-id>
        <?supplied-pmid 29115304?>
        <pub-id pub-id-type="pmid">29115304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jamal-Hanjani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wilson</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>McGranahan</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Birkbak</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Watkins</surname>
            <given-names>TB</given-names>
          </name>
          <name>
            <surname>Veeriah</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tracking the evolution of non-small-cell lung cancer</article-title>
        <source>N Engl J Med</source>
        <year>2017</year>
        <volume>376</volume>
        <issue>22</issue>
        <fpage>2109</fpage>
        <lpage>2121</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa1616288</pub-id>
        <?supplied-pmid 28445112?>
        <pub-id pub-id-type="pmid">28445112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Navin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Kendall</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Troge</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rodgers</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>McIndoo</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tumour evolution inferred by single-cell sequencing</article-title>
        <source>Nature.</source>
        <year>2011</year>
        <volume>472</volume>
        <issue>7341</issue>
        <fpage>90</fpage>
        <pub-id pub-id-type="doi">10.1038/nature09807</pub-id>
        <?supplied-pmid 21399628?>
        <pub-id pub-id-type="pmid">21399628</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Andor N, Lau BT, Catalanotti C, Kumar V, Sathe A, Belhocine K, et al. Joint single cell DNA-Seq and RNA-Seq of gastric cancer reveals subclonal signatures of genomic instability and gene expression. BioRxiv. 2020; p. 445932.</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zahn</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Steif</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Eirew</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>VanInsberghe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>SP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Scalable whole-genome single-cell library preparation without preamplification</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>2</issue>
        <fpage>167</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4140</pub-id>
        <?supplied-pmid 28068316?>
        <pub-id pub-id-type="pmid">28068316</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Zahn</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Steif</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brimhall</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clonal decomposition and DNA replication states defined by scaled single-cell genome sequencing</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>179</volume>
        <issue>5</issue>
        <fpage>1207</fpage>
        <lpage>1221</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.10.026</pub-id>
        <?supplied-pmid 31730858?>
        <pub-id pub-id-type="pmid">31730858</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garvin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Aboukhalil</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kendall</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Baslan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Atwal</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Hicks</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Interactive analysis and assessment of single-cell copy-number variations</article-title>
        <source>Nat Methods</source>
        <year>2015</year>
        <volume>12</volume>
        <issue>11</issue>
        <fpage>1058</fpage>
        <lpage>1060</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3578</pub-id>
        <?supplied-pmid 26344043?>
        <pub-id pub-id-type="pmid">26344043</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bakker</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Taudt</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Belderbos</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Porubsky</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Spierings</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>de Jong</surname>
            <given-names>TV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell sequencing reveals karyotype heterogeneity in murine and human malignancies</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-0971-7</pub-id>
        <pub-id pub-id-type="pmid">26753840</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>NR</given-names>
          </name>
        </person-group>
        <article-title>DNA copy number profiling using single-cell sequencing</article-title>
        <source>Brief Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>5</issue>
        <fpage>731</fpage>
        <lpage>736</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbx004</pub-id>
        <?supplied-pmid 28159966?>
        <pub-id pub-id-type="pmid">28159966</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vijg</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>SCCNV: a software tool for identifying copy number variation from single-cell whole-genome sequencing</article-title>
        <source>Front Genet</source>
        <year>2020</year>
        <volume>8</volume>
        <fpage>11</fpage>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>DY</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>SCOPE: a normalization and copy-number estimation method for single-cell DNA sequencing</article-title>
        <source>Cell Syst</source>
        <year>2020</year>
        <volume>10</volume>
        <issue>5</issue>
        <fpage>445</fpage>
        <lpage>452</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2020.03.005</pub-id>
        <?supplied-pmid 32437686?>
        <pub-id pub-id-type="pmid">32437686</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zaccaria</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Characterizing allele-and haplotype-specific copy numbers in single cells with CHISEL</article-title>
        <source>Nat Biotechnol</source>
        <year>2020</year>
        <volume>66</volume>
        <fpage>1</fpage>
        <lpage>8</lpage>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frey</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Dueck</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Clustering by passing messages between data points</article-title>
        <source>Science</source>
        <year>2007</year>
        <volume>315</volume>
        <issue>5814</issue>
        <fpage>972</fpage>
        <lpage>976</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1136800</pub-id>
        <?supplied-pmid 17218491?>
        <pub-id pub-id-type="pmid">17218491</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Ramakrishnan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Livny</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>BIRCH: an efficient data clustering method for very large databases</article-title>
        <source>ACM Sigmod Rec</source>
        <year>1996</year>
        <volume>25</volume>
        <issue>2</issue>
        <fpage>103</fpage>
        <lpage>114</lpage>
        <pub-id pub-id-type="doi">10.1145/235968.233324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Ester M, Kriegel HP, Sander J, Xu X, et al. A density-based algorithm for discovering clusters in large spatial databases with noise. In: Kdd. vol. 96; 1996. p. 226–31.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">McInnes L, Healy J. Accelerated hierarchical density based clustering. In: 2017 IEEE international conference on data mining workshops (ICDMW). IEEE; 2017. p. 33–42.</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical clustering schemes</article-title>
        <source>Psychometrika</source>
        <year>1967</year>
        <volume>32</volume>
        <issue>3</issue>
        <fpage>241</fpage>
        <lpage>254</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02289588</pub-id>
        <?supplied-pmid 5234703?>
        <pub-id pub-id-type="pmid">5234703</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <mixed-citation publication-type="other">MacQueen J, et al. Some methods for classification and analysis of multivariate observations. In: Proceedings of the fifth Berkeley symposium on mathematical statistics and probability. vol. 1. Oakland, CA, USA; 1967. p. 281–97.</mixed-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ankerst</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Breunig</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Kriegel</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>OPTICS: ordering points to identify the clustering structure</article-title>
        <source>ACM Sigmod Rec</source>
        <year>1999</year>
        <volume>28</volume>
        <issue>2</issue>
        <fpage>49</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1145/304181.304187</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ng</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Weiss</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>On spectral clustering: analysis and an algorithm</article-title>
        <source>Adv Neural Inf Process Syst</source>
        <year>2002</year>
        <volume>2</volume>
        <fpage>849</fpage>
        <lpage>856</lpage>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J Comput Appl Math</source>
        <year>1987</year>
        <volume>20</volume>
        <fpage>53</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/0377-0427(87)90125-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">Beyer K, Goldstein J, Ramakrishnan R, Shaft U. When is “nearest neighbor” meaningful? In: International conference on database theory. Springer; 1999. p. 217–35.</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <mixed-citation publication-type="other">Aggarwal CC, Hinneburg A, Keim DA. On the surprising behavior of distance metrics in high dimensional space. In: International conference on database theory. Springer; 2001. p. 420–34.</mixed-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mallory</surname>
            <given-names>XF</given-names>
          </name>
          <name>
            <surname>Edrisi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Assessing the performance of methods for copy number aberration detection from single-cell DNA sequencing data</article-title>
        <source>PLoS Comput Biol</source>
        <year>2020</year>
        <volume>16</volume>
        <issue>7</issue>
        <fpage>e1008012</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008012</pub-id>
        <?supplied-pmid 32658894?>
        <pub-id pub-id-type="pmid">32658894</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blum</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>François</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Which random processes describe the tree of life? A large-scale study of phylogenetic tree imbalance</article-title>
        <source>Syst Biol</source>
        <year>2006</year>
        <volume>55</volume>
        <issue>4</issue>
        <fpage>685</fpage>
        <lpage>691</lpage>
        <pub-id pub-id-type="doi">10.1080/10635150600889625</pub-id>
        <?supplied-pmid 16969944?>
        <pub-id pub-id-type="pmid">16969944</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <mixed-citation publication-type="other">10x Genomics. 10x Genomics: Biology at True Resolution; 2019. <ext-link ext-link-type="uri" xlink:href="https://www.10xgenomics.com">https://www.10xgenomics.com</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dadi</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Ehrhardt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hauswedell</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Mehringer</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rahn</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The SeqAn C++ template library for efficient sequence analysis: a resource for programmers</article-title>
        <source>J Biotechnol</source>
        <year>2017</year>
        <volume>261</volume>
        <fpage>157</fpage>
        <lpage>168</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jbiotec.2017.07.017</pub-id>
        <?supplied-pmid 28888961?>
        <pub-id pub-id-type="pmid">28888961</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Navin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Krasnitz</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rodgers</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Cook</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Meth</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kendall</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inferring tumor progression from genomic heterogeneity</article-title>
        <source>Genome Res</source>
        <year>2010</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>68</fpage>
        <lpage>80</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.099622.109</pub-id>
        <?supplied-pmid 19903760?>
        <pub-id pub-id-type="pmid">19903760</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leung</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Casasent</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sei</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell DNA sequencing reveals a late-dissemination model in metastatic colorectal cancer</article-title>
        <source>Genome Res</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>8</issue>
        <fpage>1287</fpage>
        <lpage>1299</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.209973.116</pub-id>
        <?supplied-pmid 28546418?>
        <pub-id pub-id-type="pmid">28546418</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawson</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Kessenbrock</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>Pervolarakis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Werb</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Tumour heterogeneity and metastasis at single-cell resolution</article-title>
        <source>Nat Cell Biol</source>
        <year>2018</year>
        <volume>20</volume>
        <issue>12</issue>
        <fpage>1349</fpage>
        <lpage>1360</lpage>
        <pub-id pub-id-type="doi">10.1038/s41556-018-0236-7</pub-id>
        <?supplied-pmid 30482943?>
        <pub-id pub-id-type="pmid">30482943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Minussi</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Nicholson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Baker</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Breast tumours maintain a reservoir of subclonal diversity during expansion</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>592</volume>
        <issue>7853</issue>
        <fpage>302</fpage>
        <lpage>308</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03357-x</pub-id>
        <?supplied-pmid 33762732?>
        <pub-id pub-id-type="pmid">33762732</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
