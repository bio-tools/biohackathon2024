<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genetics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">genetics</journal-id>
    <journal-title-group>
      <journal-title>Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0016-6731</issn>
    <issn pub-type="epub">1943-2631</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>US</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9991502</article-id>
    <article-id pub-id-type="pmid">36529897</article-id>
    <article-id pub-id-type="doi">10.1093/genetics/iyac183</article-id>
    <article-id pub-id-type="publisher-id">iyac183</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Investigation</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01180</subject>
        <subject>AcademicSubjects/SCI01140</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Mega-scale Bayesian regression methods for genome-wide prediction and association studies with thousands of traits</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Qu</surname>
          <given-names>Jiayi</given-names>
        </name>
        <aff><institution>Department of Animal Science, University of California Davis</institution>, <addr-line>Davis, CA 95616</addr-line>, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3008-9312</contrib-id>
        <name>
          <surname>Runcie</surname>
          <given-names>Daniel</given-names>
        </name>
        <aff><institution>Department of Plant Sciences, University of California Davis</institution>, <addr-line>Davis, CA 95616</addr-line>, <country country="US">USA</country></aff>
        <xref rid="iyac183-cor1" ref-type="corresp"/>
        <!--deruncie@ucdavis.edu-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Cheng</surname>
          <given-names>Hao</given-names>
        </name>
        <aff><institution>Department of Plant Sciences, University of California Davis</institution>, <addr-line>Davis, CA 95616</addr-line>, <country country="US">USA</country></aff>
        <xref rid="iyac183-cor2" ref-type="corresp"/>
        <!--qtlcheng@ucdavis.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Endelman</surname>
          <given-names>J</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="iyac183-cor1">Corresponding author: Department of Plant Sciences, University of California Davis, 1 Shield Ave., Davis, CA 95616, USA. Email: <email>deruncie@ucdavis.edu</email></corresp>
      <corresp id="iyac183-cor2">Corresponding author: Department of Animal Science, University of California Davis, 1 Shield Ave., Davis, CA 95616, USA. Email: <email>qtlcheng@ucdavis.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-12-19">
      <day>19</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>223</volume>
    <issue>3</issue>
    <elocation-id>iyac183</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>23</day>
        <month>1</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press on behalf of the Genetics Society of America.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="iyac183.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Large-scale phenotype data are expected to increase the accuracy of genome-wide prediction and the power of genome-wide association analyses. However, genomic analyses of high-dimensional, highly correlated traits are challenging. We developed a method for implementing high-dimensional Bayesian multivariate regression to simultaneously analyze genetic variants underlying thousands of traits. As a demonstration, we implemented the BayesC prior in the R package <monospace>MegaLMM</monospace>. Applied to Genomic Prediction, <monospace>MegaBayesC</monospace> effectively integrated hyperspectral reflectance data from 620 hyperspectral wavelengths to improve the accuracy of genetic value prediction on grain yield in a wheat dataset. Applied to Genome-Wide Association Studies, we used simulations to show that <monospace>MegaBayesC</monospace> can accurately estimate the effect sizes of QTL across a range of genetic architectures and causes of correlations among traits. To apply <monospace>MegaBayesC</monospace> to a realistic scenario involving whole-genome marker data, we developed a 2-stage procedure involving a preliminary step of candidate marker selection prior to multivariate regression. We then used <monospace>MegaBayesC</monospace> to identify genetic associations with flowering time in <italic toggle="yes">Arabidopsis thaliana</italic>, leveraging expression data from 20,843 genes. <monospace>MegaBayesC</monospace> selected 15 single nucleotide polymorphisms as important for flowering time, with 13 located within 100 kb of known flowering-time related genes, a higher validation rate than achieved by a single-stage analysis using only the flowering time data itself. These results demonstrate that <monospace>MegaBayesC</monospace> can efficiently and effectively leverage high-dimensional phenotypes in genetic analyses.</p>
    </abstract>
    <kwd-group>
      <kwd>multi-trait</kwd>
      <kwd>genomic prediction</kwd>
      <kwd>genome-wide association studies</kwd>
      <kwd>high-throughput phenotyping</kwd>
      <kwd>Bayesian regression models</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>United States Department of Agriculture (USDA) NIFA</institution>
            <institution-id institution-id-type="doi">10.13039/100000199</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2020-67013-30904</award-id>
        <award-id>2018-67015-27957</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="iyac183-s0">
    <title>Introduction</title>
    <p>The advent of high density genome-wide single nucleotide polymorphism (SNP) arrays in the past decades has provided exciting new material for the genetic analysis of complex traits. Linear mixed models that can integrate such large-scale genomic data are widely used for genomic prediction (<xref rid="iyac183-B24" ref-type="bibr">Meuwissen <italic toggle="yes">et al.</italic> 2001</xref>; <xref rid="iyac183-B34" ref-type="bibr">VanRaden 2008</xref>) and genome-wide association studies (<xref rid="iyac183-B36" ref-type="bibr">Visscher <italic toggle="yes">et al.</italic> 2017</xref>). Recent advance in multi-omics methodologies now provide opportunities to generate large-scale transcriptomic, metabolomic, and epigenomic profiles as well. The integration of these high-dimensional phenotypes into association studies can increase power to detect causal variants. For example, gene expression profiling in thousands of genes has been used for the identification of genes that affect transcriptional variation (i.e. eQTLs) (<xref rid="iyac183-B15" ref-type="bibr">Gibson and Weir 2005</xref>; <xref rid="iyac183-B22" ref-type="bibr">McGraw <italic toggle="yes">et al.</italic> 2011</xref>), and integrative approaches combining genomic and gene expression data can have higher power to capture the true pathway associations underlying human diseases and complex traits (<xref rid="iyac183-B39" ref-type="bibr">Xiong <italic toggle="yes">et al.</italic> 2012</xref>). In addition, recent developments of high-throughput phenotyping platforms have made the collection of thousands to millions of physiological measurements affordable to breeders (<xref rid="iyac183-B2" ref-type="bibr">Araus <italic toggle="yes">et al.</italic> 2018</xref>). For example, images collected through thermal and hyperspectral cameras are used to increase the accuracy in genomic prediction for grain yield in wheat (<xref rid="iyac183-B32" ref-type="bibr">Rutkoski <italic toggle="yes">et al.</italic> 2016</xref>). To further improve genomic prediction and to understand the underlying genetic mechanism, statistical models that enable the joint analysis of high-dimensional traits are required to establish the connection between phenomics and genomics.</p>
    <p>Genomic analyses of high-dimensional, highly correlated data present analytic and computational challenges. The multivariate linear mixed model (MvLMM) is a widely used statistical model for the genetic analyses of 2 or more correlated traits (<xref rid="iyac183-B18" ref-type="bibr">Henderson and Quaas 1976</xref>). However, most algorithms used to fit MvLMMs require repeated inversions of genetic and residual covariance matrices among all traits, with a computational burden that grows cubically to quintically as the number of traits increases (<xref rid="iyac183-B41" ref-type="bibr">Zhou and Stephens 2014</xref>). MvLMMs are also susceptible to over-fitting unless sample sizes are very large. Re-parameterizing MvLMMs as Bayesian sparse factor models can alleviate much of this computational burden (<xref rid="iyac183-B30" ref-type="bibr">Runcie and Mukherjee 2013</xref>; <xref rid="iyac183-B31" ref-type="bibr">Runcie <italic toggle="yes">et al.</italic> 2021</xref>) and can significantly improve the accuracy of genomic prediction (<xref rid="iyac183-B31" ref-type="bibr">Runcie <italic toggle="yes">et al.</italic> 2021</xref>). <monospace>BSFG</monospace> and <monospace>MegaLMM</monospace> are based on the assumption that the covariances among large sets of traits can be explained by a small set of latent factors (e.g. through gene regulatory networks), which is consistent with the discovery that variation in gene expressions of human diseases is mainly regulated by a few major disease-associated pathways (<xref rid="iyac183-B39" ref-type="bibr">Xiong <italic toggle="yes">et al.</italic> 2012</xref>).</p>
    <p>While <monospace>MegaLMM</monospace> addressed the statistical and computational challenges of applying MvLMMs to high-dimensional phenotypes, it permits a limited range of models for high-dimensional genotype data. Specifically, <monospace>MegaLMM</monospace> incorporates genomic data through 1 (or more) genomic relationship matrices, which imposes specific assumptions about the distribution and effect sizes of the underlying genetic variants, and does not allow direct inference on the identities of causal loci. Whole-genome regression methods (<xref rid="iyac183-B24" ref-type="bibr">Meuwissen <italic toggle="yes">et al.</italic> 2001</xref>; <xref rid="iyac183-B26" ref-type="bibr">Park and Casella 2008</xref>; <xref rid="iyac183-B19" ref-type="bibr">Kizilkaya <italic toggle="yes">et al.</italic> 2010</xref>; <xref rid="iyac183-B17" ref-type="bibr">Habier <italic toggle="yes">et al.</italic> 2011</xref>; <xref rid="iyac183-B12" ref-type="bibr">Erbe <italic toggle="yes">et al.</italic> 2012</xref>; <xref rid="iyac183-B10" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="iyac183-B9" ref-type="bibr">Cheng, Kizilkaya, <italic toggle="yes">et al.</italic> 2018</xref>), on the other hand, encode a wide range of different and more flexible distributions on the effect sizes of causal genomic loci and allow for inference of the causal loci themselves. The Bayesian Alphabet methods in particular (<xref rid="iyac183-B14" ref-type="bibr">Gianola <italic toggle="yes">et al.</italic> 2009</xref>; <xref rid="iyac183-B19" ref-type="bibr">Kizilkaya <italic toggle="yes">et al.</italic> 2010</xref>; <xref rid="iyac183-B17" ref-type="bibr">Habier <italic toggle="yes">et al.</italic> 2011</xref>; <xref rid="iyac183-B13" ref-type="bibr">Gianola 2013</xref>; <xref rid="iyac183-B25" ref-type="bibr">Moser <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="iyac183-B38" ref-type="bibr">Wolc <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyac183-B23" ref-type="bibr">Mehrban <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="iyac183-B37" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2020</xref>) use mixture priors on marker effects and are popular genetic models due to their incorporation of biologically meaningful assumptions and the variable selection procedure performed during model fitting. However, fitting Bayesian Alphabet methods to very large numbers of markers can also be computationally demanding even for a single trait, and extensions of these methods to multivariate traits are very limited.</p>
    <p>In this paper, we develop a method for extending the Bayesian Alphabet whole-genome regression approaches to high-dimensional phenotypes using a Bayesian sparse factor model for applications in genome-wide prediction and genome-wide association studies. We focus on implementing the BayesC method in the R package <monospace>MegaLMM</monospace> as an example of a Bayesian Alphabet method (<xref rid="iyac183-B19" ref-type="bibr">Kizilkaya <italic toggle="yes">et al.</italic> 2010</xref>; <xref rid="iyac183-B17" ref-type="bibr">Habier <italic toggle="yes">et al.</italic> 2011</xref>; <xref rid="iyac183-B9" ref-type="bibr">Cheng, Kizilkaya, <italic toggle="yes">et al.</italic> 2018</xref>), but extensions of <monospace>MegaLMM</monospace> to other priors should be straightforward. We call this model <monospace>MegaBayesC</monospace>, which is a specific parameterization and choice of prior distributions within the more general <monospace>MegaLMM</monospace> model family. We show that <monospace>MegaBayesC</monospace> can improve genomic prediction accuracy by leveraging mixture priors on marker effects and information from thousands of traits. In association studies with millions of markers, <monospace>MegaBayesC</monospace> is computationally demanding, but we propose a 2-step approach that can accurately estimate marker effects and improve power for association inference in both simulated and real data studies.</p>
  </sec>
  <sec sec-type="materials|methods" id="iyac183-s1">
    <title>Materials and methods</title>
    <p>In a conventional MvLMM, the genetic and nongenetic correlations among <inline-formula><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> traits are modeled through 1 or more <inline-formula><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula> genetic covariance matrices (<inline-formula><mml:math id="IM3" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula>) and a <inline-formula><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>×</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula> residual covariance matrix (<inline-formula><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">R</mml:mi></mml:mrow></mml:math></inline-formula>), respectively. The computational cost of fitting a MvLMM can be prohibitive when <inline-formula><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> is large due to the difficulty in taking inverses of the covariance matrices (<xref rid="iyac183-B16" ref-type="bibr">Gilmour <italic toggle="yes">et al.</italic> 1995</xref>; <xref rid="iyac183-B40" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2011</xref>; <xref rid="iyac183-B41" ref-type="bibr">Zhou and Stephens 2014</xref>). To overcome the computational challenge and overfitting in conventional MvLMMs, we reparameterized the conventional MvLMM as a factor model, as in <xref rid="iyac183-B31" ref-type="bibr">Runcie <italic toggle="yes">et al.</italic> (2021)</xref>, introducing <inline-formula><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> independent (unobserved) latent factors to account for the covariances among the <inline-formula><mml:math id="IM8" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> traits.</p>
    <sec id="iyac183-s1.1">
      <title>Model description</title>
      <p>In <monospace>MegaLMM</monospace> models, the variation among <inline-formula><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> observed traits is decomposed into 2 parts: the variation caused by dependencies on <inline-formula><mml:math id="IM10" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> independent latent factors, which induces correlations among the <inline-formula><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> observed traits, and the variation that is unique, or idiosyncratic, to each trait. In <monospace>MegaBayesC</monospace>, genetic values of latent factors are defined as a linear combination of marker effects, and BayesC priors (<xref rid="iyac183-B24" ref-type="bibr">Meuwissen <italic toggle="yes">et al.</italic> 2001</xref>; <xref rid="iyac183-B26" ref-type="bibr">Park and Casella 2008</xref>; <xref rid="iyac183-B19" ref-type="bibr">Kizilkaya <italic toggle="yes">et al.</italic> 2010</xref>; <xref rid="iyac183-B17" ref-type="bibr">Habier <italic toggle="yes">et al.</italic> 2011</xref>; <xref rid="iyac183-B12" ref-type="bibr">Erbe <italic toggle="yes">et al.</italic> 2012</xref>; <xref rid="iyac183-B10" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="iyac183-B9" ref-type="bibr">Cheng, Kizilkaya, <italic toggle="yes">et al.</italic> 2018</xref>) are assigned to the marker effects. The model specification of <monospace>MegaBayesC</monospace> is described below<disp-formula id="M0001"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msub></mml:math></disp-formula>with<disp-formula id="M0002"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:math></disp-formula>where <inline-formula><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow></mml:math></inline-formula> is an <inline-formula><mml:math id="IM13" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula> matrix of observations for <inline-formula><mml:math id="IM14" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> individuals on <inline-formula><mml:math id="IM15" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> traits, <inline-formula><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow></mml:math></inline-formula> is an <inline-formula><mml:math id="IM17" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:math></inline-formula> matrix of latent factors for <inline-formula><mml:math id="IM18" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> individuals across <inline-formula><mml:math id="IM19" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> latent factors, and <inline-formula><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> is a <inline-formula><mml:math id="IM21" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula> factor loading matrix whose elements (<inline-formula><mml:math id="IM22" display="inline" overflow="scroll"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) describe factor-trait relationships (e.g. the relationship between factor <inline-formula><mml:math id="IM23" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula> and trait <inline-formula><mml:math id="IM24" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>). The <inline-formula><mml:math id="IM25" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> latent factors in <inline-formula><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow></mml:math></inline-formula> are further decomposed into genetic effects (i.e. <inline-formula><mml:math id="IM27" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and residual effects (i.e. <inline-formula><mml:math id="IM28" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mi>F</mml:mi></mml:msub></mml:math></inline-formula>) as shown in Equation (<xref rid="M0002" ref-type="disp-formula">2</xref>). The genetic effects of latent factors are expressed as multiple regressions on genotype covariates, where <inline-formula><mml:math id="IM29" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is an <inline-formula><mml:math id="IM30" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> matrix of genotype covariates, and <inline-formula><mml:math id="IM31" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a <inline-formula><mml:math id="IM32" display="inline" overflow="scroll"><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:math></inline-formula> matrix of marker effects for the <inline-formula><mml:math id="IM33" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> latent factors at <inline-formula><mml:math id="IM34" display="inline" overflow="scroll"><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> genotyped loci. <inline-formula><mml:math id="IM35" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> is an <inline-formula><mml:math id="IM36" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> incidence matrix allocating the observations on <inline-formula><mml:math id="IM37" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> traits to <inline-formula><mml:math id="IM38" display="inline" overflow="scroll"><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> fixed effects with coefficient matrix <inline-formula><mml:math id="IM39" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>. The residuals are similarly decomposed into trait-specific genetic effects (i.e. <inline-formula><mml:math id="IM40" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and trait-specific residual effects (i.e. <inline-formula><mml:math id="IM41" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>), with <inline-formula><mml:math id="IM42" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> being a <inline-formula><mml:math id="IM43" display="inline" overflow="scroll"><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>t</mml:mi></mml:math></inline-formula> matrix of marker effects corresponding to the <inline-formula><mml:math id="IM44" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> traits at <inline-formula><mml:math id="IM45" display="inline" overflow="scroll"><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> genotyped loci. We expect users to generally choose identical design matrices for <inline-formula><mml:math id="IM46" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM47" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, allowing the same markers to affect the latent factors or trait residuals, but this is not required and we exclude <inline-formula><mml:math id="IM48" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in some applications for computational efficiency.</p>
      <p>If all sources of correlation among observed traits are explained by the latent factors, the residuals conditional on these factors become uncorrelated between different traits. Since the sources of correlation among observed traits are explained by independent latent factors, samples at each iteration of Markov chain Monte Carlo (MCMC) can be obtained simultaneously in parallel across traits and factors, which leads to significant reduction in the computational cost of model fitting.</p>
    </sec>
    <sec id="iyac183-s1.2">
      <title>Prior specification</title>
      <sec id="iyac183-s1.2.1">
        <title>Genetic marker effects</title>
        <p>Mixture priors are widely used for genetic marker effects in Bayesian regression methods in genome-enabled analysis. In this paper, the BayesC prior (<xref rid="iyac183-B17" ref-type="bibr">Habier <italic toggle="yes">et al.</italic> 2011</xref>) is used for the marker effects (e.g. coefficients in <inline-formula><mml:math id="IM49" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>). The BayesC mixture prior assumes that marker effects are independent and identically distributed, each of which has a point mass at zero with a marker exclusion probability <inline-formula><mml:math id="IM50" display="inline" overflow="scroll"><mml:mi>π</mml:mi></mml:math></inline-formula> and follows a univariate normal distribution with a marker inclusion probability <inline-formula><mml:math id="IM51" display="inline" overflow="scroll"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>π</mml:mi></mml:math></inline-formula>. For example, the prior distribution of the marker effect at locus <inline-formula><mml:math id="IM52" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> for the <inline-formula><mml:math id="IM53" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula>th latent factor is shown as follows:<disp-formula id="UM0001"><mml:math id="UM1" display="block" overflow="scroll"><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>F</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>probability</mml:mtext></mml:mstyle><mml:mspace width=".1em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>probability</mml:mtext></mml:mstyle><mml:mspace width=".1em"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula><mml:math id="IM54" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>F</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is the variance of marker effects corresponding to factor <inline-formula><mml:math id="IM55" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula>. Due to the independence among latent factors and the independence among traits conditional on <inline-formula><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula>, marker effects can be efficiently sampled from a set of univariate BayesC models in parallel across traits and factors at each iteration of MCMC. We treat each marker exclusion probability for the <inline-formula><mml:math id="IM57" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> latent factors (e.g. <inline-formula><mml:math id="IM58" display="inline" overflow="scroll"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>) and the <inline-formula><mml:math id="IM59" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> observed traits (<inline-formula><mml:math id="IM60" display="inline" overflow="scroll"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula>) as an independent unknown parameter to be estimated. Note that if marker inclusion probabilities for all factors were set to 1.0 (i.e. all markers are included), the model is equivalent to RR-BLUP, and we term this specific version of <monospace>MegaLMM</monospace>: <monospace>MegaRRBLUP</monospace>.</p>
      </sec>
      <sec id="iyac183-s1.2.2">
        <title>Factor loading matrix</title>
        <p>The factor loading matrix (<inline-formula><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula>) describes the relationship between latent factors and observed traits. Sparsity in this matrix implies that factors affect some, but not all traits, a key assumption in Bayesian sparse factor models (<xref rid="iyac183-B7" ref-type="bibr">Carvalho <italic toggle="yes">et al.</italic> 2008</xref>). We use a BayesC mixture prior for the elements of <inline-formula><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula>. For the factor loading that describes the relationship between factor <inline-formula><mml:math id="IM63" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula> and trait <inline-formula><mml:math id="IM64" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> (i.e. <inline-formula><mml:math id="IM65" display="inline" overflow="scroll"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), its prior distribution is shown as follows:<disp-formula id="M0003"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mtable columnalign="right left" rowspacing=".5em" columnspacing="thickmathspace" displaystyle="true"><mml:mtr><mml:mtd><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>probability</mml:mtext></mml:mstyle><mml:mspace width=".1em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>probability</mml:mtext></mml:mstyle><mml:mspace width=".1em"/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mi>δ</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>δ</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mtd><mml:mtd><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">Gamma</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>δ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>δ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>…</mml:mo><mml:mi>K</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mtd><mml:mtd><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">Inv</mml:mi><mml:mrow><mml:mstyle displaystyle="false" scriptlevel="0"><mml:mtext>-</mml:mtext></mml:mstyle></mml:mrow><mml:mi mathvariant="normal">Gamma</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>σ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>σ</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>The parameter <inline-formula><mml:math id="IM66" display="inline" overflow="scroll"><mml:msub><mml:mi>τ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></inline-formula> stochastically increases from <inline-formula><mml:math id="IM67" display="inline" overflow="scroll"><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>K</mml:mi></mml:math></inline-formula> which has the effect of shrinking all values in the <inline-formula><mml:math id="IM68" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula>th row of <inline-formula><mml:math id="IM69" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> toward zero. This means that all rows with row indices <inline-formula><mml:math id="IM70" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>&gt;</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> for some threshold <inline-formula><mml:math id="IM71" display="inline" overflow="scroll"><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula> will have all values close to zero and contribute a negligible amount to the total covariance. Therefore, as long as we choose <inline-formula><mml:math id="IM72" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>&gt;</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></inline-formula>, the precise value of <inline-formula><mml:math id="IM73" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> is not important (<xref rid="iyac183-B4" ref-type="bibr">Bhattacharya and Dunson 2011</xref>). In each run of <monospace>MegaBayesC</monospace> we check that the values in the last several rows of <inline-formula><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> contain only small values, implying that <inline-formula><mml:math id="IM75" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> is large enough. If this is not the case, we re-start the chain with a greater <inline-formula><mml:math id="IM76" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula>. The only consequence of setting <inline-formula><mml:math id="IM77" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> larger than needed is an increase in the computation time required per iteration.</p>
      </sec>
      <sec id="iyac183-s1.2.3">
        <title>Other parameters</title>
        <p>Prior distributions for all other parameters are the same as used in <xref rid="iyac183-B31" ref-type="bibr">Runcie <italic toggle="yes">et al.</italic> (2021)</xref>.</p>
      </sec>
    </sec>
    <sec id="iyac183-s1.3">
      <title>Gibbs sampler</title>
      <p>We use MCMC to sample from the posterior distributions of all parameters. The full conditional distributions of each Gibbs step are provided in the <xref rid="sup1" ref-type="supplementary-material">Supplementary File</xref>. The values of hyperparameters used for the analyses reported in this paper are provided in the <xref rid="sup1" ref-type="supplementary-material">Supplementary File</xref>. We used trace plots for the 5 largest elements in each of the <inline-formula><mml:math id="IM78" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> factors to assess convergence and ensure that the number of factors (<inline-formula><mml:math id="IM79" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula>) is large enough to capture the covariance among observed traits. We also computed R-hat convergence diagnostics (<xref rid="iyac183-B35" ref-type="bibr">Vehtari <italic toggle="yes">et al.</italic> 2021</xref>) for estimates of the genetic variance of focal trait using 3 MCMC chains. The genetic variance of the focal trait was computed as <inline-formula><mml:math id="IM80" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">λ</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (when <inline-formula><mml:math id="IM81" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was excluded) with <inline-formula><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">λ</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> being the column of <inline-formula><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> that specifies the relationship between factors and focal trait.</p>
    </sec>
    <sec id="iyac183-s1.4">
      <title>Estimation of genetic values for genomic prediction</title>
      <p>We assessed the performance of <monospace>MegaBayesC</monospace> as a tool for genomic prediction using hyperspectral data as additional traits to assist wheat yield prediction.</p>
      <sec id="iyac183-s1.4.1">
        <title>Data description</title>
        <p>Best linear unbiased estimators (BLUEs) of grain yield and reflectances from 62 wavelength bands collected with an areal hyperspectral camera on each of 10 time-points during the growing season for 1,033 bread wheat lines were downloaded from CIMMYT Research Data (<xref rid="iyac183-B20" ref-type="bibr">Krause <italic toggle="yes">et al.</italic> 2019</xref>). We analyzed results from the 2014–2015 breeding cycle under the Optimal Flat treatment. All lines were genotyped using the pipeline described in <xref rid="iyac183-B27" ref-type="bibr">Poland <italic toggle="yes">et al.</italic> (2012)</xref>. Markers with call rate <inline-formula><mml:math id="IM84" display="inline" overflow="scroll"><mml:mo>≤</mml:mo></mml:math></inline-formula>50% and minor allele frequency (MAF) <inline-formula><mml:math id="IM85" display="inline" overflow="scroll"><mml:mo>≤</mml:mo></mml:math></inline-formula>0.05 were removed. Missing genotypes were imputed by corresponding marker means. In our analysis, the 620 hyperspectral BLUEs were used as secondary traits (<xref rid="iyac183-B29" ref-type="bibr">Runcie and Cheng 2019</xref>) to improve the prediction of the genetic value of grain yield, which is served as a focal trait in our prediction scenario. Both sets of traits were combined into a <inline-formula><mml:math id="IM86" display="inline" overflow="scroll"><mml:mn>1033</mml:mn><mml:mo>×</mml:mo><mml:mn>621</mml:mn></mml:math></inline-formula> trait matrix <inline-formula><mml:math id="IM87" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec id="iyac183-s1.4.2">
        <title>Models</title>
        <p>Five different models were used to predict the grain yield (GY): <monospace>GBLUP_K</monospace>, <monospace>GBLUP_KH</monospace>, <monospace>MegaGBLUP</monospace>, <monospace>MegaRRBLUP</monospace>, and <monospace>MegaBayesC</monospace>. These 5 models are described below.</p>
        <sec id="iyac183-s1.4.2.1">
          <title>GBLUP_K</title>
          <p>A single-kernel single-trait model with a genomic relationship matrix, <inline-formula><mml:math id="IM88" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow></mml:math></inline-formula>, calculated from the full set of markers using the method of <xref rid="iyac183-B34" ref-type="bibr">VanRaden (2008)</xref>.</p>
        </sec>
        <sec id="iyac183-s1.4.2.2">
          <title>GBLUP_KH</title>
          <p>A 2-kernel single-trait model with 2 relationship matrices: a genomic relationship matrix <inline-formula><mml:math id="IM89" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow></mml:math></inline-formula> and a hyperspectral reflectance relationship matrix <inline-formula><mml:math id="IM90" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow></mml:math></inline-formula> calculated as <inline-formula><mml:math id="IM91" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">S</mml:mi><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mo>/</mml:mo><mml:mn>620</mml:mn></mml:math></inline-formula> with <inline-formula><mml:math id="IM92" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow></mml:math></inline-formula> being the matrix of centered and standardized BLUEs of hyperspectral data. This method is analogous to the method proposed by <xref rid="iyac183-B20" ref-type="bibr">Krause <italic toggle="yes">et al.</italic> (2019)</xref> as described in <xref rid="iyac183-B31" ref-type="bibr">Runcie <italic toggle="yes">et al.</italic> (2021)</xref>.</p>
        </sec>
        <sec id="iyac183-s1.4.2.3">
          <title>MegaGBLUP</title>
          <p>This model implements a multivariate version of <monospace>GBLUP_K</monospace> as described in <xref rid="iyac183-B31" ref-type="bibr">Runcie <italic toggle="yes">et al.</italic> (2021)</xref>. The fixed effects <inline-formula><mml:math id="IM93" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> included intercepts only. The random effects <inline-formula><mml:math id="IM94" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM95" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> were not included in the model. A random effect with covariance proportional to <inline-formula><mml:math id="IM96" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">K</mml:mi></mml:mrow></mml:math></inline-formula> was used to model the genetic relationships among lines. We ran <monospace>MegaGBLUP</monospace> with <inline-formula><mml:math id="IM97" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:math></inline-formula> factors and assessed that the last several factors had all loadings close to zero.</p>
        </sec>
        <sec id="iyac183-s1.4.2.4">
          <title>MegaBayesC</title>
          <p>The <monospace>MegaBayesC</monospace> model was specified as described above. <inline-formula><mml:math id="IM98" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> included only intercepts, and <inline-formula><mml:math id="IM99" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was not included for computational efficiency. Instead, to allow markers to directly affect grain yield (fitted as the first trait), we fixed the first factor to be a vector of <inline-formula><mml:math id="IM100" display="inline" overflow="scroll"><mml:mn>0</mml:mn></mml:math></inline-formula>’s, but with the value <inline-formula><mml:math id="IM101" display="inline" overflow="scroll"><mml:mn>1</mml:mn></mml:math></inline-formula> as it’s first element. This latent factor thus only affects grain yield, so elements of the first column of <inline-formula><mml:math id="IM102" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> also only affect grain yield. For the remaining factors, the probability of an element being zero was considered as an unknown. The probability of a marker having a null effect on a latent factor was also considered as unknown for all the factors. We ran <monospace>MegaBayesC</monospace> with <inline-formula><mml:math id="IM103" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:math></inline-formula> factors and assessed that the last several factors had all loadings close to zero. Estimated individual genetic merits of grain yield were computed as <inline-formula><mml:math id="IM104" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">u</mml:mi></mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, where <inline-formula><mml:math id="IM105" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> denotes the first column of <inline-formula><mml:math id="IM106" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, which specifies the estimated relationship between all factors and grain yield.</p>
        </sec>
        <sec id="iyac183-s1.4.2.5">
          <title>MegaRRBLUP</title>
          <p>The <monospace>MegaRRBLUP</monospace> model was identical to the <monospace>MegaBayesC</monospace> model except that the marker exclusion probability <inline-formula><mml:math id="IM107" display="inline" overflow="scroll"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> was set to 0 so all markers were included. This model should be identical to <monospace>MegaGBLUP</monospace> except that the prior distribution of <inline-formula><mml:math id="IM108" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> is a BayesC prior (with factor loading exclusion probability <inline-formula><mml:math id="IM109" display="inline" overflow="scroll"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:msub><mml:mi mathvariant="normal">Λ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> estimated from the data) in <monospace>MegaRRBLUP</monospace>, which differs slightly from the Bayesian Horseshoe prior used in <monospace>MegaGBLUP</monospace> (<xref rid="iyac183-B31" ref-type="bibr">Runcie <italic toggle="yes">et al.</italic> 2021</xref>).</p>
          <p>All Bayesian methods were run for 10,000 iterations, with 2,000 used as burn-in and a thinning rate of 2.</p>
        </sec>
      </sec>
      <sec id="iyac183-s1.4.3">
        <title>Cross validation</title>
        <p>We used cross-validation to evaluate the predictive performance of different models by masking the grain yield of randomly selected subsets of 50% of the lines during model fitting and comparing the predictions of the genetic values of lines with masked values to their observed grain yield. Since we did not mask the hyperspectral data from these validation individuals to use those secondary traits as additional features for genetic value predictions, estimating prediction accuracy using Pearson’s correlation between predicted and observed grain yield values will be biased (<xref rid="iyac183-B29" ref-type="bibr">Runcie and Cheng 2019</xref>). Instead, we estimated the accuracy as the genetic correlation corrected by grain yield heritability (<xref rid="iyac183-B11" ref-type="bibr">Daetwyler <italic toggle="yes">et al.</italic> 2013</xref>; <xref rid="iyac183-B29" ref-type="bibr">Runcie and Cheng 2019</xref>) as implemented in <xref rid="iyac183-B31" ref-type="bibr">Runcie <italic toggle="yes">et al.</italic> (2021)</xref>. The cross-validation process was repeated 20 times with different selections of masked lines. Since these cross-validation repetitions re-use validation data, estimates of genetic prediction accuracy across repetitions are correlated and <inline-formula><mml:math id="IM110" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula>-tests of differences among models become anti-conservative. We used a modified <inline-formula><mml:math id="IM111" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula>-statistic to account for this correlation when comparing across methods: <inline-formula><mml:math id="IM112" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mspace width=".1em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>20</mml:mn></mml:munderover><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mrow><mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:msqrt></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="IM113" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM114" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></inline-formula> are the sizes of the training and testing sets for the focal trait, respectively (<xref rid="iyac183-B6" ref-type="bibr">Bouckaert and Frank 2004</xref>).</p>
      </sec>
    </sec>
    <sec id="iyac183-s1.5">
      <title>Estimation of marker effects for association inference</title>
      <p>We conducted 2 simulation studies and 1 real data analysis to investigate the ability of <monospace>MegaBayesC</monospace> to accurately estimate marker effects. First, we simulated a population with independent and uncorrelated SNPs to assess the ability of <monospace>MegaBayesC</monospace> to distinguish between genetic and nongenetic sources of variation in a focal trait by using information from correlated traits. Second, we designed a simulation study using marker data from a real <italic toggle="yes">Arabidopsis thaliana</italic> population to study the effects of population structure and linkage among markers. Finally, we used <monospace>MegaBayesC</monospace> to model real flowering time phenotypes from this Arabidopsis population and assessed whether expression data from 20,843 genes could improve gene discovery by genome-wide association study (GWAS).</p>
      <p>Although <monospace>MegaBayesC</monospace> greatly reduces the computational burden of Bayesian multivariate regressions by decomposing phenotypic covariances into a set of <inline-formula><mml:math id="IM115" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> laten factors, whole-genome regression models with hundreds of thousands of candidate markers are computationally prohibitive. In our second simulation study and our real data analysis, we implemented a 2-stage approach for BayesC-based methods. In the first stage (i.e. the preselection stage), we selected a small proportion of SNPs to take forward into a full BayesC analysis by running a single-trait GWAS on individuals that have no observation on secondary traits. We used LD-based clumping to select thousands of potentially important SNPs. After the preselection stage, the records of focal and secondary traits from the remaining individuals were analyzed in BayesC-based methods using only the preselected potentially important SNPs.</p>
      <sec id="iyac183-s1.5.1">
        <title>Simulated study in a population without structure or linkage disequilibrium</title>
        <p>We created a simulated population of <inline-formula><mml:math id="IM116" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math></inline-formula> individuals and <inline-formula><mml:math id="IM117" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>2,000</mml:mn></mml:math></inline-formula> independent SNPs. An <inline-formula><mml:math id="IM118" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:math></inline-formula> matrix of genotypic covariates was generated by random sampling from <inline-formula><mml:math id="IM119" display="inline" overflow="scroll"><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:math></inline-formula>. We then created simulated phenotypic data for a single focal trait and many correlated “secondary” traits. The performance of <monospace>MegaBayesC</monospace> was compared to a single-trait BayesC model (ST-BayesC) based on the accuracy of estimated marker effects for the focal trait. We induced genetic and nongenetic covariation among the traits through latent factors. The majority of variance in the focal trait was attributed to the latent factors. In Scenario 1, we created latent factors whose variation was primarily determined by the genetic markers (i.e. high-heritability latent factors), and in Scenario 2, the latent factors were predominantly nongenetic (i.e. low-heritability factors).</p>
        <p>We studied 4 parameters that we expected to influence the relative performance of <monospace>MegaBayesC</monospace> and <monospace>ST-BayesC</monospace>: (1) the number of latent factors (<inline-formula><mml:math id="IM120" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), (2) the number of correlated traits (<inline-formula><mml:math id="IM121" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) controlled by each factor, (3) the number of QTL (i.e. causal variants) that control each factor (<inline-formula><mml:math id="IM122" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), and (4) the heritability of the factors. In this simulation study, <inline-formula><mml:math id="IM123" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>9</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="IM124" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="IM125" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>30</mml:mn><mml:mo fence="false" stretchy="false">}</mml:mo></mml:math></inline-formula>, and 2 heritable patterns of latent factors were considered.</p>
        <p>To generate simulated phenotype data, we first used <inline-formula><mml:math id="IM126" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM127" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to construct a factor loading matrix (<inline-formula><mml:math id="IM128" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula>). For example, when <inline-formula><mml:math id="IM129" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="IM130" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula>, 4 (i.e. <inline-formula><mml:math id="IM131" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) observed traits were simulated, with 2 different observed traits linked to each factor. Since the first observed trait was treated as the focal trait, and all factors were assumed to contribute to its variation, factor loadings in the first column of <inline-formula><mml:math id="IM132" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> were set to 1. To minimize the complexity of this simulation, all the nonzero factor loadings in <inline-formula><mml:math id="IM133" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> were set to 1. Therefore, the simulated <inline-formula><mml:math id="IM134" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> given <inline-formula><mml:math id="IM135" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="IM136" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> was<disp-formula id="UM0002"><mml:math id="UM2" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mtable rowspacing="4pt" columnspacing="1em"><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>]</mml:mo></mml:mrow></mml:math></disp-formula>By constructing <inline-formula><mml:math id="IM137" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> in this way, all factors except the first were linked to <inline-formula><mml:math id="IM138" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:math></inline-formula> observed traits, while the first factor was linked to <inline-formula><mml:math id="IM139" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> observed traits. A similarly structured <inline-formula><mml:math id="IM140" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> was constructed for other combinations of <inline-formula><mml:math id="IM141" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM142" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
        <p>After defining <inline-formula><mml:math id="IM143" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula>, genetic variation controlled by QTL and nongenetic residual variation in each factor was simulated. <inline-formula><mml:math id="IM144" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> QTL were selected for each factor, and Gaussian variation was added such that the variance explained by QTL was a specific percentage of the total variance in the factor. In Scenario 1, QTL accounted for <inline-formula><mml:math id="IM145" display="inline" overflow="scroll"><mml:mn>95</mml:mn><mml:mtext>%</mml:mtext></mml:math></inline-formula> of the variance of each factor (i.e. <inline-formula><mml:math id="IM146" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>E</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:math></inline-formula> with <inline-formula><mml:math id="IM147" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>G</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> being the genetic variance of factors and <inline-formula><mml:math id="IM148" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>F</mml:mi><mml:mi>E</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> being the residual variance of factors). In Scenario 2, only the first factor was associated with QTL (again with <inline-formula><mml:math id="IM149" display="inline" overflow="scroll"><mml:mn>95</mml:mn><mml:mtext>%</mml:mtext></mml:math></inline-formula> of its variance explained by the QTL), and the remaining factors had independent variation. Finally, trait-specific variation was added to each trait, accounting for approximately <inline-formula><mml:math id="IM150" display="inline" overflow="scroll"><mml:mn>10</mml:mn><mml:mtext>%</mml:mtext></mml:math></inline-formula> of its total variance.</p>
        <p>As a consequence of these simulation choices, the 2 scenarios differed in several key aspects of the genetic architecture and correlation structures between the focal trait and the secondary traits. In Scenario 1, all factors were controlled predominately by genetic variation and every QTL for every factor was indirectly a QTL for the focal trait, and all secondary traits had strong genetic correlations with the focal trait. In Scenario 2, most factors were controlled by nongenetic variation; only the first factor was controlled by QTL. Therefore, all secondary traits were phenotypically correlated with the focal trait, but most of these correlations were nongenetic.</p>
        <p>In both scenarios, as <inline-formula><mml:math id="IM151" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and/or <inline-formula><mml:math id="IM152" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> increased, the magnitude of variation explained by each QTL decreased to hold the total percentage of variation in the focal trait explained by QTL constant.</p>
        <p>In Scenario 1, when <inline-formula><mml:math id="IM153" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="IM154" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math></inline-formula>, the 90 QTL each explained <inline-formula><mml:math id="IM155" display="inline" overflow="scroll"><mml:mo>≈</mml:mo><mml:mn>0.97</mml:mn><mml:mtext>%</mml:mtext></mml:math></inline-formula> of the total variance (<xref rid="iyac183-F3" ref-type="fig">Fig. 3</xref>). As <inline-formula><mml:math id="IM156" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> increased to 30, the number of QTL for the focal trait increased to 270 and each accounted for around 0.29% of the total variance of focal trait. The percentage of variance explained by QTL was constant across values of <inline-formula><mml:math id="IM157" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. In this scenario, all QTL for all factors contributed to the variation in the focal trait. For example, when <inline-formula><mml:math id="IM158" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="IM159" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math></inline-formula>, each factor was influenced by 10 QTL, for a total of 60 QTL. During this process, some SNPs were stochastically selected more than once, and thus some QTL had effects on more than 1 factor.</p>
        <p>In Scenario 2, as <inline-formula><mml:math id="IM160" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> increased, the proportion of variance explained by QTL decreased. For example, when <inline-formula><mml:math id="IM161" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:math></inline-formula>, the genetic variance accounted for 14% of the total variance of focal trait. With <inline-formula><mml:math id="IM162" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:math></inline-formula>, the percent of variance explained by genetic markers decreased to 9%. Furthermore, when <inline-formula><mml:math id="IM163" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:math></inline-formula>, the variance explained by each marker decreased from <inline-formula><mml:math id="IM164" display="inline" overflow="scroll"><mml:mn>0.90</mml:mn><mml:mtext>%</mml:mtext></mml:math></inline-formula> to <inline-formula><mml:math id="IM165" display="inline" overflow="scroll"><mml:mn>0.31</mml:mn><mml:mtext>%</mml:mtext></mml:math></inline-formula> as the number of QTL increased from 10 to 30. For a given <inline-formula><mml:math id="IM166" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM167" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> the per-QTL effect sizes in both scenarios were comparable, but since there were more genetic factors in Scenario 1, the total variance in the focal trait controlled by QTL was larger.</p>
        <p>Based on the combination of <inline-formula><mml:math id="IM168" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="IM169" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="IM170" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and the heritable patterns, a total of <inline-formula><mml:math id="IM171" display="inline" overflow="scroll"><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> conditions were studied in this simulation study. Ten replicates were conducted for each of the 36 conditions.</p>
        <p>When fitting models to these simulated data, we included the intercept for each trait as the only fixed effect. We compared <monospace>MegaBayesC</monospace> to a single-trait implementation of BayesC (<monospace>ST-BayesC</monospace>) using the <monospace>JWAS</monospace> package (<xref rid="iyac183-B8" ref-type="bibr">Cheng, Fernando, <italic toggle="yes">et al.</italic> 2018</xref>). The model specification of <monospace>MegaBayesC</monospace> was similar to that used in the <bold>Genomic Prediction</bold> application, except: (1) no fixed factor loadings were included in <inline-formula><mml:math id="IM172" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula>, (2) <inline-formula><mml:math id="IM173" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> the number of factors fitted in the model was <inline-formula><mml:math id="IM174" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:math></inline-formula>. We estimated the total marker effects on the focal trait as <inline-formula><mml:math id="IM175" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula>, where <inline-formula><mml:math id="IM176" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the matrix of marker effects of latent factors and <inline-formula><mml:math id="IM177" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:math></inline-formula> denotes the first column of <inline-formula><mml:math id="IM178" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> specifying the relationship between factors and focal trait, i.e. summing the QTL effects on the latent factors weighted by the relationships between each factor and the focal trait. Both models were run for 10,000 iterations, with a burn-in of 2,000 iterations and a thinning rate of 10. We measured the performance of each method (<monospace>MegaBayesC</monospace> and <monospace>ST-BayesC</monospace>) by calculating the square root of the mean square error (RMSE) of estimated marker effects.</p>
      </sec>
      <sec id="iyac183-s1.5.2">
        <title>Simulation study in a real Arabidopsis population</title>
        <p>We created a second set of simulated datasets based on real genotypes from 1003 Arabidopsis thaliana accessions. Genotype data were downloaded from the 1,001 genomes project (<xref rid="iyac183-B1" ref-type="bibr">Alonso-Blanco <italic toggle="yes">et al.</italic> 2016</xref>). In a real population, the presence of linkage disequilibrium (LD) between loci and variable allele frequencies among markers increase the complexity of genetic association analyses. We removed SNPs with MAF <inline-formula><mml:math id="IM179" display="inline" overflow="scroll"><mml:mo>≤</mml:mo></mml:math></inline-formula>0.05 and missing genotype rate <inline-formula><mml:math id="IM180" display="inline" overflow="scroll"><mml:mo>≥</mml:mo></mml:math></inline-formula>0.1 using PLINK 1.9 (<xref rid="iyac183-B28" ref-type="bibr">Purcell <italic toggle="yes">et al.</italic> 2007</xref>), leaving 802,427 variants used for downstream analysis.</p>
        <p>To ensure the QTL were independent, we pruned SNPs with an LD threshold of 0.8 in windows of 500 SNPs, using a sliding window of 100 SNPs. We randomly selected 20 QTL from these SNPs, and generated 10 latent factors, each affected by 2 different QTL. In this simulation, the structure of the variance of the focal trait was simplified. All genetic variance in all traits was driven by the QTL effects on the latent factors, while all nongenetic variance was trait-specific. In this way, the observed traits (<inline-formula><mml:math id="IM181" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow></mml:math></inline-formula>) was expressed as <inline-formula><mml:math id="IM182" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msub></mml:math></inline-formula>.</p>
        <p>We set each element of the first column of <inline-formula><mml:math id="IM183" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> to 0.5 so that all 10 of the factors contributed equally to the focal trait. Each factor was additionally linked to 20 different secondary traits with factor loadings equal to 1. Other elements in <inline-formula><mml:math id="IM184" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> were set to be 0. Therefore, a total of 201 traits were simulated.</p>
        <p>The proportion of genetic variance in the focal trait was set to <inline-formula><mml:math id="IM185" display="inline" overflow="scroll"><mml:mo>≈</mml:mo><mml:mn>60</mml:mn><mml:mtext>%</mml:mtext></mml:math></inline-formula> (i.e. <inline-formula><mml:math id="IM186" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>o</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:math></inline-formula>). To ensure that the variance explained by each QTL was consistent (<inline-formula><mml:math id="IM187" display="inline" overflow="scroll"><mml:mo>≈</mml:mo></mml:math></inline-formula>1–5% of the total variance), QTL effects were sampled from a uniform distribution <inline-formula><mml:math id="IM188" display="inline" overflow="scroll"><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, and a randomly chosen half of those effects were multiplied by <inline-formula><mml:math id="IM189" display="inline" overflow="scroll"><mml:mo>−</mml:mo></mml:math></inline-formula>1. In addition, since the heritability of secondary traits such as gene expression is often higher than that of focal trait in real data applications, the heritabilities of the 200 secondary traits were each set to be 0.8.</p>
        <p>Finally, to parallel our real data analysis below, secondary trait data were simulated for only 649 of the 1003 Arabidopsis accessions. The 354 remaining accessions had records for only the focal trait. Hundred replicates were conducted in this simulation study.</p>
        <p>After creating the simulated data, we applied 3 methods to identify QTL and estimate their effects on the focal trait: (1) single-trait Genome-Wide Association Studies (GWAS) using GCTA (<xref rid="iyac183-B40" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2011</xref>) (ST-GCTA); (2) single-trait BayesC implemented in JWAS (<xref rid="iyac183-B8" ref-type="bibr">Cheng, Fernando, <italic toggle="yes">et al.</italic> 2018</xref>) (<monospace>ST-BayesC</monospace>); and (3) <monospace>MegaBayesC</monospace> implemented in <monospace>MegaLMM</monospace>.</p>
        <p>A 2-stage analysis as described above was implemented for <monospace>ST-BayesC</monospace> and <monospace>MegaBayesC</monospace>. In the first stage, a single-trait GWAS on the 354 individuals without records on secondary traits was implemented in GCTA. After running the GWAS, we sorted SNPs by <inline-formula><mml:math id="IM190" display="inline" overflow="scroll"><mml:mi>P</mml:mi></mml:math></inline-formula>-value, removed SNPs with <inline-formula><mml:math id="IM191" display="inline" overflow="scroll"><mml:mi>P</mml:mi></mml:math></inline-formula>-values larger than 0.01, then used a greedy algorithm to select the most-significant SNPs and mask all nearby SNPs (within 250 kb) with <inline-formula><mml:math id="IM192" display="inline" overflow="scroll"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0.5</mml:mn></mml:math></inline-formula> (<xref rid="iyac183-B28" ref-type="bibr">Purcell <italic toggle="yes">et al.</italic> 2007</xref>). After the preselection stage, the records of focal and secondary traits from the remaining 649 individuals were analyzed in <monospace>ST-BayesC</monospace> and <monospace>MegaBayesC</monospace> using only the preselected potentially important SNPs.</p>
        <p>The model specification of <monospace>MegaBayesC</monospace> was similar to that used in the previous simulation study for the independent populations, except we set <inline-formula><mml:math id="IM193" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:math></inline-formula>. In <monospace>MegaBayesC</monospace>, the total marker effects of the focal trait were computed as <inline-formula><mml:math id="IM194" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:math></inline-formula>, where <inline-formula><mml:math id="IM195" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a <inline-formula><mml:math id="IM196" display="inline" overflow="scroll"><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:math></inline-formula> matrix of marker effects for latent factors, with <inline-formula><mml:math id="IM197" display="inline" overflow="scroll"><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> being the number of SNPs selected at the preselection stage and <inline-formula><mml:math id="IM198" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">λ</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:math></inline-formula> being the column of <inline-formula><mml:math id="IM199" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Λ</mml:mi></mml:mrow></mml:math></inline-formula> that specifies the relationship between factors and focal trait. Furthermore, to demonstrate that the improved performance of <monospace>MegaBayesC</monospace> is attributed to not only the use of the BayesC prior on the marker effects but also the utilization of information from correlated secondary traits, a <monospace>ST-BayesC</monospace> analysis was also performed for the 649 individuals at the second stage. MCMC chains of 50,000 iterations were run for the BayesC-based methods with the first 10,000 iterations discarded as burn-in. We used a thinning rate of 1 sampler per 100 iterations to compute posterior means of model parameters.</p>
        <p>In addition to the 2-stage analysis, a 1-stage <monospace>ST-GCTA</monospace> was performed using the whole-genome SNP information and the phenotypes of the focal trait from all 1003 individuals. To compare with the 2-stage analysis, the selection of potentially important SNPs was done based on the 1-stage <monospace>ST-GCTA</monospace> result in the same manner as that in the preselection stage.</p>
        <p><xref rid="iyac183-F1" ref-type="fig">Figure 1</xref> shows the procedures performed to estimate marker effects in the 3 different methods.</p>
        <fig position="float" id="iyac183-F1" fig-type="figure">
          <label>Fig. 1.</label>
          <caption>
            <p>Graphical representation for the procedure of 1-stage and 2-stage analyses performed for the estimation of marker effects. FT represents the focal trait, <monospace>ST-GCTA</monospace> represents the single-trait GWAS implemented in GCTA, and <monospace>ST-BayesC</monospace> represents the single-trait BayesC method. In <monospace>ST-BayesC</monospace>, only phenotypes of FT and genotypes of the preselected potentially important SNPs were used.</p>
          </caption>
          <graphic xlink:href="iyac183f1" position="float"/>
        </fig>
        <p>RMSEs of the QTL effect sizes and the variance in the focal trait explained by the QTL were used to evaluate the accuracy of estimation of QTL effects by different methods. The variance explained by marker <inline-formula><mml:math id="IM200" display="inline" overflow="scroll"><mml:mi>l</mml:mi></mml:math></inline-formula> was computed as <inline-formula><mml:math id="IM201" display="inline" overflow="scroll"><mml:mi>v</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, where <inline-formula><mml:math id="IM202" display="inline" overflow="scroll"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the marker effect of SNP <inline-formula><mml:math id="IM203" display="inline" overflow="scroll"><mml:mi>l</mml:mi></mml:math></inline-formula> on focal trait, and <inline-formula><mml:math id="IM204" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:math></inline-formula> is the vector of genotypic covariates for SNP <inline-formula><mml:math id="IM205" display="inline" overflow="scroll"><mml:mi>l</mml:mi></mml:math></inline-formula>. To score QTL accuracy, we parsed the detected QTL in 3 ways: (1) If the true QTL were selected in the set of potentially important SNPs (e.g. Stage 1), the estimated effects were compared directly to the true effects. (2) If a SNP in imperfect LD with the true QTL was selected instead of the true QTL, we flagged its estimated effect size in the accuracy comparison because the incomplete linkage and different allele frequencies of the 2 SNPs mean that the estimated effect size will not be directly comparable to that of the true QTL. However, the variance attributed to the marker should be similar to the true QTL as long as <inline-formula><mml:math id="IM206" display="inline" overflow="scroll"><mml:msup><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> is high. (3) If neither the true QTL nor any of its linked SNPs was selected in the potentially important SNPs, we set the estimated marker effect and variance explained by this QTL to 0. For the purpose of unit consistency, RMSE of estimated marker effects and estimated marker-explained standard deviation (i.e. square root of marker-explained variance) across different methods were compared. In this study, a SNP was considered to be linked to a QTL if the squared correlation between its genotypic covariate and the QTL genotype was greater than 0.4.</p>
      </sec>
      <sec id="iyac183-s1.5.3">
        <title>Genetic association analysis of <italic toggle="yes">Arabidopsis thaliana</italic> flowering time and gene expression</title>
        <p>Phenotypes of flowering time from 1,003 accessions and expression data of 20,843 genes from 649 accessions were used, with flowering time selected as our focal trait. Gene expression data were downloaded from NCBI GEO (<xref rid="iyac183-B3" ref-type="bibr">Barrett <italic toggle="yes">et al.</italic> 2012</xref>). Genes with average counts smaller than 10 were removed and the remaining gene counts were normalized and variance stabilized as per <xref rid="iyac183-B31" ref-type="bibr">Runcie <italic toggle="yes">et al.</italic> (2021)</xref> using DESeq2 (<xref rid="iyac183-B21" ref-type="bibr">Love <italic toggle="yes">et al.</italic> 2014</xref>). The 2-stage <monospace>MegaBayesC</monospace> and 1-stage <monospace>ST-GCTA</monospace> analyses described above were performed again on this dataset. LD-based clumping was done to select potentially important SNPs for both methods. The model specification of <monospace>MegaBayesC</monospace> was similar to that used in the <bold>Genomic Prediction</bold> application. A MCMC chain of 80,000 was run with the first 20,000 iterations discarded as burn-in. We used a thinning rate of 1 sample per 100 iterations to compute posterior means of model parameters. In the 2-stage <monospace>MegaBayesC</monospace> analysis, potentially important SNPs with explained proportion of variance &gt;0.1% were classified as significant SNPs, while in the 1-stage <monospace>ST-GCTA</monospace> analysis, potentially important SNPs with <inline-formula><mml:math id="IM207" display="inline" overflow="scroll"><mml:mi>P</mml:mi></mml:math></inline-formula>-value <inline-formula><mml:math id="IM208" display="inline" overflow="scroll"><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> were classified as significant SNPs. We compared each significant SNP to a list of genes previously known to influence flowering time in Arabidopsis (<xref rid="iyac183-B5" ref-type="bibr">Bouché <italic toggle="yes">et al.</italic> 2016</xref>), and counted as a match (i.e. a true positive hit) if a SNP was within <inline-formula><mml:math id="IM209" display="inline" overflow="scroll"><mml:mo>±</mml:mo></mml:math></inline-formula>100 kb distance from at least 1 of the reported genes. Otherwise the significant SNP was conservatively considered as a false positive association.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="results" id="iyac183-s2">
    <title>Results</title>
    <sec id="iyac183-s2.1">
      <title><monospace>MegaBayesC</monospace> and <monospace>MegaRRBLUP</monospace> achieve similar prediction accuracy as MegaGBLUP</title>
      <p>We tested if whole-genome regression models could match or exceed the performance of univariate genomic prediction (<monospace>GBLUP</monospace>) and multivariate genomic prediction (<monospace>MegaGBLUP</monospace>) using data from a breeding trial of bread wheat. We compared the genomic value prediction accuracy of <monospace>MegaBayesC</monospace> and <monospace>MegaRRBLUP</monospace> to <monospace>MegaGBLUP</monospace> in this dataset, where we leveraged 620 hyperspectral phenotypes measured on 1,033 bread wheat lines to supplement genotype-based predictions of genomic value for grain yield. As baseline, we performed univariate genomic prediction using either the marker-based genomic relationship matrix (<monospace>GBLUP_K</monospace>) or a 2-kernel univariate model using both a genomic relationship matrix and a hyperspectral reflectance relationship matrix (<monospace>GBLUP_KH</monospace>). Prediction accuracy was assessed by cross-validation where for each of 20 replicates, grain yield values of 50% of the lines were masked and used as an independent testing set. Estimated genetic correlations between predicted and observed yields in the testing set were used as the cross-validation statistic.</p>
      <p>As shown in <xref rid="iyac183-F2" ref-type="fig">Fig. 2</xref>, the single-kernel <monospace>GBLUP_K</monospace> model had the lowest average prediction accuracy across cross-validation runs (<inline-formula><mml:math id="IM210" display="inline" overflow="scroll"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.46</mml:mn></mml:math></inline-formula>) in this dataset, followed by the 2 kernel, but still univariate <monospace>GBLUP_KH</monospace> model (<inline-formula><mml:math id="IM211" display="inline" overflow="scroll"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.66</mml:mn></mml:math></inline-formula>). <monospace>MegaBayesC</monospace> achieved a higher average prediction accuracy (<inline-formula><mml:math id="IM212" display="inline" overflow="scroll"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.73</mml:mn></mml:math></inline-formula>) to the univariate models, but a similar average accuracy to <monospace>MegaRRBLUP</monospace> and <monospace>MegaGBLUP</monospace> (<inline-formula><mml:math id="IM213" display="inline" overflow="scroll"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0.74</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="IM214" display="inline" overflow="scroll"><mml:mn>0.73</mml:mn></mml:math></inline-formula>, respectively). However, because our cross-validation runs re-used observations (due to the necessary 50:50 training split to estimate genetic prediction accuracy using the method of Runcie and Cheng <xref rid="iyac183-B29" ref-type="bibr">2019</xref>), the differences in estimated accuracy among the 4 methods incorporating the hyperspectral data were not significant at <inline-formula><mml:math id="IM215" display="inline" overflow="scroll"><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:math></inline-formula> using a re-sampling-adjusted <inline-formula><mml:math id="IM216" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula>-statistic: <inline-formula><mml:math id="IM217" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">(</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mspace width=".1em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>20</mml:mn></mml:munderover><mml:msub><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msqrt><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:mfrac></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mrow><mml:mover><mml:mi>σ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:msqrt></mml:mrow></mml:math></inline-formula> (<xref rid="iyac183-B6" ref-type="bibr">Bouckaert and Frank 2004</xref>). These results indicate that <monospace>MegaBayesC</monospace> can effectively leverage multivariate associations for genomic prediction, but there was no benefit from the more complex <monospace>MegaBayesC</monospace> model relative to the simpler <monospace>MegaGBLUP</monospace> model.</p>
      <fig position="float" id="iyac183-F2" fig-type="figure">
        <label>Fig. 2.</label>
        <caption>
          <p>Genomic value prediction performance of 5 models for wheat yield. Records of yield, 620 hyperspectral phenotypes, and genotype data for 1,033 lines were used. Bars show the mean prediction accuracy (<inline-formula><mml:math id="IM218" display="inline" overflow="scroll"><mml:mo>±</mml:mo></mml:math></inline-formula> adjusted standard error) for each model, and letters show the statistical significance of mean difference between methods based on an adjusted <inline-formula><mml:math id="IM219" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula>-statistics that accounts for correlations between samples.</p>
        </caption>
        <graphic xlink:href="iyac183f2" position="float"/>
      </fig>
      <fig position="float" id="iyac183-F3" fig-type="figure">
        <label>Fig. 3.</label>
        <caption>
          <p>RMSE of estimated QTL effects and SNP effects, respectively, under 2 scenarios. The upper panels show RMSE of estimated QTL effects under 2 scenarios. The lower panels show RMSE of estimated SNP effects under 2 scenarios. The left panels show RMSE for Scenario 1, where all latent factors had high heritability (<inline-formula><mml:math id="IM220" display="inline" overflow="scroll"><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:math></inline-formula>). The right panels show RMSE for Scenario 2, where only 1 of the factors had high heritability (i.e. factor 1 had <inline-formula><mml:math id="IM221" display="inline" overflow="scroll"><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:math></inline-formula> and the remainder factors had <inline-formula><mml:math id="IM222" display="inline" overflow="scroll"><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>). Results are shown for the simulation setting with <inline-formula><mml:math id="IM223" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="IM224" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:math></inline-formula>. The average proportion of total variance explained by 1 QTL was shown in the parenthesis of x-axis label.</p>
        </caption>
        <graphic xlink:href="iyac183f3" position="float"/>
      </fig>
    </sec>
    <sec id="iyac183-s2.2">
      <title><monospace>MegaBayesC</monospace> improves estimation of marker effects in simulated populations with independent markers</title>
      <p>Next, we ran a set of simulations to evaluate the ability of <monospace>MegaBayesC</monospace> to identify and accurately estimate the effect sizes of genetic variants for a set of correlated traits under different genetic architectures. Specifically, we tested whether <monospace>MegaBayesC</monospace> improved the estimation of variant effect sizes of a single focal trait when phenotypes of other correlated traits (i.e. secondary traits) were provided.</p>
      <p>Since the magnitude and causes (genetic vs. nongenetic) of the covariance structures among traits determine the usefulness of the secondary traits, we considered 2 covariance structures. In both cases, we began by simulating a set of latent factors partially controlled by genetic variation. In Scenario 1, the majority of variation in the focal trait was controlled by latent factors that were dominated by genetic variation. In Scenario 2, the majority of variation in the focal trait was controlled by latent factors dominated by nongenetic sources of variation. We compared the estimation of marker effects between <monospace>ST-BayesC</monospace> (which ignored all secondary traits) and <monospace>MegaBayesC</monospace> (which used all trait data at once). We scored the accuracy of each method by the RMSE of estimated marker effects. In both scenarios, as the genetic architecture increased in complexity (i.e. the number of QTL increased and the average size of each QTL decreased to keep the total percentage of variation attributable to the QTL constant), the performance of <monospace>ST-BayesC</monospace> decreased (RMSE increased) much more dramatically than <monospace>MegaBayesC</monospace>. <xref rid="iyac183-F3" ref-type="fig">Figure 3</xref> shows RMSE of estimated effects for QTL and SNP, respectively, (i.e. QTL are markers with a nonzero effect and SNPs are markers with a true effect size of zero) under the 2 scenarios for the simulation setting where the largest difference of RMSE was observed between <monospace>MegaBayesC</monospace> and ST-BayesC, with <inline-formula><mml:math id="IM225" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> and <inline-formula><mml:math id="IM226" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:math></inline-formula>. Results for other combinations of <inline-formula><mml:math id="IM227" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="IM228" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and <inline-formula><mml:math id="IM229" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are shown in the <xref rid="sup1" ref-type="supplementary-material">Supplementary File</xref> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). In Scenario 1, the number of latent factors had no direct effect on the performance of <monospace>ST-BayesC</monospace> beyond its effect on the number of QTL. Also, the number of traits linked to each factor (i.e. <inline-formula><mml:math id="IM230" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) did not significantly affect the performance of <monospace>MegaBayesC</monospace> in both Scenario 1 and Scenario 2. This shows the ability of <monospace>MegaBayesC</monospace> to capture the underlying sources of correlations among traits by optimizing the utilization of secondary traits, even when each factor only has 1 linked secondary trait included in the model.</p>
      <p>For <monospace>ST-BayesC</monospace>, the RMSE of estimated marker effects increased significantly as marker-explained variances decreased in both scenarios. Compared to Scenario 1, the increase of RMSE for estimated effects of QTL was greater in Scenario 2, while the increase of RMSE for estimated effects of SNPs were similar between the 2 scenarios. This indicates that the performance of <monospace>ST-BayesC</monospace> to identify QTL was affected by the marker-explained variance as well as the variance structure of the focal trait.</p>
      <p>In contrast, the performance of <monospace>MegaBayesC</monospace> was relatively constant across scenarios as measured by RMSE. In terms of the estimation of effect sizes of QTL, the influence of the variance structure and the marker-explained variance was negligible, which led to a relatively constant RMSE across the simulation settings. At the same time, <monospace>MegaBayesC</monospace> was able to shrink most SNPs more effectively toward zero, especially in Scenario 2, when the ratio of number of QTL to number of SNPs was smaller.</p>
      <p>To further explore the differences in the performance of <monospace>ST-BayesC</monospace> and <monospace>MegaBayesC</monospace> in Scenario 2, we plotted the estimated marker effects under 1 example simulation with <inline-formula><mml:math id="IM231" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM232" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:math></inline-formula>, and <inline-formula><mml:math id="IM233" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> (<xref rid="iyac183-F4" ref-type="fig">Fig. 4</xref>).</p>
      <fig position="float" id="iyac183-F4" fig-type="figure">
        <label>Fig. 4.</label>
        <caption>
          <p>Scatter plot of estimated marker effects versus true marker effects for the simulation setting with <inline-formula><mml:math id="IM234" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mspace width=".1em"/><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM235" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>q</mml:mi><mml:mi>t</mml:mi><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:math></inline-formula>, and <inline-formula><mml:math id="IM236" display="inline" overflow="scroll"><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:math></inline-formula> in Scenario 2, where all factors have effects on the focal trait but only 1 of them is a genetic factor (i.e. <inline-formula><mml:math id="IM237" display="inline" overflow="scroll"><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>). Red and blue colors specify QTLs (True effect size <inline-formula><mml:math id="IM238" display="inline" overflow="scroll"><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:math></inline-formula>) and SNPs (True effect size <inline-formula><mml:math id="IM239" display="inline" overflow="scroll"><mml:mo>=</mml:mo></mml:math></inline-formula> 0), respectively. The solid line represents the line <inline-formula><mml:math id="IM240" display="inline" overflow="scroll"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:math></inline-formula>.</p>
        </caption>
        <graphic xlink:href="iyac183f4" position="float"/>
      </fig>
      <p>For <monospace>ST-BayesC</monospace>, some QTL were successfully selected by the model and their effect sizes were accurately estimated close to the true value of 0.1. However, for the majority of QTL, the estimated marker effects were shrunk toward 0s. On the other hand, <monospace>ST-BayesC</monospace> erroneously estimated effect sizes of null-effect SNPs from <inline-formula><mml:math id="IM241" display="inline" overflow="scroll"><mml:mo>−</mml:mo></mml:math></inline-formula>0.03 to 0.06. In contrast, the marker effects of QTL and null-effect SNPs were accurately estimated by <monospace>MegaBayesC</monospace> (<xref rid="iyac183-F4" ref-type="fig">Fig. 4</xref>).</p>
    </sec>
    <sec id="iyac183-s2.3">
      <title>Estimation of explained variance of markers in a population simulated using real genotype data</title>
      <p>To explore the ability of <monospace>MegaBayesC</monospace> to accurately identify QTL and estimate their effect sizes in the presence of LD, we generated simulated phenotypes based on real genotypes from an Arabidopsis population. We then ran association analyses using 3 methods: The direct (i.e. 1-stage) method, <monospace>ST-GCTA</monospace>, that only uses the focal trait, and 2 2-stage methods: <monospace>ST-BayesC</monospace> and <monospace>MegaBayesC</monospace>, which both rely on a preselection stage to select a set of candidate SNPs using 1 partition of the population, and then an assay stage where the effects of those SNPs on the focal trait are modeled in the second partition of the population. We compared the performance of the models by the RMSE of estimated marker effects and marker-explained variances.</p>
      <p><xref rid="iyac183-F5" ref-type="fig">Figure 5</xref> shows the RMSE of estimated marker effects and estimated marker-explained standard deviations from the simulated phenotype data. The 2-stage <monospace>MegaBayesC</monospace> method achieved the lowest RMSE for both marker effects and marker-explained standard deviations, followed by the 2-stage analysis incorporating <monospace>ST-BayesC</monospace>, and then the 1-stage single-trait GWAS (<monospace>ST-GCTA</monospace>). The RMSE of the 1-stage single-trait GWAS was around 10 times larger than that of the 2-stage BayesC-based analyses, while the difference between <monospace>ST-BayesC</monospace> and <monospace>MegaBayesC</monospace> was much smaller. Furthermore, the RMSE of estimated marker-explained standard deviations was generally lower than that of estimated marker effects. The larger RMSE of estimated marker effects is likely due to the selection of linked SNPs rather than the true causal QTL in the preselection stage.</p>
      <fig position="float" id="iyac183-F5" fig-type="figure">
        <label>Fig. 5.</label>
        <caption>
          <p>RMSE of estimated marker effects and estimated marker-explained standard deviations (i.e. square root of marker-explained variances) across different methods. The performance of 2-stage (ST-BayesC and <monospace>MegaBayesC</monospace>) methods and 1-stage (ST-GCTA) method was compared.</p>
        </caption>
        <graphic xlink:href="iyac183f5" position="float"/>
      </fig>
      <p>To further explore the difference in the performance of <monospace>ST-BayesC</monospace> and <monospace>MegaBayesC</monospace> in this simulation scenario, we present the relationship between true and estimated marker effects for 1 replicate in <xref rid="iyac183-F6" ref-type="fig">Fig. 6</xref>. In this simulation, 19/20 true causal QTL were selected by <monospace>ST-GCTA</monospace>, and only 16 were selected in the preselection stage for the 2-stage methods, <monospace>ST-BayesC</monospace> and <monospace>MegaBayesC</monospace>. In all 3 cases, the effect sizes of these selected QTL were accurately estimated. However, the effect sizes of many null-effect SNPs were dramatically overestimated by <monospace>ST-GCTA</monospace>, leading to an overall high false positive rate. In contrast, although a few true causal QTL were missed in the preselection stage, SNPs with null effects that were moved forward into stage 2 were estimated to have very small effects by both <monospace>ST-BayesC</monospace> and <monospace>MegaBayesC</monospace>.</p>
      <fig position="float" id="iyac183-F6" fig-type="figure">
        <label>Fig. 6.</label>
        <caption>
          <p>The relationship between estimated and true values of marker effects and marker-explained proportion of variance for focal trait. Three different methods (<monospace>ST-GCTA</monospace>, <monospace>ST-BayesC</monospace>, and <monospace>MegaBayesC</monospace>) were compared. Details of each method are presented in “Materials and methods”. Red and grey points indicate markers that are causal QTL. Red markers were selected by the first-stage analysis but grey markers were not and so have an estimated effect size of zero. Green and blue points indicate markers that are not causal QTL but were selected by the first-stage analysis. Green markers are in strong LD with true causal QTL but blue markers are not.</p>
        </caption>
        <graphic xlink:href="iyac183f6" position="float"/>
      </fig>
      <p>Note that in some cases, SNPs that are in LD with true QTL were selected instead of the causal QTL. When the linkage phase was negative, the estimated effect sizes for linked SNPs have the opposite sign, which increases the reported RMSE. However, even in these cases, the proportion of variance explained by these linked markers is close to the proportion that would have been explained by the true QTL, so the effect of LD on the RMSE of marker-explained variances is minimized.</p>
    </sec>
    <sec id="iyac183-s2.4">
      <title>Identifying candidate genes for flowering time in Arabidopsis using gene expression data as secondary traits</title>
      <p>We applied the 2-stage <monospace>MegaBayesC</monospace> and the 1-stage single-trait GWAS (<monospace>ST-GCTA</monospace>) to the task of identifying candidate genes that regulate flowering time in <italic toggle="yes">Arabidopsis thaliana</italic> using actual flowering time measurements and genotype data from 1003 <italic toggle="yes">A. thaliana</italic> accessions. In <monospace>MegaBayesC</monospace>, we included the expression of 20,843 genes measured on 649 of the accessions as secondary traits.</p>
      <p>Potentially important SNPs with marker-explained variance proportion greater than <inline-formula><mml:math id="IM242" display="inline" overflow="scroll"><mml:mn>0.1</mml:mn><mml:mtext>%</mml:mtext></mml:math></inline-formula> in <monospace>MegaBayesC</monospace> and potentially important SNPs with <inline-formula><mml:math id="IM243" display="inline" overflow="scroll"><mml:mi>P</mml:mi></mml:math></inline-formula>-value smaller than <inline-formula><mml:math id="IM244" display="inline" overflow="scroll"><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> in <monospace>ST-GCTA</monospace> were selected as significant SNPs. <monospace>MegaBayesC</monospace> was better able to select a limited number of candidate SNPs based on per-marker variance explained (<xref rid="iyac183-F7" ref-type="fig">Fig. 7</xref>) than <monospace>ST-GCTA</monospace> (<xref rid="iyac183-F8" ref-type="fig">Fig. 8</xref>) by shrinking the vast majority of SNP effects to zero.</p>
      <fig position="float" id="iyac183-F7" fig-type="figure">
        <label>Fig. 7.</label>
        <caption>
          <p>Marker-explained proportion of variance for potentially important SNPs by the 2-stage analysis using <monospace>MegaBayesC</monospace>. The top 15 SNPs that explained the greatest proportions of variance in flowering time are highlighted.</p>
        </caption>
        <graphic xlink:href="iyac183f7" position="float"/>
      </fig>
      <fig position="float" id="iyac183-F8" fig-type="figure">
        <label>Fig. 8.</label>
        <caption>
          <p>Marker-explained proportion of variance for potentially important SNPs by the 1-stage <monospace>ST-GCTA</monospace> analysis. The top 15 SNPs that explained the greatest proportions of variance in flowering time are highlighted.</p>
        </caption>
        <graphic xlink:href="iyac183f8" position="float"/>
      </fig>
      <p>We assessed the accuracy of these associations by checking whether known flowering time-related genes are located near to the SNPs selected by each model.</p>
      <p>Using <monospace>MegaBayesC</monospace>, we selected 15 significant SNPs and 13 of these were located within 100 kb of known flowering time-related genes. Note that these known genes were generally not the nearest gene to the significant SNPs, but associations at this distance are not uncommon in Arabidopsis (<xref rid="iyac183-B33" ref-type="bibr">Sasaki <italic toggle="yes">et al.</italic> 2021</xref>). In some cases, more than 1 gene was within <inline-formula><mml:math id="IM245" display="inline" overflow="scroll"><mml:mo>±</mml:mo></mml:math></inline-formula>100 kb of a significant SNP, so a total of 15 known flowering-time-related genes were within 100 kb of the 13 significant SNPs. For <monospace>ST-GCTA</monospace>, we selected 34 significant SNPs, among which 26 SNPs were located within 100 kb of known flowering time-related genes. In several cases, more than 1 selected SNP was within 100 kb of a known flowering-time related gene, so a total of 15 known flowering-time-related genes were within 100 kb of the 26 significant SNPs. Detailed comparison on detected genes between <monospace>MegaBayesC</monospace> and <monospace>ST-GCTA</monospace> is shown in <xref rid="iyac183-T1" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="iyac183-T1">
        <label>Table 1.</label>
        <caption>
          <p>Detailed information on detected genes from <monospace>ST-GCTA</monospace> and <monospace>MegaBayesC</monospace>.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Method</th>
              <th align="center" rowspan="1" colspan="1">Number of significant SNPs</th>
              <th align="center" rowspan="1" colspan="1">Number of false positives</th>
              <th align="center" rowspan="1" colspan="1">Detected genes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">MegaBayesC</td>
              <td rowspan="1" colspan="1">15</td>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">AGL17, <bold>FLC</bold>, <bold>FT</bold>, FRI, <bold>FRL1</bold>,</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">GRP7, <bold>LIF2</bold>, MED18, <bold>AtNDX</bold>, <bold>PIE1</bold>,</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">SEF, SVP, <bold>VIN3</bold>, <bold>ZTL</bold>, and <bold>DOG1</bold></td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">ST-GCTA</td>
              <td rowspan="1" colspan="1">34</td>
              <td rowspan="1" colspan="1">8</td>
              <td rowspan="1" colspan="1">CIB2, <bold>FLC</bold>, <bold>FT</bold>, <bold>FRL1</bold>, JMJ14,</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">LATE, <bold>LIF2</bold>, MRG1, <bold>AtNDX</bold>, <bold>PIE1</bold>,</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">PRMT4A, TSF, <bold>VIN3</bold>, <bold>ZTL</bold>, and <bold>DOG1</bold></td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="iyac183-tblfn1">
            <p>Bold fonts are used to indicate genes that are detected in both methods.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="discussion" id="iyac183-s3">
    <title>Discussion</title>
    <p>The emergence of new types of phenotype data, such as gene expression or spectral reflectances, has created a demand for the development of robust models that are able to analyze large numbers of phenotypes in genome-enabled analysis. Although Bayesian regression models with mixture priors allow for more biologically meaningful prior assumptions on the effect size distributions of causal variants, their corresponding multivariate models (<xref rid="iyac183-B9" ref-type="bibr">Cheng, Kizilkaya, <italic toggle="yes">et al.</italic> 2018</xref>) suffer from a high computational burden. In this paper, we developed a Bayesian sparse factor model with mixture priors on marker effects to implement both genome-wide prediction and association for analyses with hundreds to tens-of-thousands of phenotypes. We use a moderate number of latent factors (<inline-formula><mml:math id="IM246" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula>) to account for the covariance among the observed traits. This substantially reduces the computational burden relative to either a multivariate Bayesian regression model or a MvLMM with fully parameterized trait covariance matrices when the number of traits (<inline-formula><mml:math id="IM247" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula>) is large.</p>
    <p>However, the sparse factor structure of <monospace>MegaBayesC</monospace> does not reduce the model complexity enough to enable mixture priors over the millions of genetic markers that are available in many systems from high-density genotyping arrays or whole genome sequencing. When marker effects of the factors and the trait-specific residuals are both included in the model, the number of marker effects to be estimated is equivalent to <inline-formula><mml:math id="IM248" display="inline" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:math></inline-formula>, with <inline-formula><mml:math id="IM249" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> being the number of observed traits, <inline-formula><mml:math id="IM250" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> being the number of factors, and <inline-formula><mml:math id="IM251" display="inline" overflow="scroll"><mml:mi>p</mml:mi></mml:math></inline-formula> being the number of total SNPs, which would require a tremendous amount of computational time and memory storage for whole-genome analysis.</p>
    <p>We therefore developed 2 approximations to greatly reduce the time complexity of the full model. First, we forced the marker effects to affect the secondary traits through the <inline-formula><mml:math id="IM252" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> factors (although we do allow marker effects to independently control the focal trait). This reduces the number of marker effects to <inline-formula><mml:math id="IM253" display="inline" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi></mml:math></inline-formula>. Second, we developed a 2-stage approach to prune the candidate markers before subjecting the pruned markers to the <monospace>MegaBayesC</monospace> analysis. For our <monospace>MegaBayesC</monospace> analysis of the Arabidopsis dataset with <inline-formula><mml:math id="IM254" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>649</mml:mn></mml:math></inline-formula>, <inline-formula><mml:math id="IM255" display="inline" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>844</mml:mn></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="IM256" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>804</mml:mn></mml:mrow></mml:math></inline-formula>, it took around 3 h to sample a MCMC chain of 10,000 iterations on a computer with 1 node and 20 CPU. Theoretically, the computational cost of <monospace>MegaBayesC</monospace> without fitting trait-specific marker effects (as in the analyses conducted in this paper) is approximately <inline-formula><mml:math id="IM257" display="inline" overflow="scroll"><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mi>n</mml:mi><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> if <inline-formula><mml:math id="IM258" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>p</mml:mi></mml:math></inline-formula>, or <inline-formula><mml:math id="IM259" display="inline" overflow="scroll"><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mi>n</mml:mi><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> if <inline-formula><mml:math id="IM260" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>n</mml:mi></mml:math></inline-formula>. Since <inline-formula><mml:math id="IM261" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> is generally much smaller than <inline-formula><mml:math id="IM262" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="IM263" display="inline" overflow="scroll"><mml:mi>p</mml:mi></mml:math></inline-formula>, or <inline-formula><mml:math id="IM264" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula>, the increase in complexity as a function of <inline-formula><mml:math id="IM265" display="inline" overflow="scroll"><mml:mi>K</mml:mi></mml:math></inline-formula> is dominated by <inline-formula><mml:math id="IM266" display="inline" overflow="scroll"><mml:mi>K</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and so is approximately linear. As a function of <inline-formula><mml:math id="IM267" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula>, the complexity is also linear. As a function of <inline-formula><mml:math id="IM268" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> and/or <inline-formula><mml:math id="IM269" display="inline" overflow="scroll"><mml:mi>p</mml:mi></mml:math></inline-formula>, it is approximately quadratic-cubic in the smaller and linear in the larger because either a <inline-formula><mml:math id="IM270" display="inline" overflow="scroll"><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:math></inline-formula> or <inline-formula><mml:math id="IM271" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:math></inline-formula> matrix inversion is required.</p>
    <p>While <monospace>MegaBayesC</monospace>, and <monospace>MegaLMM</monospace> more generally, shows promise in its ability to integrate thousands of traits in genome-wide prediction and association, the tradeoff between the benefit of incorporating secondary traits and the computational cost brought from the increased model complexity must be considered. Based on our simulated study, <monospace>MegaBayesC</monospace> can effectively disentangle the genetic and nongenetic sources of covariation among observed traits. When there is an important environmental component in the variation of focal trait, and this environmental component is shared by many other highly correlated traits, we expect <monospace>MegaLMM</monospace> whole-genome regression models to provide a large benefit by providing a tool to effectively control for this environmental variation. However, when the secondary traits are not highly correlated with the focal trait, or the heritability of the focal trait is already sufficiently high, <monospace>MegaLMM</monospace> whole-genome regression may prove less useful. In this paper, we have focused on 2 versions of <monospace>MegaLMM</monospace>: whole-genome regression with the BayesC prior on the marker effects (<monospace>MegaBayesC</monospace>), and with a ridge prior on the marker effects (<monospace>MegaRRBLUP</monospace>). The extension to other similar Bayesian Alphabet priors such as BayesA and BayesB would require only minor modifications to the code in the <monospace>MegaLMM</monospace> package. Other mixture priors such as the BayesR priors could also be implemented in future studies and we anticipate that each version may provide benefits in specific datasets.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>iyac183_Supplementary_Data</label>
      <media xlink:href="iyac183_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors would like to thank the editor and 2 anonymous reviewers for helpful comments on the manuscript.</p>
  </ack>
  <sec sec-type="data-availability" id="iyac183-s4">
    <title>Data availability</title>
    <p>Scripts for running all analyses are archived at GitHub: <ext-link xlink:href="https://github.com/Jiayi-Qu/Mega-BayesC" ext-link-type="uri">https://github.com/Jiayi-Qu/Mega-BayesC</ext-link>. The Bayesian Alphabet implementation is in the <monospace>MegaLMM</monospace> R package on GitHub. A stable release of the software used in this manuscript is available from Zenodo: <ext-link xlink:href="https://doi.org/10.5281/zenodo.7158887" ext-link-type="uri">https://doi.org/10.5281/zenodo.7158887</ext-link>. Data from the wheat breeding trial were downloaded from CIMMYT Research Data <ext-link xlink:href="http://hdl.handle.net/11529/10548109" ext-link-type="uri">http://hdl.handle.net/11529/10548109</ext-link> (<xref rid="iyac183-B20" ref-type="bibr">Krause <italic toggle="yes">et al.</italic> 2019</xref>). Arabidopsis flowering time data were downloaded from Arapheno: <ext-link xlink:href="https://arapheno.1001genomes.org/phenotype/261/" ext-link-type="uri">https://arapheno.1001genomes.org/phenotype/261/</ext-link>. Gene expression data were downloaded from NCBI GEO: <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE80744" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE80744</ext-link> (<xref rid="iyac183-B3" ref-type="bibr">Barrett <italic toggle="yes">et al.</italic> 2012</xref>). Genotype data were downloaded from the 1,001 genomes project (<xref rid="iyac183-B1" ref-type="bibr">Alonso-Blanco <italic toggle="yes">et al.</italic> 2016</xref>). <xref rid="sup1" ref-type="supplementary-material">Supplemental material</xref> available at <italic toggle="yes">GENETICS</italic> online.</p>
  </sec>
  <sec id="iyac183-s5">
    <title>Funding</title>
    <p>This work was supported by the United States Department of Agriculture (USDA) NIFA grant numbers 2020-67013-30904, 2021-67015-33412 and 2018-67015-27957 to DER and HC and USDA Hatch Project number 1010469.</p>
  </sec>
  <sec id="iyac183-s6">
    <title>Conflicts of interest</title>
    <p>The authors declare no conflict of interest.</p>
  </sec>
  <ref-list id="ref1">
    <title>Literature cited</title>
    <ref id="iyac183-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alonso-Blanco</surname><given-names>C</given-names></string-name>, <string-name><surname>Andrade</surname><given-names>J</given-names></string-name>, <string-name><surname>Becker</surname><given-names>C</given-names></string-name>, <string-name><surname>Bemm</surname><given-names>F</given-names></string-name>, <string-name><surname>Bergelson</surname><given-names>J</given-names></string-name>, <string-name><surname>Borgwardt</surname><given-names>KM</given-names></string-name>, <string-name><surname>Cao</surname><given-names>J</given-names></string-name>, <string-name><surname>Chae</surname><given-names>E</given-names></string-name>, <string-name><surname>Dezwaan</surname><given-names>TM</given-names></string-name>, <string-name><surname>Ding</surname><given-names>W</given-names></string-name>, <etal>et al</etal></person-group><article-title>1,135 genomes reveal the global pattern of polymorphism in <italic toggle="yes">Arabidopsis thaliana</italic></article-title>. <source>Cell</source>. <year>2016</year>;<volume>166</volume>:<fpage>481</fpage>–<lpage>491</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2016.05.063</pub-id><pub-id pub-id-type="pmid">27293186</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Araus</surname><given-names>JL</given-names></string-name>, <string-name><surname>Kefauver</surname><given-names>SC</given-names></string-name>, <string-name><surname>Zaman-Allah</surname><given-names>M</given-names></string-name>, <string-name><surname>Olsen</surname><given-names>MS</given-names></string-name>, <string-name><surname>Cairns</surname><given-names>JE</given-names></string-name></person-group>. <article-title>Translating high-throughput phenotyping into genetic gain</article-title>. <source>Trends Plant Sci</source>. <year>2018</year>;<volume>23</volume>:<fpage>451</fpage>–<lpage>466</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.tplants.2018.02.001</pub-id><pub-id pub-id-type="pmid">29555431</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barrett</surname><given-names>T</given-names></string-name>, <string-name><surname>Wilhite</surname><given-names>SE</given-names></string-name>, <string-name><surname>Ledoux</surname><given-names>P</given-names></string-name>, <string-name><surname>Evangelista</surname><given-names>C</given-names></string-name>, <string-name><surname>Kim</surname><given-names>IF</given-names></string-name></person-group>. <article-title>NCBI GEO: archive for functional genomics data sets-update</article-title>. <source>Nucleic Acids Res</source>. <year>2012</year>;<volume>41</volume>:<fpage>D991</fpage>–<lpage>D995</lpage>. doi:<pub-id pub-id-type="doi">10.1093/nar/gks1193</pub-id><pub-id pub-id-type="pmid">23193258</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bhattacharya</surname><given-names>A</given-names></string-name>, <string-name><surname>Dunson</surname><given-names>DB</given-names></string-name></person-group>. <article-title>Sparse Bayesian infinite factor models</article-title>. <source>Biometrika</source>. <year>2011</year>;<volume>98</volume>:<fpage>291</fpage>–<lpage>306</lpage>. doi:<pub-id pub-id-type="doi">10.1093/biomet/asr013</pub-id><pub-id pub-id-type="pmid">23049129</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bouché</surname><given-names>F</given-names></string-name>, <string-name><surname>Lobet</surname><given-names>G</given-names></string-name>, <string-name><surname>Tocquin</surname><given-names>P</given-names></string-name>, <string-name><surname>Périlleux</surname><given-names>C</given-names></string-name></person-group>. <article-title>FLOR-ID: an interactive database of flowering-time gene networks in <italic toggle="yes">Arabidopsis thaliana</italic></article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>:<fpage>D1167</fpage>–<lpage>D1171</lpage>. doi:<pub-id pub-id-type="doi">10.1093/nar/gkv1054</pub-id><pub-id pub-id-type="pmid">26476447</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Bouckaert</surname><given-names>RR</given-names></string-name>, <string-name><surname>Frank</surname><given-names>E</given-names></string-name></person-group>. <comment>Evaluating the replicability of significance tests for comparing learning algorithms. In: Pacific-Asia Conference on Knowledge Discovery and Data Mining. Springer; 2004. p. 3–12</comment>.</mixed-citation>
    </ref>
    <ref id="iyac183-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carvalho</surname><given-names>CM</given-names></string-name>, <string-name><surname>Chang</surname><given-names>J</given-names></string-name>, <string-name><surname>Lucas</surname><given-names>JE</given-names></string-name>, <string-name><surname>Nevins</surname><given-names>JR</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Q</given-names></string-name>, <string-name><surname>West</surname><given-names>M</given-names></string-name></person-group>. <article-title>High-dimensional sparse factor modeling: applications in gene expression genomics</article-title>. <source>J Am Stat Assoc</source>. <year>2008</year>;<volume>103</volume>:<fpage>1438</fpage>–<lpage>1456</lpage>. doi:<pub-id pub-id-type="doi">10.1198/016214508000000869</pub-id><pub-id pub-id-type="pmid">21218139</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>H</given-names></string-name>, <string-name><surname>Fernando</surname><given-names>R</given-names></string-name>, <string-name><surname>Garrick</surname><given-names>D</given-names></string-name></person-group>. <comment>2018. JWAS: Julia implementation of whole-genome analysis software. In: Proceedings of the World Congress on Genetics Applied to Livestock Production. Vol. 11. Auckland, New Zealand. p. 859</comment>.</mixed-citation>
    </ref>
    <ref id="iyac183-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>H</given-names></string-name>, <string-name><surname>Kizilkaya</surname><given-names>K</given-names></string-name>, <string-name><surname>Zeng</surname><given-names>J</given-names></string-name>, <string-name><surname>Garrick</surname><given-names>D</given-names></string-name>, <string-name><surname>Fernando</surname><given-names>R</given-names></string-name></person-group>. <article-title>Genomic prediction from multiple-trait bayesian regression methods using mixture priors</article-title>. <source>Genetics</source>. <year>2018</year>;<volume>209</volume>:genetics.300650.2018. doi:<pub-id pub-id-type="doi">10.1534/genetics.118.300650</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>H</given-names></string-name>, <string-name><surname>Qu</surname><given-names>L</given-names></string-name>, <string-name><surname>Garrick</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Fernando</surname><given-names>RL</given-names></string-name></person-group>. <article-title>A fast and efficient Gibbs sampler for BayesB in whole-genome analyses</article-title>. <source>Genet Sel Evol</source>. <year>2015</year>;<volume>47</volume>:<fpage>80</fpage>. doi:<pub-id pub-id-type="doi">10.1186/s12711-015-0157-x</pub-id><pub-id pub-id-type="pmid">26467850</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Daetwyler</surname><given-names>HD</given-names></string-name>, <string-name><surname>Calus</surname><given-names>MP</given-names></string-name>, <string-name><surname>Pong-Wong</surname><given-names>R</given-names></string-name>, <string-name><surname>de Los Campos</surname><given-names>G</given-names></string-name>, <string-name><surname>Hickey</surname><given-names>JM</given-names></string-name></person-group>. <article-title>Genomic prediction in animals and plants: simulation of data, validation, reporting, and benchmarking</article-title>. <source>Genetics</source>. <year>2013</year>;<volume>193</volume>:<fpage>347</fpage>–<lpage>365</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.112.147983</pub-id><pub-id pub-id-type="pmid">23222650</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Erbe</surname><given-names>M</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Matukumalli</surname><given-names>LK</given-names></string-name>, <string-name><surname>Goswami</surname><given-names>S</given-names></string-name>, <string-name><surname>Bowman</surname><given-names>PJ</given-names></string-name>, <string-name><surname>Reich</surname><given-names>CM</given-names></string-name>, <string-name><surname>Mason</surname><given-names>BA</given-names></string-name>, <string-name><surname>Goddard</surname><given-names>ME</given-names></string-name></person-group>. <article-title>Improving accuracy of genomic predictions within and between dairy cattle breeds with imputed high-density single nucleotide polymorphism panels</article-title>. <source>J Dairy Sci</source>. <year>2012</year>;<volume>95</volume>:<fpage>4114</fpage>–<lpage>4129</lpage>. doi:<pub-id pub-id-type="doi">10.3168/jds.2011-5019</pub-id><pub-id pub-id-type="pmid">22720968</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gianola</surname><given-names>D</given-names></string-name></person-group>. <article-title>Priors in whole-genome regression: the Bayesian alphabet returns</article-title>. <source>Genetics</source>. <year>2013</year>;<volume>194</volume>:<fpage>573</fpage>–<lpage>596</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.113.151753</pub-id><pub-id pub-id-type="pmid">23636739</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gianola</surname><given-names>D</given-names></string-name>, <string-name><surname>De Los Campos</surname><given-names>G</given-names></string-name>, <string-name><surname>Hill</surname><given-names>WG</given-names></string-name>, <string-name><surname>Manfredi</surname><given-names>E</given-names></string-name>, <string-name><surname>Fernando</surname><given-names>R</given-names></string-name></person-group>. <article-title>Additive genetic variability and the Bayesian alphabet</article-title>. <source>Genetics</source>. <year>2009</year>;<volume>183</volume>:<fpage>347</fpage>–<lpage>363</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.109.103952</pub-id><pub-id pub-id-type="pmid">19620397</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gibson</surname><given-names>G</given-names></string-name>, <string-name><surname>Weir</surname><given-names>B</given-names></string-name></person-group>. <article-title>The quantitative genetics of transcription</article-title>. <source>Trends Genet</source>. <year>2005</year>;<volume>21</volume>:<fpage>616</fpage>–<lpage>623</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.tig.2005.08.010</pub-id><pub-id pub-id-type="pmid">16154229</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gilmour</surname><given-names>A</given-names></string-name>, <string-name><surname>Thompson</surname><given-names>R</given-names></string-name>, <string-name><surname>Cullis</surname><given-names>B</given-names></string-name></person-group>. <article-title>Linear mixed models algorithm for average information REML: an efficient in linear mixed models variance parameter estimation</article-title>. <source>Biometrics</source>. <year>1995</year>;<volume>51</volume>:<fpage>1440</fpage>–<lpage>1450</lpage>. doi:<pub-id pub-id-type="doi">10.2307/2533274</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Habier</surname><given-names>D</given-names></string-name>, <string-name><surname>Fernando</surname><given-names>RL</given-names></string-name>, <string-name><surname>Kizilkaya</surname><given-names>K</given-names></string-name>, <string-name><surname>Garrick</surname><given-names>DJ</given-names></string-name></person-group>. <article-title>Extension of the bayesian alphabet for genomic selection</article-title>. <source>BMC Bioinform</source>. <year>2011</year>;<volume>12</volume>:<fpage>1</fpage>–<lpage>12</lpage>. doi:<pub-id pub-id-type="doi">10.1186/1471-2105-12-186</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henderson</surname><given-names>C</given-names></string-name>, <string-name><surname>Quaas</surname><given-names>R</given-names></string-name></person-group>. <article-title>Multiple trait evaluation using relatives’ records</article-title>. <source>J Anim Sci</source>. <year>1976</year>;<volume>43</volume>:<fpage>1188</fpage>–<lpage>1197</lpage>. doi:<pub-id pub-id-type="doi">10.2527/jas1976.4361188x</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kizilkaya</surname><given-names>K</given-names></string-name>, <string-name><surname>Fernando</surname><given-names>R</given-names></string-name>, <string-name><surname>Garrick</surname><given-names>D</given-names></string-name></person-group>. <article-title>Genomic prediction of simulated multibreed and purebred performance using observed fifty thousand single nucleotide polymorphism genotypes</article-title>. <source>J Anim Sci</source>. <year>2010</year>;<volume>88</volume>:<fpage>544</fpage>–<lpage>551</lpage>. doi:<pub-id pub-id-type="doi">10.2527/jas.2009-2064</pub-id><pub-id pub-id-type="pmid">19820059</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krause</surname><given-names>MR</given-names></string-name>, <string-name><surname>González-Pérez</surname><given-names>L</given-names></string-name>, <string-name><surname>Crossa</surname><given-names>J</given-names></string-name>, <string-name><surname>Pérez-Rodríguez</surname><given-names>P</given-names></string-name>, <string-name><surname>Montesinos-López</surname><given-names>O</given-names></string-name>, <string-name><surname>Singh</surname><given-names>RP</given-names></string-name>, <string-name><surname>Dreisigacker</surname><given-names>S</given-names></string-name>, <string-name><surname>Poland</surname><given-names>J</given-names></string-name>, <string-name><surname>Rutkoski</surname><given-names>J</given-names></string-name>, <string-name><surname>Sorrells</surname><given-names>M</given-names></string-name>, <etal>et al</etal></person-group><article-title>Hyperspectral reflectance-derived relationship matrices for genomic prediction of grain yield in wheat</article-title>. <source>G3</source>. <year>2019</year>;<volume>9</volume>:<fpage>1231</fpage>–<lpage>1247</lpage>. doi:<pub-id pub-id-type="doi">10.1534/g3.118.200856</pub-id><pub-id pub-id-type="pmid">30796086</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Love</surname><given-names>MI</given-names></string-name>, <string-name><surname>Huber</surname><given-names>W</given-names></string-name>, <string-name><surname>Anders</surname><given-names>S</given-names></string-name></person-group>. <article-title>Moderated estimation of fold change and dispersion for RNA-Seq data with deseq2</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>:<fpage>1</fpage>–<lpage>21</lpage>. doi:<pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McGraw</surname><given-names>EA</given-names></string-name>, <string-name><surname>Ye</surname><given-names>YH</given-names></string-name>, <string-name><surname>Foley</surname><given-names>B</given-names></string-name>, <string-name><surname>Chenoweth</surname><given-names>SF</given-names></string-name>, <string-name><surname>Higgie</surname><given-names>M</given-names></string-name>, <string-name><surname>Hine</surname><given-names>E</given-names></string-name>, <string-name><surname>Blows</surname><given-names>MW</given-names></string-name></person-group>. <article-title>High-dimensional variance partitioning reveals the modular genetic basis of adaptive divergence in gene expression during reproductive character displacement</article-title>. <source>Evolution</source>. <year>2011</year>;<volume>65</volume>:<fpage>3126</fpage>–<lpage>3137</lpage>. doi:<pub-id pub-id-type="doi">10.1111/j.1558-5646.2011.01371.x</pub-id><pub-id pub-id-type="pmid">22023580</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mehrban</surname><given-names>H</given-names></string-name>, <string-name><surname>Lee</surname><given-names>DH</given-names></string-name>, <string-name><surname>Moradi</surname><given-names>MH</given-names></string-name>, <string-name><surname>IlCho</surname><given-names>C</given-names></string-name>, <string-name><surname>Naserkheil</surname><given-names>M</given-names></string-name>, <string-name><surname>Ibáñez-Escriche</surname><given-names>N</given-names></string-name></person-group>. <article-title>Predictive performance of genomic selection methods for carcass traits in Hanwoo beef cattle: impacts of the genetic architecture</article-title>. <source>Genet Sel Evol</source>. <year>2017</year>;<volume>49</volume>:<fpage>1</fpage>–<lpage>13</lpage>. doi:<pub-id pub-id-type="doi">10.1186/s12711-016-0283-0</pub-id><pub-id pub-id-type="pmid">28093066</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meuwissen</surname><given-names>TH</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Goddard</surname><given-names>ME</given-names></string-name></person-group>. <article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title>. <source>Genetics</source>. <year>2001</year>;<volume>157</volume>:<fpage>1819</fpage>–<lpage>1829</lpage>. doi:<pub-id pub-id-type="doi">10.1093/genetics/157.4.1819</pub-id><pub-id pub-id-type="pmid">11290733</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moser</surname><given-names>G</given-names></string-name>, <string-name><surname>Lee</surname><given-names>SH</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Goddard</surname><given-names>ME</given-names></string-name>, <string-name><surname>Wray</surname><given-names>NR</given-names></string-name>, <string-name><surname>Visscher</surname><given-names>PM</given-names></string-name>, <string-name><surname>Haley</surname><given-names>C</given-names></string-name></person-group>. <article-title>Simultaneous discovery, estimation and prediction analysis of complex traits using a Bayesian mixture model</article-title>. <source>PLoS Genet</source>. <year>2015</year>;<volume>11</volume>:<fpage>e1004969</fpage>. doi:<pub-id pub-id-type="doi">10.1371/journal.pgen.1004969</pub-id><pub-id pub-id-type="pmid">25849665</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Park</surname><given-names>T</given-names></string-name>, <string-name><surname>Casella</surname><given-names>G</given-names></string-name></person-group>. <article-title>The Bayesian lasso</article-title>. <source>J Am Stat Assoc</source>. <year>2008</year>;<volume>103</volume>:<fpage>681</fpage>–<lpage>686</lpage>. doi:<pub-id pub-id-type="doi">10.1198/016214508000000337</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poland</surname><given-names>J</given-names></string-name>, <string-name><surname>Endelman</surname><given-names>J</given-names></string-name>, <string-name><surname>Dawson</surname><given-names>J</given-names></string-name>, <string-name><surname>Rutkoski</surname><given-names>J</given-names></string-name>, <string-name><surname>Wu</surname><given-names>S</given-names></string-name>, <string-name><surname>Manes</surname><given-names>Y</given-names></string-name>, <string-name><surname>Dreisigacker</surname><given-names>S</given-names></string-name>, <string-name><surname>Crossa</surname><given-names>J</given-names></string-name>, <string-name><surname>Sánchez-Villeda</surname><given-names>H</given-names></string-name>, <string-name><surname>Sorrells</surname><given-names>M</given-names></string-name>, <etal>et al</etal></person-group><article-title>Genomic selection in wheat breeding using genotyping-by-sequencing</article-title>. <source>Plant Genome</source>. <year>2012</year>;<volume>5</volume>:<fpage>103</fpage>–<lpage>113</lpage>.</mixed-citation>
    </ref>
    <ref id="iyac183-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Purcell</surname><given-names>S</given-names></string-name>, <string-name><surname>Neale</surname><given-names>B</given-names></string-name>, <string-name><surname>Todd-Brown</surname><given-names>K</given-names></string-name>, <string-name><surname>Thomas</surname><given-names>L</given-names></string-name>, <string-name><surname>Ferreira</surname><given-names>MAR</given-names></string-name>, <string-name><surname>Bender</surname><given-names>D</given-names></string-name>, <string-name><surname>Maller</surname><given-names>J</given-names></string-name>, <string-name><surname>Sklar</surname><given-names>P</given-names></string-name>, <string-name><surname>de Bakker</surname><given-names>PIW</given-names></string-name>, <string-name><surname>Daly</surname><given-names>MJ</given-names></string-name></person-group>. <article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title>. <source>Am J Hum Genet</source>. <year>2007</year>;<volume>81</volume>:<fpage>559</fpage>–<lpage>575</lpage>. doi:<pub-id pub-id-type="doi">10.1086/519795</pub-id><pub-id pub-id-type="pmid">17701901</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Runcie</surname><given-names>D</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>H</given-names></string-name></person-group>. <article-title>Pitfalls and remedies for cross validation with multi-trait genomic prediction methods</article-title>. <source>G3</source>. <year>2019</year>;<volume>9</volume>:<fpage>3727</fpage>–<lpage>3741</lpage>. doi:<pub-id pub-id-type="doi">10.1534/g3.119.400598</pub-id><pub-id pub-id-type="pmid">31511297</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Runcie</surname><given-names>DE</given-names></string-name>, <string-name><surname>Mukherjee</surname><given-names>S</given-names></string-name></person-group>. <article-title>Dissecting high-dimensional phenotypes with Bayesian sparse factor analysis of genetic covariance matrices</article-title>. <source>Genetics</source>. <year>2013</year>;<volume>194</volume>:<fpage>753</fpage>–<lpage>767</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.113.151217</pub-id><pub-id pub-id-type="pmid">23636737</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Runcie</surname><given-names>DE</given-names></string-name>, <string-name><surname>Qu</surname><given-names>J</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>H</given-names></string-name>, <string-name><surname>Crawford</surname><given-names>L</given-names></string-name></person-group>. <article-title>MegaLMM: mega-scale linear mixed models for genomic predictions with thousands of traits</article-title>. <source>Genome Biol</source>. <year>2021</year>;<volume>22</volume>:<fpage>1</fpage>–<lpage>25</lpage>. doi:<pub-id pub-id-type="doi">10.1186/s13059-021-02416-w</pub-id><pub-id pub-id-type="pmid">33397451</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rutkoski</surname><given-names>J</given-names></string-name>, <string-name><surname>Poland</surname><given-names>J</given-names></string-name>, <string-name><surname>Mondal</surname><given-names>S</given-names></string-name>, <string-name><surname>Autrique</surname><given-names>E</given-names></string-name>, <string-name><surname>González Pérez</surname><given-names>L</given-names></string-name>, <string-name><surname>Crossa</surname><given-names>J</given-names></string-name>, <string-name><surname>Reynolds</surname><given-names>M</given-names></string-name>, <string-name><surname>Singh</surname><given-names>R</given-names></string-name></person-group>. <article-title>Canopy temperature and vegetation indices from high-throughput phenotyping improve accuracy of pedigree and genomic selection for grain yield in wheat</article-title>. <source>G3</source>. <year>2016</year>;<volume>6</volume>:<fpage>2799</fpage>–<lpage>2808</lpage>. doi:<pub-id pub-id-type="doi">10.1534/g3.116.032888</pub-id><pub-id pub-id-type="pmid">27402362</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sasaki</surname><given-names>E</given-names></string-name>, <string-name><surname>Köcher</surname><given-names>T</given-names></string-name>, <string-name><surname>Filiault</surname><given-names>DL</given-names></string-name>, <string-name><surname>Nordborg</surname><given-names>M</given-names></string-name></person-group>. <article-title>Revisiting a GWAS peak in <italic toggle="yes">Arabidopsis thaliana</italic> reveals possible confounding by genetic heterogeneity</article-title>. <source>Heredity</source>. <year>2021</year>;<volume>127</volume>:<fpage>245</fpage>–<lpage>252</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41437-021-00456-3</pub-id><pub-id pub-id-type="pmid">34226672</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>VanRaden</surname><given-names>PM</given-names></string-name></person-group>. <article-title>Efficient methods to compute genomic predictions</article-title>. <source>J Dairy Sci</source>. <year>2008</year>;<volume>91</volume>:<fpage>4414</fpage>–<lpage>4423</lpage>. doi:<pub-id pub-id-type="doi">10.3168/jds.2007-0980</pub-id><pub-id pub-id-type="pmid">18946147</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vehtari</surname><given-names>A</given-names></string-name>, <string-name><surname>Gelman</surname><given-names>A</given-names></string-name>, <string-name><surname>Simpson</surname><given-names>D</given-names></string-name>, <string-name><surname>Carpenter</surname><given-names>B</given-names></string-name>, <string-name><surname>Bürkner</surname><given-names>P-C</given-names></string-name></person-group>. <article-title>Rank-normalization, folding, and localization: an improved r for assessing convergence of MCMC (with discussion)</article-title>. <source>Bayesian Anal</source>. <year>2021</year>;<volume>16</volume>:<fpage>667</fpage>–<lpage>718</lpage>. doi:<pub-id pub-id-type="doi">10.1214/20-BA1221</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Visscher</surname><given-names>PM</given-names></string-name>, <string-name><surname>Wray</surname><given-names>NR</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Q</given-names></string-name>, <string-name><surname>Sklar</surname><given-names>P</given-names></string-name>, <string-name><surname>McCarthy</surname><given-names>MI</given-names></string-name>, <string-name><surname>Brown</surname><given-names>MA</given-names></string-name>, <string-name><surname>Yang</surname><given-names>J</given-names></string-name></person-group>. <article-title>Ten years of GWAS discovery: biology, function, and translation</article-title>. <source>Am J Hum Genet</source>. <year>2017</year>;<volume>101</volume>:<fpage>5</fpage>–<lpage>22</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.ajhg.2017.06.005</pub-id><pub-id pub-id-type="pmid">28686856</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Chapman</surname><given-names>D</given-names></string-name>, <string-name><surname>Morota</surname><given-names>G</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>H</given-names></string-name></person-group>. <article-title>A multiple-trait Bayesian variable selection regression method for integrating phenotypic causal networks in genome-wide association studies</article-title>. <source>G3</source>. <year>2020</year>;<volume>10</volume>:<fpage>4439</fpage>–<lpage>4448</lpage>. doi:<pub-id pub-id-type="doi">10.1534/g3.120.401618</pub-id><pub-id pub-id-type="pmid">33020191</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolc</surname><given-names>A</given-names></string-name>, <string-name><surname>Arango</surname><given-names>J</given-names></string-name>, <string-name><surname>Settar</surname><given-names>P</given-names></string-name>, <string-name><surname>Fulton</surname><given-names>JE</given-names></string-name>, <string-name><surname>O’Sullivan</surname><given-names>NP</given-names></string-name></person-group>. <article-title>Mixture models detect large effect QTL better than GBLUP and result in more accurate and persistent predictions</article-title>. <source>J Anim Sci Biotechnol</source>. <year>2016</year>;<volume>7</volume>:<fpage>1</fpage>–<lpage>6</lpage>. doi:<pub-id pub-id-type="doi">10.1186/s40104-016-0066-z</pub-id><pub-id pub-id-type="pmid">26779340</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xiong</surname><given-names>Q</given-names></string-name>, <string-name><surname>Ancona</surname><given-names>N</given-names></string-name>, <string-name><surname>Hauser</surname><given-names>ER</given-names></string-name>, <string-name><surname>Mukherjee</surname><given-names>S</given-names></string-name>, <string-name><surname>Furey</surname><given-names>TS</given-names></string-name></person-group>. <article-title>Integrating genetic and gene expression evidence into genome-wide association analysis of gene sets</article-title>. <source>Genome Res</source>. <year>2012</year>;<volume>22</volume>:<fpage>386</fpage>–<lpage>397</lpage>. doi:<pub-id pub-id-type="doi">10.1101/gr.124370.111</pub-id><pub-id pub-id-type="pmid">21940837</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>J</given-names></string-name>, <string-name><surname>Lee</surname><given-names>SH</given-names></string-name>, <string-name><surname>Goddard</surname><given-names>ME</given-names></string-name>, <string-name><surname>Visscher</surname><given-names>PM</given-names></string-name></person-group>. <article-title>GCTA: a tool for genome-wide complex trait analysis</article-title>. <source>Am J Hum Genet</source>. <year>2011</year>;<volume>88</volume>:<fpage>76</fpage>–<lpage>82</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.ajhg.2010.11.011</pub-id><pub-id pub-id-type="pmid">21167468</pub-id></mixed-citation>
    </ref>
    <ref id="iyac183-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>X</given-names></string-name>, <string-name><surname>Stephens</surname><given-names>M</given-names></string-name></person-group>. <article-title>Efficient multivariate linear mixed model algorithms for genome-wide association studies</article-title>. <source>Nat Methods</source>. <year>2014</year>;<volume>11</volume>:<fpage>407</fpage>–<lpage>409</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.2848</pub-id><pub-id pub-id-type="pmid">24531419</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
