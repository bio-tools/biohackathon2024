<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10680269</article-id>
    <article-id pub-id-type="publisher-id">5563</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05563-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scMuffin: an R package to disentangle solid tumor heterogeneity by single-cell gene expression analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nale</surname>
          <given-names>Valentina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chiodi</surname>
          <given-names>Alice</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Di Nanni</surname>
          <given-names>Noemi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cifola</surname>
          <given-names>Ingrid</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moscatelli</surname>
          <given-names>Marco</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cocola</surname>
          <given-names>Cinzia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gnocchi</surname>
          <given-names>Matteo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Piscitelli</surname>
          <given-names>Eleonora</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sula</surname>
          <given-names>Ada</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zucchi</surname>
          <given-names>Ileana</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reinbold</surname>
          <given-names>Rolland</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Milanesi</surname>
          <given-names>Luciano</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mezzelani</surname>
          <given-names>Alessandra</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Pelucchi</surname>
          <given-names>Paride</given-names>
        </name>
        <address>
          <email>paride.pelucchi@itb.cnr.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3102-5150</contrib-id>
        <name>
          <surname>Mosca</surname>
          <given-names>Ettore</given-names>
        </name>
        <address>
          <email>ettore.mosca@itb.cnr.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.5326.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 1940 4177</institution-id><institution>Institute of Biomedical Technologies, </institution><institution>National Research Council, </institution></institution-wrap>Via Fratelli Cervi 93, 20054 Segrate, Milan Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>445</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Introduction</title>
        <p id="Par1">Single-cell (SC) gene expression analysis is crucial to dissect the complex cellular heterogeneity of solid tumors, which is one of the main obstacles for the development of effective cancer treatments. Such tumors typically contain a mixture of cells with aberrant genomic and transcriptomic profiles affecting specific sub-populations that might have a pivotal role in cancer progression, whose identification eludes bulk RNA-sequencing approaches. We present scMuffin, an R package that enables the characterization of cell identity in solid tumors on the basis of a various and complementary analyses on SC gene expression data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">scMuffin provides a series of functions to calculate qualitative and quantitative scores, such as: expression of marker sets for normal and tumor conditions, pathway activity, cell state trajectories, Copy Number Variations, transcriptional complexity and proliferation state. Thus, scMuffin facilitates the combination of various evidences that can be used to distinguish normal and tumoral cells, define cell identities, cluster cells in different ways, link genomic aberrations to phenotypes and identify subtle differences between cell subtypes or cell states. We analysed public SC expression datasets of human high-grade gliomas as a proof-of-concept to show the value of scMuffin and illustrate its user interface. Nevertheless, these analyses lead to interesting findings, which suggest that some chromosomal amplifications might underlie the invasive tumor phenotype and the presence of cells that possess tumor initiating cells characteristics.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The analyses offered by scMuffin and the results achieved in the case study show that our tool helps addressing the main challenges in the bioinformatics analysis of SC expression data from solid tumors.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05563-y.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell transcriptomics</kwd>
      <kwd>Cancer</kwd>
      <kwd>Tumor heterogeneity</kwd>
      <kwd>Cell identity</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100021856</institution-id>
            <institution>Ministero dell'Università e della Ricerca</institution>
          </institution-wrap>
        </funding-source>
        <award-id>IR0000031</award-id>
        <award-id>PIR01_00017</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000780</institution-id>
            <institution>European Commission</institution>
          </institution-wrap>
        </funding-source>
        <award-id>IR0000031</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par20">Single-cell (SC) gene expression analysis is crucial to dissect the complex cellular heterogeneity of solid tumors, which is one of the main obstacles for the development of effective cancer treatments [<xref ref-type="bibr" rid="CR1">1</xref>]. A relevant number of software tools has been developed in recent years in the field of SC data analysis [<xref ref-type="bibr" rid="CR2">2</xref>], a fact that stresses the key opportunities and challenges in this field. A recent study has shown that the development of tools that address common tasks (e.g., clustering of similar cells) and ordering of cells (e.g., definition of cell trajectories) is decreasing, while a greater focus is being paid on data integration and classification [<xref ref-type="bibr" rid="CR2">2</xref>]. These observations reflect the growing availability, scale and complexity of SC datasets [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par21">SC datasets of solid tumors are typical examples of complex datasets that present a series of computational challenges and whose analysis demands domain-specific and integrative approaches. In fact, solid tumors typically contain a mixture of cells with aberrant genomic and transcriptomic profiles affecting specific sub-populations that might play a pivotal role in cancer progression, whose identification eludes bulk RNA-sequencing approaches. The use of cell type-specific markers (when available) is limited, and the alterations of gene expression that mark cancer cells makes the use of markers for normal cells not completely adequate. Moreover, the molecular heterogeneity of cancer cells (due to both intra-tumor and inter-individual differences) poses intrinsic limits in the definition of such markers. In addition, solid tumor samples typically comprise cells from the surrounding tissue or infiltrating cells that need to be distinguished from tumor populations for an effective analysis. Another challenge is the identification of clinically relevant cell subtypes that may be rare in the tumor mass, such as cancer stem cells or drug resistant subclones: because of their relatively low number, these cells are typically clustered together with many others. Lastly, an intrinsic problem of many SC datasets is the sequencing depth limit at the SC level. These limitations bound the number of detectable genes to the few thousands of the highest expressed genes, which implies, for example, that some established markers may not be used for data analysis.</p>
    <p id="Par22">To address these challenges, we developed scMuffin, an R package that implements a series of complementary analyses aimed at shedding light on the complexity of solid tumor SC expression data, including: a fast and customizable gene set scoring system; gene sets from various sources, including pathways, cancer functional states and cell markers; cell cluster association analysis with quantitative (e.g., gene set scores) as well as categorical (e.g. mutation states, proliferation states) features; copy number variation (CNV) analysis; transcriptional complexity analysis; proliferation rate quantification; and gene set based multi-dataset analysis (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). scMuffin facilitates the integrative analysis of these multiple features, thus allowing the identification of cell subtypes that elude more general clustering and classification approaches. We describe the key aspects of scMuffin implementation and then its user interface by means of a case study on a public SC expression dataset of human high-grade gliomas (HGG).<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of scMuffin package. scMuffin offers the possibility to perform several different analyses and data integration approaches to address the main challenges of SC gene expression analysis in solid tumors</p></caption><graphic xlink:href="12859_2023_5563_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par23">scMuffin is implemented as an R package and provides a series of functions that allows the user to quantify various genetic and phenotypic characteristics of single cells, which can be combined to obtain insights on cell identity and function. The functions of scMuffin operate on a common data structure, the “scMuffinList”, by adding, changing or removing its elements. Computationally intensive tasks (in particular, gene set scoring and CNV inference) are parallelized. Package documentation includes R vignettes and function documentation, which are also available as “GitHub Pages” at the URL <ext-link ext-link-type="uri" xlink:href="https://emosca-cnr.github.io/scMuffin">https://emosca-cnr.github.io/scMuffin</ext-link>. In this section, we describe package inputs and the main algorithms and definitions underlying the analyses offered by scMuffin.</p>
    <sec id="Sec3">
      <title>Input</title>
      <p id="Par24">scMuffin is intended to be used downstream to general purpose tasks like quality control, normalization, cell clustering and dataset integration, for which there are dedicated tools, such as Seurat [<xref ref-type="bibr" rid="CR3">3</xref>]. scMuffin requires the genes-by-cells raw counts matrix, genes-by-cells normalized expression matrix and a partition of cells in clusters. Typically, these matrices are filtered during preprocessing steps to exclude low quality cells and genes that could negatively affect the analyses. However, the characterization of cells that can be achieved with scMuffin offers insights that can be used to (further) filter the dataset and/or to decide on which cells apply particular analyses (e.g. biomarker identification). In general, according to research questions and experimental design one may want to apply strong or mild filters before using scMuffin.</p>
    </sec>
    <sec id="Sec4">
      <title>Quantification of gene set expression scores at cell and cluster levels</title>
      <p id="Par25">The quantification of gene set expression scores follows the approach described in [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>], in which a gene set is scored on the basis of its average deviation from an empirical null. The approach is implemented enabling the user to tune various parameters (e.g., the minimum number of cells in which a gene set must be expressed, the number of bins of the null model and the possible removal of missing values) to better address the needs of a particular study in relation to the characteristics of the dataset under analysis. In particular, the code is implemented to handle missing values, which are one of the main issues in SC datasets. For example, this is important to quantify the expression of gene sets that are expressed just in a small subset of cells (and have null values elsewhere), or to account for the expression of different members of the same pathway in different cells.</p>
      <p id="Par26">The algorithm for gene set scoring is the following. Given a gene set <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M2"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq1.gif"/></alternatives></inline-formula>:<list list-type="bullet"><list-item><p id="Par27">1. the genes occurring in the normalized genes-by-cells matrix are grouped into a series of bins according to their average expression across cells;</p></list-item><list-item><p id="Par28">2. a number <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M4"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq2.gif"/></alternatives></inline-formula> of random gene sets <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{i}^{*}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq3.gif"/></alternatives></inline-formula>: are created, of the same size of <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M8"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq4.gif"/></alternatives></inline-formula>, tossing genes from the same bins of <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M10"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq5.gif"/></alternatives></inline-formula>, in order to match the distribution of gene expression of each <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{i}^{*}$$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq6.gif"/></alternatives></inline-formula> with that of <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M14"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq7.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par29">3. the averages <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{c}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{ic}^{*}$$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq9.gif"/></alternatives></inline-formula> are calculated, respectively, over the values of <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M20"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{i}^{*}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq11.gif"/></alternatives></inline-formula> in every cell <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M24"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq12.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par30">4. the expression score <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{c}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq13.gif"/></alternatives></inline-formula> is calculated as the average difference between <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{c}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq14.gif"/></alternatives></inline-formula> and <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{ic}^{*}$$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq15.gif"/></alternatives></inline-formula>:<disp-formula id="Equa"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{c} = \frac{{\mathop \sum \nolimits_{i}^{k} \left( {m_{c} - m_{ic}^{*} } \right)}}{k}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mi>k</mml:mi></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par31">5. the difference between the medians of <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{c}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{ic}^{*}$$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq17.gif"/></alternatives></inline-formula> values in any cluster is used as the cluster-level score of <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M38"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq18.gif"/></alternatives></inline-formula>.</p></list-item></list></p>
    </sec>
    <sec id="Sec5">
      <title>CNV estimation based on adjacent gene expression</title>
      <p id="Par32">CNV inference in scMuffin is based on the “adjacent gene windows” approach [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], which has been validated using both single nucleotide polymorphism arrays [<xref ref-type="bibr" rid="CR6">6</xref>] and whole-exome sequencing [<xref ref-type="bibr" rid="CR4">4</xref>]. The approach is implemented in parallel and, like gene set scoring, offers various parameter tuning and data filtering possibilities, which allow the investigator to optimize the analysis to specific needs. The CNV profile of each cell is calculated as a moving average of scaled gene expression levels ordered by genomic location. scMuffin offers the possibility of subtracting a “normal” reference profile to highlight relative CNVs. Since a SC dataset derived from a sample of a solid tumor can either contain or not a proper set of physiological cells to be used as reference, this reference can be derived from cells that are part of the dataset under analysis (as described in [<xref ref-type="bibr" rid="CR4">4</xref>]), or using external dataset (as described in [<xref ref-type="bibr" rid="CR6">6</xref>]). The main steps are:<list list-type="order"><list-item><p id="Par33">the reference cells are added to the genes-by-cells matrix (optional);</p></list-item><list-item><p id="Par34">the expression of each gene is scaled subtracting its average (optional);</p></list-item><list-item><p id="Par35">the gene expression matrix is ordered by chromosome and gene location;</p></list-item><list-item><p id="Par36">in each chromosome <italic>h</italic>, the estimated copy number <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq19.gif"/></alternatives></inline-formula> of cell <italic>c</italic> is calculated for all the ordered genes <inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \left[ {\frac{w}{2} + 1,n_{h} - \frac{w}{2}} \right]$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq20.gif"/></alternatives></inline-formula>:<disp-formula id="Equb"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic} = \mathop \sum \limits_{{j = i - \frac{w}{2}}}^{{i + \frac{w}{2}}} \frac{{e_{jc} }}{w + 1}$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:munderover><mml:mfrac><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">jc</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list>where <italic>w</italic> is an even number that defines the window size, that is, the number of genes located before and after gene <italic>i</italic> which contribute to the estimation of <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq21.gif"/></alternatives></inline-formula>, <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{h}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq22.gif"/></alternatives></inline-formula> is the number of genes in <italic>h</italic>, and <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{jc}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">jc</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq23.gif"/></alternatives></inline-formula> is the gene expression value;<list list-type="simple"><list-item><label>5.</label><p id="Par37"><inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq24.gif"/></alternatives></inline-formula> values are scaled subtracting their average in a cell (optional);</p></list-item><list-item><label>6.</label><p id="Par38">cells are clustered by their CNV profile;</p></list-item><list-item><label>7.</label><p id="Par39">the average CNV profile of the normal reference cells is subtracted from all the CNV profiles (optional).</p></list-item><list-item><label>8.</label><p id="Par40">the CNV score of a cell is calculated as:<disp-formula id="Equc"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{c} = \mathop \sum \limits_{i} \left( {V_{ic} } \right)^{2}$$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
      <p id="Par41">Cells are clustered based on their CNV profile using Seurat [<xref ref-type="bibr" rid="CR3">3</xref>]. A CNV region of a cluster is composed of the adjacent genes <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M56"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq25.gif"/></alternatives></inline-formula> that have absolute median <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq26.gif"/></alternatives></inline-formula> (within the cluster) higher than a given threshold. This threshold is by default defined as the standard deviation of <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq27.gif"/></alternatives></inline-formula> values of all cells.</p>
    </sec>
    <sec id="Sec6">
      <title>Transcriptional complexity</title>
      <p id="Par42">The transcriptional complexity (TC) is calculated using three different approaches. The TC-R <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{R}$$\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq28.gif"/></alternatives></inline-formula> of a cell is inferred based on the number of expressed genes <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(g_{c} )$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq29.gif"/></alternatives></inline-formula> over the number of total mapped reads (transcripts) <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(t_{c} )$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq30.gif"/></alternatives></inline-formula>:<disp-formula id="Equd"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{R} = \frac{{g_{c} }}{{t_{c} }} \cdot \frac{{\mathop {\max }\limits_{c} \left( {t_{c} } \right)}}{{\mathop {\max }\limits_{c} \left( {g_{c} } \right)}}$$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfrac><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo movablelimits="false">max</mml:mo><mml:mi>c</mml:mi></mml:munder><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:munder><mml:mo movablelimits="false">max</mml:mo><mml:mi>c</mml:mi></mml:munder><mml:mfenced close=")" open="("><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{c} = \# \left\{ {r_{ic} \ge \alpha } \right\}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>#</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq31.gif"/></alternatives></inline-formula>, <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M72"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq32.gif"/></alternatives></inline-formula> is a threshold over the gene count <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{ic}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq33.gif"/></alternatives></inline-formula> and defines the gene <italic>i</italic> as “expressed”, and <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{c} = \sum\nolimits_{i} {r_{ic} }$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq34.gif"/></alternatives></inline-formula>. Values of <inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{R}$$\end{document}</tex-math><mml:math id="M78"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq35.gif"/></alternatives></inline-formula> higher (lower) than 1 indicate a higher (lower) number of expressed genes in relation to the total transcripts of the cell.</p>
      <p id="Par43">The TC-LMR (linear model residual) of a cell corresponds to its residual in the linear regression model between <inline-formula id="IEq36"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{c}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq36.gif"/></alternatives></inline-formula> and <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{c}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq37.gif"/></alternatives></inline-formula>:<disp-formula id="Eque"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{log}}_{10} \left( {g_{c} } \right) = \beta_{0} + \beta_{1} {\text{log}}_{10} \left( {t_{c} } \right) + \varepsilon_{c}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:msub><mml:mtext>log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mtext>log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Eque.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equf"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{LMR} = {\text{log}}_{10} \left( {g_{c} } \right) - \left[ {\beta_{0} + \beta_{1} {\text{log}}_{10} \left( {t_{c} } \right)} \right].$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">LMR</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mtext>log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mtext>log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par44">Positive (negative) residuals indicate higher (lower) number of expressed genes in relation to total transcripts.</p>
      <p id="Par45">The TC-H (entropy) is quantified as the transcriptional entropy of the cell [<xref ref-type="bibr" rid="CR7">7</xref>]:<disp-formula id="Equg"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{H} = - \mathop \sum \limits_{ic} \left[ {p_{ic} {\text{ log}}\left( {p_{ic} } \right)} \right]$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>log</mml:mtext></mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equg.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq38"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{ic} = r_{ic} /t_{c}$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq38.gif"/></alternatives></inline-formula>. The higher the entropy the higher the number of expressed genes.</p>
    </sec>
    <sec id="Sec7">
      <title>Proliferation rate</title>
      <p id="Par46">The proliferation rate <inline-formula id="IEq39"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{c}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>P</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq39.gif"/></alternatives></inline-formula> of a cell is quantified as the maximum between the two gene set scores <inline-formula id="IEq40"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{c} \left( {S_{1} } \right)$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{c} \left( {S_{2} } \right)$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq41.gif"/></alternatives></inline-formula>, calculated on the gene sets <inline-formula id="IEq42"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{1}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq42.gif"/></alternatives></inline-formula> and <inline-formula id="IEq43"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{2}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq43.gif"/></alternatives></inline-formula> that contain, respectively, genes involved in G1/S and G2/M cell cycle phases:<disp-formula id="Equh"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{c} = {\text{max}}\left( {Y_{c} \left( {S_{1} } \right), Y_{c} \left( {S_{2} } \right)} \right)$$\end{document}</tex-math><mml:math id="M102" display="block"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equh.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq44"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{1}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq44.gif"/></alternatives></inline-formula> and <inline-formula id="IEq45"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{2}$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq45.gif"/></alternatives></inline-formula> are defined as in Tirosh et al. [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    </sec>
    <sec id="Sec8">
      <title>Cluster enrichment analysis for quantitative and categorical features</title>
      <p id="Par47">The association between cell clusters and any cell-level feature is performed through Cell Set Enrichment Analysis (CSEA) and Over Representation Analysis (ORA) for, respectively, quantitative and categorical values. Importantly, these two types of analysis are implemented in parallel, which is particularly important for CSEA that uses permutations to build an empirical null distribution.</p>
      <p id="Par48">CSEA is the application of Gene Set Enrichment Analysis (GSEA) [<xref ref-type="bibr" rid="CR8">8</xref>] to cells and cell sets in place of, respectively, genes and gene sets: a ranked cell list is used instead of a ranked gene list, and cell sets (cell clusters) are tested instead of gene sets. In addition, the code is implemented to handle missing values. Therefore, scMuffin tests whether the cells assigned to a cluster are located at the top (bottom) of a ranked list of cells.</p>
      <p id="Par49">The assessment of cluster enrichment in a particular value of a categorical feature is computed using the over-representation analysis (ORA) approach [<xref ref-type="bibr" rid="CR9">9</xref>], which is based on the hypergeometric test. Here, this test assesses whether the occurrence of a particular value between the cells of a cluster in relation to all other clusters is higher than expected in a hypergeometric experiment.</p>
    </sec>
    <sec id="Sec9">
      <title>Overlap between partitions of cells</title>
      <p id="Par50">Cell partitions resulting from different clustering analyses are compared by calculating the overlap coefficients among all-pairs of clusters. Given two partitions <italic>A</italic> and <italic>B</italic>, defined as sets of cell clusters <inline-formula id="IEq46"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A = \left\{ {a_{i} } \right\}{ }$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq46.gif"/></alternatives></inline-formula> and <inline-formula id="IEq47"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B = \left\{ {b_{j} } \right\}$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq47.gif"/></alternatives></inline-formula>, the similarity between the cell clusters <inline-formula id="IEq48"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{i}$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq48.gif"/></alternatives></inline-formula> and <inline-formula id="IEq49"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{j}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq49.gif"/></alternatives></inline-formula> is calculated as:<disp-formula id="Equi"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_{ij} = \frac{{\left| {a_{i} \cap b_{j} } \right|}}{{\min \left( {\left| {a_{i} } \right|,\left| {b_{j} } \right|} \right)}}$$\end{document}</tex-math><mml:math id="M116" display="block"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close="|" open="|"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Results and discussion</title>
    <p id="Par51">In this section, we present the user interface (Table <xref rid="Tab1" ref-type="table">1</xref>), taking advantage of the results obtained on the SC dataset generated by Yuan et al. [<xref ref-type="bibr" rid="CR10">10</xref>] from human high-grade glioma (HGG) samples (available on the Gene Expression Omnibus (GEO) repository [<xref ref-type="bibr" rid="CR11">11</xref>] with identifier GSE103224, see Supplementary Methods in Additional file <xref rid="MOESM1" ref-type="media">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Main tasks and corresponding functions in scMuffin</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Task</th><th align="left">Description</th><th align="left">User interface</th></tr></thead><tbody><tr><td align="left">Create the scMuffinList</td><td align="left">Create the scMuffinList from counts and normalized expression data</td><td align="left">create_scMuffinList()</td></tr><tr><td align="left">Add a partition</td><td align="left">Add a partition of cell (clusters)</td><td align="left">add_partition()</td></tr><tr><td align="left">Gene set expression scoring</td><td align="left"><p>Average gene set expression deviation from matched empirical reference</p><p>Provided gene sets from CellMarker [<xref ref-type="bibr" rid="CR12">12</xref>], PanglaoDB [<xref ref-type="bibr" rid="CR13">13</xref>], CancerSEA [<xref ref-type="bibr" rid="CR14">14</xref>] and MSigDB [<xref ref-type="bibr" rid="CR8">8</xref>]</p></td><td align="left"><p>prepare_gsls()</p><p>calculate_gs_scores()</p><p>calculate_gs_scores_in_clusters()</p></td></tr><tr><td align="left">CNV</td><td align="left"><p>Estimation of CNVs by means of the “moving window” approach, that is, considering the expression of adjacent genes</p><p>Calculation of CNV deviation from a normal reference profile</p><p>Processing of normal tissue-specific expression data from GTEx</p><p>Detection of CNV regions</p></td><td align="left"><p>CNV_analysis()</p><p>process_GTEx_gene_reads()</p></td></tr><tr><td align="left">Transcriptional complexity</td><td align="left">Number of expressed genes in relation to the total reads, calculated using a ratio, linear model residuals and entropy</td><td align="left">transcr_compl()</td></tr><tr><td align="left">Proliferation</td><td align="left">Maximum between G1/S and G2/M gene set scores</td><td align="left">proliferation_analysis()</td></tr><tr><td align="left">Cell state trajectory</td><td align="left">Diffusion map computation</td><td align="left">diff_map()</td></tr><tr><td align="left">Cell cluster annotation</td><td align="left">Assessment of cluster enrichment for quantitative and categorical features</td><td align="left">assess_cluster_enrichment()</td></tr><tr><td align="left">Comparison of datasets</td><td align="left">Assessment of cluster markers or gene set expression across multiple datasets</td><td align="left">inter_dataset_comparison()</td></tr><tr><td align="left">Visualization</td><td align="left"><p>Automated UMAP visualizations for multiple features</p><p>Heatmaps: gene set scores, CNV, overlap between clusters</p><p>Boxplots and barplots of cluster enrichment</p><p>Diffusion maps</p></td><td align="left"><p>boxplot_cluster()</p><p>dotplot_cluster()</p><p>heatmap_CNV()</p><p>plot_profile_CNV()</p><p>plot_umap_colored_features()</p><p>plot_heatmap_features_by_clusters()</p><p>plot_diff_map()</p></td></tr></tbody></table></table-wrap></p>
    <sec id="Sec11">
      <title>Gene set scoring</title>
      <p id="Par52">scMuffin provides functions to set up one or more gene set collections and perform SC-level estimation of gene set expression scores in relation to an empirical null model (see Implementation section). This can be applied to any gene set and can therefore be used to estimate several different cell phenotypes, like pathway activities or marker set expression.</p>
      <p id="Par53">The function prepare_gsls() allows the user to collect gene sets of cell types, pathways, cancer functional states, as well as other collections of gene sets (e.g. positional gene sets, hallmarks) from CellMarker [<xref ref-type="bibr" rid="CR12">12</xref>], PanglaoDB [<xref ref-type="bibr" rid="CR13">13</xref>], CancerSEA [<xref ref-type="bibr" rid="CR14">14</xref>] and MSigDB [<xref ref-type="bibr" rid="CR8">8</xref>] databases. Unlike many existing tools that are used to perform marker-based cell annotation [<xref ref-type="bibr" rid="CR15">15</xref>], the availability of these gene sets within scMuffin package spares the user the effort of data collection and harmonization. The function, which also accepts any user-given gene sets, applies a series of criteria (e.g., minimum and maximum number of genes in a gene set) to filter the chosen gene sets.</p>
      <p id="Par54">The cell-level expression scores for these gene sets can be calculated using calculate_gs_scores(). For instance, the following code shows how to quantify the activity of “Cancer functional states” from CancerSEA [<xref ref-type="bibr" rid="CR14">14</xref>] at cell and cell cluster level:</p>
      <p id="Par55">
gsc &lt;- prepare_gsls(gs_sources = "CancerSEA", scMuffinList = scML)
</p>
      <p id="Par56">
scML &lt;- calculate_gs_scores(scMuffinList = scML, gs_list = gsc$CancerSEA)
</p>
      <p id="Par57">scML &lt;- calculate_gs_scores_in_clusters(scMuffinList = scML, partition_id = "global_expr")</p>
      <p id="Par58">where scML is the data structure that contains expression data and cell clusters (“global_expr”).</p>
      <p id="Par59">Cluster-level gene sets scores can be visualized as a heatmap to obtain a useful summary visualization that can provide insights for cluster annotation. This is accomplished by means of the function plot_heatmap_features_by_clusters(), which relies on the powerful ComplexHeatmap R package [<xref ref-type="bibr" rid="CR16">16</xref>]). For example, the analysis of the CancerSEA functional states in the HGG sample PJ016 showed that the two groups of cell clusters that are spatially separated in the UMAP visualization, that is clusters {0, 6, 8, 9} and {1, 2, 3, 4, 5, 7} (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), reflect distinct functional states (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Cell-level gene set scores can be visualized over the UMAP by means of plot_umap_colored_features() (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). <fig id="Fig2"><label>Fig. 2</label><caption><p>Quantification of CancerSEA functional states in the HGG sample PJ016. <bold>a</bold> UMAP visualization where cells are coloured by expression clusters. <bold>b</bold> Cluster-level expression scores (z-score) of all the CancerSEA functional states. <bold>c</bold> UMAP visualization where cells are colored by “Invasion” gene set score</p></caption><graphic xlink:href="12859_2023_5563_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>CNV estimation and association with CancerSEA functional states</title>
      <p id="Par60">CNV inference from SC transcriptomics in cancer provides a means to assess the presence of relevant genomic aberrations (duplications and deletions) based on the expression of adjacent genes. This knowledge offers crucial clues to address the difficult task of distinguishing normal from malignant cells and provides quantitative information to reconstruct the tumor clonal substructure. Moreover, CNV patterns allow the investigator to hypothesize link between genomic alterations and cell phenotypes. As a proof-of-concept, we describe CNV inference in scMuffin with and without a reference expression profile, and the association of CNV clusters with CancerSEA functional states.</p>
      <p id="Par61">CNV inference is performed by means of the function CNV_analysis(): </p>
      <p id="Par62">
scML &lt;- CNV_analysis(scMuffinList = scML, reference = GTEx_mean, center_genes = TRUE)
</p>
      <p id="Par63">where GTEx_mean contains a reference expression profile, which can be obtained by means of the function process_GTEx_gene_reads() starting from data available at The Genotype-Tissue Expression (GTEx) portal [<xref ref-type="bibr" rid="CR17">17</xref>]. The resulting scMuffinList scML contains the matrix with CNV values for each genomic regions in every cell, cell clusters by CNV, detected CNV regions and mapping information between gene locations and CNV regions.</p>
      <p id="Par64">Heatmaps that show CNV profiles of every cell, clustered by similarity, can be generated by means of plot_heatmap_CNV(). In the considered dataset (PJ030), we observed that the reference profile (normal brain samples from GTEx) is included into cluster 3, while clusters 0, 1 and 2 show large aneuploidies, some of which are typical of HGG, like the amplification of chromosome 7 as reported by dataset authors [<xref ref-type="bibr" rid="CR10">10</xref>] (Table <xref rid="Tab2" ref-type="table">2</xref>, Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, b). The median CNV profile of every cell cluster can be visualized by means of plot_profile_CNV() (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c) while boxplots of the distribution of CNV score by clusters can be visualized through boxplot_points() (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d).<table-wrap id="Tab2"><label>Table 2</label><caption><p>CNV regions detected in chromosomes 7 and 19 of sample PJ030</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Chr</th><th align="left">Start (location)</th><th align="left">Stop (location)</th><th align="left">Cluster</th><th align="left">Length</th></tr></thead><tbody><tr><td align="left">chr7</td><td char="," align="char">497,259</td><td char="," align="char">132,784,870</td><td char="." align="char">0</td><td char="," align="char">132,287,611</td></tr><tr><td align="left">chr7</td><td char="," align="char">497,259</td><td char="," align="char">132,784,870</td><td char="." align="char">1</td><td char="," align="char">132,287,611</td></tr><tr><td align="left">chr7</td><td char="," align="char">497,259</td><td char="," align="char">132,784,870</td><td char="." align="char">2</td><td char="," align="char">132,287,611</td></tr><tr><td align="left">chr19</td><td char="," align="char">416,582</td><td char="," align="char">48,872,391</td><td char="." align="char">0</td><td char="," align="char">48,455,809</td></tr><tr><td align="left">chr19</td><td char="," align="char">1,793,3014</td><td char="," align="char">58,551,565</td><td char="." align="char">1</td><td char="," align="char">40,618,551</td></tr><tr><td align="left">chr19</td><td char="," align="char">416,582</td><td char="," align="char">49,906,825</td><td char="." align="char">2</td><td char="," align="char">49,490,243</td></tr></tbody></table></table-wrap><fig id="Fig3"><label>Fig. 3</label><caption><p>CNV analysis (PJ030). <bold>a</bold> CNV heatmap where cells (columns) are grouped into “CNV clusters”; the cluster of cells that include the reference profile is highlighted through a red label. <bold>b</bold> UMAP visualizations where cells are colored by CNV clusters. <bold>c</bold> z-score of cluster 0 median CNV profile. <bold>d</bold> Distribution of cell CNV score (<italic>C</italic>) in clusters</p></caption><graphic xlink:href="12859_2023_5563_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par65">The analysis of another dataset (PJ016, without reference profile) showed two groups of clusters ({0, 1, 4} and {2, 3}) that map to separated regions of the UMAP visualization (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, b). Interestingly, clusters 2 and 3 are marked by peculiar amplifications in chromosome arms 1p and 19p. These “CNV clusters” correspond to expression clusters {0, 6, 8, 9} (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). The similarity of multiple cell partitions can be quantified using the function overlap_matrix().<fig id="Fig4"><label>Fig. 4</label><caption><p>CNV analysis and CancerSEA functional states (PJ016). <bold>a</bold> CNV heatmap where cells (columns) are grouped into “CNV clusters”. <bold>b</bold> UMAP visualizations where cells are colored by CNV clusters. <bold>c</bold> Overlap indices between expression clusters (prefix “EXPR_”) and CNV clusters (prefix “CNV_”). <bold>d</bold> Heatmap of CancerSEA functional state expression score (z-score) in CNV clusters</p></caption><graphic xlink:href="12859_2023_5563_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par66">An example of integrative analysis enabled by scMuffin is the functional assessment of CNV clusters. We quantified the expression scores of CancerSEA functional states throughout the CNV clusters of sample PJ016. As expected, the two aforementioned groups of CNV clusters {0, 1, 4} and {2, 3} are characterized by different functional states (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). This finding suggests that the peculiar amplifications of chromosomes 1 and 19 that characterize these clusters might underlie two phenotypes. A suggestive evidence of such hypothesis, with regards to the CancerSEA functional state “Invasion”, is the location of the two Invasion markers <italic>YBX1</italic> (Y-Box Binding Protein 1) and <italic>HNRNPM</italic> (Heterogeneous Nuclear Ribonucleoprotein M) within the amplified regions of chromosomes 1p and 19p (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a)<italic>. YBX1</italic> is a DNA/RNA-binding protein and transcription factor which plays a central role in coordinating tumor invasion in glioblastoma [<xref ref-type="bibr" rid="CR18">18</xref>]. <italic>HNRNPM</italic> belongs to a family of spliceosome auxiliary factors and is involved in the regulation of splicing; the upregulation of these factors results in tumor-associated aberrant splicing, which promotes glioma progression and malignancy [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. In particular, HNRNPM was identified as an interactor of the DNA/RNA binding protein SON, which drives oncogenic RNA splicing in glioblastoma [<xref ref-type="bibr" rid="CR21">21</xref>]. While it is beyond the scope of this article to validate this hypothesis, these findings clearly highlight the usefulness of the integrative analysis of CNVs and CancerSEA functional states provided by scMuffin.</p>
    </sec>
    <sec id="Sec13">
      <title>Cluster enrichment analysis: association of clusters and features</title>
      <p id="Par67">scMuffin contains functions for assessing the association between cell clusters and quantitative as well as categorical features, by means of CSEA and ORA, respectively. The function assess_cluster_enrichment() performs CSEA and ORA accordingly to the feature type under consideration. For example, the following instruction runs CSEA over the gene set scores, considering the partition “global_expr”:</p>
      <p id="Par68">
scML &lt;- assess_cluster_enrichment(scMuffinList = scML, feature_name = "gene_set_scoring", partition_id = "global_expr")
</p>
      <p id="Par69">The results of CSEA and ORA include several quantities, such as the normalized enrichment score (NES), the enrichment ratio (ER) and the false discovery rate (FDR) (Tables <xref rid="Tab3" ref-type="table">3</xref>, <xref rid="Tab4" ref-type="table">4</xref>). These results can be visualized as boxplots (quantitative features) and barplots (categorical features). For instance, the cluster 0 of sample PJ016 is particularly enriched—as expected—in “Invasion” markers (Table <xref rid="Tab3" ref-type="table">3</xref>, Fig. <xref rid="Fig5" ref-type="fig">5</xref>a) and cells assigned to G2/M or S phases (Table <xref rid="Tab4" ref-type="table">4</xref>, Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). The function extract_cluster_enrichment_table() provides a means to obtain tables of enrichment results across clusters, which can be visualized as heatmaps (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c), while extract_cluster_enrichment_tags() defines the most significant features as cluster labels that are therefore available for annotating UMAPs (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d).<table-wrap id="Tab3"><label>Table 3</label><caption><p>The output of CSEA analysis for a quantitative feature</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Cluster</th><th align="left">ES</th><th align="left">p</th><th align="left">p (BH)</th><th align="left">NES</th><th align="left">q (FDR)</th></tr></thead><tbody><tr><td align="left">0</td><td char="." align="char">0.67</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">2.38</td><td char="." align="char">0.01</td></tr><tr><td align="left">1</td><td char="." align="char">0.22</td><td char="." align="char">0.99</td><td char="." align="char">0.99</td><td char="." align="char">0.80</td><td char="." align="char">0.97</td></tr><tr><td align="left">2</td><td char="." align="char">-0.21</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">0.00</td><td char="." align="char">1.00</td></tr><tr><td align="left">3</td><td char="." align="char">-0.15</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">0.00</td><td char="." align="char">1.00</td></tr><tr><td align="left">4</td><td char="." align="char">-0.11</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">0.00</td><td char="." align="char">1.00</td></tr><tr><td align="left">5</td><td char="." align="char">0.25</td><td char="." align="char">0.80</td><td char="." align="char">0.89</td><td char="." align="char">0.92</td><td char="." align="char">0.90</td></tr><tr><td align="left">6</td><td char="." align="char">0.29</td><td char="." align="char">0.31</td><td char="." align="char">0.39</td><td char="." align="char">1.05</td><td char="." align="char">0.41</td></tr><tr><td align="left">7</td><td char="." align="char">0.33</td><td char="." align="char">0.11</td><td char="." align="char">0.18</td><td char="." align="char">1.14</td><td char="." align="char">0.20</td></tr><tr><td align="left">8</td><td char="." align="char">0.32</td><td char="." align="char">0.13</td><td char="." align="char">0.19</td><td char="." align="char">1.13</td><td char="." align="char">0.18</td></tr><tr><td align="left">9</td><td char="." align="char">0.71</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">2.43</td><td char="." align="char">0.01</td></tr></tbody></table><table-wrap-foot><p>This result is relative to the CancerSEA Invasion gene set on dataset PJ016</p><p><italic>ES</italic> Enrichment score, <italic>p</italic> CSEA <italic>p</italic> value, <italic>p (BH) p</italic> value after Bonferroni–Hochberg correction, <italic>NES</italic> Normalized enrichment score, <italic>q (FDR)</italic> q value of FDR</p></table-wrap-foot></table-wrap><table-wrap id="Tab4"><label>Table 4</label><caption><p>The output of an ORA analysis for a categorical feature</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Cluster</th><th align="left">N</th><th align="left">wb</th><th align="left">bb</th><th align="left">bd</th><th align="left">wbd</th><th align="left">exp</th><th align="left">ER</th><th align="left">p</th><th align="left">p (BH)</th></tr></thead><tbody><tr><td align="left">0</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">499</td><td char="." align="char">239</td><td char="." align="char">67.05</td><td char="." align="char">3.56</td><td align="left">1.67 × 10<sup>−105</sup></td><td align="left">8.34 × 10<sup>−105</sup></td></tr><tr><td align="left">1</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">475</td><td char="." align="char">4</td><td char="." align="char">63.83</td><td char="." align="char">0.06</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">2</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">378</td><td char="." align="char">4</td><td char="." align="char">50.79</td><td char="." align="char">0.08</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">3</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">309</td><td char="." align="char">2</td><td char="." align="char">41.52</td><td char="." align="char">0.05</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">4</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">296</td><td char="." align="char">7</td><td char="." align="char">39.77</td><td char="." align="char">0.18</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">5</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">257</td><td char="." align="char">0</td><td char="." align="char">34.53</td><td char="." align="char">0.00</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">6</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">185</td><td char="." align="char">4</td><td char="." align="char">24.86</td><td char="." align="char">0.16</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">7</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">172</td><td char="." align="char">0</td><td char="." align="char">23.11</td><td char="." align="char">0.00</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">8</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">142</td><td char="." align="char">5</td><td char="." align="char">19.08</td><td char="." align="char">0.26</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">9</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">115</td><td char="." align="char">115</td><td char="." align="char">15.45</td><td char="." align="char">7.44</td><td align="left">2.47 × 10<sup>−108</sup></td><td align="left">2.47 × 10<sup>−107</sup></td></tr></tbody></table><table-wrap-foot><p>Enrichment of every cluster in cells in “G2M” phase (dataset PJ016). The cell cycle phase was calculated by means of the function “CellCycleScoring()” from Seurat package [<xref ref-type="bibr" rid="CR3">3</xref>]</p><p><italic>N</italic> Number of cells, <italic>wb</italic> Number G2M cells, <italic>bb</italic> N-wb, <italic>wbd</italic> Number of G2M cells in the cluster, <italic>exp</italic> Expected number of G2M cells in the cluster, <italic>ER</italic> Enrichment ratio, <italic>p</italic> Hypergeometric p, <italic>p (BH) p</italic> value after Bonferroni–Hochberg correction</p></table-wrap-foot></table-wrap><fig id="Fig5"><label>Fig. 5</label><caption><p>Cluster enrichment analysis (PJ016). <bold>a</bold> Output of boxplot_cluster() function for a quantitative feature—CancerSEA functional states—in cluster 0: distribution of gene set scores values (red) and corresponfing null models (gray, suffix “_ref”) (top); Normalized Enrichment Score (z-score) and FDR <italic>q</italic>-value (bottom). <bold>b</bold> Output of barplot_cluster() function for a categorical feature—cell cycle phase—in cluster 0: expected (“exp”) and observed (“obs”) occurrences of every possible category (top); enrichment ratio (ER) and hypergeometric <italic>p</italic>-value (bottom). <bold>c</bold> Heatmap of NES values for CancerSEA functional states in expression clusters; asterisks indicate FDR q-value &lt; 0.01. <bold>d</bold> UMAP visualization where clusters are labelled with the top three most significant CancerSEA functional states</p></caption><graphic xlink:href="12859_2023_5563_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>Transcriptional complexity, proliferation rate and cell state trajectories</title>
      <p id="Par70">The number of expressed genes and proliferation rate are two relevant pieces of information for the characterization of cell type and cell state in cancer.</p>
      <p id="Par71">Undifferentiated stem or progenitor cells show a high number of expressed genes (open chromatin state) compared to differentiated cell types. In cancer context, a high number of expressed genes might suggest tumor initiating cells (TICs) or might indicate de-differentiation processes of tumor progression [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. For instance, in a recent study on glioblastoma, chromatin accessibility was associated with a specific subpopulation of putative tumor-initiating Cancer Stem Cells (CSCs) with invasive phenotype and low survival rate prediction [<xref ref-type="bibr" rid="CR24">24</xref>]. The transcriptional complexity of a cell can be calculated as follows:</p>
      <p id="Par72">
scML &lt;- transcr_compl(scMuffinList = scML,
min_counts=3, min_cells=10, min_genes=500
)
</p>
      <p id="Par73">where min_counts is the threshold above which a gene is considered expressed, min_cells is the minimum number of cells in which a gene must be expressed and min_genes is the minimum number of genes that a cell must express. In SC datasets, transcriptional complexity quantification is complicated by the presence of a linear relationship between number of expressed genes and total transcripts detected, where biological variability is entangled with sequencing deepness. scMuffin provides three measures of transcriptional complexity, which show three different – but complementary—relations with the number of total transcripts (<italic>t</italic>): the ratio (TC-R) prioritizes cells with a relatively low <italic>t</italic> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a); the linear model residuals (TC-LMR) are independent from <italic>t</italic> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b); lastly, the transcriptional entropy (TC-H) [<xref ref-type="bibr" rid="CR7">7</xref>] highlights genes with relatively high number of <italic>t</italic> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). All three measures may provide useful insights for the identification of particular cell types or states. For example, TC-R could be used when one is not interested in cell with a relatively abundant RNA production, like can be the case of quiescent cells with stem-like properties.<fig id="Fig6"><label>Fig. 6</label><caption><p>Transcriptional complexity, proliferation rate and cell state trajectories (PJ016). <bold>a</bold> Transcriptional Complexity Ratio (TC-R) of cells. <bold>b</bold> Transcriptional Complexity Linear Model Residuals (TC-LMR) of cells. <bold>c</bold> Transcriptional Complexity Entropy (TC-H) of cells. <bold>d</bold> Distribution of TC-R values split by cell proliferation score <bold>e</bold>–<bold>f</bold> Distribution of cells according to the first two “diffusion components” (DC)</p></caption><graphic xlink:href="12859_2023_5563_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par74">The proliferation rate is a relevant indicator for distinguishing cell types in solid tumors and helps to identify cells with potential clinical relevance and interest as candidate therapeutic targets [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. Cell proliferation rate is quantified based on the expression of G1/S and G2/M genes:</p>
      <p id="Par75">
scML &lt;- proliferation_analysis(scMuffinList = scML).
</p>
      <p id="Par76">As a proof-of-concept we jointly analysed cell TC and cell proliferation of sample PJ016 and visualized the results on a diffusion map [<xref ref-type="bibr" rid="CR27">27</xref>]—which can be run by means of the wrapper function diff_map(). This joint analysis shows that cells with the highest values of TC-R tend to have lower proliferation scores (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). These cells are located more closely to the branching point of the diffusion map (Fig. <xref rid="Fig6" ref-type="fig">6</xref>e), while the cells with the highest proliferation rates are located at a corner of one of the branches (Fig. <xref rid="Fig6" ref-type="fig">6</xref>f). This evidence suggests that the cells with high TC and low proliferation are interesting candidates for further analyses aimed at finding TICs in this dataset of HGG. Interestingly, this particular pattern is captured by TC-R, but not by TC-LMR and TC-H (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1).</p>
    </sec>
    <sec id="Sec15">
      <title>Comparison of datasets</title>
      <p id="Par77">A SC dataset carries an extensive amount of information. The integration of multiple SC datasets is a challenging task and multiple approaches have been proposed to address it [<xref ref-type="bibr" rid="CR28">28</xref>]. Typically, the integrated datasets are computationally demanding due to their huge size. An alternative possibility lies in cross-checking the expression of cluster markers between datasets: the expression of the cluster markers of every dataset is assessed in all considered datasets. For example, Nguyen et al. [<xref ref-type="bibr" rid="CR5">5</xref>] used this approach to study the occurrence of the characteristic cell types of normal mammary gland across samples collected from different subjects.</p>
      <p id="Par78">scMuffin provides a function to quantify the expression of a series of gene sets across multiple datasets:</p>
      <p id="Par79">
res &lt;- inter_dataset_comparison(seu_obj_list = seu_obj_list, gsl = cluster_markers_list)
</p>
      <p id="Par80">where seu_obj_list is a list of Seurat objects (each containing a SC dataset). If the gene sets are defined as cluster markers (“cluster_markers_list” in the code above), then the analysis sheds light over the possible presence of cells with similar expression profiles across datasets.</p>
      <p id="Par81">We performed this analysis on three datasets (PJ016, PJ017, PJ030) and found cell clusters that are more similar to clusters of other datasets than clusters of the same dataset, suggesting the presence of similar cells (Fig. <xref rid="Fig7" ref-type="fig">7</xref>a), like cluster 7 of PJ030 (“PJ030_C7”), which is close to clusters {0, 6, 8, 9} of PJ016. Importantly, the same analysis can be done using gene sets with a functional meaning, to obtain a functional characterization of similar cell types across datasets (Fig. <xref rid="Fig7" ref-type="fig">7</xref>b).<fig id="Fig7"><label>Fig. 7</label><caption><p>Inter-dataset comparison of gene set expression. <bold>a</bold> Heatmap of cluster marker (columns, “_Mx” suffix, where “x” indicates cluster number) expression scores across clusters (rows, “_Cx” suffix, where “x” indicates cluster number) of datasets PJ016, PJ017 and PJ030. <bold>b</bold> Heatmap of CancerSEA functional states scores across clusters of datasets as in panel (<bold>a</bold>)</p></caption><graphic xlink:href="12859_2023_5563_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec16">
      <title>scMuffin and scCancer</title>
      <p id="Par82">scCancer [<xref ref-type="bibr" rid="CR29">29</xref>] is an R package for automated processing of SC expression data in cancer. The two packages (scMuffin and scCancer) address the same challenge and are complementary. Indeed, each of them offers some analyses that the other does not (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Examples of this are cluster association analysis (CSEA and ORA), comparison of multiple cell partitions and inter-dataset gene set expression assessment, available in scMuffin, and cell interaction, expression programs and cancer micro-environment cell classification, provided by scCancer. Other types of analyses are common to both packages but differ by the underlying algorithm and/or implementation. This is the case, for instance, of gene set scoring and CNV analysis.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Conclusions</title>
    <p id="Par83">Here, we presented scMuffin, an R package that provides a series of functions to perform and integrate various types of analyses on SC expression data. As a proof-of-concept, to illustrate the user interface and its potentialities, we analysed publicly available SC expression datasets of human HGG. We described two examples of integrative analyses which returned particularly interesting findings that would deserve further investigations: the functional characterization of CNVs highlighted a possible link between amplifications of chromosomes 1p and 19p and invasive tumor phenotype; the joint analysis of transcriptional complexity, proliferation rate and cell state trajectories spotted cells that have some characteristics of TICs. Despite the inference of CNV from SC expression data is a challenging task, subject to various issues (e.g., missing data, number of aberrancies), it provides useful insights to clarify cell identity, like the distinction between a more aberrant cluster and the others or the distinction of tumoral and normal cells. The functions of scMuffin can be combined conveniently to address various tasks. For example, different partitions of the same dataset obtained using the same clustering method with different parameters can be characterized by means of their overlap and gene set expression, to gain insights on the appropriate number of clusters. The analyses offered by scMuffin and the results achieved in the proof-of-concept show that scMuffin helps addressing the main challenges in the bioinformatics analysis of SC datasets from solid tumors.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec20">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5563_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1. </bold>Supplementary methods, Figure S1 and Table S1.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CNV</term>
        <def>
          <p id="Par4">Copy number variation</p>
        </def>
      </def-item>
      <def-item>
        <term>CSC</term>
        <def>
          <p id="Par5">Cancer stem cells</p>
        </def>
      </def-item>
      <def-item>
        <term>CSEA</term>
        <def>
          <p id="Par6">Cell set enrichment analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p id="Par7">False discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>ER</term>
        <def>
          <p id="Par8">Enrichment ratio</p>
        </def>
      </def-item>
      <def-item>
        <term>GSEA</term>
        <def>
          <p id="Par9">Gene set enrichment analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>GTEx</term>
        <def>
          <p id="Par10">The Genotype-Tissue Expression project</p>
        </def>
      </def-item>
      <def-item>
        <term>HGG</term>
        <def>
          <p id="Par11">High grade glioma</p>
        </def>
      </def-item>
      <def-item>
        <term>NES</term>
        <def>
          <p id="Par12">Normalized enrichment score</p>
        </def>
      </def-item>
      <def-item>
        <term>ORA</term>
        <def>
          <p id="Par13">Over representation analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>SC</term>
        <def>
          <p id="Par14">Single cell</p>
        </def>
      </def-item>
      <def-item>
        <term>TC-R</term>
        <def>
          <p id="Par15">Transcriptional complexity ratio</p>
        </def>
      </def-item>
      <def-item>
        <term>TC-LMR</term>
        <def>
          <p id="Par16">Transcriptional complexity linear model residuals</p>
        </def>
      </def-item>
      <def-item>
        <term>TC-H</term>
        <def>
          <p id="Par17">Transcriptional complexity entropy</p>
        </def>
      </def-item>
      <def-item>
        <term>TICs</term>
        <def>
          <p id="Par18">Tumor initiating cells</p>
        </def>
      </def-item>
      <def-item>
        <term>UMAP</term>
        <def>
          <p id="Par19">Uniform manifold approximation and projection</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Paride Pelucchi and Ettore Mosca contributed equally to this work.</p>
    </fn>
  </fn-group>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>VN implemented the CNV functions, carried out the analyses, interpreted the results and wrote the article. AC implemented clustering functions, carried out the analyses, wrote the article, tested the package. NDN drafted the package, carried out the analyses and wrote the article. IC curated the biological aspects of CNV analysis and revised the article. MM and MG set up the computational infrastructure for data analysis. CC and EP curated the biological aspects of solid tumor data analysis. AS tested the package. RR, IZ, LM and AM contributed to the design of the study. PP contributed to the software design, case study definition, interpretation of the results and wrote the article. EM designed the study, implemented the software, performed the analysis, interpreted the results, and wrote the article. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded by the European Union “NextGenerationEU” and Italian Ministry of University and Research project “BBMRI.it” (Italian national node of BBMRI-ERIC, IR0000031), and by the Italian Ministry of University and Research PON Project “CNRBIOMICS” (PIR01_00017). The funding bodies played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The data used for the analyses described in this manuscript were obtained from: The Gene Expression Omnibus [<xref ref-type="bibr" rid="CR11">11</xref>], under the accession GSE103224; the GTEx Portal [<xref ref-type="bibr" rid="CR17">17</xref>] on 04/08/2020. Project name: scMuffin. Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/emosca-cnr/scMuffin">https://github.com/emosca-cnr/scMuffin</ext-link>. Operating system: Platform independent. Programming language: R (≥ 4.0.0). Other requirements: The R Project for Statistical Computing. License: GPL-3. Any restrictions to use by non-academics: According to GPL-3.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par84">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par85">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par86">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baslan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hicks</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Unravelling biology and shifting paradigms in cancer with single-cell sequencing</article-title>
        <source>Nat Rev Cancer</source>
        <year>2017</year>
        <volume>17</volume>
        <issue>9</issue>
        <fpage>557</fpage>
        <lpage>569</lpage>
        <pub-id pub-id-type="doi">10.1038/nrc.2017.58</pub-id>
        <?supplied-pmid 28835719?>
        <pub-id pub-id-type="pmid">28835719</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zappia</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Over 1000 tools reveal trends in the single-cell RNA-seq analysis landscape</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>301</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02519-4</pub-id>
        <?supplied-pmid 34715899?>
        <pub-id pub-id-type="pmid">34715899</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Andersen-Nissen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated analysis of multimodal single-cell data</article-title>
        <source>Cell.</source>
        <year>2021</year>
        <volume>184</volume>
        <issue>13</issue>
        <fpage>3573</fpage>
        <lpage>3587</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id>
        <?supplied-pmid 34062119?>
        <pub-id pub-id-type="pmid">34062119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Izar</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prakadan</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wadsworth</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Treacy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title>
        <source>Science (1979)</source>
        <year>2016</year>
        <volume>352</volume>
        <issue>6282</issue>
        <fpage>189</fpage>
        <lpage>196</lpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>QH</given-names>
          </name>
          <name>
            <surname>Pervolarakis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Profiling human breast epithelial cells using single cell RNA sequencing identifies cell diversity</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>2028</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-04334-1</pub-id>
        <?supplied-pmid 29795293?>
        <pub-id pub-id-type="pmid">29795293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Gillespie</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wakimoto</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>344</volume>
        <issue>6190</issue>
        <fpage>1396</fpage>
        <lpage>1401</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1254257</pub-id>
        <?supplied-pmid 24925914?>
        <pub-id pub-id-type="pmid">24925914</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gandrillon</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Gaillard</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Espinasse</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Garnier</surname>
            <given-names>NB</given-names>
          </name>
          <name>
            <surname>Dussiau</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kosmider</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Entropy as a measure of variability and stemness in single-cell transcriptomics</article-title>
        <source>Curr Opin Syst Biol.</source>
        <year>2021</year>
        <volume>27</volume>
        <fpage>100348</fpage>
        <pub-id pub-id-type="doi">10.1016/j.coisb.2021.05.009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2005</year>
        <volume>102</volume>
        <issue>43</issue>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <?supplied-pmid 16199517?>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khatri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sirota</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Butte</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Ten years of pathway analysis: current approaches and outstanding challenges. Ouzounis CA. editor</article-title>
        <source>PLoS Comput Biol.</source>
        <year>2012</year>
        <volume>8</volume>
        <issue>2</issue>
        <fpage>e1002375</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002375</pub-id>
        <?supplied-pmid 22383865?>
        <pub-id pub-id-type="pmid">22383865</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Levitin</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Frattini</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bush</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Boyett</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Samanamud</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome analysis of lineage diversity in high-grade glioma</article-title>
        <source>Genome Med</source>
        <year>2018</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>57</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-018-0567-9</pub-id>
        <?supplied-pmid 30041684?>
        <pub-id pub-id-type="pmid">30041684</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrett</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wilhite</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Ledoux</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Evangelista</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>IF</given-names>
          </name>
          <name>
            <surname>Tomashevsky</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NCBI GEO: archive for functional genomics data sets—update</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>41</volume>
        <issue>D1</issue>
        <fpage>D991</fpage>
        <lpage>D995</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1193</pub-id>
        <?supplied-pmid 23193258?>
        <pub-id pub-id-type="pmid">23193258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Quan</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell marker: a manually curated resource of cell markers in human and mouse</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D721</fpage>
        <lpage>D728</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky900</pub-id>
        <?supplied-pmid 30289549?>
        <pub-id pub-id-type="pmid">30289549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Franzén</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Gan</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Björkegren</surname>
            <given-names>JLM</given-names>
          </name>
        </person-group>
        <article-title>PanglaoDB: a web server for exploration of mouse and human single-cell RNA sequencing data</article-title>
        <source>Database</source>
        <year>2019</year>
        <volume>1</volume>
        <fpage>2019</fpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CancerSEA: a cancer single-cell state atlas</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D900</fpage>
        <lpage>D908</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky939</pub-id>
        <?supplied-pmid 30329142?>
        <pub-id pub-id-type="pmid">30329142</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clarke</surname>
            <given-names>ZA</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Atif</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pouyabahar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Innes</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>MacParland</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tutorial: guidelines for annotating single-cell transcriptomic maps using automated and manual methods</article-title>
        <source>Nat Protoc</source>
        <year>2021</year>
        <volume>16</volume>
        <issue>6</issue>
        <fpage>2749</fpage>
        <lpage>2764</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-021-00534-0</pub-id>
        <?supplied-pmid 34031612?>
        <pub-id pub-id-type="pmid">34031612</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Eils</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schlesner</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Complex heatmaps reveal patterns and correlations in multidimensional genomic data</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>18</issue>
        <fpage>2847</fpage>
        <lpage>2849</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw313</pub-id>
        <?supplied-pmid 27207943?>
        <pub-id pub-id-type="pmid">27207943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">GTEx Consortium. The genotype-tissue expression (GTEx) project.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Polisetty</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ganesh</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Gowda</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Purohit</surname>
            <given-names>AK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Altered transcriptional regulatory proteins in glioblastoma and YBX1 as a potential regulator of tumor invasion</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>10986</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-47360-9</pub-id>
        <?supplied-pmid 31358880?>
        <pub-id pub-id-type="pmid">31358880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LeFave</surname>
            <given-names>CV</given-names>
          </name>
          <name>
            <surname>Squatrito</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vorlova</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rocco</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Brennan</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Holland</surname>
            <given-names>EC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Splicing factor hnRNPH drives an oncogenic splicing switch in gliomas</article-title>
        <source>EMBO J</source>
        <year>2011</year>
        <volume>30</volume>
        <issue>19</issue>
        <fpage>4084</fpage>
        <lpage>4097</lpage>
        <pub-id pub-id-type="doi">10.1038/emboj.2011.259</pub-id>
        <?supplied-pmid 21915099?>
        <pub-id pub-id-type="pmid">21915099</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Golan-Gerstl</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shilo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Suh</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Bakàcs</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coppola</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Splicing factor hnRNP A2/B1 regulates tumor suppressor gene splicing and is an oncogenic driver in glioblastoma</article-title>
        <source>Cancer Res</source>
        <year>2011</year>
        <volume>71</volume>
        <issue>13</issue>
        <fpage>4464</fpage>
        <lpage>4472</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-10-4410</pub-id>
        <?supplied-pmid 21586613?>
        <pub-id pub-id-type="pmid">21586613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Jeong</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Vukadin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stone</surname>
            <given-names>JK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SON drives oncogenic RNA splicing in glioblastoma by regulating PTBP1/PTBP2 switching and RBFOX2 activity</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>5551</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-25892-x</pub-id>
        <?supplied-pmid 34548489?>
        <pub-id pub-id-type="pmid">34548489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wainwright</surname>
            <given-names>EN</given-names>
          </name>
          <name>
            <surname>Scaffidi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Epigenetics and cancer stem cells: unleashing, hijacking, and restricting cellular plasticity</article-title>
        <source>Trends Cancer</source>
        <year>2017</year>
        <volume>3</volume>
        <issue>5</issue>
        <fpage>372</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trecan.2017.04.004</pub-id>
        <?supplied-pmid 28718414?>
        <pub-id pub-id-type="pmid">28718414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaspar-Maia</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Alajem</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Meshorer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ramalho-Santos</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Open chromatin in pluripotency and reprogramming</article-title>
        <source>Nat Rev Mol Cell Biol</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>36</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm3036</pub-id>
        <?supplied-pmid 21179060?>
        <pub-id pub-id-type="pmid">21179060</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guilhamon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chesnelong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kushida</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Nikolic</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Singhal</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>MacLeod</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell chromatin accessibility profiling of glioblastoma identifies an invasive cancer stem cell population associated with lower survival</article-title>
        <source>Elife</source>
        <year>2021</year>
        <volume>11</volume>
        <fpage>10</fpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feitelson</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Arzumanyan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kulathinal</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Blain</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Holcombe</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Mahajna</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sustained proliferation in cancer: Mechanisms and novel therapeutic targets</article-title>
        <source>Semin Cancer Biol</source>
        <year>2015</year>
        <volume>35</volume>
        <fpage>S25</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1016/j.semcancer.2015.02.006</pub-id>
        <?supplied-pmid 25892662?>
        <pub-id pub-id-type="pmid">25892662</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Al-Hajj</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>Self-renewal and solid tumor stem cells</article-title>
        <source>Oncogene</source>
        <year>2004</year>
        <volume>23</volume>
        <issue>43</issue>
        <fpage>7274</fpage>
        <lpage>7282</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.onc.1207947</pub-id>
        <?supplied-pmid 15378087?>
        <pub-id pub-id-type="pmid">15378087</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Haghverdi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Büttner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Marr</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Destiny: diffusion maps for large-scale single-cell data in R</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>8</issue>
        <fpage>1241</fpage>
        <lpage>1243</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv715</pub-id>
        <?supplied-pmid 26668002?>
        <pub-id pub-id-type="pmid">26668002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forcato</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Romano</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Bicciato</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Computational methods for the integrative analysis of single-cell data</article-title>
        <source>Brief Bioinform.</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>3</issue>
        <fpage>bbaa042</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbaa042</pub-id>
        <?supplied-pmid 32363378?>
        <pub-id pub-id-type="pmid">32363378</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>scCancer: a package for automated processing of single-cell RNA-seq data in cancer</article-title>
        <source>Brief Bioinform.</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>3</issue>
        <fpage>bbaa127</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbaa127</pub-id>
        <?supplied-pmid 34020534?>
        <pub-id pub-id-type="pmid">34020534</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10680269</article-id>
    <article-id pub-id-type="publisher-id">5563</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05563-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scMuffin: an R package to disentangle solid tumor heterogeneity by single-cell gene expression analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nale</surname>
          <given-names>Valentina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chiodi</surname>
          <given-names>Alice</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Di Nanni</surname>
          <given-names>Noemi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cifola</surname>
          <given-names>Ingrid</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moscatelli</surname>
          <given-names>Marco</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cocola</surname>
          <given-names>Cinzia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gnocchi</surname>
          <given-names>Matteo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Piscitelli</surname>
          <given-names>Eleonora</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sula</surname>
          <given-names>Ada</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zucchi</surname>
          <given-names>Ileana</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reinbold</surname>
          <given-names>Rolland</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Milanesi</surname>
          <given-names>Luciano</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mezzelani</surname>
          <given-names>Alessandra</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Pelucchi</surname>
          <given-names>Paride</given-names>
        </name>
        <address>
          <email>paride.pelucchi@itb.cnr.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3102-5150</contrib-id>
        <name>
          <surname>Mosca</surname>
          <given-names>Ettore</given-names>
        </name>
        <address>
          <email>ettore.mosca@itb.cnr.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.5326.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 1940 4177</institution-id><institution>Institute of Biomedical Technologies, </institution><institution>National Research Council, </institution></institution-wrap>Via Fratelli Cervi 93, 20054 Segrate, Milan Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>445</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Introduction</title>
        <p id="Par1">Single-cell (SC) gene expression analysis is crucial to dissect the complex cellular heterogeneity of solid tumors, which is one of the main obstacles for the development of effective cancer treatments. Such tumors typically contain a mixture of cells with aberrant genomic and transcriptomic profiles affecting specific sub-populations that might have a pivotal role in cancer progression, whose identification eludes bulk RNA-sequencing approaches. We present scMuffin, an R package that enables the characterization of cell identity in solid tumors on the basis of a various and complementary analyses on SC gene expression data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">scMuffin provides a series of functions to calculate qualitative and quantitative scores, such as: expression of marker sets for normal and tumor conditions, pathway activity, cell state trajectories, Copy Number Variations, transcriptional complexity and proliferation state. Thus, scMuffin facilitates the combination of various evidences that can be used to distinguish normal and tumoral cells, define cell identities, cluster cells in different ways, link genomic aberrations to phenotypes and identify subtle differences between cell subtypes or cell states. We analysed public SC expression datasets of human high-grade gliomas as a proof-of-concept to show the value of scMuffin and illustrate its user interface. Nevertheless, these analyses lead to interesting findings, which suggest that some chromosomal amplifications might underlie the invasive tumor phenotype and the presence of cells that possess tumor initiating cells characteristics.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The analyses offered by scMuffin and the results achieved in the case study show that our tool helps addressing the main challenges in the bioinformatics analysis of SC expression data from solid tumors.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05563-y.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell transcriptomics</kwd>
      <kwd>Cancer</kwd>
      <kwd>Tumor heterogeneity</kwd>
      <kwd>Cell identity</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100021856</institution-id>
            <institution>Ministero dell'Università e della Ricerca</institution>
          </institution-wrap>
        </funding-source>
        <award-id>IR0000031</award-id>
        <award-id>PIR01_00017</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000780</institution-id>
            <institution>European Commission</institution>
          </institution-wrap>
        </funding-source>
        <award-id>IR0000031</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par20">Single-cell (SC) gene expression analysis is crucial to dissect the complex cellular heterogeneity of solid tumors, which is one of the main obstacles for the development of effective cancer treatments [<xref ref-type="bibr" rid="CR1">1</xref>]. A relevant number of software tools has been developed in recent years in the field of SC data analysis [<xref ref-type="bibr" rid="CR2">2</xref>], a fact that stresses the key opportunities and challenges in this field. A recent study has shown that the development of tools that address common tasks (e.g., clustering of similar cells) and ordering of cells (e.g., definition of cell trajectories) is decreasing, while a greater focus is being paid on data integration and classification [<xref ref-type="bibr" rid="CR2">2</xref>]. These observations reflect the growing availability, scale and complexity of SC datasets [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par21">SC datasets of solid tumors are typical examples of complex datasets that present a series of computational challenges and whose analysis demands domain-specific and integrative approaches. In fact, solid tumors typically contain a mixture of cells with aberrant genomic and transcriptomic profiles affecting specific sub-populations that might play a pivotal role in cancer progression, whose identification eludes bulk RNA-sequencing approaches. The use of cell type-specific markers (when available) is limited, and the alterations of gene expression that mark cancer cells makes the use of markers for normal cells not completely adequate. Moreover, the molecular heterogeneity of cancer cells (due to both intra-tumor and inter-individual differences) poses intrinsic limits in the definition of such markers. In addition, solid tumor samples typically comprise cells from the surrounding tissue or infiltrating cells that need to be distinguished from tumor populations for an effective analysis. Another challenge is the identification of clinically relevant cell subtypes that may be rare in the tumor mass, such as cancer stem cells or drug resistant subclones: because of their relatively low number, these cells are typically clustered together with many others. Lastly, an intrinsic problem of many SC datasets is the sequencing depth limit at the SC level. These limitations bound the number of detectable genes to the few thousands of the highest expressed genes, which implies, for example, that some established markers may not be used for data analysis.</p>
    <p id="Par22">To address these challenges, we developed scMuffin, an R package that implements a series of complementary analyses aimed at shedding light on the complexity of solid tumor SC expression data, including: a fast and customizable gene set scoring system; gene sets from various sources, including pathways, cancer functional states and cell markers; cell cluster association analysis with quantitative (e.g., gene set scores) as well as categorical (e.g. mutation states, proliferation states) features; copy number variation (CNV) analysis; transcriptional complexity analysis; proliferation rate quantification; and gene set based multi-dataset analysis (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). scMuffin facilitates the integrative analysis of these multiple features, thus allowing the identification of cell subtypes that elude more general clustering and classification approaches. We describe the key aspects of scMuffin implementation and then its user interface by means of a case study on a public SC expression dataset of human high-grade gliomas (HGG).<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of scMuffin package. scMuffin offers the possibility to perform several different analyses and data integration approaches to address the main challenges of SC gene expression analysis in solid tumors</p></caption><graphic xlink:href="12859_2023_5563_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par23">scMuffin is implemented as an R package and provides a series of functions that allows the user to quantify various genetic and phenotypic characteristics of single cells, which can be combined to obtain insights on cell identity and function. The functions of scMuffin operate on a common data structure, the “scMuffinList”, by adding, changing or removing its elements. Computationally intensive tasks (in particular, gene set scoring and CNV inference) are parallelized. Package documentation includes R vignettes and function documentation, which are also available as “GitHub Pages” at the URL <ext-link ext-link-type="uri" xlink:href="https://emosca-cnr.github.io/scMuffin">https://emosca-cnr.github.io/scMuffin</ext-link>. In this section, we describe package inputs and the main algorithms and definitions underlying the analyses offered by scMuffin.</p>
    <sec id="Sec3">
      <title>Input</title>
      <p id="Par24">scMuffin is intended to be used downstream to general purpose tasks like quality control, normalization, cell clustering and dataset integration, for which there are dedicated tools, such as Seurat [<xref ref-type="bibr" rid="CR3">3</xref>]. scMuffin requires the genes-by-cells raw counts matrix, genes-by-cells normalized expression matrix and a partition of cells in clusters. Typically, these matrices are filtered during preprocessing steps to exclude low quality cells and genes that could negatively affect the analyses. However, the characterization of cells that can be achieved with scMuffin offers insights that can be used to (further) filter the dataset and/or to decide on which cells apply particular analyses (e.g. biomarker identification). In general, according to research questions and experimental design one may want to apply strong or mild filters before using scMuffin.</p>
    </sec>
    <sec id="Sec4">
      <title>Quantification of gene set expression scores at cell and cluster levels</title>
      <p id="Par25">The quantification of gene set expression scores follows the approach described in [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>], in which a gene set is scored on the basis of its average deviation from an empirical null. The approach is implemented enabling the user to tune various parameters (e.g., the minimum number of cells in which a gene set must be expressed, the number of bins of the null model and the possible removal of missing values) to better address the needs of a particular study in relation to the characteristics of the dataset under analysis. In particular, the code is implemented to handle missing values, which are one of the main issues in SC datasets. For example, this is important to quantify the expression of gene sets that are expressed just in a small subset of cells (and have null values elsewhere), or to account for the expression of different members of the same pathway in different cells.</p>
      <p id="Par26">The algorithm for gene set scoring is the following. Given a gene set <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M2"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq1.gif"/></alternatives></inline-formula>:<list list-type="bullet"><list-item><p id="Par27">1. the genes occurring in the normalized genes-by-cells matrix are grouped into a series of bins according to their average expression across cells;</p></list-item><list-item><p id="Par28">2. a number <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M4"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq2.gif"/></alternatives></inline-formula> of random gene sets <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{i}^{*}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq3.gif"/></alternatives></inline-formula>: are created, of the same size of <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M8"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq4.gif"/></alternatives></inline-formula>, tossing genes from the same bins of <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M10"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq5.gif"/></alternatives></inline-formula>, in order to match the distribution of gene expression of each <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{i}^{*}$$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq6.gif"/></alternatives></inline-formula> with that of <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M14"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq7.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par29">3. the averages <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{c}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{ic}^{*}$$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq9.gif"/></alternatives></inline-formula> are calculated, respectively, over the values of <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M20"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{i}^{*}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq11.gif"/></alternatives></inline-formula> in every cell <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M24"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq12.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par30">4. the expression score <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{c}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq13.gif"/></alternatives></inline-formula> is calculated as the average difference between <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{c}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq14.gif"/></alternatives></inline-formula> and <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{ic}^{*}$$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq15.gif"/></alternatives></inline-formula>:<disp-formula id="Equa"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{c} = \frac{{\mathop \sum \nolimits_{i}^{k} \left( {m_{c} - m_{ic}^{*} } \right)}}{k}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mi>k</mml:mi></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par31">5. the difference between the medians of <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{c}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{ic}^{*}$$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq17.gif"/></alternatives></inline-formula> values in any cluster is used as the cluster-level score of <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M38"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq18.gif"/></alternatives></inline-formula>.</p></list-item></list></p>
    </sec>
    <sec id="Sec5">
      <title>CNV estimation based on adjacent gene expression</title>
      <p id="Par32">CNV inference in scMuffin is based on the “adjacent gene windows” approach [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], which has been validated using both single nucleotide polymorphism arrays [<xref ref-type="bibr" rid="CR6">6</xref>] and whole-exome sequencing [<xref ref-type="bibr" rid="CR4">4</xref>]. The approach is implemented in parallel and, like gene set scoring, offers various parameter tuning and data filtering possibilities, which allow the investigator to optimize the analysis to specific needs. The CNV profile of each cell is calculated as a moving average of scaled gene expression levels ordered by genomic location. scMuffin offers the possibility of subtracting a “normal” reference profile to highlight relative CNVs. Since a SC dataset derived from a sample of a solid tumor can either contain or not a proper set of physiological cells to be used as reference, this reference can be derived from cells that are part of the dataset under analysis (as described in [<xref ref-type="bibr" rid="CR4">4</xref>]), or using external dataset (as described in [<xref ref-type="bibr" rid="CR6">6</xref>]). The main steps are:<list list-type="order"><list-item><p id="Par33">the reference cells are added to the genes-by-cells matrix (optional);</p></list-item><list-item><p id="Par34">the expression of each gene is scaled subtracting its average (optional);</p></list-item><list-item><p id="Par35">the gene expression matrix is ordered by chromosome and gene location;</p></list-item><list-item><p id="Par36">in each chromosome <italic>h</italic>, the estimated copy number <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq19.gif"/></alternatives></inline-formula> of cell <italic>c</italic> is calculated for all the ordered genes <inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \left[ {\frac{w}{2} + 1,n_{h} - \frac{w}{2}} \right]$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq20.gif"/></alternatives></inline-formula>:<disp-formula id="Equb"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic} = \mathop \sum \limits_{{j = i - \frac{w}{2}}}^{{i + \frac{w}{2}}} \frac{{e_{jc} }}{w + 1}$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:munderover><mml:mfrac><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">jc</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list>where <italic>w</italic> is an even number that defines the window size, that is, the number of genes located before and after gene <italic>i</italic> which contribute to the estimation of <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq21.gif"/></alternatives></inline-formula>, <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{h}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq22.gif"/></alternatives></inline-formula> is the number of genes in <italic>h</italic>, and <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{jc}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">jc</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq23.gif"/></alternatives></inline-formula> is the gene expression value;<list list-type="simple"><list-item><label>5.</label><p id="Par37"><inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq24.gif"/></alternatives></inline-formula> values are scaled subtracting their average in a cell (optional);</p></list-item><list-item><label>6.</label><p id="Par38">cells are clustered by their CNV profile;</p></list-item><list-item><label>7.</label><p id="Par39">the average CNV profile of the normal reference cells is subtracted from all the CNV profiles (optional).</p></list-item><list-item><label>8.</label><p id="Par40">the CNV score of a cell is calculated as:<disp-formula id="Equc"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{c} = \mathop \sum \limits_{i} \left( {V_{ic} } \right)^{2}$$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
      <p id="Par41">Cells are clustered based on their CNV profile using Seurat [<xref ref-type="bibr" rid="CR3">3</xref>]. A CNV region of a cluster is composed of the adjacent genes <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M56"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq25.gif"/></alternatives></inline-formula> that have absolute median <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq26.gif"/></alternatives></inline-formula> (within the cluster) higher than a given threshold. This threshold is by default defined as the standard deviation of <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq27.gif"/></alternatives></inline-formula> values of all cells.</p>
    </sec>
    <sec id="Sec6">
      <title>Transcriptional complexity</title>
      <p id="Par42">The transcriptional complexity (TC) is calculated using three different approaches. The TC-R <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{R}$$\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq28.gif"/></alternatives></inline-formula> of a cell is inferred based on the number of expressed genes <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(g_{c} )$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq29.gif"/></alternatives></inline-formula> over the number of total mapped reads (transcripts) <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(t_{c} )$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq30.gif"/></alternatives></inline-formula>:<disp-formula id="Equd"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{R} = \frac{{g_{c} }}{{t_{c} }} \cdot \frac{{\mathop {\max }\limits_{c} \left( {t_{c} } \right)}}{{\mathop {\max }\limits_{c} \left( {g_{c} } \right)}}$$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfrac><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo movablelimits="false">max</mml:mo><mml:mi>c</mml:mi></mml:munder><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:munder><mml:mo movablelimits="false">max</mml:mo><mml:mi>c</mml:mi></mml:munder><mml:mfenced close=")" open="("><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{c} = \# \left\{ {r_{ic} \ge \alpha } \right\}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>#</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq31.gif"/></alternatives></inline-formula>, <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M72"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq32.gif"/></alternatives></inline-formula> is a threshold over the gene count <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{ic}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq33.gif"/></alternatives></inline-formula> and defines the gene <italic>i</italic> as “expressed”, and <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{c} = \sum\nolimits_{i} {r_{ic} }$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq34.gif"/></alternatives></inline-formula>. Values of <inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{R}$$\end{document}</tex-math><mml:math id="M78"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq35.gif"/></alternatives></inline-formula> higher (lower) than 1 indicate a higher (lower) number of expressed genes in relation to the total transcripts of the cell.</p>
      <p id="Par43">The TC-LMR (linear model residual) of a cell corresponds to its residual in the linear regression model between <inline-formula id="IEq36"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{c}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq36.gif"/></alternatives></inline-formula> and <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{c}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq37.gif"/></alternatives></inline-formula>:<disp-formula id="Eque"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{log}}_{10} \left( {g_{c} } \right) = \beta_{0} + \beta_{1} {\text{log}}_{10} \left( {t_{c} } \right) + \varepsilon_{c}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:msub><mml:mtext>log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mtext>log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Eque.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equf"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{LMR} = {\text{log}}_{10} \left( {g_{c} } \right) - \left[ {\beta_{0} + \beta_{1} {\text{log}}_{10} \left( {t_{c} } \right)} \right].$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">LMR</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mtext>log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mtext>log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par44">Positive (negative) residuals indicate higher (lower) number of expressed genes in relation to total transcripts.</p>
      <p id="Par45">The TC-H (entropy) is quantified as the transcriptional entropy of the cell [<xref ref-type="bibr" rid="CR7">7</xref>]:<disp-formula id="Equg"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{H} = - \mathop \sum \limits_{ic} \left[ {p_{ic} {\text{ log}}\left( {p_{ic} } \right)} \right]$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>log</mml:mtext></mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equg.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq38"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{ic} = r_{ic} /t_{c}$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq38.gif"/></alternatives></inline-formula>. The higher the entropy the higher the number of expressed genes.</p>
    </sec>
    <sec id="Sec7">
      <title>Proliferation rate</title>
      <p id="Par46">The proliferation rate <inline-formula id="IEq39"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{c}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>P</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq39.gif"/></alternatives></inline-formula> of a cell is quantified as the maximum between the two gene set scores <inline-formula id="IEq40"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{c} \left( {S_{1} } \right)$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{c} \left( {S_{2} } \right)$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq41.gif"/></alternatives></inline-formula>, calculated on the gene sets <inline-formula id="IEq42"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{1}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq42.gif"/></alternatives></inline-formula> and <inline-formula id="IEq43"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{2}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq43.gif"/></alternatives></inline-formula> that contain, respectively, genes involved in G1/S and G2/M cell cycle phases:<disp-formula id="Equh"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{c} = {\text{max}}\left( {Y_{c} \left( {S_{1} } \right), Y_{c} \left( {S_{2} } \right)} \right)$$\end{document}</tex-math><mml:math id="M102" display="block"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equh.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq44"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{1}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq44.gif"/></alternatives></inline-formula> and <inline-formula id="IEq45"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{2}$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq45.gif"/></alternatives></inline-formula> are defined as in Tirosh et al. [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    </sec>
    <sec id="Sec8">
      <title>Cluster enrichment analysis for quantitative and categorical features</title>
      <p id="Par47">The association between cell clusters and any cell-level feature is performed through Cell Set Enrichment Analysis (CSEA) and Over Representation Analysis (ORA) for, respectively, quantitative and categorical values. Importantly, these two types of analysis are implemented in parallel, which is particularly important for CSEA that uses permutations to build an empirical null distribution.</p>
      <p id="Par48">CSEA is the application of Gene Set Enrichment Analysis (GSEA) [<xref ref-type="bibr" rid="CR8">8</xref>] to cells and cell sets in place of, respectively, genes and gene sets: a ranked cell list is used instead of a ranked gene list, and cell sets (cell clusters) are tested instead of gene sets. In addition, the code is implemented to handle missing values. Therefore, scMuffin tests whether the cells assigned to a cluster are located at the top (bottom) of a ranked list of cells.</p>
      <p id="Par49">The assessment of cluster enrichment in a particular value of a categorical feature is computed using the over-representation analysis (ORA) approach [<xref ref-type="bibr" rid="CR9">9</xref>], which is based on the hypergeometric test. Here, this test assesses whether the occurrence of a particular value between the cells of a cluster in relation to all other clusters is higher than expected in a hypergeometric experiment.</p>
    </sec>
    <sec id="Sec9">
      <title>Overlap between partitions of cells</title>
      <p id="Par50">Cell partitions resulting from different clustering analyses are compared by calculating the overlap coefficients among all-pairs of clusters. Given two partitions <italic>A</italic> and <italic>B</italic>, defined as sets of cell clusters <inline-formula id="IEq46"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A = \left\{ {a_{i} } \right\}{ }$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq46.gif"/></alternatives></inline-formula> and <inline-formula id="IEq47"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B = \left\{ {b_{j} } \right\}$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq47.gif"/></alternatives></inline-formula>, the similarity between the cell clusters <inline-formula id="IEq48"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{i}$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq48.gif"/></alternatives></inline-formula> and <inline-formula id="IEq49"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{j}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq49.gif"/></alternatives></inline-formula> is calculated as:<disp-formula id="Equi"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_{ij} = \frac{{\left| {a_{i} \cap b_{j} } \right|}}{{\min \left( {\left| {a_{i} } \right|,\left| {b_{j} } \right|} \right)}}$$\end{document}</tex-math><mml:math id="M116" display="block"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close="|" open="|"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Results and discussion</title>
    <p id="Par51">In this section, we present the user interface (Table <xref rid="Tab1" ref-type="table">1</xref>), taking advantage of the results obtained on the SC dataset generated by Yuan et al. [<xref ref-type="bibr" rid="CR10">10</xref>] from human high-grade glioma (HGG) samples (available on the Gene Expression Omnibus (GEO) repository [<xref ref-type="bibr" rid="CR11">11</xref>] with identifier GSE103224, see Supplementary Methods in Additional file <xref rid="MOESM1" ref-type="media">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Main tasks and corresponding functions in scMuffin</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Task</th><th align="left">Description</th><th align="left">User interface</th></tr></thead><tbody><tr><td align="left">Create the scMuffinList</td><td align="left">Create the scMuffinList from counts and normalized expression data</td><td align="left">create_scMuffinList()</td></tr><tr><td align="left">Add a partition</td><td align="left">Add a partition of cell (clusters)</td><td align="left">add_partition()</td></tr><tr><td align="left">Gene set expression scoring</td><td align="left"><p>Average gene set expression deviation from matched empirical reference</p><p>Provided gene sets from CellMarker [<xref ref-type="bibr" rid="CR12">12</xref>], PanglaoDB [<xref ref-type="bibr" rid="CR13">13</xref>], CancerSEA [<xref ref-type="bibr" rid="CR14">14</xref>] and MSigDB [<xref ref-type="bibr" rid="CR8">8</xref>]</p></td><td align="left"><p>prepare_gsls()</p><p>calculate_gs_scores()</p><p>calculate_gs_scores_in_clusters()</p></td></tr><tr><td align="left">CNV</td><td align="left"><p>Estimation of CNVs by means of the “moving window” approach, that is, considering the expression of adjacent genes</p><p>Calculation of CNV deviation from a normal reference profile</p><p>Processing of normal tissue-specific expression data from GTEx</p><p>Detection of CNV regions</p></td><td align="left"><p>CNV_analysis()</p><p>process_GTEx_gene_reads()</p></td></tr><tr><td align="left">Transcriptional complexity</td><td align="left">Number of expressed genes in relation to the total reads, calculated using a ratio, linear model residuals and entropy</td><td align="left">transcr_compl()</td></tr><tr><td align="left">Proliferation</td><td align="left">Maximum between G1/S and G2/M gene set scores</td><td align="left">proliferation_analysis()</td></tr><tr><td align="left">Cell state trajectory</td><td align="left">Diffusion map computation</td><td align="left">diff_map()</td></tr><tr><td align="left">Cell cluster annotation</td><td align="left">Assessment of cluster enrichment for quantitative and categorical features</td><td align="left">assess_cluster_enrichment()</td></tr><tr><td align="left">Comparison of datasets</td><td align="left">Assessment of cluster markers or gene set expression across multiple datasets</td><td align="left">inter_dataset_comparison()</td></tr><tr><td align="left">Visualization</td><td align="left"><p>Automated UMAP visualizations for multiple features</p><p>Heatmaps: gene set scores, CNV, overlap between clusters</p><p>Boxplots and barplots of cluster enrichment</p><p>Diffusion maps</p></td><td align="left"><p>boxplot_cluster()</p><p>dotplot_cluster()</p><p>heatmap_CNV()</p><p>plot_profile_CNV()</p><p>plot_umap_colored_features()</p><p>plot_heatmap_features_by_clusters()</p><p>plot_diff_map()</p></td></tr></tbody></table></table-wrap></p>
    <sec id="Sec11">
      <title>Gene set scoring</title>
      <p id="Par52">scMuffin provides functions to set up one or more gene set collections and perform SC-level estimation of gene set expression scores in relation to an empirical null model (see Implementation section). This can be applied to any gene set and can therefore be used to estimate several different cell phenotypes, like pathway activities or marker set expression.</p>
      <p id="Par53">The function prepare_gsls() allows the user to collect gene sets of cell types, pathways, cancer functional states, as well as other collections of gene sets (e.g. positional gene sets, hallmarks) from CellMarker [<xref ref-type="bibr" rid="CR12">12</xref>], PanglaoDB [<xref ref-type="bibr" rid="CR13">13</xref>], CancerSEA [<xref ref-type="bibr" rid="CR14">14</xref>] and MSigDB [<xref ref-type="bibr" rid="CR8">8</xref>] databases. Unlike many existing tools that are used to perform marker-based cell annotation [<xref ref-type="bibr" rid="CR15">15</xref>], the availability of these gene sets within scMuffin package spares the user the effort of data collection and harmonization. The function, which also accepts any user-given gene sets, applies a series of criteria (e.g., minimum and maximum number of genes in a gene set) to filter the chosen gene sets.</p>
      <p id="Par54">The cell-level expression scores for these gene sets can be calculated using calculate_gs_scores(). For instance, the following code shows how to quantify the activity of “Cancer functional states” from CancerSEA [<xref ref-type="bibr" rid="CR14">14</xref>] at cell and cell cluster level:</p>
      <p id="Par55">
gsc &lt;- prepare_gsls(gs_sources = "CancerSEA", scMuffinList = scML)
</p>
      <p id="Par56">
scML &lt;- calculate_gs_scores(scMuffinList = scML, gs_list = gsc$CancerSEA)
</p>
      <p id="Par57">scML &lt;- calculate_gs_scores_in_clusters(scMuffinList = scML, partition_id = "global_expr")</p>
      <p id="Par58">where scML is the data structure that contains expression data and cell clusters (“global_expr”).</p>
      <p id="Par59">Cluster-level gene sets scores can be visualized as a heatmap to obtain a useful summary visualization that can provide insights for cluster annotation. This is accomplished by means of the function plot_heatmap_features_by_clusters(), which relies on the powerful ComplexHeatmap R package [<xref ref-type="bibr" rid="CR16">16</xref>]). For example, the analysis of the CancerSEA functional states in the HGG sample PJ016 showed that the two groups of cell clusters that are spatially separated in the UMAP visualization, that is clusters {0, 6, 8, 9} and {1, 2, 3, 4, 5, 7} (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), reflect distinct functional states (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Cell-level gene set scores can be visualized over the UMAP by means of plot_umap_colored_features() (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). <fig id="Fig2"><label>Fig. 2</label><caption><p>Quantification of CancerSEA functional states in the HGG sample PJ016. <bold>a</bold> UMAP visualization where cells are coloured by expression clusters. <bold>b</bold> Cluster-level expression scores (z-score) of all the CancerSEA functional states. <bold>c</bold> UMAP visualization where cells are colored by “Invasion” gene set score</p></caption><graphic xlink:href="12859_2023_5563_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>CNV estimation and association with CancerSEA functional states</title>
      <p id="Par60">CNV inference from SC transcriptomics in cancer provides a means to assess the presence of relevant genomic aberrations (duplications and deletions) based on the expression of adjacent genes. This knowledge offers crucial clues to address the difficult task of distinguishing normal from malignant cells and provides quantitative information to reconstruct the tumor clonal substructure. Moreover, CNV patterns allow the investigator to hypothesize link between genomic alterations and cell phenotypes. As a proof-of-concept, we describe CNV inference in scMuffin with and without a reference expression profile, and the association of CNV clusters with CancerSEA functional states.</p>
      <p id="Par61">CNV inference is performed by means of the function CNV_analysis(): </p>
      <p id="Par62">
scML &lt;- CNV_analysis(scMuffinList = scML, reference = GTEx_mean, center_genes = TRUE)
</p>
      <p id="Par63">where GTEx_mean contains a reference expression profile, which can be obtained by means of the function process_GTEx_gene_reads() starting from data available at The Genotype-Tissue Expression (GTEx) portal [<xref ref-type="bibr" rid="CR17">17</xref>]. The resulting scMuffinList scML contains the matrix with CNV values for each genomic regions in every cell, cell clusters by CNV, detected CNV regions and mapping information between gene locations and CNV regions.</p>
      <p id="Par64">Heatmaps that show CNV profiles of every cell, clustered by similarity, can be generated by means of plot_heatmap_CNV(). In the considered dataset (PJ030), we observed that the reference profile (normal brain samples from GTEx) is included into cluster 3, while clusters 0, 1 and 2 show large aneuploidies, some of which are typical of HGG, like the amplification of chromosome 7 as reported by dataset authors [<xref ref-type="bibr" rid="CR10">10</xref>] (Table <xref rid="Tab2" ref-type="table">2</xref>, Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, b). The median CNV profile of every cell cluster can be visualized by means of plot_profile_CNV() (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c) while boxplots of the distribution of CNV score by clusters can be visualized through boxplot_points() (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d).<table-wrap id="Tab2"><label>Table 2</label><caption><p>CNV regions detected in chromosomes 7 and 19 of sample PJ030</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Chr</th><th align="left">Start (location)</th><th align="left">Stop (location)</th><th align="left">Cluster</th><th align="left">Length</th></tr></thead><tbody><tr><td align="left">chr7</td><td char="," align="char">497,259</td><td char="," align="char">132,784,870</td><td char="." align="char">0</td><td char="," align="char">132,287,611</td></tr><tr><td align="left">chr7</td><td char="," align="char">497,259</td><td char="," align="char">132,784,870</td><td char="." align="char">1</td><td char="," align="char">132,287,611</td></tr><tr><td align="left">chr7</td><td char="," align="char">497,259</td><td char="," align="char">132,784,870</td><td char="." align="char">2</td><td char="," align="char">132,287,611</td></tr><tr><td align="left">chr19</td><td char="," align="char">416,582</td><td char="," align="char">48,872,391</td><td char="." align="char">0</td><td char="," align="char">48,455,809</td></tr><tr><td align="left">chr19</td><td char="," align="char">1,793,3014</td><td char="," align="char">58,551,565</td><td char="." align="char">1</td><td char="," align="char">40,618,551</td></tr><tr><td align="left">chr19</td><td char="," align="char">416,582</td><td char="," align="char">49,906,825</td><td char="." align="char">2</td><td char="," align="char">49,490,243</td></tr></tbody></table></table-wrap><fig id="Fig3"><label>Fig. 3</label><caption><p>CNV analysis (PJ030). <bold>a</bold> CNV heatmap where cells (columns) are grouped into “CNV clusters”; the cluster of cells that include the reference profile is highlighted through a red label. <bold>b</bold> UMAP visualizations where cells are colored by CNV clusters. <bold>c</bold> z-score of cluster 0 median CNV profile. <bold>d</bold> Distribution of cell CNV score (<italic>C</italic>) in clusters</p></caption><graphic xlink:href="12859_2023_5563_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par65">The analysis of another dataset (PJ016, without reference profile) showed two groups of clusters ({0, 1, 4} and {2, 3}) that map to separated regions of the UMAP visualization (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, b). Interestingly, clusters 2 and 3 are marked by peculiar amplifications in chromosome arms 1p and 19p. These “CNV clusters” correspond to expression clusters {0, 6, 8, 9} (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). The similarity of multiple cell partitions can be quantified using the function overlap_matrix().<fig id="Fig4"><label>Fig. 4</label><caption><p>CNV analysis and CancerSEA functional states (PJ016). <bold>a</bold> CNV heatmap where cells (columns) are grouped into “CNV clusters”. <bold>b</bold> UMAP visualizations where cells are colored by CNV clusters. <bold>c</bold> Overlap indices between expression clusters (prefix “EXPR_”) and CNV clusters (prefix “CNV_”). <bold>d</bold> Heatmap of CancerSEA functional state expression score (z-score) in CNV clusters</p></caption><graphic xlink:href="12859_2023_5563_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par66">An example of integrative analysis enabled by scMuffin is the functional assessment of CNV clusters. We quantified the expression scores of CancerSEA functional states throughout the CNV clusters of sample PJ016. As expected, the two aforementioned groups of CNV clusters {0, 1, 4} and {2, 3} are characterized by different functional states (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). This finding suggests that the peculiar amplifications of chromosomes 1 and 19 that characterize these clusters might underlie two phenotypes. A suggestive evidence of such hypothesis, with regards to the CancerSEA functional state “Invasion”, is the location of the two Invasion markers <italic>YBX1</italic> (Y-Box Binding Protein 1) and <italic>HNRNPM</italic> (Heterogeneous Nuclear Ribonucleoprotein M) within the amplified regions of chromosomes 1p and 19p (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a)<italic>. YBX1</italic> is a DNA/RNA-binding protein and transcription factor which plays a central role in coordinating tumor invasion in glioblastoma [<xref ref-type="bibr" rid="CR18">18</xref>]. <italic>HNRNPM</italic> belongs to a family of spliceosome auxiliary factors and is involved in the regulation of splicing; the upregulation of these factors results in tumor-associated aberrant splicing, which promotes glioma progression and malignancy [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. In particular, HNRNPM was identified as an interactor of the DNA/RNA binding protein SON, which drives oncogenic RNA splicing in glioblastoma [<xref ref-type="bibr" rid="CR21">21</xref>]. While it is beyond the scope of this article to validate this hypothesis, these findings clearly highlight the usefulness of the integrative analysis of CNVs and CancerSEA functional states provided by scMuffin.</p>
    </sec>
    <sec id="Sec13">
      <title>Cluster enrichment analysis: association of clusters and features</title>
      <p id="Par67">scMuffin contains functions for assessing the association between cell clusters and quantitative as well as categorical features, by means of CSEA and ORA, respectively. The function assess_cluster_enrichment() performs CSEA and ORA accordingly to the feature type under consideration. For example, the following instruction runs CSEA over the gene set scores, considering the partition “global_expr”:</p>
      <p id="Par68">
scML &lt;- assess_cluster_enrichment(scMuffinList = scML, feature_name = "gene_set_scoring", partition_id = "global_expr")
</p>
      <p id="Par69">The results of CSEA and ORA include several quantities, such as the normalized enrichment score (NES), the enrichment ratio (ER) and the false discovery rate (FDR) (Tables <xref rid="Tab3" ref-type="table">3</xref>, <xref rid="Tab4" ref-type="table">4</xref>). These results can be visualized as boxplots (quantitative features) and barplots (categorical features). For instance, the cluster 0 of sample PJ016 is particularly enriched—as expected—in “Invasion” markers (Table <xref rid="Tab3" ref-type="table">3</xref>, Fig. <xref rid="Fig5" ref-type="fig">5</xref>a) and cells assigned to G2/M or S phases (Table <xref rid="Tab4" ref-type="table">4</xref>, Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). The function extract_cluster_enrichment_table() provides a means to obtain tables of enrichment results across clusters, which can be visualized as heatmaps (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c), while extract_cluster_enrichment_tags() defines the most significant features as cluster labels that are therefore available for annotating UMAPs (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d).<table-wrap id="Tab3"><label>Table 3</label><caption><p>The output of CSEA analysis for a quantitative feature</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Cluster</th><th align="left">ES</th><th align="left">p</th><th align="left">p (BH)</th><th align="left">NES</th><th align="left">q (FDR)</th></tr></thead><tbody><tr><td align="left">0</td><td char="." align="char">0.67</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">2.38</td><td char="." align="char">0.01</td></tr><tr><td align="left">1</td><td char="." align="char">0.22</td><td char="." align="char">0.99</td><td char="." align="char">0.99</td><td char="." align="char">0.80</td><td char="." align="char">0.97</td></tr><tr><td align="left">2</td><td char="." align="char">-0.21</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">0.00</td><td char="." align="char">1.00</td></tr><tr><td align="left">3</td><td char="." align="char">-0.15</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">0.00</td><td char="." align="char">1.00</td></tr><tr><td align="left">4</td><td char="." align="char">-0.11</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">0.00</td><td char="." align="char">1.00</td></tr><tr><td align="left">5</td><td char="." align="char">0.25</td><td char="." align="char">0.80</td><td char="." align="char">0.89</td><td char="." align="char">0.92</td><td char="." align="char">0.90</td></tr><tr><td align="left">6</td><td char="." align="char">0.29</td><td char="." align="char">0.31</td><td char="." align="char">0.39</td><td char="." align="char">1.05</td><td char="." align="char">0.41</td></tr><tr><td align="left">7</td><td char="." align="char">0.33</td><td char="." align="char">0.11</td><td char="." align="char">0.18</td><td char="." align="char">1.14</td><td char="." align="char">0.20</td></tr><tr><td align="left">8</td><td char="." align="char">0.32</td><td char="." align="char">0.13</td><td char="." align="char">0.19</td><td char="." align="char">1.13</td><td char="." align="char">0.18</td></tr><tr><td align="left">9</td><td char="." align="char">0.71</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">2.43</td><td char="." align="char">0.01</td></tr></tbody></table><table-wrap-foot><p>This result is relative to the CancerSEA Invasion gene set on dataset PJ016</p><p><italic>ES</italic> Enrichment score, <italic>p</italic> CSEA <italic>p</italic> value, <italic>p (BH) p</italic> value after Bonferroni–Hochberg correction, <italic>NES</italic> Normalized enrichment score, <italic>q (FDR)</italic> q value of FDR</p></table-wrap-foot></table-wrap><table-wrap id="Tab4"><label>Table 4</label><caption><p>The output of an ORA analysis for a categorical feature</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Cluster</th><th align="left">N</th><th align="left">wb</th><th align="left">bb</th><th align="left">bd</th><th align="left">wbd</th><th align="left">exp</th><th align="left">ER</th><th align="left">p</th><th align="left">p (BH)</th></tr></thead><tbody><tr><td align="left">0</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">499</td><td char="." align="char">239</td><td char="." align="char">67.05</td><td char="." align="char">3.56</td><td align="left">1.67 × 10<sup>−105</sup></td><td align="left">8.34 × 10<sup>−105</sup></td></tr><tr><td align="left">1</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">475</td><td char="." align="char">4</td><td char="." align="char">63.83</td><td char="." align="char">0.06</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">2</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">378</td><td char="." align="char">4</td><td char="." align="char">50.79</td><td char="." align="char">0.08</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">3</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">309</td><td char="." align="char">2</td><td char="." align="char">41.52</td><td char="." align="char">0.05</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">4</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">296</td><td char="." align="char">7</td><td char="." align="char">39.77</td><td char="." align="char">0.18</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">5</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">257</td><td char="." align="char">0</td><td char="." align="char">34.53</td><td char="." align="char">0.00</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">6</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">185</td><td char="." align="char">4</td><td char="." align="char">24.86</td><td char="." align="char">0.16</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">7</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">172</td><td char="." align="char">0</td><td char="." align="char">23.11</td><td char="." align="char">0.00</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">8</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">142</td><td char="." align="char">5</td><td char="." align="char">19.08</td><td char="." align="char">0.26</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">9</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">115</td><td char="." align="char">115</td><td char="." align="char">15.45</td><td char="." align="char">7.44</td><td align="left">2.47 × 10<sup>−108</sup></td><td align="left">2.47 × 10<sup>−107</sup></td></tr></tbody></table><table-wrap-foot><p>Enrichment of every cluster in cells in “G2M” phase (dataset PJ016). The cell cycle phase was calculated by means of the function “CellCycleScoring()” from Seurat package [<xref ref-type="bibr" rid="CR3">3</xref>]</p><p><italic>N</italic> Number of cells, <italic>wb</italic> Number G2M cells, <italic>bb</italic> N-wb, <italic>wbd</italic> Number of G2M cells in the cluster, <italic>exp</italic> Expected number of G2M cells in the cluster, <italic>ER</italic> Enrichment ratio, <italic>p</italic> Hypergeometric p, <italic>p (BH) p</italic> value after Bonferroni–Hochberg correction</p></table-wrap-foot></table-wrap><fig id="Fig5"><label>Fig. 5</label><caption><p>Cluster enrichment analysis (PJ016). <bold>a</bold> Output of boxplot_cluster() function for a quantitative feature—CancerSEA functional states—in cluster 0: distribution of gene set scores values (red) and corresponfing null models (gray, suffix “_ref”) (top); Normalized Enrichment Score (z-score) and FDR <italic>q</italic>-value (bottom). <bold>b</bold> Output of barplot_cluster() function for a categorical feature—cell cycle phase—in cluster 0: expected (“exp”) and observed (“obs”) occurrences of every possible category (top); enrichment ratio (ER) and hypergeometric <italic>p</italic>-value (bottom). <bold>c</bold> Heatmap of NES values for CancerSEA functional states in expression clusters; asterisks indicate FDR q-value &lt; 0.01. <bold>d</bold> UMAP visualization where clusters are labelled with the top three most significant CancerSEA functional states</p></caption><graphic xlink:href="12859_2023_5563_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>Transcriptional complexity, proliferation rate and cell state trajectories</title>
      <p id="Par70">The number of expressed genes and proliferation rate are two relevant pieces of information for the characterization of cell type and cell state in cancer.</p>
      <p id="Par71">Undifferentiated stem or progenitor cells show a high number of expressed genes (open chromatin state) compared to differentiated cell types. In cancer context, a high number of expressed genes might suggest tumor initiating cells (TICs) or might indicate de-differentiation processes of tumor progression [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. For instance, in a recent study on glioblastoma, chromatin accessibility was associated with a specific subpopulation of putative tumor-initiating Cancer Stem Cells (CSCs) with invasive phenotype and low survival rate prediction [<xref ref-type="bibr" rid="CR24">24</xref>]. The transcriptional complexity of a cell can be calculated as follows:</p>
      <p id="Par72">
scML &lt;- transcr_compl(scMuffinList = scML,
min_counts=3, min_cells=10, min_genes=500
)
</p>
      <p id="Par73">where min_counts is the threshold above which a gene is considered expressed, min_cells is the minimum number of cells in which a gene must be expressed and min_genes is the minimum number of genes that a cell must express. In SC datasets, transcriptional complexity quantification is complicated by the presence of a linear relationship between number of expressed genes and total transcripts detected, where biological variability is entangled with sequencing deepness. scMuffin provides three measures of transcriptional complexity, which show three different – but complementary—relations with the number of total transcripts (<italic>t</italic>): the ratio (TC-R) prioritizes cells with a relatively low <italic>t</italic> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a); the linear model residuals (TC-LMR) are independent from <italic>t</italic> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b); lastly, the transcriptional entropy (TC-H) [<xref ref-type="bibr" rid="CR7">7</xref>] highlights genes with relatively high number of <italic>t</italic> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). All three measures may provide useful insights for the identification of particular cell types or states. For example, TC-R could be used when one is not interested in cell with a relatively abundant RNA production, like can be the case of quiescent cells with stem-like properties.<fig id="Fig6"><label>Fig. 6</label><caption><p>Transcriptional complexity, proliferation rate and cell state trajectories (PJ016). <bold>a</bold> Transcriptional Complexity Ratio (TC-R) of cells. <bold>b</bold> Transcriptional Complexity Linear Model Residuals (TC-LMR) of cells. <bold>c</bold> Transcriptional Complexity Entropy (TC-H) of cells. <bold>d</bold> Distribution of TC-R values split by cell proliferation score <bold>e</bold>–<bold>f</bold> Distribution of cells according to the first two “diffusion components” (DC)</p></caption><graphic xlink:href="12859_2023_5563_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par74">The proliferation rate is a relevant indicator for distinguishing cell types in solid tumors and helps to identify cells with potential clinical relevance and interest as candidate therapeutic targets [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. Cell proliferation rate is quantified based on the expression of G1/S and G2/M genes:</p>
      <p id="Par75">
scML &lt;- proliferation_analysis(scMuffinList = scML).
</p>
      <p id="Par76">As a proof-of-concept we jointly analysed cell TC and cell proliferation of sample PJ016 and visualized the results on a diffusion map [<xref ref-type="bibr" rid="CR27">27</xref>]—which can be run by means of the wrapper function diff_map(). This joint analysis shows that cells with the highest values of TC-R tend to have lower proliferation scores (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). These cells are located more closely to the branching point of the diffusion map (Fig. <xref rid="Fig6" ref-type="fig">6</xref>e), while the cells with the highest proliferation rates are located at a corner of one of the branches (Fig. <xref rid="Fig6" ref-type="fig">6</xref>f). This evidence suggests that the cells with high TC and low proliferation are interesting candidates for further analyses aimed at finding TICs in this dataset of HGG. Interestingly, this particular pattern is captured by TC-R, but not by TC-LMR and TC-H (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1).</p>
    </sec>
    <sec id="Sec15">
      <title>Comparison of datasets</title>
      <p id="Par77">A SC dataset carries an extensive amount of information. The integration of multiple SC datasets is a challenging task and multiple approaches have been proposed to address it [<xref ref-type="bibr" rid="CR28">28</xref>]. Typically, the integrated datasets are computationally demanding due to their huge size. An alternative possibility lies in cross-checking the expression of cluster markers between datasets: the expression of the cluster markers of every dataset is assessed in all considered datasets. For example, Nguyen et al. [<xref ref-type="bibr" rid="CR5">5</xref>] used this approach to study the occurrence of the characteristic cell types of normal mammary gland across samples collected from different subjects.</p>
      <p id="Par78">scMuffin provides a function to quantify the expression of a series of gene sets across multiple datasets:</p>
      <p id="Par79">
res &lt;- inter_dataset_comparison(seu_obj_list = seu_obj_list, gsl = cluster_markers_list)
</p>
      <p id="Par80">where seu_obj_list is a list of Seurat objects (each containing a SC dataset). If the gene sets are defined as cluster markers (“cluster_markers_list” in the code above), then the analysis sheds light over the possible presence of cells with similar expression profiles across datasets.</p>
      <p id="Par81">We performed this analysis on three datasets (PJ016, PJ017, PJ030) and found cell clusters that are more similar to clusters of other datasets than clusters of the same dataset, suggesting the presence of similar cells (Fig. <xref rid="Fig7" ref-type="fig">7</xref>a), like cluster 7 of PJ030 (“PJ030_C7”), which is close to clusters {0, 6, 8, 9} of PJ016. Importantly, the same analysis can be done using gene sets with a functional meaning, to obtain a functional characterization of similar cell types across datasets (Fig. <xref rid="Fig7" ref-type="fig">7</xref>b).<fig id="Fig7"><label>Fig. 7</label><caption><p>Inter-dataset comparison of gene set expression. <bold>a</bold> Heatmap of cluster marker (columns, “_Mx” suffix, where “x” indicates cluster number) expression scores across clusters (rows, “_Cx” suffix, where “x” indicates cluster number) of datasets PJ016, PJ017 and PJ030. <bold>b</bold> Heatmap of CancerSEA functional states scores across clusters of datasets as in panel (<bold>a</bold>)</p></caption><graphic xlink:href="12859_2023_5563_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec16">
      <title>scMuffin and scCancer</title>
      <p id="Par82">scCancer [<xref ref-type="bibr" rid="CR29">29</xref>] is an R package for automated processing of SC expression data in cancer. The two packages (scMuffin and scCancer) address the same challenge and are complementary. Indeed, each of them offers some analyses that the other does not (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Examples of this are cluster association analysis (CSEA and ORA), comparison of multiple cell partitions and inter-dataset gene set expression assessment, available in scMuffin, and cell interaction, expression programs and cancer micro-environment cell classification, provided by scCancer. Other types of analyses are common to both packages but differ by the underlying algorithm and/or implementation. This is the case, for instance, of gene set scoring and CNV analysis.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Conclusions</title>
    <p id="Par83">Here, we presented scMuffin, an R package that provides a series of functions to perform and integrate various types of analyses on SC expression data. As a proof-of-concept, to illustrate the user interface and its potentialities, we analysed publicly available SC expression datasets of human HGG. We described two examples of integrative analyses which returned particularly interesting findings that would deserve further investigations: the functional characterization of CNVs highlighted a possible link between amplifications of chromosomes 1p and 19p and invasive tumor phenotype; the joint analysis of transcriptional complexity, proliferation rate and cell state trajectories spotted cells that have some characteristics of TICs. Despite the inference of CNV from SC expression data is a challenging task, subject to various issues (e.g., missing data, number of aberrancies), it provides useful insights to clarify cell identity, like the distinction between a more aberrant cluster and the others or the distinction of tumoral and normal cells. The functions of scMuffin can be combined conveniently to address various tasks. For example, different partitions of the same dataset obtained using the same clustering method with different parameters can be characterized by means of their overlap and gene set expression, to gain insights on the appropriate number of clusters. The analyses offered by scMuffin and the results achieved in the proof-of-concept show that scMuffin helps addressing the main challenges in the bioinformatics analysis of SC datasets from solid tumors.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec20">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5563_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1. </bold>Supplementary methods, Figure S1 and Table S1.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CNV</term>
        <def>
          <p id="Par4">Copy number variation</p>
        </def>
      </def-item>
      <def-item>
        <term>CSC</term>
        <def>
          <p id="Par5">Cancer stem cells</p>
        </def>
      </def-item>
      <def-item>
        <term>CSEA</term>
        <def>
          <p id="Par6">Cell set enrichment analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p id="Par7">False discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>ER</term>
        <def>
          <p id="Par8">Enrichment ratio</p>
        </def>
      </def-item>
      <def-item>
        <term>GSEA</term>
        <def>
          <p id="Par9">Gene set enrichment analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>GTEx</term>
        <def>
          <p id="Par10">The Genotype-Tissue Expression project</p>
        </def>
      </def-item>
      <def-item>
        <term>HGG</term>
        <def>
          <p id="Par11">High grade glioma</p>
        </def>
      </def-item>
      <def-item>
        <term>NES</term>
        <def>
          <p id="Par12">Normalized enrichment score</p>
        </def>
      </def-item>
      <def-item>
        <term>ORA</term>
        <def>
          <p id="Par13">Over representation analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>SC</term>
        <def>
          <p id="Par14">Single cell</p>
        </def>
      </def-item>
      <def-item>
        <term>TC-R</term>
        <def>
          <p id="Par15">Transcriptional complexity ratio</p>
        </def>
      </def-item>
      <def-item>
        <term>TC-LMR</term>
        <def>
          <p id="Par16">Transcriptional complexity linear model residuals</p>
        </def>
      </def-item>
      <def-item>
        <term>TC-H</term>
        <def>
          <p id="Par17">Transcriptional complexity entropy</p>
        </def>
      </def-item>
      <def-item>
        <term>TICs</term>
        <def>
          <p id="Par18">Tumor initiating cells</p>
        </def>
      </def-item>
      <def-item>
        <term>UMAP</term>
        <def>
          <p id="Par19">Uniform manifold approximation and projection</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Paride Pelucchi and Ettore Mosca contributed equally to this work.</p>
    </fn>
  </fn-group>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>VN implemented the CNV functions, carried out the analyses, interpreted the results and wrote the article. AC implemented clustering functions, carried out the analyses, wrote the article, tested the package. NDN drafted the package, carried out the analyses and wrote the article. IC curated the biological aspects of CNV analysis and revised the article. MM and MG set up the computational infrastructure for data analysis. CC and EP curated the biological aspects of solid tumor data analysis. AS tested the package. RR, IZ, LM and AM contributed to the design of the study. PP contributed to the software design, case study definition, interpretation of the results and wrote the article. EM designed the study, implemented the software, performed the analysis, interpreted the results, and wrote the article. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded by the European Union “NextGenerationEU” and Italian Ministry of University and Research project “BBMRI.it” (Italian national node of BBMRI-ERIC, IR0000031), and by the Italian Ministry of University and Research PON Project “CNRBIOMICS” (PIR01_00017). The funding bodies played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The data used for the analyses described in this manuscript were obtained from: The Gene Expression Omnibus [<xref ref-type="bibr" rid="CR11">11</xref>], under the accession GSE103224; the GTEx Portal [<xref ref-type="bibr" rid="CR17">17</xref>] on 04/08/2020. Project name: scMuffin. Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/emosca-cnr/scMuffin">https://github.com/emosca-cnr/scMuffin</ext-link>. Operating system: Platform independent. Programming language: R (≥ 4.0.0). Other requirements: The R Project for Statistical Computing. License: GPL-3. Any restrictions to use by non-academics: According to GPL-3.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par84">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par85">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par86">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baslan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hicks</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Unravelling biology and shifting paradigms in cancer with single-cell sequencing</article-title>
        <source>Nat Rev Cancer</source>
        <year>2017</year>
        <volume>17</volume>
        <issue>9</issue>
        <fpage>557</fpage>
        <lpage>569</lpage>
        <pub-id pub-id-type="doi">10.1038/nrc.2017.58</pub-id>
        <?supplied-pmid 28835719?>
        <pub-id pub-id-type="pmid">28835719</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zappia</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Over 1000 tools reveal trends in the single-cell RNA-seq analysis landscape</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>301</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02519-4</pub-id>
        <?supplied-pmid 34715899?>
        <pub-id pub-id-type="pmid">34715899</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Andersen-Nissen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated analysis of multimodal single-cell data</article-title>
        <source>Cell.</source>
        <year>2021</year>
        <volume>184</volume>
        <issue>13</issue>
        <fpage>3573</fpage>
        <lpage>3587</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id>
        <?supplied-pmid 34062119?>
        <pub-id pub-id-type="pmid">34062119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Izar</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prakadan</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wadsworth</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Treacy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title>
        <source>Science (1979)</source>
        <year>2016</year>
        <volume>352</volume>
        <issue>6282</issue>
        <fpage>189</fpage>
        <lpage>196</lpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>QH</given-names>
          </name>
          <name>
            <surname>Pervolarakis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Profiling human breast epithelial cells using single cell RNA sequencing identifies cell diversity</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>2028</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-04334-1</pub-id>
        <?supplied-pmid 29795293?>
        <pub-id pub-id-type="pmid">29795293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Gillespie</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wakimoto</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>344</volume>
        <issue>6190</issue>
        <fpage>1396</fpage>
        <lpage>1401</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1254257</pub-id>
        <?supplied-pmid 24925914?>
        <pub-id pub-id-type="pmid">24925914</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gandrillon</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Gaillard</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Espinasse</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Garnier</surname>
            <given-names>NB</given-names>
          </name>
          <name>
            <surname>Dussiau</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kosmider</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Entropy as a measure of variability and stemness in single-cell transcriptomics</article-title>
        <source>Curr Opin Syst Biol.</source>
        <year>2021</year>
        <volume>27</volume>
        <fpage>100348</fpage>
        <pub-id pub-id-type="doi">10.1016/j.coisb.2021.05.009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2005</year>
        <volume>102</volume>
        <issue>43</issue>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <?supplied-pmid 16199517?>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khatri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sirota</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Butte</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Ten years of pathway analysis: current approaches and outstanding challenges. Ouzounis CA. editor</article-title>
        <source>PLoS Comput Biol.</source>
        <year>2012</year>
        <volume>8</volume>
        <issue>2</issue>
        <fpage>e1002375</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002375</pub-id>
        <?supplied-pmid 22383865?>
        <pub-id pub-id-type="pmid">22383865</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Levitin</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Frattini</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bush</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Boyett</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Samanamud</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome analysis of lineage diversity in high-grade glioma</article-title>
        <source>Genome Med</source>
        <year>2018</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>57</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-018-0567-9</pub-id>
        <?supplied-pmid 30041684?>
        <pub-id pub-id-type="pmid">30041684</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrett</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wilhite</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Ledoux</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Evangelista</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>IF</given-names>
          </name>
          <name>
            <surname>Tomashevsky</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NCBI GEO: archive for functional genomics data sets—update</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>41</volume>
        <issue>D1</issue>
        <fpage>D991</fpage>
        <lpage>D995</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1193</pub-id>
        <?supplied-pmid 23193258?>
        <pub-id pub-id-type="pmid">23193258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Quan</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell marker: a manually curated resource of cell markers in human and mouse</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D721</fpage>
        <lpage>D728</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky900</pub-id>
        <?supplied-pmid 30289549?>
        <pub-id pub-id-type="pmid">30289549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Franzén</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Gan</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Björkegren</surname>
            <given-names>JLM</given-names>
          </name>
        </person-group>
        <article-title>PanglaoDB: a web server for exploration of mouse and human single-cell RNA sequencing data</article-title>
        <source>Database</source>
        <year>2019</year>
        <volume>1</volume>
        <fpage>2019</fpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CancerSEA: a cancer single-cell state atlas</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D900</fpage>
        <lpage>D908</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky939</pub-id>
        <?supplied-pmid 30329142?>
        <pub-id pub-id-type="pmid">30329142</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clarke</surname>
            <given-names>ZA</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Atif</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pouyabahar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Innes</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>MacParland</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tutorial: guidelines for annotating single-cell transcriptomic maps using automated and manual methods</article-title>
        <source>Nat Protoc</source>
        <year>2021</year>
        <volume>16</volume>
        <issue>6</issue>
        <fpage>2749</fpage>
        <lpage>2764</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-021-00534-0</pub-id>
        <?supplied-pmid 34031612?>
        <pub-id pub-id-type="pmid">34031612</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Eils</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schlesner</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Complex heatmaps reveal patterns and correlations in multidimensional genomic data</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>18</issue>
        <fpage>2847</fpage>
        <lpage>2849</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw313</pub-id>
        <?supplied-pmid 27207943?>
        <pub-id pub-id-type="pmid">27207943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">GTEx Consortium. The genotype-tissue expression (GTEx) project.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Polisetty</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ganesh</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Gowda</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Purohit</surname>
            <given-names>AK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Altered transcriptional regulatory proteins in glioblastoma and YBX1 as a potential regulator of tumor invasion</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>10986</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-47360-9</pub-id>
        <?supplied-pmid 31358880?>
        <pub-id pub-id-type="pmid">31358880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LeFave</surname>
            <given-names>CV</given-names>
          </name>
          <name>
            <surname>Squatrito</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vorlova</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rocco</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Brennan</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Holland</surname>
            <given-names>EC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Splicing factor hnRNPH drives an oncogenic splicing switch in gliomas</article-title>
        <source>EMBO J</source>
        <year>2011</year>
        <volume>30</volume>
        <issue>19</issue>
        <fpage>4084</fpage>
        <lpage>4097</lpage>
        <pub-id pub-id-type="doi">10.1038/emboj.2011.259</pub-id>
        <?supplied-pmid 21915099?>
        <pub-id pub-id-type="pmid">21915099</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Golan-Gerstl</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shilo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Suh</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Bakàcs</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coppola</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Splicing factor hnRNP A2/B1 regulates tumor suppressor gene splicing and is an oncogenic driver in glioblastoma</article-title>
        <source>Cancer Res</source>
        <year>2011</year>
        <volume>71</volume>
        <issue>13</issue>
        <fpage>4464</fpage>
        <lpage>4472</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-10-4410</pub-id>
        <?supplied-pmid 21586613?>
        <pub-id pub-id-type="pmid">21586613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Jeong</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Vukadin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stone</surname>
            <given-names>JK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SON drives oncogenic RNA splicing in glioblastoma by regulating PTBP1/PTBP2 switching and RBFOX2 activity</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>5551</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-25892-x</pub-id>
        <?supplied-pmid 34548489?>
        <pub-id pub-id-type="pmid">34548489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wainwright</surname>
            <given-names>EN</given-names>
          </name>
          <name>
            <surname>Scaffidi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Epigenetics and cancer stem cells: unleashing, hijacking, and restricting cellular plasticity</article-title>
        <source>Trends Cancer</source>
        <year>2017</year>
        <volume>3</volume>
        <issue>5</issue>
        <fpage>372</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trecan.2017.04.004</pub-id>
        <?supplied-pmid 28718414?>
        <pub-id pub-id-type="pmid">28718414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaspar-Maia</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Alajem</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Meshorer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ramalho-Santos</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Open chromatin in pluripotency and reprogramming</article-title>
        <source>Nat Rev Mol Cell Biol</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>36</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm3036</pub-id>
        <?supplied-pmid 21179060?>
        <pub-id pub-id-type="pmid">21179060</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guilhamon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chesnelong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kushida</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Nikolic</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Singhal</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>MacLeod</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell chromatin accessibility profiling of glioblastoma identifies an invasive cancer stem cell population associated with lower survival</article-title>
        <source>Elife</source>
        <year>2021</year>
        <volume>11</volume>
        <fpage>10</fpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feitelson</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Arzumanyan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kulathinal</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Blain</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Holcombe</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Mahajna</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sustained proliferation in cancer: Mechanisms and novel therapeutic targets</article-title>
        <source>Semin Cancer Biol</source>
        <year>2015</year>
        <volume>35</volume>
        <fpage>S25</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1016/j.semcancer.2015.02.006</pub-id>
        <?supplied-pmid 25892662?>
        <pub-id pub-id-type="pmid">25892662</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Al-Hajj</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>Self-renewal and solid tumor stem cells</article-title>
        <source>Oncogene</source>
        <year>2004</year>
        <volume>23</volume>
        <issue>43</issue>
        <fpage>7274</fpage>
        <lpage>7282</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.onc.1207947</pub-id>
        <?supplied-pmid 15378087?>
        <pub-id pub-id-type="pmid">15378087</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Haghverdi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Büttner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Marr</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Destiny: diffusion maps for large-scale single-cell data in R</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>8</issue>
        <fpage>1241</fpage>
        <lpage>1243</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv715</pub-id>
        <?supplied-pmid 26668002?>
        <pub-id pub-id-type="pmid">26668002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forcato</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Romano</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Bicciato</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Computational methods for the integrative analysis of single-cell data</article-title>
        <source>Brief Bioinform.</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>3</issue>
        <fpage>bbaa042</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbaa042</pub-id>
        <?supplied-pmid 32363378?>
        <pub-id pub-id-type="pmid">32363378</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>scCancer: a package for automated processing of single-cell RNA-seq data in cancer</article-title>
        <source>Brief Bioinform.</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>3</issue>
        <fpage>bbaa127</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbaa127</pub-id>
        <?supplied-pmid 34020534?>
        <pub-id pub-id-type="pmid">34020534</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10680269</article-id>
    <article-id pub-id-type="publisher-id">5563</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05563-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>scMuffin: an R package to disentangle solid tumor heterogeneity by single-cell gene expression analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Nale</surname>
          <given-names>Valentina</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chiodi</surname>
          <given-names>Alice</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Di Nanni</surname>
          <given-names>Noemi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cifola</surname>
          <given-names>Ingrid</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moscatelli</surname>
          <given-names>Marco</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cocola</surname>
          <given-names>Cinzia</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gnocchi</surname>
          <given-names>Matteo</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Piscitelli</surname>
          <given-names>Eleonora</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sula</surname>
          <given-names>Ada</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zucchi</surname>
          <given-names>Ileana</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reinbold</surname>
          <given-names>Rolland</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Milanesi</surname>
          <given-names>Luciano</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mezzelani</surname>
          <given-names>Alessandra</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <name>
          <surname>Pelucchi</surname>
          <given-names>Paride</given-names>
        </name>
        <address>
          <email>paride.pelucchi@itb.cnr.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes" equal-contrib="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3102-5150</contrib-id>
        <name>
          <surname>Mosca</surname>
          <given-names>Ettore</given-names>
        </name>
        <address>
          <email>ettore.mosca@itb.cnr.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1"/>
      </contrib>
      <aff id="Aff1"><institution-wrap><institution-id institution-id-type="GRID">grid.5326.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 1940 4177</institution-id><institution>Institute of Biomedical Technologies, </institution><institution>National Research Council, </institution></institution-wrap>Via Fratelli Cervi 93, 20054 Segrate, Milan Italy </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>27</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>445</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>6</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>11</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Introduction</title>
        <p id="Par1">Single-cell (SC) gene expression analysis is crucial to dissect the complex cellular heterogeneity of solid tumors, which is one of the main obstacles for the development of effective cancer treatments. Such tumors typically contain a mixture of cells with aberrant genomic and transcriptomic profiles affecting specific sub-populations that might have a pivotal role in cancer progression, whose identification eludes bulk RNA-sequencing approaches. We present scMuffin, an R package that enables the characterization of cell identity in solid tumors on the basis of a various and complementary analyses on SC gene expression data.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">scMuffin provides a series of functions to calculate qualitative and quantitative scores, such as: expression of marker sets for normal and tumor conditions, pathway activity, cell state trajectories, Copy Number Variations, transcriptional complexity and proliferation state. Thus, scMuffin facilitates the combination of various evidences that can be used to distinguish normal and tumoral cells, define cell identities, cluster cells in different ways, link genomic aberrations to phenotypes and identify subtle differences between cell subtypes or cell states. We analysed public SC expression datasets of human high-grade gliomas as a proof-of-concept to show the value of scMuffin and illustrate its user interface. Nevertheless, these analyses lead to interesting findings, which suggest that some chromosomal amplifications might underlie the invasive tumor phenotype and the presence of cells that possess tumor initiating cells characteristics.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The analyses offered by scMuffin and the results achieved in the case study show that our tool helps addressing the main challenges in the bioinformatics analysis of SC expression data from solid tumors.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05563-y.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell transcriptomics</kwd>
      <kwd>Cancer</kwd>
      <kwd>Tumor heterogeneity</kwd>
      <kwd>Cell identity</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100021856</institution-id>
            <institution>Ministero dell'Università e della Ricerca</institution>
          </institution-wrap>
        </funding-source>
        <award-id>IR0000031</award-id>
        <award-id>PIR01_00017</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000780</institution-id>
            <institution>European Commission</institution>
          </institution-wrap>
        </funding-source>
        <award-id>IR0000031</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par20">Single-cell (SC) gene expression analysis is crucial to dissect the complex cellular heterogeneity of solid tumors, which is one of the main obstacles for the development of effective cancer treatments [<xref ref-type="bibr" rid="CR1">1</xref>]. A relevant number of software tools has been developed in recent years in the field of SC data analysis [<xref ref-type="bibr" rid="CR2">2</xref>], a fact that stresses the key opportunities and challenges in this field. A recent study has shown that the development of tools that address common tasks (e.g., clustering of similar cells) and ordering of cells (e.g., definition of cell trajectories) is decreasing, while a greater focus is being paid on data integration and classification [<xref ref-type="bibr" rid="CR2">2</xref>]. These observations reflect the growing availability, scale and complexity of SC datasets [<xref ref-type="bibr" rid="CR2">2</xref>].</p>
    <p id="Par21">SC datasets of solid tumors are typical examples of complex datasets that present a series of computational challenges and whose analysis demands domain-specific and integrative approaches. In fact, solid tumors typically contain a mixture of cells with aberrant genomic and transcriptomic profiles affecting specific sub-populations that might play a pivotal role in cancer progression, whose identification eludes bulk RNA-sequencing approaches. The use of cell type-specific markers (when available) is limited, and the alterations of gene expression that mark cancer cells makes the use of markers for normal cells not completely adequate. Moreover, the molecular heterogeneity of cancer cells (due to both intra-tumor and inter-individual differences) poses intrinsic limits in the definition of such markers. In addition, solid tumor samples typically comprise cells from the surrounding tissue or infiltrating cells that need to be distinguished from tumor populations for an effective analysis. Another challenge is the identification of clinically relevant cell subtypes that may be rare in the tumor mass, such as cancer stem cells or drug resistant subclones: because of their relatively low number, these cells are typically clustered together with many others. Lastly, an intrinsic problem of many SC datasets is the sequencing depth limit at the SC level. These limitations bound the number of detectable genes to the few thousands of the highest expressed genes, which implies, for example, that some established markers may not be used for data analysis.</p>
    <p id="Par22">To address these challenges, we developed scMuffin, an R package that implements a series of complementary analyses aimed at shedding light on the complexity of solid tumor SC expression data, including: a fast and customizable gene set scoring system; gene sets from various sources, including pathways, cancer functional states and cell markers; cell cluster association analysis with quantitative (e.g., gene set scores) as well as categorical (e.g. mutation states, proliferation states) features; copy number variation (CNV) analysis; transcriptional complexity analysis; proliferation rate quantification; and gene set based multi-dataset analysis (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). scMuffin facilitates the integrative analysis of these multiple features, thus allowing the identification of cell subtypes that elude more general clustering and classification approaches. We describe the key aspects of scMuffin implementation and then its user interface by means of a case study on a public SC expression dataset of human high-grade gliomas (HGG).<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of scMuffin package. scMuffin offers the possibility to perform several different analyses and data integration approaches to address the main challenges of SC gene expression analysis in solid tumors</p></caption><graphic xlink:href="12859_2023_5563_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par23">scMuffin is implemented as an R package and provides a series of functions that allows the user to quantify various genetic and phenotypic characteristics of single cells, which can be combined to obtain insights on cell identity and function. The functions of scMuffin operate on a common data structure, the “scMuffinList”, by adding, changing or removing its elements. Computationally intensive tasks (in particular, gene set scoring and CNV inference) are parallelized. Package documentation includes R vignettes and function documentation, which are also available as “GitHub Pages” at the URL <ext-link ext-link-type="uri" xlink:href="https://emosca-cnr.github.io/scMuffin">https://emosca-cnr.github.io/scMuffin</ext-link>. In this section, we describe package inputs and the main algorithms and definitions underlying the analyses offered by scMuffin.</p>
    <sec id="Sec3">
      <title>Input</title>
      <p id="Par24">scMuffin is intended to be used downstream to general purpose tasks like quality control, normalization, cell clustering and dataset integration, for which there are dedicated tools, such as Seurat [<xref ref-type="bibr" rid="CR3">3</xref>]. scMuffin requires the genes-by-cells raw counts matrix, genes-by-cells normalized expression matrix and a partition of cells in clusters. Typically, these matrices are filtered during preprocessing steps to exclude low quality cells and genes that could negatively affect the analyses. However, the characterization of cells that can be achieved with scMuffin offers insights that can be used to (further) filter the dataset and/or to decide on which cells apply particular analyses (e.g. biomarker identification). In general, according to research questions and experimental design one may want to apply strong or mild filters before using scMuffin.</p>
    </sec>
    <sec id="Sec4">
      <title>Quantification of gene set expression scores at cell and cluster levels</title>
      <p id="Par25">The quantification of gene set expression scores follows the approach described in [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>], in which a gene set is scored on the basis of its average deviation from an empirical null. The approach is implemented enabling the user to tune various parameters (e.g., the minimum number of cells in which a gene set must be expressed, the number of bins of the null model and the possible removal of missing values) to better address the needs of a particular study in relation to the characteristics of the dataset under analysis. In particular, the code is implemented to handle missing values, which are one of the main issues in SC datasets. For example, this is important to quantify the expression of gene sets that are expressed just in a small subset of cells (and have null values elsewhere), or to account for the expression of different members of the same pathway in different cells.</p>
      <p id="Par26">The algorithm for gene set scoring is the following. Given a gene set <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M2"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq1.gif"/></alternatives></inline-formula>:<list list-type="bullet"><list-item><p id="Par27">1. the genes occurring in the normalized genes-by-cells matrix are grouped into a series of bins according to their average expression across cells;</p></list-item><list-item><p id="Par28">2. a number <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M4"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq2.gif"/></alternatives></inline-formula> of random gene sets <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{i}^{*}$$\end{document}</tex-math><mml:math id="M6"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq3.gif"/></alternatives></inline-formula>: are created, of the same size of <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M8"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq4.gif"/></alternatives></inline-formula>, tossing genes from the same bins of <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M10"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq5.gif"/></alternatives></inline-formula>, in order to match the distribution of gene expression of each <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{i}^{*}$$\end{document}</tex-math><mml:math id="M12"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq6.gif"/></alternatives></inline-formula> with that of <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M14"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq7.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par29">3. the averages <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{c}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{ic}^{*}$$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq9.gif"/></alternatives></inline-formula> are calculated, respectively, over the values of <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M20"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq10.gif"/></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{i}^{*}$$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq11.gif"/></alternatives></inline-formula> in every cell <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M24"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq12.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par30">4. the expression score <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{c}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq13.gif"/></alternatives></inline-formula> is calculated as the average difference between <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{c}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq14.gif"/></alternatives></inline-formula> and <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{ic}^{*}$$\end{document}</tex-math><mml:math id="M30"><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq15.gif"/></alternatives></inline-formula>:<disp-formula id="Equa"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{c} = \frac{{\mathop \sum \nolimits_{i}^{k} \left( {m_{c} - m_{ic}^{*} } \right)}}{k}$$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mi>k</mml:mi></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><p id="Par31">5. the difference between the medians of <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{c}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>m</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq16.gif"/></alternatives></inline-formula> and <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{ic}^{*}$$\end{document}</tex-math><mml:math id="M36"><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq17.gif"/></alternatives></inline-formula> values in any cluster is used as the cluster-level score of <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M38"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq18.gif"/></alternatives></inline-formula>.</p></list-item></list></p>
    </sec>
    <sec id="Sec5">
      <title>CNV estimation based on adjacent gene expression</title>
      <p id="Par32">CNV inference in scMuffin is based on the “adjacent gene windows” approach [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR6">6</xref>], which has been validated using both single nucleotide polymorphism arrays [<xref ref-type="bibr" rid="CR6">6</xref>] and whole-exome sequencing [<xref ref-type="bibr" rid="CR4">4</xref>]. The approach is implemented in parallel and, like gene set scoring, offers various parameter tuning and data filtering possibilities, which allow the investigator to optimize the analysis to specific needs. The CNV profile of each cell is calculated as a moving average of scaled gene expression levels ordered by genomic location. scMuffin offers the possibility of subtracting a “normal” reference profile to highlight relative CNVs. Since a SC dataset derived from a sample of a solid tumor can either contain or not a proper set of physiological cells to be used as reference, this reference can be derived from cells that are part of the dataset under analysis (as described in [<xref ref-type="bibr" rid="CR4">4</xref>]), or using external dataset (as described in [<xref ref-type="bibr" rid="CR6">6</xref>]). The main steps are:<list list-type="order"><list-item><p id="Par33">the reference cells are added to the genes-by-cells matrix (optional);</p></list-item><list-item><p id="Par34">the expression of each gene is scaled subtracting its average (optional);</p></list-item><list-item><p id="Par35">the gene expression matrix is ordered by chromosome and gene location;</p></list-item><list-item><p id="Par36">in each chromosome <italic>h</italic>, the estimated copy number <inline-formula id="IEq19"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq19.gif"/></alternatives></inline-formula> of cell <italic>c</italic> is calculated for all the ordered genes <inline-formula id="IEq20"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \left[ {\frac{w}{2} + 1,n_{h} - \frac{w}{2}} \right]$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq20.gif"/></alternatives></inline-formula>:<disp-formula id="Equb"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic} = \mathop \sum \limits_{{j = i - \frac{w}{2}}}^{{i + \frac{w}{2}}} \frac{{e_{jc} }}{w + 1}$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>w</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:munderover><mml:mfrac><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">jc</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi>w</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list>where <italic>w</italic> is an even number that defines the window size, that is, the number of genes located before and after gene <italic>i</italic> which contribute to the estimation of <inline-formula id="IEq21"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq21.gif"/></alternatives></inline-formula>, <inline-formula id="IEq22"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{h}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>n</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq22.gif"/></alternatives></inline-formula> is the number of genes in <italic>h</italic>, and <inline-formula id="IEq23"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{jc}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi mathvariant="italic">jc</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq23.gif"/></alternatives></inline-formula> is the gene expression value;<list list-type="simple"><list-item><label>5.</label><p id="Par37"><inline-formula id="IEq24"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq24.gif"/></alternatives></inline-formula> values are scaled subtracting their average in a cell (optional);</p></list-item><list-item><label>6.</label><p id="Par38">cells are clustered by their CNV profile;</p></list-item><list-item><label>7.</label><p id="Par39">the average CNV profile of the normal reference cells is subtracted from all the CNV profiles (optional).</p></list-item><list-item><label>8.</label><p id="Par40">the CNV score of a cell is calculated as:<disp-formula id="Equc"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{c} = \mathop \sum \limits_{i} \left( {V_{ic} } \right)^{2}$$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msup><mml:mfenced close=")" open="("><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p></list-item></list></p>
      <p id="Par41">Cells are clustered based on their CNV profile using Seurat [<xref ref-type="bibr" rid="CR3">3</xref>]. A CNV region of a cluster is composed of the adjacent genes <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M56"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq25.gif"/></alternatives></inline-formula> that have absolute median <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq26.gif"/></alternatives></inline-formula> (within the cluster) higher than a given threshold. This threshold is by default defined as the standard deviation of <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ic}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq27.gif"/></alternatives></inline-formula> values of all cells.</p>
    </sec>
    <sec id="Sec6">
      <title>Transcriptional complexity</title>
      <p id="Par42">The transcriptional complexity (TC) is calculated using three different approaches. The TC-R <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{R}$$\end{document}</tex-math><mml:math id="M62"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq28.gif"/></alternatives></inline-formula> of a cell is inferred based on the number of expressed genes <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(g_{c} )$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq29.gif"/></alternatives></inline-formula> over the number of total mapped reads (transcripts) <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(t_{c} )$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq30.gif"/></alternatives></inline-formula>:<disp-formula id="Equd"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{R} = \frac{{g_{c} }}{{t_{c} }} \cdot \frac{{\mathop {\max }\limits_{c} \left( {t_{c} } \right)}}{{\mathop {\max }\limits_{c} \left( {g_{c} } \right)}}$$\end{document}</tex-math><mml:math id="M68" display="block"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfrac><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:munder><mml:mo movablelimits="false">max</mml:mo><mml:mi>c</mml:mi></mml:munder><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:mrow><mml:munder><mml:mo movablelimits="false">max</mml:mo><mml:mi>c</mml:mi></mml:munder><mml:mfenced close=")" open="("><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq31"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{c} = \# \left\{ {r_{ic} \ge \alpha } \right\}$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>#</mml:mo><mml:mfenced close="}" open="{"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq31.gif"/></alternatives></inline-formula>, <inline-formula id="IEq32"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M72"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq32.gif"/></alternatives></inline-formula> is a threshold over the gene count <inline-formula id="IEq33"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{ic}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq33.gif"/></alternatives></inline-formula> and defines the gene <italic>i</italic> as “expressed”, and <inline-formula id="IEq34"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{c} = \sum\nolimits_{i} {r_{ic} }$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq34.gif"/></alternatives></inline-formula>. Values of <inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{R}$$\end{document}</tex-math><mml:math id="M78"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>R</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq35.gif"/></alternatives></inline-formula> higher (lower) than 1 indicate a higher (lower) number of expressed genes in relation to the total transcripts of the cell.</p>
      <p id="Par43">The TC-LMR (linear model residual) of a cell corresponds to its residual in the linear regression model between <inline-formula id="IEq36"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{c}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq36.gif"/></alternatives></inline-formula> and <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_{c}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq37.gif"/></alternatives></inline-formula>:<disp-formula id="Eque"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{log}}_{10} \left( {g_{c} } \right) = \beta_{0} + \beta_{1} {\text{log}}_{10} \left( {t_{c} } \right) + \varepsilon_{c}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:msub><mml:mtext>log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mtext>log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Eque.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equf"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{LMR} = {\text{log}}_{10} \left( {g_{c} } \right) - \left[ {\beta_{0} + \beta_{1} {\text{log}}_{10} \left( {t_{c} } \right)} \right].$$\end{document}</tex-math><mml:math id="M86" display="block"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">LMR</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mtext>log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mtext>log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par44">Positive (negative) residuals indicate higher (lower) number of expressed genes in relation to total transcripts.</p>
      <p id="Par45">The TC-H (entropy) is quantified as the transcriptional entropy of the cell [<xref ref-type="bibr" rid="CR7">7</xref>]:<disp-formula id="Equg"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{c}^{H} = - \mathop \sum \limits_{ic} \left[ {p_{ic} {\text{ log}}\left( {p_{ic} } \right)} \right]$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mi>H</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:munder><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mspace width="0.333333em"/><mml:mtext>log</mml:mtext></mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equg.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq38"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{ic} = r_{ic} /t_{c}$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi mathvariant="italic">ic</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq38.gif"/></alternatives></inline-formula>. The higher the entropy the higher the number of expressed genes.</p>
    </sec>
    <sec id="Sec7">
      <title>Proliferation rate</title>
      <p id="Par46">The proliferation rate <inline-formula id="IEq39"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{c}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>P</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq39.gif"/></alternatives></inline-formula> of a cell is quantified as the maximum between the two gene set scores <inline-formula id="IEq40"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{c} \left( {S_{1} } \right)$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Y_{c} \left( {S_{2} } \right)$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq41.gif"/></alternatives></inline-formula>, calculated on the gene sets <inline-formula id="IEq42"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{1}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq42.gif"/></alternatives></inline-formula> and <inline-formula id="IEq43"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{2}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq43.gif"/></alternatives></inline-formula> that contain, respectively, genes involved in G1/S and G2/M cell cycle phases:<disp-formula id="Equh"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{c} = {\text{max}}\left( {Y_{c} \left( {S_{1} } \right), Y_{c} \left( {S_{2} } \right)} \right)$$\end{document}</tex-math><mml:math id="M102" display="block"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equh.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq44"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{1}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq44.gif"/></alternatives></inline-formula> and <inline-formula id="IEq45"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S_{2}$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi>S</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq45.gif"/></alternatives></inline-formula> are defined as in Tirosh et al. [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
    </sec>
    <sec id="Sec8">
      <title>Cluster enrichment analysis for quantitative and categorical features</title>
      <p id="Par47">The association between cell clusters and any cell-level feature is performed through Cell Set Enrichment Analysis (CSEA) and Over Representation Analysis (ORA) for, respectively, quantitative and categorical values. Importantly, these two types of analysis are implemented in parallel, which is particularly important for CSEA that uses permutations to build an empirical null distribution.</p>
      <p id="Par48">CSEA is the application of Gene Set Enrichment Analysis (GSEA) [<xref ref-type="bibr" rid="CR8">8</xref>] to cells and cell sets in place of, respectively, genes and gene sets: a ranked cell list is used instead of a ranked gene list, and cell sets (cell clusters) are tested instead of gene sets. In addition, the code is implemented to handle missing values. Therefore, scMuffin tests whether the cells assigned to a cluster are located at the top (bottom) of a ranked list of cells.</p>
      <p id="Par49">The assessment of cluster enrichment in a particular value of a categorical feature is computed using the over-representation analysis (ORA) approach [<xref ref-type="bibr" rid="CR9">9</xref>], which is based on the hypergeometric test. Here, this test assesses whether the occurrence of a particular value between the cells of a cluster in relation to all other clusters is higher than expected in a hypergeometric experiment.</p>
    </sec>
    <sec id="Sec9">
      <title>Overlap between partitions of cells</title>
      <p id="Par50">Cell partitions resulting from different clustering analyses are compared by calculating the overlap coefficients among all-pairs of clusters. Given two partitions <italic>A</italic> and <italic>B</italic>, defined as sets of cell clusters <inline-formula id="IEq46"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A = \left\{ {a_{i} } \right\}{ }$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mrow/></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq46.gif"/></alternatives></inline-formula> and <inline-formula id="IEq47"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B = \left\{ {b_{j} } \right\}$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq47.gif"/></alternatives></inline-formula>, the similarity between the cell clusters <inline-formula id="IEq48"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{i}$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq48.gif"/></alternatives></inline-formula> and <inline-formula id="IEq49"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{j}$$\end{document}</tex-math><mml:math id="M114"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5563_Article_IEq49.gif"/></alternatives></inline-formula> is calculated as:<disp-formula id="Equi"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o_{ij} = \frac{{\left| {a_{i} \cap b_{j} } \right|}}{{\min \left( {\left| {a_{i} } \right|,\left| {b_{j} } \right|} \right)}}$$\end{document}</tex-math><mml:math id="M116" display="block"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mfenced close="|" open="|"><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="12859_2023_5563_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Results and discussion</title>
    <p id="Par51">In this section, we present the user interface (Table <xref rid="Tab1" ref-type="table">1</xref>), taking advantage of the results obtained on the SC dataset generated by Yuan et al. [<xref ref-type="bibr" rid="CR10">10</xref>] from human high-grade glioma (HGG) samples (available on the Gene Expression Omnibus (GEO) repository [<xref ref-type="bibr" rid="CR11">11</xref>] with identifier GSE103224, see Supplementary Methods in Additional file <xref rid="MOESM1" ref-type="media">1</xref>).<table-wrap id="Tab1"><label>Table 1</label><caption><p>Main tasks and corresponding functions in scMuffin</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Task</th><th align="left">Description</th><th align="left">User interface</th></tr></thead><tbody><tr><td align="left">Create the scMuffinList</td><td align="left">Create the scMuffinList from counts and normalized expression data</td><td align="left">create_scMuffinList()</td></tr><tr><td align="left">Add a partition</td><td align="left">Add a partition of cell (clusters)</td><td align="left">add_partition()</td></tr><tr><td align="left">Gene set expression scoring</td><td align="left"><p>Average gene set expression deviation from matched empirical reference</p><p>Provided gene sets from CellMarker [<xref ref-type="bibr" rid="CR12">12</xref>], PanglaoDB [<xref ref-type="bibr" rid="CR13">13</xref>], CancerSEA [<xref ref-type="bibr" rid="CR14">14</xref>] and MSigDB [<xref ref-type="bibr" rid="CR8">8</xref>]</p></td><td align="left"><p>prepare_gsls()</p><p>calculate_gs_scores()</p><p>calculate_gs_scores_in_clusters()</p></td></tr><tr><td align="left">CNV</td><td align="left"><p>Estimation of CNVs by means of the “moving window” approach, that is, considering the expression of adjacent genes</p><p>Calculation of CNV deviation from a normal reference profile</p><p>Processing of normal tissue-specific expression data from GTEx</p><p>Detection of CNV regions</p></td><td align="left"><p>CNV_analysis()</p><p>process_GTEx_gene_reads()</p></td></tr><tr><td align="left">Transcriptional complexity</td><td align="left">Number of expressed genes in relation to the total reads, calculated using a ratio, linear model residuals and entropy</td><td align="left">transcr_compl()</td></tr><tr><td align="left">Proliferation</td><td align="left">Maximum between G1/S and G2/M gene set scores</td><td align="left">proliferation_analysis()</td></tr><tr><td align="left">Cell state trajectory</td><td align="left">Diffusion map computation</td><td align="left">diff_map()</td></tr><tr><td align="left">Cell cluster annotation</td><td align="left">Assessment of cluster enrichment for quantitative and categorical features</td><td align="left">assess_cluster_enrichment()</td></tr><tr><td align="left">Comparison of datasets</td><td align="left">Assessment of cluster markers or gene set expression across multiple datasets</td><td align="left">inter_dataset_comparison()</td></tr><tr><td align="left">Visualization</td><td align="left"><p>Automated UMAP visualizations for multiple features</p><p>Heatmaps: gene set scores, CNV, overlap between clusters</p><p>Boxplots and barplots of cluster enrichment</p><p>Diffusion maps</p></td><td align="left"><p>boxplot_cluster()</p><p>dotplot_cluster()</p><p>heatmap_CNV()</p><p>plot_profile_CNV()</p><p>plot_umap_colored_features()</p><p>plot_heatmap_features_by_clusters()</p><p>plot_diff_map()</p></td></tr></tbody></table></table-wrap></p>
    <sec id="Sec11">
      <title>Gene set scoring</title>
      <p id="Par52">scMuffin provides functions to set up one or more gene set collections and perform SC-level estimation of gene set expression scores in relation to an empirical null model (see Implementation section). This can be applied to any gene set and can therefore be used to estimate several different cell phenotypes, like pathway activities or marker set expression.</p>
      <p id="Par53">The function prepare_gsls() allows the user to collect gene sets of cell types, pathways, cancer functional states, as well as other collections of gene sets (e.g. positional gene sets, hallmarks) from CellMarker [<xref ref-type="bibr" rid="CR12">12</xref>], PanglaoDB [<xref ref-type="bibr" rid="CR13">13</xref>], CancerSEA [<xref ref-type="bibr" rid="CR14">14</xref>] and MSigDB [<xref ref-type="bibr" rid="CR8">8</xref>] databases. Unlike many existing tools that are used to perform marker-based cell annotation [<xref ref-type="bibr" rid="CR15">15</xref>], the availability of these gene sets within scMuffin package spares the user the effort of data collection and harmonization. The function, which also accepts any user-given gene sets, applies a series of criteria (e.g., minimum and maximum number of genes in a gene set) to filter the chosen gene sets.</p>
      <p id="Par54">The cell-level expression scores for these gene sets can be calculated using calculate_gs_scores(). For instance, the following code shows how to quantify the activity of “Cancer functional states” from CancerSEA [<xref ref-type="bibr" rid="CR14">14</xref>] at cell and cell cluster level:</p>
      <p id="Par55">
gsc &lt;- prepare_gsls(gs_sources = "CancerSEA", scMuffinList = scML)
</p>
      <p id="Par56">
scML &lt;- calculate_gs_scores(scMuffinList = scML, gs_list = gsc$CancerSEA)
</p>
      <p id="Par57">scML &lt;- calculate_gs_scores_in_clusters(scMuffinList = scML, partition_id = "global_expr")</p>
      <p id="Par58">where scML is the data structure that contains expression data and cell clusters (“global_expr”).</p>
      <p id="Par59">Cluster-level gene sets scores can be visualized as a heatmap to obtain a useful summary visualization that can provide insights for cluster annotation. This is accomplished by means of the function plot_heatmap_features_by_clusters(), which relies on the powerful ComplexHeatmap R package [<xref ref-type="bibr" rid="CR16">16</xref>]). For example, the analysis of the CancerSEA functional states in the HGG sample PJ016 showed that the two groups of cell clusters that are spatially separated in the UMAP visualization, that is clusters {0, 6, 8, 9} and {1, 2, 3, 4, 5, 7} (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a), reflect distinct functional states (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). Cell-level gene set scores can be visualized over the UMAP by means of plot_umap_colored_features() (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). <fig id="Fig2"><label>Fig. 2</label><caption><p>Quantification of CancerSEA functional states in the HGG sample PJ016. <bold>a</bold> UMAP visualization where cells are coloured by expression clusters. <bold>b</bold> Cluster-level expression scores (z-score) of all the CancerSEA functional states. <bold>c</bold> UMAP visualization where cells are colored by “Invasion” gene set score</p></caption><graphic xlink:href="12859_2023_5563_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>CNV estimation and association with CancerSEA functional states</title>
      <p id="Par60">CNV inference from SC transcriptomics in cancer provides a means to assess the presence of relevant genomic aberrations (duplications and deletions) based on the expression of adjacent genes. This knowledge offers crucial clues to address the difficult task of distinguishing normal from malignant cells and provides quantitative information to reconstruct the tumor clonal substructure. Moreover, CNV patterns allow the investigator to hypothesize link between genomic alterations and cell phenotypes. As a proof-of-concept, we describe CNV inference in scMuffin with and without a reference expression profile, and the association of CNV clusters with CancerSEA functional states.</p>
      <p id="Par61">CNV inference is performed by means of the function CNV_analysis(): </p>
      <p id="Par62">
scML &lt;- CNV_analysis(scMuffinList = scML, reference = GTEx_mean, center_genes = TRUE)
</p>
      <p id="Par63">where GTEx_mean contains a reference expression profile, which can be obtained by means of the function process_GTEx_gene_reads() starting from data available at The Genotype-Tissue Expression (GTEx) portal [<xref ref-type="bibr" rid="CR17">17</xref>]. The resulting scMuffinList scML contains the matrix with CNV values for each genomic regions in every cell, cell clusters by CNV, detected CNV regions and mapping information between gene locations and CNV regions.</p>
      <p id="Par64">Heatmaps that show CNV profiles of every cell, clustered by similarity, can be generated by means of plot_heatmap_CNV(). In the considered dataset (PJ030), we observed that the reference profile (normal brain samples from GTEx) is included into cluster 3, while clusters 0, 1 and 2 show large aneuploidies, some of which are typical of HGG, like the amplification of chromosome 7 as reported by dataset authors [<xref ref-type="bibr" rid="CR10">10</xref>] (Table <xref rid="Tab2" ref-type="table">2</xref>, Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, b). The median CNV profile of every cell cluster can be visualized by means of plot_profile_CNV() (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c) while boxplots of the distribution of CNV score by clusters can be visualized through boxplot_points() (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d).<table-wrap id="Tab2"><label>Table 2</label><caption><p>CNV regions detected in chromosomes 7 and 19 of sample PJ030</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Chr</th><th align="left">Start (location)</th><th align="left">Stop (location)</th><th align="left">Cluster</th><th align="left">Length</th></tr></thead><tbody><tr><td align="left">chr7</td><td char="," align="char">497,259</td><td char="," align="char">132,784,870</td><td char="." align="char">0</td><td char="," align="char">132,287,611</td></tr><tr><td align="left">chr7</td><td char="," align="char">497,259</td><td char="," align="char">132,784,870</td><td char="." align="char">1</td><td char="," align="char">132,287,611</td></tr><tr><td align="left">chr7</td><td char="," align="char">497,259</td><td char="," align="char">132,784,870</td><td char="." align="char">2</td><td char="," align="char">132,287,611</td></tr><tr><td align="left">chr19</td><td char="," align="char">416,582</td><td char="," align="char">48,872,391</td><td char="." align="char">0</td><td char="," align="char">48,455,809</td></tr><tr><td align="left">chr19</td><td char="," align="char">1,793,3014</td><td char="," align="char">58,551,565</td><td char="." align="char">1</td><td char="," align="char">40,618,551</td></tr><tr><td align="left">chr19</td><td char="," align="char">416,582</td><td char="," align="char">49,906,825</td><td char="." align="char">2</td><td char="," align="char">49,490,243</td></tr></tbody></table></table-wrap><fig id="Fig3"><label>Fig. 3</label><caption><p>CNV analysis (PJ030). <bold>a</bold> CNV heatmap where cells (columns) are grouped into “CNV clusters”; the cluster of cells that include the reference profile is highlighted through a red label. <bold>b</bold> UMAP visualizations where cells are colored by CNV clusters. <bold>c</bold> z-score of cluster 0 median CNV profile. <bold>d</bold> Distribution of cell CNV score (<italic>C</italic>) in clusters</p></caption><graphic xlink:href="12859_2023_5563_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par65">The analysis of another dataset (PJ016, without reference profile) showed two groups of clusters ({0, 1, 4} and {2, 3}) that map to separated regions of the UMAP visualization (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, b). Interestingly, clusters 2 and 3 are marked by peculiar amplifications in chromosome arms 1p and 19p. These “CNV clusters” correspond to expression clusters {0, 6, 8, 9} (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). The similarity of multiple cell partitions can be quantified using the function overlap_matrix().<fig id="Fig4"><label>Fig. 4</label><caption><p>CNV analysis and CancerSEA functional states (PJ016). <bold>a</bold> CNV heatmap where cells (columns) are grouped into “CNV clusters”. <bold>b</bold> UMAP visualizations where cells are colored by CNV clusters. <bold>c</bold> Overlap indices between expression clusters (prefix “EXPR_”) and CNV clusters (prefix “CNV_”). <bold>d</bold> Heatmap of CancerSEA functional state expression score (z-score) in CNV clusters</p></caption><graphic xlink:href="12859_2023_5563_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par66">An example of integrative analysis enabled by scMuffin is the functional assessment of CNV clusters. We quantified the expression scores of CancerSEA functional states throughout the CNV clusters of sample PJ016. As expected, the two aforementioned groups of CNV clusters {0, 1, 4} and {2, 3} are characterized by different functional states (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). This finding suggests that the peculiar amplifications of chromosomes 1 and 19 that characterize these clusters might underlie two phenotypes. A suggestive evidence of such hypothesis, with regards to the CancerSEA functional state “Invasion”, is the location of the two Invasion markers <italic>YBX1</italic> (Y-Box Binding Protein 1) and <italic>HNRNPM</italic> (Heterogeneous Nuclear Ribonucleoprotein M) within the amplified regions of chromosomes 1p and 19p (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a)<italic>. YBX1</italic> is a DNA/RNA-binding protein and transcription factor which plays a central role in coordinating tumor invasion in glioblastoma [<xref ref-type="bibr" rid="CR18">18</xref>]. <italic>HNRNPM</italic> belongs to a family of spliceosome auxiliary factors and is involved in the regulation of splicing; the upregulation of these factors results in tumor-associated aberrant splicing, which promotes glioma progression and malignancy [<xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. In particular, HNRNPM was identified as an interactor of the DNA/RNA binding protein SON, which drives oncogenic RNA splicing in glioblastoma [<xref ref-type="bibr" rid="CR21">21</xref>]. While it is beyond the scope of this article to validate this hypothesis, these findings clearly highlight the usefulness of the integrative analysis of CNVs and CancerSEA functional states provided by scMuffin.</p>
    </sec>
    <sec id="Sec13">
      <title>Cluster enrichment analysis: association of clusters and features</title>
      <p id="Par67">scMuffin contains functions for assessing the association between cell clusters and quantitative as well as categorical features, by means of CSEA and ORA, respectively. The function assess_cluster_enrichment() performs CSEA and ORA accordingly to the feature type under consideration. For example, the following instruction runs CSEA over the gene set scores, considering the partition “global_expr”:</p>
      <p id="Par68">
scML &lt;- assess_cluster_enrichment(scMuffinList = scML, feature_name = "gene_set_scoring", partition_id = "global_expr")
</p>
      <p id="Par69">The results of CSEA and ORA include several quantities, such as the normalized enrichment score (NES), the enrichment ratio (ER) and the false discovery rate (FDR) (Tables <xref rid="Tab3" ref-type="table">3</xref>, <xref rid="Tab4" ref-type="table">4</xref>). These results can be visualized as boxplots (quantitative features) and barplots (categorical features). For instance, the cluster 0 of sample PJ016 is particularly enriched—as expected—in “Invasion” markers (Table <xref rid="Tab3" ref-type="table">3</xref>, Fig. <xref rid="Fig5" ref-type="fig">5</xref>a) and cells assigned to G2/M or S phases (Table <xref rid="Tab4" ref-type="table">4</xref>, Fig. <xref rid="Fig5" ref-type="fig">5</xref>b). The function extract_cluster_enrichment_table() provides a means to obtain tables of enrichment results across clusters, which can be visualized as heatmaps (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c), while extract_cluster_enrichment_tags() defines the most significant features as cluster labels that are therefore available for annotating UMAPs (Fig. <xref rid="Fig5" ref-type="fig">5</xref>d).<table-wrap id="Tab3"><label>Table 3</label><caption><p>The output of CSEA analysis for a quantitative feature</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Cluster</th><th align="left">ES</th><th align="left">p</th><th align="left">p (BH)</th><th align="left">NES</th><th align="left">q (FDR)</th></tr></thead><tbody><tr><td align="left">0</td><td char="." align="char">0.67</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">2.38</td><td char="." align="char">0.01</td></tr><tr><td align="left">1</td><td char="." align="char">0.22</td><td char="." align="char">0.99</td><td char="." align="char">0.99</td><td char="." align="char">0.80</td><td char="." align="char">0.97</td></tr><tr><td align="left">2</td><td char="." align="char">-0.21</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">0.00</td><td char="." align="char">1.00</td></tr><tr><td align="left">3</td><td char="." align="char">-0.15</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">0.00</td><td char="." align="char">1.00</td></tr><tr><td align="left">4</td><td char="." align="char">-0.11</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">0.00</td><td char="." align="char">1.00</td></tr><tr><td align="left">5</td><td char="." align="char">0.25</td><td char="." align="char">0.80</td><td char="." align="char">0.89</td><td char="." align="char">0.92</td><td char="." align="char">0.90</td></tr><tr><td align="left">6</td><td char="." align="char">0.29</td><td char="." align="char">0.31</td><td char="." align="char">0.39</td><td char="." align="char">1.05</td><td char="." align="char">0.41</td></tr><tr><td align="left">7</td><td char="." align="char">0.33</td><td char="." align="char">0.11</td><td char="." align="char">0.18</td><td char="." align="char">1.14</td><td char="." align="char">0.20</td></tr><tr><td align="left">8</td><td char="." align="char">0.32</td><td char="." align="char">0.13</td><td char="." align="char">0.19</td><td char="." align="char">1.13</td><td char="." align="char">0.18</td></tr><tr><td align="left">9</td><td char="." align="char">0.71</td><td char="." align="char">0.01</td><td char="." align="char">0.02</td><td char="." align="char">2.43</td><td char="." align="char">0.01</td></tr></tbody></table><table-wrap-foot><p>This result is relative to the CancerSEA Invasion gene set on dataset PJ016</p><p><italic>ES</italic> Enrichment score, <italic>p</italic> CSEA <italic>p</italic> value, <italic>p (BH) p</italic> value after Bonferroni–Hochberg correction, <italic>NES</italic> Normalized enrichment score, <italic>q (FDR)</italic> q value of FDR</p></table-wrap-foot></table-wrap><table-wrap id="Tab4"><label>Table 4</label><caption><p>The output of an ORA analysis for a categorical feature</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Cluster</th><th align="left">N</th><th align="left">wb</th><th align="left">bb</th><th align="left">bd</th><th align="left">wbd</th><th align="left">exp</th><th align="left">ER</th><th align="left">p</th><th align="left">p (BH)</th></tr></thead><tbody><tr><td align="left">0</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">499</td><td char="." align="char">239</td><td char="." align="char">67.05</td><td char="." align="char">3.56</td><td align="left">1.67 × 10<sup>−105</sup></td><td align="left">8.34 × 10<sup>−105</sup></td></tr><tr><td align="left">1</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">475</td><td char="." align="char">4</td><td char="." align="char">63.83</td><td char="." align="char">0.06</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">2</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">378</td><td char="." align="char">4</td><td char="." align="char">50.79</td><td char="." align="char">0.08</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">3</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">309</td><td char="." align="char">2</td><td char="." align="char">41.52</td><td char="." align="char">0.05</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">4</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">296</td><td char="." align="char">7</td><td char="." align="char">39.77</td><td char="." align="char">0.18</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">5</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">257</td><td char="." align="char">0</td><td char="." align="char">34.53</td><td char="." align="char">0.00</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">6</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">185</td><td char="." align="char">4</td><td char="." align="char">24.86</td><td char="." align="char">0.16</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">7</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">172</td><td char="." align="char">0</td><td char="." align="char">23.11</td><td char="." align="char">0.00</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">8</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">142</td><td char="." align="char">5</td><td char="." align="char">19.08</td><td char="." align="char">0.26</td><td align="left">1.00</td><td align="left">1.00</td></tr><tr><td align="left">9</td><td char="." align="char">2828</td><td char="." align="char">380</td><td char="." align="char">2448</td><td char="." align="char">115</td><td char="." align="char">115</td><td char="." align="char">15.45</td><td char="." align="char">7.44</td><td align="left">2.47 × 10<sup>−108</sup></td><td align="left">2.47 × 10<sup>−107</sup></td></tr></tbody></table><table-wrap-foot><p>Enrichment of every cluster in cells in “G2M” phase (dataset PJ016). The cell cycle phase was calculated by means of the function “CellCycleScoring()” from Seurat package [<xref ref-type="bibr" rid="CR3">3</xref>]</p><p><italic>N</italic> Number of cells, <italic>wb</italic> Number G2M cells, <italic>bb</italic> N-wb, <italic>wbd</italic> Number of G2M cells in the cluster, <italic>exp</italic> Expected number of G2M cells in the cluster, <italic>ER</italic> Enrichment ratio, <italic>p</italic> Hypergeometric p, <italic>p (BH) p</italic> value after Bonferroni–Hochberg correction</p></table-wrap-foot></table-wrap><fig id="Fig5"><label>Fig. 5</label><caption><p>Cluster enrichment analysis (PJ016). <bold>a</bold> Output of boxplot_cluster() function for a quantitative feature—CancerSEA functional states—in cluster 0: distribution of gene set scores values (red) and corresponfing null models (gray, suffix “_ref”) (top); Normalized Enrichment Score (z-score) and FDR <italic>q</italic>-value (bottom). <bold>b</bold> Output of barplot_cluster() function for a categorical feature—cell cycle phase—in cluster 0: expected (“exp”) and observed (“obs”) occurrences of every possible category (top); enrichment ratio (ER) and hypergeometric <italic>p</italic>-value (bottom). <bold>c</bold> Heatmap of NES values for CancerSEA functional states in expression clusters; asterisks indicate FDR q-value &lt; 0.01. <bold>d</bold> UMAP visualization where clusters are labelled with the top three most significant CancerSEA functional states</p></caption><graphic xlink:href="12859_2023_5563_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>Transcriptional complexity, proliferation rate and cell state trajectories</title>
      <p id="Par70">The number of expressed genes and proliferation rate are two relevant pieces of information for the characterization of cell type and cell state in cancer.</p>
      <p id="Par71">Undifferentiated stem or progenitor cells show a high number of expressed genes (open chromatin state) compared to differentiated cell types. In cancer context, a high number of expressed genes might suggest tumor initiating cells (TICs) or might indicate de-differentiation processes of tumor progression [<xref ref-type="bibr" rid="CR22">22</xref>, <xref ref-type="bibr" rid="CR23">23</xref>]. For instance, in a recent study on glioblastoma, chromatin accessibility was associated with a specific subpopulation of putative tumor-initiating Cancer Stem Cells (CSCs) with invasive phenotype and low survival rate prediction [<xref ref-type="bibr" rid="CR24">24</xref>]. The transcriptional complexity of a cell can be calculated as follows:</p>
      <p id="Par72">
scML &lt;- transcr_compl(scMuffinList = scML,
min_counts=3, min_cells=10, min_genes=500
)
</p>
      <p id="Par73">where min_counts is the threshold above which a gene is considered expressed, min_cells is the minimum number of cells in which a gene must be expressed and min_genes is the minimum number of genes that a cell must express. In SC datasets, transcriptional complexity quantification is complicated by the presence of a linear relationship between number of expressed genes and total transcripts detected, where biological variability is entangled with sequencing deepness. scMuffin provides three measures of transcriptional complexity, which show three different – but complementary—relations with the number of total transcripts (<italic>t</italic>): the ratio (TC-R) prioritizes cells with a relatively low <italic>t</italic> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a); the linear model residuals (TC-LMR) are independent from <italic>t</italic> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b); lastly, the transcriptional entropy (TC-H) [<xref ref-type="bibr" rid="CR7">7</xref>] highlights genes with relatively high number of <italic>t</italic> (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). All three measures may provide useful insights for the identification of particular cell types or states. For example, TC-R could be used when one is not interested in cell with a relatively abundant RNA production, like can be the case of quiescent cells with stem-like properties.<fig id="Fig6"><label>Fig. 6</label><caption><p>Transcriptional complexity, proliferation rate and cell state trajectories (PJ016). <bold>a</bold> Transcriptional Complexity Ratio (TC-R) of cells. <bold>b</bold> Transcriptional Complexity Linear Model Residuals (TC-LMR) of cells. <bold>c</bold> Transcriptional Complexity Entropy (TC-H) of cells. <bold>d</bold> Distribution of TC-R values split by cell proliferation score <bold>e</bold>–<bold>f</bold> Distribution of cells according to the first two “diffusion components” (DC)</p></caption><graphic xlink:href="12859_2023_5563_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par74">The proliferation rate is a relevant indicator for distinguishing cell types in solid tumors and helps to identify cells with potential clinical relevance and interest as candidate therapeutic targets [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. Cell proliferation rate is quantified based on the expression of G1/S and G2/M genes:</p>
      <p id="Par75">
scML &lt;- proliferation_analysis(scMuffinList = scML).
</p>
      <p id="Par76">As a proof-of-concept we jointly analysed cell TC and cell proliferation of sample PJ016 and visualized the results on a diffusion map [<xref ref-type="bibr" rid="CR27">27</xref>]—which can be run by means of the wrapper function diff_map(). This joint analysis shows that cells with the highest values of TC-R tend to have lower proliferation scores (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d). These cells are located more closely to the branching point of the diffusion map (Fig. <xref rid="Fig6" ref-type="fig">6</xref>e), while the cells with the highest proliferation rates are located at a corner of one of the branches (Fig. <xref rid="Fig6" ref-type="fig">6</xref>f). This evidence suggests that the cells with high TC and low proliferation are interesting candidates for further analyses aimed at finding TICs in this dataset of HGG. Interestingly, this particular pattern is captured by TC-R, but not by TC-LMR and TC-H (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1).</p>
    </sec>
    <sec id="Sec15">
      <title>Comparison of datasets</title>
      <p id="Par77">A SC dataset carries an extensive amount of information. The integration of multiple SC datasets is a challenging task and multiple approaches have been proposed to address it [<xref ref-type="bibr" rid="CR28">28</xref>]. Typically, the integrated datasets are computationally demanding due to their huge size. An alternative possibility lies in cross-checking the expression of cluster markers between datasets: the expression of the cluster markers of every dataset is assessed in all considered datasets. For example, Nguyen et al. [<xref ref-type="bibr" rid="CR5">5</xref>] used this approach to study the occurrence of the characteristic cell types of normal mammary gland across samples collected from different subjects.</p>
      <p id="Par78">scMuffin provides a function to quantify the expression of a series of gene sets across multiple datasets:</p>
      <p id="Par79">
res &lt;- inter_dataset_comparison(seu_obj_list = seu_obj_list, gsl = cluster_markers_list)
</p>
      <p id="Par80">where seu_obj_list is a list of Seurat objects (each containing a SC dataset). If the gene sets are defined as cluster markers (“cluster_markers_list” in the code above), then the analysis sheds light over the possible presence of cells with similar expression profiles across datasets.</p>
      <p id="Par81">We performed this analysis on three datasets (PJ016, PJ017, PJ030) and found cell clusters that are more similar to clusters of other datasets than clusters of the same dataset, suggesting the presence of similar cells (Fig. <xref rid="Fig7" ref-type="fig">7</xref>a), like cluster 7 of PJ030 (“PJ030_C7”), which is close to clusters {0, 6, 8, 9} of PJ016. Importantly, the same analysis can be done using gene sets with a functional meaning, to obtain a functional characterization of similar cell types across datasets (Fig. <xref rid="Fig7" ref-type="fig">7</xref>b).<fig id="Fig7"><label>Fig. 7</label><caption><p>Inter-dataset comparison of gene set expression. <bold>a</bold> Heatmap of cluster marker (columns, “_Mx” suffix, where “x” indicates cluster number) expression scores across clusters (rows, “_Cx” suffix, where “x” indicates cluster number) of datasets PJ016, PJ017 and PJ030. <bold>b</bold> Heatmap of CancerSEA functional states scores across clusters of datasets as in panel (<bold>a</bold>)</p></caption><graphic xlink:href="12859_2023_5563_Fig7_HTML" id="MO7"/></fig></p>
    </sec>
    <sec id="Sec16">
      <title>scMuffin and scCancer</title>
      <p id="Par82">scCancer [<xref ref-type="bibr" rid="CR29">29</xref>] is an R package for automated processing of SC expression data in cancer. The two packages (scMuffin and scCancer) address the same challenge and are complementary. Indeed, each of them offers some analyses that the other does not (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). Examples of this are cluster association analysis (CSEA and ORA), comparison of multiple cell partitions and inter-dataset gene set expression assessment, available in scMuffin, and cell interaction, expression programs and cancer micro-environment cell classification, provided by scCancer. Other types of analyses are common to both packages but differ by the underlying algorithm and/or implementation. This is the case, for instance, of gene set scoring and CNV analysis.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Conclusions</title>
    <p id="Par83">Here, we presented scMuffin, an R package that provides a series of functions to perform and integrate various types of analyses on SC expression data. As a proof-of-concept, to illustrate the user interface and its potentialities, we analysed publicly available SC expression datasets of human HGG. We described two examples of integrative analyses which returned particularly interesting findings that would deserve further investigations: the functional characterization of CNVs highlighted a possible link between amplifications of chromosomes 1p and 19p and invasive tumor phenotype; the joint analysis of transcriptional complexity, proliferation rate and cell state trajectories spotted cells that have some characteristics of TICs. Despite the inference of CNV from SC expression data is a challenging task, subject to various issues (e.g., missing data, number of aberrancies), it provides useful insights to clarify cell identity, like the distinction between a more aberrant cluster and the others or the distinction of tumoral and normal cells. The functions of scMuffin can be combined conveniently to address various tasks. For example, different partitions of the same dataset obtained using the same clustering method with different parameters can be characterized by means of their overlap and gene set expression, to gain insights on the appropriate number of clusters. The analyses offered by scMuffin and the results achieved in the proof-of-concept show that scMuffin helps addressing the main challenges in the bioinformatics analysis of SC datasets from solid tumors.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec20">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5563_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1. </bold>Supplementary methods, Figure S1 and Table S1.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>CNV</term>
        <def>
          <p id="Par4">Copy number variation</p>
        </def>
      </def-item>
      <def-item>
        <term>CSC</term>
        <def>
          <p id="Par5">Cancer stem cells</p>
        </def>
      </def-item>
      <def-item>
        <term>CSEA</term>
        <def>
          <p id="Par6">Cell set enrichment analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>FDR</term>
        <def>
          <p id="Par7">False discovery rate</p>
        </def>
      </def-item>
      <def-item>
        <term>ER</term>
        <def>
          <p id="Par8">Enrichment ratio</p>
        </def>
      </def-item>
      <def-item>
        <term>GSEA</term>
        <def>
          <p id="Par9">Gene set enrichment analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>GTEx</term>
        <def>
          <p id="Par10">The Genotype-Tissue Expression project</p>
        </def>
      </def-item>
      <def-item>
        <term>HGG</term>
        <def>
          <p id="Par11">High grade glioma</p>
        </def>
      </def-item>
      <def-item>
        <term>NES</term>
        <def>
          <p id="Par12">Normalized enrichment score</p>
        </def>
      </def-item>
      <def-item>
        <term>ORA</term>
        <def>
          <p id="Par13">Over representation analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>SC</term>
        <def>
          <p id="Par14">Single cell</p>
        </def>
      </def-item>
      <def-item>
        <term>TC-R</term>
        <def>
          <p id="Par15">Transcriptional complexity ratio</p>
        </def>
      </def-item>
      <def-item>
        <term>TC-LMR</term>
        <def>
          <p id="Par16">Transcriptional complexity linear model residuals</p>
        </def>
      </def-item>
      <def-item>
        <term>TC-H</term>
        <def>
          <p id="Par17">Transcriptional complexity entropy</p>
        </def>
      </def-item>
      <def-item>
        <term>TICs</term>
        <def>
          <p id="Par18">Tumor initiating cells</p>
        </def>
      </def-item>
      <def-item>
        <term>UMAP</term>
        <def>
          <p id="Par19">Uniform manifold approximation and projection</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Paride Pelucchi and Ettore Mosca contributed equally to this work.</p>
    </fn>
  </fn-group>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>VN implemented the CNV functions, carried out the analyses, interpreted the results and wrote the article. AC implemented clustering functions, carried out the analyses, wrote the article, tested the package. NDN drafted the package, carried out the analyses and wrote the article. IC curated the biological aspects of CNV analysis and revised the article. MM and MG set up the computational infrastructure for data analysis. CC and EP curated the biological aspects of solid tumor data analysis. AS tested the package. RR, IZ, LM and AM contributed to the design of the study. PP contributed to the software design, case study definition, interpretation of the results and wrote the article. EM designed the study, implemented the software, performed the analysis, interpreted the results, and wrote the article. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded by the European Union “NextGenerationEU” and Italian Ministry of University and Research project “BBMRI.it” (Italian national node of BBMRI-ERIC, IR0000031), and by the Italian Ministry of University and Research PON Project “CNRBIOMICS” (PIR01_00017). The funding bodies played no role in the design of the study and collection, analysis, and interpretation of data and in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The data used for the analyses described in this manuscript were obtained from: The Gene Expression Omnibus [<xref ref-type="bibr" rid="CR11">11</xref>], under the accession GSE103224; the GTEx Portal [<xref ref-type="bibr" rid="CR17">17</xref>] on 04/08/2020. Project name: scMuffin. Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/emosca-cnr/scMuffin">https://github.com/emosca-cnr/scMuffin</ext-link>. Operating system: Platform independent. Programming language: R (≥ 4.0.0). Other requirements: The R Project for Statistical Computing. License: GPL-3. Any restrictions to use by non-academics: According to GPL-3.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par84">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par85">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par86">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baslan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hicks</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Unravelling biology and shifting paradigms in cancer with single-cell sequencing</article-title>
        <source>Nat Rev Cancer</source>
        <year>2017</year>
        <volume>17</volume>
        <issue>9</issue>
        <fpage>557</fpage>
        <lpage>569</lpage>
        <pub-id pub-id-type="doi">10.1038/nrc.2017.58</pub-id>
        <?supplied-pmid 28835719?>
        <pub-id pub-id-type="pmid">28835719</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zappia</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Over 1000 tools reveal trends in the single-cell RNA-seq analysis landscape</article-title>
        <source>Genome Biol</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>1</issue>
        <fpage>301</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-021-02519-4</pub-id>
        <?supplied-pmid 34715899?>
        <pub-id pub-id-type="pmid">34715899</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Andersen-Nissen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mauck</surname>
            <given-names>WM</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated analysis of multimodal single-cell data</article-title>
        <source>Cell.</source>
        <year>2021</year>
        <volume>184</volume>
        <issue>13</issue>
        <fpage>3573</fpage>
        <lpage>3587</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id>
        <?supplied-pmid 34062119?>
        <pub-id pub-id-type="pmid">34062119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Izar</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prakadan</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wadsworth</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Treacy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title>
        <source>Science (1979)</source>
        <year>2016</year>
        <volume>352</volume>
        <issue>6282</issue>
        <fpage>189</fpage>
        <lpage>196</lpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nguyen</surname>
            <given-names>QH</given-names>
          </name>
          <name>
            <surname>Pervolarakis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RT</given-names>
          </name>
          <name>
            <surname>James</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Profiling human breast epithelial cells using single cell RNA sequencing identifies cell diversity</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>2028</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-04334-1</pub-id>
        <?supplied-pmid 29795293?>
        <pub-id pub-id-type="pmid">29795293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Patel</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Tirosh</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Gillespie</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wakimoto</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>
        <source>Science</source>
        <year>2014</year>
        <volume>344</volume>
        <issue>6190</issue>
        <fpage>1396</fpage>
        <lpage>1401</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1254257</pub-id>
        <?supplied-pmid 24925914?>
        <pub-id pub-id-type="pmid">24925914</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gandrillon</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Gaillard</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Espinasse</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Garnier</surname>
            <given-names>NB</given-names>
          </name>
          <name>
            <surname>Dussiau</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kosmider</surname>
            <given-names>O</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Entropy as a measure of variability and stemness in single-cell transcriptomics</article-title>
        <source>Curr Opin Syst Biol.</source>
        <year>2021</year>
        <volume>27</volume>
        <fpage>100348</fpage>
        <pub-id pub-id-type="doi">10.1016/j.coisb.2021.05.009</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2005</year>
        <volume>102</volume>
        <issue>43</issue>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
        <?supplied-pmid 16199517?>
        <pub-id pub-id-type="pmid">16199517</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khatri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sirota</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Butte</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Ten years of pathway analysis: current approaches and outstanding challenges. Ouzounis CA. editor</article-title>
        <source>PLoS Comput Biol.</source>
        <year>2012</year>
        <volume>8</volume>
        <issue>2</issue>
        <fpage>e1002375</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002375</pub-id>
        <?supplied-pmid 22383865?>
        <pub-id pub-id-type="pmid">22383865</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Levitin</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Frattini</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bush</surname>
            <given-names>EC</given-names>
          </name>
          <name>
            <surname>Boyett</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Samanamud</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome analysis of lineage diversity in high-grade glioma</article-title>
        <source>Genome Med</source>
        <year>2018</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>57</fpage>
        <pub-id pub-id-type="doi">10.1186/s13073-018-0567-9</pub-id>
        <?supplied-pmid 30041684?>
        <pub-id pub-id-type="pmid">30041684</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barrett</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wilhite</surname>
            <given-names>SE</given-names>
          </name>
          <name>
            <surname>Ledoux</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Evangelista</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>IF</given-names>
          </name>
          <name>
            <surname>Tomashevsky</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>NCBI GEO: archive for functional genomics data sets—update</article-title>
        <source>Nucleic Acids Res</source>
        <year>2012</year>
        <volume>41</volume>
        <issue>D1</issue>
        <fpage>D991</fpage>
        <lpage>D995</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1193</pub-id>
        <?supplied-pmid 23193258?>
        <pub-id pub-id-type="pmid">23193258</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Quan</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell marker: a manually curated resource of cell markers in human and mouse</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D721</fpage>
        <lpage>D728</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky900</pub-id>
        <?supplied-pmid 30289549?>
        <pub-id pub-id-type="pmid">30289549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Franzén</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Gan</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Björkegren</surname>
            <given-names>JLM</given-names>
          </name>
        </person-group>
        <article-title>PanglaoDB: a web server for exploration of mouse and human single-cell RNA sequencing data</article-title>
        <source>Database</source>
        <year>2019</year>
        <volume>1</volume>
        <fpage>2019</fpage>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liao</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CancerSEA: a cancer single-cell state atlas</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D900</fpage>
        <lpage>D908</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky939</pub-id>
        <?supplied-pmid 30329142?>
        <pub-id pub-id-type="pmid">30329142</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Clarke</surname>
            <given-names>ZA</given-names>
          </name>
          <name>
            <surname>Andrews</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Atif</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pouyabahar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Innes</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>MacParland</surname>
            <given-names>SA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tutorial: guidelines for annotating single-cell transcriptomic maps using automated and manual methods</article-title>
        <source>Nat Protoc</source>
        <year>2021</year>
        <volume>16</volume>
        <issue>6</issue>
        <fpage>2749</fpage>
        <lpage>2764</lpage>
        <pub-id pub-id-type="doi">10.1038/s41596-021-00534-0</pub-id>
        <?supplied-pmid 34031612?>
        <pub-id pub-id-type="pmid">34031612</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Eils</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Schlesner</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Complex heatmaps reveal patterns and correlations in multidimensional genomic data</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>18</issue>
        <fpage>2847</fpage>
        <lpage>2849</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw313</pub-id>
        <?supplied-pmid 27207943?>
        <pub-id pub-id-type="pmid">27207943</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">GTEx Consortium. The genotype-tissue expression (GTEx) project.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gupta</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Polisetty</surname>
            <given-names>RV</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ganesh</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Gowda</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Purohit</surname>
            <given-names>AK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Altered transcriptional regulatory proteins in glioblastoma and YBX1 as a potential regulator of tumor invasion</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>10986</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-019-47360-9</pub-id>
        <?supplied-pmid 31358880?>
        <pub-id pub-id-type="pmid">31358880</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>LeFave</surname>
            <given-names>CV</given-names>
          </name>
          <name>
            <surname>Squatrito</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Vorlova</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Rocco</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Brennan</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Holland</surname>
            <given-names>EC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Splicing factor hnRNPH drives an oncogenic splicing switch in gliomas</article-title>
        <source>EMBO J</source>
        <year>2011</year>
        <volume>30</volume>
        <issue>19</issue>
        <fpage>4084</fpage>
        <lpage>4097</lpage>
        <pub-id pub-id-type="doi">10.1038/emboj.2011.259</pub-id>
        <?supplied-pmid 21915099?>
        <pub-id pub-id-type="pmid">21915099</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Golan-Gerstl</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shilo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Suh</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Bakàcs</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Coppola</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Splicing factor hnRNP A2/B1 regulates tumor suppressor gene splicing and is an oncogenic driver in glioblastoma</article-title>
        <source>Cancer Res</source>
        <year>2011</year>
        <volume>71</volume>
        <issue>13</issue>
        <fpage>4464</fpage>
        <lpage>4472</lpage>
        <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-10-4410</pub-id>
        <?supplied-pmid 21586613?>
        <pub-id pub-id-type="pmid">21586613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Jeong</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Vukadin</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Stone</surname>
            <given-names>JK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SON drives oncogenic RNA splicing in glioblastoma by regulating PTBP1/PTBP2 switching and RBFOX2 activity</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>5551</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-25892-x</pub-id>
        <?supplied-pmid 34548489?>
        <pub-id pub-id-type="pmid">34548489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wainwright</surname>
            <given-names>EN</given-names>
          </name>
          <name>
            <surname>Scaffidi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Epigenetics and cancer stem cells: unleashing, hijacking, and restricting cellular plasticity</article-title>
        <source>Trends Cancer</source>
        <year>2017</year>
        <volume>3</volume>
        <issue>5</issue>
        <fpage>372</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trecan.2017.04.004</pub-id>
        <?supplied-pmid 28718414?>
        <pub-id pub-id-type="pmid">28718414</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gaspar-Maia</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Alajem</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Meshorer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ramalho-Santos</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Open chromatin in pluripotency and reprogramming</article-title>
        <source>Nat Rev Mol Cell Biol</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>36</fpage>
        <lpage>47</lpage>
        <pub-id pub-id-type="doi">10.1038/nrm3036</pub-id>
        <?supplied-pmid 21179060?>
        <pub-id pub-id-type="pmid">21179060</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guilhamon</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Chesnelong</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Kushida</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Nikolic</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Singhal</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>MacLeod</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell chromatin accessibility profiling of glioblastoma identifies an invasive cancer stem cell population associated with lower survival</article-title>
        <source>Elife</source>
        <year>2021</year>
        <volume>11</volume>
        <fpage>10</fpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feitelson</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Arzumanyan</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kulathinal</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Blain</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Holcombe</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Mahajna</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sustained proliferation in cancer: Mechanisms and novel therapeutic targets</article-title>
        <source>Semin Cancer Biol</source>
        <year>2015</year>
        <volume>35</volume>
        <fpage>S25</fpage>
        <lpage>54</lpage>
        <pub-id pub-id-type="doi">10.1016/j.semcancer.2015.02.006</pub-id>
        <?supplied-pmid 25892662?>
        <pub-id pub-id-type="pmid">25892662</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Al-Hajj</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>MF</given-names>
          </name>
        </person-group>
        <article-title>Self-renewal and solid tumor stem cells</article-title>
        <source>Oncogene</source>
        <year>2004</year>
        <volume>23</volume>
        <issue>43</issue>
        <fpage>7274</fpage>
        <lpage>7282</lpage>
        <pub-id pub-id-type="doi">10.1038/sj.onc.1207947</pub-id>
        <?supplied-pmid 15378087?>
        <pub-id pub-id-type="pmid">15378087</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Haghverdi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Büttner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
          <name>
            <surname>Marr</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Destiny: diffusion maps for large-scale single-cell data in R</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>8</issue>
        <fpage>1241</fpage>
        <lpage>1243</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv715</pub-id>
        <?supplied-pmid 26668002?>
        <pub-id pub-id-type="pmid">26668002</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Forcato</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Romano</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Bicciato</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Computational methods for the integrative analysis of single-cell data</article-title>
        <source>Brief Bioinform.</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>3</issue>
        <fpage>bbaa042</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbaa042</pub-id>
        <?supplied-pmid 32363378?>
        <pub-id pub-id-type="pmid">32363378</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shan</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>scCancer: a package for automated processing of single-cell RNA-seq data in cancer</article-title>
        <source>Brief Bioinform.</source>
        <year>2021</year>
        <volume>22</volume>
        <issue>3</issue>
        <fpage>bbaa127</fpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbaa127</pub-id>
        <?supplied-pmid 34020534?>
        <pub-id pub-id-type="pmid">34020534</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
