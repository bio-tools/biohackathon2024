<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9825741</article-id>
    <article-id pub-id-type="pmid">36484701</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac792</article-id>
    <article-id pub-id-type="publisher-id">btac792</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Synggen: fast and data-driven generation of synthetic heterogeneous NGS cancer data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1640-5307</contrib-id>
        <name>
          <surname>Scandino</surname>
          <given-names>Riccardo</given-names>
        </name>
        <aff><institution>Department of Cellular, Computational and Integrative Biology (CIBIO), University of Trento</institution>, Trento 38123, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Calabrese</surname>
          <given-names>Federico</given-names>
        </name>
        <aff><institution>Department of Cellular, Computational and Integrative Biology (CIBIO), University of Trento</institution>, Trento 38123, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4855-8620</contrib-id>
        <name>
          <surname>Romanel</surname>
          <given-names>Alessandro</given-names>
        </name>
        <xref rid="btac792-cor1" ref-type="corresp"/>
        <!--alessandro.romanel@unitn.it-->
        <aff><institution>Department of Cellular, Computational and Integrative Biology (CIBIO), University of Trento</institution>, Trento 38123, <country country="IT">Italy</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alkan</surname>
          <given-names>Can</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac792-cor1">To whom correspondence should be addressed. <email>alessandro.romanel@unitn.it</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-12-09">
      <day>09</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>09</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac792</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>06</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>08</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>16</day>
        <month>12</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac792.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Whole-exome and targeted sequencing are widely utilized both in translational cancer genomics and in the setting of precision medicine. The benchmarking of computational methods and tools that are in continuous development is fundamental for the correct interpretation of somatic genomic profiling results. To this aim we developed synggen, a tool for the fast generation of large-scale realistic and heterogeneous cancer whole-exome and targeted sequencing synthetic datasets, which enables the incorporation of phased germline single nucleotide polymorphisms and complex allele-specific somatic genomic events. Synggen performances and effectiveness in generating synthetic cancer data are shown across different scenarios and considering different platforms with distinct characteristics.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>synggen is freely available at <ext-link xlink:href="https://bitbucket.org/CibioBCG/synggen/" ext-link-type="uri">https://bitbucket.org/CibioBCG/synggen/</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The interrogation of next-generation sequencing (NGS), principally whole-exome (WES) and targeted sequencing (TS), is rapidly becoming a preferred approach for the exploration of large tissue and liquid biopsy-based cohorts, especially in the context of precision medicine. In this setting, a precise benchmarking of the large collection of computational tools that are continuously developed is fundamental for the correct interpretation of somatic genomic profiling results. Although many simulators of synthetic cancer genomes and NGS data have been developed in the last years (<xref rid="btac792-B3" ref-type="bibr">Peng <italic toggle="yes">et al.</italic>, 2019</xref>), only a few of them focus on WES and TS data and most of them either require the generation and merge of intermediate large FASTA files (<xref rid="btac792-B7" ref-type="bibr">Tanner <italic toggle="yes">et al.</italic>, 2019</xref>), incorporate random genomic events (<xref rid="btac792-B5" ref-type="bibr">Semeraro <italic toggle="yes">et al.</italic>, 2018</xref>) or do not allow to incorporate complex somatic cancer-specific patterns (<xref rid="btac792-B6" ref-type="bibr">Stephens <italic toggle="yes">et al.</italic>, 2016</xref>). The generation of large-scale benchmarking datasets that are able to capture cancer-specific heterogeneous scenarios together with NGS platform-specific characteristics is hence still hindered, limiting the broad applicability of synthetic NGS-based computational tool benchmarking. To overcome these limitations, we developed synggen, a tool that enables a fast and scalable generation of platform-specific cancer and matched control WES and TS synthetic data, incorporating phased germline polymorphisms together with complex and allele-specific cancer genomic events.</p>
  </sec>
  <sec>
    <title>2 Approach</title>
    <p>Synggen is a tool written in C programming language to generate synthetic NGS files, in the form of WES or TS experiments, representing heterogeneous cancer genomes and matched controls. The tool provides two execution modes which allow to (i) exploit a set of control (non-cancer) NGS sequencing files (BAM format) to generate three <italic toggle="yes">reference models</italic> capturing a collection of data summary statistics; and (ii) combine these reference models and a set of user-specified germline and somatic genomic profiles to create synthetic sequencing files (FASTQ format).</p>
    <p>Reference models are built across a single or a collection of WES or TS sequencing control samples, profiled with the same platform, using a fast and efficient multi-threaded cumulative pileup strategy based on (<xref rid="btac792-B8" ref-type="bibr">Valentini <italic toggle="yes">et al.</italic>, 2019</xref>). Specifically, synggen generates: (i) a <italic toggle="yes">Read Depth Model</italic> (<italic toggle="yes">RDM</italic>), which measures the average intra-sample depth of coverage variability by calculating the probability, across all input files, of observing sequencing reads at any captured genomic region and position; only reads aligning at the lowest genomic coordinate are considered when paired-end data is used; (ii) a <italic toggle="yes">Quality Model</italic> (<italic toggle="yes">QM</italic>), which measures the distribution of base qualities across sequencing read positions; (iii) <italic toggle="yes">Position-Based Error</italic> (<italic toggle="yes">PBE</italic>), which measures for each captured genomic position [not representing a common single nucleotide polymorphism (SNP)] the probability of observing platform-specific systematic errors supported by high quality reads and bases (<xref rid="btac792-B1" ref-type="bibr">Casiraghi <italic toggle="yes">et al.</italic>, 2020</xref>). When paired-end data are used to generate the reference models, insert size statistics are also computed and embedded in the RDM model.</p>
    <p>Exploiting the created reference models, synggen allows to directly generate platform-specific cancer and matched control NGS files by incorporating in the simulated genomes a user-specified list of germline-phased SNPs and user-specified lists of somatic <italic toggle="yes">allele-specific</italic> copy number alterations (CNAs) and point mutations (PMs). Phased SNPs are used to realistically represent the genetic background of specific individuals and to generate both cancer and matched control samples. Somatic CNAs are defined as allele-specific copy numbers (pairs of values specifying the number of copies for each allele) and are incorporated across all affected WES/TS captured regions to modulate the RDM distribution and to adjust SNP allelic fractions. Of note, both overlapping and nested somatic copy number alterations can be represented (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref> for details). Point mutations are incorporated by specifying the affected allele and indicating the number of allele copies (in case copy number alterations are present) carrying the specific point mutation. When generating cancer genomes NGS files, CNAs and PMs are defined specifying also alteration-specific clonality values, which are used to adjust the fraction at which they are incorporated in the data. A global tumor content value is also specified by the user to adjust the fraction at which all somatic events are incorporated. Provided all these information, synggen uses an efficient multi-threaded approach to generate a specified number of synthetic sequencing reads implementing for each of them the following steps: (i) sample a genomic region and position from the RDM distribution; (ii) Generate the corresponding read sequence provided a specific read length; (iii) randomly choose one of the two alleles, sampling from a probability distribution that reflects the number of region allele-specific copies; (iv) incorporate all SNPs spanning the read (if any); (v) Generate base qualities and errors sampling first from the PBE (for all positions there annotated) and then from the QM for all the remaining read bases; (vi) In case of cancer samples, incorporate PMs if any; and (vii) Choose the strand considering the strand bias (default 0.5). When paired-end data is considered, two reads are generated in Step 2 using an insert size sampled from a normal distribution with mean and standard deviation as specified in the RDM model; Steps from 3 to 7 are executed for both reads. Details are available in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We developed synggen to allow efficient and scalable generation of cancer and matched control targeted NGS synthetic data. Compared to previous methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>), synggen is the only simulator providing built-in generation of platform-specific WES- or TS-based NGS reads, reproducing hence sequencing characteristics of real data and incorporating germline and somatic variants without the need of intermediate FASTA files. Differently from most available simulators, synggen allows to input specific lists of germline variants and somatic genomic events, including phased germline SNPs and somatic allele-specific CNAs and PMs, together with local and global parameters including the clonality of somatic events and the overall sample tumor content, allowing for the emulation of varied and realistic cancer- and patient-specific data across the different multi-subclones composition, tumor purity, aneuploidy and tumor evolution scenarios. Our approach allows hence for the generation of large-scale bulk WES and TS datasets, including multi-regional and longitudinal tissue sequencing datasets and liquid biopsy cfDNA sequencing datasets.</p>
    <p>To test the performances of synggen, we generated synthetic WES and TS samples and measured the computational time required for reference models’ construction and sequencing reads generation. The construction of reference models was tested for an increasing number of input samples selected among breast cancer control (non-tumor) samples (BAM files) available from The Cancer Genome Atlas dataset, focusing on patients having high (&gt;80%) tumor content WES (Sure Select All Exome v3) cancer tissue samples. Generation of synthetic NGS cancer data was instead tested for increasing number of sequencing reads produced. A cancer sample was generated with tumor content at 80% and incorporating patient-specific germline SNPs and patient-specific somatic CNAs and PMs (details in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). The overall reference models’ construction time using one input sample on a HPE Proliant DL560 server and exploiting 16 cores took approximately 2.5 min for the WES sample and 1 second for the TS sample (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). Using the same running configuration, 56 s and 1 min were instead required to generate a FASTQ file representing, respectively, a cancer WES sample with 100x average coverage (∼36 million reads) and a cancer TS sample with 1000× average coverage (∼57 million reads) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). Overall, results show that reference models’ creation and FASTQ files generation scales well with the number of threads used (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1 and S2</xref>). In addition, complex and patient’s specific combinations of somatic events were generated (<xref rid="btac792-F1" ref-type="fig">Fig. 1</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3 and S4</xref>) keeping genomic characteristics like depth of coverage distributions and error rates consistent with the original WES sample (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S5 and S6</xref>).</p>
    <fig position="float" id="btac792-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Examples of somatic allele-specific CNAs. (Top) log2(tumor/control) of regions’ average depth of coverage. (Bottom) allelic fraction (AF) of heterozygous SNPs in tumor and matched control synthetic samples. TC, tumor content</p>
      </caption>
      <graphic xlink:href="btac792f1" position="float"/>
    </fig>
    <p>To demonstrate the effectiveness of synggen in generating benchmarking datasets, we simulated two liquid biopsy cfDNA scenarios considering data produced in <xref rid="btac792-B4" ref-type="bibr">Qvick <italic toggle="yes">et al.</italic> (2021)</xref> and <xref rid="btac792-B2" ref-type="bibr">Kaisaki <italic toggle="yes">et al.</italic> (2016)</xref>. In those studies, different commercial TS panels that exploit different technologies were used. Considering genomic regions covered by both panels, we first generated synthetic NGS cancer data at decreasing tumor content, simulating a patient with both clonal and sub-clonal somatic copy number alterations and point mutations. Then, we generated synthetic NGS cancer data simulating a temporal sampling from a patient with regressing and emerging independent cancer sub-clones, at fixed tumor content. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figures S7 and S8</xref> demonstrate that log2 ratios of incorporated somatic copy number alterations and allelic fractions of incorporated somatic point mutations are well represented in both simulated scenarios and across all generated cancer samples’ data but also demonstrate that the generated data consistently preserve the different and platform-specific genomic characteristics of the two considered TS panels. See <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref> for additional details.</p>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>We developed synggen to perform fast and scalable generation of cancer and matched control WES and TS synthetic data without the need for intermediate FASTA files generation and exploiting multi-threaded computation. Synggen allows to emulate platform-specific NGS data characteristics and allows to incorporate germline-phased SNPs and complex somatic allele-specific copy number alterations and point mutations. In addition, it allows to create clonal and sub-clonal events across different tumor content scenarios enabling the generation of large-scale complex benchmarking datasets. Synggen is easy to use and is provided with a collection of additional scripts to simplify further its usability.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac792_Supplementary_Data</label>
      <media xlink:href="btac792_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data supporting the results of this article are available at <ext-link xlink:href="https://bcglab.cibio.unitn.it/synggen_data" ext-link-type="uri">https://bcglab.cibio.unitn.it/synggen_data</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac792-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Casiraghi</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>ABEMUS: platform-specific and data-informed detection of somatic SNVs in cfDNA</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>2665</fpage>–<lpage>2674</lpage>.<pub-id pub-id-type="pmid">31922552</pub-id></mixed-citation>
    </ref>
    <ref id="btac792-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kaisaki</surname><given-names>P.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Targeted next-generation sequencing of plasma DNA from cancer patients: factors influencing consistency with tumour DNA and prospective investigation of its utility for diagnosis</article-title>. <source>PLoS One</source>, <volume>11</volume>, <fpage>e0162809</fpage>.<pub-id pub-id-type="pmid">27626278</pub-id></mixed-citation>
    </ref>
    <ref id="btac792-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peng</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Genetic simulation resources and the GSR certification program</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>709</fpage>–<lpage>710</lpage>.<pub-id pub-id-type="pmid">30101297</pub-id></mixed-citation>
    </ref>
    <ref id="btac792-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qvick</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Liquid biopsy as an option for predictive testing and prognosis in patients with lung cancer</article-title>. <source>Mol. Med</source>., <volume>27</volume>, <fpage>68</fpage>.<pub-id pub-id-type="pmid">34217228</pub-id></mixed-citation>
    </ref>
    <ref id="btac792-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Semeraro</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Xome-Blender: a novel cancer genome simulator</article-title>. <source>PLoS One</source>, <volume>13</volume>, <fpage>e0194472</fpage>.<pub-id pub-id-type="pmid">29621252</pub-id></mixed-citation>
    </ref>
    <ref id="btac792-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stephens</surname><given-names>Z.D.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Simulating next-generation sequencing datasets from empirical mutation and sequencing models</article-title>. <source>PLoS One</source>, <volume>11</volume>, <fpage>e0167047</fpage>.<pub-id pub-id-type="pmid">27893777</pub-id></mixed-citation>
    </ref>
    <ref id="btac792-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tanner</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Simulation of heterogeneous tumour genomes with HeteroGenesis and in silico whole exome sequencing</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>2850</fpage>–<lpage>2852</lpage>.<pub-id pub-id-type="pmid">30615054</pub-id></mixed-citation>
    </ref>
    <ref id="btac792-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Valentini</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>PaCBAM: fast and scalable processing of whole exome and targeted sequencing data</article-title>. <source>BMC Genomics</source>, <volume>20</volume>, <fpage>1018</fpage>.<pub-id pub-id-type="pmid">31878881</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
