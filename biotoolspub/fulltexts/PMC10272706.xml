<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10272706</article-id>
    <article-id pub-id-type="pmid">37279738</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad365</article-id>
    <article-id pub-id-type="publisher-id">btad365</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AIRRSHIP: simulating human B cell receptor repertoire sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5862-4014</contrib-id>
        <name>
          <surname>Sutherland</surname>
          <given-names>Catherine</given-names>
        </name>
        <aff><institution>Institute of Immunology and Infection Research, School of Biological Sciences, University of Edinburgh</institution>, Edinburgh, EH9 3FL, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1949-4253</contrib-id>
        <name>
          <surname>Cowan</surname>
          <given-names>Graeme J M</given-names>
        </name>
        <aff><institution>Institute of Immunology and Infection Research, School of Biological Sciences, University of Edinburgh</institution>, Edinburgh, EH9 3FL, <country country="GB">United Kingdom</country></aff>
        <xref rid="btad365-cor1" ref-type="corresp"/>
        <!--graeme.cowan@ed.ac.uk-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alkan</surname>
          <given-names>Can</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad365-cor1">Corresponding author. Institute of Immunology and Infection Research, School of Biological Sciences, University of Edinburgh, Ashworth Laboratories, Charlotte Auerbach Rd, Edinburgh, EH9 3FL, United Kingdom. E-mail: <email>graeme.cowan@ed.ac.uk</email> (G.J.M.C.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-06-05">
      <day>05</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>6</issue>
    <elocation-id>btad365</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>05</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>27</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>02</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>15</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad365.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Adaptive Immune Receptor Repertoire Sequencing is a rapidly developing field that has advanced understanding of the role of the adaptive immune system in health and disease. Numerous tools have been developed to analyse the complex data produced by this technique but work to compare their accuracy and reliability has been limited. Thorough, systematic assessment of their performance is dependent on the ability to produce high quality simulated datasets with known ground truth. We have developed AIRRSHIP, a flexible and fast Python package that produces synthetic human B cell receptor sequences. AIRRSHIP uses a comprehensive set of reference data to replicate key mechanisms in the immunoglobulin recombination process, with a particular focus on junctional complexity. Repertoires generated by AIRRSHIP are highly similar to published data and all steps in the sequence generation process are recorded. These data can be used to not only determine the accuracy of repertoire analysis tools but can also, by tuning of the large number of user-controllable parameters, give insight into factors that contribute to inaccuracies in results.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>AIRRSHIP is implemented in Python. It is available via <ext-link xlink:href="https://github.com/Cowanlab/airrship" ext-link-type="uri">https://github.com/Cowanlab/airrship</ext-link> and on PyPI at <ext-link xlink:href="https://pypi.org/project/airrship/" ext-link-type="uri">https://pypi.org/project/airrship/</ext-link>. Documentation can be found at <ext-link xlink:href="https://airrship.readthedocs.io/" ext-link-type="uri">https://airrship.readthedocs.io/</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>220096/Z/20/Z</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Adaptive Immune Receptor Repertoire Sequencing (AIRR-seq) uses high throughput sequencing to characterize the state and dynamics of B cell receptor (BCR) repertoires and is of increasing use in understanding the molecular basis of immunity and autoimmunity (<xref rid="btad365-B14" ref-type="bibr">Yaari and Kleinstein 2015</xref>, <xref rid="btad365-B20" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2022</xref>). BCR repertoire data comprises sequences of the variable regions of BCRs, which are rearranged and hypermutated during B cell maturation. Key to interpretation of this data is the determination of parental VDJ segments for each receptor, as well as identification of nucleotide insertions and deletions, positions of segment junctions, and sequence mutations. Numerous tools have been developed to enable these analyses, with the most commonly used being IgBLAST, IMGT/HighV-QUEST and MiXCR (<xref rid="btad365-B2" ref-type="bibr">Brochet et al. 2008</xref>, <xref rid="btad365-B18" ref-type="bibr">Ye <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad365-B1" ref-type="bibr">Bolotin <italic toggle="yes">et al.</italic> 2015</xref>). Benchmarking of such tools has been limited but work published to date indicates that their outputs can differ, potentially impacting the conclusions drawn from repertoire sequencing experiments (<xref rid="btad365-B11" ref-type="bibr">Smakaj <italic toggle="yes">et al.</italic> 2020</xref>).</p>
    <p>The ability to assess the absolute accuracy of antibody repertoire analysis tools is limited by the lack of experimental datasets where details of all recombination processes are known. Simulation of rearranged BCR data offers an alternative solution for benchmarking where this ground-truth is recorded. Several methods for simulating BCR data have been published (<xref rid="btad365-B10" ref-type="bibr">Safonova <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad365-B9" ref-type="bibr">Ralph and Matsen 2016</xref>, <xref rid="btad365-B19" ref-type="bibr">Yermanos <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad365-B7" ref-type="bibr">Marcou <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad365-B13" ref-type="bibr">Weber <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad365-B17" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2021b</xref>; <xref rid="btad365-B5" ref-type="bibr">Han <italic toggle="yes">et al.</italic> 2022</xref>). However, the usefulness of these tools for benchmarking studies can be limited by their requirements for complex dependencies, nonstandard output file formats, and/or generation of repertoires that are dissimilar to real experimental data. Therefore, we introduce AIRRSHIP (Adaptive Immune Receptor Repertoire Simulation of Human Immunoglobulin Production), a tool for simulating human BCR sequences, which accurately replicates features of experimental data whilst being fast, flexible, and easy to use.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>AIRRSHIP is implemented in Python and has no additional dependencies beyond the standard library. It replicates the processes by which immunoglobulin sequences are formed in vivo (<xref rid="btad365-F1" ref-type="fig">Fig. 1</xref>, full details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>), with each step informed by comprehensive built-in reference data from experimental datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1</xref> and<xref rid="sup1" ref-type="supplementary-material"> S2</xref>). To begin, VDJ segments are selected from simulated immunoglobin loci according to observed patterns of usage and an initial recombined sequence is generated. Trimming of segment ends then occurs, with the number of nucleotides to be removed sampled from distributions of trimming lengths for the corresponding IMGT gene family. Following this, NP nucleotides are inserted at the VD and DJ junctions. Insertion lengths are chosen from experimental distributions and addition of nucleotides occurs according to a position dependent Markov process. Separate transition matrices are used when simulating nonmutated and mutated sequences to compensate for the inability to determine which inserted positions have been hypermutated.</p>
    <fig position="float" id="btad365-F1">
      <label>Figure 1</label>
      <caption>
        <p>AIRRSHIP simulates human heavy chain BCR sequences, informed by experimental data at each step of the synthetic recombination process. Key parameters such as VDJ usage, gene trimming, junctional insertions and somatic hypermutation can all be modified by the user. Sequences in the FASTA file output can then be used as input for tools of interest and results easily compared to the tab separated values (TSV) file which acts as a record of the recombination process for each sequence.</p>
      </caption>
      <graphic xlink:href="btad365f1" position="float"/>
    </fig>
    <p>Somatic hypermutation is replicated at both the per sequence and per position level. For each sequence, the overall mutation frequency is chosen from a distribution and the required number of mutations are introduced. The likelihood of mutation at each nucleotide is determined by considering the five base sequence motif and immunoglobulin sequence region in which it sits. All reference distributions and models used by AIRRSHIP vary at the IMGT gene, family or sequence region level and thus should be robust to novel allele discovery (<xref rid="btad365-B6" ref-type="bibr">Lefranc 2007</xref>, <xref rid="btad365-B4" ref-type="bibr">Gadala-Maria <italic toggle="yes">et al.</italic> 2015</xref>).</p>
    <p>To create repertoires tailored to specific benchmarking scenarios, the user can control patterns of VDJ usage, insertions, and deletions, as well as the rate and distribution of somatic hypermutation. Scripts are also provided to allow users to simulate from their own reference data. AIRRSHIP output is optimized for benchmarking, consisting of a FASTA file of sequences which can be used directly as input for tools of interest, as well as a TSV file, which closely follows the AIRR Standards rearrangement schema (<xref rid="btad365-B12" ref-type="bibr">Vander Heiden <italic toggle="yes">et al.</italic> 2018</xref>) and facilitates easy reference to known sequence origins.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We assessed the resemblance to real data of sequences generated by AIRRSHIP and three other simulation tools: partis, immuneSIM, and IMPlAntS (<xref rid="btad365-B9" ref-type="bibr">Ralph and Matsen 2016</xref>, <xref rid="btad365-B13" ref-type="bibr">Weber <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad365-B17" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2021b</xref>). Key summary statistics from these repertoires were compared to those from published BCR data using sumrep, an R package for comparison and summaries of repertoire data (<xref rid="btad365-B8" ref-type="bibr">Olson <italic toggle="yes">et al.</italic> 2019</xref>). To prevent favourable bias, experimental data were selected from studies not used for AIRRSHIP input reference (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>).</p>
    <p>Comparison between nonmutated simulated repertoires and IgD/IgM experimental sequences revealed similarly high levels of performance between AIRRSHIP, IMPlAntS, and immuneSIM for VDJ usage frequency. Substantial deviation from experimental data in repertoires generated using partis was observed (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). Clustering of sequences by usage of VJ gene combinations also indicated that both AIRRSHIP and IMPlAntS produce patterns of recombination that more closely resemble experimental data than immuneSIM or partis (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). Divergences between real sequences and the AIRRSHIP and IMPlAntS repertoires were similar for lengths of nucleotide deletions and insertions at the junctions, whilst sequences from partis and immuneSIM differed more (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). The composition of nucleotides inserted at junctions in AIRRSHIP sequences was found to be more similar to experimental data than the insertions produced by any of the other tools. AIRRSHIP uses a Markov process with transition matrices established from human datasets to choose which nucleotide to add at each position of the insertion. In contrast, inserted nucleotides are chosen randomly by IMPlAntS, and immuneSIM selects from NP region and trimming combinations observed from mouse data. The more detailed model used by AIRRSHIP may explain the more realistic insertions produced.</p>
    <p>AIRRSHIP repertoires also most closely resembled experimental data in amino acid usage, GRAVY score, aliphatic index, and Atchley factor scores; all of which are important measures of sequence composition. These metrics are measured across the junction region and are representative of the realistic combinations of insertions, deletions, and VDJ gene usage generated by AIRRSHIP. Similar patterns were observed across metrics when comparing simulated repertoires with mutation to experimental IgA/IgG sequences (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>).</p>
    <p>During affinity maturation, mutations are introduced unevenly across BCR sequences. Therefore, we compared the ability of the simulation tools to produce realistic mutation patterns (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). Mutation rates per nucleotide position in the sequence were very closely correlated between AIRRSHIP and experimental sequences (<italic toggle="yes">r</italic> = 0.97). This was comparable to the relationship shown with IMPlAntS repertoires (<italic toggle="yes">r</italic> = 0.95), and stronger than that achieved by partis (<italic toggle="yes">r</italic> = 0.29) and immuneSIM (<italic toggle="yes">r</italic> = 0.27). Mutability models were also inferred using SHazaM (<xref rid="btad365-B15" ref-type="bibr">Yaari <italic toggle="yes">et al.</italic> 2013</xref>). As with per position mutation rate, IMPlAntS and AIRRSHIP closely replicate experimental patterns, with hotspot and coldspot motifs showing higher and lower mutability, respectively (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S5</xref> and <xref rid="sup1" ref-type="supplementary-material">S6</xref>).</p>
    <p>Finally, repertoire sequencing datasets may now consist of hundreds of thousands, if not millions, of sequences. Synthetic datasets of similar scale will be required, and these must be able to be produced within a reasonable timeframe. AIRRSHIP can generate 10 000 unique recombinations with mutation in &lt;70 s. This is faster than, but comparable to, IMPlAntS and partis, whilst immuneSIM is considerably slower (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7A</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). Sequence generation by AIRRSHIP scales linearly, and one million sequences can be produced in just under 2 h with mutation, or in 13 min without (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S7</xref>). When benchmarking, the time taken to achieve the requested number of independent VDJ recombination processes was measured. For IMPlAntS and partis, this can result in final repertoires of greater size when simulating with SHM. Depending on the end goal of the user, in some cases it may be faster than reported for these tools to generate the required repertoire size. Maximum RAM usage was found to be similar for all tools and is unlikely to be prohibitive (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7B</xref>). All tools were run on an Intel (R) Xeon (R) E5-2407 CPU with eight total cores and 188 GB RAM.</p>
  </sec>
  <sec>
    <title>4 Demonstration</title>
    <p>To illustrate a potential application of AIRRSHIP, we compared the ability of IMGT/HighV-QUEST and IgBLAST to accurately identify the number of nucleotides inserted at the VD junction (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>). Establishing correct gene boundaries within the junction can be complex. During the recombination process, D genes, which are already shorter than V or J genes, may be extensively trimmed such that the remaining sequence has an equal likelihood of having come from multiple parental genes (<xref rid="btad365-B14" ref-type="bibr">Yaari and Kleinstein 2015</xref>). Distinguishing between mutations and nontemplated nucleotides can also be problematic.</p>
    <p>Three repertoires of 100 000 sequences were simulated using AIRRSHIP with default settings. The percentage of sequences where the assigned VD insertion length, as given by IgBLAST or IMGT/HighV-QUEST, matched the number of nucleotides known to be inserted by AIRRSHIP was calculated. Only 49% of all sequences had the correct insertion length assigned by both tools (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9A</xref>). The length of the D gene was also shorter in sequences with an incorrect insertion length assignment (9.0 bases versus 14.5 bases, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9B</xref>). As trimming of gene ends will result in shorter D genes, simulated repertoires were then generated where the ends of the D gene were not trimmed or where no gene ends were trimmed. In sequences where the D gene was not trimmed, the proportion of sequences with correct assignments was 88%, rising to 97% when no gene ends were trimmed. In our analyses, incorrect assignments will include cases in which inserted nucleotides are identical to those trimmed from the gene ends. It may be impossible for any tool to correctly establish recombination events in these situations but, as they may occur in real sequences, they should not be ignored.</p>
    <p>Although identifying differences in performance between the tools themselves was not our primary intention, we did observe that the percentage of sequences where the VD insertion length was correctly identified by both tools was lower than that of each individual tool. This suggests that different sequences are incorrectly analysed by each tool. Overall, gene trimming appears to be a substantial confounder in boundary assignment. By further iterating through AIRRSHIP parameters, a greater understanding of limitations in junctional boundary identification and how these might affect downstream analyses could be gained.</p>
  </sec>
  <sec>
    <title>5 Discussion</title>
    <p>AIRRSHIP simulates BCR repertoires that closely resemble experimental datasets and, for certain metrics, appear more realistic than those produced by other simulation tools. Several factors may contribute to this improved performance. Firstly, all tools were run as presented ‘out of the box’, without providing user data to learn from. In the case of partis, this involved using the <italic toggle="yes">–simulate-from-scratch</italic> method which uses ‘plausible heuristics’ to generate repertoire features rather than replicating a specific sample. This may have contributed to the dissimilarity between partis and experimental sequences. In particular, the SHM model used in this mode does not distinguish between positions in the sequence, explaining the lack of variation in per position mutation rate observed. Partis can also simulate sequences using parameters inferred from user provided data. However, this requires substantially more user input and is therefore not comparable to how AIRRSHIP and the other tools were run.</p>
    <p>The choice of in-built reference data may also affect the quality of sequences produced. Data from 380 individual repertoires from five independent datasets, comprising a total of 11 869 126 BCR sequences were processed to create AIRRSHIP reference files. The breadth of this reference data captures variation amongst individuals and the depth should allow even rare BCR sequences to be replicated. In comparison, the majority of immuneSIM parameters are inferred from a single dataset (<xref rid="btad365-B3" ref-type="bibr">DeWitt <italic toggle="yes">et al.</italic> 2016</xref>) and as such will be limited to features present in these individuals. For many metrics, IMPlAntS performs similarly to AIRRSHIP and this tool also uses reference data from a wide range of experimental datasets, encompassing 2152 individuals (<xref rid="btad365-B16" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2021a</xref>). The differences observed between these tools may be due to the underlying algorithms employed as previously discussed in the case of nucleotide insertion.</p>
    <p>As well as producing high quality sequences, AIRRSHIP is designed for ease of use in the production of repertoires for benchmarking applications. It requires few dependencies, runs quickly, and offers broad choices in parameter selection. We have illustrated how AIRRSHIP may be used to explore challenges in AIRR-seq analyses and believe it can be of value in more systematic assessment of the current AIRR-seq tool landscape.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad365_Supplementary_Data</label>
      <media xlink:href="btad365_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> is available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Wellcome Trust [220096/Z/20/Z to C.S.].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>AIRRSHIP source code is publicly available at <ext-link xlink:href="https://github.com/Cowanlab/airrship" ext-link-type="uri">https://github.com/Cowanlab/airrship</ext-link>. This publication makes use of a number of publicly available datasets that are listed in the Supplementary Methods.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad365-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bolotin</surname><given-names>DA</given-names></string-name>, <string-name><surname>Poslavsky</surname><given-names>S</given-names></string-name>, <string-name><surname>Mitrophanov</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>MiXCR: software for comprehensive adaptive immunity profiling</article-title>. <source>Nat Methods</source><year>2015</year>;<volume>12</volume>:<fpage>380</fpage>–<lpage>1</lpage>.<pub-id pub-id-type="pmid">25924071</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brochet</surname><given-names>X</given-names></string-name>, <string-name><surname>Lefranc</surname><given-names>M-P</given-names></string-name>, <string-name><surname>Giudicelli</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>IMGT/V-QUEST: the highly customized and integrated system for IG and TR standardized V-J and V-D-J sequence analysis</article-title>. <source>Nucleic Acids Res</source><year>2008</year>;<volume>36</volume>:<fpage>W503</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">18503082</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DeWitt</surname><given-names>WS</given-names></string-name>, <string-name><surname>Lindau</surname><given-names>P</given-names></string-name>, <string-name><surname>Snyder</surname><given-names>TM</given-names></string-name></person-group><etal>et al</etal><article-title>A public database of memory and naive B-cell receptor sequences</article-title>. <source>PLoS One</source><year>2016</year>;<volume>11</volume>:<fpage>e0160853</fpage>.<pub-id pub-id-type="pmid">27513338</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gadala-Maria</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Automated analysis of high-throughput B-cell sequencing data reveals a high frequency of novel immunoglobulin V gene segment alleles</article-title>. <source>Proc Natl Acad Sci USA</source><year>2015</year>;<volume>112</volume>:<fpage>E862</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">25675496</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Echidna: integrated simulations of single-cell immune receptor repertoires and transcriptomes</article-title>. <source>Bioinf Adv</source><year>2022</year>;<volume>2</volume>:<fpage>vbac062</fpage>.</mixed-citation>
    </ref>
    <ref id="btad365-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lefranc</surname><given-names>MP.</given-names></string-name></person-group><article-title>WHO-IUIS nomenclature subcommittee for immunoglobulins and T cell receptors report</article-title>. <source>Immunogenetics</source><year>2007</year>;<volume>59</volume>:<fpage>899</fpage>–<lpage>902</lpage>.<pub-id pub-id-type="pmid">18046549</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marcou</surname><given-names>Q</given-names></string-name>, <string-name><surname>Mora</surname><given-names>T</given-names></string-name>, <string-name><surname>Walczak</surname><given-names>AM</given-names></string-name></person-group><etal>et al</etal><article-title>High-throughput immune repertoire analysis with IGoR</article-title>. <source>Nat Commun</source><year>2018</year>;<volume>9</volume>:<fpage>561</fpage>.<pub-id pub-id-type="pmid">29422654</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Olson</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Moghimi</surname><given-names>P</given-names></string-name>, <string-name><surname>Schramm</surname><given-names>CA</given-names></string-name></person-group><etal>et al</etal><article-title>sumrep: a summary statistic framework for immune receptor repertoire comparison and model validation</article-title>. <source>Front Immunol</source><year>2019</year>;<volume>10</volume>:<fpage>2533</fpage>.<pub-id pub-id-type="pmid">31736960</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ralph</surname><given-names>DK</given-names></string-name>, <string-name><surname>Matsen</surname><given-names>FA.</given-names></string-name></person-group><article-title>Consistency of VDJ rearrangement and substitution parameters enables accurate B cell receptor sequence annotation</article-title>. <source>PLoS Comput Biol</source><year>2016</year>;<volume>12</volume>:<fpage>1</fpage>–<lpage>25</lpage>.</mixed-citation>
    </ref>
    <ref id="btad365-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Safonova</surname><given-names>Y</given-names></string-name>, <string-name><surname>Lapidus</surname><given-names>A</given-names></string-name>, <string-name><surname>Lill</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>IgSimulator: a versatile immunosequencing simulator</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>3213</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">26007226</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smakaj</surname><given-names>E</given-names></string-name>, <string-name><surname>Babrak</surname><given-names>L</given-names></string-name>, <string-name><surname>Ohlin</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Benchmarking immunoinformatic tools for the analysis of antibody repertoire sequences</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>1731</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">31873728</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vander Heiden</surname><given-names>JA</given-names></string-name>, <string-name><surname>Marquez</surname><given-names>S</given-names></string-name>, <string-name><surname>Marthandan</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal>; <collab>AIRR Community</collab>. <article-title>AIRR community standardized representations for annotated immune repertoires</article-title>. <source>Front Immunol</source><year>2018</year>;<volume>9</volume>:<fpage>2206</fpage>.<pub-id pub-id-type="pmid">30323809</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weber</surname><given-names>CR</given-names></string-name>, <string-name><surname>Akbar</surname><given-names>R</given-names></string-name>, <string-name><surname>Yermanos</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>ImmuneSIM: tunable multi-feature simulation of B- and T-cell receptor repertoires for immunoinformatics benchmarking</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>3594</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">32154832</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yaari</surname><given-names>G</given-names></string-name>, <string-name><surname>Kleinstein</surname><given-names>SH.</given-names></string-name></person-group><article-title>Practical guidelines for B-cell receptor repertoire sequencing analysis</article-title>. <source>Genome Med</source><year>2015</year>;<volume>7</volume>:<fpage>121</fpage>.<pub-id pub-id-type="pmid">26589402</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yaari</surname><given-names>G</given-names></string-name>, <string-name><surname>Vander Heiden</surname><given-names>JA</given-names></string-name>, <string-name><surname>Uduman</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Models of somatic hypermutation targeting and substitution based on synonymous mutations from high-throughput immunoglobulin sequencing data</article-title>. <source>Front Immunol</source><year>2013</year>;<volume>4</volume>:<fpage>358</fpage>.<pub-id pub-id-type="pmid">24298272</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>X</given-names></string-name>, <string-name><surname>Wang</surname><given-names>M</given-names></string-name>, <string-name><surname>Wu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Large-scale analysis of 2,152 Ig-seq datasets reveals key features of B cell biology and the antibody repertoire</article-title>. <source>Cell Rep</source><year>2021a</year>;<volume>35</volume>:<fpage>109110</fpage>.<pub-id pub-id-type="pmid">33979623</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Novel allele detection tool benchmark and application with antibody repertoire sequencing dataset</article-title>. <source>Front Immunol</source><year>2021b</year>;<volume>12</volume>:<fpage>739179</fpage>.<pub-id pub-id-type="pmid">34764956</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ye</surname><given-names>J</given-names></string-name>, <string-name><surname>Ma</surname><given-names>N</given-names></string-name>, <string-name><surname>Madden</surname><given-names>TL</given-names></string-name></person-group><etal>et al</etal><article-title>IgBLAST: an immunoglobulin variable domain sequence analysis tool</article-title>. <source>Nucleic Acids Res</source><year>2013</year>;<volume>41</volume>:<fpage>W34</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">23671333</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yermanos</surname><given-names>A</given-names></string-name>, <string-name><surname>Greiff</surname><given-names>V</given-names></string-name>, <string-name><surname>Krautler</surname><given-names>NJ</given-names></string-name></person-group><etal>et al</etal><article-title>Comparison of methods for phylogenetic B-cell lineage inference using time-resolved antibody repertoire simulations (AbSim)</article-title>. <source>Bioinformatics</source><year>2017</year>;<volume>33</volume>:<fpage>3938</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">28968873</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>B</given-names></string-name>, <string-name><surname>Yang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>B-cell receptor repertoire sequencing: deeper digging into the mechanisms and clinical aspects of immune-mediated diseases</article-title>. <source>iScience</source><year>2022</year>;<volume>25</volume>:<fpage>105002</fpage>.<pub-id pub-id-type="pmid">36157582</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10272706</article-id>
    <article-id pub-id-type="pmid">37279738</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad365</article-id>
    <article-id pub-id-type="publisher-id">btad365</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>AIRRSHIP: simulating human B cell receptor repertoire sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-5862-4014</contrib-id>
        <name>
          <surname>Sutherland</surname>
          <given-names>Catherine</given-names>
        </name>
        <aff><institution>Institute of Immunology and Infection Research, School of Biological Sciences, University of Edinburgh</institution>, Edinburgh, EH9 3FL, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1949-4253</contrib-id>
        <name>
          <surname>Cowan</surname>
          <given-names>Graeme J M</given-names>
        </name>
        <aff><institution>Institute of Immunology and Infection Research, School of Biological Sciences, University of Edinburgh</institution>, Edinburgh, EH9 3FL, <country country="GB">United Kingdom</country></aff>
        <xref rid="btad365-cor1" ref-type="corresp"/>
        <!--graeme.cowan@ed.ac.uk-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Alkan</surname>
          <given-names>Can</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad365-cor1">Corresponding author. Institute of Immunology and Infection Research, School of Biological Sciences, University of Edinburgh, Ashworth Laboratories, Charlotte Auerbach Rd, Edinburgh, EH9 3FL, United Kingdom. E-mail: <email>graeme.cowan@ed.ac.uk</email> (G.J.M.C.)</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-06-05">
      <day>05</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>6</issue>
    <elocation-id>btad365</elocation-id>
    <history>
      <date date-type="received">
        <day>31</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>05</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>27</day>
        <month>5</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>02</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>15</day>
        <month>6</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad365.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Adaptive Immune Receptor Repertoire Sequencing is a rapidly developing field that has advanced understanding of the role of the adaptive immune system in health and disease. Numerous tools have been developed to analyse the complex data produced by this technique but work to compare their accuracy and reliability has been limited. Thorough, systematic assessment of their performance is dependent on the ability to produce high quality simulated datasets with known ground truth. We have developed AIRRSHIP, a flexible and fast Python package that produces synthetic human B cell receptor sequences. AIRRSHIP uses a comprehensive set of reference data to replicate key mechanisms in the immunoglobulin recombination process, with a particular focus on junctional complexity. Repertoires generated by AIRRSHIP are highly similar to published data and all steps in the sequence generation process are recorded. These data can be used to not only determine the accuracy of repertoire analysis tools but can also, by tuning of the large number of user-controllable parameters, give insight into factors that contribute to inaccuracies in results.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>AIRRSHIP is implemented in Python. It is available via <ext-link xlink:href="https://github.com/Cowanlab/airrship" ext-link-type="uri">https://github.com/Cowanlab/airrship</ext-link> and on PyPI at <ext-link xlink:href="https://pypi.org/project/airrship/" ext-link-type="uri">https://pypi.org/project/airrship/</ext-link>. Documentation can be found at <ext-link xlink:href="https://airrship.readthedocs.io/" ext-link-type="uri">https://airrship.readthedocs.io/</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>220096/Z/20/Z</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Adaptive Immune Receptor Repertoire Sequencing (AIRR-seq) uses high throughput sequencing to characterize the state and dynamics of B cell receptor (BCR) repertoires and is of increasing use in understanding the molecular basis of immunity and autoimmunity (<xref rid="btad365-B14" ref-type="bibr">Yaari and Kleinstein 2015</xref>, <xref rid="btad365-B20" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2022</xref>). BCR repertoire data comprises sequences of the variable regions of BCRs, which are rearranged and hypermutated during B cell maturation. Key to interpretation of this data is the determination of parental VDJ segments for each receptor, as well as identification of nucleotide insertions and deletions, positions of segment junctions, and sequence mutations. Numerous tools have been developed to enable these analyses, with the most commonly used being IgBLAST, IMGT/HighV-QUEST and MiXCR (<xref rid="btad365-B2" ref-type="bibr">Brochet et al. 2008</xref>, <xref rid="btad365-B18" ref-type="bibr">Ye <italic toggle="yes">et al.</italic> 2013</xref>, <xref rid="btad365-B1" ref-type="bibr">Bolotin <italic toggle="yes">et al.</italic> 2015</xref>). Benchmarking of such tools has been limited but work published to date indicates that their outputs can differ, potentially impacting the conclusions drawn from repertoire sequencing experiments (<xref rid="btad365-B11" ref-type="bibr">Smakaj <italic toggle="yes">et al.</italic> 2020</xref>).</p>
    <p>The ability to assess the absolute accuracy of antibody repertoire analysis tools is limited by the lack of experimental datasets where details of all recombination processes are known. Simulation of rearranged BCR data offers an alternative solution for benchmarking where this ground-truth is recorded. Several methods for simulating BCR data have been published (<xref rid="btad365-B10" ref-type="bibr">Safonova <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btad365-B9" ref-type="bibr">Ralph and Matsen 2016</xref>, <xref rid="btad365-B19" ref-type="bibr">Yermanos <italic toggle="yes">et al.</italic> 2017</xref>, <xref rid="btad365-B7" ref-type="bibr">Marcou <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btad365-B13" ref-type="bibr">Weber <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad365-B17" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2021b</xref>; <xref rid="btad365-B5" ref-type="bibr">Han <italic toggle="yes">et al.</italic> 2022</xref>). However, the usefulness of these tools for benchmarking studies can be limited by their requirements for complex dependencies, nonstandard output file formats, and/or generation of repertoires that are dissimilar to real experimental data. Therefore, we introduce AIRRSHIP (Adaptive Immune Receptor Repertoire Simulation of Human Immunoglobulin Production), a tool for simulating human BCR sequences, which accurately replicates features of experimental data whilst being fast, flexible, and easy to use.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>AIRRSHIP is implemented in Python and has no additional dependencies beyond the standard library. It replicates the processes by which immunoglobulin sequences are formed in vivo (<xref rid="btad365-F1" ref-type="fig">Fig. 1</xref>, full details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>), with each step informed by comprehensive built-in reference data from experimental datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S1</xref> and<xref rid="sup1" ref-type="supplementary-material"> S2</xref>). To begin, VDJ segments are selected from simulated immunoglobin loci according to observed patterns of usage and an initial recombined sequence is generated. Trimming of segment ends then occurs, with the number of nucleotides to be removed sampled from distributions of trimming lengths for the corresponding IMGT gene family. Following this, NP nucleotides are inserted at the VD and DJ junctions. Insertion lengths are chosen from experimental distributions and addition of nucleotides occurs according to a position dependent Markov process. Separate transition matrices are used when simulating nonmutated and mutated sequences to compensate for the inability to determine which inserted positions have been hypermutated.</p>
    <fig position="float" id="btad365-F1">
      <label>Figure 1</label>
      <caption>
        <p>AIRRSHIP simulates human heavy chain BCR sequences, informed by experimental data at each step of the synthetic recombination process. Key parameters such as VDJ usage, gene trimming, junctional insertions and somatic hypermutation can all be modified by the user. Sequences in the FASTA file output can then be used as input for tools of interest and results easily compared to the tab separated values (TSV) file which acts as a record of the recombination process for each sequence.</p>
      </caption>
      <graphic xlink:href="btad365f1" position="float"/>
    </fig>
    <p>Somatic hypermutation is replicated at both the per sequence and per position level. For each sequence, the overall mutation frequency is chosen from a distribution and the required number of mutations are introduced. The likelihood of mutation at each nucleotide is determined by considering the five base sequence motif and immunoglobulin sequence region in which it sits. All reference distributions and models used by AIRRSHIP vary at the IMGT gene, family or sequence region level and thus should be robust to novel allele discovery (<xref rid="btad365-B6" ref-type="bibr">Lefranc 2007</xref>, <xref rid="btad365-B4" ref-type="bibr">Gadala-Maria <italic toggle="yes">et al.</italic> 2015</xref>).</p>
    <p>To create repertoires tailored to specific benchmarking scenarios, the user can control patterns of VDJ usage, insertions, and deletions, as well as the rate and distribution of somatic hypermutation. Scripts are also provided to allow users to simulate from their own reference data. AIRRSHIP output is optimized for benchmarking, consisting of a FASTA file of sequences which can be used directly as input for tools of interest, as well as a TSV file, which closely follows the AIRR Standards rearrangement schema (<xref rid="btad365-B12" ref-type="bibr">Vander Heiden <italic toggle="yes">et al.</italic> 2018</xref>) and facilitates easy reference to known sequence origins.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We assessed the resemblance to real data of sequences generated by AIRRSHIP and three other simulation tools: partis, immuneSIM, and IMPlAntS (<xref rid="btad365-B9" ref-type="bibr">Ralph and Matsen 2016</xref>, <xref rid="btad365-B13" ref-type="bibr">Weber <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btad365-B17" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2021b</xref>). Key summary statistics from these repertoires were compared to those from published BCR data using sumrep, an R package for comparison and summaries of repertoire data (<xref rid="btad365-B8" ref-type="bibr">Olson <italic toggle="yes">et al.</italic> 2019</xref>). To prevent favourable bias, experimental data were selected from studies not used for AIRRSHIP input reference (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>).</p>
    <p>Comparison between nonmutated simulated repertoires and IgD/IgM experimental sequences revealed similarly high levels of performance between AIRRSHIP, IMPlAntS, and immuneSIM for VDJ usage frequency. Substantial deviation from experimental data in repertoires generated using partis was observed (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). Clustering of sequences by usage of VJ gene combinations also indicated that both AIRRSHIP and IMPlAntS produce patterns of recombination that more closely resemble experimental data than immuneSIM or partis (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). Divergences between real sequences and the AIRRSHIP and IMPlAntS repertoires were similar for lengths of nucleotide deletions and insertions at the junctions, whilst sequences from partis and immuneSIM differed more (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). The composition of nucleotides inserted at junctions in AIRRSHIP sequences was found to be more similar to experimental data than the insertions produced by any of the other tools. AIRRSHIP uses a Markov process with transition matrices established from human datasets to choose which nucleotide to add at each position of the insertion. In contrast, inserted nucleotides are chosen randomly by IMPlAntS, and immuneSIM selects from NP region and trimming combinations observed from mouse data. The more detailed model used by AIRRSHIP may explain the more realistic insertions produced.</p>
    <p>AIRRSHIP repertoires also most closely resembled experimental data in amino acid usage, GRAVY score, aliphatic index, and Atchley factor scores; all of which are important measures of sequence composition. These metrics are measured across the junction region and are representative of the realistic combinations of insertions, deletions, and VDJ gene usage generated by AIRRSHIP. Similar patterns were observed across metrics when comparing simulated repertoires with mutation to experimental IgA/IgG sequences (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>).</p>
    <p>During affinity maturation, mutations are introduced unevenly across BCR sequences. Therefore, we compared the ability of the simulation tools to produce realistic mutation patterns (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). Mutation rates per nucleotide position in the sequence were very closely correlated between AIRRSHIP and experimental sequences (<italic toggle="yes">r</italic> = 0.97). This was comparable to the relationship shown with IMPlAntS repertoires (<italic toggle="yes">r</italic> = 0.95), and stronger than that achieved by partis (<italic toggle="yes">r</italic> = 0.29) and immuneSIM (<italic toggle="yes">r</italic> = 0.27). Mutability models were also inferred using SHazaM (<xref rid="btad365-B15" ref-type="bibr">Yaari <italic toggle="yes">et al.</italic> 2013</xref>). As with per position mutation rate, IMPlAntS and AIRRSHIP closely replicate experimental patterns, with hotspot and coldspot motifs showing higher and lower mutability, respectively (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S5</xref> and <xref rid="sup1" ref-type="supplementary-material">S6</xref>).</p>
    <p>Finally, repertoire sequencing datasets may now consist of hundreds of thousands, if not millions, of sequences. Synthetic datasets of similar scale will be required, and these must be able to be produced within a reasonable timeframe. AIRRSHIP can generate 10 000 unique recombinations with mutation in &lt;70 s. This is faster than, but comparable to, IMPlAntS and partis, whilst immuneSIM is considerably slower (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7A</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). Sequence generation by AIRRSHIP scales linearly, and one million sequences can be produced in just under 2 h with mutation, or in 13 min without (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S7</xref>). When benchmarking, the time taken to achieve the requested number of independent VDJ recombination processes was measured. For IMPlAntS and partis, this can result in final repertoires of greater size when simulating with SHM. Depending on the end goal of the user, in some cases it may be faster than reported for these tools to generate the required repertoire size. Maximum RAM usage was found to be similar for all tools and is unlikely to be prohibitive (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7B</xref>). All tools were run on an Intel (R) Xeon (R) E5-2407 CPU with eight total cores and 188 GB RAM.</p>
  </sec>
  <sec>
    <title>4 Demonstration</title>
    <p>To illustrate a potential application of AIRRSHIP, we compared the ability of IMGT/HighV-QUEST and IgBLAST to accurately identify the number of nucleotides inserted at the VD junction (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>). Establishing correct gene boundaries within the junction can be complex. During the recombination process, D genes, which are already shorter than V or J genes, may be extensively trimmed such that the remaining sequence has an equal likelihood of having come from multiple parental genes (<xref rid="btad365-B14" ref-type="bibr">Yaari and Kleinstein 2015</xref>). Distinguishing between mutations and nontemplated nucleotides can also be problematic.</p>
    <p>Three repertoires of 100 000 sequences were simulated using AIRRSHIP with default settings. The percentage of sequences where the assigned VD insertion length, as given by IgBLAST or IMGT/HighV-QUEST, matched the number of nucleotides known to be inserted by AIRRSHIP was calculated. Only 49% of all sequences had the correct insertion length assigned by both tools (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9A</xref>). The length of the D gene was also shorter in sequences with an incorrect insertion length assignment (9.0 bases versus 14.5 bases, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9B</xref>). As trimming of gene ends will result in shorter D genes, simulated repertoires were then generated where the ends of the D gene were not trimmed or where no gene ends were trimmed. In sequences where the D gene was not trimmed, the proportion of sequences with correct assignments was 88%, rising to 97% when no gene ends were trimmed. In our analyses, incorrect assignments will include cases in which inserted nucleotides are identical to those trimmed from the gene ends. It may be impossible for any tool to correctly establish recombination events in these situations but, as they may occur in real sequences, they should not be ignored.</p>
    <p>Although identifying differences in performance between the tools themselves was not our primary intention, we did observe that the percentage of sequences where the VD insertion length was correctly identified by both tools was lower than that of each individual tool. This suggests that different sequences are incorrectly analysed by each tool. Overall, gene trimming appears to be a substantial confounder in boundary assignment. By further iterating through AIRRSHIP parameters, a greater understanding of limitations in junctional boundary identification and how these might affect downstream analyses could be gained.</p>
  </sec>
  <sec>
    <title>5 Discussion</title>
    <p>AIRRSHIP simulates BCR repertoires that closely resemble experimental datasets and, for certain metrics, appear more realistic than those produced by other simulation tools. Several factors may contribute to this improved performance. Firstly, all tools were run as presented ‘out of the box’, without providing user data to learn from. In the case of partis, this involved using the <italic toggle="yes">–simulate-from-scratch</italic> method which uses ‘plausible heuristics’ to generate repertoire features rather than replicating a specific sample. This may have contributed to the dissimilarity between partis and experimental sequences. In particular, the SHM model used in this mode does not distinguish between positions in the sequence, explaining the lack of variation in per position mutation rate observed. Partis can also simulate sequences using parameters inferred from user provided data. However, this requires substantially more user input and is therefore not comparable to how AIRRSHIP and the other tools were run.</p>
    <p>The choice of in-built reference data may also affect the quality of sequences produced. Data from 380 individual repertoires from five independent datasets, comprising a total of 11 869 126 BCR sequences were processed to create AIRRSHIP reference files. The breadth of this reference data captures variation amongst individuals and the depth should allow even rare BCR sequences to be replicated. In comparison, the majority of immuneSIM parameters are inferred from a single dataset (<xref rid="btad365-B3" ref-type="bibr">DeWitt <italic toggle="yes">et al.</italic> 2016</xref>) and as such will be limited to features present in these individuals. For many metrics, IMPlAntS performs similarly to AIRRSHIP and this tool also uses reference data from a wide range of experimental datasets, encompassing 2152 individuals (<xref rid="btad365-B16" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2021a</xref>). The differences observed between these tools may be due to the underlying algorithms employed as previously discussed in the case of nucleotide insertion.</p>
    <p>As well as producing high quality sequences, AIRRSHIP is designed for ease of use in the production of repertoires for benchmarking applications. It requires few dependencies, runs quickly, and offers broad choices in parameter selection. We have illustrated how AIRRSHIP may be used to explore challenges in AIRR-seq analyses and believe it can be of value in more systematic assessment of the current AIRR-seq tool landscape.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad365_Supplementary_Data</label>
      <media xlink:href="btad365_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> is available at <italic toggle="yes">Bioinformatics</italic> online.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Wellcome Trust [220096/Z/20/Z to C.S.].</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>AIRRSHIP source code is publicly available at <ext-link xlink:href="https://github.com/Cowanlab/airrship" ext-link-type="uri">https://github.com/Cowanlab/airrship</ext-link>. This publication makes use of a number of publicly available datasets that are listed in the Supplementary Methods.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad365-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bolotin</surname><given-names>DA</given-names></string-name>, <string-name><surname>Poslavsky</surname><given-names>S</given-names></string-name>, <string-name><surname>Mitrophanov</surname><given-names>I</given-names></string-name></person-group><etal>et al</etal><article-title>MiXCR: software for comprehensive adaptive immunity profiling</article-title>. <source>Nat Methods</source><year>2015</year>;<volume>12</volume>:<fpage>380</fpage>–<lpage>1</lpage>.<pub-id pub-id-type="pmid">25924071</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brochet</surname><given-names>X</given-names></string-name>, <string-name><surname>Lefranc</surname><given-names>M-P</given-names></string-name>, <string-name><surname>Giudicelli</surname><given-names>V</given-names></string-name></person-group><etal>et al</etal><article-title>IMGT/V-QUEST: the highly customized and integrated system for IG and TR standardized V-J and V-D-J sequence analysis</article-title>. <source>Nucleic Acids Res</source><year>2008</year>;<volume>36</volume>:<fpage>W503</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">18503082</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DeWitt</surname><given-names>WS</given-names></string-name>, <string-name><surname>Lindau</surname><given-names>P</given-names></string-name>, <string-name><surname>Snyder</surname><given-names>TM</given-names></string-name></person-group><etal>et al</etal><article-title>A public database of memory and naive B-cell receptor sequences</article-title>. <source>PLoS One</source><year>2016</year>;<volume>11</volume>:<fpage>e0160853</fpage>.<pub-id pub-id-type="pmid">27513338</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gadala-Maria</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Automated analysis of high-throughput B-cell sequencing data reveals a high frequency of novel immunoglobulin V gene segment alleles</article-title>. <source>Proc Natl Acad Sci USA</source><year>2015</year>;<volume>112</volume>:<fpage>E862</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">25675496</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Echidna: integrated simulations of single-cell immune receptor repertoires and transcriptomes</article-title>. <source>Bioinf Adv</source><year>2022</year>;<volume>2</volume>:<fpage>vbac062</fpage>.</mixed-citation>
    </ref>
    <ref id="btad365-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lefranc</surname><given-names>MP.</given-names></string-name></person-group><article-title>WHO-IUIS nomenclature subcommittee for immunoglobulins and T cell receptors report</article-title>. <source>Immunogenetics</source><year>2007</year>;<volume>59</volume>:<fpage>899</fpage>–<lpage>902</lpage>.<pub-id pub-id-type="pmid">18046549</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marcou</surname><given-names>Q</given-names></string-name>, <string-name><surname>Mora</surname><given-names>T</given-names></string-name>, <string-name><surname>Walczak</surname><given-names>AM</given-names></string-name></person-group><etal>et al</etal><article-title>High-throughput immune repertoire analysis with IGoR</article-title>. <source>Nat Commun</source><year>2018</year>;<volume>9</volume>:<fpage>561</fpage>.<pub-id pub-id-type="pmid">29422654</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Olson</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Moghimi</surname><given-names>P</given-names></string-name>, <string-name><surname>Schramm</surname><given-names>CA</given-names></string-name></person-group><etal>et al</etal><article-title>sumrep: a summary statistic framework for immune receptor repertoire comparison and model validation</article-title>. <source>Front Immunol</source><year>2019</year>;<volume>10</volume>:<fpage>2533</fpage>.<pub-id pub-id-type="pmid">31736960</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ralph</surname><given-names>DK</given-names></string-name>, <string-name><surname>Matsen</surname><given-names>FA.</given-names></string-name></person-group><article-title>Consistency of VDJ rearrangement and substitution parameters enables accurate B cell receptor sequence annotation</article-title>. <source>PLoS Comput Biol</source><year>2016</year>;<volume>12</volume>:<fpage>1</fpage>–<lpage>25</lpage>.</mixed-citation>
    </ref>
    <ref id="btad365-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Safonova</surname><given-names>Y</given-names></string-name>, <string-name><surname>Lapidus</surname><given-names>A</given-names></string-name>, <string-name><surname>Lill</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>IgSimulator: a versatile immunosequencing simulator</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>3213</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">26007226</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smakaj</surname><given-names>E</given-names></string-name>, <string-name><surname>Babrak</surname><given-names>L</given-names></string-name>, <string-name><surname>Ohlin</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Benchmarking immunoinformatic tools for the analysis of antibody repertoire sequences</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>1731</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">31873728</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vander Heiden</surname><given-names>JA</given-names></string-name>, <string-name><surname>Marquez</surname><given-names>S</given-names></string-name>, <string-name><surname>Marthandan</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal>; <collab>AIRR Community</collab>. <article-title>AIRR community standardized representations for annotated immune repertoires</article-title>. <source>Front Immunol</source><year>2018</year>;<volume>9</volume>:<fpage>2206</fpage>.<pub-id pub-id-type="pmid">30323809</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weber</surname><given-names>CR</given-names></string-name>, <string-name><surname>Akbar</surname><given-names>R</given-names></string-name>, <string-name><surname>Yermanos</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>ImmuneSIM: tunable multi-feature simulation of B- and T-cell receptor repertoires for immunoinformatics benchmarking</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>3594</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">32154832</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yaari</surname><given-names>G</given-names></string-name>, <string-name><surname>Kleinstein</surname><given-names>SH.</given-names></string-name></person-group><article-title>Practical guidelines for B-cell receptor repertoire sequencing analysis</article-title>. <source>Genome Med</source><year>2015</year>;<volume>7</volume>:<fpage>121</fpage>.<pub-id pub-id-type="pmid">26589402</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yaari</surname><given-names>G</given-names></string-name>, <string-name><surname>Vander Heiden</surname><given-names>JA</given-names></string-name>, <string-name><surname>Uduman</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Models of somatic hypermutation targeting and substitution based on synonymous mutations from high-throughput immunoglobulin sequencing data</article-title>. <source>Front Immunol</source><year>2013</year>;<volume>4</volume>:<fpage>358</fpage>.<pub-id pub-id-type="pmid">24298272</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>X</given-names></string-name>, <string-name><surname>Wang</surname><given-names>M</given-names></string-name>, <string-name><surname>Wu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>Large-scale analysis of 2,152 Ig-seq datasets reveals key features of B cell biology and the antibody repertoire</article-title>. <source>Cell Rep</source><year>2021a</year>;<volume>35</volume>:<fpage>109110</fpage>.<pub-id pub-id-type="pmid">33979623</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Novel allele detection tool benchmark and application with antibody repertoire sequencing dataset</article-title>. <source>Front Immunol</source><year>2021b</year>;<volume>12</volume>:<fpage>739179</fpage>.<pub-id pub-id-type="pmid">34764956</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ye</surname><given-names>J</given-names></string-name>, <string-name><surname>Ma</surname><given-names>N</given-names></string-name>, <string-name><surname>Madden</surname><given-names>TL</given-names></string-name></person-group><etal>et al</etal><article-title>IgBLAST: an immunoglobulin variable domain sequence analysis tool</article-title>. <source>Nucleic Acids Res</source><year>2013</year>;<volume>41</volume>:<fpage>W34</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">23671333</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yermanos</surname><given-names>A</given-names></string-name>, <string-name><surname>Greiff</surname><given-names>V</given-names></string-name>, <string-name><surname>Krautler</surname><given-names>NJ</given-names></string-name></person-group><etal>et al</etal><article-title>Comparison of methods for phylogenetic B-cell lineage inference using time-resolved antibody repertoire simulations (AbSim)</article-title>. <source>Bioinformatics</source><year>2017</year>;<volume>33</volume>:<fpage>3938</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">28968873</pub-id></mixed-citation>
    </ref>
    <ref id="btad365-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>B</given-names></string-name>, <string-name><surname>Yang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>B-cell receptor repertoire sequencing: deeper digging into the mechanisms and clinical aspects of immune-mediated diseases</article-title>. <source>iScience</source><year>2022</year>;<volume>25</volume>:<fpage>105002</fpage>.<pub-id pub-id-type="pmid">36157582</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
