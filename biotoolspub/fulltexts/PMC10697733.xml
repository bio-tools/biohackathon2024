<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10697733</article-id>
    <article-id pub-id-type="pmid">37966918</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad688</article-id>
    <article-id pub-id-type="publisher-id">btad688</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Nunchaku: optimally partitioning data into piece-wise contiguous segments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7427-3007</contrib-id>
        <name>
          <surname>Huo</surname>
          <given-names>Yu</given-names>
        </name>
        <aff><institution>Centre for Engineering Biology, University of Edinburgh</institution>, Edinburgh EH9 3BF, <country country="GB">United Kingdom</country></aff>
        <aff><institution>School of Biological Sciences, University of Edinburgh</institution>, Edinburgh EH9 3BF, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Hongpei</given-names>
        </name>
        <aff><institution>School of Biological Sciences, University of Edinburgh</institution>, Edinburgh EH9 3BF, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xiao</given-names>
        </name>
        <aff><institution>School of Biological Sciences, University of Edinburgh</institution>, Edinburgh EH9 3BF, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Xiaochen</given-names>
        </name>
        <aff><institution>School of Biological Sciences, University of Edinburgh</institution>, Edinburgh EH9 3BF, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7489-8587</contrib-id>
        <name>
          <surname>Swain</surname>
          <given-names>Peter S</given-names>
        </name>
        <aff><institution>Centre for Engineering Biology, University of Edinburgh</institution>, Edinburgh EH9 3BF, <country country="GB">United Kingdom</country></aff>
        <aff><institution>School of Biological Sciences, University of Edinburgh</institution>, Edinburgh EH9 3BF, <country country="GB">United Kingdom</country></aff>
        <xref rid="btad688-cor1" ref-type="corresp"/>
        <!--peter.swain@ed.ac.uk-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Martelli</surname>
          <given-names>Pier Luigi</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad688-cor1">Corresponding author. Centre for Engineering Biology, University of Edinburgh, Mayfield Road, Edinburgh EH9 3BF, United Kingdom. E-mail: <email>peter.swain@ed.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-15">
      <day>15</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>12</issue>
    <elocation-id>btad688</elocation-id>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>06</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>08</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>05</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad688.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>When analyzing 1D time series, scientists are often interested in identifying regions where one variable depends linearly on the other. Typically, they use an <italic toggle="yes">ad hoc</italic> and therefore often subjective method to do so.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we develop a statistically rigorous, Bayesian approach to infer the optimal partitioning of a dataset not only into contiguous piece-wise linear segments, but also into contiguous segments described by linear combinations of arbitrary basis functions. We therefore present a general solution to the problem of identifying discontinuous change points. Focusing on microbial growth, we use the algorithm to find the range of optical density where this density is linearly proportional to the number of cells and to automatically find the regions of exponential growth for both <italic toggle="yes">Escherichia coli</italic> and <italic toggle="yes">Saccharomyces cerevisiae</italic>. For budding yeast, we consequently are able to infer the Monod constant for growth on fructose. Our algorithm lends itself to automation and high throughput studies, increases reproducibility, and should facilitate data analyses for a broad range of scientists.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The corresponding Python package, entitled Nunchaku, is available at PyPI: <ext-link xlink:href="https://pypi.org/project/nunchaku" ext-link-type="uri">https://pypi.org/project/nunchaku</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Biotechnology and Biological Sciences Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000268</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>BB/W006545/1</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>A common scientific problem is understanding the relationship between two variables. When the dependent variable, or some transformation of it, depends linearly on the independent variable, the underlying system linking the two often behaves more simply than generally. As a consequence, scientists commonly focus their efforts on identifying and understanding this linear regime.</p>
    <p>A well-known example is the growth of a population of cells. In log phase, when the logarithm of the number of cells increases linearly with time, the total mass of every intracellular component grows exponentially and the mass per cell is approximately constant. Such steady-state conditions regularize growth; metabolic fluxes are balanced; and physiology simplifies, generating behaviours controlled by only a handful of variables (<xref rid="btad688-B11" ref-type="bibr">Scott and Hwa 2023</xref>).</p>
    <p>Biologists therefore often wish to determine when growth is in log phase. Historically the approach has been to plot the logarithm of a variable correlating with the number of cells, such as optical density (OD), against time and to identify a linear region by eye (<xref rid="btad688-B7" ref-type="bibr">Monod 1949</xref>). Today this subjective technique is still used, with one scientist’s linear region not necessarily the same as another’s.</p>
    <p>A challenge to developing objective approaches is identifying a suitable nonlinear model with which to compare the linear one. There is no general way to describe all relationships that we may observe. With a mechanistic understanding, we might generate a nonlinear description, but such an understanding is often lacking and, anyhow, may obviate the need to find linear regimes.</p>
    <p>Here, we circumvent this problem by inferring the piece-wise linear description that best approximates an entire 1D time series. By doing so, we reframe the task to one of detecting change points—time points where the process generating the time series changes, a well-studied problem (<xref rid="btad688-B12" ref-type="bibr">Stephens 1994</xref>) with an established frequentist solution (<xref rid="btad688-B1" ref-type="bibr">Baranowski <italic toggle="yes">et al.</italic> 2019</xref>). We use a Bayesian approach, complementing others (<xref rid="btad688-B5" ref-type="bibr">Hutter 2007</xref>, <xref rid="btad688-B10" ref-type="bibr">Papastamoulis <italic toggle="yes">et al.</italic> 2019</xref>), and generalize by allowing each segment of data to be described by a linear combination of arbitrary basis functions, with straight lines being but one example. For a given set of basis functions, we compare the evidence for every possible piece-wise linear combination, found by marginalizing over all possible fits to all possible contiguous subdivisions of the data. For linear segments and for the optimal choice of segments, we provide statistics for each segment, allowing users to select straightforwardly the segment or segments of most interest. To illustrate our algorithm, we primarily discuss two examples: determining the range of OD of a liquid culture where the OD depends linearly on the number of cells and finding the exponential phases of microbial growth curves.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Inferring contiguous regions using model comparison</title>
      <p>Given 1D time-series data and a set of <italic toggle="yes">K</italic> basis functions, we wish to divide the data into the group of contiguous segments that is best characterized by piece-wise linear combinations of the basis functions. Irrespective of the data’s behaviour, we will always find such a group. Our approach answers two questions: how many piece-wise contiguous segments best describe the data given the basis functions and where the optimal segment boundaries lie.</p>
      <p>Let us assume that we have observations, <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">j</italic> runs from 1 to <italic toggle="yes">N</italic> and the <italic toggle="yes">x<sub>j</sub></italic> are in ascending order; <italic toggle="yes">r</italic> indexes the <italic toggle="yes">N<sub>r</sub></italic> replicates if any. We denote these observations collectively as <italic toggle="yes">D</italic>.</p>
      <p>First, we consider whether we should divide the data into <italic toggle="yes">M</italic> or <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> segments, using Bayesian model comparison (<xref rid="btad688-B6" ref-type="bibr">MacKay 2003</xref>). Assuming equal prior probabilities, <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we write the Bayes’ factor as:</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>′</mml:mo>
                  <mml:mo>|</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>′</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>′</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>′</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>and therefore we should determine the evidence <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for each <italic toggle="yes">M</italic>.</p>
      <p>The evidence is a marginal likelihood. For <italic toggle="yes">M</italic> contiguous segments, there are <italic toggle="yes">M–</italic>1 unknown boundary points, which we denote as <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>≡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. These points are integers and index an <italic toggle="yes">x<sub>j</sub></italic>. The two remaining boundaries are the indices for the first and last <italic toggle="yes">x</italic> values: 1 and <italic toggle="yes">N</italic>. We assume that each segment contains a minimal number of data points <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, so that <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. The choice of <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> depends on the type and number of basis functions: in general, <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      <p>The evidence is a sum over all potential <bold><italic toggle="yes">n</italic></bold>:</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>D</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mi>M</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mi mathvariant="bold-italic">n</mml:mi>
                  </mml:munder>
                </mml:mrow>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>D</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mi mathvariant="bold-italic">n</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>M</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi mathvariant="bold-italic">n</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mi>M</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo>=</mml:mo>
                <mml:mi>f</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>M</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>ℓ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>min</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mrow>
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mi mathvariant="bold-italic">n</mml:mi>
                  </mml:munder>
                </mml:mrow>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>D</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mi mathvariant="bold-italic">n</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>M</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where we use that any permissible <italic toggle="yes">n<sub>i</sub></italic> is equally likely as any other to write the prior <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as a function of <italic toggle="yes">N</italic>, <italic toggle="yes">M</italic>, and <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Specifically, this bounded uniform prior is the reciprocal of the number of possible <bold><italic toggle="yes">n</italic></bold>, which satisfy</p>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>n</mml:mi>
                </mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mo>≥</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>ℓ</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>min</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mo> </mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>n</mml:mi>
                </mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mo>≥</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>n</mml:mi>
                </mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>ℓ</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>min</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mo>…</mml:mo>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>n</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>M</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>≥</mml:mo>
            <mml:mi>N</mml:mi>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>ℓ</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>min</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>for a given <italic toggle="yes">M</italic> and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We therefore have:</p>
      <disp-formula id="E4">
        <label>(4)</label>
        <mml:math id="M4" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi mathvariant="bold-italic">n</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mi>M</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo> </mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mo> </mml:mo>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:mrow>
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo> </mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ℓ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>min</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>M</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ℓ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>min</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:munderover>
                </mml:mrow>
                <mml:mo>×</mml:mo>
                <mml:mrow>
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo> </mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ℓ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>min</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>M</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ℓ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>min</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:munderover>
                </mml:mrow>
                <mml:mo>×</mml:mo>
                <mml:mo>⋯</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo>×</mml:mo>
                <mml:mrow>
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo> </mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ℓ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>min</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ℓ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>min</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:munderover>
                </mml:mrow>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo> </mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mo> </mml:mo>
                <mml:mi>f</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>M</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>ℓ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>min</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>.</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>Second, for a given <italic toggle="yes">M</italic> and <bold><italic toggle="yes">n</italic></bold>, we fit the data to <italic toggle="yes">M</italic> different linear combinations of the basis functions, one for each segment, with each combination independent of the other. The linear combination ending near the data points indexed by <italic toggle="yes">n<sub>i</sub></italic> and <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> depends only on the data indexed by the indices <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> inclusively, denoted <italic toggle="yes">D<sub>i</sub></italic>, and this data does not determine any other linear combination. Therefore, mathematically,</p>
      <disp-formula id="E5">
        <label>(5)</label>
        <mml:math id="M5" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>D</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:mi mathvariant="bold-italic">n</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>×</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>×</mml:mo>
                <mml:mo>⋯</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo>×</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>M</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the likelihood of a linear combination of the basis functions describing the data indexed by <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      <sec>
        <title>2.1.1 Finding <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:msub></mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></title>
        <p>For each segment of the data, we consider the <italic toggle="yes">K</italic> basis functions, each individually denoted <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo mathvariant="bold">ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and collectively <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mi>ϕ</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, and correspondingly <italic toggle="yes">K</italic> coefficients, each denoted <italic toggle="yes">m<sub>k</sub></italic>. If fitting lines, we have two basis functions: <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, and two <italic toggle="yes">m<sub>k</sub></italic> where <italic toggle="yes">m</italic><sub>1</sub> determines the line’s <italic toggle="yes">y</italic>-intercept and <italic toggle="yes">m</italic><sub>2</sub> its gradient. We then set <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> so that there are sufficient data points in each segment to define a line.</p>
        <p>We let <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> describe how a data point <italic toggle="yes">y<sub>j</sub></italic> at <italic toggle="yes">x<sub>j</sub></italic> deviates from the linear combination of basis functions and assume that this deviation is independent of the deviations of other data points.</p>
        <p>For the <italic toggle="yes">i</italic>th segment, we then have</p>
        <disp-formula id="E6">
          <label>(6)</label>
          <mml:math id="M6" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>D</mml:mi>
                          </mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>|</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mo>∫</mml:mo>
                    <mml:mi>d</mml:mi>
                  </mml:mrow>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo> </mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo>∏</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:munderover>
                    </mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mi>j</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>r</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mrow>
                    <mml:mo>∫</mml:mo>
                    <mml:mi>d</mml:mi>
                  </mml:mrow>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo> </mml:mo>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo>∏</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:munderover>
                    </mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mi>j</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>r</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>assuming the prior <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a constant, with each <italic toggle="yes">m<sub>k</sub></italic> independently and uniformly distributed in some bounded region so that</p>
        <disp-formula id="E7">
          <label>(7)</label>
          <mml:math id="M7" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi mathvariant="bold-italic">m</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mrow>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mn>1</mml:mn>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>m</mml:mi>
                                    </mml:mrow>
                                    <mml:mn>1</mml:mn>
                                    <mml:mrow>
                                      <mml:mtext>max</mml:mtext>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>m</mml:mi>
                                    </mml:mrow>
                                    <mml:mn>1</mml:mn>
                                    <mml:mrow>
                                      <mml:mtext>min</mml:mtext>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                                <mml:mo>⋯</mml:mo>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>m</mml:mi>
                                    </mml:mrow>
                                    <mml:mi>K</mml:mi>
                                    <mml:mrow>
                                      <mml:mtext>max</mml:mtext>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>m</mml:mi>
                                    </mml:mrow>
                                    <mml:mi>K</mml:mi>
                                    <mml:mrow>
                                      <mml:mtext>min</mml:mtext>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mtext>for</mml:mtext>
                          <mml:mo> </mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>∈</mml:mo>
                          <mml:mo stretchy="false">[</mml:mo>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mrow>
                                <mml:mtext>min</mml:mtext>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                          <mml:mo>,</mml:mo>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mrow>
                                <mml:mtext>max</mml:mtext>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                          <mml:mo stretchy="false">]</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mn>0</mml:mn>
                          <mml:mo> </mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mtext>otherwise</mml:mtext>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>for fixed <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> for all <italic toggle="yes">k</italic>.</p>
      </sec>
      <sec>
        <title>2.1.2 Marginalizing <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></title>
        <p>Using <xref rid="E5" ref-type="disp-formula">Equation (5)</xref>, we factorize the sum in <xref rid="E2" ref-type="disp-formula">Equation (2)</xref>:</p>
        <disp-formula id="E8">
          <label>(8)</label>
          <mml:math id="M8" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi mathvariant="bold-italic">n</mml:mi>
                    </mml:munder>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>×</mml:mo>
                  <mml:mo>⋯</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>3</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>3</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>and use the method of variable elimination (<xref rid="btad688-B16" ref-type="bibr">Zhang and Poole 1996</xref>) to evaluate these sums. First we perform the rightmost one, over <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, to generate a function of <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We then perform the next rightmost sum, over <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, of this function and the next term in <xref rid="E8" ref-type="disp-formula">Equation (8)</xref>, which generates a function of <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We repeat this process until we reach the leftmost sum over <italic toggle="yes">n</italic><sub>1</sub>, enabling <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> operations in total instead of <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We evaluate <xref rid="E4" ref-type="disp-formula">Equation (4)</xref> similarly.</p>
        <p>All that remains is to determine <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> so that we can find <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> via <xref rid="E2" ref-type="disp-formula">Equation (2)</xref> and <xref rid="E8" ref-type="disp-formula">Equation (8)</xref>.</p>
      </sec>
      <sec>
        <title>2.1.3 Finding <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for known measurement error</title>
        <p>To proceed, we assume that <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a normal distribution with mean <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mi mathvariant="bold">ϕ</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:math></inline-formula>, or equivalently <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and a standard deviation <italic toggle="yes">σ<sub>j</sub></italic>. If we know the <italic toggle="yes">σ<sub>j</sub></italic>, e.g. by approximating each by the corresponding measurement error, then <xref rid="E6" ref-type="disp-formula">Equation (6)</xref>, the likelihood of a linear combination describing the data indexed by <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, becomes</p>
        <disp-formula id="E9">
          <label>(9)</label>
          <mml:math id="M9" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>n</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>n</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">σ</mml:mi>
                  <mml:mo>)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo>)</mml:mo>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msqrt>
                          <mml:mn>2</mml:mn>
                          <mml:mo>π</mml:mo>
                        </mml:msqrt>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mo>σ</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>N</mml:mi>
                            <mml:mi>r</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mo>∫</mml:mo>
                  <mml:mi>d</mml:mi>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo> </mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>N</mml:mi>
                            <mml:mi>r</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:munderover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:munderover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>[</mml:mo>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mi>y</mml:mi>
                                  <mml:mi>j</mml:mi>
                                  <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mi>r</mml:mi>
                                    <mml:mo>)</mml:mo>
                                  </mml:mrow>
                                </mml:msubsup>
                              </mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:mi mathvariant="bold">ϕ</mml:mi>
                              <mml:mrow>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mi>x</mml:mi>
                                        <mml:mi>j</mml:mi>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mo>)</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>T</mml:mi>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mi mathvariant="bold-italic">m</mml:mi>
                              <mml:mo>]</mml:mo>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mo>σ</mml:mo>
                              <mml:mi>j</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>To evaluate the integral, we extend it to infinite range for all <italic toggle="yes">m<sub>k</sub>—</italic>a suitable approximation because we expect the integrand to be strongly peaked at the most likely values of each <italic toggle="yes">m<sub>k</sub></italic> (<xref rid="btad688-B6" ref-type="bibr">MacKay 2003</xref>). We can then perform the integration analytically.</p>
        <p>Consider data with a single replicate. Define <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to be the number of <italic toggle="yes">x</italic> values in the <italic toggle="yes">i</italic>th segment and <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to be a vector with components <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, with the superscript <italic toggle="yes">i</italic> used to denote the <italic toggle="yes">i</italic>th segment. Let <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:mo>Φ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> matrix with components <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and further defining</p>
        <disp-formula id="E10">
          <label>(10)</label>
          <mml:math id="M10" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>A</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mo>Φ</mml:mo>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>Φ</mml:mo>
                          </mml:mrow>
                          <mml:mi>T</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>;</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mover accent="true">
                                    <mml:mi mathvariant="bold-italic">m</mml:mi>
                                    <mml:mo stretchy="false">¯</mml:mo>
                                  </mml:mover>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:msup>
                                      <mml:mrow>
                                        <mml:mi>A</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mi>i</mml:mi>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:msup>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mo>Φ</mml:mo>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">z</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>so that <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The matrix <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is a symmetric <italic toggle="yes">K </italic>×<italic toggle="yes"> K</italic> matrix, which is invertible when the basis functions <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are linearly independent and when <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>. Then standard algebra gives</p>
        <disp-formula id="E11">
          <label>(11)</label>
          <mml:math id="M11" display="block" overflow="scroll">
            <mml:mrow>
              <mml:munderover>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>n</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:munderover>
            </mml:mrow>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>[</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mi mathvariant="bold">ϕ</mml:mi>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>x</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mi>T</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mi mathvariant="bold-italic">m</mml:mi>
                      <mml:mo>]</mml:mo>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mo>σ</mml:mo>
                      <mml:mi>j</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msubsup>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mi mathvariant="bold-italic">m</mml:mi>
                          <mml:mo>¯</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mi>T</mml:mi>
              </mml:msup>
            </mml:mrow>
            <mml:mrow>
              <mml:msup>
                <mml:mi>A</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mi>i</mml:mi>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mo>(</mml:mo>
            <mml:mi mathvariant="bold-italic">m</mml:mi>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mi mathvariant="bold-italic">m</mml:mi>
                    <mml:mo>¯</mml:mo>
                  </mml:mover>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mi>i</mml:mi>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>U</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mi>i</mml:mi>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>where</p>
        <disp-formula id="E12">
          <label>(12)</label>
          <mml:math id="M12" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mn>2</mml:mn>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>U</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi mathvariant="bold-italic">z</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mi>T</mml:mi>
                </mml:msup>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">z</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mo>−</mml:mo>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mi mathvariant="bold-italic">m</mml:mi>
                                        <mml:mo stretchy="false">¯</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mi>T</mml:mi>
                </mml:msup>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>A</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi mathvariant="bold-italic">m</mml:mi>
                            <mml:mo stretchy="false">¯</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mo>.</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>Using <xref rid="E11" ref-type="disp-formula">Equation (11)</xref> and the results for integrating multivariate Gaussian distributions (<xref rid="btad688-B6" ref-type="bibr">MacKay 2003</xref>), we have that</p>
        <disp-formula id="E13">
          <label>(13)</label>
          <mml:math id="M13" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>∫</mml:mo>
                  <mml:mi>d</mml:mi>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo> </mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:munderover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>[</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>y</mml:mi>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:mi mathvariant="bold">ϕ</mml:mi>
                              <mml:mrow>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mi>x</mml:mi>
                                        <mml:mi>j</mml:mi>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mo>)</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>T</mml:mi>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mi mathvariant="bold-italic">m</mml:mi>
                              <mml:mo>]</mml:mo>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mo>σ</mml:mo>
                              <mml:mi>j</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mo>π</mml:mo>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mi>K</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mtext>det</mml:mtext>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mi>A</mml:mi>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mi>i</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mn>1</mml:mn>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mi mathvariant="normal">e</mml:mi>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mi>U</mml:mi>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mi>i</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>If we are fitting straight lines with <italic toggle="yes">K </italic>=<italic toggle="yes"> </italic>2 and <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, then it is useful to define (<xref rid="btad688-B4" ref-type="bibr">Hinrichsen <italic toggle="yes">et al.</italic> 2017</xref>)</p>
        <disp-formula id="E14">
          <label>(14)</label>
          <mml:math id="M14" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:munder>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>y</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo>σ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>;</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:munder>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo>σ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:mrow>
                          <mml:mn>3</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:munder>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mn>1</mml:mn>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo>σ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>;</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:mrow>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:munder>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>y</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo>σ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:mrow>
                          <mml:mn>5</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:munder>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>y</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo>σ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>;</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:mrow>
                          <mml:mn>6</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:munder>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo>σ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>with <italic toggle="yes">j</italic> running from <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Using these definitions,</p>
        <disp-formula id="E15">
          <label>(15)</label>
          <mml:math id="M15" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>A</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:mo stretchy="true">(</mml:mo>
                            <mml:mrow>
                              <mml:mtable>
                                <mml:mtr>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mi>T</mml:mi>
                                          </mml:mrow>
                                          <mml:mn>3</mml:mn>
                                        </mml:msub>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:mtd>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mi>T</mml:mi>
                                          </mml:mrow>
                                          <mml:mn>6</mml:mn>
                                        </mml:msub>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:mtd>
                                </mml:mtr>
                                <mml:mtr>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mi>T</mml:mi>
                                          </mml:mrow>
                                          <mml:mn>6</mml:mn>
                                        </mml:msub>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:mtd>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mi>T</mml:mi>
                                          </mml:mrow>
                                          <mml:mn>2</mml:mn>
                                        </mml:msub>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:mtd>
                                </mml:mtr>
                              </mml:mtable>
                            </mml:mrow>
                            <mml:mo stretchy="true">)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mo>;</mml:mo>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mi mathvariant="bold-italic">m</mml:mi>
                                        <mml:mo stretchy="true">¯</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mtable>
                                <mml:mtr>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mfrac>
                                          <mml:mrow>
                                            <mml:mn>2</mml:mn>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>2</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>4</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mo>−</mml:mo>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>5</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>6</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mn>4</mml:mn>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>2</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>3</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mo>−</mml:mo>
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>6</mml:mn>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mfrac>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:mtd>
                                </mml:mtr>
                                <mml:mtr>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mfrac>
                                          <mml:mrow>
                                            <mml:mn>2</mml:mn>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>3</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>5</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mo>−</mml:mo>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>4</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>6</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mn>4</mml:mn>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>2</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>3</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mo>−</mml:mo>
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>6</mml:mn>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mfrac>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:mtd>
                                </mml:mtr>
                              </mml:mtable>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mrow/>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>U</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>T</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>4</mml:mn>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>5</mml:mn>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>4</mml:mn>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>6</mml:mn>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>and the integral becomes <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>π</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>6</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
        <p>With more than one replicate, <bold><italic toggle="yes">z</italic></bold> runs over all <italic toggle="yes">y</italic> in all replicates, with the replicates arranged contiguously, and is of length <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>; <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mo>Φ</mml:mo></mml:math></inline-formula> has rows of length <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> repeated <italic toggle="yes">N<sub>r</sub></italic> times in each row to match the corresponding <italic toggle="yes">y</italic> values. For the linear case, the sums in <xref rid="E14" ref-type="disp-formula">Equation (14)</xref> are over both <italic toggle="yes">j</italic> and the number of replicates, so that <italic toggle="yes">T</italic><sub>1</sub>, e.g., becomes <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
        <p>Returning to <xref rid="E9" ref-type="disp-formula">Equation (9)</xref>, we find</p>
        <disp-formula id="E16">
          <label>(16)</label>
          <mml:math id="M16" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">σ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munderover>
                          <mml:mo>∏</mml:mo>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>n</mml:mi>
                                </mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>n</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:munderover>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msqrt>
                                  <mml:mrow>
                                    <mml:mn>2</mml:mn>
                                    <mml:mo>π</mml:mo>
                                  </mml:mrow>
                                </mml:msqrt>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mo>σ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>j</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>N</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mo>π</mml:mo>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mi>K</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mtext>det</mml:mtext>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>A</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">e</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mi>U</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mi>i</mml:mi>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>with the help of <xref rid="E13" ref-type="disp-formula">Equation (13)</xref>. For this approximation to be valid, we require that the strongly peaked region in <bold><italic toggle="yes">m</italic></bold> space is within the <italic toggle="yes">a priori</italic> range for <bold><italic toggle="yes">m</italic></bold>. The area under the integrand in <xref rid="E13" ref-type="disp-formula">Equation (13)</xref> is proportional to the square root of <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:mtext>det</mml:mtext><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, and the prior range of <bold><italic toggle="yes">m</italic></bold> must be large enough to contain this area. Using <xref rid="E7" ref-type="disp-formula">Equation (7)</xref>, we need</p>
        <disp-formula id="E17">
          <label>(17)</label>
          <mml:math id="M17" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mtext>det</mml:mtext>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>A</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mo>×</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi mathvariant="bold-italic">m</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>≪</mml:mo>
              <mml:mn>1.</mml:mn>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </sec>
      <sec>
        <title>2.1.4 Finding the boundary points</title>
        <p>After determining the optimal number of segments into which to divide the data from <xref rid="E1" ref-type="disp-formula">Equaion (1)</xref>, we next find their boundary points. Using Bayes’ theorem, the posterior for <italic toggle="yes">n</italic> is</p>
        <disp-formula id="E18">
          <label>(18)</label>
          <mml:math id="M18" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi mathvariant="bold-italic">n</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mi>D</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>M</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi mathvariant="bold-italic">σ</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:mi mathvariant="bold-italic">n</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi mathvariant="bold-italic">σ</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mi>P</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi mathvariant="bold-italic">n</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi mathvariant="bold-italic">σ</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>which we evaluate using <xref rid="E2" ref-type="disp-formula">Equations (2</xref>, <xref rid="E4" ref-type="disp-formula">4</xref>, and <xref rid="E5" ref-type="disp-formula">5</xref>). We use the mean posterior value of <italic toggle="yes">n<sub>i</sub></italic> to estimate the optimal <italic toggle="yes">n<sub>i</sub></italic>:</p>
        <disp-formula id="E19">
          <label>(19)</label>
          <mml:math id="M19" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>E</mml:mi>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">]</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi mathvariant="bold-italic">n</mml:mi>
                    </mml:munder>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">σ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi mathvariant="bold-italic">n</mml:mi>
                        <mml:mo>|</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>D</mml:mi>
                        <mml:mo>|</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi mathvariant="bold-italic">σ</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi mathvariant="bold-italic">n</mml:mi>
                    </mml:munder>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">σ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>⋯</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">σ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>which we sum following <xref rid="E8" ref-type="disp-formula">Equation (8)</xref>. The posterior variance, <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mrow><mml:mtext>Var</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, determines the error in this estimate, which we find similarly.</p>
      </sec>
      <sec>
        <title>2.1.5 Finding <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for unknown measurement error</title>
        <p>If the <italic toggle="yes">σ<sub>j</sub></italic> are unknown, we assume the same constant <italic toggle="yes">σ</italic> for all <italic toggle="yes">j</italic> with a uniform prior probability between <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> (<xref rid="btad688-B3" ref-type="bibr">Gelman 2006</xref>). <xref rid="E2" ref-type="disp-formula">Equation (2)</xref> then becomes</p>
        <disp-formula id="E20">
          <label>(20)</label>
          <mml:math id="M20" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mi>f</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ℓ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>min</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi mathvariant="bold-italic">n</mml:mi>
                    </mml:munder>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:mi>f</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ℓ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>min</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi mathvariant="bold-italic">n</mml:mi>
                    </mml:munder>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mo>∫</mml:mo>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mo>σ</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext>min</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mo>σ</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext>max</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mi>d</mml:mi>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo>σ</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>The constant <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> will cancel in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> when we compare the evidence for different <italic toggle="yes">M</italic>.</p>
        <p>Using the equivalent of <xref rid="E9" ref-type="disp-formula">Equations (9</xref> and <xref rid="E13" ref-type="disp-formula">13)</xref>, we find that</p>
        <disp-formula id="E21">
          <label>(21)</label>
          <mml:math id="M21" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:mo>π</mml:mo>
                          </mml:mrow>
                        </mml:msqrt>
                        <mml:mo>σ</mml:mo>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mtext>det</mml:mtext>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>A</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mo> </mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>U</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>σ</mml:mo>
                                </mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where we now explicitly follow <italic toggle="yes">σ</italic> and so set the <italic toggle="yes">σ<sub>j</sub></italic> in <xref rid="E10" ref-type="disp-formula">Equation (10)</xref> to unity, making <italic toggle="yes">z<sub>i</sub></italic> = <italic toggle="yes">y<sub>i</sub></italic> and <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Similarly for the linear case, the <italic toggle="yes">σ<sub>j</sub></italic> become unity in <xref rid="E14" ref-type="disp-formula">Equation (14)</xref>.</p>
        <p>Consequently,</p>
        <disp-formula id="E22">
          <label>(22)</label>
          <mml:math id="M22" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>×</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>×</mml:mo>
                  <mml:mo>⋯</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mo> </mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi mathvariant="bold-italic">m</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:mo>π</mml:mo>
                          </mml:mrow>
                        </mml:msqrt>
                        <mml:mo>σ</mml:mo>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mtext>det</mml:mtext>
                                <mml:mrow>
                                  <mml:msup>
                                    <mml:mrow>
                                      <mml:mi>A</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:mi>i</mml:mi>
                                      <mml:mo stretchy="false">)</mml:mo>
                                    </mml:mrow>
                                  </mml:msup>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>−</mml:mo>
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mo> </mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mo>∑</mml:mo>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>=</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mi>M</mml:mi>
                              </mml:msubsup>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>U</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mi>i</mml:mi>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>σ</mml:mo>
                                </mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>Although with <xref rid="E22" ref-type="disp-formula">Equation (22)</xref> it is possible to approximate analytically the integral over <italic toggle="yes">σ</italic> in <xref rid="E20" ref-type="disp-formula">Equation (20)</xref> by extending the range of the integrand to <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>∞</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, the resulting expression prevents us from summing over <bold><italic toggle="yes">n</italic></bold> using variable elimination. Instead, we swap the sum and the integral to write</p>
        <disp-formula id="E23">
          <label>(23)</label>
          <mml:math id="M23" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>D</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mi>M</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>N</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>M</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ℓ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext>min</mml:mtext>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mo>σ</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mrow>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mo>∫</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo>σ</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>min</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo>σ</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>max</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mi>d</mml:mi>
              </mml:mrow>
              <mml:mo>σ</mml:mo>
              <mml:mrow>
                <mml:munder>
                  <mml:mo>∑</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                </mml:munder>
              </mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>D</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mi mathvariant="bold-italic">n</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>M</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mo>σ</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>and numerically evaluate, using variable elimination to sum over <bold><italic toggle="yes">n</italic></bold> in <xref rid="E23" ref-type="disp-formula">Equation (23)</xref> for each <italic toggle="yes">σ</italic> chosen by the integration algorithm.</p>
        <p>We find the expected boundary points via <xref rid="E19" ref-type="disp-formula">Equation (19)</xref>, again numerically integrating over <italic toggle="yes">σ</italic>.</p>
        <p><bold>Performing the integration:</bold> To stabilize the numerical integration, we scale the integrand of <xref rid="E23" ref-type="disp-formula">Equation (23)</xref> by its value at the most likely value of <italic toggle="yes">σ</italic>, making the integrand nearly always less than one and preventing overflow. We use expectation-maximization (EM) to estimate the most likely <italic toggle="yes">σ</italic> for a given <italic toggle="yes">M</italic>. The EM algorithm finds the <italic toggle="yes">σ</italic> that maximizes <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (<xref rid="btad688-B2" ref-type="bibr">Bishop 2006</xref>). We guess a value of <italic toggle="yes">σ</italic>, <italic toggle="yes">σ<sub>o</sub></italic> say, and find <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from <xref rid="E18" ref-type="disp-formula">Equation (18)</xref>. To update <italic toggle="yes">σ<sub>o</sub></italic>, we maximize <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>σ</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with respect to <italic toggle="yes">σ</italic>, where</p>
        <disp-formula id="E24">
          <label>(24)</label>
          <mml:math id="M24" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>Q</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mo>σ</mml:mo>
                      <mml:mi>o</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi mathvariant="bold-italic">n</mml:mi>
                    </mml:munder>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mo>σ</mml:mo>
                      <mml:mi>o</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                  <mml:mo> </mml:mo>
                  <mml:mtext>log</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo>)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:mi>E</mml:mi>
                  <mml:mo>[</mml:mo>
                  <mml:mtext>log</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo>)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>log</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo>)</mml:mo>
                  <mml:mo>]</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:mi>E</mml:mi>
                  <mml:mo>[</mml:mo>
                  <mml:mtext>log</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo>)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>log</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mi>f</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ℓ</mml:mi>
                      <mml:mtext>min</mml:mtext>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                  <mml:mo>]</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>with the expectations taken over <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Expanding <xref rid="E24" ref-type="disp-formula">Equation (24)</xref> using <xref rid="E22" ref-type="disp-formula">Equation</xref><xref rid="E22" ref-type="disp-formula"> (22)</xref>, there are only two terms that depend on <italic toggle="yes">σ</italic>, and we can differentiate to find the updated <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:mo>σ</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>:</p>
        <disp-formula id="E25">
          <label>(25)</label>
          <mml:math id="M25" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mo>σ</mml:mo>
                  </mml:mrow>
                  <mml:mi>n</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mfrac>
                  <mml:mn>2</mml:mn>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mi>N</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mi>K</mml:mi>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
              <mml:mrow>
                <mml:munderover>
                  <mml:mo>∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mi>M</mml:mi>
                </mml:munderover>
              </mml:mrow>
              <mml:mi>E</mml:mi>
              <mml:mo stretchy="false">[</mml:mo>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>U</mml:mi>
                  </mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:msub>
              </mml:mrow>
              <mml:mo stretchy="false">]</mml:mo>
              <mml:mo>.</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>We use the equivalent of <xref rid="E19" ref-type="disp-formula">Equation (19)</xref> with <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to evaluate these expectations and iterate until the value of <italic toggle="yes">σ</italic> converges.</p>
      </sec>
      <sec>
        <title>2.1.6 Implementation</title>
        <p>For basis functions that generate lines, we compare the different linear segments by calculating the gradient, intercept, and the coefficient of determination <italic toggle="yes">R</italic><sup>2</sup> of the line maximizing the likelihood for each segment. The user can then select a desired segment, such as the one with the largest gradient.</p>
        <p>The algorithm requires the <italic toggle="yes">a priori</italic> bounded region of <bold><italic toggle="yes">m</italic></bold> in <xref rid="E7" ref-type="disp-formula">Equation (7)</xref>. Again specializing to straight lines, the prior specifies the range of the intercept <italic toggle="yes">m</italic><sub>1</sub> and the gradient <italic toggle="yes">m</italic><sub>2</sub>: <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. The user can either provide both ranges or only the range of <italic toggle="yes">m</italic><sub>2</sub> or give the maximal range of <italic toggle="yes">y</italic> possible in the experiment, <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. If the user provides only the range of <italic toggle="yes">m</italic><sub>2</sub>, we estimate <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> as <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> as <inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. If the user provides the range of <italic toggle="yes">y</italic>, we estimate the range of <italic toggle="yes">m</italic><sub>2</sub> as <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, with <inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mo>Δ</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> being the smallest difference between two neighbouring <italic toggle="yes">x</italic> values.</p>
      </sec>
      <sec>
        <title>2.1.7 Availability</title>
        <p>We coded the algorithm as a Python package available at <ext-link xlink:href="https://pypi.org/project/nunchaku" ext-link-type="uri">https://pypi.org/project/nunchaku</ext-link> and via <monospace>pip</monospace>. We have also embedded <monospace>nunchaku</monospace> into our <monospace>omniplate</monospace> software for analyzing plate-reader data (<xref rid="btad688-B8" ref-type="bibr">Montaño-Gutierrez <italic toggle="yes">et al.</italic> 2022</xref>).</p>
      </sec>
      <sec>
        <title>2.1.8 Generating and testing with synthetic data</title>
        <p>To test our method, we generated a piece-wise linear function <italic toggle="yes">f</italic>(<italic toggle="yes">x</italic>) with <inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>M</mml:mi><mml:mo>≤</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> continuous linear segments, each having between 10 and 50 data points and with a unit distance, <inline-formula id="IE90"><mml:math id="IM90" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, between data points. We sampled <italic toggle="yes">θ</italic>, the angle between each segment and the <italic toggle="yes">x</italic>-axis, from a uniform distribution on the interval <inline-formula id="IE91"><mml:math id="IM91" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mtext>tan</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>tan</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, so that the gradient, <inline-formula id="IE92"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mrow><mml:mtext>tan</mml:mtext><mml:mo> </mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula>, lies between <inline-formula id="IE93"><mml:math id="IM93" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. Furthermore we ensured that the difference in <italic toggle="yes">θ</italic> between neighbouring segments is larger than a fixed minimum, <italic toggle="yes">θ</italic><sub>0</sub>. We added Gaussian noise, <inline-formula id="IE94"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mrow><mml:mo>ϵ</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, to give three replicates of <inline-formula id="IE95"><mml:math id="IM95" display="inline" overflow="scroll"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo>ϵ</mml:mo></mml:mrow></mml:math></inline-formula>. We generated 3600 synthetic datasets in total, a combination of 200 different piece-wise linear functions <italic toggle="yes">f</italic>(<italic toggle="yes">x</italic>), three values of <italic toggle="yes">θ</italic><sub>0</sub>, and six values of <italic toggle="yes">σ</italic>. In <xref rid="btad688-F1" ref-type="fig">Figs 1</xref> and <xref rid="btad688-F2" ref-type="fig">2</xref>, <inline-formula id="IE96"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
        <fig position="float" id="btad688-F1">
          <label>Figure 1.</label>
          <caption>
            <p>The nunchaku algorithm correctly predicts the number of linear segments in synthetic data when the measurement noise is not too high. (A) Example synthetic datasets with the ground truth in blue (small circles) and the triplicate data in light grey. The large red circles are the predicted boundaries of each linear segment with the best-fit line in red. Left: with a measurement error of 0.25, the predictions overlap the data; Right: with a measurement error of 8, the predictions miss some segments, which the noise obscures. As a prior, we specify only that the gradient of each line lies between <inline-formula id="IE97"><mml:math id="IM97" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>25</mml:mn><mml:mo>,</mml:mo><mml:mn>25</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. For this data, a measurement error of 0.25 is 0.5% of the mean of <italic toggle="yes">y</italic> and an error of 8 is almost 15%. (B) The algorithm underestimates the number of linear segments only once the magnitude of the measurement noise becomes sufficiently high. The actual number of segments is <italic toggle="yes">M</italic>; the estimated number is <inline-formula id="IE98"><mml:math id="IM98" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
          </caption>
          <graphic xlink:href="btad688f1" position="float"/>
        </fig>
        <fig position="float" id="btad688-F2">
          <label>Figure 2.</label>
          <caption>
            <p>Nunchaku performs as well as or better than the NOT algorithm (<xref rid="btad688-B1" ref-type="bibr">Baranowski <italic toggle="yes">et al.</italic> 2019</xref>). This algorithm only supports input of one <italic toggle="yes">y</italic> value for each <italic toggle="yes">x</italic> value: we therefore input either one replicate or the mean of three replicates. The data are generated similarly to that in <xref rid="btad688-F1" ref-type="fig">Fig. 1</xref> (Section 2). As a prior for nunchaku, we specify that the gradient of each line lies between <inline-formula id="IE99"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>25</mml:mn><mml:mo>,</mml:mo><mml:mn>25</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. (A) The root mean squared error (RMSE) between the ground truth and the best-fit lines. (B) The difference between the predicted number of segments <inline-formula id="IE100"><mml:math id="IM100" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> and the ground truth <italic toggle="yes">M</italic> (left) and the percentage of correct predictions of <italic toggle="yes">M</italic> with <inline-formula id="IE101"><mml:math id="IM101" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> (right).</p>
          </caption>
          <graphic xlink:href="btad688f2" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>2.2 Experimental methods</title>
      <p>We used a prototrophic strain of <italic toggle="yes">Saccharomyces cerevisiae</italic> (FY4), precultured in synthetic complete (SC) medium with 2% (w/v) sodium pyruvate in a 30°C shaking incubator at 180 rpm for two days. Before the experiment, we diluted the cells 6-fold and let them grow for six hours. After washing the cells twice with fresh minimal media (<xref rid="btad688-B14" ref-type="bibr">Verduyn <italic toggle="yes">et al.</italic> 1992</xref>), we inoculated them into minimal media with different concentrations of fructose on a 96-well microplate. The liquid volume of each well was 200 μl.</p>
      <p>For <italic toggle="yes">Escherichia coli</italic>, we precultured cells in 3 ml liquid Luria broth (LB) with one colony from a fresh plate and grew aerobically to log phase (6 h) at 37°C with 250 rpm shaking. We then inoculated 3 μl culture into 147 μl fresh LB medium per well on a 96-well microplate.</p>
      <p>We used either a Tecan Infinite M200 Pro or F200 plate reader at 30°C for <italic toggle="yes">S.cerevisiae</italic> and 37°C for <italic toggle="yes">E.coli</italic> with linear shaking at amplitude 6 mm. Measurements of absorbance at 600 nm, OD<sub>600</sub>, were taken every 10 min.</p>
      <p>Data were analyzed using the <monospace>omniplate</monospace> software (<xref rid="btad688-B8" ref-type="bibr">Montaño-Gutierrez <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    </sec>
    <sec>
      <title>2.3 Fitting Monod’s equation</title>
      <p>After estimating the specific growth rate <italic toggle="yes">λ</italic> at each concentration of fructose <italic toggle="yes">s</italic>, we have a dataset <inline-formula id="IE102"><mml:math id="IM102" display="inline" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi><mml:mo>≡</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> with 38 data points. We use Bayesian inference to estimate the constants <inline-formula id="IE103"><mml:math id="IM103" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">K<sub>M</sub></italic> of Monod’s equation. Assuming a Gaussian measurement error of <inline-formula id="IE104"><mml:math id="IM104" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> with a standard deviation <italic toggle="yes">σ</italic> and independent measurements, the likelihood</p>
      <disp-formula id="E26">
        <label>(26)</label>
        <mml:math id="M26" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>D</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>λ</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>max</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>K</mml:mi>
                    </mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mo>σ</mml:mo>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msqrt>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                          <mml:mo>π</mml:mo>
                        </mml:mrow>
                      </mml:msqrt>
                      <mml:mo>σ</mml:mo>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo>×</mml:mo>
                <mml:mrow>
                  <mml:munderover>
                    <mml:mo>∏</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:munderover>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo> </mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mo> </mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>[</mml:mo>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="true">(</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mo>λ</mml:mo>
                                      </mml:mrow>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>−</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mo>λ</mml:mo>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mtext>max</mml:mtext>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:msub>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                            <mml:mi>i</mml:mi>
                                          </mml:msub>
                                        </mml:mrow>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:msub>
                                            <mml:mrow>
                                              <mml:mi>K</mml:mi>
                                            </mml:mrow>
                                            <mml:mi>M</mml:mi>
                                          </mml:msub>
                                        </mml:mrow>
                                        <mml:mo>+</mml:mo>
                                        <mml:mrow>
                                          <mml:msub>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                            <mml:mi>i</mml:mi>
                                          </mml:msub>
                                        </mml:mrow>
                                      </mml:mrow>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo stretchy="true">)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mo>σ</mml:mo>
                              </mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
                <mml:mo>.</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>To marginalize over <italic toggle="yes">σ</italic>, we assume <inline-formula id="IE105"><mml:math id="IM105" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo>σ</mml:mo></mml:mrow></mml:math></inline-formula>, so that</p>
      <disp-formula id="E27">
        <label>(27)</label>
        <mml:math id="M27" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>D</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>λ</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>max</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>K</mml:mi>
                    </mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>∝</mml:mo>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mo>∫</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>∞</mml:mo>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:mrow>
                <mml:mo>σ</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>D</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>λ</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>max</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>K</mml:mi>
                    </mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mo>σ</mml:mo>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mo>σ</mml:mo>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo>∝</mml:mo>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:munderover>
                              <mml:mo>∑</mml:mo>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:munderover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mo stretchy="true">(</mml:mo>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mo>λ</mml:mo>
                                        </mml:mrow>
                                        <mml:mi>i</mml:mi>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mo>−</mml:mo>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mo>λ</mml:mo>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mtext>max</mml:mtext>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mfrac>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:msub>
                                              <mml:mrow>
                                                <mml:mi>s</mml:mi>
                                              </mml:mrow>
                                              <mml:mi>i</mml:mi>
                                            </mml:msub>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:msub>
                                              <mml:mrow>
                                                <mml:mi>K</mml:mi>
                                              </mml:mrow>
                                              <mml:mi>M</mml:mi>
                                            </mml:msub>
                                          </mml:mrow>
                                          <mml:mo>+</mml:mo>
                                          <mml:mrow>
                                            <mml:msub>
                                              <mml:mrow>
                                                <mml:mi>s</mml:mi>
                                              </mml:mrow>
                                              <mml:mi>i</mml:mi>
                                            </mml:msub>
                                          </mml:mrow>
                                        </mml:mrow>
                                      </mml:mfrac>
                                    </mml:mrow>
                                    <mml:mo stretchy="true">)</mml:mo>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mi>N</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
                <mml:mo>.</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>We further assume that the prior <inline-formula id="IE106"><mml:math id="IM106" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is uniform, and so the posterior probability <inline-formula id="IE107"><mml:math id="IM107" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">K<sub>M</sub></italic> is proportional to the likelihood, <xref rid="E27" ref-type="disp-formula">Equation (27)</xref>. We therefore maximize the likelihood with respect to <inline-formula id="IE108"><mml:math id="IM108" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">K<sub>M</sub></italic> using the BFGS algorithm. We estimate the errors in these inferences using the diagonal elements of the Hessian matrix <inline-formula id="IE109"><mml:math id="IM109" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:mo>∇</mml:mo><mml:mo>∇</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> evaluated at the maximum of the likelihood (<xref rid="btad688-B6" ref-type="bibr">MacKay 2003</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Approximating data with a piece-wise linear model</title>
      <p>Although our goal is to allow scientists to choose objectively the segment of their data that is ‘most’ linear, we adopt a general methodology and allow the data to be described by linear combinations of arbitrary basis functions. For straight lines, there are two basis functions, <inline-formula id="IE110"><mml:math id="IM110" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE111"><mml:math id="IM111" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, but datasets may require higher order polynomials or even Gaussian or sigmoid functions (<xref rid="btad688-B2" ref-type="bibr">Bishop 2006</xref>).</p>
      <p>For a 1D time series and a given set of basis functions, we will infer the optimal piece-wise description—the number of contiguous segments into which we should divide the data, where the boundaries of each of those segments should be, and the best-fit linear combination of basis functions for each segment. Deciding which of these segments is then most appropriate for the task in hand is unavoidably subjective. It is straightforward, however, to compare different segments by comparing properties of their best-fit linear combinations. For lines, these properties include their gradients and <italic toggle="yes">R</italic><sup>2</sup> value—how much of the variance of the dependent variable is explained by the independent one (<xref rid="btad688-B9" ref-type="bibr">Moses 2017</xref>).</p>
      <p>We use a Bayesian approach to infer the best piece-wise description and assume only that the data of each segment is normally distributed around a linear combination of the basis functions (Section 2). To proceed analytically we marginalize over all coefficients constituting the linear combination for each segment using a mild approximation and choose the optimal number of segments by comparing marginal likelihoods. The data points bounding each segment are then estimated by the means of their posterior distribution. We consider the case with known measurement error separately from an unknown one and call our algorithm <monospace>nunchaku</monospace>.</p>
    </sec>
    <sec>
      <title>3.2 Verifying our approach</title>
      <p>To verify our methodology (Section 2), we first focused on identifying linear regions. We generated synthetic data using piece-wise linear functions, where we know the number of segments and their gradients, added Gaussian noise, and then inferred from this data the optimal number of segments and the gradients of the best-fit lines, assuming that we know the magnitude of the measurement noise (<xref rid="btad688-F1" ref-type="fig">Fig. 1A</xref>).</p>
      <p>The algorithm predicts correctly the number of segments when the noise in the data is sufficiently low (<xref rid="btad688-F1" ref-type="fig">Fig. 1B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>), but underestimates this number when the noise is larger. Such noise tends to blur two neighbouring segments so they seem one, rather than cause a single segment to appear as two or more. Similarly, if we decrease the angle between neighbouring segments, the noise is more likely to make two neighbouring segments appear contiguous, and the algorithm’s accuracy falls (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
      <p>We confirmed that the algorithm also correctly predicts the underlying piece-wise linear functions, and hence the gradient of the lines generating the data in the segments (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). As expected, this accuracy falls too with more noisy data.</p>
      <p>When the measurement error is unknown, the results are similar (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>), but the algorithm is slower because we numerically integrate over all possible magnitudes of this measurement error. We also confirmed that the algorithm’s performance is robust to broad choices of the prior distribution (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>).</p>
      <p>We next compared our methodology to the Narrowest-Over-Threshold (NOT) algorithm (<xref rid="btad688-B1" ref-type="bibr">Baranowski <italic toggle="yes">et al.</italic> 2019</xref>), a state-of-the-art frequentist approach. Whether we consider the root mean square error between the best-fit lines and the ground truth (<xref rid="btad688-F2" ref-type="fig">Fig. 2A</xref>) or the predicted number of segments (<xref rid="btad688-F2" ref-type="fig">Fig. 2B</xref>), our algorithm consistently performs as well as or better (see also <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). This greater accuracy however comes at the expense of speed: the NOT algorithm is faster than our implementation of <monospace>nunchaku</monospace>.</p>
      <p>Finally, we demonstrated that <monospace>nunchaku</monospace> works with other basis functions, including constant functions, third-order polynomials, and sines (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>).</p>
    </sec>
    <sec>
      <title>3.3 Application 1: finding the range of OD that increases linearly with cell number</title>
      <p>The OD of a microbial culture increases linearly with the number of cells only for sufficiently small ODs. At higher ODs, the light from the spectrophotometer may scatter off multiple cells, and the relationship between OD and the number of cells becomes nonlinear (<xref rid="btad688-B13" ref-type="bibr">Stevenson <italic toggle="yes">et al.</italic> 2016</xref>). To calibrate OD measurements, researchers often serially dilute a dense culture of microbes and measure the relationship between the OD and the dilution factor (<xref rid="btad688-B15" ref-type="bibr">Warringer and Blomberg 2003</xref>, <xref rid="btad688-B13" ref-type="bibr">Stevenson <italic toggle="yes">et al.</italic> 2016</xref>) (<xref rid="btad688-F3" ref-type="fig">Fig. 3A</xref>). Interpolating this curve, we can convert an OD measurement to the corresponding dilution factor and so correct for any nonlinearity between the OD and cell numbers.</p>
      <fig position="float" id="btad688-F3">
        <label>Figure 3.</label>
        <caption>
          <p>The nunchaku algorithm gives intuitive results when applied to biological data. (A) The calibration curve for plate-reader measurements of the OD of <italic toggle="yes">S.cerevisiae</italic>, found by diluting an overnight culture in 2% fructose, is nonlinear (blue dots). There are three replicate measurements for each dilution factor. Our algorithm identifies two linear segments (boundaries marked as circles). Lighter orange circles bound the segment with the highest <italic toggle="yes">R</italic><sup>2</sup>. We specify the likely maximal range of OD as our prior: <inline-formula id="IE112"><mml:math id="IM112" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. Inset: the logarithm of the model evidence for the number of segments. (B) Identifying contiguous linear segments in the logarithm of the OD of growing <italic toggle="yes">E.coli</italic> cells as a function of time allows us to identify automatically the region of exponential growth. We show the mean of four replicate measurements (blue) with twice their standard deviation shaded. Circles denote the boundaries of linear segments; orange circles bound the segment with the best-fit line with highest gradient and so highest specific growth rate. The average specific growth rate over this segment is 1.5 h<sup>–1</sup>. Inset: the logarithm of the model evidence for the number of segments. (C) With our algorithm, we can automatically identify the region of exponential growth in multiple datasets, here 38, to reveal growth laws such as Monod’s equation. We plot the specific growth rate in log phase for <italic toggle="yes">S.cerevisiae</italic> as a function of the concentration of fructose, with the solid line a fit of Monod’s equation: <inline-formula id="IE113"><mml:math id="IM113" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.422</mml:mn><mml:mo>±</mml:mo><mml:mn>0.006</mml:mn></mml:mrow></mml:math></inline-formula> h<sup>–1</sup> and <inline-formula id="IE114"><mml:math id="IM114" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.026</mml:mn><mml:mo>±</mml:mo><mml:mn>0.002</mml:mn></mml:mrow></mml:math></inline-formula>% (w/v). The shaded area shows the 95% confidence interval. Inset: three example growth curves with dots marking the region of exponential growth, identified as the segment with the highest gradient. For panels (B) and (C), we specify a prior on the range of the gradient: <inline-formula id="IE115"><mml:math id="IM115" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> h<sup>–1</sup>.</p>
        </caption>
        <graphic xlink:href="btad688f3" position="float"/>
      </fig>
      <p>Dilution factors, however, are not intuitive units, and it is useful to identify the range of ODs over which there is a linear relationship with cell numbers. Not only is this range itself important, but by using the ratio of the maximum of the range to the corresponding dilution factor, we can re-scale the dilution factors back into ODs.</p>
      <p>We used the <monospace>nunchaku</monospace> algorithm to identify the linear range, using basis functions that generate straight lines and an unknown measurement error. Two linear segments are optimal, and the one of interest, where OD is proportional to the number of cells, is the segment beginning at the smallest OD. This segment also has the highest coefficient of determination <italic toggle="yes">R</italic><sup>2</sup>. Its maximal OD is 0.66 for a relative cell number of 0.25 (<xref rid="btad688-F3" ref-type="fig">Fig. 3A</xref>), and we should therefore multiply the dilution factors by 0.66/0.25, or 2.6, to convert back to ODs.</p>
    </sec>
    <sec>
      <title>3.4 Application 2: identifying the log phase of microbial growth</title>
      <p>Microbes are most often studied when growing exponentially, with the <inline-formula id="IE116"><mml:math id="IM116" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>OD</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of the culture increasing linearly with time (<xref rid="btad688-B7" ref-type="bibr">Monod 1949</xref>). Researchers identify this log-phase growth from microbial growth curves.</p>
      <p>To detect log phase automatically, we applied <monospace>nunchaku</monospace>, again with basis functions generating lines, to OD measurements of <italic toggle="yes">E.coli</italic> (<xref rid="btad688-F3" ref-type="fig">Fig. 3B</xref>). Partitioning the data into six segments is optimal, and the segment whose best-fit line has the highest gradient—the greatest specific growth rate—corresponds to exponential growth.</p>
      <p>Monod noticed an empirical relationship between the nutrient concentration and the specific growth rate of microbes in log phase (<xref rid="btad688-B7" ref-type="bibr">Monod 1949</xref>). Denoting this growth rate as <italic toggle="yes">λ</italic>, the maximal specific growth rate as <inline-formula id="IE117"><mml:math id="IM117" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and the nutrient concentration as <italic toggle="yes">s</italic>, his equation becomes</p>
      <disp-formula id="E28">
        <label>(28)</label>
        <mml:math id="M28" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mo>λ</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>λ</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>max</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:mfrac>
                <mml:mi>s</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <italic toggle="yes">K<sub>M</sub></italic> is now called the Monod constant. To estimate <inline-formula id="IE118"><mml:math id="IM118" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">K<sub>M</sub></italic>, researchers systematically vary the concentration of the carbon source and identify the log phase and the corresponding gradient for each growth curve.</p>
      <p>Here, we use the <monospace>nunchaku</monospace> algorithm to select data to estimate <inline-formula id="IE119"><mml:math id="IM119" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">K<sub>M</sub></italic> for <italic toggle="yes">S.cerevisiae</italic> growing on fructose (Section 2), from 38 growth curves measured with plate readers (<xref rid="btad688-F3" ref-type="fig">Fig. 3C</xref>). Each biological replicate has two technical replicates.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Determining where data are best described by a line is a problem familiar to most scientists. We present a statistically rigorous solution, which we generalize by considering linear combinations of arbitrary basis functions. Our methodology is Bayesian and similar in approach to earlier work that focused on piece-wise constant functions (<xref rid="btad688-B5" ref-type="bibr">Hutter 2007</xref>).</p>
    <p>Like all Bayesian inference, our algorithm depends on prior information: the bounds on the coefficients constituting the linear combination of basis functions. For basis functions generating lines, these bounds describe the range of the gradients and intercepts of all possible lines within a segment. The optimal number of segments will depend on this prior if the amount of data is sufficiently small, as it should (<xref rid="btad688-B6" ref-type="bibr">MacKay 2003</xref>). In practice, however, users interested in lines need specify only one prior range with the other inferred (Section 2), and we see that although a wide prior favours fewer segments, a single segment is robustly assigned to sections of the data that appear linear.</p>
    <p>Our method makes two assumptions about how the data deviate from a linear combination of basis functions. We assume these deviations are independent and we assume that each deviation obeys a normal distribution. For some data, a distribution with a purely nonnegative support, such as a log normal, may be more appropriate. Although we can use such a distribution in principle, in practice some of the steps that we performed analytically would have to become numerical. Further, if nothing is known <italic toggle="yes">a priori</italic> about these deviations, we assume that their standard deviation is identical for all time points. Our algorithm would work too if the standard deviations vary but are proportional to a known function of <italic toggle="yes">x<sub>j</sub></italic> and <italic toggle="yes">y<sub>j</sub></italic>.</p>
    <p>Our work adds to existing algorithms for detecting change points in time series, including those aimed at analyzing microbial growth (<xref rid="btad688-B10" ref-type="bibr">Papastamoulis <italic toggle="yes">et al.</italic> 2019</xref>). We have simplified this problem by considering change points to occur only at data points and by imposing no continuity between the functions underlying the data for each segment. These simplifications are not restrictive for our task of finding one particular segment of interest. Identifying change points more generally typically requires Markov chain Monte Carlo methods (<xref rid="btad688-B12" ref-type="bibr">Stephens 1994</xref>, <xref rid="btad688-B10" ref-type="bibr">Papastamoulis <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>The <monospace>nunchaku</monospace> algorithm by using enumeration is robust and lends itself to automation, facilitating high throughput studies. It should both ease and increase the reproducibility of data analyses for a wide range of scientists.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad688_Supplementary_Data</label>
      <media xlink:href="btad688_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Ramon Grima and Edward WJ Wallace for helpful comments and the Biotechnology and Biological Sciences Research Council (P.S.S. and Y.H.) and the Darwin Trust (Y.H. and X.D.) for funding.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <ext-link xlink:href="https://datashare.ed.ac.uk/handle/10283/2002" ext-link-type="uri">datashare.ed.ac.uk/handle/10283/2002</ext-link>.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This research was funded in whole, or in part, by the Biotechnology and Biological Sciences Research Council [BB/W006545/1]. For the purpose of open access, the authors have applied a creative commons attribution (CC BY) licence to any author accepted manuscript version arising.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article are available in Edinburgh DataShare at <ext-link xlink:href="https://doi.org/10.7488/ds/7548" ext-link-type="uri">https://doi.org/10.7488/ds/7548</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad688-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baranowski</surname><given-names>R</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y</given-names></string-name>, <string-name><surname>Fryzlewicz</surname><given-names>P.</given-names></string-name></person-group><article-title>Narrowest-over-threshold detection of multiple change points and change-point-like features</article-title>. <source>J R Stat Soc Series B Stat Methodol</source><year>2019</year>;<volume>81</volume>:<fpage>649</fpage>–<lpage>72</lpage>.</mixed-citation>
    </ref>
    <ref id="btad688-B2">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Bishop</surname><given-names>CM.</given-names></string-name></person-group><source>Pattern Recognition and Machine Learning</source>. <publisher-name>Berlin, Germany</publisher-name>: Springer, <year>2006</year>.</mixed-citation>
    </ref>
    <ref id="btad688-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gelman</surname><given-names>A.</given-names></string-name></person-group><article-title>Prior distributions for variance parameters in hierarchical models</article-title>. <source>Bayesian Anal</source><year>2006</year>;<volume>1</volume>:<fpage>515</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="btad688-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hinrichsen</surname><given-names>M</given-names></string-name>, <string-name><surname>Lenz</surname><given-names>M</given-names></string-name>, <string-name><surname>Edwards</surname><given-names>JM</given-names></string-name></person-group><etal>et al</etal><article-title>A new method for post-translationally labeling proteins in live cells for fluorescence imaging and tracking</article-title>. <source>Protein Eng Des Sel</source><year>2017</year>;<volume>30</volume>:<fpage>771</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">29228311</pub-id></mixed-citation>
    </ref>
    <ref id="btad688-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hutter</surname><given-names>M.</given-names></string-name></person-group><article-title>Exact Bayesian regression of piecewise constant functions</article-title>. <source>Bayesian Anal</source><year>2007</year>;<volume>2</volume>:<fpage>635</fpage>–<lpage>64</lpage>.</mixed-citation>
    </ref>
    <ref id="btad688-B6">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>MacKay</surname><given-names>DJ.</given-names></string-name></person-group><source>Information Theory, Inference and Learning Algorithms</source>. Cambridge, UK: <publisher-name>Cambridge University Press</publisher-name>, <year>2003</year>.</mixed-citation>
    </ref>
    <ref id="btad688-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Monod</surname><given-names>J.</given-names></string-name></person-group><article-title>The growth of bacterial cultures</article-title>. <source>Annu Rev Microbiol</source><year>1949</year>;<volume>3</volume>:<fpage>371</fpage>–<lpage>94</lpage>.</mixed-citation>
    </ref>
    <ref id="btad688-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Montaño-Gutierrez</surname><given-names>LF</given-names></string-name>, <string-name><surname>Moreno</surname><given-names>NM</given-names></string-name>, <string-name><surname>Farquhar</surname><given-names>IL</given-names></string-name></person-group><etal>et al</etal><article-title>Analysing and meta-analysing time-series data of microbial growth and gene expression from plate readers</article-title>. <source>PLoS Comput Biol</source><year>2022</year>;<volume>18</volume>:<fpage>e1010138</fpage>.<pub-id pub-id-type="pmid">35617352</pub-id></mixed-citation>
    </ref>
    <ref id="btad688-B9">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Moses</surname><given-names>AM.</given-names></string-name></person-group><source>Statistical Modelling and Machine Learning for Molecular Biology</source>. <publisher-name>Boca Raton, FL</publisher-name>: CRC Press. <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="btad688-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Papastamoulis</surname><given-names>P</given-names></string-name>, <string-name><surname>Furukawa</surname><given-names>T</given-names></string-name>, <string-name><surname>Van Rhijn</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>Bayesian detection of piecewise linear trends in replicated time-series with application to growth data modelling</article-title>. <source>Int J Biostat</source><year>2019</year>;<volume>16</volume>:<fpage>20180052</fpage>.</mixed-citation>
    </ref>
    <ref id="btad688-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scott</surname><given-names>M</given-names></string-name>, <string-name><surname>Hwa</surname><given-names>T.</given-names></string-name></person-group><article-title>Shaping bacterial gene expression by physiological and proteome allocation constraints</article-title>. <source>Nat Rev Microbiol</source><year>2023</year>;<volume>21</volume>:<fpage>327</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">36376406</pub-id></mixed-citation>
    </ref>
    <ref id="btad688-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stephens</surname><given-names>DA.</given-names></string-name></person-group><article-title>Bayesian retrospective multiple-changepoint identification</article-title>. <source>J R Stat Soc Ser C Appl Stat</source><year>1994</year>;<volume>43</volume>:<fpage>159</fpage>–<lpage>78</lpage>.</mixed-citation>
    </ref>
    <ref id="btad688-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stevenson</surname><given-names>K</given-names></string-name>, <string-name><surname>McVey</surname><given-names>AF</given-names></string-name>, <string-name><surname>Clark</surname><given-names>IB</given-names></string-name></person-group><etal>et al</etal><article-title>General calibration of microbial growth in microplate readers</article-title>. <source>Sci Rep</source><year>2016</year>;<volume>6</volume>:<fpage>38828</fpage>.<pub-id pub-id-type="pmid">27958314</pub-id></mixed-citation>
    </ref>
    <ref id="btad688-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Verduyn</surname><given-names>C</given-names></string-name>, <string-name><surname>Postma</surname><given-names>E</given-names></string-name>, <string-name><surname>Scheffers</surname><given-names>WA</given-names></string-name></person-group><etal>et al</etal><article-title>Effect of benzoic acid on metabolic fluxes in yeasts</article-title>. <source>Yeast</source><year>1992</year>;<volume>8</volume>:<fpage>501</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">1523884</pub-id></mixed-citation>
    </ref>
    <ref id="btad688-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Warringer</surname><given-names>J</given-names></string-name>, <string-name><surname>Blomberg</surname><given-names>A.</given-names></string-name></person-group><article-title>Automated screening in environmental arrays allows analysis of quantitative phenotypic profiles in <italic toggle="yes">Saccharomyces cerevisiae</italic></article-title>. <source>Yeast</source><year>2003</year>;<volume>20</volume>:<fpage>53</fpage>–<lpage>67</lpage>.<pub-id pub-id-type="pmid">12489126</pub-id></mixed-citation>
    </ref>
    <ref id="btad688-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>NL</given-names></string-name>, <string-name><surname>Poole</surname><given-names>D.</given-names></string-name></person-group><article-title>Exploiting causal independence in Bayesian network inference</article-title>. <source>JAIR</source><year>1996</year>;<volume>5</volume>:<fpage>301</fpage>–<lpage>28</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10697733</article-id>
    <article-id pub-id-type="pmid">37966918</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad688</article-id>
    <article-id pub-id-type="publisher-id">btad688</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Nunchaku: optimally partitioning data into piece-wise contiguous segments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7427-3007</contrib-id>
        <name>
          <surname>Huo</surname>
          <given-names>Yu</given-names>
        </name>
        <aff><institution>Centre for Engineering Biology, University of Edinburgh</institution>, Edinburgh EH9 3BF, <country country="GB">United Kingdom</country></aff>
        <aff><institution>School of Biological Sciences, University of Edinburgh</institution>, Edinburgh EH9 3BF, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Hongpei</given-names>
        </name>
        <aff><institution>School of Biological Sciences, University of Edinburgh</institution>, Edinburgh EH9 3BF, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xiao</given-names>
        </name>
        <aff><institution>School of Biological Sciences, University of Edinburgh</institution>, Edinburgh EH9 3BF, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Xiaochen</given-names>
        </name>
        <aff><institution>School of Biological Sciences, University of Edinburgh</institution>, Edinburgh EH9 3BF, <country country="GB">United Kingdom</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7489-8587</contrib-id>
        <name>
          <surname>Swain</surname>
          <given-names>Peter S</given-names>
        </name>
        <aff><institution>Centre for Engineering Biology, University of Edinburgh</institution>, Edinburgh EH9 3BF, <country country="GB">United Kingdom</country></aff>
        <aff><institution>School of Biological Sciences, University of Edinburgh</institution>, Edinburgh EH9 3BF, <country country="GB">United Kingdom</country></aff>
        <xref rid="btad688-cor1" ref-type="corresp"/>
        <!--peter.swain@ed.ac.uk-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Martelli</surname>
          <given-names>Pier Luigi</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad688-cor1">Corresponding author. Centre for Engineering Biology, University of Edinburgh, Mayfield Road, Edinburgh EH9 3BF, United Kingdom. E-mail: <email>peter.swain@ed.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>12</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-11-15">
      <day>15</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>11</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>12</issue>
    <elocation-id>btad688</elocation-id>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>6</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>06</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>08</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>11</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>05</day>
        <month>12</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad688.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>When analyzing 1D time series, scientists are often interested in identifying regions where one variable depends linearly on the other. Typically, they use an <italic toggle="yes">ad hoc</italic> and therefore often subjective method to do so.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we develop a statistically rigorous, Bayesian approach to infer the optimal partitioning of a dataset not only into contiguous piece-wise linear segments, but also into contiguous segments described by linear combinations of arbitrary basis functions. We therefore present a general solution to the problem of identifying discontinuous change points. Focusing on microbial growth, we use the algorithm to find the range of optical density where this density is linearly proportional to the number of cells and to automatically find the regions of exponential growth for both <italic toggle="yes">Escherichia coli</italic> and <italic toggle="yes">Saccharomyces cerevisiae</italic>. For budding yeast, we consequently are able to infer the Monod constant for growth on fructose. Our algorithm lends itself to automation and high throughput studies, increases reproducibility, and should facilitate data analyses for a broad range of scientists.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The corresponding Python package, entitled Nunchaku, is available at PyPI: <ext-link xlink:href="https://pypi.org/project/nunchaku" ext-link-type="uri">https://pypi.org/project/nunchaku</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Biotechnology and Biological Sciences Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000268</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>BB/W006545/1</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>A common scientific problem is understanding the relationship between two variables. When the dependent variable, or some transformation of it, depends linearly on the independent variable, the underlying system linking the two often behaves more simply than generally. As a consequence, scientists commonly focus their efforts on identifying and understanding this linear regime.</p>
    <p>A well-known example is the growth of a population of cells. In log phase, when the logarithm of the number of cells increases linearly with time, the total mass of every intracellular component grows exponentially and the mass per cell is approximately constant. Such steady-state conditions regularize growth; metabolic fluxes are balanced; and physiology simplifies, generating behaviours controlled by only a handful of variables (<xref rid="btad688-B11" ref-type="bibr">Scott and Hwa 2023</xref>).</p>
    <p>Biologists therefore often wish to determine when growth is in log phase. Historically the approach has been to plot the logarithm of a variable correlating with the number of cells, such as optical density (OD), against time and to identify a linear region by eye (<xref rid="btad688-B7" ref-type="bibr">Monod 1949</xref>). Today this subjective technique is still used, with one scientist’s linear region not necessarily the same as another’s.</p>
    <p>A challenge to developing objective approaches is identifying a suitable nonlinear model with which to compare the linear one. There is no general way to describe all relationships that we may observe. With a mechanistic understanding, we might generate a nonlinear description, but such an understanding is often lacking and, anyhow, may obviate the need to find linear regimes.</p>
    <p>Here, we circumvent this problem by inferring the piece-wise linear description that best approximates an entire 1D time series. By doing so, we reframe the task to one of detecting change points—time points where the process generating the time series changes, a well-studied problem (<xref rid="btad688-B12" ref-type="bibr">Stephens 1994</xref>) with an established frequentist solution (<xref rid="btad688-B1" ref-type="bibr">Baranowski <italic toggle="yes">et al.</italic> 2019</xref>). We use a Bayesian approach, complementing others (<xref rid="btad688-B5" ref-type="bibr">Hutter 2007</xref>, <xref rid="btad688-B10" ref-type="bibr">Papastamoulis <italic toggle="yes">et al.</italic> 2019</xref>), and generalize by allowing each segment of data to be described by a linear combination of arbitrary basis functions, with straight lines being but one example. For a given set of basis functions, we compare the evidence for every possible piece-wise linear combination, found by marginalizing over all possible fits to all possible contiguous subdivisions of the data. For linear segments and for the optimal choice of segments, we provide statistics for each segment, allowing users to select straightforwardly the segment or segments of most interest. To illustrate our algorithm, we primarily discuss two examples: determining the range of OD of a liquid culture where the OD depends linearly on the number of cells and finding the exponential phases of microbial growth curves.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Inferring contiguous regions using model comparison</title>
      <p>Given 1D time-series data and a set of <italic toggle="yes">K</italic> basis functions, we wish to divide the data into the group of contiguous segments that is best characterized by piece-wise linear combinations of the basis functions. Irrespective of the data’s behaviour, we will always find such a group. Our approach answers two questions: how many piece-wise contiguous segments best describe the data given the basis functions and where the optimal segment boundaries lie.</p>
      <p>Let us assume that we have observations, <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">j</italic> runs from 1 to <italic toggle="yes">N</italic> and the <italic toggle="yes">x<sub>j</sub></italic> are in ascending order; <italic toggle="yes">r</italic> indexes the <italic toggle="yes">N<sub>r</sub></italic> replicates if any. We denote these observations collectively as <italic toggle="yes">D</italic>.</p>
      <p>First, we consider whether we should divide the data into <italic toggle="yes">M</italic> or <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> segments, using Bayesian model comparison (<xref rid="btad688-B6" ref-type="bibr">MacKay 2003</xref>). Assuming equal prior probabilities, <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we write the Bayes’ factor as:</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M1" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>′</mml:mo>
                  <mml:mo>|</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>′</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>′</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>′</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>and therefore we should determine the evidence <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for each <italic toggle="yes">M</italic>.</p>
      <p>The evidence is a marginal likelihood. For <italic toggle="yes">M</italic> contiguous segments, there are <italic toggle="yes">M–</italic>1 unknown boundary points, which we denote as <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>≡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>&lt;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. These points are integers and index an <italic toggle="yes">x<sub>j</sub></italic>. The two remaining boundaries are the indices for the first and last <italic toggle="yes">x</italic> values: 1 and <italic toggle="yes">N</italic>. We assume that each segment contains a minimal number of data points <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, so that <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. The choice of <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> depends on the type and number of basis functions: in general, <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      <p>The evidence is a sum over all potential <bold><italic toggle="yes">n</italic></bold>:</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M2" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>D</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mi>M</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mi mathvariant="bold-italic">n</mml:mi>
                  </mml:munder>
                </mml:mrow>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>D</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mi mathvariant="bold-italic">n</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>M</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi mathvariant="bold-italic">n</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mi>M</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo>=</mml:mo>
                <mml:mi>f</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>M</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>ℓ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>min</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mrow>
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mi mathvariant="bold-italic">n</mml:mi>
                  </mml:munder>
                </mml:mrow>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>D</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mi mathvariant="bold-italic">n</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>M</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where we use that any permissible <italic toggle="yes">n<sub>i</sub></italic> is equally likely as any other to write the prior <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as a function of <italic toggle="yes">N</italic>, <italic toggle="yes">M</italic>, and <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Specifically, this bounded uniform prior is the reciprocal of the number of possible <bold><italic toggle="yes">n</italic></bold>, which satisfy</p>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M3" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>n</mml:mi>
                </mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mo>≥</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>ℓ</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>min</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mo> </mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>n</mml:mi>
                </mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mo>≥</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>n</mml:mi>
                </mml:mrow>
                <mml:mn>1</mml:mn>
              </mml:msub>
            </mml:mrow>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>ℓ</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>min</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mo>…</mml:mo>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>n</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>M</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>≥</mml:mo>
            <mml:mi>N</mml:mi>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>ℓ</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>min</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>for a given <italic toggle="yes">M</italic> and <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We therefore have:</p>
      <disp-formula id="E4">
        <label>(4)</label>
        <mml:math id="M4" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi mathvariant="bold-italic">n</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mi>M</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo> </mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mo> </mml:mo>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:mrow>
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo> </mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ℓ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>min</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>M</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ℓ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>min</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:munderover>
                </mml:mrow>
                <mml:mo>×</mml:mo>
                <mml:mrow>
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo> </mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ℓ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>min</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>M</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ℓ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>min</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:munderover>
                </mml:mrow>
                <mml:mo>×</mml:mo>
                <mml:mo>⋯</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo>×</mml:mo>
                <mml:mrow>
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo> </mml:mo>
                      <mml:mo>=</mml:mo>
                      <mml:mo> </mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ℓ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>min</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>ℓ</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>min</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:munderover>
                </mml:mrow>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="false">]</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo> </mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mo> </mml:mo>
                <mml:mi>f</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>M</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>ℓ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>min</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>.</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>Second, for a given <italic toggle="yes">M</italic> and <bold><italic toggle="yes">n</italic></bold>, we fit the data to <italic toggle="yes">M</italic> different linear combinations of the basis functions, one for each segment, with each combination independent of the other. The linear combination ending near the data points indexed by <italic toggle="yes">n<sub>i</sub></italic> and <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> depends only on the data indexed by the indices <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> inclusively, denoted <italic toggle="yes">D<sub>i</sub></italic>, and this data does not determine any other linear combination. Therefore, mathematically,</p>
      <disp-formula id="E5">
        <label>(5)</label>
        <mml:math id="M5" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>D</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:mi mathvariant="bold-italic">n</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>×</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>×</mml:mo>
                <mml:mo>⋯</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo>×</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>M</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the likelihood of a linear combination of the basis functions describing the data indexed by <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      <sec>
        <title>2.1.1 Finding <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:msub></mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></title>
        <p>For each segment of the data, we consider the <italic toggle="yes">K</italic> basis functions, each individually denoted <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo mathvariant="bold">ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and collectively <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mi>ϕ</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, and correspondingly <italic toggle="yes">K</italic> coefficients, each denoted <italic toggle="yes">m<sub>k</sub></italic>. If fitting lines, we have two basis functions: <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, and two <italic toggle="yes">m<sub>k</sub></italic> where <italic toggle="yes">m</italic><sub>1</sub> determines the line’s <italic toggle="yes">y</italic>-intercept and <italic toggle="yes">m</italic><sub>2</sub> its gradient. We then set <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> so that there are sufficient data points in each segment to define a line.</p>
        <p>We let <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> describe how a data point <italic toggle="yes">y<sub>j</sub></italic> at <italic toggle="yes">x<sub>j</sub></italic> deviates from the linear combination of basis functions and assume that this deviation is independent of the deviations of other data points.</p>
        <p>For the <italic toggle="yes">i</italic>th segment, we then have</p>
        <disp-formula id="E6">
          <label>(6)</label>
          <mml:math id="M6" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>D</mml:mi>
                          </mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>|</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mo>∫</mml:mo>
                    <mml:mi>d</mml:mi>
                  </mml:mrow>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo> </mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo>∏</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:munderover>
                    </mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mi>j</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>r</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mrow>
                    <mml:mo>∫</mml:mo>
                    <mml:mi>d</mml:mi>
                  </mml:mrow>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo> </mml:mo>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>r</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo>∏</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>n</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:munderover>
                    </mml:mrow>
                    <mml:mi>P</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mi>y</mml:mi>
                      </mml:mrow>
                      <mml:mi>j</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>r</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                      </mml:mrow>
                      <mml:mi>j</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>assuming the prior <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a constant, with each <italic toggle="yes">m<sub>k</sub></italic> independently and uniformly distributed in some bounded region so that</p>
        <disp-formula id="E7">
          <label>(7)</label>
          <mml:math id="M7" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi mathvariant="bold-italic">m</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mo>{</mml:mo>
                <mml:mrow>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mn>1</mml:mn>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>m</mml:mi>
                                    </mml:mrow>
                                    <mml:mn>1</mml:mn>
                                    <mml:mrow>
                                      <mml:mtext>max</mml:mtext>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>m</mml:mi>
                                    </mml:mrow>
                                    <mml:mn>1</mml:mn>
                                    <mml:mrow>
                                      <mml:mtext>min</mml:mtext>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                                <mml:mo>⋯</mml:mo>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>m</mml:mi>
                                    </mml:mrow>
                                    <mml:mi>K</mml:mi>
                                    <mml:mrow>
                                      <mml:mtext>max</mml:mtext>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo>−</mml:mo>
                                <mml:mrow>
                                  <mml:msubsup>
                                    <mml:mrow>
                                      <mml:mi>m</mml:mi>
                                    </mml:mrow>
                                    <mml:mi>K</mml:mi>
                                    <mml:mrow>
                                      <mml:mtext>min</mml:mtext>
                                    </mml:mrow>
                                  </mml:msubsup>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mtext>for</mml:mtext>
                          <mml:mo> </mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>∈</mml:mo>
                          <mml:mo stretchy="false">[</mml:mo>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mrow>
                                <mml:mtext>min</mml:mtext>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                          <mml:mo>,</mml:mo>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi>m</mml:mi>
                              </mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mrow>
                                <mml:mtext>max</mml:mtext>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                          <mml:mo stretchy="false">]</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mn>0</mml:mn>
                          <mml:mo> </mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mtext>otherwise</mml:mtext>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>for fixed <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> for all <italic toggle="yes">k</italic>.</p>
      </sec>
      <sec>
        <title>2.1.2 Marginalizing <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></title>
        <p>Using <xref rid="E5" ref-type="disp-formula">Equation (5)</xref>, we factorize the sum in <xref rid="E2" ref-type="disp-formula">Equation (2)</xref>:</p>
        <disp-formula id="E8">
          <label>(8)</label>
          <mml:math id="M8" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi mathvariant="bold-italic">n</mml:mi>
                    </mml:munder>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mo stretchy="false">)</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>×</mml:mo>
                  <mml:mo>⋯</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>3</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>3</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mtext>min</mml:mtext>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>and use the method of variable elimination (<xref rid="btad688-B16" ref-type="bibr">Zhang and Poole 1996</xref>) to evaluate these sums. First we perform the rightmost one, over <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, to generate a function of <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We then perform the next rightmost sum, over <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, of this function and the next term in <xref rid="E8" ref-type="disp-formula">Equation (8)</xref>, which generates a function of <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. We repeat this process until we reach the leftmost sum over <italic toggle="yes">n</italic><sub>1</sub>, enabling <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> operations in total instead of <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We evaluate <xref rid="E4" ref-type="disp-formula">Equation (4)</xref> similarly.</p>
        <p>All that remains is to determine <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> so that we can find <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> via <xref rid="E2" ref-type="disp-formula">Equation (2)</xref> and <xref rid="E8" ref-type="disp-formula">Equation (8)</xref>.</p>
      </sec>
      <sec>
        <title>2.1.3 Finding <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for known measurement error</title>
        <p>To proceed, we assume that <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a normal distribution with mean <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mi mathvariant="bold">ϕ</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:math></inline-formula>, or equivalently <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and a standard deviation <italic toggle="yes">σ<sub>j</sub></italic>. If we know the <italic toggle="yes">σ<sub>j</sub></italic>, e.g. by approximating each by the corresponding measurement error, then <xref rid="E6" ref-type="disp-formula">Equation (6)</xref>, the likelihood of a linear combination describing the data indexed by <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, becomes</p>
        <disp-formula id="E9">
          <label>(9)</label>
          <mml:math id="M9" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>n</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>n</mml:mi>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">σ</mml:mi>
                  <mml:mo>)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo>)</mml:mo>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>n</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:msqrt>
                          <mml:mn>2</mml:mn>
                          <mml:mo>π</mml:mo>
                        </mml:msqrt>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mo>σ</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>N</mml:mi>
                            <mml:mi>r</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mo>∫</mml:mo>
                  <mml:mi>d</mml:mi>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo> </mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>r</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>N</mml:mi>
                            <mml:mi>r</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:munderover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:munderover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>[</mml:mo>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mi>y</mml:mi>
                                  <mml:mi>j</mml:mi>
                                  <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mi>r</mml:mi>
                                    <mml:mo>)</mml:mo>
                                  </mml:mrow>
                                </mml:msubsup>
                              </mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:mi mathvariant="bold">ϕ</mml:mi>
                              <mml:mrow>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mi>x</mml:mi>
                                        <mml:mi>j</mml:mi>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mo>)</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>T</mml:mi>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mi mathvariant="bold-italic">m</mml:mi>
                              <mml:mo>]</mml:mo>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mo>σ</mml:mo>
                              <mml:mi>j</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>To evaluate the integral, we extend it to infinite range for all <italic toggle="yes">m<sub>k</sub>—</italic>a suitable approximation because we expect the integrand to be strongly peaked at the most likely values of each <italic toggle="yes">m<sub>k</sub></italic> (<xref rid="btad688-B6" ref-type="bibr">MacKay 2003</xref>). We can then perform the integration analytically.</p>
        <p>Consider data with a single replicate. Define <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to be the number of <italic toggle="yes">x</italic> values in the <italic toggle="yes">i</italic>th segment and <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to be a vector with components <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, with the superscript <italic toggle="yes">i</italic> used to denote the <italic toggle="yes">i</italic>th segment. Let <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:mo>Φ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> matrix with components <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and further defining</p>
        <disp-formula id="E10">
          <label>(10)</label>
          <mml:math id="M10" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>A</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mo>Φ</mml:mo>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>Φ</mml:mo>
                          </mml:mrow>
                          <mml:mi>T</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>;</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mover accent="true">
                                    <mml:mi mathvariant="bold-italic">m</mml:mi>
                                    <mml:mo stretchy="false">¯</mml:mo>
                                  </mml:mover>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:msup>
                                      <mml:mrow>
                                        <mml:mi>A</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mo stretchy="false">(</mml:mo>
                                        <mml:mi>i</mml:mi>
                                        <mml:mo stretchy="false">)</mml:mo>
                                      </mml:mrow>
                                    </mml:msup>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mo>Φ</mml:mo>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi mathvariant="bold-italic">z</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>i</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>so that <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The matrix <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is a symmetric <italic toggle="yes">K </italic>×<italic toggle="yes"> K</italic> matrix, which is invertible when the basis functions <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are linearly independent and when <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>. Then standard algebra gives</p>
        <disp-formula id="E11">
          <label>(11)</label>
          <mml:math id="M11" display="block" overflow="scroll">
            <mml:mrow>
              <mml:munderover>
                <mml:mo>∑</mml:mo>
                <mml:mrow>
                  <mml:mi>j</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>n</mml:mi>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:munderover>
            </mml:mrow>
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>[</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mi mathvariant="bold">ϕ</mml:mi>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>x</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mi>T</mml:mi>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mi mathvariant="bold-italic">m</mml:mi>
                      <mml:mo>]</mml:mo>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msup>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mo>σ</mml:mo>
                      <mml:mi>j</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msubsup>
                  </mml:mrow>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:mfrac>
                <mml:mn>1</mml:mn>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mi mathvariant="bold-italic">m</mml:mi>
                          <mml:mo>¯</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mi>T</mml:mi>
              </mml:msup>
            </mml:mrow>
            <mml:mrow>
              <mml:msup>
                <mml:mi>A</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mi>i</mml:mi>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mo>(</mml:mo>
            <mml:mi mathvariant="bold-italic">m</mml:mi>
            <mml:mo>−</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mrow>
                  <mml:mover accent="true">
                    <mml:mi mathvariant="bold-italic">m</mml:mi>
                    <mml:mo>¯</mml:mo>
                  </mml:mover>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mi>i</mml:mi>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
            <mml:mo>)</mml:mo>
            <mml:mo>+</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>U</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mi>i</mml:mi>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>where</p>
        <disp-formula id="E12">
          <label>(12)</label>
          <mml:math id="M12" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mn>2</mml:mn>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>U</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi mathvariant="bold-italic">z</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mi>T</mml:mi>
                </mml:msup>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">z</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mo>−</mml:mo>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mi mathvariant="bold-italic">m</mml:mi>
                                        <mml:mo stretchy="false">¯</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mi>T</mml:mi>
                </mml:msup>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>A</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mover accent="true">
                            <mml:mi mathvariant="bold-italic">m</mml:mi>
                            <mml:mo stretchy="false">¯</mml:mo>
                          </mml:mover>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mo>.</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>Using <xref rid="E11" ref-type="disp-formula">Equation (11)</xref> and the results for integrating multivariate Gaussian distributions (<xref rid="btad688-B6" ref-type="bibr">MacKay 2003</xref>), we have that</p>
        <disp-formula id="E13">
          <label>(13)</label>
          <mml:math id="M13" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>∫</mml:mo>
                  <mml:mi>d</mml:mi>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo> </mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mrow>
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>n</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:munderover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>[</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>y</mml:mi>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:mi mathvariant="bold">ϕ</mml:mi>
                              <mml:mrow>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mi>x</mml:mi>
                                        <mml:mi>j</mml:mi>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mo>)</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>T</mml:mi>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mi mathvariant="bold-italic">m</mml:mi>
                              <mml:mo>]</mml:mo>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mo>σ</mml:mo>
                              <mml:mi>j</mml:mi>
                              <mml:mn>2</mml:mn>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mo>π</mml:mo>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mi>K</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mtext>det</mml:mtext>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mi>A</mml:mi>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mi>i</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mn>1</mml:mn>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mi mathvariant="normal">e</mml:mi>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mi>U</mml:mi>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mi>i</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>If we are fitting straight lines with <italic toggle="yes">K </italic>=<italic toggle="yes"> </italic>2 and <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, then it is useful to define (<xref rid="btad688-B4" ref-type="bibr">Hinrichsen <italic toggle="yes">et al.</italic> 2017</xref>)</p>
        <disp-formula id="E14">
          <label>(14)</label>
          <mml:math id="M14" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:munder>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>y</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo>σ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>;</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:munder>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo>σ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:mrow>
                          <mml:mn>3</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:munder>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mn>1</mml:mn>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo>σ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>;</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:mrow>
                          <mml:mn>4</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:munder>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>y</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo>σ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:mrow>
                          <mml:mn>5</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:munder>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>y</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo>σ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>;</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>T</mml:mi>
                          </mml:mrow>
                          <mml:mn>6</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:munder>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msubsup>
                                  <mml:mrow>
                                    <mml:mo>σ</mml:mo>
                                  </mml:mrow>
                                  <mml:mi>j</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:msubsup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>with <italic toggle="yes">j</italic> running from <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Using these definitions,</p>
        <disp-formula id="E15">
          <label>(15)</label>
          <mml:math id="M15" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>A</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:mo stretchy="true">(</mml:mo>
                            <mml:mrow>
                              <mml:mtable>
                                <mml:mtr>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mi>T</mml:mi>
                                          </mml:mrow>
                                          <mml:mn>3</mml:mn>
                                        </mml:msub>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:mtd>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mi>T</mml:mi>
                                          </mml:mrow>
                                          <mml:mn>6</mml:mn>
                                        </mml:msub>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:mtd>
                                </mml:mtr>
                                <mml:mtr>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mi>T</mml:mi>
                                          </mml:mrow>
                                          <mml:mn>6</mml:mn>
                                        </mml:msub>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:mtd>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:mn>2</mml:mn>
                                      <mml:mrow>
                                        <mml:msub>
                                          <mml:mrow>
                                            <mml:mi>T</mml:mi>
                                          </mml:mrow>
                                          <mml:mn>2</mml:mn>
                                        </mml:msub>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:mtd>
                                </mml:mtr>
                              </mml:mtable>
                            </mml:mrow>
                            <mml:mo stretchy="true">)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mo>;</mml:mo>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mi mathvariant="bold-italic">m</mml:mi>
                                        <mml:mo stretchy="true">¯</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                          <mml:mo>=</mml:mo>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mtable>
                                <mml:mtr>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mfrac>
                                          <mml:mrow>
                                            <mml:mn>2</mml:mn>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>2</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>4</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mo>−</mml:mo>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>5</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>6</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mn>4</mml:mn>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>2</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>3</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mo>−</mml:mo>
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>6</mml:mn>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mfrac>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:mtd>
                                </mml:mtr>
                                <mml:mtr>
                                  <mml:mtd>
                                    <mml:mrow>
                                      <mml:mrow>
                                        <mml:mfrac>
                                          <mml:mrow>
                                            <mml:mn>2</mml:mn>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>3</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>5</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mo>−</mml:mo>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>4</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>6</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                          </mml:mrow>
                                          <mml:mrow>
                                            <mml:mn>4</mml:mn>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>2</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mrow>
                                              <mml:msub>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>3</mml:mn>
                                              </mml:msub>
                                            </mml:mrow>
                                            <mml:mo>−</mml:mo>
                                            <mml:mrow>
                                              <mml:msubsup>
                                                <mml:mrow>
                                                  <mml:mi>T</mml:mi>
                                                </mml:mrow>
                                                <mml:mn>6</mml:mn>
                                                <mml:mrow>
                                                  <mml:mn>2</mml:mn>
                                                </mml:mrow>
                                              </mml:msubsup>
                                            </mml:mrow>
                                          </mml:mrow>
                                        </mml:mfrac>
                                      </mml:mrow>
                                    </mml:mrow>
                                  </mml:mtd>
                                </mml:mtr>
                              </mml:mtable>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd>
                        <mml:mrow/>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>U</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>T</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>4</mml:mn>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>5</mml:mn>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>4</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>5</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>6</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>4</mml:mn>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>3</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mrow>
                              <mml:mi>T</mml:mi>
                            </mml:mrow>
                            <mml:mn>6</mml:mn>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msubsup>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>and the integral becomes <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>π</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mn>6</mml:mn><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
        <p>With more than one replicate, <bold><italic toggle="yes">z</italic></bold> runs over all <italic toggle="yes">y</italic> in all replicates, with the replicates arranged contiguously, and is of length <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>; <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mo>Φ</mml:mo></mml:math></inline-formula> has rows of length <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi>r</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> repeated <italic toggle="yes">N<sub>r</sub></italic> times in each row to match the corresponding <italic toggle="yes">y</italic> values. For the linear case, the sums in <xref rid="E14" ref-type="disp-formula">Equation (14)</xref> are over both <italic toggle="yes">j</italic> and the number of replicates, so that <italic toggle="yes">T</italic><sub>1</sub>, e.g., becomes <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
        <p>Returning to <xref rid="E9" ref-type="disp-formula">Equation (9)</xref>, we find</p>
        <disp-formula id="E16">
          <label>(16)</label>
          <mml:math id="M16" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">σ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:munderover>
                          <mml:mo>∏</mml:mo>
                          <mml:mrow>
                            <mml:mi>j</mml:mi>
                            <mml:mo>=</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>n</mml:mi>
                                </mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>n</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:munderover>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:msqrt>
                                  <mml:mrow>
                                    <mml:mn>2</mml:mn>
                                    <mml:mo>π</mml:mo>
                                  </mml:mrow>
                                </mml:msqrt>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mo>σ</mml:mo>
                                    </mml:mrow>
                                    <mml:mi>j</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo>−</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>N</mml:mi>
                                  </mml:mrow>
                                  <mml:mi>r</mml:mi>
                                </mml:msub>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mo>π</mml:mo>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mi>K</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mtext>det</mml:mtext>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>A</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">e</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mi>U</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mo stretchy="false">(</mml:mo>
                              <mml:mi>i</mml:mi>
                              <mml:mo stretchy="false">)</mml:mo>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>with the help of <xref rid="E13" ref-type="disp-formula">Equation (13)</xref>. For this approximation to be valid, we require that the strongly peaked region in <bold><italic toggle="yes">m</italic></bold> space is within the <italic toggle="yes">a priori</italic> range for <bold><italic toggle="yes">m</italic></bold>. The area under the integrand in <xref rid="E13" ref-type="disp-formula">Equation (13)</xref> is proportional to the square root of <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:mtext>det</mml:mtext><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, and the prior range of <bold><italic toggle="yes">m</italic></bold> must be large enough to contain this area. Using <xref rid="E7" ref-type="disp-formula">Equation (7)</xref>, we need</p>
        <disp-formula id="E17">
          <label>(17)</label>
          <mml:math id="M17" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mtext>det</mml:mtext>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>A</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>i</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
              <mml:mo>×</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi mathvariant="bold-italic">m</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>≪</mml:mo>
              <mml:mn>1.</mml:mn>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </sec>
      <sec>
        <title>2.1.4 Finding the boundary points</title>
        <p>After determining the optimal number of segments into which to divide the data from <xref rid="E1" ref-type="disp-formula">Equaion (1)</xref>, we next find their boundary points. Using Bayes’ theorem, the posterior for <italic toggle="yes">n</italic> is</p>
        <disp-formula id="E18">
          <label>(18)</label>
          <mml:math id="M18" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi mathvariant="bold-italic">n</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mi>D</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>M</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi mathvariant="bold-italic">σ</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:mi mathvariant="bold-italic">n</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi mathvariant="bold-italic">σ</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mi>P</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi mathvariant="bold-italic">n</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi mathvariant="bold-italic">σ</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>which we evaluate using <xref rid="E2" ref-type="disp-formula">Equations (2</xref>, <xref rid="E4" ref-type="disp-formula">4</xref>, and <xref rid="E5" ref-type="disp-formula">5</xref>). We use the mean posterior value of <italic toggle="yes">n<sub>i</sub></italic> to estimate the optimal <italic toggle="yes">n<sub>i</sub></italic>:</p>
        <disp-formula id="E19">
          <label>(19)</label>
          <mml:math id="M19" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>E</mml:mi>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">]</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi mathvariant="bold-italic">n</mml:mi>
                    </mml:munder>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">σ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi mathvariant="bold-italic">n</mml:mi>
                        <mml:mo>|</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>P</mml:mi>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>D</mml:mi>
                        <mml:mo>|</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi mathvariant="bold-italic">σ</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi mathvariant="bold-italic">n</mml:mi>
                    </mml:munder>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">σ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>⋯</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">σ</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>which we sum following <xref rid="E8" ref-type="disp-formula">Equation (8)</xref>. The posterior variance, <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:mrow><mml:mtext>Var</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, determines the error in this estimate, which we find similarly.</p>
      </sec>
      <sec>
        <title>2.1.5 Finding <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for unknown measurement error</title>
        <p>If the <italic toggle="yes">σ<sub>j</sub></italic> are unknown, we assume the same constant <italic toggle="yes">σ</italic> for all <italic toggle="yes">j</italic> with a uniform prior probability between <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> (<xref rid="btad688-B3" ref-type="bibr">Gelman 2006</xref>). <xref rid="E2" ref-type="disp-formula">Equation (2)</xref> then becomes</p>
        <disp-formula id="E20">
          <label>(20)</label>
          <mml:math id="M20" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mi>f</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ℓ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>min</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi mathvariant="bold-italic">n</mml:mi>
                    </mml:munder>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:mi>f</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>ℓ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mtext>min</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi mathvariant="bold-italic">n</mml:mi>
                    </mml:munder>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mo>∫</mml:mo>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mo>σ</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext>min</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mo>σ</mml:mo>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mtext>max</mml:mtext>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mi>d</mml:mi>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo>σ</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>The constant <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> will cancel in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> when we compare the evidence for different <italic toggle="yes">M</italic>.</p>
        <p>Using the equivalent of <xref rid="E9" ref-type="disp-formula">Equations (9</xref> and <xref rid="E13" ref-type="disp-formula">13)</xref>, we find that</p>
        <disp-formula id="E21">
          <label>(21)</label>
          <mml:math id="M21" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="bold-italic">m</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:mo>π</mml:mo>
                          </mml:mrow>
                        </mml:msqrt>
                        <mml:mo>σ</mml:mo>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>ℓ</mml:mi>
                            </mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>+</mml:mo>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:mtext>det</mml:mtext>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>A</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mo> </mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mi>U</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>σ</mml:mo>
                                </mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>where we now explicitly follow <italic toggle="yes">σ</italic> and so set the <italic toggle="yes">σ<sub>j</sub></italic> in <xref rid="E10" ref-type="disp-formula">Equation (10)</xref> to unity, making <italic toggle="yes">z<sub>i</sub></italic> = <italic toggle="yes">y<sub>i</sub></italic> and <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Similarly for the linear case, the <italic toggle="yes">σ<sub>j</sub></italic> become unity in <xref rid="E14" ref-type="disp-formula">Equation (14)</xref>.</p>
        <p>Consequently,</p>
        <disp-formula id="E22">
          <label>(22)</label>
          <mml:math id="M22" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>×</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>×</mml:mo>
                  <mml:mo>⋯</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mo> </mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>D</mml:mi>
                      </mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>|</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi mathvariant="bold-italic">m</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:msqrt>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                            <mml:mo>π</mml:mo>
                          </mml:mrow>
                        </mml:msqrt>
                        <mml:mo>σ</mml:mo>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo>−</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:mrow>
                            <mml:mi>r</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:munderover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:mtext>det</mml:mtext>
                                <mml:mrow>
                                  <mml:msup>
                                    <mml:mrow>
                                      <mml:mi>A</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mo stretchy="false">(</mml:mo>
                                      <mml:mi>i</mml:mi>
                                      <mml:mo stretchy="false">)</mml:mo>
                                    </mml:mrow>
                                  </mml:msup>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>−</mml:mo>
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>×</mml:mo>
                  <mml:mo> </mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msubsup>
                                <mml:mo>∑</mml:mo>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>=</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                                <mml:mi>M</mml:mi>
                              </mml:msubsup>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mrow>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>U</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mo stretchy="false">(</mml:mo>
                                    <mml:mi>i</mml:mi>
                                    <mml:mo stretchy="false">)</mml:mo>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mo>σ</mml:mo>
                                </mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>.</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>Although with <xref rid="E22" ref-type="disp-formula">Equation (22)</xref> it is possible to approximate analytically the integral over <italic toggle="yes">σ</italic> in <xref rid="E20" ref-type="disp-formula">Equation (20)</xref> by extending the range of the integrand to <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>∞</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, the resulting expression prevents us from summing over <bold><italic toggle="yes">n</italic></bold> using variable elimination. Instead, we swap the sum and the integral to write</p>
        <disp-formula id="E23">
          <label>(23)</label>
          <mml:math id="M23" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>D</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mi>M</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mi>f</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>N</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>M</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>ℓ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mtext>min</mml:mtext>
                  </mml:mrow>
                </mml:msub>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mo>σ</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mrow>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mo>∫</mml:mo>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo>σ</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>min</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mo>σ</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>max</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mi>d</mml:mi>
              </mml:mrow>
              <mml:mo>σ</mml:mo>
              <mml:mrow>
                <mml:munder>
                  <mml:mo>∑</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                </mml:munder>
              </mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>D</mml:mi>
              <mml:mo>|</mml:mo>
              <mml:mi mathvariant="bold-italic">n</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mi>M</mml:mi>
              <mml:mo>,</mml:mo>
              <mml:mo>σ</mml:mo>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>and numerically evaluate, using variable elimination to sum over <bold><italic toggle="yes">n</italic></bold> in <xref rid="E23" ref-type="disp-formula">Equation (23)</xref> for each <italic toggle="yes">σ</italic> chosen by the integration algorithm.</p>
        <p>We find the expected boundary points via <xref rid="E19" ref-type="disp-formula">Equation (19)</xref>, again numerically integrating over <italic toggle="yes">σ</italic>.</p>
        <p><bold>Performing the integration:</bold> To stabilize the numerical integration, we scale the integrand of <xref rid="E23" ref-type="disp-formula">Equation (23)</xref> by its value at the most likely value of <italic toggle="yes">σ</italic>, making the integrand nearly always less than one and preventing overflow. We use expectation-maximization (EM) to estimate the most likely <italic toggle="yes">σ</italic> for a given <italic toggle="yes">M</italic>. The EM algorithm finds the <italic toggle="yes">σ</italic> that maximizes <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (<xref rid="btad688-B2" ref-type="bibr">Bishop 2006</xref>). We guess a value of <italic toggle="yes">σ</italic>, <italic toggle="yes">σ<sub>o</sub></italic> say, and find <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from <xref rid="E18" ref-type="disp-formula">Equation (18)</xref>. To update <italic toggle="yes">σ<sub>o</sub></italic>, we maximize <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>σ</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> with respect to <italic toggle="yes">σ</italic>, where</p>
        <disp-formula id="E24">
          <label>(24)</label>
          <mml:math id="M24" display="block" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>Q</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mo>σ</mml:mo>
                      <mml:mi>o</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi mathvariant="bold-italic">n</mml:mi>
                    </mml:munder>
                  </mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mo>σ</mml:mo>
                      <mml:mi>o</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                  <mml:mo> </mml:mo>
                  <mml:mtext>log</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo>)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:mi>E</mml:mi>
                  <mml:mo>[</mml:mo>
                  <mml:mtext>log</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo>)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>log</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo>)</mml:mo>
                  <mml:mo>]</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:mi>E</mml:mi>
                  <mml:mo>[</mml:mo>
                  <mml:mtext>log</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi>D</mml:mi>
                  <mml:mo>|</mml:mo>
                  <mml:mi mathvariant="bold-italic">n</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mo>σ</mml:mo>
                  <mml:mo>)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:mtext>log</mml:mtext>
                  <mml:mo> </mml:mo>
                  <mml:mi>f</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>ℓ</mml:mi>
                      <mml:mtext>min</mml:mtext>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                  <mml:mo>]</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
        <p>with the expectations taken over <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">n</mml:mi><mml:mo>|</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Expanding <xref rid="E24" ref-type="disp-formula">Equation (24)</xref> using <xref rid="E22" ref-type="disp-formula">Equation</xref><xref rid="E22" ref-type="disp-formula"> (22)</xref>, there are only two terms that depend on <italic toggle="yes">σ</italic>, and we can differentiate to find the updated <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:mrow><mml:mo>σ</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>:</p>
        <disp-formula id="E25">
          <label>(25)</label>
          <mml:math id="M25" display="block" overflow="scroll">
            <mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mo>σ</mml:mo>
                  </mml:mrow>
                  <mml:mi>n</mml:mi>
                  <mml:mn>2</mml:mn>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mrow>
                <mml:mfrac>
                  <mml:mn>2</mml:mn>
                  <mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mi>r</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mi>N</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mi>K</mml:mi>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
              <mml:mrow>
                <mml:munderover>
                  <mml:mo>∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mi>M</mml:mi>
                </mml:munderover>
              </mml:mrow>
              <mml:mi>E</mml:mi>
              <mml:mo stretchy="false">[</mml:mo>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>U</mml:mi>
                  </mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:msub>
              </mml:mrow>
              <mml:mo stretchy="false">]</mml:mo>
              <mml:mo>.</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
        <p>We use the equivalent of <xref rid="E19" ref-type="disp-formula">Equation (19)</xref> with <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">σ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to evaluate these expectations and iterate until the value of <italic toggle="yes">σ</italic> converges.</p>
      </sec>
      <sec>
        <title>2.1.6 Implementation</title>
        <p>For basis functions that generate lines, we compare the different linear segments by calculating the gradient, intercept, and the coefficient of determination <italic toggle="yes">R</italic><sup>2</sup> of the line maximizing the likelihood for each segment. The user can then select a desired segment, such as the one with the largest gradient.</p>
        <p>The algorithm requires the <italic toggle="yes">a priori</italic> bounded region of <bold><italic toggle="yes">m</italic></bold> in <xref rid="E7" ref-type="disp-formula">Equation (7)</xref>. Again specializing to straight lines, the prior specifies the range of the intercept <italic toggle="yes">m</italic><sub>1</sub> and the gradient <italic toggle="yes">m</italic><sub>2</sub>: <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. The user can either provide both ranges or only the range of <italic toggle="yes">m</italic><sub>2</sub> or give the maximal range of <italic toggle="yes">y</italic> possible in the experiment, <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. If the user provides only the range of <italic toggle="yes">m</italic><sub>2</sub>, we estimate <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> as <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:mrow><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> as <inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:mi>max</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. If the user provides the range of <italic toggle="yes">y</italic>, we estimate the range of <italic toggle="yes">m</italic><sub>2</sub> as <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, with <inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mo>Δ</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> being the smallest difference between two neighbouring <italic toggle="yes">x</italic> values.</p>
      </sec>
      <sec>
        <title>2.1.7 Availability</title>
        <p>We coded the algorithm as a Python package available at <ext-link xlink:href="https://pypi.org/project/nunchaku" ext-link-type="uri">https://pypi.org/project/nunchaku</ext-link> and via <monospace>pip</monospace>. We have also embedded <monospace>nunchaku</monospace> into our <monospace>omniplate</monospace> software for analyzing plate-reader data (<xref rid="btad688-B8" ref-type="bibr">Montaño-Gutierrez <italic toggle="yes">et al.</italic> 2022</xref>).</p>
      </sec>
      <sec>
        <title>2.1.8 Generating and testing with synthetic data</title>
        <p>To test our method, we generated a piece-wise linear function <italic toggle="yes">f</italic>(<italic toggle="yes">x</italic>) with <inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>M</mml:mi><mml:mo>≤</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></inline-formula> continuous linear segments, each having between 10 and 50 data points and with a unit distance, <inline-formula id="IE90"><mml:math id="IM90" display="inline" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, between data points. We sampled <italic toggle="yes">θ</italic>, the angle between each segment and the <italic toggle="yes">x</italic>-axis, from a uniform distribution on the interval <inline-formula id="IE91"><mml:math id="IM91" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mtext>tan</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>tan</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, so that the gradient, <inline-formula id="IE92"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mrow><mml:mtext>tan</mml:mtext><mml:mo> </mml:mo><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula>, lies between <inline-formula id="IE93"><mml:math id="IM93" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. Furthermore we ensured that the difference in <italic toggle="yes">θ</italic> between neighbouring segments is larger than a fixed minimum, <italic toggle="yes">θ</italic><sub>0</sub>. We added Gaussian noise, <inline-formula id="IE94"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mrow><mml:mo>ϵ</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, to give three replicates of <inline-formula id="IE95"><mml:math id="IM95" display="inline" overflow="scroll"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo>ϵ</mml:mo></mml:mrow></mml:math></inline-formula>. We generated 3600 synthetic datasets in total, a combination of 200 different piece-wise linear functions <italic toggle="yes">f</italic>(<italic toggle="yes">x</italic>), three values of <italic toggle="yes">θ</italic><sub>0</sub>, and six values of <italic toggle="yes">σ</italic>. In <xref rid="btad688-F1" ref-type="fig">Figs 1</xref> and <xref rid="btad688-F2" ref-type="fig">2</xref>, <inline-formula id="IE96"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mo>°</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
        <fig position="float" id="btad688-F1">
          <label>Figure 1.</label>
          <caption>
            <p>The nunchaku algorithm correctly predicts the number of linear segments in synthetic data when the measurement noise is not too high. (A) Example synthetic datasets with the ground truth in blue (small circles) and the triplicate data in light grey. The large red circles are the predicted boundaries of each linear segment with the best-fit line in red. Left: with a measurement error of 0.25, the predictions overlap the data; Right: with a measurement error of 8, the predictions miss some segments, which the noise obscures. As a prior, we specify only that the gradient of each line lies between <inline-formula id="IE97"><mml:math id="IM97" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>25</mml:mn><mml:mo>,</mml:mo><mml:mn>25</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. For this data, a measurement error of 0.25 is 0.5% of the mean of <italic toggle="yes">y</italic> and an error of 8 is almost 15%. (B) The algorithm underestimates the number of linear segments only once the magnitude of the measurement noise becomes sufficiently high. The actual number of segments is <italic toggle="yes">M</italic>; the estimated number is <inline-formula id="IE98"><mml:math id="IM98" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
          </caption>
          <graphic xlink:href="btad688f1" position="float"/>
        </fig>
        <fig position="float" id="btad688-F2">
          <label>Figure 2.</label>
          <caption>
            <p>Nunchaku performs as well as or better than the NOT algorithm (<xref rid="btad688-B1" ref-type="bibr">Baranowski <italic toggle="yes">et al.</italic> 2019</xref>). This algorithm only supports input of one <italic toggle="yes">y</italic> value for each <italic toggle="yes">x</italic> value: we therefore input either one replicate or the mean of three replicates. The data are generated similarly to that in <xref rid="btad688-F1" ref-type="fig">Fig. 1</xref> (Section 2). As a prior for nunchaku, we specify that the gradient of each line lies between <inline-formula id="IE99"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>25</mml:mn><mml:mo>,</mml:mo><mml:mn>25</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. (A) The root mean squared error (RMSE) between the ground truth and the best-fit lines. (B) The difference between the predicted number of segments <inline-formula id="IE100"><mml:math id="IM100" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> and the ground truth <italic toggle="yes">M</italic> (left) and the percentage of correct predictions of <italic toggle="yes">M</italic> with <inline-formula id="IE101"><mml:math id="IM101" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> (right).</p>
          </caption>
          <graphic xlink:href="btad688f2" position="float"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>2.2 Experimental methods</title>
      <p>We used a prototrophic strain of <italic toggle="yes">Saccharomyces cerevisiae</italic> (FY4), precultured in synthetic complete (SC) medium with 2% (w/v) sodium pyruvate in a 30°C shaking incubator at 180 rpm for two days. Before the experiment, we diluted the cells 6-fold and let them grow for six hours. After washing the cells twice with fresh minimal media (<xref rid="btad688-B14" ref-type="bibr">Verduyn <italic toggle="yes">et al.</italic> 1992</xref>), we inoculated them into minimal media with different concentrations of fructose on a 96-well microplate. The liquid volume of each well was 200 μl.</p>
      <p>For <italic toggle="yes">Escherichia coli</italic>, we precultured cells in 3 ml liquid Luria broth (LB) with one colony from a fresh plate and grew aerobically to log phase (6 h) at 37°C with 250 rpm shaking. We then inoculated 3 μl culture into 147 μl fresh LB medium per well on a 96-well microplate.</p>
      <p>We used either a Tecan Infinite M200 Pro or F200 plate reader at 30°C for <italic toggle="yes">S.cerevisiae</italic> and 37°C for <italic toggle="yes">E.coli</italic> with linear shaking at amplitude 6 mm. Measurements of absorbance at 600 nm, OD<sub>600</sub>, were taken every 10 min.</p>
      <p>Data were analyzed using the <monospace>omniplate</monospace> software (<xref rid="btad688-B8" ref-type="bibr">Montaño-Gutierrez <italic toggle="yes">et al.</italic> 2022</xref>).</p>
    </sec>
    <sec>
      <title>2.3 Fitting Monod’s equation</title>
      <p>After estimating the specific growth rate <italic toggle="yes">λ</italic> at each concentration of fructose <italic toggle="yes">s</italic>, we have a dataset <inline-formula id="IE102"><mml:math id="IM102" display="inline" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi><mml:mo>≡</mml:mo><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> with 38 data points. We use Bayesian inference to estimate the constants <inline-formula id="IE103"><mml:math id="IM103" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">K<sub>M</sub></italic> of Monod’s equation. Assuming a Gaussian measurement error of <inline-formula id="IE104"><mml:math id="IM104" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> with a standard deviation <italic toggle="yes">σ</italic> and independent measurements, the likelihood</p>
      <disp-formula id="E26">
        <label>(26)</label>
        <mml:math id="M26" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>D</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>λ</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>max</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>K</mml:mi>
                    </mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mo>σ</mml:mo>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:msqrt>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                          <mml:mo>π</mml:mo>
                        </mml:mrow>
                      </mml:msqrt>
                      <mml:mo>σ</mml:mo>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo>×</mml:mo>
                <mml:mrow>
                  <mml:munderover>
                    <mml:mo>∏</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mi>N</mml:mi>
                  </mml:munderover>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo> </mml:mo>
                  <mml:mtext>exp</mml:mtext>
                  <mml:mo> </mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>[</mml:mo>
                  <mml:mrow>
                    <mml:mo>−</mml:mo>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo stretchy="true">(</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mo>λ</mml:mo>
                                      </mml:mrow>
                                      <mml:mi>i</mml:mi>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>−</mml:mo>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mo>λ</mml:mo>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mtext>max</mml:mtext>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mfrac>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:msub>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                            <mml:mi>i</mml:mi>
                                          </mml:msub>
                                        </mml:mrow>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mrow>
                                          <mml:msub>
                                            <mml:mrow>
                                              <mml:mi>K</mml:mi>
                                            </mml:mrow>
                                            <mml:mi>M</mml:mi>
                                          </mml:msub>
                                        </mml:mrow>
                                        <mml:mo>+</mml:mo>
                                        <mml:mrow>
                                          <mml:msub>
                                            <mml:mrow>
                                              <mml:mi>s</mml:mi>
                                            </mml:mrow>
                                            <mml:mi>i</mml:mi>
                                          </mml:msub>
                                        </mml:mrow>
                                      </mml:mrow>
                                    </mml:mfrac>
                                  </mml:mrow>
                                  <mml:mo stretchy="true">)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                          <mml:mrow>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mo>σ</mml:mo>
                              </mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:msup>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
                <mml:mo>.</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>To marginalize over <italic toggle="yes">σ</italic>, we assume <inline-formula id="IE105"><mml:math id="IM105" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>σ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo>σ</mml:mo></mml:mrow></mml:math></inline-formula>, so that</p>
      <disp-formula id="E27">
        <label>(27)</label>
        <mml:math id="M27" display="block" overflow="scroll">
          <mml:mtable>
            <mml:mtr>
              <mml:mtd>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>D</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>λ</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>max</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>K</mml:mi>
                    </mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>∝</mml:mo>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mo>∫</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>∞</mml:mo>
                    </mml:msubsup>
                  </mml:mrow>
                  <mml:mi>d</mml:mi>
                </mml:mrow>
                <mml:mo>σ</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>D</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo>λ</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>max</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>K</mml:mi>
                    </mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mo>σ</mml:mo>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mo>σ</mml:mo>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mo>∝</mml:mo>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:munderover>
                              <mml:mo>∑</mml:mo>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mo>=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mi>N</mml:mi>
                            </mml:munderover>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:msup>
                                <mml:mrow>
                                  <mml:mrow>
                                    <mml:mo stretchy="true">(</mml:mo>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mo>λ</mml:mo>
                                        </mml:mrow>
                                        <mml:mi>i</mml:mi>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mo>−</mml:mo>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mrow>
                                          <mml:mo>λ</mml:mo>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mtext>max</mml:mtext>
                                        </mml:mrow>
                                      </mml:msub>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mfrac>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:msub>
                                              <mml:mrow>
                                                <mml:mi>s</mml:mi>
                                              </mml:mrow>
                                              <mml:mi>i</mml:mi>
                                            </mml:msub>
                                          </mml:mrow>
                                        </mml:mrow>
                                        <mml:mrow>
                                          <mml:mrow>
                                            <mml:msub>
                                              <mml:mrow>
                                                <mml:mi>K</mml:mi>
                                              </mml:mrow>
                                              <mml:mi>M</mml:mi>
                                            </mml:msub>
                                          </mml:mrow>
                                          <mml:mo>+</mml:mo>
                                          <mml:mrow>
                                            <mml:msub>
                                              <mml:mrow>
                                                <mml:mi>s</mml:mi>
                                              </mml:mrow>
                                              <mml:mi>i</mml:mi>
                                            </mml:msub>
                                          </mml:mrow>
                                        </mml:mrow>
                                      </mml:mfrac>
                                    </mml:mrow>
                                    <mml:mo stretchy="true">)</mml:mo>
                                  </mml:mrow>
                                </mml:mrow>
                                <mml:mn>2</mml:mn>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo>−</mml:mo>
                      <mml:mrow>
                        <mml:mfrac>
                          <mml:mi>N</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:mfrac>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
                <mml:mo>.</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>We further assume that the prior <inline-formula id="IE106"><mml:math id="IM106" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is uniform, and so the posterior probability <inline-formula id="IE107"><mml:math id="IM107" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">K<sub>M</sub></italic> is proportional to the likelihood, <xref rid="E27" ref-type="disp-formula">Equation (27)</xref>. We therefore maximize the likelihood with respect to <inline-formula id="IE108"><mml:math id="IM108" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">K<sub>M</sub></italic> using the BFGS algorithm. We estimate the errors in these inferences using the diagonal elements of the Hessian matrix <inline-formula id="IE109"><mml:math id="IM109" display="inline" overflow="scroll"><mml:mrow><mml:mo>−</mml:mo><mml:mo>∇</mml:mo><mml:mo>∇</mml:mo><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> evaluated at the maximum of the likelihood (<xref rid="btad688-B6" ref-type="bibr">MacKay 2003</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Approximating data with a piece-wise linear model</title>
      <p>Although our goal is to allow scientists to choose objectively the segment of their data that is ‘most’ linear, we adopt a general methodology and allow the data to be described by linear combinations of arbitrary basis functions. For straight lines, there are two basis functions, <inline-formula id="IE110"><mml:math id="IM110" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE111"><mml:math id="IM111" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ϕ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula>, but datasets may require higher order polynomials or even Gaussian or sigmoid functions (<xref rid="btad688-B2" ref-type="bibr">Bishop 2006</xref>).</p>
      <p>For a 1D time series and a given set of basis functions, we will infer the optimal piece-wise description—the number of contiguous segments into which we should divide the data, where the boundaries of each of those segments should be, and the best-fit linear combination of basis functions for each segment. Deciding which of these segments is then most appropriate for the task in hand is unavoidably subjective. It is straightforward, however, to compare different segments by comparing properties of their best-fit linear combinations. For lines, these properties include their gradients and <italic toggle="yes">R</italic><sup>2</sup> value—how much of the variance of the dependent variable is explained by the independent one (<xref rid="btad688-B9" ref-type="bibr">Moses 2017</xref>).</p>
      <p>We use a Bayesian approach to infer the best piece-wise description and assume only that the data of each segment is normally distributed around a linear combination of the basis functions (Section 2). To proceed analytically we marginalize over all coefficients constituting the linear combination for each segment using a mild approximation and choose the optimal number of segments by comparing marginal likelihoods. The data points bounding each segment are then estimated by the means of their posterior distribution. We consider the case with known measurement error separately from an unknown one and call our algorithm <monospace>nunchaku</monospace>.</p>
    </sec>
    <sec>
      <title>3.2 Verifying our approach</title>
      <p>To verify our methodology (Section 2), we first focused on identifying linear regions. We generated synthetic data using piece-wise linear functions, where we know the number of segments and their gradients, added Gaussian noise, and then inferred from this data the optimal number of segments and the gradients of the best-fit lines, assuming that we know the magnitude of the measurement noise (<xref rid="btad688-F1" ref-type="fig">Fig. 1A</xref>).</p>
      <p>The algorithm predicts correctly the number of segments when the noise in the data is sufficiently low (<xref rid="btad688-F1" ref-type="fig">Fig. 1B</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>), but underestimates this number when the noise is larger. Such noise tends to blur two neighbouring segments so they seem one, rather than cause a single segment to appear as two or more. Similarly, if we decrease the angle between neighbouring segments, the noise is more likely to make two neighbouring segments appear contiguous, and the algorithm’s accuracy falls (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
      <p>We confirmed that the algorithm also correctly predicts the underlying piece-wise linear functions, and hence the gradient of the lines generating the data in the segments (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). As expected, this accuracy falls too with more noisy data.</p>
      <p>When the measurement error is unknown, the results are similar (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>), but the algorithm is slower because we numerically integrate over all possible magnitudes of this measurement error. We also confirmed that the algorithm’s performance is robust to broad choices of the prior distribution (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>).</p>
      <p>We next compared our methodology to the Narrowest-Over-Threshold (NOT) algorithm (<xref rid="btad688-B1" ref-type="bibr">Baranowski <italic toggle="yes">et al.</italic> 2019</xref>), a state-of-the-art frequentist approach. Whether we consider the root mean square error between the best-fit lines and the ground truth (<xref rid="btad688-F2" ref-type="fig">Fig. 2A</xref>) or the predicted number of segments (<xref rid="btad688-F2" ref-type="fig">Fig. 2B</xref>), our algorithm consistently performs as well as or better (see also <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). This greater accuracy however comes at the expense of speed: the NOT algorithm is faster than our implementation of <monospace>nunchaku</monospace>.</p>
      <p>Finally, we demonstrated that <monospace>nunchaku</monospace> works with other basis functions, including constant functions, third-order polynomials, and sines (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>).</p>
    </sec>
    <sec>
      <title>3.3 Application 1: finding the range of OD that increases linearly with cell number</title>
      <p>The OD of a microbial culture increases linearly with the number of cells only for sufficiently small ODs. At higher ODs, the light from the spectrophotometer may scatter off multiple cells, and the relationship between OD and the number of cells becomes nonlinear (<xref rid="btad688-B13" ref-type="bibr">Stevenson <italic toggle="yes">et al.</italic> 2016</xref>). To calibrate OD measurements, researchers often serially dilute a dense culture of microbes and measure the relationship between the OD and the dilution factor (<xref rid="btad688-B15" ref-type="bibr">Warringer and Blomberg 2003</xref>, <xref rid="btad688-B13" ref-type="bibr">Stevenson <italic toggle="yes">et al.</italic> 2016</xref>) (<xref rid="btad688-F3" ref-type="fig">Fig. 3A</xref>). Interpolating this curve, we can convert an OD measurement to the corresponding dilution factor and so correct for any nonlinearity between the OD and cell numbers.</p>
      <fig position="float" id="btad688-F3">
        <label>Figure 3.</label>
        <caption>
          <p>The nunchaku algorithm gives intuitive results when applied to biological data. (A) The calibration curve for plate-reader measurements of the OD of <italic toggle="yes">S.cerevisiae</italic>, found by diluting an overnight culture in 2% fructose, is nonlinear (blue dots). There are three replicate measurements for each dilution factor. Our algorithm identifies two linear segments (boundaries marked as circles). Lighter orange circles bound the segment with the highest <italic toggle="yes">R</italic><sup>2</sup>. We specify the likely maximal range of OD as our prior: <inline-formula id="IE112"><mml:math id="IM112" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. Inset: the logarithm of the model evidence for the number of segments. (B) Identifying contiguous linear segments in the logarithm of the OD of growing <italic toggle="yes">E.coli</italic> cells as a function of time allows us to identify automatically the region of exponential growth. We show the mean of four replicate measurements (blue) with twice their standard deviation shaded. Circles denote the boundaries of linear segments; orange circles bound the segment with the best-fit line with highest gradient and so highest specific growth rate. The average specific growth rate over this segment is 1.5 h<sup>–1</sup>. Inset: the logarithm of the model evidence for the number of segments. (C) With our algorithm, we can automatically identify the region of exponential growth in multiple datasets, here 38, to reveal growth laws such as Monod’s equation. We plot the specific growth rate in log phase for <italic toggle="yes">S.cerevisiae</italic> as a function of the concentration of fructose, with the solid line a fit of Monod’s equation: <inline-formula id="IE113"><mml:math id="IM113" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.422</mml:mn><mml:mo>±</mml:mo><mml:mn>0.006</mml:mn></mml:mrow></mml:math></inline-formula> h<sup>–1</sup> and <inline-formula id="IE114"><mml:math id="IM114" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.026</mml:mn><mml:mo>±</mml:mo><mml:mn>0.002</mml:mn></mml:mrow></mml:math></inline-formula>% (w/v). The shaded area shows the 95% confidence interval. Inset: three example growth curves with dots marking the region of exponential growth, identified as the segment with the highest gradient. For panels (B) and (C), we specify a prior on the range of the gradient: <inline-formula id="IE115"><mml:math id="IM115" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> h<sup>–1</sup>.</p>
        </caption>
        <graphic xlink:href="btad688f3" position="float"/>
      </fig>
      <p>Dilution factors, however, are not intuitive units, and it is useful to identify the range of ODs over which there is a linear relationship with cell numbers. Not only is this range itself important, but by using the ratio of the maximum of the range to the corresponding dilution factor, we can re-scale the dilution factors back into ODs.</p>
      <p>We used the <monospace>nunchaku</monospace> algorithm to identify the linear range, using basis functions that generate straight lines and an unknown measurement error. Two linear segments are optimal, and the one of interest, where OD is proportional to the number of cells, is the segment beginning at the smallest OD. This segment also has the highest coefficient of determination <italic toggle="yes">R</italic><sup>2</sup>. Its maximal OD is 0.66 for a relative cell number of 0.25 (<xref rid="btad688-F3" ref-type="fig">Fig. 3A</xref>), and we should therefore multiply the dilution factors by 0.66/0.25, or 2.6, to convert back to ODs.</p>
    </sec>
    <sec>
      <title>3.4 Application 2: identifying the log phase of microbial growth</title>
      <p>Microbes are most often studied when growing exponentially, with the <inline-formula id="IE116"><mml:math id="IM116" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>OD</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of the culture increasing linearly with time (<xref rid="btad688-B7" ref-type="bibr">Monod 1949</xref>). Researchers identify this log-phase growth from microbial growth curves.</p>
      <p>To detect log phase automatically, we applied <monospace>nunchaku</monospace>, again with basis functions generating lines, to OD measurements of <italic toggle="yes">E.coli</italic> (<xref rid="btad688-F3" ref-type="fig">Fig. 3B</xref>). Partitioning the data into six segments is optimal, and the segment whose best-fit line has the highest gradient—the greatest specific growth rate—corresponds to exponential growth.</p>
      <p>Monod noticed an empirical relationship between the nutrient concentration and the specific growth rate of microbes in log phase (<xref rid="btad688-B7" ref-type="bibr">Monod 1949</xref>). Denoting this growth rate as <italic toggle="yes">λ</italic>, the maximal specific growth rate as <inline-formula id="IE117"><mml:math id="IM117" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and the nutrient concentration as <italic toggle="yes">s</italic>, his equation becomes</p>
      <disp-formula id="E28">
        <label>(28)</label>
        <mml:math id="M28" display="block" overflow="scroll">
          <mml:mrow>
            <mml:mo>λ</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mo>λ</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mtext>max</mml:mtext>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
            <mml:mrow>
              <mml:mfrac>
                <mml:mi>s</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                      <mml:mi>M</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                  <mml:mo>+</mml:mo>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>where <italic toggle="yes">K<sub>M</sub></italic> is now called the Monod constant. To estimate <inline-formula id="IE118"><mml:math id="IM118" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">K<sub>M</sub></italic>, researchers systematically vary the concentration of the carbon source and identify the log phase and the corresponding gradient for each growth curve.</p>
      <p>Here, we use the <monospace>nunchaku</monospace> algorithm to select data to estimate <inline-formula id="IE119"><mml:math id="IM119" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">K<sub>M</sub></italic> for <italic toggle="yes">S.cerevisiae</italic> growing on fructose (Section 2), from 38 growth curves measured with plate readers (<xref rid="btad688-F3" ref-type="fig">Fig. 3C</xref>). Each biological replicate has two technical replicates.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Determining where data are best described by a line is a problem familiar to most scientists. We present a statistically rigorous solution, which we generalize by considering linear combinations of arbitrary basis functions. Our methodology is Bayesian and similar in approach to earlier work that focused on piece-wise constant functions (<xref rid="btad688-B5" ref-type="bibr">Hutter 2007</xref>).</p>
    <p>Like all Bayesian inference, our algorithm depends on prior information: the bounds on the coefficients constituting the linear combination of basis functions. For basis functions generating lines, these bounds describe the range of the gradients and intercepts of all possible lines within a segment. The optimal number of segments will depend on this prior if the amount of data is sufficiently small, as it should (<xref rid="btad688-B6" ref-type="bibr">MacKay 2003</xref>). In practice, however, users interested in lines need specify only one prior range with the other inferred (Section 2), and we see that although a wide prior favours fewer segments, a single segment is robustly assigned to sections of the data that appear linear.</p>
    <p>Our method makes two assumptions about how the data deviate from a linear combination of basis functions. We assume these deviations are independent and we assume that each deviation obeys a normal distribution. For some data, a distribution with a purely nonnegative support, such as a log normal, may be more appropriate. Although we can use such a distribution in principle, in practice some of the steps that we performed analytically would have to become numerical. Further, if nothing is known <italic toggle="yes">a priori</italic> about these deviations, we assume that their standard deviation is identical for all time points. Our algorithm would work too if the standard deviations vary but are proportional to a known function of <italic toggle="yes">x<sub>j</sub></italic> and <italic toggle="yes">y<sub>j</sub></italic>.</p>
    <p>Our work adds to existing algorithms for detecting change points in time series, including those aimed at analyzing microbial growth (<xref rid="btad688-B10" ref-type="bibr">Papastamoulis <italic toggle="yes">et al.</italic> 2019</xref>). We have simplified this problem by considering change points to occur only at data points and by imposing no continuity between the functions underlying the data for each segment. These simplifications are not restrictive for our task of finding one particular segment of interest. Identifying change points more generally typically requires Markov chain Monte Carlo methods (<xref rid="btad688-B12" ref-type="bibr">Stephens 1994</xref>, <xref rid="btad688-B10" ref-type="bibr">Papastamoulis <italic toggle="yes">et al.</italic> 2019</xref>).</p>
    <p>The <monospace>nunchaku</monospace> algorithm by using enumeration is robust and lends itself to automation, facilitating high throughput studies. It should both ease and increase the reproducibility of data analyses for a wide range of scientists.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad688_Supplementary_Data</label>
      <media xlink:href="btad688_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Ramon Grima and Edward WJ Wallace for helpful comments and the Biotechnology and Biological Sciences Research Council (P.S.S. and Y.H.) and the Darwin Trust (Y.H. and X.D.) for funding.</p>
  </ack>
  <sec>
    <title>Supplementary data</title>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <ext-link xlink:href="https://datashare.ed.ac.uk/handle/10283/2002" ext-link-type="uri">datashare.ed.ac.uk/handle/10283/2002</ext-link>.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This research was funded in whole, or in part, by the Biotechnology and Biological Sciences Research Council [BB/W006545/1]. For the purpose of open access, the authors have applied a creative commons attribution (CC BY) licence to any author accepted manuscript version arising.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>The data underlying this article are available in Edinburgh DataShare at <ext-link xlink:href="https://doi.org/10.7488/ds/7548" ext-link-type="uri">https://doi.org/10.7488/ds/7548</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad688-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baranowski</surname><given-names>R</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y</given-names></string-name>, <string-name><surname>Fryzlewicz</surname><given-names>P.</given-names></string-name></person-group><article-title>Narrowest-over-threshold detection of multiple change points and change-point-like features</article-title>. <source>J R Stat Soc Series B Stat Methodol</source><year>2019</year>;<volume>81</volume>:<fpage>649</fpage>–<lpage>72</lpage>.</mixed-citation>
    </ref>
    <ref id="btad688-B2">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Bishop</surname><given-names>CM.</given-names></string-name></person-group><source>Pattern Recognition and Machine Learning</source>. <publisher-name>Berlin, Germany</publisher-name>: Springer, <year>2006</year>.</mixed-citation>
    </ref>
    <ref id="btad688-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gelman</surname><given-names>A.</given-names></string-name></person-group><article-title>Prior distributions for variance parameters in hierarchical models</article-title>. <source>Bayesian Anal</source><year>2006</year>;<volume>1</volume>:<fpage>515</fpage>–<lpage>34</lpage>.</mixed-citation>
    </ref>
    <ref id="btad688-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hinrichsen</surname><given-names>M</given-names></string-name>, <string-name><surname>Lenz</surname><given-names>M</given-names></string-name>, <string-name><surname>Edwards</surname><given-names>JM</given-names></string-name></person-group><etal>et al</etal><article-title>A new method for post-translationally labeling proteins in live cells for fluorescence imaging and tracking</article-title>. <source>Protein Eng Des Sel</source><year>2017</year>;<volume>30</volume>:<fpage>771</fpage>–<lpage>80</lpage>.<pub-id pub-id-type="pmid">29228311</pub-id></mixed-citation>
    </ref>
    <ref id="btad688-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hutter</surname><given-names>M.</given-names></string-name></person-group><article-title>Exact Bayesian regression of piecewise constant functions</article-title>. <source>Bayesian Anal</source><year>2007</year>;<volume>2</volume>:<fpage>635</fpage>–<lpage>64</lpage>.</mixed-citation>
    </ref>
    <ref id="btad688-B6">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>MacKay</surname><given-names>DJ.</given-names></string-name></person-group><source>Information Theory, Inference and Learning Algorithms</source>. Cambridge, UK: <publisher-name>Cambridge University Press</publisher-name>, <year>2003</year>.</mixed-citation>
    </ref>
    <ref id="btad688-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Monod</surname><given-names>J.</given-names></string-name></person-group><article-title>The growth of bacterial cultures</article-title>. <source>Annu Rev Microbiol</source><year>1949</year>;<volume>3</volume>:<fpage>371</fpage>–<lpage>94</lpage>.</mixed-citation>
    </ref>
    <ref id="btad688-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Montaño-Gutierrez</surname><given-names>LF</given-names></string-name>, <string-name><surname>Moreno</surname><given-names>NM</given-names></string-name>, <string-name><surname>Farquhar</surname><given-names>IL</given-names></string-name></person-group><etal>et al</etal><article-title>Analysing and meta-analysing time-series data of microbial growth and gene expression from plate readers</article-title>. <source>PLoS Comput Biol</source><year>2022</year>;<volume>18</volume>:<fpage>e1010138</fpage>.<pub-id pub-id-type="pmid">35617352</pub-id></mixed-citation>
    </ref>
    <ref id="btad688-B9">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Moses</surname><given-names>AM.</given-names></string-name></person-group><source>Statistical Modelling and Machine Learning for Molecular Biology</source>. <publisher-name>Boca Raton, FL</publisher-name>: CRC Press. <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="btad688-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Papastamoulis</surname><given-names>P</given-names></string-name>, <string-name><surname>Furukawa</surname><given-names>T</given-names></string-name>, <string-name><surname>Van Rhijn</surname><given-names>N</given-names></string-name></person-group><etal>et al</etal><article-title>Bayesian detection of piecewise linear trends in replicated time-series with application to growth data modelling</article-title>. <source>Int J Biostat</source><year>2019</year>;<volume>16</volume>:<fpage>20180052</fpage>.</mixed-citation>
    </ref>
    <ref id="btad688-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scott</surname><given-names>M</given-names></string-name>, <string-name><surname>Hwa</surname><given-names>T.</given-names></string-name></person-group><article-title>Shaping bacterial gene expression by physiological and proteome allocation constraints</article-title>. <source>Nat Rev Microbiol</source><year>2023</year>;<volume>21</volume>:<fpage>327</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">36376406</pub-id></mixed-citation>
    </ref>
    <ref id="btad688-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stephens</surname><given-names>DA.</given-names></string-name></person-group><article-title>Bayesian retrospective multiple-changepoint identification</article-title>. <source>J R Stat Soc Ser C Appl Stat</source><year>1994</year>;<volume>43</volume>:<fpage>159</fpage>–<lpage>78</lpage>.</mixed-citation>
    </ref>
    <ref id="btad688-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stevenson</surname><given-names>K</given-names></string-name>, <string-name><surname>McVey</surname><given-names>AF</given-names></string-name>, <string-name><surname>Clark</surname><given-names>IB</given-names></string-name></person-group><etal>et al</etal><article-title>General calibration of microbial growth in microplate readers</article-title>. <source>Sci Rep</source><year>2016</year>;<volume>6</volume>:<fpage>38828</fpage>.<pub-id pub-id-type="pmid">27958314</pub-id></mixed-citation>
    </ref>
    <ref id="btad688-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Verduyn</surname><given-names>C</given-names></string-name>, <string-name><surname>Postma</surname><given-names>E</given-names></string-name>, <string-name><surname>Scheffers</surname><given-names>WA</given-names></string-name></person-group><etal>et al</etal><article-title>Effect of benzoic acid on metabolic fluxes in yeasts</article-title>. <source>Yeast</source><year>1992</year>;<volume>8</volume>:<fpage>501</fpage>–<lpage>17</lpage>.<pub-id pub-id-type="pmid">1523884</pub-id></mixed-citation>
    </ref>
    <ref id="btad688-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Warringer</surname><given-names>J</given-names></string-name>, <string-name><surname>Blomberg</surname><given-names>A.</given-names></string-name></person-group><article-title>Automated screening in environmental arrays allows analysis of quantitative phenotypic profiles in <italic toggle="yes">Saccharomyces cerevisiae</italic></article-title>. <source>Yeast</source><year>2003</year>;<volume>20</volume>:<fpage>53</fpage>–<lpage>67</lpage>.<pub-id pub-id-type="pmid">12489126</pub-id></mixed-citation>
    </ref>
    <ref id="btad688-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>NL</given-names></string-name>, <string-name><surname>Poole</surname><given-names>D.</given-names></string-name></person-group><article-title>Exploiting causal independence in Bayesian network inference</article-title>. <source>JAIR</source><year>1996</year>;<volume>5</volume>:<fpage>301</fpage>–<lpage>28</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
