<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1181627</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-6-173</article-id>
    <article-id pub-id-type="pmid">16011807</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-6-173</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Normal uniform mixture differential gene expression detection for cDNA microarrays</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Dean</surname>
          <given-names>Nema</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>nemad@stat.washington.edu</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Raftery</surname>
          <given-names>Adrian E</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>raftery@stat.washington.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Statistics, University of Washington, Box 354322, Seattle, WA 98195-4322, U.S.A</aff>
    <pub-date pub-type="collection">
      <year>2005</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>7</month>
      <year>2005</year>
    </pub-date>
    <volume>6</volume>
    <fpage>173</fpage>
    <lpage>173</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/6/173"/>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>3</month>
        <year>2005</year>
      </date>
      <date date-type="accepted">
        <day>12</day>
        <month>7</month>
        <year>2005</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2005 Dean and Raftery; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2005</copyright-year>
      <copyright-holder>Dean and Raftery; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Dean
               Nema
               
               nemad@stat.washington.edu
            </dc:author><dc:title>
            Normal uniform mixture differential gene expression detection for cDNA microarrays
         </dc:title><dc:date>2005</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 6(1): 173-. (2005)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2005)6:1&#x0003c;173&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>One of the primary tasks in analysing gene expression data is finding genes that are differentially expressed in different samples. Multiple testing issues due to the thousands of tests run make some of the more popular methods for doing this problematic.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We propose a simple method, Normal Uniform Differential Gene Expression (NUDGE) detection for finding differentially expressed genes in cDNA microarrays. The method uses a simple univariate normal-uniform mixture model, in combination with new normalization methods for spread as well as mean that extend the lowess normalization of Dudoit, Yang, Callow and Speed (2002) [<xref ref-type="bibr" rid="B1">1</xref>]. It takes account of multiple testing, and gives probabilities of differential expression as part of its output. It can be applied to either single-slide or replicated experiments, and it is very fast. Three datasets are analyzed using NUDGE, and the results are compared to those given by other popular methods: unadjusted and Bonferroni-adjusted <italic>t </italic>tests, Significance Analysis of Microarrays (SAM), and Empirical Bayes for microarrays (EBarrays) with both Gamma-Gamma and Lognormal-Normal models.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The method gives a high probability of differential expression to genes known/suspected a priori to be differentially expressed and a low probability to the others. In terms of known false positives and false negatives, the method outperforms all multiple-replicate methods except for the Gamma-Gamma EBarrays method to which it offers comparable results with the added advantages of greater simplicity, speed, fewer assumptions and applicability to the single replicate case. An R package called <underline>nudge</underline> to implement the methods in this paper will be made available soon at <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org"/>.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Differentially expressed genes between two or more samples may be of interest to researchers for different reasons, for example, looking at causes of or treatments for diseases such as cancer. Given appropriately processed data, the researcher needs a methodology for assessing the genes in order to separate out ones of interest, i.e. genes with "significantly" different levels of expression in different samples. Widely used methods for single slide data include examining the ratio of expression levels for the gene in each of the two samples/channels (or the log ratio), which was the quantity examined in one of the first statistical analyses for differential expression in cDNA microarrays [<xref ref-type="bibr" rid="B2">2</xref>]. One of the earliest uses of this quantity for determining differential expression was the "rule of two", where if the gene's ratio of expression levels in the two channels/samples is greater than two or less than half, it is considered to be differentially expressed [<xref ref-type="bibr" rid="B3">3</xref>].</p>
    <p>Methods for data with replicate slides include the standard <italic>t </italic>test, which requires adjustment for the multiple comparisons being made. Modifications of this approach to account for multiple comparisons include the approach of Dudoit, Yang, Callow and Speed [<xref ref-type="bibr" rid="B1">1</xref>], which used a permutation analysis on Welsh's <italic>t</italic>-statistics, and the Significance Analysis of Microarrays (SAM) method, which modifies the <italic>t</italic>-statistic by adding a constant to the denominator [<xref ref-type="bibr" rid="B4">4</xref>]. A good summary of multiple testing adjustments is given by [<xref ref-type="bibr" rid="B5">5</xref>].</p>
    <p>The idea of modeling the data as two groups of genes, one differentially expressed and one not, seems to be a natural and intuitive approach. This approach has been used in the context of a Bayesian analysis [<xref ref-type="bibr" rid="B6">6</xref>], EBarrays, assuming that the observed ratios had a gamma distribution the reciprocal of whose scale parameter itself had a gamma distribution, or, as an alternative assumption, that the observed log ratios were normally distributed and the prior for the mean was normal also. A two-component mixture model was used to model the two groups and the posterior probability was used to make inference about differential expression. This follows from work done for single slide data with a Gamma-Gamma hierarchical model [<xref ref-type="bibr" rid="B7">7</xref>]. Another approach using mixture models is given by Pan, Lin and Le [<xref ref-type="bibr" rid="B8">8</xref>].</p>
    <p>This paper presents a very simple methodology based on mixture models called Normal Uniform Differential Gene Expression (NUDGE) detection. It is applicable to both single slide and replicated cDNA microarray datasets, produced by two of the more widely used experimental setups. After standardizing, the log ratio (or averaged across replicates log ratio) observations are modeled with a two-component mixture model; a normal component for those genes that are not differentially expressed and a uniform component for those that are. The mixture gives posterior probabilities of differential expression which do not need to be adjusted for multiple testing. This methodology is applied to three different experiments. The experiments include single replicate data (Like-Like), multiple replicate data (HIV and Apo Al), experiments with different samples being labeled with their own dyes (HIV) and experiments with all samples being labeled with one dye and compared to a reference sample (Apo Al). The results given by NUDGE are compared with those given by some other methodologies for these types of cDNA microarray experiments (different comparison methods used for different types of experiments). An R package called <underline>nudge</underline> to implement the methods in this paper will be made available soon at [<xref ref-type="bibr" rid="B9">9</xref>]</p>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>HIV dataset</title>
      <p>The HIV dataset that we analyze consists of four replicate experiments comparing cDNA from CD4+ T cell lines at 1 hour after infection with HIV-1BRU with non-infected cell lines on each slide; see [<xref ref-type="bibr" rid="B10">10</xref>] for details. There were four slides in total with the same RNA preparations hybridized to each. This dataset is useful in testing the specificity and sensitivity of methods for identifying differentially expressed genes, since there are 13 genes known to be differentially expressed (spots containing PCR products from segments of the HIV-1 genome which the cDNA of the infected cells should hybridize to and the non-infected should not) called positive controls, and 29 genes known not to be (non-human genes which neither infected nor non-infected cDNA samples should hybridize to) called negative controls. There are 4608 gene expression levels recorded in each replicate. The four replicates have balanced dye swaps, so no mean normalization of the (averaged across replicates) log ratios was necessary provided we always used one sample (say the infected sample) in the numerator of the log ratio and the other (non-infected sample) in the denominator regardless of which dye was used to label which sample in each array/slide.</p>
      <p>NUDGE took a few seconds to run. All 13 positive controls, no negative controls and three other genes were found to be differentially expressed (with posterior probability greater than 0.5).</p>
      <p>It is clear from Figure <xref ref-type="fig" rid="F1">1</xref> that the rule of two under any normalization gave less than optimal results. In all cases the rule of two correctly found the positive control genes to be differentially expressed. However, in the unnormalized case it also incorrectly found 3 of the 29 negative controls to be differentially expressed, as well as 58 other genes (including the three found by NUDGE). In the variance-normalized case, it incorrectly found one of the 29 negative controls to be differentially expressed, as well as 27 other genes (including the three found by NUDGE). Even though the rule of two is suboptimal, its performance can be improved through the use of the normalization methods suggested here.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><bold>Different Normalizations of HIV Data</bold>. Different normalizations of HIV data: (a) raw data, (b) data normalized with respect to the variance. The bullets are the positive controls: NUDGE correctly found them all to be differentially expressed. Other genes found to be differentially expressed by NUDGE are indicated by a plus sign, and all genes found not to be differentially expressed by NUDGE are shown by small dots. Negative controls are indicated by a box. No negative controls were found to be differentially expressed by NUDGE.</p>
        </caption>
        <graphic xlink:href="1471-2105-6-173-1"/>
      </fig>
      <p>Table <xref ref-type="table" rid="T1">1</xref> shows the results of different methods for the control genes. NUDGE had a perfect result for these genes, with no false positives and no false negatives. The Bonferroni-corrected <italic>t </italic>test was the only method considered that recorded any false negatives. The rule of two (normalized or unnormalized), SAM and the EBarrays Lognormal-Normal model all had false positives. Only the EBarrays Gamma-Gamma model equaled NUDGE's performance on these control genes.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Summary of Results for HIV data for control genes</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="center">Method</td>
              <td align="center">Number of False Negatives</td>
              <td align="center">Number of False Positives</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">Rule of Two (on unnormalized data)</td>
              <td align="center">0</td>
              <td align="center">3</td>
            </tr>
            <tr>
              <td align="center">Rule of Two (on variance normalized data)</td>
              <td align="center">0</td>
              <td align="center">1</td>
            </tr>
            <tr>
              <td align="center">NUDGE</td>
              <td align="center">0</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td align="center">SAM</td>
              <td align="center">0</td>
              <td align="center">2</td>
            </tr>
            <tr>
              <td align="center">EBarrays (GG)</td>
              <td align="center">0</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td align="center">EBarrays (LNN)</td>
              <td align="center">0</td>
              <td align="center">1</td>
            </tr>
            <tr>
              <td align="center"><italic>t </italic>test</td>
              <td align="center">0</td>
              <td align="center">1</td>
            </tr>
            <tr>
              <td align="center">Bonferroni corrected <italic>t </italic>test</td>
              <td align="center">1</td>
              <td align="center">0</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>In order to assess the stability of the different methods, the four replicates were split into two different subsets of two replicates each (still with balanced dye swaps), and the agreements and disagreements between the genes found to be differentially expressed in each of the two datasets was calculated for each of the methods. A summary of the results is given in Table <xref ref-type="table" rid="T2">2</xref>. The number of genes found to be differentially expressed in each of the datasets by each method is given in Table <xref ref-type="table" rid="T3">3</xref>.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Number of agreements and disagreements between the differentially expressed genes found in the two sets of two replicates for the HIV data</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">NUDGE</td>
              <td align="center">SAM</td>
              <td align="center">EBarrays GG</td>
              <td align="center">EBarrays LNN</td>
              <td align="center"><italic>t </italic>test</td>
              <td align="center">Bonferroni <italic>t </italic>test</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">Agreements</td>
              <td align="center">14</td>
              <td align="center">19</td>
              <td align="center">13</td>
              <td align="center">13</td>
              <td align="center">34</td>
              <td align="center">15</td>
            </tr>
            <tr>
              <td align="center">Disagreements</td>
              <td align="center">27</td>
              <td align="center">153</td>
              <td align="center">16</td>
              <td align="center">32</td>
              <td align="center">531</td>
              <td align="center">217</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Number of genes declared to be differentially expressed by each method for the HIV data using 2 and 4 replicates</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">NUDGE</td>
              <td align="center">SAM</td>
              <td align="center">EBarrays GG</td>
              <td align="center">EBarrays LNN</td>
              <td align="center"><italic>t </italic>test</td>
              <td align="center">Bonferroni <italic>t </italic>test</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">All 4 replicates</td>
              <td align="center">16</td>
              <td align="center">42</td>
              <td align="center">24</td>
              <td align="center">19</td>
              <td align="center">26</td>
              <td align="center">12</td>
            </tr>
            <tr>
              <td align="left">Replicates 1&amp;3</td>
              <td align="center">30</td>
              <td align="center">49</td>
              <td align="center">23</td>
              <td align="center">27</td>
              <td align="center">193</td>
              <td align="center">83</td>
            </tr>
            <tr>
              <td align="left">Replicates 2&amp;4</td>
              <td align="center">25</td>
              <td align="center">142</td>
              <td align="center">19</td>
              <td align="center">31</td>
              <td align="center">406</td>
              <td align="center">164</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Comparison of results depends on how one weights agreement (roughly indicating true positives) against disagreement (roughly indicating false positives). NUDGE had more agreement and less disagreement than EBarrays-LNN, and thus dominated it on both these criteria. The <italic>t </italic>test, both raw and corrected, and SAM, had more agreement, but at the cost of a much higher level of disagreement than NUDGE. NUDGE had more agreement, but also significantly more disagreement, than EBarrays with a Gamma-Gamma model.</p>
      <p>Finally in order to check the empirical fit of the model to this data (where we know we have both differentially and non-differentially expressed genes) we plot the model's fitted density over a histogram of the normalized log ratios in Figure <xref ref-type="fig" rid="F2">2</xref>. The model seems to fit the normalized data fairly well.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>Overlay of the model's fitted density on the normalized log ratios</bold>. Plot (a) shows a histogram of the normalized average log ratios for the HIV data along with a dashed line showing the model-fitted density. Plot (b) shows a close-up of the right-hand tail of the histogram (where the positive controls lie) with a dashed line showing the model-fitted density.</p>
        </caption>
        <graphic xlink:href="1471-2105-6-173-2"/>
      </fig>
    </sec>
    <sec>
      <title>Like-like dataset</title>
      <p>This dataset is from a microarray experiment where the same samples (with different dyes) were hybridized to an array with 7680 genes. The expression levels in the red and green dyes were extracted from the image using customized software written at the University of Washington (Spot-On Image, developed by R. E. Bumgarner and Erick Hammersmark). The genes should be equally highly expressed, as each sample is the same, so ideally we should find few differentially expressed genes.</p>
      <p>Figure <xref ref-type="fig" rid="F3">3 (a)</xref> shows the log ratios plotted against the log intensities. Here we see evidence of the dye effect, since if it were not present the data would fall with some variation about a zero-intercept horizontal line. Figure <xref ref-type="fig" rid="F3">3 (b)</xref> is a plot of the mean-normalized log ratio against the log intensity. In Figure <xref ref-type="fig" rid="F4">4</xref> we plot the absolute mean-normalized log ratio as a function of log intensity. We use a loess smoother of this as a robust estimate of how spread depends on log intensity. This is used to get the loess variance-normalized log ratios, which are plotted against the log intensities in Figure <xref ref-type="fig" rid="F3">3 (c)</xref>. The data now look much more normal and homoscedastic. The NUDGE method took less than 5 seconds to run with 10 iterations of the EM algorithm.</p>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>Different Normalizations of Like-like Data</bold>. Different normalizations of Like-like data: (a) raw data, (b) data normalized with respect to the mean, (c) data normalized with respect to both mean and variance. Diff. Exp. genes are genes found to be differentially expressed by NUDGE (with posterior probability greater than 0.5).</p>
        </caption>
        <graphic xlink:href="1471-2105-6-173-3"/>
      </fig>
      <fig position="float" id="F4">
        <label>Figure 4</label>
        <caption>
          <p><bold>Absolute mean normalized log ratio versus log intensity for Like-like Data</bold>. Absolute mean normalized log ratio versus log intensity for Like-like Data. The loess line in this plot represents the estimate of the gene-specific Mean Absolute Deviation (MAD), a robust estimator of spread.</p>
        </caption>
        <graphic xlink:href="1471-2105-6-173-4"/>
      </fig>
      <p>The results are summarized in Table <xref ref-type="table" rid="T4">4</xref>. NUDGE found 28 differentially expressed genes (with posterior probability greater than 0.5). This is a false positive rate of 0.4%. With no normalization, the rule of two declared 3233 genes to be differentially expressed, 42.1% of the total; clearly this is not appropriate. After the data had been mean-normalized, the rule of two found 281 differentially expressed genes, a false positive rate of 3.7%. When the data have been mean- and variance-normalized, the rule of two finds 105 genes, a false positive rate of 1.4%, still higher than NUDGE. Since there is only one replicate in this case, neither <italic>t </italic>tests, SAM nor EBarrays can be used to test for differential expression.</p>
      <table-wrap position="float" id="T4">
        <label>Table 4</label>
        <caption>
          <p>Results for the Like-like data</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="center">Method</td>
              <td align="center">Estimated False Positive Rate</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">Rule of Two (on unnormalized data)</td>
              <td align="center">42.1%</td>
            </tr>
            <tr>
              <td align="center">Rule of Two (on mean loess normalised data)</td>
              <td align="center">3.7%</td>
            </tr>
            <tr>
              <td align="center">Rule of Two (on mean and variance loess normalised data)</td>
              <td align="center">1.4%</td>
            </tr>
            <tr>
              <td align="center">NUDGE</td>
              <td align="center">0.4%</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>SAM, EBarrays and t tests are not applicable to single slide data.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Apo AI dataset</title>
      <p>This dataset was analyzed in [<xref ref-type="bibr" rid="B1">1</xref>] and 8 genes were suggested to be differentially expressed. The data was obtained from 8 mice with the Apo AI gene knocked out and 8 normal mice. However the replicates were not created simply by comparing samples from control labeled with one dye versus knock-out mice labeled with the other. Instead, cDNA was created from samples from each of the 16 mice (both control and knock-out) and labeled with a red dye. The green dye was used in all cases on cDNA created by pooling all 8 control mice. The statistic used in [<xref ref-type="bibr" rid="B1">1</xref>] was</p>
      <p>
        <inline-graphic xlink:href="1471-2105-6-173-i1.gif"/>
      </p>
      <p>We used the numerator of this statistic, which is the same as <italic>M </italic>defined in equation (7) below, in place of ordinary average log ratios, as detailed in the Methods section. Again the method took only a few seconds to run. Figure <xref ref-type="fig" rid="F5">5</xref> shows the data at different stages of normalization along with the genes found to be differentially expressed in [<xref ref-type="bibr" rid="B1">1</xref>]. Table <xref ref-type="table" rid="T5">5</xref> shows the gene position numbers of those genes whose posterior probability of being differentially expressed was in the top sixteen found by NUDGE. All eight of the genes found by [<xref ref-type="bibr" rid="B1">1</xref>] to be differentially expressed were also found to be differentially expressed with high probability by our method. The lines in Figure <xref ref-type="fig" rid="F5">5</xref> indicating the rule of two cut-off appear either to miss genes that are differentially expressed (in the unnormalized and mean-normalized cases), or to give a large number of possible false positives (in the mean- and variance-normalized case).</p>
      <table-wrap position="float" id="T5">
        <label>Table 5</label>
        <caption>
          <p>NUDGE's Top 16 Genes from the Apo data</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="center" colspan="3">Top 16 genes in terms of NUDGE posterior probability of differential expression</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">Row numbers in data matrix</td>
              <td align="center">Probability of differential expression</td>
              <td align="center">Found by Dudoit et al [1]?</td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">540</td>
              <td align="center">1.000</td>
              <td align="center">Yes</td>
            </tr>
            <tr>
              <td align="center">2149</td>
              <td align="center">1.000</td>
              <td align="center">Yes</td>
            </tr>
            <tr>
              <td align="center">5356</td>
              <td align="center">1.000</td>
              <td align="center">Yes</td>
            </tr>
            <tr>
              <td align="center">1739</td>
              <td align="center">0.999</td>
              <td align="center">Yes</td>
            </tr>
            <tr>
              <td align="center">4139</td>
              <td align="center">0.999</td>
              <td align="center">Yes</td>
            </tr>
            <tr>
              <td align="center">2537</td>
              <td align="center">0.998</td>
              <td align="center">Yes</td>
            </tr>
            <tr>
              <td align="center">4941</td>
              <td align="center">0.993</td>
              <td align="center">Yes</td>
            </tr>
            <tr>
              <td align="center">1496</td>
              <td align="center">0.829</td>
              <td align="center">Yes</td>
            </tr>
            <tr>
              <td colspan="3">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">5986</td>
              <td align="center">0.330</td>
              <td align="center">No</td>
            </tr>
            <tr>
              <td align="center">541</td>
              <td align="center">0.263</td>
              <td align="center">No</td>
            </tr>
            <tr>
              <td align="center">716</td>
              <td align="center">0.099</td>
              <td align="center">No</td>
            </tr>
            <tr>
              <td align="center">2538</td>
              <td align="center">0.087</td>
              <td align="center">No</td>
            </tr>
            <tr>
              <td align="center">1224</td>
              <td align="center">0.066</td>
              <td align="center">No</td>
            </tr>
            <tr>
              <td align="center">799</td>
              <td align="center">0.060</td>
              <td align="center">No</td>
            </tr>
            <tr>
              <td align="center">1204</td>
              <td align="center">0.057</td>
              <td align="center">No</td>
            </tr>
            <tr>
              <td align="center">3729</td>
              <td align="center">0.050</td>
              <td align="center">No</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <fig position="float" id="F5">
        <label>Figure 5</label>
        <caption>
          <p><bold>Different Normalizations of Apo Data</bold>. Different Normalizations of Apo data: (a) raw data, (b) data normalized with respect to the mean, (c) data normalized with respect to both mean and variance. Diff. Exp. genes are genes found to be differentially expressed by NUDGE (with posterior probability greater than 0.5).</p>
        </caption>
        <graphic xlink:href="1471-2105-6-173-5"/>
      </fig>
      <p>For application of SAM, the data were normalized in the standard way, by centering the log ratios across genes within a replicate about zero. Two different levels of the SAM control parameter delta gave reasonable answers when using SAM on this data set. The first level (0.61) found 15 genes to be differentially expressed, including the eight genes found in [<xref ref-type="bibr" rid="B1">1</xref>] and by NUDGE, and the False Discovery Rate was estimated to be 5.3%. If we assume that only these eight genes are correct, this would actually correspond to a False Positive Rate of 46.7%. The second level (3.53) found six genes to be differentially expressed, a subset of the eight genes found by [<xref ref-type="bibr" rid="B1">1</xref>], and the False Discovery Rate was estimated to be 13.3%. Assuming that only those eight genes are correct, this corresponds to a False Positive Rate of 0% but a False Negative Rate of 25%. These were the best results we obtained using SAM.</p>
      <p>For similarly normalized data, both the <italic>t </italic>test and the Bonferroni adjusted <italic>t </italic>test found the 8 genes identified by [<xref ref-type="bibr" rid="B1">1</xref>] to be differentially expressed. However, the <italic>t </italic>test found an additional 852 genes to be differentially expressed at the 5% significance level (13.5% of all genes), and the Bonferroni adjusted <italic>t </italic>test found an additional two genes to be differentially expressed. A summary of the results for the Apo data is given in Table <xref ref-type="table" rid="T6">6</xref>.</p>
      <table-wrap position="float" id="T6">
        <label>Table 6</label>
        <caption>
          <p>Results for the Apo data</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="center">Method</td>
              <td align="center">Number of 8 Dudoit et al [1] genes found to be differentially expressed</td>
              <td align="center">Number of other genes found to be differentially expressed</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">Rule of Two (on unnormalized data)</td>
              <td align="center">3</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td align="center">Rule of Two (on mean normalized data)</td>
              <td align="center">7</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td align="center">Rule of Two (on mean and variance normalized data)</td>
              <td align="center">8</td>
              <td align="center">134</td>
            </tr>
            <tr>
              <td align="center">NUDGE</td>
              <td align="center">8</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td align="center">SAM (delta = 0.61)</td>
              <td align="center">8</td>
              <td align="center">7</td>
            </tr>
            <tr>
              <td align="center">SAM (delta = 3.53)</td>
              <td align="center">6</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td align="center"><italic>t </italic>test</td>
              <td align="center">8</td>
              <td align="center">852</td>
            </tr>
            <tr>
              <td align="center">Bonferroni corrected <italic>t </italic>test</td>
              <td align="center">8</td>
              <td align="center">2</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We have proposed a simple method for detecting differentially expressed genes that is fast and can be applied to single-slide and multiple-replicate experiments, as well as to log ratio difference experiments. It accounts for the multiple comparisons involved, and produces a posterior probability of differential expression for each gene, rather than just a yes/no testing result. The posterior probabilities can be used either to declare which genes are differentially expressed, or to produce a ranked list of genes for further analysis. The method worked well for the three datasets that we analyzed. In terms of known false positives and false negatives, the method outperforms all multiple-replicate methods except for the Gamma-Gamma EBarrays method to which it offers comparable results with the added advantages of greater simplicity, speed, fewer assumptions and applicability to the single replicate case.</p>
    <p>Our method can be seen as a parametric alternative to adjustment of tests for multiple comparisons using false discovery rate ideas [<xref ref-type="bibr" rid="B11">11</xref>], or empirical Bayes formulations [<xref ref-type="bibr" rid="B12">12</xref>]. A similar idea was proposed in [<xref ref-type="bibr" rid="B13">13</xref>] for large numbers of tests, in which the distribution of the test statistic was modeled as a mixture of two normals, one corresponding to the null hypothesis being true, and the other to its being false. This differs from our approach in that we use a uniform distribution for the mixture component that corresponds to departures from the null, rather than a mean-shifted normal. Because of this, a method such as [<xref ref-type="bibr" rid="B13">13</xref>] could not find both over- and underexpressed genes.</p>
    <p>A similar idea with different distributional assumptions, using only normally distributed components is given in [<xref ref-type="bibr" rid="B8">8</xref>]. Instead of the average log ratios used in the method presented in this paper, [<xref ref-type="bibr" rid="B8">8</xref>] use a t-type statistic using the difference of average gene intensities. A more complex approach given by [<xref ref-type="bibr" rid="B14">14</xref>] involves modeling each level of differential expression with its own normal component.</p>
    <p>In our approach the important aspect of the mixture is the cutoff points where the weighted normal density falls below the height of the weighted uniform density. Points beyond the cutoff are declared to be differentially expressed (under a 0.5 posterior probability rule). These cut-off points are relatively unaffected by outliers which affect the range of the data and thus the range and height of the uniform component, because the normal density falls off very rapidly towards the tails, and also because the estimated mixture weights change accordingly.</p>
    <p>An important part of the method is normalization in terms of variance as well as mean. This extends the original lowess normalization in [<xref ref-type="bibr" rid="B1">1</xref>]. As a preprocessing step, it improves the performance not only of NUDGE, but also of other methods, including the simplest of all, the rule of two. Thus, this normalization method may be useful as a preprocessing tool for analysis of differential gene expression, regardless of which method is used to draw final inferences.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Model for detecting differential expression</title>
      <p>Our methods are applied to averages of normalized log ratios; we discuss the specification of these quantities in different experimental settings in the section on normalizations below. In this section we will refer to them simply as observed log ratios. We use logarithms to base 2.</p>
      <p>Our model is a normal-uniform mixture model [<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B16">16</xref>]. We begin by modeling the genes as two different groups: differentially expressed and non-differentially expressed. Each group is modeled by its own density, and so the data as a whole are modeled by a weighted mixture of these densities, where the weights correspond to the prior probabilities of being in each of the two groups. This results in a mixture model with two components. Since genes that are not differentially expressed have a true log ratio of zero, we model the observed log ratios for these genes, after an appropriate transformation, as a group with a Gaussian density. The differentially expressed genes have log ratios that are, for the most part, in some sense "far" from the other group. So these genes can be viewed as outliers from the main distribution of non-differentially expressed genes. These genes are modeled as uniformly distributed over an appropriately wide range.</p>
      <p>The model is</p>
      <p>
        <inline-graphic xlink:href="1471-2105-6-173-i2.gif"/>
      </p>
      <p>where <italic>x</italic><sub><italic>i </italic></sub>is the observed log ratio for gene <italic>i</italic>, <italic>π </italic>is the prior probability that a gene is not differentially expressed, <italic>N </italic>(<italic>x</italic>|<italic>μ</italic>, <italic>σ</italic><sup>2</sup>) denotes a Gaussian distribution with mean <italic>μ </italic>and variance <italic>σ</italic><sup>2</sup>, <italic>U</italic><sub>[<italic>a</italic>,<italic>b</italic>]</sub>(<italic>x</italic>) denotes a uniform distribution on the interval [<italic>a</italic>, <italic>b</italic>], and <italic>N </italic>is the number of genes.</p>
      <p>We estimate the model by maximum likelihood using the EM algorithm [<xref ref-type="bibr" rid="B17">17</xref>]. We define the unknown labels, <italic>z</italic><sub><italic>i</italic></sub><italic>, i = </italic>1,..., <italic>N</italic>, where <italic>z</italic><sub><italic>i </italic></sub>is 0 if gene <italic>i </italic>is not differentially expressed and 1 if it is. There are two steps in the algorithm: the Expectation, or E step, where the labels are estimated given the current parameter estimates, and the Maximization, or M step, where the model parameters, <italic>π</italic>, <italic>μ </italic>and <italic>σ</italic><sup>2</sup>, are estimated given the current estimates of the labels. The maximum likelihood estimates of <italic>a </italic>and <italic>b </italic>are <inline-graphic xlink:href="1471-2105-6-173-i3.gif"/> = min{<italic>x</italic><sub><italic>i </italic></sub>: <italic>i </italic>= 1,..., <italic>N</italic>}, and <inline-graphic xlink:href="1471-2105-6-173-i4.gif"/> = max{<italic>x</italic><sub><italic>i </italic></sub>: <italic>i </italic>= 1,..., <italic>N</italic>}; these do not change during the algorithm. The steps in the algorithm are as follows:</p>
      <sec>
        <title>Iteration k</title>
        <sec>
          <title>Expectation Step</title>
          <p>
            <inline-graphic xlink:href="1471-2105-6-173-i5.gif"/>
          </p>
        </sec>
        <sec>
          <title>Maximization Step</title>
          <p>
            <inline-graphic xlink:href="1471-2105-6-173-i6.gif"/>
          </p>
          <p>The likelihood for the model given parameter estimates at iteration <italic>k </italic>is</p>
          <p>
            <inline-graphic xlink:href="1471-2105-6-173-i7.gif"/>
          </p>
          <p>The above steps are iterated until convergence. Convergence can be checked by calculating the parameter estimates, the labels, and the logarithm of the likelihood at each step, given the current estimates of the parameters. Once the change in these quantities between steps gets small enough the algorithm is deemed to have converged. The increasing property of the EM algorithm guarantees that a local maximum is reached, but a global maximum cannot be guaranteed. This depends on the starting values. For the analyses in this paper, the starting value for the label z<sub><italic>i </italic></sub>was 1 if gene <italic>i</italic>'s observed log ratio, minus the mean value for all genes and divided by the standard deviation of the values across all genes, was greater than 2 in absolute value, and 0 otherwise. This appeared to give good results.</p>
          <p>The final label estimate for gene <italic>i</italic>, <inline-graphic xlink:href="1471-2105-6-173-i8.gif"/>, is the posterior probability that it is differentially expressed, given the parameter estimates. The posterior probabilities do not need to be adjusted for multiple comparisons.</p>
        </sec>
      </sec>
    </sec>
    <sec>
      <title>Normalizations</title>
      <p>There are two different types of experimental setup for which we will discuss normalization. The first is where the two different samples, say control and treatment, have each been labeled with a different color dye, say treatment with red (Cy5, R) and control with green (Cy3, G). In the second experimental setup, the treatment and control samples have replicates, with both control and treatment replicates being labeled with the same dye, say red (Cy5, R), and these are compared to a reference sample labeled with the other dye.</p>
      <p>Two of the data sets analyzed in this paper, the HIV and the Like-like datasets, are of the first type of setup. The other data set analyzed in this paper is the Apo AI mouse data [<xref ref-type="bibr" rid="B1">1</xref>] which is of the second type of setup, with pooled control mRNA used as its reference sample. Since there are slightly different normalizations and quantities of interest used for analysis in these two cases, we will discuss them separately below, referring to the first experiment type as the log ratio experiment (since the log ratios are the quantities of interest), and to the second as the log ratio difference experiment (since the differences of log ratios between control and treatment samples are the quantities of interest).</p>
      <sec>
        <title>Normalizations for the log ratio cDNA experiment</title>
        <p>The main problem in applying the Normal-Uniform mixture model is that the data need to be normalized in order for this model to be appropriate. In the basic type of cDNA experiment, the log ratio of expressions in the two samples is the quantity of interest. There are dye and other effects that add a bias, making the mean of the non-differentially expressed log ratios non-zero (see the Like-like example in the Results section). Also, the variance of the log ratios depends on the log of the total intensity, where the total intensity is defined as the product of the red and green intensities. We need to ensure that any normalization does not "pull in" the differentially expressed genes.</p>
      </sec>
      <sec>
        <title>Single slide normalizations</title>
        <p>The normalization of single slide log ratios is a two-step process. In the first step, the observed log ratios are regressed nonparametrically on the log intensities, using the lowess regression smoother [<xref ref-type="bibr" rid="B18">18</xref>], and the fitted value is subtracted from the observed log ratios. In our implementation, a modification, the loess smoother [<xref ref-type="bibr" rid="B19">19</xref>], is used in place of lowess. Specifically,</p>
        <p>
          <inline-graphic xlink:href="1471-2105-6-173-i9.gif"/>
        </p>
        <p>where <italic>R </italic>and <italic>G </italic>are the intensities in the red and green channels, and <italic>c</italic>(log(<italic>RG</italic>)) is the fitted value from loess regression of log(<italic>R</italic>/<italic>G</italic>) on log(<italic>RG</italic>), a situation we denote by <inline-graphic xlink:href="1471-2105-6-173-i10.gif"/>.</p>
        <p>We got good results with a loess span in the range 60% to 80%. This generally did a good job of normalizing the mean but not the spread.</p>
        <p>The spread depends on the log intensity, log(<italic>RG</italic>), and we estimate a running mean absolute deviation by loess regression of the absolute mean-normalized log ratio on the log intensity. We then divide the mean-normalized log ratio by the loess-estimated mean absolute deviation in order to get our final estimate,</p>
        <p>
          <inline-graphic xlink:href="1471-2105-6-173-i11.gif"/>
        </p>
        <p>where <inline-graphic xlink:href="1471-2105-6-173-i12.gif"/>. We got good results with a span between 10% and 20%. As can be seen from the figures in the Results section, this does a good job of making the log ratios for non-differentially expressed genes approximately normal and homoscedastic.</p>
      </sec>
      <sec>
        <title>Multiple slide normalizations with dye swap</title>
        <p>In dye swap experiments, there is an even number of replicates and they are divided into two groups with equal numbers of replicates. In the second group of replicates, the assignment of dyes to samples is the reverse of that in the first group. Log ratios in this case are taken with the different samples as numerator and denominator (since the assigned dyes will be different for the two groups and averaging must be done over the same ratio of samples not the same ratio of dyes). In that case, mean normalization is unnecessary, although normalization of the variance is still required. This is because we take the average of the log ratios across replicates, ensuring that the dye effect cancels out.</p>
      </sec>
      <sec>
        <title>Multiple slide normalizations without dye swap</title>
        <p>Here we take the average of log ratios and log intensities across replicates for each of the genes and apply the mean lowess normalization, given by equation (4), with average ratios and intensities in place of the single replicate log ratios and intensities.</p>
        <p>The variance normalization is not the same for multiple replicate slides as for a single slide. Because the average log ratios are not robust to outliers, even after mean normalization, we carry out a normalization based on variation across replicates rather than on variation depending on intensities, to downweight the influence of outlying observations. If the empirical standard deviation of the log ratios across replicates is greater than the absolute mean-normalized average log ratio for a gene, we divide its mean-normalized average log ratio by its standard deviation. If the empirical standard deviation of the log ratios across replicates is small, defined as smaller than the absolute mean-normalized average log ratio, we divide instead by a constant. The constant is chosen to be a high percentile (we use the 99th) of the distribution of the standard deviations of genes for which the absolute mean-normalized average log ratio is greater than the standard deviation. This avoids a gene being declared differentially expressed just because its empirical across-replicate standard deviation is small, as can easily happen by chance when there are few replicates. Thus the mean- and variance-normalized log ratio for a given gene is:</p>
        <p>
          <inline-graphic xlink:href="1471-2105-6-173-i13.gif"/>
        </p>
        <p>where <italic>m </italic>is the number of replicates, <italic>q</italic><sub><italic>j </italic></sub>is the mean-normalized log ratio of replicate <italic>j</italic>, <italic>s </italic>is the standard deviation of log ratios across replicates, and <italic>k </italic>is the chosen percentile of the distribution of standard deviations of genes whose absolute mean-normalized average log ratio is greater than their standard deviation.</p>
      </sec>
      <sec>
        <title>Normalizations for the log ratio difference cDNA experiment</title>
        <p>Here the quantity of interest is the difference in log ratios between control and treatment replicates. We define</p>
        <p>
          <inline-graphic xlink:href="1471-2105-6-173-i14.gif"/>
        </p>
        <p>
          <inline-graphic xlink:href="1471-2105-6-173-i15.gif"/>
        </p>
        <p>where <italic>n</italic><sub><italic>treatment </italic></sub>is the number of treatment replicates, <italic>n</italic><sub><italic>control </italic></sub>is the number of control replicates, <italic>n </italic>= <italic>n</italic><sub><italic>treatment </italic></sub>+ <italic>n</italic><sub><italic>control</italic></sub>, <italic>q</italic><sub><italic>treatment</italic>,<italic>i </italic></sub>is the log ratio of treatment replicate <italic>i </italic>and <italic>q</italic><sub><italic>control</italic>,<italic>j </italic></sub>is the log ratio of control replicate <italic>j</italic>. With these definitions we give the multiple-replicates normalizations, defined analogously to those in the log ratio type experiment.</p>
      </sec>
      <sec>
        <title>Multiple slide normalizations</title>
        <p>We again use loess to allow dependence of the mean normalization of M on A in the following way:</p>
        <p><italic>M</italic><sub><italic>norm </italic></sub>= <italic>M </italic>- <italic>c</italic>(<italic>A</italic>)     (9)</p>
        <p>where <italic>c</italic>(<italic>A</italic>) = <italic>loess</italic>(<italic>M </italic>~ <italic>A</italic>), with the recommended span for the loess smoother being between 60% and 80%.</p>
        <p>For the variance normalization we again use the information about the variance contained in the replicates to get a robust estimator of the overall variance. We calculate the variance of log ratios across the <italic>n</italic><sub><italic>control </italic></sub>replicates in the control dataset and call this <italic>V</italic><sub><italic>control</italic></sub>. Similarly we calculate the variance of log ratios across the <italic>n</italic><sub><italic>treatment </italic></sub>replicates in the treatment dataset and call this <italic>V</italic><sub><italic>treatment</italic></sub>. Our estimate for the standard deviation s, in M for each gene is given by</p>
        <p>
          <inline-graphic xlink:href="1471-2105-6-173-i16.gif"/>
        </p>
        <p>We then develop the variance normalization similarly to the previous log ratio type experiment case. The variance normalization is given by</p>
        <p>
          <inline-graphic xlink:href="1471-2105-6-173-i17.gif"/>
        </p>
      </sec>
    </sec>
    <sec>
      <title>Summary of model and normalizations for different experiments</title>
      <p>A summary of the quantities of interest (used in the normalizations and normal uniform mixture model) and the normalizations is given in Table <xref ref-type="table" rid="T7">7</xref>. An R package called <underline>nudge</underline> to implement the different normalizations and fit the model in this paper will be made available soon at [<xref ref-type="bibr" rid="B9">9</xref>].</p>
      <table-wrap position="float" id="T7">
        <label>Table 7</label>
        <caption>
          <p>Summary of Methods</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="center">Type of Experiment</td>
              <td align="center">Multiple Replicates?</td>
              <td align="center">Dye Swap?</td>
              <td align="center">Quantity of Interest</td>
              <td align="center">Mean Normalization</td>
              <td align="center">Variance Normalization</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">Sample 1 = Red, Sample 2 = Green</td>
              <td align="center">No</td>
              <td align="center">NA</td>
              <td align="center">
                <graphic xlink:href="1471-2105-6-173-i18.gif"/>
              </td>
              <td align="center">Equation (4)</td>
              <td align="center">Equation (5)</td>
            </tr>
            <tr>
              <td align="center">Sample 1 = Red, Sample 2 = Green</td>
              <td align="center">Yes</td>
              <td align="center">No</td>
              <td align="center">
                <graphic xlink:href="1471-2105-6-173-i19.gif"/>
              </td>
              <td align="center">Equation (4)</td>
              <td align="center">Equation (6)</td>
            </tr>
            <tr>
              <td align="center">Sample <graphic xlink:href="1471-2105-6-173-i20.gif"/> = Red, Sample <graphic xlink:href="1471-2105-6-173-i21.gif"/> = Green Sample <graphic xlink:href="1471-2105-6-173-i22.gif"/> = Green, Sample <graphic xlink:href="1471-2105-6-173-i23.gif"/> = Red</td>
              <td align="center">Yes</td>
              <td align="center">Yes</td>
              <td align="center">
                <graphic xlink:href="1471-2105-6-173-i24.gif"/>
              </td>
              <td align="center">NA</td>
              <td align="center">Equation (6)</td>
            </tr>
            <tr>
              <td align="center">Sample 1 &amp; 2 = Red, Reference = Green</td>
              <td align="center">Yes</td>
              <td align="center">NA</td>
              <td align="center">M, Equation (7)</td>
              <td align="center">Equation (9)</td>
              <td align="center">Equation (11)</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>Methods for comparison with NUDGE</title>
      <p>We now give brief descriptions of the methods for finding differentially expressed genes that will be used for comparison with NUDGE in the datasets examined in the Results section.</p>
      <sec>
        <title>Rule of two</title>
        <p>This simple but popular method, mentioned in [<xref ref-type="bibr" rid="B3">3</xref>], involves examining the ratios or average ratios of the two channels for each gene, and calling those genes with a ratio or average ratio greater than two or less than half, differentially expressed. It requires some initial normalization and its performance can depend on the normalization.</p>
      </sec>
      <sec>
        <title>t test and adjusted t test</title>
        <p>One of the most obvious first approaches to try for this problem is the classical <italic>t </italic>test, as used, for example, in [<xref ref-type="bibr" rid="B20">20</xref>]. A simple normalization consisting of centering the mean of the log ratios within each replicate is often used in this case. One needs to be able to estimate the standard deviations as well.</p>
        <p>Because of the large number of tests being run (thousands in the usual cDNA experiment setup), the standard <italic>t </italic>test needs to be modified to account for the multiple testing. Traditionally the most popular adjustment has been the Bonferroni correction, as mentioned in [<xref ref-type="bibr" rid="B21">21</xref>]. For the Bonferroni correction with <italic>N </italic>genes/tests and significance level <italic>α</italic>, we instead call each test significant only if it is significant at the <inline-graphic xlink:href="1471-2105-6-173-i25.gif"/> level, controlling for the probability of one or more false positives.</p>
      </sec>
      <sec>
        <title>EBarrays</title>
        <p>This follows a hierarchical Bayes approach for modeling the gene expression levels as detailed in [<xref ref-type="bibr" rid="B22">22</xref>]. As in our approach, the data are assumed to be generated by a two-component mixture model, one component for differentially expressed and the other for non-differentially expressed genes, each with their own distribution. The parameters specifying these distributions are estimated from the data, whence the name Empirical Bayes.</p>
        <p>Results in this framework are given for two different parametric models in [<xref ref-type="bibr" rid="B22">22</xref>]. In the first model, the observed intensities for the replicates in each channel are assumed to be independently generated from a gamma distribution with a channel-specific scale parameter. The scale parameters are, in turn, assumed to have an inverse gamma distribution, whose parameters are estimated from the whole dataset. In the second model, the log ratios are assumed to be normally distributed, with gene-specific means that are themselves normally distributed. To normalize, the authors divided the log ratio for a given gene and replicate by the average log ratio across genes for that replicate.</p>
      </sec>
      <sec>
        <title>Significance analysis of microarrays (SAM) [<xref ref-type="bibr" rid="B4">4</xref>]</title>
        <p>The statistic used to test for differential expression is a regularized <italic>t </italic>statistic, i.e. the mean value divided by the sum of the standard deviation and a constant. SAM controls the False Discovery Rate (FDR), i.e. the number of genes declared to be differentially expressed that are not in truth differentially expressed.</p>
        <p>A rejection region is fixed and SAM uses a permutation analysis to estimate the FDR. The user then decides on an acceptable rejection region based on their preferences for FDR.</p>
      </sec>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>We thank Roger Bumgarner, Ka Yee Yeung and Raphael Gottardo for helpful comments and use of data. This research was supported by NIH grant 8 R01 EB002137-02.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>YH</given-names>
          </name>
          <name>
            <surname>Callow</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Statistical Methods for identifying differentially expressed genes in replicated cDNA microarray experiments</article-title>
        <source>Stat Sin</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>111</fpage>
        <lpage>139</lpage>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dougherty</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Bittner</surname>
            <given-names>ML</given-names>
          </name>
        </person-group>
        <article-title>Ratio-based decisions and the quantitative analysis of cDNA microarray images</article-title>
        <source>J Biomed Optics</source>
        <year>1997</year>
        <volume>2</volume>
        <fpage>364</fpage>
        <lpage>374</lpage>
        <pub-id pub-id-type="doi">10.1117/1.429838</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schena</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shalon</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Heller</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chai</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>RW</given-names>
          </name>
        </person-group>
        <article-title>Parallel human genome analysis: Microarray-based expression monitoring of 1000 genes</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>1996</year>
        <volume>93</volume>
        <fpage>10614</fpage>
        <lpage>10619</lpage>
        <pub-id pub-id-type="pmid">8855227</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.93.20.10614</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tusher</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chu</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Significance analysis of microarrays applied to the ionizing radiation response</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>5116</fpage>
        <lpage>5121</lpage>
        <pub-id pub-id-type="pmid">11309499</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.091062498</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shaffer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Boldrick</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Multiple hypothesis testing in microarray experiments</article-title>
        <source>Stat Sci</source>
        <year>2003</year>
        <volume>18</volume>
        <fpage>71</fpage>
        <lpage>103</lpage>
        <pub-id pub-id-type="doi">10.1214/ss/1056397487</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Newton</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Kendziorski</surname>
            <given-names>CM</given-names>
          </name>
        </person-group>
        <source>The Analysis of Gene Expression Data: Methods and Software</source>
        <publisher-name>Springer, N.Y. 2003 chap. Parametric Empirical Bayes Methods for Microarrays</publisher-name>
        <fpage>254</fpage>
        <lpage>271</lpage>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newton</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Kendziorski</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Richmond</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Blattner</surname>
            <given-names>FR</given-names>
          </name>
          <name>
            <surname>Tsui</surname>
            <given-names>KW</given-names>
          </name>
        </person-group>
        <article-title>On differential variability of expression ratios: Improving statistical inference about gene expression changes from microarray data</article-title>
        <source>J Complit Biol</source>
        <year>2001</year>
        <volume>8</volume>
        <fpage>37</fpage>
        <lpage>52</lpage>
        <pub-id pub-id-type="doi">10.1089/106652701300099074</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Le</surname>
            <given-names>CT</given-names>
          </name>
        </person-group>
        <article-title>A Mixture Model Approach to Detecting Differentially Expressed Genes with Microarray Data</article-title>
        <source>Fund Integr Genomics</source>
        <year>2003</year>
        <volume>3</volume>
        <fpage>117</fpage>
        <lpage>124</lpage>
        <pub-id pub-id-type="pmid">12844246</pub-id>
        <pub-id pub-id-type="doi">10.1007/s10142-003-0085-7</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="other">
        <article-title>Bioconductor</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org"/>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van't Wout</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Lehrma</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Mikheeva</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>O'Keeffe</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Katze</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>Bumgarner</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Geiss</surname>
            <given-names>GK</given-names>
          </name>
          <name>
            <surname>Mullins</surname>
            <given-names>JI</given-names>
          </name>
        </person-group>
        <article-title>Cellular gene expression upon human immunodeficiency virus type 1 infection of CD4+-T-Cell lines</article-title>
        <source>J Virol</source>
        <year>2003</year>
        <volume>77</volume>
        <fpage>1392</fpage>
        <lpage>1402</lpage>
        <pub-id pub-id-type="pmid">12502855</pub-id>
        <pub-id pub-id-type="doi">10.1128/JVI.77.2.1392-1402.2003</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>A direct approach to false discovery rates</article-title>
        <source>J R Stat Soc Ser B</source>
        <year>2002</year>
        <volume>64</volume>
        <fpage>479</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9868.00346</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Storey</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Tusher</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Empirical Bayes analysis of a microarray experiment</article-title>
        <source>J Am Stat Assoc</source>
        <year>2001</year>
        <volume>96</volume>
        <fpage>1151</fpage>
        <lpage>1160</lpage>
        <pub-id pub-id-type="doi">10.1198/016214501753382129</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>MY</given-names>
          </name>
        </person-group>
        <article-title>A simple procedure for the selection of significant effects</article-title>
        <source>J R Stat Soc Ser B</source>
        <year>2004</year>
        <volume>66</volume>
        <fpage>395</fpage>
        <lpage>400</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1369-7412.2004.05695.x</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Broët</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Radvanyi</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Bayesian Hierarchical Model for Identifying Changes in Gene Expression from Microarray Experiments</article-title>
        <source>Journal of Computational Biology</source>
        <year>2002</year>
        <volume>9</volume>
        <fpage>671</fpage>
        <lpage>683</lpage>
        <pub-id pub-id-type="pmid">12323100</pub-id>
        <pub-id pub-id-type="doi">10.1089/106652702760277381</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Banfield</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Model-based Gaussian and non-Gaussian clustering</article-title>
        <source>Biometrics</source>
        <year>1993</year>
        <volume>49</volume>
        <fpage>803</fpage>
        <lpage>821</lpage>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Titterington</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Smith</surname>
            <given-names>AFM</given-names>
          </name>
          <name>
            <surname>Makov</surname>
            <given-names>UE</given-names>
          </name>
        </person-group>
        <source>Statistical Analysis of Finite Mixture Distributions</source>
        <year>1985</year>
        <publisher-name>New York: Wiley</publisher-name>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dempster</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Laird</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>DB</given-names>
          </name>
        </person-group>
        <article-title>Maximum likelihood from incomplete data via the EM algorithm (with discussion)</article-title>
        <source>J R Stat Soc Ser B</source>
        <year>1977</year>
        <volume>39</volume>
        <fpage>1</fpage>
        <lpage>38</lpage>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cleveland</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Robust locally weighted regression and smoothing scatterplots</article-title>
        <source>J Am Stat Assoc</source>
        <year>1979</year>
        <volume>74</volume>
        <fpage>829</fpage>
        <lpage>836</lpage>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cleveland</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Locally-Weighted Regression: An Approach to Regression Analysis by Local Fitting</article-title>
        <source>J Am Stat Assoc</source>
        <year>1988</year>
        <volume>83</volume>
        <fpage>596</fpage>
        <lpage>610</lpage>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arfin</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Ito</surname>
            <given-names>ET</given-names>
          </name>
          <name>
            <surname>Tolleri</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Riehle</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Paegle</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Hatfield</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>Global Gene Expression Profiling in Escherichia coli K12</article-title>
        <source>J Biol Chem</source>
        <year>2000</year>
        <volume>275</volume>
        <fpage>29672</fpage>
        <lpage>29684</lpage>
        <pub-id pub-id-type="pmid">10871608</pub-id>
        <pub-id pub-id-type="doi">10.1074/jbc.M002247200</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Long</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Mangalam</surname>
            <given-names>HJ</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>BYP</given-names>
          </name>
          <name>
            <surname>Tolleri</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Hatfield</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Baldi</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Improved Statistical Inference from DNA Microarray Data Using Analysis of Variance and A Bayesian Statistical Framework</article-title>
        <source>J Biol Chem</source>
        <year>2001</year>
        <volume>276</volume>
        <fpage>19937</fpage>
        <lpage>19944</lpage>
        <pub-id pub-id-type="pmid">11259426</pub-id>
        <pub-id pub-id-type="doi">10.1074/jbc.M010192200</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kendziorski</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Newton</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Lan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gould</surname>
            <given-names>MN</given-names>
          </name>
        </person-group>
        <article-title>On parametric empirical Bayes methods for comparing multiple groups using replicated gene expression profiles</article-title>
        <source>Stat Med</source>
        <year>2003</year>
        <volume>22</volume>
        <fpage>3899</fpage>
        <lpage>3914</lpage>
        <pub-id pub-id-type="pmid">14673946</pub-id>
        <pub-id pub-id-type="doi">10.1002/sim.1548</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
