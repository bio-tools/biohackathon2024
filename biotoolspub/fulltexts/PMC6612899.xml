<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6612899</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz372</article-id>
    <article-id pub-id-type="publisher-id">btz372</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2019 Conference Proceedings</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Studies of Phenotypes and Clinical Applications</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PRECISE: a domain adaptation approach to transfer predictors of drug response from pre-clinical models to tumors</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Mourragui</surname>
          <given-names>Soufiane</given-names>
        </name>
        <xref ref-type="aff" rid="btz372-aff1">1</xref>
        <xref ref-type="aff" rid="btz372-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Loog</surname>
          <given-names>Marco</given-names>
        </name>
        <xref ref-type="aff" rid="btz372-aff2">2</xref>
        <xref ref-type="aff" rid="btz372-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>van de Wiel</surname>
          <given-names>Mark A</given-names>
        </name>
        <xref ref-type="aff" rid="btz372-aff4">4</xref>
        <xref ref-type="aff" rid="btz372-aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reinders</surname>
          <given-names>Marcel J T</given-names>
        </name>
        <xref ref-type="aff" rid="btz372-aff2">2</xref>
        <xref ref-type="aff" rid="btz372-aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wessels</surname>
          <given-names>Lodewyk F A</given-names>
        </name>
        <xref ref-type="aff" rid="btz372-aff1">1</xref>
        <xref ref-type="aff" rid="btz372-aff2">2</xref>
        <xref ref-type="corresp" rid="btz372-cor1"/>
        <!--<email>l.wessels@nki.nl</email>-->
      </contrib>
    </contrib-group>
    <aff id="btz372-aff1"><label>1</label>Computational Cancer Biology, Division of Molecular Carcinogenesis, Oncode Institute, the Netherlands Cancer Institute, Amsterdam CX, The Netherlands</aff>
    <aff id="btz372-aff2"><label>2</label>Department of Intelligent Systems, Faculty of EEMCS, Delft University of Technology, Delft CD, The Netherlands</aff>
    <aff id="btz372-aff3"><label>3</label>Department of Computer Science, University of Copenhagen, Copenhagen, Denmark</aff>
    <aff id="btz372-aff4"><label>4</label>Department of Epidemiology and Biostatistics, Amsterdam Public Health Research Institute, Amsterdam University Medical Centers, Amsterdam, The Netherlands</aff>
    <aff id="btz372-aff5"><label>5</label>MRC Biostatistics Unit, University of Cambridge, Cambridge, UK</aff>
    <aff id="btz372-aff6"><label>6</label>Computational Biology Center, Leiden University Medical Center, Leiden ZC, The Netherlands</aff>
    <author-notes>
      <corresp id="btz372-cor1">To whom correspondence should be addressed. <email>l.wessels@nki.nl</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-07-05">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>7</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>35</volume>
    <issue>14</issue>
    <fpage>i510</fpage>
    <lpage>i519</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz372.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Cell lines and patient-derived xenografts (PDXs) have been used extensively to understand the molecular underpinnings of cancer. While core biological processes are typically conserved, these models also show important differences compared to human tumors, hampering the translation of findings from pre-clinical models to the human setting. In particular, employing drug response predictors generated on data derived from pre-clinical models to predict patient response remains a challenging task. As very large drug response datasets have been collected for pre-clinical models, and patient drug response data are often lacking, there is an urgent need for methods that efficiently transfer drug response predictors from pre-clinical models to the human setting.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We show that cell lines and PDXs share common characteristics and processes with human tumors. We quantify this similarity and show that a regression model cannot simply be trained on cell lines or PDXs and then applied on tumors. We developed PRECISE, a novel methodology based on domain adaptation that captures the common information shared amongst pre-clinical models and human tumors in a consensus representation. Employing this representation, we train predictors of drug response on pre-clinical data and apply these predictors to stratify human tumors. We show that the resulting domain-invariant predictors show a small reduction in predictive performance in the pre-clinical domain but, importantly, reliably recover known associations between independent biomarkers and their companion drugs on human tumors.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>PRECISE and the scripts for running our experiments are available on our GitHub page (https://github.com/NKI-CCB/PRECISE).</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">ZonMw</named-content>
          <named-content content-type="funder-identifier">10.13039/501100001826</named-content>
        </funding-source>
        <award-id>40-00812-98-16012</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Cancer is a heterogeneous disease that arises due to the accumulation of somatic genomic alterations. These alterations show high levels of variability between tumors resulting in heterogeneous responses to treatments. Precision medicine attempts to improve response rates by taking this heterogeneity into account and tailoring treatment to the specific molecular make-up of a given tumor. This requires the identification of biomarkers to identify the set of patients that will benefit from a given treatment while sparing those that will not benefit the unnecessary side-effects. However, as there are limited patient response data for a wide range of drugs, pre-clinical modes, such as cell lines and patient-derived xenografts (PDXs) have been employed to generate large-scale datasets that enable the development of personalized treatment strategies based on the data-driven identification of biomarkers of response. More specifically, hundreds of pre-clinical models have not only been extensively molecularly characterized, but, more importantly, their response to hundreds of drugs has also been recorded. This has resulted in large public resources containing data derived from cell lines (GDSC1000, <xref rid="btz372-B18" ref-type="bibr">Iorio <italic>et al.</italic>, 2016</xref>) and PDX models (NIBR PDXE, <xref rid="btz372-B9" ref-type="bibr">Gao <italic>et al.</italic>, 2015</xref>).</p>
    <p>These pre-clinical resources can be employed to build predictors of drug response which are then transferred to the human setting, allowing stratification of patients for drugs the patients have not yet been exposed to. Geeleher <italic>et al.</italic> applied this approach by simply correcting for a batch effect between the cell line and tumor datasets and then directly transferring the cell line predictor to the human setting (<xref rid="btz372-B11" ref-type="bibr">Geeleher <italic>et al.</italic>, 2014</xref>, <xref rid="btz372-B12" ref-type="bibr">2017</xref>). This already yielded some promising results: it recovered well-established biomarkers such as the association between Lapatinib sensitivity and ERBB2 amplifications. However, when directly transferring a predictor from the source domain (cell lines) to the target domain (human tumors) one assumes that the source and target data originate from the same distribution. While the differences between pre-clinical models and human tumors have been studied extensively (<xref rid="btz372-B2" ref-type="bibr">Ben-David <italic>et al.</italic>, 2017</xref>,<xref rid="btz372-B3" ref-type="bibr">2018</xref>; <xref rid="btz372-B13" ref-type="bibr">Gillet <italic>et al.</italic>, 2013</xref>), the most obvious differences include the absence of an immune system in both cell lines and PDXs and the absence of a tumor micro-environment and vasculature in cell lines. One can therefore not assume similarity between the source and target distributions.</p>
    <p>Transfer learning aims at addressing this issue (see <xref rid="btz372-B21" ref-type="bibr">Pan and Yang, 2010</xref> for a general review). Transfer learning methods can be assigned to different categories depending on the availability of source and target labels and on the specific relation between these source and target datasets. Since we have a very small number of labeled tumor samples, but a wealth of labeled pre-clinical models, our approach falls into the category referred to as <italic>transductive</italic> [while this terminology is not widely used in the community, we follow the categorization employed in <xref rid="btz372-B21" ref-type="bibr">Pan and Yang (2010</xref>)]. Since the features (i.e. the genes) are the same in the source and target domains, our problem requires a <italic>domain adaptation</italic> strategy, sometimes also referred to as <italic>homogeneous domain adaptation</italic>.</p>
    <p>As previously mentioned, the marginal distributions of pre-clinical models and tumors are expected to be different. However, we assume that drug response is, for a large part, determined by biological phenomena that are conserved between pre-clinical models and human tumors. Therefore there should exist a set of features (genes) for which the conditional distribution of drug response given these features is comparable across cell lines, PDXs and human tumors. Different methodologies have been proposed to find such a common space and these can be divided in two main categories (<xref rid="btz372-B6" ref-type="bibr">Csurka, 2017</xref>). For approaches in the first category, called <italic>data-centric</italic>, a common subspace can be found directly from both the pre-clinical models and the tumors by aligning the marginal distributions. This can be done by, for instance, using the Maximum Mean Discrepancy either exactly or employing semi-definite-programming (<xref rid="btz372-B22" ref-type="bibr">Pan <italic>et al.</italic>, 2008</xref>; <xref rid="btz372-B25" ref-type="bibr">Song <italic>et al.</italic>, 2008</xref>), or by using approximations based on multiple-kernel learning (<xref rid="btz372-B7" ref-type="bibr">Duan <italic>et al.</italic>, 2012</xref>) or empirical kernel maps (<xref rid="btz372-B23" ref-type="bibr">Pan <italic>et al.</italic>, 2011</xref>). Approaches in the second category, called <italic>subspace-centric</italic>, perform the domain adaptation correction by first reducing the dimensionality, and then aligning the low-rank representations (<xref rid="btz372-B8" ref-type="bibr">Fernando <italic>et al.</italic>, 2013</xref>; <xref rid="btz372-B15" ref-type="bibr">Gong <italic>et al.</italic>, 2012</xref>; <xref rid="btz372-B16" ref-type="bibr">Gopalan <italic>et al.</italic>, 2011</xref>). In the first category, the marginal distributions are directly aligned, suggesting that the empirical distribution would sufficiently accurately reflect the real behavior of the source and target samples. If, for instance, the source dataset consists of a proportion of ER positive samples that is very different from the target dataset, such a direction would be discarded as it is too dissimilar between the source and target. Clearly, this would be undesirable, as it represents a very important variable in breast cancer. The second category does find the directions of important variations, and then compares these directions between source and target. Hence, these approaches do not directly compare the distribution and are less subject to the sample size issue and to sample selection bias. We chose to employ the latter approach.</p>
    <p>We present Patient Response Estimation Corrected by Interpolation of Subspace Embeddings (PRECISE), a methodology based on domain adaptation that trains a regression model on processes that human tumors share with pre-clinical models. <xref ref-type="fig" rid="btz372-F1">Figure 1</xref> shows the general workflow of PRECISE. We first independently extract factors from the cell lines, PDXs and human tumors by means of linear dimensionality reduction. We then use a linear transformation that geometrically matches the factors from one of the pre-clinical models to the human tumor factors (<xref rid="btz372-B8" ref-type="bibr">Fernando <italic>et al.</italic>, 2013</xref>). Subsequently we extract the common factors [<italic>principal vectors (PVs)</italic>] defined as the directions that are the least influenced by the linear transformation (<xref ref-type="fig" rid="btz372-F1">Fig. 1A</xref>). After selection of the most similar PVs, we compute new feature spaces (based on this selection) by interpolating between the source domain (cell line or PDX PVs) and the target domain (human tumor PVs). The feature spaces resulting from this interpolation allow a balance to be struck between the chosen model system and the tumors (<xref rid="btz372-B15" ref-type="bibr">Gong <italic>et al.</italic>, 2012</xref>; <xref rid="btz372-B16" ref-type="bibr">Gopalan <italic>et al.</italic>, 2011</xref>). This approach, although using the notion of canonical angle differs markedly from Canonical Correlation Analysis. Indeed, in our case, samples are not paired and no cross-correlation can be computed. From the set of interpolated spaces, the <italic>consensus representation</italic> is obtained by optimizing the match between the marginal distributions of the chosen pre-clinical model and the human tumor data projected on these interpolated features. These consensus features are finally used to train a regression model using data from the pre-clinical model of choice. We use this regression model to predict tumor drug response (<xref ref-type="fig" rid="btz372-F1">Fig. 1B</xref>). As these features are shared between the pre-clinical models and the human tumors, the regression model is expected to generalize to human tumors. We finally use known biomarker-drug associations (from independent data sources, e.g. mutation status, copy number) as positive controls to validate the predictions of the model in human tumors (<xref ref-type="fig" rid="btz372-F1">Fig. 1C</xref>).
</p>
    <fig id="btz372-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>Overview of PRECISE and its validation. (<bold>A</bold>) Human tumor and pre-clinical data are first processed independently to find the most important domain-specific factors (using, for instance PCA). These factors are then compared, aligned and ordered by similarity, yielding <italic>PVs</italic>. The first PVs are pairs of vectors that are geometrically very similar and capture strong commonality between human tumors and pre-clinical models, the PVs at the bottom represent dissimilarities between human tumors and pre-clinical models. (<bold>B</bold>) A cut-off in similarity enables the retention of processes that are common. After interpolation between these most similar pre-clinical and tumor PVs, a <italic>consensus representation</italic> is computed by balancing the influence of human tumor and pre-clinical PVs. We performed a gene set enrichment analysis on these features to assess that they were clinically relevant. A tumor-aware regression model is finally trained by projecting pre-clinical and human tumor transcriptomics data on this consensus representation. (<bold>C</bold>) In order to validate our model, we use positive controls from independent data sources such as copy number or mutation data. These positive controls are established biomarker–drug associations. We compare the predictions of our model to predictions obtained based on these independent established biomarkers. Red boxes highlight our contributions</p>
      </caption>
      <graphic xlink:href="btz372f1"/>
    </fig>
    <p>This work contains the following novel contributions. First, we introduce a scalable and flexible methodology to find the common factors between pre-clinical models and human tumors. Second, we use this methodology to quantify the transcriptional commonality in biological processes between cell lines, PDXs and human tumors, and we show that these common factors are biologically relevant. Third, we show how these common factors can be used in regression pipelines to predict drug response in human tumors and that we recover well-known biomarker–drug associations. Finally, we derive an equivalent, faster and more interpretable way to compute the geodesic flow kernel, a widely used domain adaptation method in computer vision. Our approach builds up on the work of <xref rid="btz372-B16" ref-type="bibr">Gopalan <italic>et al.</italic> (2011)</xref> and <xref rid="btz372-B15" ref-type="bibr">Gong <italic>et al.</italic> (2012)</xref> but extend these approaches by first removing irrelevant non-transferable information automatically, and second by finding consensus features within the interpolation scheme to counter the bias towards source features induced by Ridge regression.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Notes on transcriptomics data</title>
      <p>We here present the datasets employed in this study. Further notes on preprocessing can be found in <xref ref-type="supplementary-material" rid="sup1">Supplementary Subsection 1.3</xref>.</p>
      <sec>
        <title>2.1.1 The cell line dataset</title>
        <p>We used the GDSC1000 dataset to train predictors on the cell lines. GDSC1000 contains <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>IC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>-values for a wide range of drugs. Amongst these drugs, we restricted ourselves to drugs that are either cytotoxic chemotherapies or targeted therapies and have shown an effect on at least one cancer type. This resulted in a set of 45 drugs employed in this study (<xref ref-type="supplementary-material" rid="sup1">Supplementary Subsection 1.2</xref>). The gene expression profiles of 1031 cell lines are available in total, including 51 breast cancer and 40 skin melanoma lines. Gene expression data are available in the form of FPKM and read counts.</p>
      </sec>
      <sec>
        <title>2.1.2 The PDX dataset</title>
        <p>We used the Novartis PDXE dataset which includes the gene expression profiles of 399 PDXs, including 42 breast cancer PDXs and 32 skin melanoma PDXs. Transcriptomics data are available in the form of FPKM.</p>
      </sec>
      <sec>
        <title>2.1.3 The human tumor dataset</title>
        <p>We extracted gene expression profiles for human tumors from The Cancer Genome Atlas. Specifically, we employed gene expression profiles for 1222 breast cancers and 472 skin melanoma cancers. Both FPKM and read counts are available. Mutation and copy number aberrations have been downloaded from the cBioPortal (<xref rid="btz372-B10" ref-type="bibr">Gao <italic>et al.</italic>, 2013</xref>). Translocation data have been downloaded from TumorFusions (<xref rid="btz372-B17" ref-type="bibr">Hu <italic>et al.</italic>, 2018</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 The cosine similarity matrix</title>
      <p>Transcriptomics data are high-dimensional with <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:mi>p</mml:mi><mml:mo>∼</mml:mo><mml:mn>19.000</mml:mn></mml:mrow></mml:math></inline-formula> features (genes) and since these genes are highly correlated, only some combinations of genes are informative. A simple—yet robust (<xref rid="btz372-B27" ref-type="bibr">Van Der Maaten <italic>et al.</italic>, 2009</xref>)—way to find these combinations is to use a linear dimensionality reduction method, like Principal Components Analysis (PCA), that breaks the data matrix down in <italic>d<sub>f</sub></italic> factors independently for the source (cell lines or PDXs) and target (human tumors) such that
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="true">{</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true">}</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mtext>with</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>s</italic> and <italic>t</italic> refer to the source and target, respectively; <bold>X</bold> represents the (<italic>n</italic> x <italic>p</italic>) transcriptomics dataset where each row represents a sample and each column a gene; <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the identity matrix and <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:mi mathvariant="bold">P</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> contains the <italic>factors</italic> in the rows (i.e. the principal components). Since these factors are computed independently for the source and the target, we refer to them as <italic>domain-specific factors</italic>. Here we only consider PCA since it is widely adopted by the community, and for its direct link to variance that acts as a first-order approximation in the comparison of distributions. Our method is, however, flexible and any linear dimensionality reduction method can be used.</p>
      <p>Once domain-specific factors have been independently computed for both the source and target, a simple way to map the source factors to the target factors is to use the <italic>subspace alignment</italic> approach suggested by <xref rid="btz372-B8" ref-type="bibr">Fernando <italic>et al.</italic> (2013</xref>). This approach finds a linear combination (<inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>) of source factors that reconstructs the target factors as closely as possible:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmin</mml:mtext></mml:mrow><mml:mrow><mml:mi mathvariant="bold">M</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>s</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mi mathvariant="bold">M</mml:mi><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>F</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo> </mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
which is the least squares solution under orthogonality constraints from <xref ref-type="disp-formula" rid="E1">Equation (1)</xref>. This optimal transformation consists of the inner product between the source and target factors and therefore quantifies the similarity between the factors. We will therefore refer to it as the <italic>cosine similarity matrix</italic>. It is also referred to as Bregman matrix divergence in the literature.</p>
    </sec>
    <sec>
      <title>2.3 Common signal extraction by transformation analysis</title>
      <p>As we will show in Subsection 3.1, matrix <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> is far from diagonal, indicating that there is not a one-to-one correspondence between the source- and target-specific factors. Moreover, using <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> to map the source-projected data onto the target domain-specific factors would only remove source-specific variation, leaving target-specific factors and the associated variation untouched.</p>
      <p>To understand this transformation further, we performed a singular value decomposition (SVD), i.e. <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mo>Γ</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, where <bold>U</bold> and <bold>V</bold> are orthogonal of size <italic>d<sub>f</sub></italic> and <inline-formula id="IE9"><mml:math id="IM9"><mml:mi mathvariant="bold">Γ</mml:mi></mml:math></inline-formula> is a diagonal matrix. <bold>U</bold> and <bold>V</bold> define orthogonal transformations on the source and target domain-specific factors, respectively, and create a new basis for the source and target domain-specific factors:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>s</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mtext>for</mml:mtext><mml:mo> </mml:mo><mml:mtext>all</mml:mtext><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>These define the <italic>principal vectors</italic> (PVs) (<xref rid="btz372-B14" ref-type="bibr">Golub and Van Loan, 2012</xref>) that have the following equivalent definition:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mtext>span</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mtext>span</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:munder></mml:mstyle><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo> </mml:mo><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>⊥</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>⊥</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo> </mml:mo><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula><inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> define the same span as the source-specific factors—and so do <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with the target-specific factors. PVs thus retain the same information as the original domain-specific factors, but their cosine similarity matrix (<inline-formula id="IE12"><mml:math id="IM12"><mml:mi mathvariant="bold">Γ</mml:mi></mml:math></inline-formula>) is diagonal. The PVs <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:math></inline-formula> are derived from the source and target domain-specific factors and the pairs are sorted in decreasing order based on their similarity. The top PVs are very similar between source and target while the bottom pairs are very dissimilar. For this reason we restricted the analysis to the top <italic>d<sub>pv</sub></italic> PVs. In <xref ref-type="disp-formula" rid="E4">Equation (4)</xref>, PVs have been defined as unitary vectors that maximize the inner product. The similarities therefore range between 0 and 1, and can thus be interpreted as the cosines of <italic>principal angles</italic> defined as
<disp-formula id="E5"><label>(5)</label><mml:math id="M5"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>arccos</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>We define <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mi mathvariant="bold">t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> as the matrix with the ordered PVs of the source and the target, respectively, with the factors in the rows.</p>
    </sec>
    <sec>
      <title>2.4 Factor-level gene set enrichment analysis</title>
      <p>In order to associate the PVs and the consensus representation with biological processes, we use Gene Set Enrichment Analysis (<xref rid="btz372-B26" ref-type="bibr">Subramanian <italic>et al.</italic>, 2005</xref>). For each factor (i.e. a PV or a consensus factor), we projected the tumor data onto it, yielding one score per tumor sample. These sample scores where then used in the GSEA package as continuous phenotypes. We employed sample-level permutation to assess significance based on 1000 permutations. We used two curated gene sets from the MSigDB package: the canonical pathways and the chemical and genetic perturbations.</p>
    </sec>
    <sec>
      <title>2.5 Building a robust regression model</title>
      <p>
        <boxed-text id="btz372-BOX1" position="float" orientation="portrait">
          <label>Algorithm 1</label>
          <caption>
            <p>PRECISE</p>
          </caption>
          <p><bold>Require:</bold> source data <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, target data <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, number of <italic>domain-specific factors d<sub>f</sub></italic>, number of <italic>PV d<sub>pv</sub></italic>.</p>
          <p><inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>←</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> source <italic>domain-specific factors</italic> (e.g. Principal Components)</p>
          <p><inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>←</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> target <italic>domain-specific factors</italic> (e.g. Principal Components)</p>
          <p><inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mi mathvariant="bold">U</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">V</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Γ</mml:mi><mml:mo>←</mml:mo></mml:mrow></mml:math></inline-formula> SVD of <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">P</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mo>Γ</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula></p>
          <p>
            <inline-formula id="IE22">
              <mml:math id="IM22">
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">Q</mml:mi>
                    </mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:msub>
                  <mml:mo>←</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi mathvariant="bold">P</mml:mi>
                              </mml:mrow>
                              <mml:mi>s</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msubsup>
                            <mml:mi mathvariant="bold">U</mml:mi>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mi>T</mml:mi>
                  </mml:msup>
                </mml:mrow>
              </mml:math>
            </inline-formula>
          </p>
          <p>
            <inline-formula id="IE23">
              <mml:math id="IM23">
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold">Q</mml:mi>
                    </mml:mrow>
                    <mml:mi>t</mml:mi>
                  </mml:msub>
                  <mml:mo>←</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mi mathvariant="bold">P</mml:mi>
                              </mml:mrow>
                              <mml:mi>t</mml:mi>
                              <mml:mi>T</mml:mi>
                            </mml:msubsup>
                            <mml:mi mathvariant="bold">V</mml:mi>
                          </mml:mrow>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mi>T</mml:mi>
                  </mml:msup>
                </mml:mrow>
              </mml:math>
            </inline-formula>
          </p>
          <p><inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> as specified in <xref ref-type="disp-formula" rid="E7">Equation (7)</xref></p>
          <p><bold>for</bold><inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:mi>i</mml:mi><mml:mo>←</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> to <italic>d<sub>pv</sub></italic><bold>do</bold></p>
          <p>  <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>←</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0.01</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula></p>
          <p>  <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">proj</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></p>
          <p>  <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">proj</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">S</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></p>
          <p>  <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>←</mml:mo></mml:mrow></mml:math></inline-formula> time of optimal matching between columns of <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">proj</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">proj</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></p>
          <p>
            <bold>end for</bold>
          </p>
          <p>
            <inline-formula id="IE32">
              <mml:math id="IM32">
                <mml:mrow>
                  <mml:mi mathvariant="bold">F</mml:mi>
                  <mml:mo>←</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo>[</mml:mo>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mo>Φ</mml:mo>
                              </mml:mrow>
                              <mml:mn>1</mml:mn>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mo>τ</mml:mo>
                                  </mml:mrow>
                                  <mml:mn>1</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>,</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mo>Φ</mml:mo>
                              </mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mo>τ</mml:mo>
                                  </mml:mrow>
                                  <mml:mn>2</mml:mn>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mo>,</mml:mo>
                            <mml:mn>..</mml:mn>
                            <mml:mo>,</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mo>Φ</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mi>d</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi mathvariant="italic">pv</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mrow>
                                    <mml:mo>τ</mml:mo>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>d</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi mathvariant="italic">pv</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                          </mml:mrow>
                          <mml:mo>]</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mi>T</mml:mi>
                  </mml:msup>
                </mml:mrow>
              </mml:math>
            </inline-formula>
          </p>
          <p>
            <inline-formula id="IE33">
              <mml:math id="IM33">
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>X</mml:mi>
                    </mml:mrow>
                    <mml:mi>s</mml:mi>
                    <mml:mrow>
                      <mml:mi mathvariant="italic">proj</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>←</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>X</mml:mi>
                    </mml:mrow>
                    <mml:mi>s</mml:mi>
                  </mml:msub>
                  <mml:mi mathvariant="bold">F</mml:mi>
                </mml:mrow>
              </mml:math>
            </inline-formula>
          </p>
          <p>
            <inline-formula id="IE34">
              <mml:math id="IM34">
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mi>X</mml:mi>
                    </mml:mrow>
                    <mml:mi>t</mml:mi>
                    <mml:mrow>
                      <mml:mi mathvariant="italic">proj</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>←</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>X</mml:mi>
                    </mml:mrow>
                    <mml:mi>t</mml:mi>
                  </mml:msub>
                  <mml:mi mathvariant="bold">F</mml:mi>
                </mml:mrow>
              </mml:math>
            </inline-formula>
          </p>
          <p>Train a regression model on <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="italic">proj</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula></p>
          <p>Apply it on the projected target data <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="italic">proj</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
        </boxed-text>
      </p>
      <p>Given the common factors, we can create a drug response predictor based on these pairs of PVs. There are different ways to use these pairs of PVs. We could restrict ourselves to either the source or target PVs, but it would only support one of the two domains. Alternatively, we could use both source and target PVs. However, this would also be sub-optimal for the following reason. Source PVs are computed using the source data and maximize the explained variance of the source. Hence the source data projected on the source PVs is likely to have higher variance than the source data projected on the target PVs, since target PVs have not been optimized for the source data. If we were to apply penalized regression on the source data projected on both the source and target PVs, it would preferably select the source PVs. This would in turn lead to a loss of generalizability as source-specific information is weighed more heavily that target-specific information.</p>
      <p>One way to circumvent this issue is to construct a new feature space using ‘intermediate’ features based on interpolation between the spaces spanned by the source and target PVs. For instance, in the plane that joins <italic>s</italic><sub>1</sub> and <italic>t</italic><sub>1</sub>, the rotations from the former to the latter vector could contain a better representation. The intermediate features are expected to be domain invariant as they represent a trade-off between source and target domains and can thus be used in a regression model.</p>
      <p>There are an infinite number of parameterizations for the intermediate features that join the source to the target PVs. As suggested in <xref rid="btz372-B16" ref-type="bibr">Gopalan <italic>et al.</italic> (2011</xref>) and <xref rid="btz372-B15" ref-type="bibr">Gong <italic>et al.</italic> (2012</xref>), we consider the geodesic flow representing the shortest path on the Grassmannian manifold. We derive (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Subsection 2.2</xref> for the complete proof) a parameterization of the geodesic as a function of the PVs. Let’s define <inline-formula id="IE37"><mml:math id="IM37"><mml:mi mathvariant="bold">Π</mml:mi></mml:math></inline-formula> and <inline-formula id="IE38"><mml:math id="IM38"><mml:mi mathvariant="bold">Ξ</mml:mi></mml:math></inline-formula> as
<disp-formula id="E6"><label>(6)</label><mml:math id="M6"><mml:mrow><mml:mo>∀</mml:mo><mml:mo>τ</mml:mo><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold">Π</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mo>τ</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mtext>diag</mml:mtext><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>τ</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold">Ξ</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mo>τ</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mtext>diag</mml:mtext><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mo>τ</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>sin</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the diagonal matrix. The intermediate representations are then defined by the geodesic path that corresponds to a rotation for each pair of PVs:
<disp-formula id="E7"><label>(7)</label><mml:math id="M7"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>:</mml:mo><mml:mo>τ</mml:mo><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>↦</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mi>s</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mi mathvariant="bold">Π</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mo>τ</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow><mml:mi>t</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mi mathvariant="bold">Ξ</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mo>τ</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>This geodesic path contains, for each pair of PVs, the features forming a rotating arc between the source and the target PVs. This formulation of the geodesic flow has the advantage of being based on the PVs, and not the domain-specific factors, in contrast to the formulation used in <xref rid="btz372-B16" ref-type="bibr">Gopalan <italic>et al.</italic> (2011)</xref> and <xref rid="btz372-B15" ref-type="bibr">Gong <italic>et al.</italic> (2012)</xref>. Non-similar PVs can be removed prior to interpolation.</p>
      <p>However, we show in <xref ref-type="supplementary-material" rid="sup1">Supplementary Subsections 2.3</xref> and <xref ref-type="supplementary-material" rid="sup1">2.4</xref> that projecting on all these features is equivalent, even in the infinite case, to projecting onto both the source and the target PVs, with the undesirable consequences described above. It is therefore preferable to create, for each pair of PVs, a single interpolated feature that strikes the right balance between the information contained in the source and target spaces. Consequently, a regression model trained on source data projected on the interpolated feature would generalize better on the target space. To construct these interpolated, or <italic>consensus features</italic>, we use the Kolmogorov–Smirnov (KS) statistic as a measure of similarity between the source and target data, both projected on a candidate interpolated feature.</p>
      <p>Specifically, by denoting <italic>d<sub>pv</sub></italic> as the number of selected PVs, for <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>..</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">pv</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">}</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:mo>τ</mml:mo><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> the feature at position <italic>τ</italic> between the <italic>i</italic>th pair is defined as <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:msub><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mo>τ</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mo>τ</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. For each pair of PVs, we then select the position <italic>τ<sub>i</sub></italic> that minimizes the KS statistic between the distributions of the source and target data projected on this feature. Let denote by <italic>D</italic> the KS statistic between the two projected datasets. We thus define <italic>τ<sub>i</sub></italic> as:
<disp-formula id="E8"><label>(8)</label><mml:math id="M8"><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mo>τ</mml:mo><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mo> </mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mo>τ</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mo>τ</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>This optimization is performed using a uniformly spaced grid search in interval <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with step size 0.01, moving between the source and the target.</p>
      <p>This process is repeated for each of the top <italic>d<sub>pv</sub></italic> PVs, resulting in an optimal interpolation position for each. These positions are then plugged back into the geodesic curve to yield the domain-invariant feature representation <bold>F</bold> defined as:
<disp-formula id="E9"><label>(9)</label><mml:math id="M9"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:msub><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>..</mml:mn><mml:mo> </mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>Φ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">pv</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">pv</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>The source data can now be projected on these features and the resulting dataset can be used for training a regression model that can be more reliably transferred to the target (human tumor) data.</p>
    </sec>
    <sec>
      <title>2.6 Notes on implementation</title>
      <p>Once the number of principal components and PVs have been set (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Subsection 5</xref> for an example), the only hyper-parameter that needs to be optimized is the shrinkage coefficient (<italic>λ</italic>) in the regression model. We employed a nested 10-fold cross-validation for this purpose. Specifically, for each of the outer cross-validation folds, we employed an inner 10-fold cross-validation on 90% of the data (the outer training fold) to estimate the optimal <italic>λ</italic>. To this end, in each of the 10 inner folds, we estimated the common subspace, projected the inner training and test fold on the subspace, trained a predictor on the projected inner training fold and determined the performance on the projected inner test fold as a function of <italic>λ</italic>. After completing these steps for all 10 inner folds, we determined the optimal <italic>λ</italic> across these results. Then we trained a model with the optimal <italic>λ</italic> on the outer training fold and applied the predictor to the remaining 10% of the data (outer test fold). We then employed the Pearson correlation between the predicted and actual values on the outer test folds as a metric of predictive performance. Note that every sample in an outer test folds is never employed to perform either domain adaptation nor in constructing the response predictor in that same fold.</p>
      <p>The methodology presented in this section is available as a Python 3.7 package available on our GitHub page. The domain adaptation step has been fully coded by ourselves and the regression and cross-validation uses scikit-learn 0.19.2 (<xref rid="btz372-B24" ref-type="bibr">Pedregosa <italic>et al.</italic>, 2011</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Pre-clinical models and human tumors show limited similarity</title>
      <p>The cosine similarity matrix <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> presented in Subsection 2.2 gives an indication of the similarity between the source and the target principal components. A clear correspondence between factors would yield a diagonal matrix, allowing a single target principal component to be assigned to a single source principal component. Using data presented in Subsection 2.1, <xref ref-type="fig" rid="btz372-F2">Figure 2A and C</xref> instead, show that this is clearly not the case as each source principal component shows similarity to a number of target principal components. Roughly speaking, for cell lines (<xref ref-type="fig" rid="btz372-F2">Fig. 2A</xref>), the top four source factors show high similarity with the top ten target factors. The similarity between PDXs and human tumor principal components is generally higher and holds for a larger set of factors (<xref ref-type="fig" rid="btz372-F2">Fig. 2C</xref>). This is to be expected since PDXs are believed to show higher resemblance to human tumors than cell lines.
</p>
      <fig id="btz372-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Comparison of domain-specific factors between source and target with the source being cell lines (<bold>A, B</bold>) or PDXs (<bold>C, D</bold>). (A, C) The absolute cosines similarity, i.e. the absolute values of the scalar products between source and target domain specific factors. High similarities are found between some factors but no clear 1–1 correspondence is visible (absence of high values on the diagonal). (B, D) The ratio of tumor variance explained. Human tumor data were projected on the source and target PVs, the variance of the projected data on each direction was computed and divided by the total human tumor variance. The shaded regions represent the 98% confidence intervals obtained by bootstrapping the human tumor samples. Overall, the first five cell line factors each explain more than 1% of the human tumor variance each, while for PDXs this is achieved for the first seven factors. The non-monotonic behavior of the PDX and cell line principal component curves shows that the human tumor variance is not supported by the same directions than the pre-clinical models, which necessitates domain adaptation. PDXs show slightly higher similarity to human tumors than cell lines</p>
        </caption>
        <graphic xlink:href="btz372f2"/>
      </fig>
      <p>When tumor data are projected on the cell line principal components, the explained variance accounts for around 30% of the variance explained when mapping the data on the human tumor principal components (<xref ref-type="fig" rid="btz372-F2">Fig. 2B</xref>). For PDXs, on the other hand, this amounts to 40% (<xref ref-type="fig" rid="btz372-F2">Fig. 2D</xref>), again indicating that PDXs resemble tumors more closely than cell lines. The bootstrap confidence intervals obtained by bootstrapping the tumor samples show that the obtained variance proportions differ significantly (<xref ref-type="fig" rid="btz372-F2">Fig. 2B and D</xref>). However, for both model systems, the explained variance is relatively small, indicating that the data for both model systems are not drawn from the same probability distribution as the human tumors, underscoring the need for a proper alignment of the datasets prior to transferring a predictor from the pre-clinical modes to the human tumors.</p>
      <p>In order to show that some gene-level structure is shared between these systems, we permuted the order of the genes in the source data only. We then computed the cosine similarities and target explained variance as before (<xref ref-type="supplementary-material" rid="sup1">Supplementary Subsection 3.2</xref>). Neither the cosine similarity values, nor the variance explained were as high as for the original unshuffled data, suggesting that model systems and tumor cells do share some feature-level structure. We also compared the target data to samples drawn uniformly from a Gaussian with a random covariance matrix in order to study whether the similarity between source and target data is significant. As shown in (<xref ref-type="supplementary-material" rid="sup1">Supplementary Subsection 3.3</xref>), this also yields values three to four orders of magnitude lower than observed. This all shows the existence of a shared signal between source and target.</p>
    </sec>
    <sec>
      <title>3.2 PVs capture common biological processes</title>
      <p>The source and target principal components are employed to compute the ‘common factors’ or PVs for both the source and target (see Subsection 2.3). <xref ref-type="fig" rid="btz372-F3">Figure 3A</xref> shows that the source and target PVs exhibit a perfect one-to-one correspondence. This is not unexpected since, by construction, this cosine similarity matrix is the central diagonal matrix (<inline-formula id="IE45"><mml:math id="IM45"><mml:mi mathvariant="bold">Γ</mml:mi></mml:math></inline-formula>) in the SVD of the optimal transformation between source and target [<xref ref-type="disp-formula" rid="E2">Equation (2)</xref>]. The source and target PVs are directions that respectively support the source and the target variance and are ranked by their pairwise similarity. When 20 principal components are computed between breast cell lines and breast tumors, the similarity between the PVs ranges from 0.78 to 0.02, indicating that the low ranking pairs are almost orthogonal. Although 0.78 could seem like a low value for the top similarity, such a value remains significantly large for a 19 000-dimensional space. <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5A</xref> depicts the top 20 PVs obtained for breast PDXs and breast tumors and shows that the top similarity coefficients are higher than for cell lines, as expected.
</p>
      <fig id="btz372-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>PVs computed from breast cell lines and breast tumors from 20 principal components. (<bold>A</bold>) The Cosine Similarity matrix for cell line and tumor PVs. The values on the diagonal show the similarities within the corresponding pairs of PVs. Similarity starts at 78% and goes down to 2% for the last pair (not shown). The off-diagonal values are almost zero, showing that pairs of PVs of unequal rank are orthogonal to one another. (<bold>B</bold>) The Spearman correlations between the Normalized Enrichment Scores (NES) of source and target PVs for the different gene sets employed. The top PVs show similar enrichments while the bottom ones show little similarity, even negative correlation. This shows that top PVs represent the same biological phenomena. (<bold>C</bold>) The NES based on the canonical pathways for each PV pair with the NES for the source PV on the left and the NES for the target PV on the right (separated by a dashed line). Non-significant gene sets are represented as white cells. For this figure panel, we selected the 10 gene sets that were most highly enriched in the first five PVs, the 10 gene sets that showed the highest enrichment in the bottom PVs as well as all the gene sets related to extra-cellular matrix. The top PVs are exclusively enriched in pathways related to cell cycle. Immune system-related pathways are enriched in the middle and bottom PVs and PVs at the bottom tend to show enrichment for the target PVs only. (<bold>D</bold>) The NES for each PV as displayed in (C), for the CHARAFE and VANTVEER gene sets. The top PVs are significantly enriched in sets associated with breast cancer subtypes</p>
        </caption>
        <graphic xlink:href="btz372f3"/>
      </fig>
      <p>To determine how PVs are related to genes, we calculated the contribution of each gene to the PVs. We subsequently employed these contributions in a gene set enrichment analysis (see Subsection 2.4) to compute the association between the pathways in a given data base and the PVs. This resulted in a vector of pathway scores for every PV. We then computed the pathway similarity between a pair of PVs as the correlation of the pathway scores. <xref ref-type="fig" rid="btz372-F3">Figure 3B</xref> shows these correlations for the top 20 pairs of cell line and human tumor PVs for six different pathway databases. Correlations are close to one for the first PVs, indicating high pathway similarities, whereas the pathway similarity decreases (even becoming negative) for the lower ranked PVs. Taken together this shows that the PVs capture shared pathway information between the model systems and the human tumors.</p>
      <p>When zooming in on the individual pathway similarities, we observe roughly two types of behaviors (<xref ref-type="fig" rid="btz372-F3">Fig. 3C and D</xref>). First, some gene sets show significant enrichment for the top PVs as well as lower ranked PVs. These gene sets are related to breast cancer subtypes, cell cycle and DNA replication, i.e. gene sets one would expect to be enriched in both cell lines and human tumors. Second, some gene sets show enrichment for the more dissimilar PVs. Most of these gene sets are related to the response of the immune system and the extra-cellular matrix, entities which are not fully present in the cell lines. <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5C</xref> shows the results of the gene set enrichment analysis for breast PDXs and human tumors. We observe roughly the same behavior as for the cell lines and human tumors, especially regarding the gene sets enriched in the top PVs and the enrichment of immune related sets. However, we do observe that the extra-cellular matrix shows enrichment in higher ranked PVs (PV 5 and 7) which is in line with what one would expect in a PDX model. Taken together, this indicates that the PVs that are most similar between pre-clinical models and human tumors provide a mechanism to capture the information shared between model systems are tumors, while discarding processes that behave differently.</p>
    </sec>
    <sec>
      <title>3.3 The consensus representation yields reduced but competitive performance</title>
      <p>Using PRECISE, we have derived a consensus feature representation which is both biologically informative and shared between the source and target. This representation can be used in a regression model trained on the source drug response data. Since <xref rid="btz372-B19" ref-type="bibr">Jang <italic>et al.</italic> (2014)</xref> demonstrated that regularized linear models such as Ridge regression or ElasticNet (<xref rid="btz372-B29" ref-type="bibr">Zou and Hastie, 2005</xref>) yield state-of-the-art performance for drug response prediction and since it is widely used, we will be employing Ridge regression.</p>
      <p>We computed the predictive performance of PRECISE for 84 drug and tumor type combinations (<xref ref-type="supplementary-material" rid="sup1">Supplementary Subsection 1.2</xref>). For a given drug and tumor type combination, we used PRECISE with all cell lines—i.e. the 1.001 cell lines across the 31 tissue types—as source and the corresponding tumor type as target. For example, to predict response to Vemurafenib in melanoma, we used all the cell lines from the GDSC panel, regardless of tumor type, as source, and melanoma tumors from The Cancer Genome Atlas as target. We used 70 principal components since the variance explained shows a plateau after 70 principal components (<xref ref-type="supplementary-material" rid="sup1">Supplementary Subsection 5.1</xref>). For the selection of the top PVs, we compared the obtained similarity values of the source and target PVs to the similarities obtained with random data and put the cut-off at the top 40 PVs (<xref ref-type="supplementary-material" rid="sup1">Supplementary Subsection 5.2</xref>). We then computed the interpolated feature space employing the KS statistic and employed this feature space in the subsequent Ridge regression models.</p>
      <p>As shown in <xref ref-type="fig" rid="btz372-F4">Figure 4A</xref>, PRECISE achieves predictive performances that are reduced but comparable with a Ridge regression model trained on the raw cell line gene expression data. The Pearson correlation between Ridge regression and PRECISE performance is <italic>r </italic>=<italic> </italic>0.97 with a median relative reduction in Pearson correlation of 0.039. As it is the aim of the consensus representation to focus on the commonalities between the cell lines and the human tumors, it is to be expected that such a representation will not fully capture the variation in the cell lines as it is also adapted to the variation in the human tumors. Hence, a small drop in performance is not unexpected, as long as it results in improved predictions on the human tumor data, which we will demonstrate in the next section.
</p>
      <fig id="btz372-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Predictive performance assessment. (<bold>A</bold>) Scatterplot of the performance of PRECISE and Ridge regression. Predictive performance for each approach was computed as the Pearson correlation between the measured and the 10-fold cross-validated predicted <inline-formula id="IE46"><mml:math id="IM46"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>IC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>s. PRECISE and Ridge regression performance is strongly correlated, with PRECISE showing a slight drop in performance. (<bold>B</bold>) Predicted drug response (predicted <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>IC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) for breast tumors based on a predictor of Lapatinib response trained on all the cell lines—i.e. across all tissue types—employing gene expression data only. ERBB2 copy number status in tumors correlates significantly with predicted <inline-formula id="IE48"><mml:math id="IM48"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>IC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> values, validating the predictions, as tumors with ERBB2 amplifications are known to be more sensitive to Lapatinib. (<bold>C</bold>) Predicted drug response (predicted <inline-formula id="IE49"><mml:math id="IM49"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>IC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) for skin melanoma tumors based on a predictor of Tramatinib response trained on all the cell lines—i.e. across all tissue types—employing gene expression data only. The PRECISE predictions are validated by the established fact that <inline-formula id="IE50"><mml:math id="IM50"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mtext>BRAF</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mn>600</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>-mutated tumors show a significantly higher sensitivity while the tumors bearing other mutations in <inline-formula id="IE51"><mml:math id="IM51"><mml:mrow><mml:mtext>BRAF</mml:mtext></mml:mrow></mml:math></inline-formula> do not show responses that differ from wild-type tumors</p>
        </caption>
        <graphic xlink:href="btz372f4"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 Domain-invariant regression models recover biomarker–drug associations</title>
      <p>To validate our predictor on human tumor data, we follow <xref rid="btz372-B12" ref-type="bibr">Geeleher <italic>et al.</italic> (2017)</xref> by comparing the prediction in human tumors with the performance of independent, known biomarkers. Since we exclusively use gene expression to stratify patients in terms of their response to a certain therapy, we can use known biomarkers derived from other data sources—e.g. mutations or copy number changes—to create an independent response stratification of the human tumors against which we can compare our approach. In order to predict the <inline-formula id="IE52"><mml:math id="IM52"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>IC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> in human tumor, we trained PRECISE using all the cell lines, irrespective of their tissue of origin, and the corresponding tumor type.</p>
      <p>The first known and clinically employed association between a biomarker and response to a drug that we tested is the association between the presence of an ERBB2 amplification and response to Lapatinib in breast cancer. Since Lapatinib specifically targets the ERBB2 growth factor, breast tumors that overexpress this growth factor, and are therefore addicted to this signal, respond well to this therapy. An accurate stratification of the breast tumors by PRECISE would therefore show a negative association with the level of ERBB2 amplification in the tumors, as the tumors predicted to be most sensitive (lowest <inline-formula id="IE53"><mml:math id="IM53"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>IC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>) would show the highest level of ERBB2 copy number amplification. This is exactly what we observe in <xref ref-type="fig" rid="btz372-F4">Figure 4B</xref>, where the predicted <inline-formula id="IE54"><mml:math id="IM54"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>IC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the observed ERBB2 copy number amplification level show a Spearman correlation of <inline-formula id="IE55"><mml:math id="IM55"><mml:mrow><mml:mo>ρ</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mn>0.32</mml:mn></mml:mrow></mml:math></inline-formula>. In addition, the copy number loss and copy number neutral categories show statistically significant differences in predicted <inline-formula id="IE56"><mml:math id="IM56"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>IC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> compared to the samples harboring a copy number gain.</p>
      <p>The second known association that we investigated is the association between the presence of a <inline-formula id="IE57"><mml:math id="IM57"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mtext>BRAF</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mn>600</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> mutation and response to MEK inhibitors in skin melanomas, while other BRAF mutations have not exhibited this association. As shown in <xref ref-type="fig" rid="btz372-F4">Figure 4C</xref>, the <inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>IC</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mn>50</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>s predicted for Trametinib by PRECISE show a significant difference between tumors bearing a <inline-formula id="IE59"><mml:math id="IM59"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mtext>BRAF</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mn>600</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> mutation and tumors that are wild-type for this gene. In addition, the PRECISE predictions also show a significant difference in predicted Trametinib response between tumors bearing a <inline-formula id="IE60"><mml:math id="IM60"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mtext>BRAF</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mn>600</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> mutation and tumors bearing other mutations in this gene.</p>
      <p>Other known associations we tested against are shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S9</xref>: Dabrafenib sensitivity predicted by <inline-formula id="IE61"><mml:math id="IM61"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mtext>BRAF</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mn>600</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> mutations (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S9A</xref>), Vemurafenib sensitivity predicted by <inline-formula id="IE62"><mml:math id="IM62"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mtext>BRAF</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mn>600</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S9B</xref>) mutations, Imatinib sensitivity predicted by BCR/ABL translocations in Acute Myeloid Leukemia (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S9C</xref>), Olaparib sensitivity predicted by BRCA1 deletion in breast cancer (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S9D</xref>) and Talazoparib sensitivity predicted by BRCA1 deletion in breast cancer (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S9E</xref>). These results have been computed using all the cell lines as source. When using solely cell lines from the tissue under consideration, the same results are observed, with a larger difference in predicted sensitivity for <inline-formula id="IE63"><mml:math id="IM63"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mtext>BRAF</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mn>600</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> mutated tumors for Trametinib (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S9G</xref>), Dabrafenib (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S9H</xref>) and Vemurafenib (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S9I</xref>), and a very clear separation of BCR/ABL translocated tumors from the rest under Imatinib treatment (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S9J</xref>).</p>
      <p>Finally, we compared results from PRECISE with two baseline approaches. We replicated results from <xref rid="btz372-B12" ref-type="bibr">Geeleher <italic>et al.</italic> (2017)</xref> by employing Ridge regression on either the raw or ComBat corrected gene expression data. Correcting for batch effect with ComBat provides a baseline comparison for our methodology. Lapatinib sensitivity is predicted as well as by PRECISE (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S10A</xref>) with or without the ComBat preprocessing step. For Dabrafenib, the association with <inline-formula id="IE64"><mml:math id="IM64"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mtext>BRAF</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mn>600</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is recovered, with and without ComBat. However, while the strength of the association obtained with ComBat is comparable to the association recovered with PRECISE, the strength diminishes without ComBat preprocessing (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S10C</xref>). In contrast to PRECISE, neither Ridge regression nor Ridge regression in combination with ComBat were able to recover the association between the <inline-formula id="IE65"><mml:math id="IM65"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mtext>BRAF</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mn>600</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> mutation and Trametinib.</p>
      <p>In summary, PRECISE is capable of retrieving all tested associations between known biomarkers and drug response, while current state-of-the-art approaches fail to recover all these associations.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Using high throughput sequencing and screening technologies, scientists have leveraged the versatility of pre-clinical models over the past decade to create powerful predictors of drug response. However, due to the intrinsic differences between cell lines, PDXs and real human tumors, these predictors cannot be expected to directly translate to the human setting. We have quantified the overlap in terms of the transcriptomics signal between these pre-clinical models and human tumors. We then introduced PRECISE, a domain adaptation framework that finds shared mechanisms between pre-clinical models and human tumors that display the same behavior across these systems.</p>
    <p>PRECISE generates PVs, pairs of factors that capture the common variance between pre-clinical models and human tumors. The top pairs of PVs are most similar, and thus recapitulate molecular behavior shared between the systems. The least similar PVs, can be discarded since they correspond to mechanisms not shared across systems.</p>
    <p>These vectors depend on the choice of linear dimensionality reduction methods employed. We employed PCA, but other methods have been proposed in the literature (e.g. <xref rid="btz372-B1" ref-type="bibr">Argelaguet <italic>et al.</italic>, 2018</xref>; <xref rid="btz372-B4" ref-type="bibr">Bismeijer <italic>et al.</italic>, 2018</xref>), all having different qualities (e.g. being biologically meaningful, filtering out noise, etc.). The versatility of our method enables the use of any dimensionality reduction scheme, as long it finds an informative linear subspace.</p>
    <p>Interpolation between the source and target PVs gives rise to features that balance the contribution of pre-clinical models and tumors. We showed (<xref ref-type="supplementary-material" rid="sup1">Supplementary Section 2</xref>) that interpolating between the PVs is equivalent to employing the Geodesic Flow Kernel approach that relies on the geodesics on the Grassmannian manifold (<xref rid="btz372-B15" ref-type="bibr">Gong <italic>et al.</italic>, 2012</xref>) and has already yielded state-of-the-art performance in Computer Vision.</p>
    <p>Recently, other ways to interpolate between the source and the target domains have been proposed, such as <xref rid="btz372-B5" ref-type="bibr">Caseiro <italic>et al.</italic> (2015)</xref> that use a spline instead of the geodesic. We devised a simple, yet effective interpolation scheme between the source and target PVs where we employed the similarity based on the KS statistic between the source and target data projected on the interpolated space to arrive at a consensus representation. This representation strikes the right balance between the pre-clinical models and the human tumors.</p>
    <p>We subsequently projected the data on this consensus representation and trained a regression model which takes the distribution of the tumor gene expression data into account. This work considered Ridge and ElasticNet, but our approach is versatile and can be employed in combination with any classification or regression approach.</p>
    <p>We showed that a Ridge regression model based on the consensus representation achieves slightly reduced performance compared to state-of-the-art approaches applied directly to the raw cell line gene expression data. This is to be expected, as the consensus representation filters out cell line specific information while capturing more relevant tumor variation, hence enabling efficient transfer to the tumor samples.</p>
    <p>We finally compared our predictions to the performance of known biomarkers such as <inline-formula id="IE66"><mml:math id="IM66"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mtext>BRAF</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mn>600</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> in skin cancer or ERBB2 amplification in breast cancer and show that our method can reliably recover the associations between these biomarkers and their companion drugs. We show that response to Lapatinib can be predicted better when all cell lines are used for domain adaptation. On the other hand, using all cell lines reduced the power to predict response to Vemurafenib, although the resulting association with <inline-formula id="IE67"><mml:math id="IM67"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mtext>BRAF</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mn>600</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> mutation status remained significant. This might be due to the ubiquity of the ERBB2 amplification in several tumor types, in contrast to the <inline-formula id="IE68"><mml:math id="IM68"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mtext>BRAF</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">V</mml:mi><mml:mn>600</mml:mn><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> mutation that is specific to particular tumor types.</p>
    <p>We restricted our study to domain adaptation based on transcriptomics data only, as it has been shown to be the most predictive data type (<xref rid="btz372-B19" ref-type="bibr">Jang <italic>et al.</italic>, 2014</xref>). However, dissimilar behavior between pre-clinical models and human tumors might also be present in other molecular data types. A multi-omic drug response predictor should also correct for these differences, which will require a multi-omic domain adaptation approach which accommodates the unique data characteristics of each molecular data type.</p>
    <p>Other methods have recently been proposed to tackle the problem of transferring pre-clinical predictors to human tumors. In <xref rid="btz372-B28" ref-type="bibr">Webber <italic>et al.</italic> (2018)</xref>, the authors create a correlation network for each omics data type and jointly map these networks onto a protein–protein interaction network. They then select the cliques that are conserved across omics-layers. In <xref rid="btz372-B20" ref-type="bibr">Normand <italic>et al.</italic> (2018)</xref>, the authors present an elegant framework for fold-change prediction in humans based on data from mouse models. Using fold-change data from both humans and mouse, a linear model is fitted at the gene-level. This linear model is then used to predict fold changes in human tumors for novel conditions. The problem of translating from model systems to human has broad applications and we envision that it will be a very active area of future research.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by ZonMw TOP grant COMPUTE CANCER [40-00812-98-16012].</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz372_Supplementary_Data</label>
      <media xlink:href="btz372_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Mirrelijn van Nee, Gergana Bounova, Daniel Vis, Stavros Makrodimitris and Tycho Bismeijer for useful discussions. We thank Nanne Aben, Marie Corradi and Wouter Kouw for critical reading of the manuscript and useful feedback on the methodology.</p>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz372-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Argelaguet</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Multi-Omics Factor Analysis–a framework for unsupervised integration of multi-omics data sets</article-title>. <source>Mol. Syst. Biol</source>., <volume>14</volume>, <fpage>e8124.</fpage><pub-id pub-id-type="pmid">29925568</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ben-David</surname><given-names>U.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Patient-derived xenografts undergo mouse-specific tumor evolution</article-title>. <source>Nat. Genet</source>., <volume>49</volume>, <fpage>1567.</fpage><pub-id pub-id-type="pmid">28991255</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ben-David</surname><given-names>U.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Genetic and transcriptional evolution alters cancer cell line drug response</article-title>. <source>Nature</source>, <volume>560</volume>, <fpage>325</fpage>–<lpage>330</lpage>.<pub-id pub-id-type="pmid">30089904</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bismeijer</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Molecular characterization of breast and lung tumors by integration of multiple data types with functional sparse-factor analysis</article-title>. <source>PLoS Comput. Biol</source>., <volume>14</volume>, <fpage>e1006520.</fpage><pub-id pub-id-type="pmid">30379847</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B5">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Caseiro</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) Beyond the shortest path: unsupervised domain adaptation by sampling subspaces along the spline flow. In: <italic>Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</italic> pp. <fpage>3846</fpage>–<lpage>3854</lpage>.</mixed-citation>
    </ref>
    <ref id="btz372-B6">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Csurka</surname><given-names>G.</given-names></name></person-group> (<year>2017</year>) <source>A Comprehensive Survey on Domain Adaptation for Visual Applications</source>. 
<publisher-name>Springer International Publishing</publisher-name>, 
<publisher-loc>Cham</publisher-loc>, pp. <fpage>1</fpage>–<lpage>35</lpage>.</mixed-citation>
    </ref>
    <ref id="btz372-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Duan</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Domain transfer multiple kernel learning</article-title>. <source>IEEE Trans. Pattern Anal. Mach. Intell</source>., <volume>34</volume>, <fpage>465</fpage>–<lpage>479</lpage>.<pub-id pub-id-type="pmid">21646679</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Fernando</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) Unsupervised visual domain adaptation using subspace alignment. In: <italic>Proceedings of the IEEE International Conference on Computer Vision</italic> pp. <fpage>2960</fpage>–<lpage>2967</lpage>.</mixed-citation>
    </ref>
    <ref id="btz372-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gao</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>High-throughput screening using patient-derived tumor xenografts to predict clinical trial drug response</article-title>. <source>Nat. Med</source>., <volume>21</volume>, <fpage>1318.</fpage><pub-id pub-id-type="pmid">26479923</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gao</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Integrative analysis of complex cancer genomics and clinical profiles using the cBioPortal</article-title>. <source>Sci. Signal</source>., <volume>6</volume>, <fpage>pl1</fpage>.<pub-id pub-id-type="pmid">23550210</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Geeleher</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Clinical drug response can be predicted using baseline gene expression levels and in vitro drug sensitivity in cell lines</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>R47</fpage>.<pub-id pub-id-type="pmid">24580837</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Geeleher</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Discovering novel pharmacogenomic biomarkers by imputing drug response in cancer patients from large genomics studies</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>1743</fpage>–<lpage>1751</lpage>.<pub-id pub-id-type="pmid">28847918</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gillet</surname><given-names>J.-P.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>The clinical relevance of cancer cell lines</article-title>. <source>J. Natl. Cancer Inst</source>., <volume>105</volume>, <fpage>452</fpage>–<lpage>458</lpage>.<pub-id pub-id-type="pmid">23434901</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B14">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Golub</surname><given-names>G.H.</given-names></name>, <name name-style="western"><surname>Van Loan</surname><given-names>C.F.</given-names></name></person-group> (<year>2012</year>) <source>Matrix Computations</source>. <volume>Vol. 3</volume>
<publisher-name>JHU Press</publisher-name>, 
<publisher-loc>Baltimore, MD, USA</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btz372-B15">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Gong</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) Geodesic flow kernel for unsupervised domain adaptation. In: <italic>2012 IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</italic> pp. <fpage>2066</fpage>–<lpage>2073</lpage>. 
<publisher-name>IEEE</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btz372-B16">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Gopalan</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) Domain adaptation for object recognition: an unsupervised approach. In: <italic>2011 IEEE International Conference on Computer Vision (ICCV)</italic> pp. <fpage>999</fpage>–<lpage>1006</lpage>. IEEE.</mixed-citation>
    </ref>
    <ref id="btz372-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hu</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>TumorFusions: an integrative resource for cancer-associated transcript fusions</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>D1144</fpage>–<lpage>D1149</lpage>.<pub-id pub-id-type="pmid">29099951</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Iorio</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>A Landscape of Pharmacogenomic Interactions in Cancer</article-title>. <source>Cell</source>, <volume>166</volume>, <fpage>740</fpage>–<lpage>754</lpage>.<pub-id pub-id-type="pmid">27397505</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jang</surname><given-names>I.S.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Systematic assessment of analytical methods for drug sensitivity prediction from cancer cell line data</article-title>. <source>Pac. Symp. Biocomput</source>., <volume>2014</volume>, <fpage>63</fpage>–<lpage>74</lpage>.</mixed-citation>
    </ref>
    <ref id="btz372-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Normand</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Found in translation: a machine learning model for mouse-to-human inference</article-title>. <source>Nat. Methods</source>, <volume>15</volume>, <fpage>1067.</fpage><pub-id pub-id-type="pmid">30478323</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pan</surname><given-names>S.J.</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>Q.</given-names></name></person-group> (<year>2010</year>) 
<article-title>A survey on transfer learning</article-title>. <source>IEEE Trans. Knowl. Data Eng</source>., <volume>22</volume>, <fpage>1345</fpage>–<lpage>1359</lpage>.</mixed-citation>
    </ref>
    <ref id="btz372-B22">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Pan</surname><given-names>S.J.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) Transfer learning via dimensionality reduction. In: <italic>AAAI</italic>, Vol. 8, pp. <fpage>677</fpage>–<lpage>682</lpage>.</mixed-citation>
    </ref>
    <ref id="btz372-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pan</surname><given-names>S.J.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Domain adaptation via transfer component analysis</article-title>. <source>IEEE Trans. Neural Netw</source>., <volume>22</volume>, <fpage>199</fpage>–<lpage>210</lpage>.<pub-id pub-id-type="pmid">21095864</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pedregosa</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Scikit-learn: machine learning in Python</article-title>. <source>J. Mach. Learn. Res</source>., <volume>12</volume>, <fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation>
    </ref>
    <ref id="btz372-B25">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Song</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) Colored maximum variance unfolding. In: <italic>Advances in Neural Information Processing Systems</italic> pp. <fpage>1385</fpage>–<lpage>1392</lpage>.</mixed-citation>
    </ref>
    <ref id="btz372-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Subramanian</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>102</volume>, <fpage>15545</fpage>–<lpage>15550</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Van Der Maaten</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Dimensionality reduction: a comparative review</article-title>. <source>J. Mach. Learn. Res</source>., <volume>10</volume>, <fpage>66</fpage>–<lpage>71</lpage>.</mixed-citation>
    </ref>
    <ref id="btz372-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Webber</surname><given-names>J.T.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Integration of tumor genomic data with cell lines using multi-dimensional network modules improves cancer pharmacogenomics</article-title>. <source>Cell Syst</source>., <volume>7</volume>, <fpage>526</fpage>–<lpage>536</lpage>.<pub-id pub-id-type="pmid">30414925</pub-id></mixed-citation>
    </ref>
    <ref id="btz372-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zou</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Hastie</surname><given-names>T.</given-names></name></person-group> (<year>2005</year>) 
<article-title>Regularization and variable selection via the elastic net</article-title>. <source>J. R. Stat. Soc. Series B Stat. Methodol</source>., <volume>67</volume>, <fpage>301</fpage>–<lpage>320</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
