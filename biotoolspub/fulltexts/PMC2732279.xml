<?properties open_access?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1460-2059</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2732279</article-id>
    <article-id pub-id-type="pmid">18776194</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btn467</article-id>
    <article-id pub-id-type="publisher-id">btn467</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>STREAM: Static Thermodynamic REgulAtory Model of transcription</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Bauer</surname>
          <given-names>Denis C.</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bailey</surname>
          <given-names>Timothy L.</given-names>
        </name>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff>Institute for Molecular Bioscience, University of Queensland, Brisbane, Qld. 4072, Australia</aff>
    <author-notes>
      <corresp id="COR1">*To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Joaquin Dopazo</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>1</day>
      <month>11</month>
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>9</month>
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>9</month>
      <year>2008</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <!-- oupReleaseDelayRemoved from OA Article (10.1093/bioinformatics/btn467btn467APPLICATIONS NOTEGENE EXPRESSIONSTREAM: Static Thermodynamic REgulAtory Model of transcriptionBauerDenis C.*BaileyTimothy L.*Institute for Molecular Bioscience, University of Queensland, Brisbane, Qld. 4072, Australia*To whom correspondence should be addressed.Associate Editor: Joaquin Dopazo1112008692008242125442545276200811820082882008&#x000a9; 2008 The Author(s)2008This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/2.0/uk/) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.Motivation: Understanding the transcriptional regulation of a gene in detail is a crucial step towards uncovering and ultimately utilizing the regulatory grammar of the genome. Modeling transcriptional regulation using thermodynamic equations has become an increasingly important approach towards this goal.Here, we present stream, the first publicly available framework for modeling, visualizing and predicting the regulation of the transcription rate of a target gene. Given the concentrations of a set of transcription factors (TFs), the TF binding sites (TFBSs) in a regulatory DNA region, and the transcription rate of the target gene, stream will optimize its parameters to generate a model that best fits the input data. This trained model can then be used to (a) validate that the given set of TFs is able to regulate the target gene and (b) to predict the transcription rate under different conditions (e.g. different tissues, knockout/additional TFs or mutated/missing TFBSs).Availability: The platform independent executable of stream, as well as a tutorial and the full documentation, are available at http://bioinformatics.org.au/stream/. stream requires Java version 5 or higher.Contact: d.bauer@imb.uq.edu.au; t.bailey@imb.uq.edu.au) -->
    <volume>24</volume>
    <issue>21</issue>
    <fpage>2544</fpage>
    <lpage>2545</lpage>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>6</month>
        <year>2008</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>8</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>8</month>
        <year>2008</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2008 The Author(s)</copyright-statement>
      <copyright-year>2008</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">http://creativecommons.org/licenses/by-nc/2.0/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Understanding the transcriptional regulation of a gene in detail is a crucial step towards uncovering and ultimately utilizing the regulatory grammar of the genome. Modeling transcriptional regulation using thermodynamic equations has become an increasingly important approach towards this goal.</p>
      <p>Here, we present <sc>stream</sc>, the first publicly available framework for modeling, visualizing and predicting the regulation of the transcription rate of a target gene. Given the concentrations of a set of transcription factors (TFs), the TF binding sites (TFBSs) in a regulatory DNA region, and the transcription rate of the target gene, <sc>stream</sc> will optimize its parameters to generate a model that best fits the input data. This trained model can then be used to (a) validate that the given set of TFs is able to regulate the target gene and (b) to predict the transcription rate under different conditions (e.g. different tissues, knockout/additional TFs or mutated/missing TFBSs).</p>
      <p><bold>Availability:</bold> The platform independent executable of <sc>stream</sc>, as well as a tutorial and the full documentation, are available at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.org.au/stream/">http://bioinformatics.org.au/stream/</ext-link>. <sc>stream</sc> requires Java version 5 or higher.</p>
      <p><bold>Contact:</bold><email>d.bauer@imb.uq.edu.au</email>; <email>t.bailey@imb.uq.edu.au</email></p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>1 INTRODUCTION</title>
    <p>Transcription of a gene can be induced by the binding of specific transcription factors (TFs) to so-called <italic>cis</italic>-regulatory modules (CRMs). The frequency and duration of the binding events are influenced by the concentrations of the TFs, the binding affinities and location of the TF binding sites (TFBSs) in the CRM and the properties of the TFs themselves (e.g. effectiveness, competitive interaction with other TFs). With the availability of an increasing number of detailed measurements of gene concentrations in different situations (e.g. tissues, developmental time points) as well as TF-DNA binding affinities, it has become possible to build mathematical models for transcriptional regulation. Building mathematical models to associate a specific occupation of a specific CRM with an observed transcriptional response promotes a better understanding of the transcriptional regulation and enables <italic>in silico</italic> hypothesis testing about postulated regulatory TFs or mechanisms.</p>
    <p>An increasingly successful approach to mathematically simulating transcriptional regulation is using thermodynamic models that model the interaction of TFs and DNA using kinetic equations. Several such thermodynamic models have been proposed in the last years (Janssens <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2006</xref>; Segal <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2008</xref>; Zinzen <italic>et al.</italic>, <xref ref-type="bibr" rid="B7">2006</xref>). These models take the CRM sequence, a set of TFs along with their concentrations and predict the transcriptional response of the target gene as mediated by the CRM and the TFs. A training algorithm is used to optimize the model's internal parameters to minimize the difference between the observed and predicted transcriptional response.</p>
  </sec>
  <sec id="SEC2">
    <title>2 APPROACH AND USAGE</title>
    <p>Here we present <sc>stream</sc>, a Java-implemented framework to calculate and visualize transcriptional regulation using thermodynamic modeling approaches. <sc>stream</sc> currently uses the thermodynamic model introduced by Reinitz <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2003</xref>), but the framework is flexible and can be used in conjunction with other models implemented in Java. <sc>stream</sc> offers several optimization methods including gradient descent and simulated annealing for adjusting the internal parameters of the model to best fit the user's input data. To the best of our knowledge, <sc>stream</sc> is to data the only publicly available framework for modeling the regulation of the rate of transcription. <sc>stream</sc> has been tested extensively on the even-skipped gene (<italic>eve</italic>) in <italic>Drosophila melanogaster</italic> (Bauer and Bailey, <xref ref-type="bibr" rid="B1">2008</xref>).</p>
    <p><sc>stream</sc> can be executed using a graphical user interface (GUI) as well as via the command line. The GUI is illustrated in <xref ref-type="fig" rid="F1">Fig. 1</xref>. It offers the same functionality (e.g. multistart options of the optimization or automatic cross-validation evaluation) as the command-line tool, but in an intuitive and dialogue-based fashion. Both the command-line and the GUI version can save the current result and settings of the program into a file, which makes saving and modifying previous experiments simple.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Screen shot of the GUI of <sc>stream</sc>. The interface is exemplified on a model trained for the even-skipped gene (<italic>eve</italic>).</p></caption><graphic xlink:href="btn467f1"/></fig></p>
  </sec>
  <sec sec-type="methods" id="SEC3">
    <title>3 METHODS</title>
    <p>In order to generate a model for a particular target gene, the user must identify a set of putative TFs and a putative regulatory region. The suspected role of each TF, <italic>x</italic>, as an activator <italic>x</italic>∈<italic>A</italic> or repressor <italic>x</italic>∈<italic>B</italic> must be specified by the user. The program also requires measurements of the concentrations and binding preferences of those TFs, as well as the transcriptional output of the target gene. In the following section, we introduce the required input data, <bold>D</bold>, which contains the concentration and rate data, <bold>C</bold>, and a TFBS map, <bold>S</bold>.</p>
    <p>The concentration and rate data, <bold>C</bold>, comprises a set of independent data points. Each data point is a pair (<bold>V</bold>, <italic>v</italic><sub><italic>t</italic></sub>), with <bold>V</bold>=(<italic>a</italic><sub>1</sub>],…,[<italic>a</italic><sub><italic>n</italic></sub>]), a vector listing the protein concentrations of the putative regulatory TF proteins (<italic>a</italic><sub>1</sub>,…, <italic>a</italic><sub><italic>n</italic></sub>), and <italic>v</italic><sub><italic>t</italic></sub> giving the corresponding observed transcription rate of the target gene.</p>
    <p>The concentration and rate data, <bold>C</bold>, can be measured by various methods. To measure the TF concentrations, <italic>in situ</italic> antibody staining can be used to measure <bold>V</bold>. To obtain the corresponding <italic>v</italic><sub><italic>t</italic></sub>, one can proceed indirectly by measuring the mRNA levels of a reporter gene by staining against the mRNA of the reporter (Jaeger <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2004</xref>).</p>
    <p>For visualization purposes, <sc>stream</sc> allows the user to label the data points with up to two ‘features’ (e.g. the ‘condition’ under which the measurements were made). Features may be ‘continuous’ (real numbers as in the example above), or ‘categorical’ such as cell types, tissue types or experimental treatments. <sc>stream</sc> utilizes the values of the features for visualization only, and the user may interactively select either feature as the <italic>X</italic>-axis for plots of the data.</p>
    <p>Besides the concentration data, the input data also contains the TFBS map, <bold>S</bold>, corresponding to the regulatory region of interest. The TFBS map, <bold>S</bold>=(<bold>s</bold><sub>1</sub>, <bold>s</bold><sub>2</sub>,…,<bold>s</bold><sub><italic>n</italic></sub>), is a list, where each <italic>s</italic><sub><italic>i</italic></sub> represents a TFBS as a triple (<italic>a</italic>, <italic>l</italic>, <italic>s</italic>) giving the name, <italic>a</italic>, of the binding TF, the position, <italic>l</italic>, of the binding site and the log-odds score (natural logarithm), <italic>s</italic>, of the site. The log-odds score is proportional to the binding strength of the TFBS (Stormo, <xref ref-type="bibr" rid="B6">2000</xref>). <bold>S</bold> can be constructed from experimentally verified binding sites, <italic>in silico</italic> predicted sites using a prediction algorithm such as <sc>fimo</sc> (<ext-link ext-link-type="uri" xlink:href="http://meme.sdsc.edu">http://meme.sdsc.edu</ext-link>), or a combination of both. For more detailed information, see Bauer and Bailey (<xref ref-type="bibr" rid="B1">2008</xref>).</p>
    <p>The objective of the optimization is to determine the set of model parameters, Θ, that optimally explains the input data, <bold>D</bold>. Θ depends on the thermodynamic model. Currently, <sc>stream</sc> implements the model introduced by Reinitz <italic>et al.</italic>(<xref ref-type="bibr" rid="B4">2003</xref>). This model uses free parameters Θ=(θ<sub>0</sub>, <italic>R</italic><sub>0</sub>, <bold>W</bold>), where θ<sub>0</sub> is an energy barrier, <italic>R</italic><sub>0</sub> is the maximal transcription rate, and <bold>W</bold> contains a tuple, (<italic>K</italic><sub><italic>x</italic></sub>, <italic>E</italic><sub><italic>x</italic></sub>), for each TF, <italic>x</italic>, where <italic>K</italic><sub><italic>x</italic></sub> is the association constant of the TF to the DNA and <italic>E</italic><sub><italic>x</italic></sub> is the effectiveness of the TF to activate transcription, if <italic>x</italic>∈<italic>A</italic>, or to repress, if <italic>x</italic>∈<italic>B</italic>. For more details see Reinitz <italic>et al.</italic> (<xref ref-type="bibr" rid="B4">2003</xref>) and Bauer and Bailey (<xref ref-type="bibr" rid="B1">2008</xref>).</p>
    <p>Four different optimization methods are implemented: simulated annealing (SA), gradient descent (GD), genetic algorithm (GA) and limited-memory quasi-Newton unconstrained optimization (LBFGS) (for a comparison of the optimization methods see D.C.Bauer and T.L.Bailey, manuscript in preparation). All optimization methods seek to optimize the free parameters of the Reinitz model by minimizing the root mean-squared (RMS) error between the <italic>known</italic> transcription rate and the rate <italic>predicted</italic> by the Reinitz model, averaged over all input points, <bold>D</bold> (Bauer and Bailey, <xref ref-type="bibr" rid="B1">2008</xref>).</p>
  </sec>
  <sec id="SEC4">
    <title>4 FUTURE DEVELOPMENTS</title>
    <p>Besides the Reinitz model, we plan to provide additional models with enhanced functionality to simulate interacting TFs in a more detailed way, e.g., by incorporating TF-TF cooperation. Furthermore, simplifying models by using discreet TFBSs might introduce artifacts, hence, changing the model approach to use continuous binding gradients deems beneficial. Future research on other CRMs will guide the development of new models and our framework can provide the environment to directly compare them.</p>
    <p>In addition, we plan to extend the approach to optimize one model to fit more than one CRM. Being able to fit one model to the data of several CRMs, which are suspected to have the same regulatory TFs, increases the confidence in the produced model.</p>
    <p>Finally, we plan to improve the functionality of the GUI in manipulating input data, e.g., by an interactive interface to vary the properties of the TFBS map and to directly observe the changes in the predicted transcription rate.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors wish to acknowledge John Reinitz, Stefan Maetschke and Fabian Buske for their input on conceptual and implementation details for <sc>stream</sc> as well as Lachlan Dufton for providing the initial implementation of SA.</p>
    <p><italic>Funding</italic>: Australian Research Council Centre of Excellence in Bioinformatics (to T.L.B.); <funding-source>National Institutes of Health</funding-source><?release-delay 12|0?> (<award-id>RO-1 RR021692-01 to T.L.B</award-id>.), UQ International Research Tuition Award (D.C.B.).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
        </person-group>
        <article-title>Studying the functional conservation of cis-regulatory modules and their transcriptional output</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>220</fpage>
        <pub-id pub-id-type="pmid">18442418</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaeger</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dynamical analysis of regulatory interactions in the gap gene system of Drosophila melanogaster</article-title>
        <source>Genetics</source>
        <year>2004</year>
        <volume>167</volume>
        <fpage>1721</fpage>
        <lpage>1737</lpage>
        <pub-id pub-id-type="pmid">15342511</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Janssens</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantitative and predictive model of transcriptional control of the Drosophila melanogaster even skipped gene</article-title>
        <source>Nat. Genet</source>
        <year>2006</year>
        <volume>38</volume>
        <fpage>1159</fpage>
        <lpage>1165</lpage>
        <pub-id pub-id-type="pmid">16980977</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reinitz</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Transcriptional control in Drosophila</article-title>
        <source>Complexus</source>
        <year>2003</year>
        <volume>1</volume>
        <fpage>54</fpage>
        <lpage>64</lpage>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segal</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Predicting expression patterns from regulatory sequence in Drosophila segmentation</article-title>
        <source>Nature</source>
        <year>2008</year>
        <comment>doi:10.1038/nature06496.</comment>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stormo</surname>
            <given-names>GD</given-names>
          </name>
        </person-group>
        <article-title>DNA binding sites: representation and discovery</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>16</fpage>
        <lpage>23</lpage>
        <pub-id pub-id-type="pmid">10812473</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zinzen</surname>
            <given-names>RP</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational models for neurogenic gene expression in the Drosophila embryo</article-title>
        <source>Curr. Biol</source>
        <year>2006</year>
        <volume>16</volume>
        <fpage>1358</fpage>
        <lpage>1365</lpage>
        <pub-id pub-id-type="pmid">16750631</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
