<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7672694</article-id>
    <article-id pub-id-type="pmid">32369554</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa288</article-id>
    <article-id pub-id-type="publisher-id">btaa288</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HiC-Hiker: a probabilistic model to determine contig orientation in chromosome-length scaffolds with Hi-C</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-0779-5929</contrib-id>
        <name>
          <surname>Nakabayashi</surname>
          <given-names>Ryo</given-names>
        </name>
        <xref ref-type="corresp" rid="btaa288-cor1"/>
        <!--<email>ryonakabayashi@g.ecc.u-tokyo.ac.jp</email>-->
        <xref ref-type="aff" rid="btaa288-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-6201-8885</contrib-id>
        <name>
          <surname>Morishita</surname>
          <given-names>Shinichi</given-names>
        </name>
        <xref ref-type="corresp" rid="btaa288-cor1"/>
        <!--<email>ryonakabayashi@g.ecc.u-tokyo.ac.jp</email>-->
        <xref ref-type="aff" rid="btaa288-aff1"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btaa288-aff1"><institution>Department of Computational Biology and Medical Sciences</institution>, Graduate School of Frontier Sciences, The University of Tokyo, Chiba 277-8562, <country country="JP">Japan</country></aff>
    <author-notes>
      <corresp id="btaa288-cor1">To whom correspondence should be addressed. <email>ryonakabayashi@g.ecc.u-tokyo.ac.jp</email> or <email>moris@edu.k.u-tokyo.ac.jp</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-05-05">
      <day>05</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>5</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>13</issue>
    <fpage>3966</fpage>
    <lpage>3974</lpage>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>11</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>09</day>
        <month>3</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>4</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa288.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p><italic>De novo</italic> assembly of reference-quality genomes used to require enormously laborious tasks. In particular, it is extremely time-consuming to build genome markers for ordering assembled contigs along chromosomes; thus, they are only available for well-established model organisms. To resolve this issue, recent studies demonstrated that Hi-C could be a powerful and cost-effective means to output chromosome-length scaffolds for non-model species with no genome marker resources, because the Hi-C contact frequency between a pair of two loci can be a good estimator of their genomic distance, even if there is a large gap between them. Indeed, state-of-the-art methods such as 3D-DNA are now widely used for locating contigs in chromosomes. However, it remains challenging to reduce errors in contig orientation because shorter contigs have fewer contacts with their neighboring contigs. These orientation errors lower the accuracy of gene prediction, read alignment, and synteny block estimation in comparative genomics.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>To reduce these contig orientation errors, we propose a new algorithm, named HiC-Hiker, which has a firm grounding in probabilistic theory, rigorously models Hi-C contacts across contigs, and effectively infers the most probable orientations via the Viterbi algorithm. We compared HiC-Hiker and 3D-DNA using human and worm genome contigs generated from short reads, evaluated their performances, and observed a remarkable reduction in the contig orientation error rate from 4.3% (3D-DNA) to 1.7% (HiC-Hiker). Our algorithm can consider long-range information between distal contigs and precisely estimates Hi-C read contact probabilities among contigs, which may also be useful for determining the ordering of contigs.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>HiC-Hiker is freely available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/ryought/hic_hiker">https://github.com/ryought/hic_hiker</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Advanced Genome Research and Bioinformatics Study to Facilitate Medical Innovation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Advanced Research and Development Programs for Medical Innovation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Japan Agency for Medical Research and Development</institution>
            <institution-id institution-id-type="DOI">10.13039/100009619</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>AMED</institution>
            <institution-id institution-id-type="DOI">10.13039/100009619</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>High-quality reference genome sequences have been essential in analyses of organisms over the last two decades; however, due to the prevalence of repetitive elements in genomes, it is still challenging to rebuild the original genomes from reads of short DNA fragments. Specifically, if we use the widely accepted whole-genome shotgun sequencing strategy (<xref rid="btaa288-B26" ref-type="bibr">Weber and Myers, 1997</xref>) with short reads, we can collect short reads and assemble overlapping reads into contiguous sequences, named contigs, using genome assemblers (<xref rid="btaa288-B3" ref-type="bibr">Butler <italic>et al.</italic>, 2008</xref>; <xref rid="btaa288-B13" ref-type="bibr">Gnerre <italic>et al.</italic>, 2011</xref>; <xref rid="btaa288-B19" ref-type="bibr">Luo <italic>et al.</italic>, 2012</xref>; <xref rid="btaa288-B29" ref-type="bibr">Zerbino and Birney, 2008</xref>). The overlapping step, however, is likely to stop extending contigs when it hits abundant repetitive regions that make the extending step ambiguous. Thus, contigs from short reads are fairly short, i.e. typically <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math></inline-formula> kb in size, such that an alternative approach is needed for ordering contigs along chromosomes. To this end, methods for linking neighboring contigs such as bacterial artificial chromosome (or fosmid) end-sequence pairs (<xref rid="btaa288-B9" ref-type="bibr">Edwards <italic>et al.</italic>, 1990</xref>; <xref rid="btaa288-B25" ref-type="bibr">Venter <italic>et al.</italic>, 2001</xref>), long reads (<xref rid="btaa288-B10" ref-type="bibr">Eid <italic>et al.</italic>, 2009</xref>; <xref rid="btaa288-B18" ref-type="bibr">Loose <italic>et al.</italic>, 2016</xref>) and 10× read clouds (<xref rid="btaa288-B27" ref-type="bibr">Weisenfeld <italic>et al.</italic>, 2017</xref>) have been used to output scaffolds of contigs, although these methods fail to produce the chromosome-length scaffolds of large mammalian genomes. To obtain chromosome-length genome sequences, many projects, including the human and worm genome sequencing projects (<xref rid="btaa288-B15" ref-type="bibr">Lander <italic>et al.</italic>, 2001</xref>; <xref rid="btaa288-B24" ref-type="bibr">The <italic>C. elegans</italic> Sequencing Consortium, 1998</xref>), have attempted to generate genome markers for anchoring scaffolds on chromosomes; however, this is a time-consuming and expensive task.</p>
    <p>To overcome these issues in genome assembly, many more links between proximal contigs are needed. A recent promising approach exploits the fact that long DNA molecules are packed in a small nucleus, where a pair of proximal loci are more likely to interact than a distal pair. This tendency can be quantified approximately by the Hi-C method, which allows us to measure the contact frequency between pairs of loci in a genome-wide manner (<xref rid="btaa288-B17" ref-type="bibr">Lieberman-Aiden <italic>et al.</italic>, 2009</xref>). Indeed, the contact frequency between a pair of loci, as observed by Hi-C, is proven to be correlated with the one-dimensional distance between the pair (<xref rid="btaa288-B17" ref-type="bibr">Lieberman-Aiden <italic>et al.</italic>, 2009</xref>), allowing us to use Hi-C data as linking information. This approach can connect distal positions at distances of over 1 million base pairs, including regions of low recombination frequency such as those surrounding meta-centromeres (<xref rid="btaa288-B7" ref-type="bibr">Dudchenko <italic>et al.</italic>, 2017</xref>). The basic concept was proposed in 2013 (<xref rid="btaa288-B2" ref-type="bibr">Burton <italic>et al.</italic>, 2013</xref>) and has been improved by subsequent studies (<xref rid="btaa288-B7" ref-type="bibr">Dudchenko <italic>et al.</italic>, 2017</xref>; <xref rid="btaa288-B12" ref-type="bibr">Ghurye <italic>et al.</italic>, 2019</xref>; <xref rid="btaa288-B21" ref-type="bibr">Putnam <italic>et al.</italic>, 2016</xref>; <xref rid="btaa288-B30" ref-type="bibr">Zhang <italic>et al.</italic>, 2018</xref>, <xref rid="btaa288-B31" ref-type="bibr">2019</xref>). The software program 3D-DNA has shown high performance in producing high-quality chromosome-length scaffolds for human and <italic>Aedes aegypti</italic> genomes (<xref rid="btaa288-B7" ref-type="bibr">Dudchenko <italic>et al.</italic>, 2017</xref>). The 3D-DNA software is used by the <italic>DNA-ZOO</italic> project, which is aiming to produce chromosome-length genomes of many non-model organisms at under $1000 per each organism using short-read sequencing data and only 7× coverage Hi-C data (<xref rid="btaa288-B8" ref-type="bibr">Dudchenko <italic>et al.</italic>, 2018</xref>).</p>
    <p>The 3D-DNA package performs best in terms of accuracy, particularly for contigs assembled from short reads and without prior knowledge of the number of chromosomes; however, it can output scaffolds containing inverted, translocated or misoriented short contigs (<xref rid="btaa288-B7" ref-type="bibr">Dudchenko <italic>et al.</italic>, 2017</xref>, <xref rid="btaa288-B8" ref-type="bibr">2018</xref>). A larger error is easier to identify by manual inspection than a smaller one, if the contact frequency matrix of the focal region is visualized to facilitate manual revision. To assist such investigation, 3D-DNA is equipped with a graphical user interface (GUI) to help users interactively identify large errors in an assembly and fix them manually (<xref rid="btaa288-B8" ref-type="bibr">Dudchenko <italic>et al.</italic>, 2018</xref>). With this GUI, the user can correct many of the large errors in genome assemblies, although it remains infeasible to manually repair a number of misoriented short contigs, which often hinder gene prediction and disturb comparative genomic analysis.</p>
    <p>Thus, we developed a new method that is capable of correcting misoriented contigs automatically to improve the output of 3D-DNA (<xref ref-type="fig" rid="btaa288-F1">Fig. 1</xref>). The HiC-Hiker package can apply file formats used by the 3D-DNA and Juicer packages (e.g. assembly files for scaffold layout and merged_nodups.txt files for Hi-C read alignment), as well as generic formats (e.g. AGP files for scaffold layout and SAM or BAM files for Hi-C read alignment), which are used by several Hi-C-based scaffolding tools. Our probabilistic model of a Hi-C contact probability considers Hi-C contacts not only between two adjacent contigs, but also those within <italic>k</italic> neighboring contigs. Because the contact probability distribution is dependent on each sample (<xref rid="btaa288-B17" ref-type="bibr">Lieberman-Aiden <italic>et al.</italic>, 2009</xref>), it is crucial to obtain a better, empirical approximation of the distribution from a given Hi-C dataset.</p>
    <fig id="btaa288-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>(<bold>1</bold>) A typical workflow of <italic>de novo</italic> assembly using 3D-DNA and HiC-Hiker. HiC-Hiker is used as a post-processing step of the current 3D-DNA pipeline to correct local orientation errors. (<bold>2</bold>) (<bold>a</bold>), (<bold>b</bold>) and (<bold>c</bold>) show schematic dot plots (reference on the x-axis; three scaffolds on the y-axis) in the assembling procedure of an example scaffold composed of six mock contigs. The red and blue lines in the dot plots represent forward- and reverse-complement alignments of scaffolds, respectively. The arrays of arrows on both axes represent the ordering and orientation of contigs in the reference and scaffolds. The leftmost dot plot (a) illustrates 3D-DNA chromosome-length scaffolds with two major errors; the top-right large inversion that involves contigs B1–B3 and the misoriented short contig labeled A2. The former large inversion error can be corrected using Juicebox Assembly Tools (JBAT), since such large errors are typically apparent in plots of the Hi-C contact frequency matrix (b). In contrast, the latter, minor error is often difficult to detect in the contact matrix, so we propose the use of HiC-Hiker to fix the small misorientations; (c) shows revised scaffolds</p>
      </caption>
      <graphic xlink:href="btaa288f1"/>
    </fig>
    <p>To calculate an optimal series of oriented contigs with the globally maximum probability, we here revisit and revise the idea of dynamic programing algorithm used by the Chicago library (<xref rid="btaa288-B21" ref-type="bibr">Putnam <italic>et al.</italic>, 2016</xref>), provide a rigorous mathematical model and extend the algorithm to the processing of contigs of uneven length. We adapt the model to be applicable to scaffolds produced by 3D-DNA and Hi-C data, and achieve better performances compared to previous methods for real human and worm genome datasets.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Formalization of the contig orientation optimization problem</title>
      <p>We first present a formal definition of the scaffolding problem. A <italic>scaffold</italic> is an ordering of contigs, while a <italic>super-scaffold</italic> is a scaffold whose contigs are located in its corresponding chromosome; it is called a <italic>chromosome-level</italic> scaffold if it covers most parts of the chromosome. We here divide the contig scaffolding process into two steps; namely, approximate layout of contigs along chromosomes and precise refinement of contig orientations. We assume a situation where the first step has been done and the relative positions of contigs on the super-scaffold are determined by state-of-the-art software programs, such as 3D-DNA. Thus, we focus on the second step of estimating the optimal orientation of each contig. This problem setting is realistic because 3D-DNA has proven capable of ordering contigs with a high degree of accuracy (<xref rid="btaa288-B8" ref-type="bibr">Dudchenko <italic>et al.</italic>, 2018</xref>). The one remaining major issue is reduction of contig orientation errors.</p>
      <p>Suppose that we have a chromosome-length super-scaffold in which <italic>n</italic> contigs are ordered. For <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, the <italic>i</italic>th contig is a nucleotide sequence of length <italic>L<sub>i</sub></italic> bp, and its orientation in the super-scaffold is denoted as <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo></mml:mrow></mml:math></inline-formula> implies that the contig is reverse complemented in the scaffold (see <xref ref-type="fig" rid="btaa288-F2">Fig. 2</xref>). Let <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> be a set of Hi-C contacts that connect the <italic>i</italic>th and <italic>j</italic>th contigs. Each contact <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a pair of positions on the <italic>i</italic>th and <italic>j</italic>th contigs, <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:mi>r</mml:mi><mml:mo>⋅</mml:mo><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:mi>r</mml:mi><mml:mo>·</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The entire set of Hi-C contacts between different contigs is denoted as the disjoint union <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>⊔</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Using these notations, we aimed to estimate the best possible contig orientations <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:mo>Θ</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> from all Hi-C contacts, <italic>R</italic>.</p>
      <fig id="btaa288-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>(<bold>a</bold>) A schematic representation of a scaffold and a Hi-C contact in our formalization. (<bold>b</bold>) There are four cases orienting two contigs, i.e. the <italic>i</italic>th and <italic>j</italic>th contigs; in each case, the distance between the contact points of <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is fixed depending on <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, as illustrated by the lengths of the red dotted lines</p>
        </caption>
        <graphic xlink:href="btaa288f2"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Probability of each Hi-C contact read</title>
      <p>Next we characterize the contig orientation inference problem from a probabilistic viewpoint. A Hi-C contact frequency is known to be largely correlated with the one-dimensional base-pair distance (<xref rid="btaa288-B17" ref-type="bibr">Lieberman-Aiden <italic>et al.</italic>, 2009</xref>); therefore, let <italic>p</italic>(<italic>d</italic>) be the probability that we observe a contact between two loci separated by the base-pair length <italic>d</italic>. There are rare exceptional situations where the contact frequency between two locations at distance <italic>d</italic> does not follow <italic>p</italic>(<italic>d</italic>) due to the absence of contacts in high-GC content regions, low sequence mappability in repetitive regions or inherent three-dimensional structures, such as large recurrent CCCTC-binding factor (CTCF) loops.</p>
      <p>Despite these relatively rare exceptions, we are able to estimate the probability distribution <italic>p</italic>(<italic>d</italic>) reliably from real Hi-C contacts, although we must take into account the fact that <italic>p</italic>(<italic>d</italic>) can often differ among samples from different species, cell types and/or cell cycles. We must predict an accurate probability distribution for each sample <italic>de novo</italic>. To this end, we can align pairs of reads to a contig and obtain a profile of <italic>p</italic>(<italic>d</italic>) experimentally. Since longer contigs are more informative than shorter contigs, we use the longest contig to generate a contact frequency distribution between two loci at distance <italic>d</italic>, and to estimate <italic>p</italic>(<italic>d</italic>) using kernel density estimation. <italic>p</italic>(<italic>d</italic>) monotonically decreases in terms of <italic>d</italic>, and for a larger value of <italic>d</italic>, the estimate based on real data is likely to be unreliable simply because the number of contacts at distance <italic>d</italic> can be zero, or very small. Thus, with a proper threshold <italic>K</italic>, we set <italic>p</italic>(<italic>d</italic>) to a constant <italic>p</italic>(<italic>K</italic>) such that we observe random contacts when <italic>d </italic>&gt;<italic> K</italic>. The choice of threshold <italic>K</italic> depends on the size of a given Hi-C dataset. We then examined the effect of the <italic>K</italic> value on output accuracy; the third quantile in the histogram of Hi-C contact separation distances provided nearly optimal accuracy (see Section 3). Thus, using the HiC-Hiker package, <italic>K</italic> is determined automatically from the third quantile, if not specified otherwise.</p>
      <p>Next, we calculate the probability of each Hi-C contact between the <italic>i</italic>th and <italic>j</italic>th contigs given their orientations θ<sub><italic>i</italic></sub> and θ<sub><italic>j</italic></sub>. Because it is difficult to predict the size of the gap between adjacent contigs, we here simply assume that there is no gap between them. Using the Hi-C contact distribution <italic>p</italic>(<italic>d</italic>) created accordingly, we can derive the probability of a Hi-C contact between the <italic>i</italic>th and <italic>j</italic>th contigs, <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, for each contig orientation denoted by <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (see <xref ref-type="fig" rid="btaa288-F2">Fig. 2</xref>):
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>⋅</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo>⋅</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>⋅</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo>⋅</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo>⋅</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo>⋅</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo>⋅</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mo>⋅</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the distance between the <italic>i</italic>th and <italic>j</italic>th contigs. <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a normalization factor satisfying the definition of the probability density function. Note that the normalization factors are identical among the above four cases:
<disp-formula id="E2"><mml:math id="M2"><mml:mrow><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="italic">dxdy</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="italic">dxdy</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>y</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mi>p</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mo>+</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>y</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mi>d</mml:mi><mml:mi>y</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:mi>x</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:mi>y</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      <p>Finally, because each contact <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is collected independently, the probability of a set of Hi-C contacts given the contig orientation θ<sub><italic>i</italic></sub> and θ<sub><italic>j</italic></sub> can be written as
<disp-formula id="E3"><mml:math id="M3"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>Notably, because the probability of <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is independent of contig orientations other than <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we have
<disp-formula id="E4"><mml:math id="M4"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:mo>Θ</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. The probability of all Hi-C contacts between contigs in a dataset is:
<disp-formula id="E5"><mml:math id="M5"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>|</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>⊔</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Thus, our goal is to find an optimal instance of Θ that maximizes <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>|</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>:
<disp-formula id="E6"><mml:math id="M6"><mml:mrow><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mo>Θ</mml:mo></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>|</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>To design a hidden Markov model (HMM) algorithm for solving this problem, we here use Bayes’ theorem to derive:
<disp-formula id="E7"><mml:math id="M7"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>|</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is <inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋯</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Because the orientations of different contigs, θ<sub><italic>i</italic></sub>, are independent of each other and selected at random, we have <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> for each <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, and we can treat <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as a constant, <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>. Thus, resolving <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:mi>arg</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:mrow><mml:mo>Θ</mml:mo></mml:msub><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>|</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> also solves <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:mi>arg</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:mrow><mml:mo>Θ</mml:mo></mml:msub><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In the following, we propose an HMM algorithm for solving:
<disp-formula id="E8"><label>(2)</label><mml:math id="M8"><mml:mtable><mml:mtr><mml:mtd><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mo>Θ</mml:mo></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>|</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mo>Θ</mml:mo></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mo>Θ</mml:mo></mml:munder><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>2.3 Optimization of contig orientations using HMM</title>
      <p>Hi-C contacts between more distal contigs are likely to be less informative for estimating contig orientations, because the number of contacts is small, and the distances between the contacts become independent of their orientations, which contrasts with the situation when handling proximal contigs. Our probabilistic model takes this property into account naturally; that is, since <italic>p</italic>(<italic>d</italic>) is constant for <italic>d </italic>&gt;<italic> K</italic> if all contacts between the <italic>i</italic>th and <italic>j</italic>th contigs are at distances greater than <italic>K</italic>, they have the same probability regardless of their orientation. In other words, <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is identical for all <inline-formula id="IE34"><mml:math id="IM34"><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> if <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
      <p>For better readability, we here assume a simple condition whereby all contigs are of the same size (<italic>L<sub>s</sub></italic> = <italic>L</italic> for all <italic>s</italic>), although this assumption is not essential and will be removed later. In this case, <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> can be simplified to <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:mo>|</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mo>≥</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> even in the absence of orientation information. Thus, we only need to consider contacts between <italic>k</italic> neighboring contigs for a given non-negative integer <inline-formula id="IE38"><mml:math id="IM38"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>/</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>; namely, a contact between the <italic>i</italic>th and <italic>j</italic>th contigs is used if <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:mo>|</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>.</p>
      <p>Given these conditions, we can transform the right side of <xref ref-type="disp-formula" rid="E8">Equation (2)</xref> into:
<disp-formula id="E9"><label>(3)</label><mml:math id="M9"><mml:mrow><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mo>Θ</mml:mo></mml:munder><mml:munder><mml:mo>∏</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>|</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>Using <italic>j</italic> as the primary index and expressing the range of <italic>i</italic> in terms of <italic>j</italic>, we rewrite Formula (3):
<disp-formula id="E10"><label>(4)</label><mml:math id="M10"><mml:mrow><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mo>Θ</mml:mo></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>We then divide the entire range of <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> into <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> so that we can design an HMM algorithm for solving this optimization problem:
<disp-formula id="E11"><label>(5)</label><mml:math id="M11"><mml:mtable><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mo>Θ</mml:mo></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p>In the above formula, note that <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is independent of contig orientations other than θ<sub><italic>i</italic></sub> and θ<sub><italic>j</italic></sub>, and is also independent of other sets of contacts <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> where <inline-formula id="IE45"><mml:math id="IM45"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> or <inline-formula id="IE46"><mml:math id="IM46"><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>. Finally, we have:
<disp-formula id="E12"><mml:math id="M12"><mml:mstyle displaystyle="true"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>arg</mml:mi><mml:msub><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mo>Θ</mml:mo></mml:msub><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mo>=</mml:mo><mml:malignmark/><mml:mi>arg</mml:mi><mml:msub><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mo>Θ</mml:mo></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>⊔</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mo>⊔</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:math></disp-formula>where <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> represents set <inline-formula id="IE48"><mml:math id="IM48"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. We can solve the above optimization problem using HMM such that the hidden states are sets of orientations:
<disp-formula id="E13"><mml:math id="M13"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>for</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>The observations are sets of contacts:
<disp-formula id="E14"><label>(6)</label><mml:math id="M14"><mml:mrow><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>⊔</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>⊔</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
      <p>The emission probability <inline-formula id="IE49"><mml:math id="IM49"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is defined as:
<disp-formula id="E15"><mml:math id="M15"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>O</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>⊔</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>⊔</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>which can be calculated using Formula (1), and the transition probability is:
<disp-formula id="E16"><mml:math id="M16"><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:mtext>orientations</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mtext>are</mml:mtext><mml:mo> </mml:mo><mml:mtext>consistent</mml:mtext><mml:mo> </mml:mo><mml:mtext>in</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mtext>and</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p><xref ref-type="fig" rid="btaa288-F3">Figure 3</xref> illustrates an example of this HMM in the case of <italic>k </italic>=<italic> </italic>3 and <italic>n </italic>=<italic> </italic>5. The most likely path on the above HMM, which can be found efficiently using the Viterbi algorithm, gives the most probable set of contig orientations, Θ.</p>
      <fig id="btaa288-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>A sketch of the hidden Markov model proposed in this study, for the case where <italic>k </italic>=<italic> </italic>3 and <italic>n </italic>=<italic> </italic>5. The hidden states and all transitions are shown on the right, and the corresponding observations are shown on the left. For example, <inline-formula id="IE50"><mml:math id="IM50"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is chosen because its corresponding observation is the most probable with the minimum sum of distances between pairs of contacts; therefore, its emission probability is the highest; that is, the product of probabilities of Hi-C contact pairs is the highest among the eight contig orientation patterns. For the other two hidden states, suppose that <inline-formula id="IE51"><mml:math id="IM51"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE52"><mml:math id="IM52"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mn>5</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are selected. The most likely path in this model, which is shown in red, represents the most probable orientations of the contigs <inline-formula id="IE53"><mml:math id="IM53"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>,</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p>
        </caption>
        <graphic xlink:href="btaa288f3"/>
      </fig>
      <p>We have so far assumed that contigs are of the same size for better readability of the proposed algorithm. More precisely, for determining the orientation of the <italic>i</italic>th contig, we use contact information from the <italic>j</italic>th contig within <italic>k</italic> contigs (<inline-formula id="IE54"><mml:math id="IM54"><mml:mrow><mml:mo>|</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></inline-formula>) for a given constant <italic>k</italic>. In general, however, contigs differ in size. For handling regions wherein shorter contigs (e.g. <inline-formula id="IE55"><mml:math id="IM55"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mn>0</mml:mn><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> kb in length,) are enriched, contacts from more distal contigs would be informative to determine the contig orientations. In contrast, to process adjacent large contigs (e.g. <inline-formula id="IE56"><mml:math id="IM56"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> Mb in size), contacts between the two contigs would be sufficient. Thus, we must change the neighborhood of the focal <italic>i</italic>th contig adaptively, depending on the sizes of the neighboring contigs. To achieve this, hereafter, we will consider contacts between the <italic>i</italic>th and <italic>j</italic>th contigs within <italic>K</italic> distance <inline-formula id="IE57"><mml:math id="IM57"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Recall that <italic>K</italic> is the threshold parameter for pairs of distal contigs in the Hi-C contact probability distribution <italic>p</italic>(<italic>d</italic>); when all contacts between the <italic>i</italic>th and <italic>j</italic>th contigs are at distance <italic>K</italic> or more (<inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>≥</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula>), they have the same probability regardless of their orientations.</p>
      <p>Thus, the problem can be rewritten by setting <inline-formula id="IE59"><mml:math id="IM59"><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mo>{</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE60"><mml:math id="IM60"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mo>{</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>:
<disp-formula id="E17"><mml:math id="M17"><mml:mstyle displaystyle="true"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mo>Θ</mml:mo></mml:munder><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mo>=</mml:mo><mml:malignmark/><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>max</mml:mi></mml:mrow><mml:mo>Θ</mml:mo></mml:munder><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munder><mml:mo>⊔</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mrow><mml:mrow><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mo>⊔</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>j</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>Θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:math></disp-formula>which can be treated as an HMM with corresponding states and emission/transition probabilities. When determining orientations in regions with short contigs, the above modification allows us to use a sufficient number of contig orientations to correct errors. This idea is novel, and thus not described in the previous dynamic programing algorithm (<xref rid="btaa288-B21" ref-type="bibr">Putnam <italic>et al.</italic>, 2016</xref>); moreover, it is useful for handling short contigs.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Experimental results</title>
    <sec>
      <title>3.1 Datasets and error metrics</title>
      <p>To demonstrate how misoriented contigs in 3D-DNA scaffolds are corrected in the HiC-Hiker package, we used human and worm genome datasets for benchmarking, since Hi-C and Illumina short-read data from these species are abundant, and their reference genomes are nearly complete.</p>
      <p>We used the human genome dataset provided in <xref rid="btaa288-B8" ref-type="bibr">Dudchenko <italic>et al.</italic> (2018)</xref>. The first 300 million read pairs from the Illumina dataset for NA12878 of the Genome in a Bottle Consortium were assembled using the w2rap-contigger assembler (<xref rid="btaa288-B5" ref-type="bibr">Clavijo <italic>et al.</italic>, 2017a</xref>, <xref rid="btaa288-B6" ref-type="bibr">b</xref>). The first 100 million read pairs from the HIC001 <italic>in situ</italic> Hi-C library (<xref rid="btaa288-B22" ref-type="bibr">Rao <italic>et al.</italic>, 2014</xref>) were mapped onto the contigs using the Juicer platform, with approximately 7× coverage. We assembled Illumina short reads (DRR008443, DRR008444) to create a worm genome dataset using the SPAdes v. 3.13.0 assembler (<xref rid="btaa288-B1" ref-type="bibr">Bankevich <italic>et al.</italic>, 2012</xref>). We also used w2rap contigger; however, it output excessive chimeric contigs, which were not used in further analyses. The first 10, 20 and 40 million read pairs (7×, 14× and 28× coverage, respectively) from the Hi-C library (accession nos. SRR3105476 and SRR3105477; <xref rid="btaa288-B11" ref-type="bibr">Gabdank <italic>et al.</italic>, 2016</xref>) were mapped onto the contigs using Juicer.</p>
      <p>We then ran the entire 3D-DNA pipeline (version 180922) using these data with the default parameter settings, with the exception of minimum contig length, which was set to 5, 15 and 50 kb for the worm genome dataset to determine how its variation affected the accuracy of the results. We also ran two alternative scaffolding algorithms, SALSA2 (<xref rid="btaa288-B12" ref-type="bibr">Ghurye <italic>et al.</italic>, 2019</xref>) and ALLHiC v. 0.9.13 (<xref rid="btaa288-B30" ref-type="bibr">Zhang <italic>et al.</italic>, 2018</xref>, <xref rid="btaa288-B31" ref-type="bibr">2019</xref>), using the worm dataset. Hi-C reads were mapped using the BWA-MEM alignment package with the recommended settings of the scaffolding algorithms (<xref rid="btaa288-B16" ref-type="bibr">Li and Durbin, 2010</xref>). We compared SALSA2 orientation corrections using assembly graphs and tested the results against NA12878 unitigs assembled from Oxford Nanopore reads using the Canu assembler (<xref rid="btaa288-B14" ref-type="bibr">Koren <italic>et al.</italic>, 2017</xref>) and scaffolds generated by SALSA2 with and without the assembly graph shared by the creators of SALSA2 (<xref rid="btaa288-B12" ref-type="bibr">Ghurye <italic>et al.</italic>, 2019</xref>).</p>
      <p>We manually corrected large-scale (&gt;1 Mb) errors in the 3D-DNA human scaffolds using Juicebox Assembly Tools (JBAT), such that 95 fragmented scaffolds were joined into 23 scaffolds, each of which corresponded to an individual human chromosome. No errors in the worm scaffolds were sufficiently large to require manual inspection.</p>
      <p>Afterwards, we ran our software, HiC-Hiker, and inferred the probabilistic distribution <italic>p</italic>(<italic>d</italic>) based on the longest contig. To validate the feasibility of using the longest contig, we compared the distributions calculated from the three longest contigs in the human dataset and confirmed the consistency among the probability distributions (see <xref ref-type="fig" rid="btaa288-F4">Fig. 4</xref>). In <xref ref-type="fig" rid="btaa288-F4">Figure 4</xref>, the red line shows the fitted probability distribution, which was actually used as <italic>p</italic>(<italic>d</italic>). For the fitting, we used <inline-formula id="IE61"><mml:math id="IM61"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> as a base function; except for the probability of the short distance contacts (e.g. <inline-formula id="IE62"><mml:math id="IM62"><mml:mrow><mml:mi>d</mml:mi><mml:mo>&lt;</mml:mo></mml:mrow></mml:math></inline-formula> 3 kb), we used polynomial fitting to simulate the non-monotonically decreasing distribution actually observed. We set <italic>K</italic> to 75 kb, the third quantile of the histogram of Hi-C contact probability distribution. Note that the probability was unstable and noisy when <italic>d</italic> exceeded <italic>K</italic>.</p>
      <fig id="btaa288-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Comparison of contact probability distributions among the longest contig (blue), second longest contig (yellow) and the third longest contig (green). The smoothed distribution calculated from the longest contig is shown by the red line, which is actually used as <italic>P</italic>(<italic>d</italic>). This distribution appears to represent a good approximation of the top three distributions. <italic>P</italic>(<italic>d</italic>) was set to a constant probability when <inline-formula id="IE63"><mml:math id="IM63"><mml:mrow><mml:mi>d</mml:mi><mml:mo>&gt;</mml:mo></mml:mrow></mml:math></inline-formula> 75 kb, shown as a gray-colored region</p>
        </caption>
        <graphic xlink:href="btaa288f4"/>
      </fig>
      <p>After generating the refined scaffolds, we calculated the error rates. Given a scaffold with a series of contigs <inline-formula id="IE64"><mml:math id="IM64"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, suppose that these contigs are aligned with the reference genome according to the following ordering and orientation:
<disp-formula id="E18"><mml:math id="M18"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE65"><mml:math id="IM65"><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> represents a situation wherein the reverse complement of contig <italic>X</italic> is aligned. This example corresponds to the dot plots in <xref ref-type="fig" rid="btaa288-F1">Figure 1</xref>-(2). Our HiC-Hiker fixes <italic>A</italic><sub>2</sub>, a misorientation of a single contig <inline-formula id="IE66"><mml:math id="IM66"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, by using the contacts from <italic>A</italic><sub>2</sub> to <italic>A</italic><sub>1</sub>, <italic>A</italic><sub>3</sub> and <italic>A</italic><sub>4</sub>. In contrast, however, <inline-formula id="IE67"><mml:math id="IM67"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:math></inline-formula> show a large erroneous inversion of <inline-formula id="IE68"><mml:math id="IM68"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. HiC-Hiker is tailored to correct local errors, and is unlikely to handle this type of large-scale error; this necessitates a priori manual correction using the 3D-DNA GUI function.</p>
      <p>With this example in mind, we here define global and local orientation errors. The orientation of a contig <italic>X</italic> is ‘globally erroneous’ if <inline-formula id="IE69"><mml:math id="IM69"><mml:mrow><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is aligned with the reference. For example, in the running example, the orientations of <inline-formula id="IE70"><mml:math id="IM70"><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are globally erroneous. In contrast, the orientation is ‘locally erroneous’ if it is inconsistent with the orientations of its two neighboring contigs in the reference genome. According to this definition, only <italic>A</italic><sub>2</sub> is locally erroneous; <inline-formula id="IE71"><mml:math id="IM71"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are not. It would be reasonable to focus on correcting local errors if we assume that global orientation errors of large contig blocks (e.g. <inline-formula id="IE72"><mml:math id="IM72"><mml:mrow><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>) can mostly be corrected manually using JBAT. Thus, to demonstrate the reliability of contig orientations after refining the orientations of scaffolds with HiC-Hiker, we use the local error rate, that is, the ratio of contigs whose orientations are locally erroneous to all contigs.</p>
      <p>Specifically, since the definitions of global and local errors differ, methods for detecting each error type must be designed individually. To calculate a <italic>global orientation accuracy</italic>, the researchers who introduced 3D-DNA randomly sampled 1000-nt regions from the scaffolds that are uniquely aligned onto the reference, and computed the ratio of the chunks oriented in agreement with the reference to the entire set of sampled regions (<xref rid="btaa288-B8" ref-type="bibr">Dudchenko <italic>et al.</italic>, 2018</xref>). In contrast, to calculate a <italic>local orientation accuracy</italic>, we align contigs to the reference, and select triples of neighboring, uniquely mapped contigs such that their orderings does not change in the reference, and compute the ratio of the middle contigs whose orientations agree with those of their neighboring contigs to the entire set of sampled contigs, on both sides.</p>
      <p>We also calculated the accuracy statistics suggested by <xref rid="btaa288-B8" ref-type="bibr">Dudchenko <italic>et al.</italic> (2018)</xref>, including anchoring accuracy (i.e. the percentage of chunks mapped onto the correct chromosome corresponding to each chromosome-length scaffold), global ordering accuracy (i.e. the percentage of randomly selected pairs of chunks mapped onto the correct chromosome in the same order as the reference sequences), local ordering accuracy (i.e. the percentage of adjacent pairs of chunks mapped onto the correct chromosome in the same order as the reference sequences) and global orientation accuracy (i.e. the percentage of chunks mapped onto the correct chromosome with the correct orientation). We calculated the average of each statistic over five different chunks.</p>
      <p>As a reference sequence for the NA12878 human genome dataset, we adopted NA12878 inversions (<xref rid="btaa288-B23" ref-type="bibr">Shao <italic>et al.</italic>, 2018</xref>) to the hg38 reference and modified the hg38 reference accordingly. As a reference sequence for the worm dataset, we used the latest complete VC2010 reference genome (<xref rid="btaa288-B28" ref-type="bibr">Yoshimura <italic>et al.</italic>, 2019</xref>).</p>
    </sec>
    <sec>
      <title>3.2 Comparison of HiC-Hiker with 3D-DNA</title>
      <p>Local contig orientation errors were successfully corrected using our program. A comparison of dataset and scaffold accuracy metrics before and after running HiC-Hiker is shown in <xref rid="btaa288-T1" ref-type="table">Table 1</xref>. At a minimum length threshold of 15 kb and 7× Hi-C coverage, which is the recommended configuration of the 3D-DNA tool suites, HiC-Hiker improved the accuracy of local ordering, global orientation and local orientation in the human and worm datasets. Scaffold accuracy was dependent on the threshold <italic>K</italic> value. A threshold of 7.5 kb was too short to improve scaffold accuracy, as demonstrated in the distribution plot; however, no significant difference in accuracy was observed between 75 and 200 kb. Therefore, 75 kb was selected as the optimal <italic>K</italic> threshold in terms of computation time and scaffold accuracy. The minimum length threshold affects the number of short contigs, which are difficult to order and orient, and are major targets of HiC-Hiker. Compared to lower (5 or 15 kb) thresholds, there are few short contigs that can be improved by examining in detail when with the higher threshold (50 kb), so HiC-Hiker offered only limited improvement. As the Hi-C coverage increased, the local accuracy of the intact 3D-DNA output improved. Orientation errors were successfully corrected even at 28× coverage using HiC-Hiker. The ALLHiC software generated chromosome-length scaffolds with accuracy values similar to those of 3D-DNA; ALLHiC was more accurate in terms of local layout but less accurate in terms of anchoring and global ordering. Even in this case, the local orientation of output scaffolds was slightly improved using the HiC-Hiker package. In the ALLHiC algorithm, the number of chromosomes is supplied beforehand, thus improving chromosome reconstruction, but limiting the applicability of ALLHiC to organisms with a known number of chromosomes. The SALSA2 algorithm is designed to handle long-read contigs to output highly accurate chromosome-length scaffolds. When short-read contigs were supplied, SALSA2 generated only fragmented scaffolds; thus, accuracy statistics could not be computed for chromosome-length scaffolds, and the HiC-Hiker algorithm could not be applied under these conditions. Because N50 contig lengths are sufficiently high, only a few short contigs required orientation correction; therefore, the improvement in accuracy under the HiC-Hiker package was nominal.</p>
      <table-wrap id="btaa288-T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>A comparison of dataset and scaffold accuracy metrics before and after running HiC-Hiker</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Species</th>
              <th colspan="2" rowspan="1">Human (NA12878)</th>
              <th colspan="10" rowspan="1">Worm (VC2010)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Assembler</td>
              <td rowspan="1" colspan="1">w2rap + Illumina</td>
              <td rowspan="1" colspan="1">Canu + ONT</td>
              <td colspan="10" rowspan="1">SPAdes + Illumina</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Contig N50 (kb)</td>
              <td rowspan="1" colspan="1">68.6</td>
              <td rowspan="1" colspan="1">4821.0</td>
              <td colspan="10" rowspan="1">41.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Contig maximum length (kb)</td>
              <td rowspan="1" colspan="1">934.6</td>
              <td rowspan="1" colspan="1">34 607.7</td>
              <td colspan="10" rowspan="1">283.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Scaffolding software</td>
              <td rowspan="1" colspan="1">3D-DNA</td>
              <td colspan="2" align="center" rowspan="1">SALSA2</td>
              <td colspan="7" align="center" rowspan="1">3D-DNA</td>
              <td rowspan="1" colspan="1">ALLHiC</td>
              <td rowspan="1" colspan="1">SALSA2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">W/o graph</td>
              <td rowspan="1" colspan="1">W/ graph</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1"/>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Minimum length threshold</td>
              <td rowspan="1" colspan="1">15k</td>
              <td rowspan="1" colspan="1">—</td>
              <td rowspan="1" colspan="1">—</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">15k</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">5k</td>
              <td rowspan="1" colspan="1">50k</td>
              <td colspan="2" rowspan="1">15k</td>
              <td rowspan="1" colspan="1">15k</td>
              <td rowspan="1" colspan="1">15k</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Hi-C coverage</td>
              <td rowspan="1" colspan="1">7×</td>
              <td rowspan="1" colspan="1">7×</td>
              <td rowspan="1" colspan="1">7×</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">7×</td>
              <td rowspan="1" colspan="1"/>
              <td colspan="2" rowspan="1">7×</td>
              <td rowspan="1" colspan="1">14×</td>
              <td rowspan="1" colspan="1">28×</td>
              <td rowspan="1" colspan="1">7×</td>
              <td rowspan="1" colspan="1">7×</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Threshold K</td>
              <td rowspan="1" colspan="1">75 kb</td>
              <td rowspan="1" colspan="1">75 kb</td>
              <td rowspan="1" colspan="1">75 kb</td>
              <td rowspan="1" colspan="1">7.5 kb</td>
              <td rowspan="1" colspan="1">75 kb</td>
              <td rowspan="1" colspan="1">200 kb</td>
              <td colspan="2" rowspan="1">75 kb</td>
              <td colspan="2" rowspan="1">75 kb</td>
              <td rowspan="1" colspan="1">75 kb</td>
              <td rowspan="1" colspan="1">75 kb</td>
            </tr>
            <tr>
              <td colspan="13" rowspan="1">Raw scaffolds &gt;1 Mb before (after) manual correction</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> No. of scaffolds</td>
              <td rowspan="1" colspan="1">95 (23)</td>
              <td rowspan="1" colspan="1">75</td>
              <td rowspan="1" colspan="1">81</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">7</td>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">6</td>
              <td rowspan="1" colspan="1">5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Total bases (Mb)</td>
              <td rowspan="1" colspan="1">2391.4 (2392.0)</td>
              <td rowspan="1" colspan="1">2624.8</td>
              <td rowspan="1" colspan="1">2622.8</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">77.5</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">89.8</td>
              <td rowspan="1" colspan="1">39.4</td>
              <td rowspan="1" colspan="1">77.9</td>
              <td rowspan="1" colspan="1">78.0</td>
              <td rowspan="1" colspan="1">77.8</td>
              <td rowspan="1" colspan="1">7.4</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Maximum length (Mb)</td>
              <td rowspan="1" colspan="1">127.7 (205.1)</td>
              <td rowspan="1" colspan="1">273.4</td>
              <td rowspan="1" colspan="1">188.9</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">16.0</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">18.7</td>
              <td rowspan="1" colspan="1">8.8</td>
              <td rowspan="1" colspan="1">16.1</td>
              <td rowspan="1" colspan="1">16.2</td>
              <td rowspan="1" colspan="1">16.2</td>
              <td rowspan="1" colspan="1">1.8</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Anchoring</td>
              <td rowspan="1" colspan="1">99.75% (99.74%)</td>
              <td rowspan="1" colspan="1">90.42%</td>
              <td rowspan="1" colspan="1">96.76%</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">99.03%</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">95.89%</td>
              <td rowspan="1" colspan="1">95.31%</td>
              <td rowspan="1" colspan="1">98.89%</td>
              <td rowspan="1" colspan="1">98.61%</td>
              <td rowspan="1" colspan="1">98.24%</td>
              <td rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Ordering</td>
              <td rowspan="1" colspan="1">98.39% (89.62%)</td>
              <td rowspan="1" colspan="1">90.95%</td>
              <td rowspan="1" colspan="1">93.20%</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">99.79%</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">99.37%</td>
              <td rowspan="1" colspan="1">99.62%</td>
              <td rowspan="1" colspan="1">99.82%</td>
              <td rowspan="1" colspan="1">99.81%</td>
              <td rowspan="1" colspan="1">98.93%</td>
              <td rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Local ordering</td>
              <td rowspan="1" colspan="1">90.58% (89.97%)</td>
              <td rowspan="1" colspan="1">90.24%</td>
              <td rowspan="1" colspan="1">92.41%</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">85.71%</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">84.71%</td>
              <td rowspan="1" colspan="1">84.25%</td>
              <td rowspan="1" colspan="1">89.04%</td>
              <td rowspan="1" colspan="1">91.20%</td>
              <td rowspan="1" colspan="1">91.57%</td>
              <td rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Orientation</td>
              <td rowspan="1" colspan="1">91.57% (90.95%)</td>
              <td rowspan="1" colspan="1">90.31%</td>
              <td rowspan="1" colspan="1">92.48%</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">86.31%</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">85.37%</td>
              <td rowspan="1" colspan="1">84.82%</td>
              <td rowspan="1" colspan="1">89.72%</td>
              <td rowspan="1" colspan="1">91.95%</td>
              <td rowspan="1" colspan="1">92.46%</td>
              <td rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Local orientation</td>
              <td rowspan="1" colspan="1">95.72% (95.70%)</td>
              <td rowspan="1" colspan="1">96.00%</td>
              <td rowspan="1" colspan="1">96.34%</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">88.35%</td>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">86.07%</td>
              <td rowspan="1" colspan="1">87.24%</td>
              <td rowspan="1" colspan="1">89.83%</td>
              <td rowspan="1" colspan="1">92.04%</td>
              <td rowspan="1" colspan="1">93.01%</td>
              <td rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td colspan="13" rowspan="1"> HiC-Hiker output</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Anchoring</td>
              <td rowspan="1" colspan="1">99.74%</td>
              <td rowspan="1" colspan="1">90.44%</td>
              <td rowspan="1" colspan="1">96.75%</td>
              <td rowspan="1" colspan="1">99.03%</td>
              <td rowspan="1" colspan="1">99.00%</td>
              <td rowspan="1" colspan="1">99.01%</td>
              <td rowspan="1" colspan="1">95.17%</td>
              <td rowspan="1" colspan="1">95.32%</td>
              <td rowspan="1" colspan="1">98.90%</td>
              <td rowspan="1" colspan="1">98.63%</td>
              <td rowspan="1" colspan="1">98.23%</td>
              <td rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Ordering</td>
              <td rowspan="1" colspan="1">89.64%</td>
              <td rowspan="1" colspan="1">88.42%</td>
              <td rowspan="1" colspan="1">94.74%</td>
              <td rowspan="1" colspan="1">99.76%</td>
              <td rowspan="1" colspan="1">99.80%</td>
              <td rowspan="1" colspan="1">99.81%</td>
              <td rowspan="1" colspan="1">99.26%</td>
              <td rowspan="1" colspan="1">99.64%</td>
              <td rowspan="1" colspan="1">99.82%</td>
              <td rowspan="1" colspan="1">99.84%</td>
              <td rowspan="1" colspan="1">98.98%</td>
              <td rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Local ordering</td>
              <td rowspan="1" colspan="1">91.09%</td>
              <td rowspan="1" colspan="1">90.42%</td>
              <td rowspan="1" colspan="1">92.28%</td>
              <td rowspan="1" colspan="1">81.06%</td>
              <td rowspan="1" colspan="1">88.89%</td>
              <td rowspan="1" colspan="1">89.11%</td>
              <td rowspan="1" colspan="1">85.57%</td>
              <td rowspan="1" colspan="1">84.65%</td>
              <td rowspan="1" colspan="1">92.43%</td>
              <td rowspan="1" colspan="1">93.93%</td>
              <td rowspan="1" colspan="1">92.28%</td>
              <td rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Orientation</td>
              <td rowspan="1" colspan="1">92.19%</td>
              <td rowspan="1" colspan="1">90.49%</td>
              <td rowspan="1" colspan="1">92.36%</td>
              <td rowspan="1" colspan="1">81.51%</td>
              <td rowspan="1" colspan="1">89.61%</td>
              <td rowspan="1" colspan="1">89.85%</td>
              <td rowspan="1" colspan="1">86.58%</td>
              <td rowspan="1" colspan="1">85.20%</td>
              <td rowspan="1" colspan="1">93.28%</td>
              <td rowspan="1" colspan="1">94.78%</td>
              <td rowspan="1" colspan="1">93.06%</td>
              <td rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> Local orientation</td>
              <td rowspan="1" colspan="1">98.25%</td>
              <td rowspan="1" colspan="1">96.67%</td>
              <td rowspan="1" colspan="1">96.73%</td>
              <td rowspan="1" colspan="1">84.45%</td>
              <td rowspan="1" colspan="1">93.75%</td>
              <td rowspan="1" colspan="1">93.69%</td>
              <td rowspan="1" colspan="1">92.06%</td>
              <td rowspan="1" colspan="1">88.78%</td>
              <td rowspan="1" colspan="1">95.83%</td>
              <td rowspan="1" colspan="1">96.68%</td>
              <td rowspan="1" colspan="1">93.80%</td>
              <td rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td colspan="13" rowspan="1">No. of contig flip</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> True positives</td>
              <td rowspan="1" colspan="1">1139</td>
              <td rowspan="1" colspan="1">33</td>
              <td rowspan="1" colspan="1">39</td>
              <td rowspan="1" colspan="1">119</td>
              <td rowspan="1" colspan="1">118</td>
              <td rowspan="1" colspan="1">115</td>
              <td rowspan="1" colspan="1">207</td>
              <td rowspan="1" colspan="1">31</td>
              <td rowspan="1" colspan="1">125</td>
              <td rowspan="1" colspan="1">96</td>
              <td rowspan="1" colspan="1">38</td>
              <td rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> True negatives</td>
              <td rowspan="1" colspan="1">35 157</td>
              <td rowspan="1" colspan="1">1124</td>
              <td rowspan="1" colspan="1">1122</td>
              <td rowspan="1" colspan="1">1179</td>
              <td rowspan="1" colspan="1">1323</td>
              <td rowspan="1" colspan="1">1325</td>
              <td rowspan="1" colspan="1">1962</td>
              <td rowspan="1" colspan="1">317</td>
              <td rowspan="1" colspan="1">1439</td>
              <td rowspan="1" colspan="1">1507</td>
              <td rowspan="1" colspan="1">1505</td>
              <td rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> False positives</td>
              <td rowspan="1" colspan="1">193</td>
              <td rowspan="1" colspan="1">30</td>
              <td rowspan="1" colspan="1">31</td>
              <td rowspan="1" colspan="1">179</td>
              <td rowspan="1" colspan="1">35</td>
              <td rowspan="1" colspan="1">33</td>
              <td rowspan="1" colspan="1">66</td>
              <td rowspan="1" colspan="1">25</td>
              <td rowspan="1" colspan="1">27</td>
              <td rowspan="1" colspan="1">19</td>
              <td rowspan="1" colspan="1">25</td>
              <td rowspan="1" colspan="1">—</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"> False negatives</td>
              <td rowspan="1" colspan="1">453</td>
              <td rowspan="1" colspan="1">34</td>
              <td rowspan="1" colspan="1">30</td>
              <td rowspan="1" colspan="1">60</td>
              <td rowspan="1" colspan="1">61</td>
              <td rowspan="1" colspan="1">64</td>
              <td rowspan="1" colspan="1">122</td>
              <td rowspan="1" colspan="1">19</td>
              <td rowspan="1" colspan="1">41</td>
              <td rowspan="1" colspan="1">36</td>
              <td rowspan="1" colspan="1">77</td>
              <td rowspan="1" colspan="1">—</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p><xref ref-type="fig" rid="btaa288-F5">Figure 5</xref> shows the local error rates of scaffolds output by 3D-DNA and scaffolds refined by HiC-Hiker in human dataset, according to different numbers of hidden states, <italic>k</italic>. The local error rate in the scaffold generated by 3D-DNA was 4.3%, but was remarkably reduced to 1.7% after refinement via HiC-Hiker (adaptive). When we set the parameter <italic>k</italic> to 2, 3, 4 and 5, which represents how many contigs are considered in single hidden states, the local error rates were 1.85%, 1.78%, 1.75% and 1.75%, respectively. Thus, using contacts between more distal contigs slightly improves the accuracy of their orientations.</p>
      <fig id="btaa288-F5" orientation="portrait" position="float">
        <label>Fig. 5.</label>
        <caption>
          <p>Local error rates of the human scaffolds generated by 3D-DNA and refined by HiC-Hiker. The error rate was remarkably reduced from 4.3% (3D-DNA) to 1.7% (HiC-Hiker)</p>
        </caption>
        <graphic xlink:href="btaa288f5"/>
      </fig>
      <p><xref ref-type="fig" rid="btaa288-F6">Figure 6</xref> shows dot plots of scaffolds along human chromosome 8, where the dot plots were generated using MUMmer4 (<xref rid="btaa288-B20" ref-type="bibr">Marçais <italic>et al.</italic>, 2018</xref>). The left and right columns show 3D-DNA and HiC-Hiker scaffolds, respectively, in comparison with the reference genome. Blue dots show misoriented contigs, and the decrease in the number of the blue dots demonstrates the usefulness of refining orientations with HiC-Hiker.</p>
      <fig id="btaa288-F6" orientation="portrait" position="float">
        <label>Fig. 6.</label>
        <caption>
          <p>Four dot plots of scaffolds along human chromosome 8. The top row shows dot plots where the reference genome is on the x-axis and scaffolds output by 3D-DNA (left) and HiC-Hiker (right) are on the y-axis. The red-colored dots indicate correct orientations of contigs (forward alignment with the reference) while the blue-colored dots show erroneous orientations (reverse-complement alignments). The dot plots show that the reference is mostly covered by contigs. The total length of contigs in the scaffolds is 123 011 808 bp, which is close to 145 138 636 bp, i.e. the length of chromosome 8 in hg38. In the left bottom portions of both of the upper dot plots, we see large reverse-complement alignments of the reference and scaffolds. In the lower dot plots, we enlarged parts of the upper two plots to show the reference genomic region, which ranges from 65 to 74 Mb. The six orientation errors of short contigs shown in the lower left plot shown as blue dots are corrected in the HiC-Hiker scaffold shown in the lower right plot</p>
        </caption>
        <graphic xlink:href="btaa288f6"/>
      </fig>
      <p>Shorter contigs are likely to be more difficult to orient correctly than longer contigs, because fewer contacts are available on shorter contigs. To confirm this tendency, <xref ref-type="fig" rid="btaa288-F7">Figure 7</xref> presents another plot showing the local error rates of contigs according to their lengths. In this analysis, contigs smaller than 15 kb in length were not considered because 3D-DNA was set to ignore them. This figure illustrates that it tends to be difficult to determine the orientations of shorter contigs, and HiC-Hiker can correct more local orientation errors in both short and long contigs than 3D-DNA.</p>
      <fig id="btaa288-F7" orientation="portrait" position="float">
        <label>Fig. 7.</label>
        <caption>
          <p>Plot of local error rates of contigs according to their lengths. Overall, shorter contigs are difficult to orient due to insufficient Hi-C contacts, but this plot indicates that HiC-Hiker outperformed 3D-DNA in repairing the orientations not only of shorter contigs, but also of longer contigs</p>
        </caption>
        <graphic xlink:href="btaa288f7"/>
      </fig>
      <p>For the human dataset, it took 37 min to run the whole pipeline on our computer, but the loading of contigs and Hi-C read mapping data spent most of the time. In particular, the HMM optimization process took 2, 4, 13 and 39 s when we set <italic>k</italic> to 2, 3, 4 and 5, respectively. Of note, the calculation time of the optimization depends on <italic>k</italic> exponentially. When we use adaptive mode, it took 20 s.</p>
      <p>To examine why this algorithm can improve the accuracy of contig orientations, we here define the relative orientation probability matrix <italic>M</italic>, such that
<disp-formula id="E19"><mml:math id="M19"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>+</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE73"><mml:math id="IM73"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> represents the correct orientation of the <italic>i</italic>th contig. <inline-formula id="IE74"><mml:math id="IM74"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> indicates the likelihood that the orientation of the <italic>i</italic>th contig is correct, which in turn informs our confidence in the orientation of the <italic>i</italic>th contig, given Hi-C contacts between the <italic>i</italic>th and <italic>j</italic>th contigs. Notably, <italic>M</italic> is asymmetric. <xref ref-type="fig" rid="btaa288-F8">Figure 8</xref> shows typical examples of the matrix. In this plot, to represent the dependency of orientation accuracy on contig size, the horizontal and vertical lengths of each cell <inline-formula id="IE75"><mml:math id="IM75"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are proportional to the lengths of the <italic>i</italic>th and <italic>j</italic>th contigs, respectively.</p>
      <fig id="btaa288-F8" orientation="portrait" position="float">
        <label>Fig. 8.</label>
        <caption>
          <p>Relative frequency matrices <inline-formula id="IE76"><mml:math id="IM76"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for four typical cases. The identifiers of individual contigs, <italic>i</italic> and <italic>j</italic>, are shown beside the vertical and horizontal axes, respectively. The red-blue color of each cell shows the relative probability of its orientation. The schematic figure at the top illustrates that a red-colored cell (<inline-formula id="IE77"><mml:math id="IM77"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>) means that contacts between the <italic>i</italic>th and <italic>j</italic>th contigs determine the correct orientation of the <italic>i</italic>th contig, while a blue-colored cell (<inline-formula id="IE78"><mml:math id="IM78"><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>) shows that contacts between the two contigs disagree with the correct orientation of the <italic>i</italic>th contig but support the wrong orientation erroneously. The top left matrix (<bold>a</bold>) shows the ideal situation, in which each contig is long enough to have sufficient contacts with its neighbors to allow its orientation to be determined before using HiC-Hiker. Since almost all of the contigs in this region are longer than the threshold of <inline-formula id="IE79"><mml:math id="IM79"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:math></inline-formula> 75 kb in the probabilistic model, their orientations could be determined based only on their adjacent contigs; contacts with distant contigs were not required. In the top right (<bold>b</bold>), the row labeled with 806 shows a case where the orientation of contig 806 cannot be correctly determined according to its contacts with contig 805, which is depicted by the blue-colored cell of 805 and 806. HiC-Hiker corrected the misoriented contig 806 by considering its contacts with long contigs 804 and 807. In the bottom left (<bold>c</bold>), the row labeled with 1248 illustrates a situation where the misoriented contig 1248 is difficult to fix if its neighboring contigs 1249 is taken into account, but can be fixed using 1247 and 1250, all of which are small contigs (&lt;50 kb). In the bottom right (<bold>d</bold>), the row labeled with 1338 shows a case when HiC-Hiker fails to correct the misoriented contig 1338 labeled with ‘x’, which has short contigs on its right side. The relative probability of contig 1338 being close to 1/2 (in the row 1338) indicates insufficient information regarding the orientation of 1338; it is difficult to determine its orientation based on neighboring contigs</p>
        </caption>
        <graphic xlink:href="btaa288f8"/>
      </fig>
      <p>Our method has two main advantages with respect to orienting contigs. First, it estimates the proximity of two contigs more precisely according to the probability of contact, whereas previous studies simply use absolute values such as a separation distance or a contact count. Second, since the HMM algorithm is able to find the global optimum, it is proven to be less prone to errors even in the presence of local and abnormal contacts than the previous iterative contig-joining algorithm. These advantages of our proposed method can be clearly seen in the relative orientation probability matrix plot shown in <xref ref-type="fig" rid="btaa288-F8">Figure 8</xref>. The top left matrix (a) presents a case where the contact information of adjacent contigs is sufficient to determine the orientations of contigs. On the other hand, the top right and bottom left matrices (b, c) show cases where the probabilistic metric is needed. We require proximity information from more distal contigs to obtain correct orientations.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>In this article, assuming that most large global errors are corrected by using 3D-DNA, we demonstrated that HiC-Hiker can further reduce the local orientation error rate from 4.3% to 1.7% in real human datasets, and from 11.7% to 6.3% in worm datasets.</p>
    <p>In general, greater coverage of Hi-C contacts may make it possible to estimate orientations more accurately using a larger number of Hi-C contacts between contigs, although generating more contacts is more expensive. Instead, we examined a cost-efficient approach using a Hi-C dataset of shallow 7× coverage, and demonstrated that our proposed method was effective in refining scaffolds even if only a shallow coverage Hi-C dataset is available. In fact, the DNA-ZOO project recommends shallow 7× coverage Hi-C datasets to create chromosome-length genome assemblies with 3D-DNA at low cost (<xref rid="btaa288-B8" ref-type="bibr">Dudchenko <italic>et al.</italic>, 2018</xref>). Indeed, when applied to short-read contig datasets with recommended parameters (i.e. 15 kb minimum length threshold and &gt;7× Hi-C coverage; columns 1, 5, 9 and 10 in <xref rid="btaa288-T1" ref-type="table">Table 1</xref>), HiC-Hiker halved the local orientation error rate with a sufficient average recall (71%) and precision (82%). Therefore, our software program HiC-Hiker can be used as a complement to the powerful 3D-DNA program.</p>
    <p>We assumed no gaps between adjacent contigs due to the difficulty in reliably estimating the gap distances based on Hi-C contacts. However, this assumption is unrealistic and should be revised in the future, because gaps are often filled with long repetitive elements and assemblers are unlikely to extend contigs at repetitive regions to avoid the ambiguity associated with contig extension. Despite the assumption, however, the experimental results demonstrated that our algorithm can refine scaffolds, thus showing the practical feasibility of the algorithm. Nevertheless, future work should attempt to eliminate this assumption by making use of probabilistic estimation data or other information, such as assembly graphs.</p>
    <p>Also, in the probabilistic model <italic>p</italic>(<italic>d</italic>), we focused only on the most dominant term, i.e. the separation distances of Hi-C contact pairs, and did not consider the effects of other factors such as high-GC content regions, low sequence mappability in repetitive regions or inherent three-dimensional structures. Although benchmarking showed that the model was effective when not taking the other factors into consideration, ignoring these factors may lead to unwanted biases due to non-uniform coverage of Hi-C contacts; moreover, considering them may further reduce orientation error rates. Indeed, models aimed at identifying significant 3D structures in a chromosome consider the effect of restriction enzyme sites, GC content and mappability (<xref rid="btaa288-B4" ref-type="bibr">Carty <italic>et al.</italic>, 2017</xref>). Future work should modify our model to consider these factors.</p>
    <p>Finally, it is useful to take a probabilistic approach to refine contig ordering and automatically correct large inversion errors. A probability of Hi-C contact seems to be a more precise and theoretic metric than a separation distance or a contact count, which could lead to major improvements in scaffolding based on Hi-C data. Additionally, if we use probabilistic models to calculate the optimal layout of contigs, the probability, or reliability of the layout and scaffolds can be calculated. This reliability information of the generated assembly can be useful when it is used in subsequent analyses.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors are grateful to Drs Erez Lieberman Aiden and Olga Dudchenko for motivating us to examine the problem studied in this article and for stimulating discussions.</p>
    <sec>
      <title>Funding</title>
      <p>This study was supported in part by the Advanced Genome Research and Bioinformatics Study to Facilitate Medical Innovation and by the Advanced Research and Development Programs for Medical Innovation from Japan Agency for Medical Research and Development (AMED) to S.M.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa288-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bankevich</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>SPAdes: a new genome assembly algorithm and its applications to single-cell sequencing</article-title>. <source>J. Comput. Biol</source>., <volume>19</volume>, <fpage>455</fpage>–<lpage>477</lpage>.<pub-id pub-id-type="pmid">22506599</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Burton</surname><given-names>J.N.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Chromosome-scale scaffolding of de novo genome assemblies based on chromatin interactions</article-title>. <source>Nat. Biotechnol</source>., <volume>31</volume>, <fpage>1119</fpage>–<lpage>1125</lpage>.<pub-id pub-id-type="pmid">24185095</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Butler</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>ALLPATHS: De novo assembly of whole-genome shotgun microreads</article-title>. <source><italic toggle="yes">Genome Research</italic></source>, <volume>18</volume>, <fpage>810</fpage>–<lpage>820</lpage>.<pub-id pub-id-type="pmid">18340039</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Carty</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>An integrated model for detecting significant chromatin interactions from high-resolution Hi-C data</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>1</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">28232747</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Clavijo</surname><given-names>B.J.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>a) 
<article-title>An improved assembly and annotation of the allohexaploid wheat genome identifies complete families of agronomic genes and provides genomic evidence for chromosomal translocations</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>885</fpage>–<lpage>896</lpage>.<pub-id pub-id-type="pmid">28420692</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Clavijo</surname><given-names>B.J.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>b) W2RAP: a pipeline for high quality, robust assemblies of large complex genomes from short read data.https://www.biorxiv.org/content/10.1101/110999v1.abstract). <italic> </italic></mixed-citation>
    </ref>
    <ref id="btaa288-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dudchenko</surname><given-names>O.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>De novo assembly of the <italic>Aedes aegypti</italic> genome using Hi-C yields chromosome-length scaffolds</article-title>. <source>Science</source>, <volume>356</volume>, <fpage>92</fpage>–<lpage>95</lpage>.<pub-id pub-id-type="pmid">28336562</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B8">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Dudchenko</surname><given-names>O.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) The Juicebox Assembly Tools module facilitates de novo assembly of mammalian genomes with chromosome-length scaffolds for under $1000. https://www.biorxiv.org/content/10.1101/254797v1.abstract).</mixed-citation>
    </ref>
    <ref id="btaa288-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Edwards</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>1990</year>) 
<article-title>Automated DNA sequencing of the human HPRT locus</article-title>. <source>Genomics</source>, <volume>6</volume>, <fpage>593</fpage>–<lpage>608</lpage>.<pub-id pub-id-type="pmid">2341149</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eid</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Real-time DNA sequencing from single polymerase molecules</article-title>. <source>Science</source>, <volume>323</volume>, <fpage>133</fpage>–<lpage>138</lpage>.<pub-id pub-id-type="pmid">19023044</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gabdank</surname><given-names>I.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>A streamlined tethered chromosome conformation capture protocol</article-title>. <source>BMC Genomics</source>, <volume>17</volume>, <fpage>274</fpage>.<pub-id pub-id-type="pmid">27036078</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ghurye</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Integrating Hi-C links with assembly graphs for chromosome-scale assembly</article-title>. <source>PLoS Comput. Biol</source>., <volume>15</volume>, <fpage>e1007273</fpage>.<pub-id pub-id-type="pmid">31433799</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gnerre</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>High-quality draft assemblies of mammalian genomes from massively parallel sequence data</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>108</volume>, <fpage>1513</fpage>–<lpage>1518</lpage>.<pub-id pub-id-type="pmid">21187386</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Koren</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Canu: scalable and accurate long-read assembly via adaptive k-mer weighting and repeat separation</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>722</fpage>–<lpage>736</lpage>.<pub-id pub-id-type="pmid">28298431</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lander</surname><given-names>E.S.L.</given-names></name></person-group><etal>et al</etal> (<year>2001</year>) 
<article-title>Initial sequencing and analysis of the human genome</article-title>. <source>Nature</source>, <volume>409</volume>, <fpage>860</fpage>–<lpage>921</lpage>.<pub-id pub-id-type="pmid">11237011</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Fast and accurate long-read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>589</fpage>–<lpage>595</lpage>.<pub-id pub-id-type="pmid">20080505</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lieberman-Aiden</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Comprehensive mapping of long-range interactions reveals folding principles of the human genome</article-title>. <source>Science</source>, <volume>326</volume>, <fpage>289</fpage>–<lpage>293</lpage>.<pub-id pub-id-type="pmid">19815776</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Loose</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Real-time selective sequencing using nanopore technology</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>751</fpage>–<lpage>754</lpage>.<pub-id pub-id-type="pmid">27454285</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Luo</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>SOAPdenovo2: an empirically improved memory-efficient short-read de novo assembler</article-title>. <source>GigaScience</source>, <volume>1</volume>, <fpage>1</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">23587310</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Marçais</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>MUMmer4: a fast and versatile genome alignment system</article-title>. <source>PLoS Comput. Biol</source>., <volume>14</volume>, <fpage>e1005944</fpage>.<pub-id pub-id-type="pmid">29373581</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Putnam</surname><given-names>N.H.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Chromosome-scale shotgun assembly using an in vitro method for long-range linkage</article-title>. <source>Genome Res</source>., <volume>26</volume>, <fpage>342</fpage>–<lpage>350</lpage>.<pub-id pub-id-type="pmid">26848124</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rao</surname><given-names>S.S.P.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>A 3D map of the human genome at kilobase resolution reveals principles of chromatin looping</article-title>. <source>Cell</source>, <volume>159</volume>, <fpage>1665</fpage>–<lpage>1680</lpage>.<pub-id pub-id-type="pmid">25497547</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shao</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>npinv: accurate detection and genotyping of inversions using long read sub-alignment</article-title>. <source>BMC Bioinformatics</source>, <volume>19</volume>, <fpage>261</fpage>.<pub-id pub-id-type="pmid">30001702</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B24">
      <mixed-citation publication-type="journal">The C. elegans Sequencing Consortium. (<year>1998</year>) 
<article-title>Genome sequence of the nematode <italic>C. elegans</italic>: a platform for investigating biology</article-title>. <source>Science</source>, <volume>282</volume>, <fpage>2012</fpage>–<lpage>2018</lpage>.<pub-id pub-id-type="pmid">9851916</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Venter</surname><given-names>J.C.</given-names></name></person-group><etal>et al</etal> (<year>2001</year>) 
<article-title>The sequence of the human genome</article-title>. <source>Science</source>, <volume>291</volume>, <fpage>1304</fpage>–<lpage>1351</lpage>.<pub-id pub-id-type="pmid">11181995</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weber</surname><given-names>J.L.</given-names></name>, <name name-style="western"><surname>Myers</surname><given-names>E.W.</given-names></name></person-group> (<year>1997</year>) 
<article-title>Human whole-genome shotgun sequencing</article-title>. <source>Genome Res</source>., <volume>7</volume>, <fpage>401</fpage>–<lpage>409</lpage>.<pub-id pub-id-type="pmid">9149936</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Weisenfeld</surname><given-names>N.I.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Direct determination of diploid genome sequences</article-title>. <source>Genome Res</source>., <volume>27</volume>, <fpage>757</fpage>–<lpage>767</lpage>.<pub-id pub-id-type="pmid">28381613</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yoshimura</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Recompleting the <italic>Caenorhabditis elegans</italic> genome</article-title>. <source>Genome Res</source>., <volume>29</volume>, <fpage>1009</fpage>–<lpage>1022</lpage>.<pub-id pub-id-type="pmid">31123080</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zerbino</surname><given-names>D.R.</given-names></name>, <name name-style="western"><surname>Birney</surname><given-names>E.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title>. <source>Genome Res</source>., <volume>18</volume>, <fpage>821</fpage>–<lpage>829</lpage>.<pub-id pub-id-type="pmid">18349386</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Allele-defined genome of the autopolyploid sugarcane <italic>Saccharum spontaneum</italic> L</article-title>. <source>Nat. Genet</source>., <volume>50</volume>, <fpage>1565</fpage>–<lpage>1573</lpage>.<pub-id pub-id-type="pmid">30297971</pub-id></mixed-citation>
    </ref>
    <ref id="btaa288-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Assembly of allele-aware, chromosomal-scale autopolyploid genomes based on Hi-C data</article-title>. <source>Nat. Plants</source>, <volume>5</volume>, <fpage>833</fpage>–<lpage>845</lpage>.<pub-id pub-id-type="pmid">31383970</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
