<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7972227</article-id>
    <article-id pub-id-type="publisher-id">4061</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-021-04061-3</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ProgPerm: Progressive permutation for a dynamic representation of the robustness of microbiome discoveries</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5986-2260</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Liangliang</given-names>
        </name>
        <address>
          <email>liangliangzhang.stat@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shi</surname>
          <given-names>Yushu</given-names>
        </name>
        <address>
          <email>shiyushu2006@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Do</surname>
          <given-names>Kim-Anh</given-names>
        </name>
        <address>
          <email>kimdo@mdanderson.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Peterson</surname>
          <given-names>Christine B.</given-names>
        </name>
        <address>
          <email>CBPeterson@mdanderson.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Jenq</surname>
          <given-names>Robert R.</given-names>
        </name>
        <address>
          <email>RRJenq@mdanderson.org</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.240145.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2291 4776</institution-id><institution>Department of Biostatistics, </institution><institution>University of Texas MD Anderson Cancer Center, </institution></institution-wrap>Houston, TX USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.134936.a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2162 3504</institution-id><institution>Department of Statistics, </institution><institution>University of Missouri, </institution></institution-wrap>Columbia, MO USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.240145.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2291 4776</institution-id><institution>Department of Genomic Medicine, </institution><institution>University of Texas MD Anderson Cancer Center, </institution></institution-wrap>Houston, TX USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>126</elocation-id>
    <history>
      <date date-type="received">
        <day>10</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Identification of features is a critical task in microbiome studies that is complicated by the fact that microbial data are high dimensional and heterogeneous. Masked by the complexity of the data, the problem of separating signals (differential features between groups) from noise (features that are not differential between groups) becomes challenging and troublesome. For instance, when performing differential abundance tests, multiple testing adjustments tend to be overconservative, as the probability of a type I error (false positive) increases dramatically with the large numbers of hypotheses. Moreover, the grouping effect of interest can be obscured by heterogeneity. These factors can incorrectly lead to the conclusion that there are no differences in the microbiome compositions.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We translate and represent the problem of identifying differential features, which are differential in two-group comparisons (e.g., treatment versus control), as a dynamic layout of separating the signal from its random background. More specifically, we progressively permute the grouping factor labels of the microbiome samples and perform multiple differential abundance tests in each scenario. We then compare the signal strength of the most differential features from the original data with their performance in permutations, and will observe a visually apparent decreasing trend if these features are true positives identified from the data. Simulations and applications on real data show that the proposed method creates a U-curve when plotting the number of significant features versus the proportion of mixing. The shape of the U-Curve can convey the strength of the overall association between the microbiome and the grouping factor. We also define a fragility index to measure the robustness of the discoveries. Finally, we recommend the identified features by comparing <italic>p</italic>-values in the observed data with <italic>p</italic>-values in the fully mixed data.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">We have developed this into a user-friendly and efficient R-shiny tool with visualizations. By default, we use the Wilcoxon rank sum test to compute the <italic>p</italic>-values, since it is a robust nonparametric test. Our proposed method can also utilize <italic>p</italic>-values obtained from other testing methods, such as DESeq. This demonstrates the potential of the progressive permutation method to be extended to new settings.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version supplementary material available at 10.1186/s12859-021-04061-3.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Differential test</kwd>
      <kwd>Fragility index</kwd>
      <kwd>Feature selection</kwd>
      <kwd>Microbiome</kwd>
      <kwd>Permutation</kwd>
      <kwd>Robustness</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>MD Anderson Moon Shot Programs</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Prostate Cancer SPORE</institution>
        </funding-source>
        <award-id>P50CA140388</award-id>
        <principal-award-recipient>
          <name>
            <surname>Do</surname>
            <given-names>Kim-Anh</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>NIH/NCI CCSG</institution>
        </funding-source>
        <award-id>P30CA016672</award-id>
        <principal-award-recipient>
          <name>
            <surname>Do</surname>
            <given-names>Kim-Anh</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>CCTS</institution>
        </funding-source>
        <award-id>5UL1TR000371</award-id>
        <principal-award-recipient>
          <name>
            <surname>Do</surname>
            <given-names>Kim-Anh</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>CPRIT</institution>
        </funding-source>
        <award-id>RP160693</award-id>
        <principal-award-recipient>
          <name>
            <surname>Do</surname>
            <given-names>Kim-Anh</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>NIH/NCI CCSG</institution>
        </funding-source>
        <award-id>P30CA016672</award-id>
        <principal-award-recipient>
          <name>
            <surname>Peterson</surname>
            <given-names>Christine B.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>MD Anderson Moon Shot Programs</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>NIH R01</institution>
        </funding-source>
        <award-id>HL124112</award-id>
        <principal-award-recipient>
          <name>
            <surname>Jenq</surname>
            <given-names>Robert R.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>CPRIT</institution>
        </funding-source>
        <award-id>RR160089</award-id>
        <principal-award-recipient>
          <name>
            <surname>Jenq</surname>
            <given-names>Robert R.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par6">With the advent of next-generation sequencing technologies to quantify the composition of human microbiome, there have been drastic increases in the number of microbiome studies and vast improvements in microbiome analysis [<xref ref-type="bibr" rid="CR1">1</xref>]. In recent decades, a tremendous amount of evidence has strongly suggested that the human microbiota is becoming a crucial key to understanding human health and physiology [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. In practice, identification of microbial biomarkers often requires singling out specific taxa that are differentially abundant between two groups of interest (e.g. treatment vs. control). Differential abundance analysis [<xref ref-type="bibr" rid="CR9">9</xref>] in this setting, however, is challenging. On the one hand, microbiome data are high dimensional with complex structures. A single sample can produce as many as tens of thousands of distinct sequencing reads. These reads are clustered into operational taxonomic units (OTUs) and mapped to the microbial species according to a reference library. At the same time, the OTUs (which can be considered as the lowest level taxa) are routinely aggregated to higher taxonomic levels (phyla, order, class, family, genus, or species). On the other hand, microbiome data are heterogeneous across subjects that belong to different populations, because microbiome samples interact with different body environment that might be depicted by multiple clinical outcomes. It is highly likely that not all of these host phenotypes are collected and included in the study, but with all the available clinical factors in the current data, we would like to explore and investigate a subset that are most associated with differences in microbiome compositions. Then we would like to identify the corresponding microbiome features that are significantly and robustly associated with these clinical outcomes.</p>
    <p id="Par7">Researchers have adapted classical differential analysis tools developed for RNA sequencing data, such as edgeR [<xref ref-type="bibr" rid="CR10">10</xref>] and DESeq [<xref ref-type="bibr" rid="CR11">11</xref>], to microbiome data, as both data types are essentially read count data. Others have proposed methods that account for the compositional nature of microbiome data, including ANCOM [<xref ref-type="bibr" rid="CR12">12</xref>] and ALDEx2 [<xref ref-type="bibr" rid="CR13">13</xref>]. Segata et al. [<xref ref-type="bibr" rid="CR14">14</xref>] developed LEfSe (Linear discriminant analysis Effect Size) to identify differential taxonomic features between groups by using standard tests for statistical significance. When doing multiple tests, the probability of a Type I error (false positive) increases dramatically as high throughput sequencing data is tested [<xref ref-type="bibr" rid="CR15">15</xref>]. Adjustment methods such as the Benjamini–Hochberg procedure will become over-conservative and incorrectly lead to conclusions that there are no differences in the microbiome, because the threshholds of rejecting the null hypothesis for each microbe becomes extremely small as the number of tests increases [<xref ref-type="bibr" rid="CR16">16</xref>]. Although these differential testing methods are able to identify the significance of individual microbiomarkers when associating with a single clinical outcome, they do not answer a more general question as to which grouping factors better identify more differences in microbiome communities and deserve further analysis when multiple clinical outcomes are presented in the observed data. Researchers usually use dimension reduction plots (e.g. PCoA or NMDS) at the beginning to explore the overall associations between clinical outcomes and microbiome compositions before any further investigations. But the expected clustering effect may or may not be observed depending on the degree of heterogeneity across samples and populations, which could lead to the false conclusion that the microbiome is not associated with a clinical factor. Therefore, a systematic tool is needed to explore both the overall and the individual associations, and to provide measures on the robustness of the discoveries and the reliability of the results.</p>
    <p id="Par8">We propose a novel method named progressive permutation. The method progressively permutes the grouping factor labels of microbiome samples and performs differential testing (such as a Wilcoxon rank-sum test or a Kruskal–Wallis test) on the permuted data in each scenario. We then compare the signal strength (<inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq1.gif"/></alternatives></inline-formula>-values) of top hits from the observed data with their testing performance in permuted data sets. We can observe an apparent decreasing trend of the signal strength from the no permutation scenario to the full permutation scenario, if these top hits are true positives identified from the data. As the fragility index is a measure of the robustness of the results of a clinical trial [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>], we propose a similar concept in our progressive permutation to measure the minimum number of permutation steps that would change the variable’s significance to nonsigificance. We also extend these concepts to a continuous outcome using correlation tests (such as Kendall’s tau or Spearman Rank Correlation tests). We have developed this method into a user-friendly and efficient RShiny tool with visualizations, so that the method becomes easy to apply, the results are easy to understand and the process of analyzing is well organized. Hawinkel et al. [<xref ref-type="bibr" rid="CR19">19</xref>] proposed a permutation filtering method to measure the taxa importance by the filtering loss of exclusion of the taxa. The method randomly permutes the labels of taxa and evaluates the proportion of total variance loss. Our method permutes the sample labels to regroup them and evaluate the robustness of group differences. We validate our method with simulations and applications in real data. We conclude that the proposed method can not only compare the overall association between the microbiome and multiple grouping factors (that might be obscured by heterogeneity), but also single out the robust individual hits. It achieves the former by measuring the changing trend of the number of significant hits across permutation scenarios and ranking the fragility index of the discovered microbes. It achieves the latter by comparing the <italic>p</italic>-values of the observed data (signals) with <italic>p</italic>-values of the fully mixed data (noise). To finalize the results, the RShiny tool lists the discoveries, their effect sizes and individual abundances.</p>
    <p id="Par9">The paper is organized as follows. In “<xref rid="Sec2" ref-type="sec">Methods</xref>” section, we include a detailed description of the proposed method. In “<xref rid="Sec3" ref-type="sec">Simulations</xref>” section, we run simulations, and use the U-Curve and fragility index to measure overall associations with grouping factors and the robustness of microbiome discoveries. In “<xref rid="Sec4" ref-type="sec">Application</xref>” section, we apply the method to real data to test overall associations and identify robust hits. In “<xref rid="Sec5" ref-type="sec">Analytical property</xref>” section, we show the analytical properties of the proposed method in a simple setup. We conclude with a discussion in “<xref rid="Sec6" ref-type="sec">Discussion</xref>” section.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <p id="Par10">Suppose that we collect <italic>N</italic> samples and obtain <italic>p</italic> microbiome taxa. We denote the microbial features as <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{X}}}=({{\varvec{x}}}_1,\ldots , {{\varvec{x}}}_p)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq2.gif"/></alternatives></inline-formula>, where each <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{x}}}_i$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq3.gif"/></alternatives></inline-formula> is an <italic>N</italic>-dimensional vector. We aim to identify which variables are differential by the grouping factor of interest with two groups <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{g}}}=({{\varvec{g}}}^1,{{\varvec{g}}}^2)$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq4.gif"/></alternatives></inline-formula> (e.g. <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{g}}}^1$$\end{document}</tex-math><mml:math id="M10"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq5.gif"/></alternatives></inline-formula> denotes the treatment group while <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{g}}}^2$$\end{document}</tex-math><mml:math id="M12"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq6.gif"/></alternatives></inline-formula> denotes the control group). We denote the grouping labels in group 1 as <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g^1_i=1, i= \{1,\ldots , n_1\}$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq7.gif"/></alternatives></inline-formula> and group 2 as <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g^2_i=2, i= \{1,\ldots , n_2\}$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq8.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_1+n_2=N$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq9.gif"/></alternatives></inline-formula>. The hypothesis test performed on each variable is denoted as <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_j, j=\{1,\ldots , p\}$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq10.gif"/></alternatives></inline-formula>. The corresponding <italic>p</italic>-value is denoted as <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_j, j=\{1,\ldots , p\}$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq11.gif"/></alternatives></inline-formula>.</p>
    <p id="Par11">We use <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=\{0, 1,\ldots , K\}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq12.gif"/></alternatives></inline-formula> to describe progressive permutation scenarios. <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=0$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq13.gif"/></alternatives></inline-formula> describes the observed data without any permutation. <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K={\mathrm {min}}(n_1, n_2)$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">min</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq14.gif"/></alternatives></inline-formula> is the maximal permutation scenario. The permutation scenario <italic>k</italic> is constructed as follows. Each time, we start from the original grouping labels <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{g}}}=({{\varvec{g}}}^1,{{\varvec{g}}}^2)$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq15.gif"/></alternatives></inline-formula>. We randomly draw <italic>k</italic> samples from group 1 (sample labels <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{i_1^1,\ldots ,i_k^1\}\subseteq \{1,\ldots , n_1\}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mn>1</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>⊆</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq16.gif"/></alternatives></inline-formula>) and <italic>k</italic> samples from group 2 (sample labels <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{i_1^2,\ldots , i_k^2\}\subseteq \{1,\ldots , n_2\}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>⊆</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq17.gif"/></alternatives></inline-formula>), and then exchange their grouping labels, meaning that <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g^1_{i}=2, i=\{i_1^1,\ldots ,i_k^1\}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mn>1</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq18.gif"/></alternatives></inline-formula> and <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g^2_{i}=1, i=\{i_1^2,\ldots , i_k^2\}$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq19.gif"/></alternatives></inline-formula>. In the <italic>k</italic>-th permutation scenario, we have <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {\begin{array}{c}n_1\\ k\end{array}}\right) \left( {\begin{array}{c}n_2\\ k\end{array}}\right)$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq20.gif"/></alternatives></inline-formula> choices. The number of choices <inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {\begin{array}{c}n_1\\ k\end{array}}\right) \left( {\begin{array}{c}n_2\\ k\end{array}}\right)$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq21.gif"/></alternatives></inline-formula> approaches its maximum, when <italic>k</italic> equals the closest integer greater than <inline-formula id="IEq22"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{n_1n_2-1}{n_1+n_2+2}$$\end{document}</tex-math><mml:math id="M44"><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq22.gif"/></alternatives></inline-formula>. We call it as the full permutation scenario with <inline-formula id="IEq23"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_f=\lceil \frac{n_1n_2-1}{n_1+n_2+2}\rceil$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>⌈</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq23.gif"/></alternatives></inline-formula>. If <inline-formula id="IEq24"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_1=n_2=n$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq24.gif"/></alternatives></inline-formula>, then <inline-formula id="IEq25"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_f=\lceil \frac{n-1}{2}\rceil$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>⌈</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq25.gif"/></alternatives></inline-formula>. Adding up the choices of all the scenarios, we get the following equation<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \sum _{k=0}^{K} \left( {\begin{array}{c}n_1\\ k\end{array}}\right) \left( {\begin{array}{c}n_2\\ k\end{array}}\right) =\left( {\begin{array}{c}N\\ K\end{array}}\right) . \end{aligned}$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>N</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>K</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4061_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>The above equation can be derived from Vandermonde’s convolution identity for binomial coefficients. The details are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Sect. S1. The left side lists all the progressive permutation scenarios which are disjoint meaning that grouping labels are distinct between scenarios. The right side lists all possible combinations when you group <italic>N</italic> samples into two subgroups with <inline-formula id="IEq26"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_1$$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq26.gif"/></alternatives></inline-formula> and <inline-formula id="IEq27"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_2$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq27.gif"/></alternatives></inline-formula> samples respectively. With the increase of <italic>k</italic>, the two groups are mixing more with each other. In other words, among all the grouping assignments at random, the permuted assignments more similar to the original data (the observed grouping factor) would differentiate the two groups more than the less similar ones, if the microbiome variables were strongly associated with the observed grouping factor.<fig id="Fig1"><label>Fig. 1</label><caption><p>Trace plot of <inline-formula id="IEq28"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq28.gif"/></alternatives></inline-formula>-values changing with the proportion of mixing. x-axis denotes the proportion of mixing. y-axis denotes the <inline-formula id="IEq29"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq29.gif"/></alternatives></inline-formula>-values of the 100 features. Each curve denotes the trace of <inline-formula id="IEq30"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq30.gif"/></alternatives></inline-formula>-value of an individual microbiome feature. The scale of rainbow colors shows the contrast of curves that <inline-formula id="IEq31"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq31.gif"/></alternatives></inline-formula>-values of more significant variables will be higher than those of less significant ones. The vertical bars describe the 95% quantile confidence intervals of the <inline-formula id="IEq32"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq32.gif"/></alternatives></inline-formula>-values across permutation scenarios</p></caption><graphic xlink:href="12859_2021_4061_Fig1_HTML" id="MO2"/></fig></p>
    <p id="Par12">Next we introduce how to perform differential tests and utilize the testing results from all the progressive permutation scenarios. In both the permuted and unpermuted data, we perform differential testing of each feature, and obtain the corresponding <inline-formula id="IEq33"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10}p$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq33.gif"/></alternatives></inline-formula>-values. By default, we use the Wilcoxon rank sum test to compute the <italic>p</italic>-values, since it is a robust nonparametric test. Our proposed method can also utilize <italic>p</italic>-values obtained from other testing methods, such as DESeq [<xref ref-type="bibr" rid="CR20">20</xref>].</p>
    <p id="Par13">Each permutation scenario consists of multiple combination choices, implemented as follows. For each permutation scenario <italic>k</italic> (<inline-formula id="IEq34"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\ge 1$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq34.gif"/></alternatives></inline-formula>), we start from a random seed and perform a subset of <inline-formula id="IEq35"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu =N\left( \log \left( {\begin{array}{c}n_1\\ k\end{array}}\right) +\log \left( {\begin{array}{c}n_2\\ k\end{array}}\right) \right)$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq35.gif"/></alternatives></inline-formula> (rounded to the nearst integer) draws out of a total of <inline-formula id="IEq36"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {\begin{array}{c}n_1\\ k\end{array}}\right) \left( {\begin{array}{c}n_2\\ k\end{array}}\right)$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>k</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq36.gif"/></alternatives></inline-formula> draws. For each draw in every scenario <italic>k</italic>, we perform <italic>p</italic> independent tests to differentiate each microbiome features between the two groups and calculate all the <italic>p</italic>-values. Therefore, for each variable <italic>j</italic> (<inline-formula id="IEq37"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j=1,\ldots ,p$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq37.gif"/></alternatives></inline-formula>), we obtain <inline-formula id="IEq38"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu$$\end{document}</tex-math><mml:math id="M78"><mml:mi>ν</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq38.gif"/></alternatives></inline-formula> samples of <italic>p</italic>-values <inline-formula id="IEq39"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{j}(k)$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq39.gif"/></alternatives></inline-formula>. We summarize the distribution of these samples by their medians <inline-formula id="IEq40"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p^m_j(k)$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq40.gif"/></alternatives></inline-formula> and 2.5–97.5% quantile intervals. To visualize these <italic>p</italic>-values in an organized manner, we rank the <italic>p</italic>-values (defined as <inline-formula id="IEq41"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{j}(0)$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq41.gif"/></alternatives></inline-formula>) of all the variables in the observed data, and then plot their <inline-formula id="IEq42"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10}$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq42.gif"/></alternatives></inline-formula> median <italic>p</italic>-values with the same order across permutation scenarios. Please note that the observed data can be considered as one draw (<inline-formula id="IEq43"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu =1$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq43.gif"/></alternatives></inline-formula>), so the median <italic>p</italic>-value <inline-formula id="IEq44"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p^m_{j}(0)$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq44.gif"/></alternatives></inline-formula> is equivalent to the <italic>p</italic>-value <inline-formula id="IEq45"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_{j}(0)$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq45.gif"/></alternatives></inline-formula>. As illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, we presented the traces of <inline-formula id="IEq46"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq46.gif"/></alternatives></inline-formula>-values for an example data set with 100 microbiome features. In general, the paralleled traces of <inline-formula id="IEq47"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10}$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq47.gif"/></alternatives></inline-formula> median <italic>p</italic>-values of more significant variables will be higher than those of less significant ones. With the increase of mixing, the significant <italic>p</italic>-values gradually become nonsignificant, indicating that the signal is weaker and the noise is stronger. As there would be almost no signal if the data were fully mixed, more <italic>p</italic>-values are close to 1 at the full permutation scenario <inline-formula id="IEq48"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=K_f$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq48.gif"/></alternatives></inline-formula>. We describe the computational scaling of the progression permutation approach in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Sect. S2.</p>
    <p id="Par14">For microbiome data, the number of taxa <italic>p</italic> is usually a larger number. It is not easy to display and compare a large number of traces. So we summarize individual <italic>p</italic>-values into a single quantity, the number of significant taxa. We can obtain the number of significant taxa as <inline-formula id="IEq49"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {nsig}}(k)=\sum _{j=1}^p I_{p^m_j(k)\le \alpha }$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi mathvariant="normal">nsig</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq49.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq50"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M102"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq50.gif"/></alternatives></inline-formula> is the prespecified significance level (default value is 0.05). We expect to see the lowest <inline-formula id="IEq51"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {nsig}}(k)$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mi mathvariant="normal">nsig</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq51.gif"/></alternatives></inline-formula> in the full permutation scenario <inline-formula id="IEq52"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_f$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq52.gif"/></alternatives></inline-formula>, because more <italic>p</italic>-values become close to 1 here. The number of significant features <inline-formula id="IEq53"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {nsig}}(k)$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mi mathvariant="normal">nsig</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq53.gif"/></alternatives></inline-formula> decreases with the proportion of mixing <italic>k</italic>/<italic>K</italic>, when <inline-formula id="IEq54"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\le K_f$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq54.gif"/></alternatives></inline-formula>. <inline-formula id="IEq55"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {nsig}}(k)$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mi mathvariant="normal">nsig</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq55.gif"/></alternatives></inline-formula> increases with the proportion of mixing <italic>k</italic>/<italic>K</italic>, when <inline-formula id="IEq56"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\ge K_f$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq56.gif"/></alternatives></inline-formula>. If the two groups have balanced sample sizes (i.e. <inline-formula id="IEq57"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_1=n_2$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq57.gif"/></alternatives></inline-formula>), we will visualize a symmetric U-shape curve if we plot the number of significant features with the proportion of mixing <italic>k</italic>/<italic>K</italic>. The shape of U-Curve measures the signal strength how differential the microbiome compositions are between two groups. We potentially can use the U-Curve as a global measure to depict the overall association between microbiome compositions and different clinical outcomes.</p>
    <p id="Par15">To allow the U-Curve comparable across various data sets with different number of microbiome features, we scale the number of significant features <inline-formula id="IEq58"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {nsig}}(k)$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi mathvariant="normal">nsig</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq58.gif"/></alternatives></inline-formula> by total number of features considered <italic>p</italic>, which is named as the proportion of significant features <inline-formula id="IEq59"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {nsig}}(k)/p$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mi mathvariant="normal">nsig</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq59.gif"/></alternatives></inline-formula> (ranges from 0 to 1). As illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, we define the area of interest (AOI) as the rectangular region covering the curve (green plus purple), which actually measures the proportion of significant features <inline-formula id="IEq60"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {nsig}}(k)/p$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi mathvariant="normal">nsig</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq60.gif"/></alternatives></inline-formula>. In order to describe the shape of the U-Curve, we define area under the mixing curve (AUMC) and the decreasing slope of the initial point depicting the observed data. The AUMC measures the purple area in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, which can be calculated numerically. The slope of the initial point is calculated as the slope of the line connecting the first two points. Bigger AUMC means that the number of significant features varies more considerably from the observed data (<inline-formula id="IEq61"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=0$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq61.gif"/></alternatives></inline-formula>) to the fully mixed data (<inline-formula id="IEq62"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=K_f$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq62.gif"/></alternatives></inline-formula>), which indicates the higher association between clinical outcomes and microbiome compositions in the observed data. For two clinical outcomes giving equal AOIs, if one outcome provides smaller slope (meaning the signal is stable at the beginning) and bigger AUMC, we will conclude that the overall association between this outcome and the microbiome features were higher.<fig id="Fig2"><label>Fig. 2</label><caption><p>An illustration plot of the U-Curve of proportion of significant features versus proportion of mixing. x-axis describes the proportion of mixing the two groups of data. y-axis describes the proportion of significant features. The red triangle describes the observed data. The black dots describe the permuted data. The vertical bars describe the 95% quantile confidence intervals</p></caption><graphic xlink:href="12859_2021_4061_Fig2_HTML" id="MO3"/></fig></p>
    <p id="Par16">The fragility index was originally defined as a measure of the robustness of the results of a clinical trial [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. We introduce a similar concept to measure how fast the signals break down as the mixing increases. We introduce and define the fragility index of <italic>j</italic>th variable of each draw at permutation scenario <italic>k</italic> as <inline-formula id="IEq63"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {FI}}_j=\min _k \left( p^m_j(k)&gt;\alpha \right)$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:msub><mml:mi mathvariant="normal">FI</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo movablelimits="true">min</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mi>α</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq63.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq64"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p^m_j(k)$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>j</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq64.gif"/></alternatives></inline-formula> is the median <italic>p</italic>-value obtained above in each scenario <italic>k</italic>. In other words, the fragility index of a variable is the minimum number of permutation steps that would change the variable’s significance into nonsignificance. So the fragility index is smaller than full permutation scenario <inline-formula id="IEq65"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_f$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq65.gif"/></alternatives></inline-formula>, where all <italic>p</italic>-values are not significant. Therefore, we can obtain the scaled fragility index as <inline-formula id="IEq66"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {sFI}}_j={\mathrm {FI}}_j/K_f$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msub><mml:mi mathvariant="normal">sFI</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">FI</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq66.gif"/></alternatives></inline-formula>. The larger the fragility index is, the more stable the identified taxa are. Therefore, within the same data set, we can rank the importance of the taxa by their fragility indices. For two clinical outcomes, if one outcome is more associated with microbiome features, this outcome will provide higher average fragility indices.</p>
    <p id="Par17">If we roll back the wheel of our proposed method (i.e. Eq. <xref rid="Equ1" ref-type="">1</xref>), we will find an analogy to scientific research that permuting grouping labels actually lists all the possible arrangements of observations from the same random phenomenon. However, in a single study, researchers observe merely one arrangement, and expect this occasional arrangement among all the others could convey the signal that the two groups are differential. We propose progressive permutation to recover the missing arrangements. We assume that the observed data are differential between the two groups. Then the method generates all the other disjointed arrangements in a systematic manner with fixed sample sizes so that the signal progressively diminishes from the no-permutation scenario (the observed data) to the full-permutation scenario. In other words, if the grouping factor is associated with the microbial difference between the two groups, the observed data defining the signals will be readily able to distinguish from the fully mixed data which characterizes the noise. Therefore, we achieve the identification of robust variables by judging that the significant <italic>p</italic>-values obtained from the observed data lie outside of the 95% confidence intervals of the fully mixed data.</p>
  </sec>
  <sec id="Sec3">
    <title>Simulations</title>
    <p id="Par18">In this section, we first generate two types of simulations to show the performance of our method. First, we change the group mean, variance, correlation and number of significant variables to simulate data with different levels of signals. Second, we control the number of significant variables and simulate three data sets with different levels of heterogeneity. Then we compare the performance of our progressive permutation method on these data.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison on progressive permutation results produced by multiple simulated data sets with different simulation parameters, including correlation <inline-formula id="IEq67"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho$$\end{document}</tex-math><mml:math id="M136"><mml:mi>ρ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq67.gif"/></alternatives></inline-formula>, number of significant variables (nsv), group mean difference (<inline-formula id="IEq68"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_1-m_2$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq68.gif"/></alternatives></inline-formula>), and dispersion <inline-formula id="IEq69"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M140"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq69.gif"/></alternatives></inline-formula></p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><inline-formula id="IEq70"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho$$\end{document}</tex-math><mml:math id="M142"><mml:mi>ρ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq70.gif"/></alternatives></inline-formula></th><th align="left">nsv</th><th align="left"><inline-formula id="IEq71"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_1-m_2$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq71.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq72"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M146"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq72.gif"/></alternatives></inline-formula></th><th align="left">AOI</th><th align="left">AUMC</th><th align="left"><inline-formula id="IEq73"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {slope}}_0$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mi mathvariant="normal">slope</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq73.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq74"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {slope}}_1$$\end{document}</tex-math><mml:math id="M150"><mml:msub><mml:mi mathvariant="normal">slope</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq74.gif"/></alternatives></inline-formula></th><th align="left">Fragility</th><th align="left"><inline-formula id="IEq75"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {select}}_0$$\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mi mathvariant="normal">select</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq75.gif"/></alternatives></inline-formula></th><th align="left"><inline-formula id="IEq76"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {select}}_1$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mi mathvariant="normal">select</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq76.gif"/></alternatives></inline-formula></th></tr></thead><tbody><tr><td align="left" rowspan="12">0.5</td><td align="left" rowspan="6">30</td><td align="left">9</td><td char="." align="char">24</td><td char="." align="char">0.30</td><td char="." align="char">0.23</td><td char="." align="char">0</td><td char="." align="char">− 0.54</td><td char="." align="char">6.64</td><td char="." align="char">30</td><td char="." align="char">30</td></tr><tr><td align="left">9</td><td char="." align="char">1</td><td char="." align="char">0.30</td><td char="." align="char">0.20</td><td char="." align="char">0</td><td char="." align="char">− 0.54</td><td char="." align="char">5.74</td><td char="." align="char">30</td><td char="." align="char">30</td></tr><tr><td align="left">4</td><td char="." align="char">24</td><td char="." align="char">0.30</td><td char="." align="char">0.18</td><td char="." align="char">0</td><td char="." align="char">− 0.52</td><td char="." align="char">5.96</td><td char="." align="char">30</td><td char="." align="char">30</td></tr><tr><td align="left">4</td><td char="." align="char">1</td><td char="." align="char">− 0.05</td><td char="." align="char">− 0.05</td><td char="." align="char">0.45</td><td char="." align="char">0</td><td char="." align="char">1.44</td><td char="." align="char">5</td><td char="." align="char">3</td></tr><tr><td align="left">0</td><td char="." align="char">24</td><td char="." align="char">0.00</td><td char="." align="char">− 0.02</td><td char="." align="char">0</td><td char="." align="char">0.1</td><td char="." align="char">0.44</td><td char="." align="char">0</td><td char="." align="char">0</td></tr><tr><td align="left">0</td><td char="." align="char">1</td><td char="." align="char">0.00</td><td char="." align="char">− 0.02</td><td char="." align="char">0</td><td char="." align="char">0.1</td><td char="." align="char">0.46</td><td char="." align="char">0</td><td char="." align="char">0</td></tr><tr><td align="left" rowspan="6">90</td><td align="left">9</td><td char="." align="char">24</td><td char="." align="char">1.00</td><td char="." align="char">0.67</td><td char="." align="char">0</td><td char="." align="char">− 2</td><td char="." align="char">11.02</td><td char="." align="char">100</td><td char="." align="char">100</td></tr><tr><td align="left">9</td><td char="." align="char">1</td><td char="." align="char">1.00</td><td char="." align="char">0.58</td><td char="." align="char">0</td><td char="." align="char">− 1.98</td><td char="." align="char">10.14</td><td char="." align="char">100</td><td char="." align="char">100</td></tr><tr><td align="left">4</td><td char="." align="char">24</td><td char="." align="char">0.89</td><td char="." align="char">0.44</td><td char="." align="char">− 0.6</td><td char="." align="char">− 1.74</td><td char="." align="char">8.84</td><td char="." align="char">89</td><td char="." align="char">84</td></tr><tr><td align="left">4</td><td char="." align="char">1</td><td char="." align="char">− 0.08</td><td char="." align="char">− 0.08</td><td char="." align="char">1.5</td><td char="." align="char">− 0.08</td><td char="." align="char">2.06</td><td char="." align="char">8</td><td char="." align="char">3</td></tr><tr><td align="left">0</td><td char="." align="char">24</td><td char="." align="char">0.00</td><td char="." align="char">− 0.02</td><td char="." align="char">0</td><td char="." align="char">0.1</td><td char="." align="char">0.34</td><td char="." align="char">0</td><td char="." align="char">0</td></tr><tr><td align="left">0</td><td char="." align="char">1</td><td char="." align="char">0.00</td><td char="." align="char">− 0.02</td><td char="." align="char">0</td><td char="." align="char">0.1</td><td char="." align="char">0.5</td><td char="." align="char">0</td><td char="." align="char">0</td></tr><tr><td align="left" rowspan="12">0.8</td><td align="left" rowspan="6">30</td><td align="left">9</td><td char="." align="char">24</td><td char="." align="char">0.30</td><td char="." align="char">0.23</td><td char="." align="char">0</td><td char="." align="char">− 0.54</td><td char="." align="char">6.58</td><td char="." align="char">30</td><td char="." align="char">30</td></tr><tr><td align="left">9</td><td char="." align="char">1</td><td char="." align="char">0.30</td><td char="." align="char">0.20</td><td char="." align="char">0</td><td char="." align="char">− 0.54</td><td char="." align="char">5.8</td><td char="." align="char">30</td><td char="." align="char">30</td></tr><tr><td align="left">4</td><td char="." align="char">24</td><td char="." align="char">0.30</td><td char="." align="char">0.18</td><td char="." align="char">0</td><td char="." align="char">− 0.52</td><td char="." align="char">5.14</td><td char="." align="char">30</td><td char="." align="char">30</td></tr><tr><td align="left">4</td><td char="." align="char">1</td><td char="." align="char">0.04</td><td char="." align="char">0.04</td><td char="." align="char">− 0.45</td><td char="." align="char">0.02</td><td char="." align="char">1.2</td><td char="." align="char">4</td><td char="." align="char">0</td></tr><tr><td align="left">0</td><td char="." align="char">24</td><td char="." align="char">0.00</td><td char="." align="char">− 0.02</td><td char="." align="char">0</td><td char="." align="char">0.1</td><td char="." align="char">0.66</td><td char="." align="char">0</td><td char="." align="char">0</td></tr><tr><td align="left">0</td><td char="." align="char">1</td><td char="." align="char">0.00</td><td char="." align="char">− 0.02</td><td char="." align="char">0</td><td char="." align="char">0.1</td><td char="." align="char">0.3</td><td char="." align="char">0</td><td char="." align="char">0</td></tr><tr><td align="left" rowspan="6">90</td><td align="left">9</td><td char="." align="char">24</td><td char="." align="char">1.00</td><td char="." align="char">0.67</td><td char="." align="char">0</td><td char="." align="char">− 2</td><td char="." align="char">11.12</td><td char="." align="char">100</td><td char="." align="char">100</td></tr><tr><td align="left">9</td><td char="." align="char">1</td><td char="." align="char">1.00</td><td char="." align="char">0.58</td><td char="." align="char">0</td><td char="." align="char">− 1.98</td><td char="." align="char">10.1</td><td char="." align="char">100</td><td char="." align="char">100</td></tr><tr><td align="left">4</td><td char="." align="char">24</td><td char="." align="char">0.97</td><td char="." align="char">0.45</td><td char="." align="char">− 2.1</td><td char="." align="char">− 1.9</td><td char="." align="char">8.82</td><td char="." align="char">97</td><td char="." align="char">87</td></tr><tr><td align="left">4</td><td char="." align="char">1</td><td char="." align="char">− 0.07</td><td char="." align="char">− 0.08</td><td char="." align="char">2.25</td><td char="." align="char">− 0.04</td><td char="." align="char">2.06</td><td char="." align="char">7</td><td char="." align="char">0</td></tr><tr><td align="left">0</td><td char="." align="char">24</td><td char="." align="char">0.00</td><td char="." align="char">− 0.02</td><td char="." align="char">0</td><td char="." align="char">0.08</td><td char="." align="char">0.54</td><td char="." align="char">0</td><td char="." align="char">0</td></tr><tr><td align="left">0</td><td char="." align="char">1</td><td char="." align="char">0.00</td><td char="." align="char">− 0.02</td><td char="." align="char">0</td><td char="." align="char">0.1</td><td char="." align="char">0.2</td><td char="." align="char">0</td><td char="." align="char">0</td></tr></tbody></table><table-wrap-foot><p>AOI is short for area of interest. AUMC is short for area under the mixing curve. “<inline-formula id="IEq78"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {slope}}_0$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mi mathvariant="normal">slope</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq78.gif"/></alternatives></inline-formula>” denotes the slope of the first point in the U-Curve of number of significant features (the slope of the line connecting the first two points). “<inline-formula id="IEq79"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {slope}}_1$$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mi mathvariant="normal">slope</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq79.gif"/></alternatives></inline-formula>” denotes the average value of the slope of the first 15 points (<inline-formula id="IEq80"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_f=15$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq80.gif"/></alternatives></inline-formula>) in the U-Curve of number of significant features (the slope of the line connecting the point with its next neighbor). “fragility” denotes the average value of the fragility index of the first 50 microbiome features. “<inline-formula id="IEq81"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {select}}_0$$\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mi mathvariant="normal">select</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq81.gif"/></alternatives></inline-formula>” denotes the number of <italic>p</italic>-values that are less than 0.05 given by the testing results on the observed data. “<inline-formula id="IEq82"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {select}}_1$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mi mathvariant="normal">select</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq82.gif"/></alternatives></inline-formula>” denotes the number of significant features identified by the proposed method</p></table-wrap-foot></table-wrap></p>
    <p id="Par19">We follow the same simulation setup used by [<xref ref-type="bibr" rid="CR21">21</xref>]. We simulate the OTU counts as random samples drawn from a negative binomial distribution <inline-formula id="IEq83"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {F}}(m, \kappa )$$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mi mathvariant="script">F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>κ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq83.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq84"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M168"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq84.gif"/></alternatives></inline-formula> is called the dispersion parameter, as the variance is <inline-formula id="IEq85"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m+\frac{m^2}{\kappa }$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>κ</mml:mi></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq85.gif"/></alternatives></inline-formula>. To simulate the dependence between OTUs, we use the Gaussian copula [<xref ref-type="bibr" rid="CR22">22</xref>] to combine the correlation structure <inline-formula id="IEq86"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{R}}}$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq86.gif"/></alternatives></inline-formula> with the negative binomial distributions. Here are the simulation steps. First, we draw Gaussian samples of <inline-formula id="IEq87"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{Z}}}\sim {\mathcal {N}}(0,{{\varvec{R}}})$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq87.gif"/></alternatives></inline-formula>. Second, we obtain the negative binomial samples <inline-formula id="IEq88"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{X}}}_j={\mathcal {F}}^{-1}(\Phi ({{\varvec{Z}}}_j)), j =1,\ldots , p$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq88.gif"/></alternatives></inline-formula>. <inline-formula id="IEq89"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi (\cdot )$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq89.gif"/></alternatives></inline-formula> denotes the Gaussian cumulative distribution function. Third, we obtain the compositions by dividing each element <inline-formula id="IEq90"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$X_{ij}$$\end{document}</tex-math><mml:math id="M180"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq90.gif"/></alternatives></inline-formula> by a constant greater than the sum of each rows.</p>
    <p id="Par20">To gain a sense of how the shape of the U-Curve depicts the strength and robustness of signals, we construct multiple data sets, changing the simulation parameters and performing progressive permutation on each data set. Let <inline-formula id="IEq91"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{ij}^1 \sim {\mathcal {F}}(m_j^1, \kappa _j^1)$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>κ</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq91.gif"/></alternatives></inline-formula> denote the simulated data from Group 1. Let <inline-formula id="IEq92"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{ij}^2 \sim {\mathcal {F}}(m_j^2, \kappa _j^2)$$\end{document}</tex-math><mml:math id="M184"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">F</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>κ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq92.gif"/></alternatives></inline-formula> denote the simulated data from Group 2. The two groups have the same sample size <inline-formula id="IEq93"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_1=n_2=30$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq93.gif"/></alternatives></inline-formula> and the same correlation structure as <inline-formula id="IEq94"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{ij}=\rho ^{i-j}$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq94.gif"/></alternatives></inline-formula>. We simulate the grouping factor of interest <italic>y</italic> as <inline-formula id="IEq95"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[1,\ldots , 1, 2,\ldots , 2]$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq95.gif"/></alternatives></inline-formula>. Suppose both group consist of 100 variables. Let “nsv” denote the number of differential variables whose distribution means are <inline-formula id="IEq96"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_j^1$$\end{document}</tex-math><mml:math id="M192"><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq96.gif"/></alternatives></inline-formula> or <inline-formula id="IEq97"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_j^2$$\end{document}</tex-math><mml:math id="M194"><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq97.gif"/></alternatives></inline-formula>, the means of all the other variables is set as 1. As shown in Table <xref rid="Tab1" ref-type="table">1</xref>, we set the means of Group 1 as <inline-formula id="IEq98"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{10,10,10\}$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq98.gif"/></alternatives></inline-formula> and the means of Group 2 as <inline-formula id="IEq99"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{1,6,10\}$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq99.gif"/></alternatives></inline-formula>, so the mean differences between the two groups are <inline-formula id="IEq100"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{9,4,0\}$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>9</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq100.gif"/></alternatives></inline-formula>. For instance, a data set is generated with <inline-formula id="IEq101"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_1-m_2=9$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq101.gif"/></alternatives></inline-formula> and nsv=30, meaning that 30% of the 100 variables have strong differences (<inline-formula id="IEq102"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_j^1=10$$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq102.gif"/></alternatives></inline-formula> vs. <inline-formula id="IEq103"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_j^2=1$$\end{document}</tex-math><mml:math id="M206"><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq103.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq104"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j= 1,\ldots , 30$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq104.gif"/></alternatives></inline-formula>) between the two groups, while all the other 70 variables are not differential (mean difference is 0) between the two groups. We summarize the following observations based on the above simulations. AOI in general increases with the proportion of significant features in the simulated data. As the variance increases when <inline-formula id="IEq105"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M210"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq105.gif"/></alternatives></inline-formula> becomes smaller, the differential effect between the two groups shrinks with <inline-formula id="IEq106"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M212"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq106.gif"/></alternatives></inline-formula>. So the AUMC and average fragility of the first 50 features become smaller. The differential effect increases with the two mean differences between the two groups. So the corresponding AUMC and average fragility of the first 50 features become smaller when mean differences are smaller. As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, the shape of U-Curve becomes flatter when two groups are less differential. Therefore, the more a grouping factor differentiates the features, the bigger AOI, AUMC and fragility index will be obtained. In particular, when the mean difference between the two groups is close to 0, the AOI and AUMC are almost zero, indicating that the U-Curve of number of significant features is flat when there are no differential signals. Additionally, correlations between microbiome features do not affect the values of the AOI and AUMC. The significant features identified by the proposed method is a subset of features whose <italic>p</italic>-values are less than 0.05 in the observed data.</p>
    <p id="Par21">However, the behavior of steepness of the U-Curve is not clear in the previous simulations. In the following simulations, we control the data to produce the same AOI, but with different slopes. In other words, the number of identified features are the same, but actually the robustness of these features are different. Rather than just consider the significance depicted by <italic>p</italic>-values, we can further consider robustness to evaluate the feature-outcome associations using the U-Curve and fragility index from progressive permutation. We will show that some unknown heterogeneity might be one reason affecting the robustness of the features that are identified as differential. We generate three simulation data sets, which are denoted as SimData 1, SimData 2 and SimData 3. They have the same sample size <inline-formula id="IEq107"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_1=n_2=30$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq107.gif"/></alternatives></inline-formula> and same number of variables <inline-formula id="IEq108"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p=100$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq108.gif"/></alternatives></inline-formula>. The 60 samples differ substantially between Group 1 (30 samples) and Group 2 (30 samples). We denote data of Group 1 as <inline-formula id="IEq109"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_1$$\end{document}</tex-math><mml:math id="M218"><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq109.gif"/></alternatives></inline-formula> and data of Group 2 as <inline-formula id="IEq110"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_2$$\end{document}</tex-math><mml:math id="M220"><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq110.gif"/></alternatives></inline-formula>. For the 100 variables, we define the proportion of significant features to be 0.6, which implies that 60 variables are significant. To construct heterogeneity, we create the second source of difference by splitting Group 1 into two subgroups of samples, which are denoted as <inline-formula id="IEq111"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{11}$$\end{document}</tex-math><mml:math id="M222"><mml:msub><mml:mi>D</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq111.gif"/></alternatives></inline-formula> and <inline-formula id="IEq112"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{12}$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mi>D</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq112.gif"/></alternatives></inline-formula>. In the same way, we split Group 2 into two subgroups of samples, which are denoted as <inline-formula id="IEq113"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{21}$$\end{document}</tex-math><mml:math id="M226"><mml:msub><mml:mi>D</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq113.gif"/></alternatives></inline-formula> and <inline-formula id="IEq114"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{22}$$\end{document}</tex-math><mml:math id="M228"><mml:msub><mml:mi>D</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq114.gif"/></alternatives></inline-formula>. The grouping factor of interest <italic>y</italic> is <inline-formula id="IEq115"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[1,\ldots , 1, 2,\ldots , 2]$$\end{document}</tex-math><mml:math id="M230"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq115.gif"/></alternatives></inline-formula>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Result comparisons of three simulated data sets with different levels of heterogeneity. The first row (<bold>a</bold>–<bold>c</bold>) shows the NMDS plot using the Bray-Curtis distance. The second row (<bold>d</bold>–<bold>f</bold>) shows the U-Curve of proportion of significant features. AOI is short for area of interest, which denotes the proportion of significant features out of all the features (area of green plus purple). AUMC is short for area under the mixing curve, which denotes the area under the U-Curve (area of purple). Slope denotes the slope of the red triangle. The red triangle denotes the real data. The third row (<bold>g</bold>–<bold>i</bold>) shows the fragility index. The height of each bar represents the Fragility Index value for a given feature. Each color denotes features that have the same levels of fragility. To save space, the legend listing the names of the 50 features are omitted</p></caption><graphic xlink:href="12859_2021_4061_Fig3_HTML" id="MO4"/></fig></p>
    <p id="Par22">We describe the data generation as follows. We use <inline-formula id="IEq116"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(m)_c$$\end{document}</tex-math><mml:math id="M232"><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq116.gif"/></alternatives></inline-formula> to denote a sequence containing <italic>c</italic> number of <italic>m</italic>. <inline-formula id="IEq117"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {RN}}(\mu _0, \sigma _0)$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:mi mathvariant="normal">RN</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq117.gif"/></alternatives></inline-formula> describes the random number drawn from normal distribution with mean <inline-formula id="IEq118"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _0$$\end{document}</tex-math><mml:math id="M236"><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq118.gif"/></alternatives></inline-formula> and variance <inline-formula id="IEq119"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma _0$$\end{document}</tex-math><mml:math id="M238"><mml:msub><mml:mi>σ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq119.gif"/></alternatives></inline-formula>. We define the correlation structure as <inline-formula id="IEq120"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{ij}=\rho ^{i-j}$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq120.gif"/></alternatives></inline-formula>. <inline-formula id="IEq121"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho$$\end{document}</tex-math><mml:math id="M242"><mml:mi>ρ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq121.gif"/></alternatives></inline-formula> is set up as 0.5. Zero-Inflation is one of the main characteristics of microbiome data. Note that <inline-formula id="IEq122"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu$$\end{document}</tex-math><mml:math id="M244"><mml:mi>μ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq122.gif"/></alternatives></inline-formula> controls the magnitude of each variable and number of zeros in each sample. The distribution of zeros across samples and variables of SimData 1, SimData 2 and SimData 3 is comparable to the distribution of zeros in real Data, please see the histograms in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Sect. S3.<list list-type="bullet"><list-item><p id="Par23"><italic>SimData 1</italic>: <inline-formula id="IEq123"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{11}$$\end{document}</tex-math><mml:math id="M246"><mml:msub><mml:mi>D</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq123.gif"/></alternatives></inline-formula> contains 8 samples. The mean is <inline-formula id="IEq124"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[(6)_{30}, (4)_{30}, (1)_{40}]$$\end{document}</tex-math><mml:math id="M248"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>40</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq124.gif"/></alternatives></inline-formula>. The dispersion parameter <inline-formula id="IEq125"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M250"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq125.gif"/></alternatives></inline-formula> is 2. <inline-formula id="IEq126"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{12}$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mi>D</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq126.gif"/></alternatives></inline-formula> contains 22 samples. The mean is <inline-formula id="IEq127"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[(4)_{30}, (6)_{30}, (1)_{40}]$$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>40</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq127.gif"/></alternatives></inline-formula>. The dispersion parameter <inline-formula id="IEq128"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M256"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq128.gif"/></alternatives></inline-formula> is 36. <inline-formula id="IEq129"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_2$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mi>D</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq129.gif"/></alternatives></inline-formula> contains 30 samples. The mean is <inline-formula id="IEq130"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[(15)_{30}, (0.5)_{30}, (1)_{40}]$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>15</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>40</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq130.gif"/></alternatives></inline-formula>. The dispersion parameter <inline-formula id="IEq131"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M262"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq131.gif"/></alternatives></inline-formula> is 36.</p></list-item><list-item><p id="Par24"><italic>SimData 2</italic>: <inline-formula id="IEq132"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{11}$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mi>D</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq132.gif"/></alternatives></inline-formula> contains 16 samples. The mean is <inline-formula id="IEq133"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[(8)_{30}, (2)_{30}, (1)_{40}]$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>8</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>40</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq133.gif"/></alternatives></inline-formula>. The dispersion parameter <inline-formula id="IEq134"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M268"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq134.gif"/></alternatives></inline-formula> is 25. <inline-formula id="IEq135"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{12}$$\end{document}</tex-math><mml:math id="M270"><mml:msub><mml:mi>D</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq135.gif"/></alternatives></inline-formula> contains 14 samples. The mean is <inline-formula id="IEq136"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[(2)_{30}, (8)_{30}, (1)_{40}]$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>8</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>40</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq136.gif"/></alternatives></inline-formula>. The dispersion parameter <inline-formula id="IEq137"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M274"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq137.gif"/></alternatives></inline-formula> is 24. <inline-formula id="IEq138"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{21}$$\end{document}</tex-math><mml:math id="M276"><mml:msub><mml:mi>D</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq138.gif"/></alternatives></inline-formula> contains 20 samples. The mean is <inline-formula id="IEq139"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[(15)_{30}, (0.5)_{30}, (1)_{40}]$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>15</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>40</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq139.gif"/></alternatives></inline-formula>. The dispersion parameter <inline-formula id="IEq140"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M280"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq140.gif"/></alternatives></inline-formula> is 26. <inline-formula id="IEq141"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{22}$$\end{document}</tex-math><mml:math id="M282"><mml:msub><mml:mi>D</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq141.gif"/></alternatives></inline-formula> contains 10 samples. The mean is <inline-formula id="IEq142"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[(m_1)_{60},(m_2)_{40}]$$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>60</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>40</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq142.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq143"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_1= {\mathrm {RN}}(5, 1.2)$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">RN</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>1.2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq143.gif"/></alternatives></inline-formula> and <inline-formula id="IEq144"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_2={\mathrm {RN}}(1,0.1)$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">RN</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq144.gif"/></alternatives></inline-formula>. The dispersion parameter <inline-formula id="IEq145"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M290"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq145.gif"/></alternatives></inline-formula> is 24.</p></list-item><list-item><p id="Par25"><italic>SimData 3</italic>: <inline-formula id="IEq146"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{11}$$\end{document}</tex-math><mml:math id="M292"><mml:msub><mml:mi>D</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq146.gif"/></alternatives></inline-formula> contains 24 samples. The mean is <inline-formula id="IEq147"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[(8)_{30}, (2)_{30}, (1)_{40}]$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>8</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>40</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq147.gif"/></alternatives></inline-formula>. The dispersion parameter <inline-formula id="IEq148"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M296"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq148.gif"/></alternatives></inline-formula> is 14. <inline-formula id="IEq149"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{12}$$\end{document}</tex-math><mml:math id="M298"><mml:msub><mml:mi>D</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq149.gif"/></alternatives></inline-formula> contains 6 samples. The mean is <inline-formula id="IEq150"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[(1)_{30}, (10)_{30}, (1)_{40}]$$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>40</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq150.gif"/></alternatives></inline-formula>. The dispersion parameter <inline-formula id="IEq151"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M302"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq151.gif"/></alternatives></inline-formula> is 14. <inline-formula id="IEq152"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{21}$$\end{document}</tex-math><mml:math id="M304"><mml:msub><mml:mi>D</mml:mi><mml:mn>21</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq152.gif"/></alternatives></inline-formula> contains 20 samples. The mean is <inline-formula id="IEq153"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[(15)_{30}, (0.5)_{30}, (1)_{40}]$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>15</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>30</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>40</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq153.gif"/></alternatives></inline-formula>. The dispersion parameter <inline-formula id="IEq154"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M308"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq154.gif"/></alternatives></inline-formula> is 14. <inline-formula id="IEq155"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D_{22}$$\end{document}</tex-math><mml:math id="M310"><mml:msub><mml:mi>D</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq155.gif"/></alternatives></inline-formula> contains 10 samples. The mean is <inline-formula id="IEq156"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[(m_1)_{60},(m_2)_{40}]$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>60</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>40</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq156.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq157"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_1={\mathrm {RN}}(5, 1.6)$$\end{document}</tex-math><mml:math id="M314"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">RN</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>1.6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq157.gif"/></alternatives></inline-formula> and <inline-formula id="IEq158"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_1={\mathrm {RN}}(1, 0.3)$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">RN</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq158.gif"/></alternatives></inline-formula>. The dispersion parameter <inline-formula id="IEq159"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa$$\end{document}</tex-math><mml:math id="M318"><mml:mi>κ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq159.gif"/></alternatives></inline-formula> is 12.</p></list-item></list>Based on the above setup, we expect to see there are more and more levels of heterogeneity by constructing subgroups from SimData 1 to SimData 2 to SimData 3. As a result, the associations between the microbiome features and the grouping factor of interest is weaker and weaker because the proportion of differential samples between Group 1 and Group 2 is lower and lower. Traditionally, non-metric multidimensional scaling (NMDS) is used to collapse information from multiple dimensional features into just a few, so that clustering effect will be visualized and interpreted when we link them with a grouping factor of interest [<xref ref-type="bibr" rid="CR23">23</xref>]. However, in the dimension reduction plots, the expected clustering effect can not be witnessed, because this main differential effect is mixed with heterogeneity. As shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, only the NMDS plot of SimData 1 shows us the clear cluster separations between Group 1 and Group 2. But both the NMDS plot of SimData 2 and the NMDS plot of SimData 3 show overlaps of Group 1 and Group 2 similarly. Therefore, NMDS plots could not distinguish the strength of the overall association between microbiome compositions and the grouping factor of interest. Besides, we can not visualize differences in heterogeneity between SimData 2 and SimData 3.</p>
    <p id="Par26">When testing the relationship between an explanatory variable and an outcome, the variable’s effect might be modified by other variables and distorted by potential systematic bias, confounding or effect modification. The U-Curve and fragility index plots provides us with a measure of all these disturbances mixed with the main signals in the collected data. The U-Curve provides a dynamic depiction of how our method progressively singles out signals from randomized trials. In each plot, the number of significant features decreases from observed data to full permutation scenario. The shape becomes steeper when the associations are less stable (with more disturbances). We use AUMC (area under the mixing curve) to quantify the shape of the U-Curve. AUMCs in Fig. <xref rid="Fig3" ref-type="fig">3</xref>d–f are 0.392, 0.283 and 0.163, which ranks the decreasing order of robustness of the association between microbiome compositions and the grouping factor. The average fragility index of the top 50 features are 10.12 for SimData 1, 7.44 for SimData 2, and 5.24 for SimData 3. Since the full permutation scenario <inline-formula id="IEq160"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_f=15$$\end{document}</tex-math><mml:math id="M320"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq160.gif"/></alternatives></inline-formula>, the average scaled fragility indices are 0.675 for SimData 1, 0.496 for SimData 2 and 0.349 for SimData 3.</p>
    <p id="Par27">Please note that, when generating the U-Curve plots (d–f in Fig. <xref rid="Fig3" ref-type="fig">3</xref>), the black dots describe the median value. The black bars describe the <inline-formula id="IEq161"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2.5\%$$\end{document}</tex-math><mml:math id="M322"><mml:mrow><mml:mn>2.5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq161.gif"/></alternatives></inline-formula> and <inline-formula id="IEq162"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$97.5\%$$\end{document}</tex-math><mml:math id="M324"><mml:mrow><mml:mn>97.5</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq162.gif"/></alternatives></inline-formula> quantile intervals. We follow the same setup in all the subsequent figures.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparisons of identification performance among different methods.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Data</th><th align="left">nsv</th><th align="left">Method</th><th align="left">FP</th><th align="left">FN</th><th align="left">Sensitivity</th><th align="left">Specificity</th><th align="left">Accuracy</th><th align="left">RC</th></tr></thead><tbody><tr><td align="left" rowspan="10">Set 1</td><td align="left" rowspan="5">70</td><td align="left">WilPerm</td><td align="left">1</td><td align="left">3</td><td align="left">0.96</td><td align="left">0.97</td><td align="left">0.96</td><td char="." align="char">0.80</td></tr><tr><td align="left">DESPerm</td><td align="left">3.5</td><td align="left">33.6</td><td align="left">0.52</td><td align="left">0.88</td><td align="left">0.63</td><td char="." align="char">0.50</td></tr><tr><td align="left">DESeq</td><td align="left">2</td><td align="left">0</td><td align="left">1</td><td align="left">0.93</td><td align="left">0.98</td><td char="." align="char">0.55</td></tr><tr><td align="left">LEfSe</td><td align="left">19</td><td align="left">2</td><td align="left">0.97</td><td align="left">0.37</td><td align="left">0.79</td><td char="." align="char">0.16</td></tr><tr><td align="left">Logistic</td><td align="left">1</td><td align="left">4</td><td align="left">0.94</td><td align="left">0.97</td><td align="left">0.95</td><td char="." align="char">0.58</td></tr><tr><td align="left" rowspan="5">30</td><td align="left">WilPerm</td><td align="left">3</td><td align="left">6.3</td><td align="left">0.79</td><td align="left">0.96</td><td align="left">0.91</td><td char="." align="char">0.004</td></tr><tr><td align="left">DESPerm</td><td align="left">2.1</td><td align="left">12.8</td><td align="left">0.57</td><td align="left">0.97</td><td align="left">0.85</td><td char="." align="char">0.094</td></tr><tr><td align="left">DESeq</td><td align="left">4</td><td align="left">0</td><td align="left">1</td><td align="left">0.94</td><td align="left">0.96</td><td char="." align="char">0.17</td></tr><tr><td align="left">LEfSe</td><td align="left">10</td><td align="left">5</td><td align="left">0.83</td><td align="left">0.86</td><td align="left">0.85</td><td char="." align="char">0.24</td></tr><tr><td align="left">Logistic</td><td align="left">1</td><td align="left">5</td><td align="left">0.83</td><td align="left">0.99</td><td align="left">0.94</td><td char="." align="char">0.07</td></tr><tr><td align="left" rowspan="10">Set 2</td><td align="left" rowspan="5">70</td><td align="left">WilPerm</td><td align="left">6.3</td><td align="left">0</td><td align="left">1</td><td align="left">0.79</td><td align="left">0.94</td><td char="." align="char">0.02</td></tr><tr><td align="left">DESPerm</td><td align="left">30</td><td align="left">6.3</td><td align="left">0.91</td><td align="left">0</td><td align="left">0.64</td><td char="." align="char">0.79</td></tr><tr><td align="left">DESeq</td><td align="left">30</td><td align="left">9</td><td align="left">0.87</td><td align="left">0</td><td align="left">0.61</td><td char="." align="char">0.81</td></tr><tr><td align="left">LEfSe</td><td align="left">30</td><td align="left">4</td><td align="left">0.94</td><td align="left">0</td><td align="left">0.66</td><td char="." align="char">− 0.04</td></tr><tr><td align="left">Logistic</td><td align="left">5</td><td align="left">40</td><td align="left">0.43</td><td align="left">0.83</td><td align="left">0.55</td><td char="." align="char">− 0.88</td></tr><tr><td align="left" rowspan="5">30</td><td align="left">WilPerm</td><td align="left">7</td><td align="left">0</td><td align="left">1</td><td align="left">0.9</td><td align="left">0.93</td><td char="." align="char">0.35</td></tr><tr><td align="left">DESPerm</td><td align="left">19</td><td align="left">0</td><td align="left">1</td><td align="left">0.73</td><td align="left">0.81</td><td char="." align="char">0.80</td></tr><tr><td align="left">DESeq</td><td align="left">3</td><td align="left">7</td><td align="left">0.77</td><td align="left">0.96</td><td align="left">0.90</td><td char="." align="char">0.80</td></tr><tr><td align="left">LEfSe</td><td align="left">70</td><td align="left">5</td><td align="left">0.83</td><td align="left">0</td><td align="left">0.25</td><td char="." align="char">0.08</td></tr><tr><td align="left">Logistic</td><td align="left">7</td><td align="left">5</td><td align="left">0.83</td><td align="left">0.9</td><td align="left">0.88</td><td char="." align="char">− 0.79</td></tr></tbody></table><table-wrap-foot><p>“WilPerm” stands for progressive permutation equipped with Wilcoxon tests. “DESPerm” stands for progressive permutation equipped with DESeq method. FP denotes number of false positives. FN denotes number of false negatives. Sensitivity measures the proportion of positives that are correctly identified. Specificity measures the proportion of negatives that are correctly identified. Accuracy measures the proportion of true positives and true negatives. RC denotes the rank correlation (Spearman’s <inline-formula id="IEq163"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho$$\end{document}</tex-math><mml:math id="M326"><mml:mi>ρ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq163.gif"/></alternatives></inline-formula>) between the true and estimated ranks of the features. Set 1 denotes the simulation data that varies the zero inflation parameter for each variables. Set 2 denotes the simulation data that varies the mean difference parameter for each variables</p></table-wrap-foot></table-wrap></p>
    <p id="Par28">In applying our proposed progressive permutation method, we consider <italic>p</italic>-values obtained using the Wilcoxon test and DESeq. Specifically, for DESeq, we rely on the DESeq2 package in R [<xref ref-type="bibr" rid="CR11">11</xref>], with multiplicity-adjusted <italic>p</italic>-values used to determine hits. We consider features to be significant if their <inline-formula id="IEq164"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10}p$$\end{document}</tex-math><mml:math id="M328"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq164.gif"/></alternatives></inline-formula>-values in the unpermuted scenario lie outside the 95% quantile intervals of those in the full permutation scenario. We apply these two permutation methods, as well as the standard versions of the DESeq, LEfSe and logistic regression methods, to the simulated data.</p>
    <p id="Par29">We now describe our data generation procedure. Microbiome data are typically overdispersed and zero-inflated. Since the negative binomial distribution can not capture excess zero values, we use another generation mechanism “sparseDOSSA” (<ext-link ext-link-type="uri" xlink:href="https://huttenhower.sph.harvard.edu/sparsedossa/">https://huttenhower.sph.harvard.edu/sparsedossa/</ext-link>) to allow zero-inflation in the simulated data. In our simulation, we consider a setting with 60 samples (30 samples in each group) and 100 variables. The simulated abundance of each microbial variable is jointly controlled by three parameters: the proportion of zero inflation, mean, and variance.</p>
    <p id="Par30">To study the impact of excessive zero values on the performance of the testing methods, we keep the mean difference (between two groups) and variance to be the same for each variable. We fit the data generation model to a subset of the DeFilippo data (see “<xref rid="Sec4" ref-type="sec">Application</xref>” section) and obtain the zero inflation parameters for 100 variables. Then we rank the estimated values of the zero inflation parameter from lowest to highest, so that the mean abundances of the simulated data have a decreasing order from the first to the last variable. Let <inline-formula id="IEq165"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {nsv}}$$\end{document}</tex-math><mml:math id="M330"><mml:mi mathvariant="normal">nsv</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq165.gif"/></alternatives></inline-formula> denote the number of variables that are truly differential. We set the mean parameter of the first <inline-formula id="IEq166"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {nsv}}$$\end{document}</tex-math><mml:math id="M332"><mml:mi mathvariant="normal">nsv</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq166.gif"/></alternatives></inline-formula> true variables as 3 in Group 1, and as 0 in Group 2. The variance parameter is set as 1 for all variables. With this setup (named as Set 1), the variables with a smaller zero inflation parameter should be more differential than the ones with a bigger zero inflation parameter.</p>
    <p id="Par31">We also consider an alternative setup (named as Set 2), to observe how the testing methods perform with changes to the mean differences. In this setting, we fix the proportion of zero-inflation (set as 0.1) and variance (set as 0.2) to be the same for each variable. We make a decreasing order of the mean differences from the first to the last variable. With this setup, the variables with bigger mean differences should be more differential than the ones with smaller mean differences. We also design comparisons between data sets with dense signal and sparse signal. For the data with dense signal, the first 70 variables (<inline-formula id="IEq167"><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {nsv}}=70$$\end{document}</tex-math><mml:math id="M334"><mml:mrow><mml:mi mathvariant="normal">nsv</mml:mi><mml:mo>=</mml:mo><mml:mn>70</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq167.gif"/></alternatives></inline-formula>) are simulated to be differential. For the data with sparse signal, the first 30 variables (<inline-formula id="IEq168"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm {nsv}}=30$$\end{document}</tex-math><mml:math id="M336"><mml:mrow><mml:mi mathvariant="normal">nsv</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq168.gif"/></alternatives></inline-formula>) are simulated to be differential.</p>
    <p id="Par32">We report the mean values for all the performance measures in Table <xref rid="Tab2" ref-type="table">2</xref>. FP stands for false positives, where the method identifies a feature that is truly non-differential. FN stands for false negatives, where the method does not identify a feature that is truly differential. RC denotes the rank correlation (Spearman’s <inline-formula id="IEq169"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho$$\end{document}</tex-math><mml:math id="M338"><mml:mi>ρ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq169.gif"/></alternatives></inline-formula>) between the true and estimated ranks of the features. When comparing the two permutation methods, the version based on the Wilcoxon test achieves higher accuracy than the version based on DESeq. This is likely because the Wilcoxon test is a non-parametric test, while DESeq is a parametric test that requires distributional assumptions. As shown in the U-Curve plots of the number of significant features (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S4, S6, S8 and S10), the number of significant features does not approach zero in the full permutation scenario when the data are highly zero inflated. This result suggests that the DESeq method incorrectly identifies noise as signal when the data do not follow the assumed distribution. In brief, permutation with the Wilcoxon test is more flexible in dealing with data with unknown complex distributions.</p>
    <p id="Par33">When comparing the proposed permutation method with standard versions of DESeq and LEfSe, we notice that DESeq has high specificity in Setting 1, but an increased rate of false positives in Setting 2, due to violations of its parametric assumptions. Compared with the other methods, LEfSe is too generous, with a high number of false positives. LEfSe uses both <italic>p</italic>-values and effect size to determine hits; however, it does not adjust the <italic>p</italic>-values for multiplicity, and our results suggest that the default threshold on the effect sizes may be overly generous. We also notice that logistic regression has high false negatives in Setting 2. Logistic regression treats the binary outcome as the response variable and the microbial features as the independent variable. This model assumes a linear relationship between the logit of the response variable and the predictors, and may not perform well when this assumption is violated.<fig id="Fig4"><label>Fig. 4</label><caption><p>Comparisons of grouping effect in SmitsData 1 (<bold>a</bold>) versus SmitsData 2 (<bold>b</bold>) using PCoA plot. The length of straight line denotes the distance of each individual point to the centroid. The centroid of each group is labeled. The ellipse denotes a 1 standard deviation to the centroid. In plot A, the blue circle denotes the PCoA score of Dry groups, while the red triangle denotes the PCoA score of Wet groups. In plot B, the blue circle denotes the PCoA score of LDEW group, while the red triangle denotes the PCoA score of LWED group</p></caption><graphic xlink:href="12859_2021_4061_Fig4_HTML" id="MO5"/></fig></p>
  </sec>
  <sec id="Sec4">
    <title>Application</title>
    <p id="Par34">In this section, we apply the proposed method into two microbiome studies. The first study includes five groups. We regroup them to construct two data sets with different levels of heterogeneity. In the second study, we link microbiome compositions with two different outcomes.<fig id="Fig5"><label>Fig. 5</label><caption><p>Result comparisons of regrouped data SmitsData 1 (<bold>A1</bold>–<bold>A4</bold>) and SmitsData 2 (<bold>B1</bold>–<bold>B4</bold>) with different levels of heterogeneity. <bold>A1</bold> and <bold>B1</bold> plot the U-Curve of number of significant hits. In <bold>A2</bold> and <bold>B2</bold>, we rank the significance of the 786 features, and then plot their <inline-formula id="IEq170"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M340"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq170.gif"/></alternatives></inline-formula>-values with the same order across permutation scenarios. <bold>A3</bold> and <bold>B3</bold> plot the U-Curve of proportion of significant hits. <bold>A4</bold> and <bold>B4</bold> plots the fragility index of the top 100 features with a decreasing order. To save space, the legend listing the names of the 100 features are omitted</p></caption><graphic xlink:href="12859_2021_4061_Fig5_HTML" id="MO6"/></fig><fig id="Fig6"><label>Fig. 6</label><caption><p>Result comparisons when linking microbiome compositions with location (<bold>A1</bold>–<bold>A4</bold>) and gender (<bold>B1</bold>–<bold>B4</bold>). A1 and B1 plot the U-Curve of number of significant hits. In A2 and B2, we rank the significance of the 267 features, and then plot their <inline-formula id="IEq171"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M342"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq171.gif"/></alternatives></inline-formula>-values with the same order across permutation scenarios. A3 and B3 plot the U-Curve of proportion of significant hits. A4 and B4 plots the fragility index of the top 50 features with a decreasing order. To save space, the legend listing the names of the 50 features are omitted</p></caption><graphic xlink:href="12859_2021_4061_Fig6_HTML" id="MO7"/></fig></p>
    <p id="Par35">The first study examined the gut microbiota of 350 stool samples collected longitudinally for more than a year from the Hadza hunter gatherers of Tanzania. The samples were collected subsequently with 5 seasonal groups: 2013-LD (Late dry), 2014-EW (Early wet), 2014-LW (Late wet), 2014-ED (Early dry) and 2014 LD (Late Dry). Smits SA, et al. [<xref ref-type="bibr" rid="CR24">24</xref>] found that Hadza gut microbial community compositions are cyclic and differential by season. They observed that samples from the dry seasons were distinguishable from the wet seasons and were indistinguishable from other dry seasons in sequential years. We combine 2014-ED (<inline-formula id="IEq172"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=33$$\end{document}</tex-math><mml:math id="M344"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>33</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq172.gif"/></alternatives></inline-formula>) and 2014-LD (<inline-formula id="IEq173"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=133$$\end{document}</tex-math><mml:math id="M346"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>133</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq173.gif"/></alternatives></inline-formula>) as the “Dry” group, and combine 2014-EW (<inline-formula id="IEq174"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=62$$\end{document}</tex-math><mml:math id="M348"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>62</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq174.gif"/></alternatives></inline-formula>) and 2014-LW (<inline-formula id="IEq175"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=58$$\end{document}</tex-math><mml:math id="M350"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>58</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq175.gif"/></alternatives></inline-formula>) as the “Wet” group. We call this regrouped data as SmitsData 1. In the same way, we combine 2013-LD (<inline-formula id="IEq176"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=64$$\end{document}</tex-math><mml:math id="M352"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>64</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq176.gif"/></alternatives></inline-formula>) and 2014-EW (<inline-formula id="IEq177"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=62$$\end{document}</tex-math><mml:math id="M354"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>62</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq177.gif"/></alternatives></inline-formula>) as the “LDEW” group, and combine 2014-LW (<inline-formula id="IEq178"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=58$$\end{document}</tex-math><mml:math id="M356"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>58</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq178.gif"/></alternatives></inline-formula>) and 2014-ED (<inline-formula id="IEq179"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=33$$\end{document}</tex-math><mml:math id="M358"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>33</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq179.gif"/></alternatives></inline-formula>) as the “LWED” group. We call this regrouped data as SmitsData 2. We expect that SmitsData 1 is more differential between Dry and Wet group than SmitsData 2 between LDEW and LWED group. As shown in PCoA plots of both data (Fig. <xref rid="Fig4" ref-type="fig">4</xref>), the Dry and Wet groups in SmitsData 1 (<italic>p</italic>-<inline-formula id="IEq180"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text {value}}=1e{-}5$$\end{document}</tex-math><mml:math id="M360"><mml:mrow><mml:mtext>value</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq180.gif"/></alternatives></inline-formula> based on PERMANOVA) are more differential than the groups in SmitsData 2 (<italic>p</italic>-<inline-formula id="IEq181"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hbox {value}}=2e{-}5$$\end{document}</tex-math><mml:math id="M362"><mml:mrow><mml:mtext>value</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq181.gif"/></alternatives></inline-formula> based on PERMANOVA).</p>
    <p id="Par36">In total, we have 786 taxonomic features. We perform the progressive permutation tests on SmitsData 1 (Dry <inline-formula id="IEq182"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_1=166$$\end{document}</tex-math><mml:math id="M364"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>166</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq182.gif"/></alternatives></inline-formula> vs. Wet <inline-formula id="IEq183"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_2=120$$\end{document}</tex-math><mml:math id="M366"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>120</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq183.gif"/></alternatives></inline-formula>) and SmitsData 2 (LDEW <inline-formula id="IEq184"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_1=126$$\end{document}</tex-math><mml:math id="M368"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>126</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq184.gif"/></alternatives></inline-formula> vs. LWED <inline-formula id="IEq185"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_2=91$$\end{document}</tex-math><mml:math id="M370"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>91</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq185.gif"/></alternatives></inline-formula>). The results of SmitsData 1 (A1–A4) and SmitsData 2 (B1–B4) are shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. In the observed data (no permutation), differential tests provide more significant hits (<italic>p</italic>-value less than 0.05) from SmitsData 1 (672 in A1) than SmitsData 2 (345 in B1). There are more <inline-formula id="IEq186"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M372"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq186.gif"/></alternatives></inline-formula>-values greater than <inline-formula id="IEq187"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} 0.05$$\end{document}</tex-math><mml:math id="M374"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq187.gif"/></alternatives></inline-formula> (A2 vs. B2). The U-Curve of SmitsData 1 (AUMC is 0.53) is steeper than SmitsData 2 (AUMC is 0.148). Based on the plot of fragility index, the overall robustness of the top 100 features from SmitsData 1 (average fragility index is 54.93 in A4) is more than SmitsData 2 (average fragility index is 29.93 in B4). The full permutation scenario for SmitsData 1 is <inline-formula id="IEq188"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_f=70$$\end{document}</tex-math><mml:math id="M376"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>70</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq188.gif"/></alternatives></inline-formula>. So the average scaled fragility index for SmitsData 1 is 0.785. The full permutation scenario for SmitsData 2 is <inline-formula id="IEq189"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_f=53$$\end{document}</tex-math><mml:math id="M378"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>53</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq189.gif"/></alternatives></inline-formula>. So the average scaled fragility index for SmitsData 2 is 0.565. In addition, the initial slopes of the first points for SmitsData 1 and SmitsData 2 are − 0.153 and − 0.463 respectively, which also indicate the significance in SmitsData 1 is more robust. All these results demonstrate that the progressive permutation results can convey and quantify the overall association which is disturbed by heterogeneity. When it comes to feature identification, the proposed method obtains 656 features for SmitsData 1 and 271 features for SmitsData2.</p>
    <p id="Par37">The second study investigated the impact of diet by comparing the gut microbiota of 14 children aged 1–6 years in a village of rural Africa with the gut microbiota of 15 European children of the same age. De Filippo et al. [<xref ref-type="bibr" rid="CR25">25</xref>] found significant differences in gut microbiota between the two groups, as children at these two locations have different dietary habits. 11 of them are female. 18 of them are male. There is almost no difference in microbiome compositions by gender. In total, we have 267 taxonomic features in the DeFilippo Data. We perform the progressive permutation tests to associate microbiome compositions with location and gender respectively. The results of location (A1–A4) and gender (B1–B4) are shown in Fig. <xref rid="Fig6" ref-type="fig">6</xref>. In the observed data, differential tests provide more significant hits for Location (161 in A1) than for Gender (11 for A2). The results illustrate that microbiome compositions are strongly associated with location instead of gender, because AUMC of location (0.253 in A3) is greater than AUMC of gender (0.035 in B3). The U-Curves of gender (B1 and B3) are almost flat, which imply that the overall association between microbiome compositions and gender is weak. Based on the plot of fragility index, the overall robustness of the top 50 features for Location (average fragility index is 4.12 in A4) is more than Gender (average fragility index is 0.98 in B4). The full permutation scenario for Location is <inline-formula id="IEq190"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_f=7$$\end{document}</tex-math><mml:math id="M380"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq190.gif"/></alternatives></inline-formula>, and the average scaled fragility index for location is 0.589. The full permutation scenario for gender is <inline-formula id="IEq191"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_f=7$$\end{document}</tex-math><mml:math id="M382"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq191.gif"/></alternatives></inline-formula>, and the average scaled fragility index for gender is 0.14. In addition, the average slopes of the first 7 points for location and gender are − 1.17 and − 0.03 respectively, which also indicate there is no significance for gender across all the scenarios. All these results demonstrate that the progressive permutation method can measure and rank the overall association between microbiome and multiple outcomes of interest. For the outcomes with high association, we will continue to identify the microbiome features that are linked to them.<fig id="Fig7"><label>Fig. 7</label><caption><p>List of discoveries, effect sizes and individual abundances. <bold>a</bold> Denotes the coverage plot of the top 50 features with decreasing order. The color dots denote the <inline-formula id="IEq192"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M384"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq192.gif"/></alternatives></inline-formula>-value of top 50 features in the original data (permutation proportion is 0). The horizontal bars describe the 95% quantile confidence intervals of the <inline-formula id="IEq193"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M386"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq193.gif"/></alternatives></inline-formula>-value in the full permutation scenario. <bold>b</bold> Denotes the effect sizes of identified features. <bold>c</bold>, <bold>d</bold> Denote the dot plot of abundance of Prevotella and Treponema with median-quantile vertical lines</p></caption><graphic xlink:href="12859_2021_4061_Fig7_HTML" id="MO8"/></fig></p>
    <p id="Par38">We include the identification of individual features in our software by observing whether the <inline-formula id="IEq194"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M388"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq194.gif"/></alternatives></inline-formula>-values of targeted features lie within the 95% confidence interval of median <inline-formula id="IEq195"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M390"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq195.gif"/></alternatives></inline-formula>-values of the full permutation scenario. The proposed method has identified 155 features for location and 0 features for gender. As shown in the upper left panel in Fig. <xref rid="Fig7" ref-type="fig">7</xref>, all the top 50 features are significant. The effect sizes of these 50 significant features are plotted in the upper right panel. Our findings are consistent with published results [<xref ref-type="bibr" rid="CR25">25</xref>]. Firmicutes are more abundant in European children than in African children. Prevotella and Treponema (Spirochaetaceae) are more abundant in African children than in European children (as shown in the lower panels of Fig. <xref rid="Fig7" ref-type="fig">7</xref>).</p>
    <p id="Par39">In summary, our method first explores the overall association (that might be complicated by heterogeneity) between microbiome compositions and outcome variable. If the association is reasonable, it will identify the significance of individual hits, list their effect sizes and plot individual abundances.</p>
  </sec>
  <sec id="Sec5">
    <title>Analytical property</title>
    <p id="Par40">Various summary statistics, like mean, variances, median and rank sums, have been used to analyze differences between two groups. Each statistic goes along with an assumption of a sample distribution, including normal, negative binomial and so on. Among these, the mean test under a normal assumption is one of the most widely-used statistical techniques for group comparisons. Other types of tests extend the standard to broader situations that require specific assumptions or less restrictions. Therefore, it is worthwhile to pursue the theoretical aspects of the progressive permutation method in a basic setup that performs Z-tests. The theoretical results from parametric tests can provide insights to the progressive permutation coupling non-parametric tests, as we expect to observe similar patterns between them. To simplify the problem, we assume observing two groups of variables from Gaussian family. Both groups have the same number of variables <italic>p</italic>. The population distribution of Group 1 is <inline-formula id="IEq196"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {N}}(\mu _j^1,\sigma ^2)$$\end{document}</tex-math><mml:math id="M392"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq196.gif"/></alternatives></inline-formula>, and the population distribution of Group 2 is <inline-formula id="IEq197"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathcal {N}}(\mu _j^2,\sigma ^2)$$\end{document}</tex-math><mml:math id="M394"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq197.gif"/></alternatives></inline-formula>. We aim to test the hypothesis <inline-formula id="IEq198"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H_{0j}: \mu _j^1=\mu _j^2,\, {\mathrm{versus}}\, H_{1j}: \mu _j^1\ne \mu _j^2$$\end{document}</tex-math><mml:math id="M396"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi mathvariant="normal">versus</mml:mi><mml:mspace width="0.166667em"/><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>≠</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq198.gif"/></alternatives></inline-formula>.</p>
    <p id="Par41">For the sample data, we use <inline-formula id="IEq199"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{ij}^1$$\end{document}</tex-math><mml:math id="M398"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq199.gif"/></alternatives></inline-formula> to denote the <italic>i</italic>th observation of the <italic>j</italic>th variable in Group 1 and <inline-formula id="IEq200"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{ij}^2$$\end{document}</tex-math><mml:math id="M400"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq200.gif"/></alternatives></inline-formula> to denote the <italic>i</italic>th observation of the <italic>j</italic>th variable in Group 2. The data samples are generated from Gaussian distributions with <inline-formula id="IEq201"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{ij}^1\sim {\mathcal {N}}(m_j^1,\sigma ^2)$$\end{document}</tex-math><mml:math id="M402"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq201.gif"/></alternatives></inline-formula> and <inline-formula id="IEq202"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{ij}^2\sim {\mathcal {N}}(m_j^2,\sigma ^2)$$\end{document}</tex-math><mml:math id="M404"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq202.gif"/></alternatives></inline-formula>. The observations of every variable in each group are independent and identically distributed. We denote the grouping labels in Group 1 as <inline-formula id="IEq203"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I^1=\{1,\ldots , n_1\}$$\end{document}</tex-math><mml:math id="M406"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq203.gif"/></alternatives></inline-formula>. We denote the grouping labels in Group 2 as <inline-formula id="IEq204"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I^2=\{1,\ldots , n_2\}$$\end{document}</tex-math><mml:math id="M408"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq204.gif"/></alternatives></inline-formula>. To test the population mean difference (<inline-formula id="IEq205"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu _j^1-\mu _j^2$$\end{document}</tex-math><mml:math id="M410"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq205.gif"/></alternatives></inline-formula>) of the <italic>j</italic>th variable between the two groups, we calculate the sample mean difference as below:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\varvec{\bar{x}}}}_j^1-{{\varvec{\bar{x}}}}_j^2=\frac{1}{n_1}\sum _{i=1}^{n_1} x_{ij}^1-\frac{1}{n_2}\sum _{i=1}^{n_2} x_{ij}^2\sim {\mathcal {N}}\left(m_j^1-m_j^2,\frac{n_1+n_2}{n_1n_2}\sigma ^2\right). \end{aligned}$$\end{document}</tex-math><mml:math id="M412" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:munderover><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:munderover><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4061_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>Now we perform the progressive permutation method and randomly draw <italic>k</italic> samples from group 1 and <italic>k</italic> samples from group 2, and then exchange their grouping labels. We denote the selected labels in Group 1 as <inline-formula id="IEq206"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_k^1=\{i^1_1,\ldots , i^1_k\}$$\end{document}</tex-math><mml:math id="M414"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mn>1</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq206.gif"/></alternatives></inline-formula>. We denote the selected labels in Group 2 as <inline-formula id="IEq207"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_k^2=\{i^2_1,\ldots , i^2_k\}$$\end{document}</tex-math><mml:math id="M416"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq207.gif"/></alternatives></inline-formula>. Then the sample mean difference of the <italic>j</italic>th variable in permutation scenario <italic>k</italic> becomes<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {{\varvec{\bar{x'}}}}_j^1-{{\varvec{\bar{x'}}}}_j^2&amp;=\frac{1}{n_1}\sum _{i\in I^1\setminus I^1_k} x_{ij}^1 + \frac{1}{n_1}\sum _{i\in I^2_k}x_{ij}^2 - \frac{1}{n_2}\sum _{i \in I^2\setminus I^2_k} x_{ij}^2 - \frac{1}{n_2}\sum _{i\in I^1_k}x_{ij}^1\\ &amp;\sim {\mathcal {N}}\left( \left(1-\frac{n_1+n_2}{n_1n_2}k\right)\left(m_j^1-m_j^2\right),\frac{n_1+n_2}{n_1n_2}\sigma ^2\right) . \end{aligned}$$\end{document}</tex-math><mml:math id="M418" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold">′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold">′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:munder><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:munder><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo lspace="0.15em" rspace="0.15em" stretchy="false">\</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:munder><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:munder><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mfenced close=")" open="("><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mi>k</mml:mi></mml:mfenced><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4061_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>We assume <inline-formula id="IEq208"><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_j^1&gt;m_j^2$$\end{document}</tex-math><mml:math id="M420"><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq208.gif"/></alternatives></inline-formula>. The sample mean differences after permutation (<xref rid="Equ3" ref-type="">3</xref>) are smaller than those before permutation (<xref rid="Equ2" ref-type="">2</xref>). Denote <inline-formula id="IEq209"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta _j=\frac{m_j^1-m_j^2}{\sigma }$$\end{document}</tex-math><mml:math id="M422"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mi>σ</mml:mi></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq209.gif"/></alternatives></inline-formula>. The <italic>p</italic>-value of the <italic>j</italic>th variable (under null hypothesis) is<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} p_j(k)&amp;= P\left( |z|&gt;\frac{({{\varvec{\bar{x'}}}}_j^1-{{\varvec{\bar{x'}}}}_j^2)-(\mu _j^1-\mu _j^2)}{\sqrt{\frac{n_1+n_2}{n_1n_2}\sigma ^2}}\bigg \vert H_{0j}:\mu _j^1-\mu _j^2=0\right) \\&amp;=2P\left( z+\frac{{{\varvec{\bar{x}}}}_j^1-{{\varvec{\bar{x}}}}_j^2}{\sqrt{\frac{n_1+n_2}{n_1n_2}\sigma ^2}}&lt;0\right) \\&amp;= 2\Phi \left( -\sqrt{\frac{n_1n_2}{2(n_1+n_2)}}(1-\frac{n_1+n_2}{n_1n_2}k)\delta _j\right) , \end{aligned}$$\end{document}</tex-math><mml:math id="M424" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&gt;</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold">′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo mathvariant="bold">′</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em" stretchy="true">|</mml:mo></mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mi>z</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mo mathvariant="bold" stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">Φ</mml:mi><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:msqrt><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12859_2021_4061_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq210"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\le \lceil \frac{n_1n_2-1}{n_1+n_2+2} \rceil$$\end{document}</tex-math><mml:math id="M426"><mml:mrow><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mo>⌈</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq210.gif"/></alternatives></inline-formula>. <inline-formula id="IEq211"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Phi (\cdot )$$\end{document}</tex-math><mml:math id="M428"><mml:mrow><mml:mi mathvariant="normal">Φ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq211.gif"/></alternatives></inline-formula> denotes the cumulative function of standard normal distribution. Therefore, with the increase of exchanged labels <italic>k</italic>, <inline-formula id="IEq212"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M430"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq212.gif"/></alternatives></inline-formula>-value is smaller. As we perform two sided Z-tests in each scenario, the permutation results (<italic>p</italic>-values) are symmetric with respect to the fully mixing scenario <inline-formula id="IEq213"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_f=\lceil \frac{n_1n_2-1}{n_1+n_2+2} \rceil$$\end{document}</tex-math><mml:math id="M432"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>⌈</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq213.gif"/></alternatives></inline-formula>. Then we can obtain the <italic>p</italic>-value of the <italic>j</italic>th variable when <inline-formula id="IEq214"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=K_f,\ldots , K$$\end{document}</tex-math><mml:math id="M434"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq214.gif"/></alternatives></inline-formula> as <inline-formula id="IEq215"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_j(k)=2\Phi \left( \sqrt{\frac{n_1n_2}{2(n_1+n_2)}}\left(1-\frac{n_1+n_2}{n_1n_2}k\right)\delta _j\right)$$\end{document}</tex-math><mml:math id="M436"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">Φ</mml:mi><mml:mfenced close=")" open="("><mml:msqrt><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:msqrt><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mi>k</mml:mi></mml:mfenced><mml:msub><mml:mi>δ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq215.gif"/></alternatives></inline-formula>. <inline-formula id="IEq216"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p_j(k)$$\end{document}</tex-math><mml:math id="M438"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq216.gif"/></alternatives></inline-formula> decreases with <italic>k</italic> when <inline-formula id="IEq217"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0\le k\le K_f$$\end{document}</tex-math><mml:math id="M440"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq217.gif"/></alternatives></inline-formula> and increases with <italic>k</italic> when <inline-formula id="IEq218"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K_f\le k\le K$$\end{document}</tex-math><mml:math id="M442"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq218.gif"/></alternatives></inline-formula>.</p>
    <p id="Par42">For real-world data, the scaled sample mean difference <inline-formula id="IEq219"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta _j$$\end{document}</tex-math><mml:math id="M444"><mml:msub><mml:mi>δ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq219.gif"/></alternatives></inline-formula> takes a series of different numbers. For example, suppose that <inline-formula id="IEq220"><alternatives><tex-math id="M445">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_1=n_2=n$$\end{document}</tex-math><mml:math id="M446"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq220.gif"/></alternatives></inline-formula> and <inline-formula id="IEq221"><alternatives><tex-math id="M447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta _j$$\end{document}</tex-math><mml:math id="M448"><mml:msub><mml:mi>δ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq221.gif"/></alternatives></inline-formula> ranges from 0 to 2, then for <inline-formula id="IEq222"><alternatives><tex-math id="M449">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=0$$\end{document}</tex-math><mml:math id="M450"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq222.gif"/></alternatives></inline-formula>, the <italic>p</italic>-values <inline-formula id="IEq223"><alternatives><tex-math id="M451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_j(0)=2\Phi (-\frac{\sqrt{n}}{2}\delta _j)$$\end{document}</tex-math><mml:math id="M452"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">Φ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>δ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq223.gif"/></alternatives></inline-formula> will be distributed uniformly between 0 and 1. If we assume an extreme case that all the sample mean differences are the same and equal to 0 (<inline-formula id="IEq224"><alternatives><tex-math id="M453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta _j=0$$\end{document}</tex-math><mml:math id="M454"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq224.gif"/></alternatives></inline-formula>), indicating there is no group difference, all the <italic>p</italic>-values will be 1 across all permutation scenarios so that the curve of <inline-formula id="IEq225"><alternatives><tex-math id="M455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p$$\end{document}</tex-math><mml:math id="M456"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq225.gif"/></alternatives></inline-formula>-values and number of significant features will become a flat horizontal line at 0. We define <inline-formula id="IEq226"><alternatives><tex-math id="M457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{k}{K}$$\end{document}</tex-math><mml:math id="M458"><mml:mfrac><mml:mi>k</mml:mi><mml:mi>K</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq226.gif"/></alternatives></inline-formula> as the proportion of mixing. We let <inline-formula id="IEq227"><alternatives><tex-math id="M459">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_1=n_2=20$$\end{document}</tex-math><mml:math id="M460"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq227.gif"/></alternatives></inline-formula>. If we generate the sample data with group difference meaning that <inline-formula id="IEq228"><alternatives><tex-math id="M461">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta _j&gt;0$$\end{document}</tex-math><mml:math id="M462"><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq228.gif"/></alternatives></inline-formula>, then we can observe in Fig. <xref rid="Fig8" ref-type="fig">8</xref>, <inline-formula id="IEq229"><alternatives><tex-math id="M463">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\,\log _{10} p_j(k)$$\end{document}</tex-math><mml:math id="M464"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq229.gif"/></alternatives></inline-formula> is a U-Curve of <inline-formula id="IEq230"><alternatives><tex-math id="M465">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{k}{K}$$\end{document}</tex-math><mml:math id="M466"><mml:mfrac><mml:mi>k</mml:mi><mml:mi>K</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq230.gif"/></alternatives></inline-formula>. To simplify the the visualization, we assume all the <inline-formula id="IEq231"><alternatives><tex-math id="M467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta _j$$\end{document}</tex-math><mml:math id="M468"><mml:msub><mml:mi>δ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq231.gif"/></alternatives></inline-formula> are the same, so then the <italic>p</italic>-values are the same as well. If the differences of sample means are bigger, the U-Curve is steeper. If the standard deviation of the samples is bigger, the U-Curve is flatter. Therefore, the shape of the U-Curve measures how differential the quantifies of interest are between the two groups.<fig id="Fig8"><label>Fig. 8</label><caption><p>U-Curve plots of <italic>p</italic>-values calculated from formula (<xref rid="Equ4" ref-type="">4</xref>). Both of the sample sizes <inline-formula id="IEq232"><alternatives><tex-math id="M469">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_1$$\end{document}</tex-math><mml:math id="M470"><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq232.gif"/></alternatives></inline-formula> and <inline-formula id="IEq233"><alternatives><tex-math id="M471">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_2$$\end{document}</tex-math><mml:math id="M472"><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq233.gif"/></alternatives></inline-formula> are 20. x-axis is <inline-formula id="IEq234"><alternatives><tex-math id="M473">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{k}{K}$$\end{document}</tex-math><mml:math id="M474"><mml:mfrac><mml:mi>k</mml:mi><mml:mi>K</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq234.gif"/></alternatives></inline-formula>. In <bold>a</bold>, standard deviation <inline-formula id="IEq235"><alternatives><tex-math id="M475">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma$$\end{document}</tex-math><mml:math id="M476"><mml:mi>σ</mml:mi></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq235.gif"/></alternatives></inline-formula> is fixed at 2. In <bold>b</bold>, mean difference <inline-formula id="IEq236"><alternatives><tex-math id="M477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_j^1-m_j^2$$\end{document}</tex-math><mml:math id="M478"><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq236.gif"/></alternatives></inline-formula> is fixed at 1</p></caption><graphic xlink:href="12859_2021_4061_Fig8_HTML" id="MO12"/></fig></p>
  </sec>
  <sec id="Sec6">
    <title>Discussion</title>
    <p id="Par43">In this work, we propose a method for the analysis of microbiome data which progressively permutes a grouping factor and performs differential abundance tests in each scenario. To convey the overall association with the grouping factor, we summarize the resulting <italic>p</italic>-values by the number of significant hits. This number will exhibit a U-Curve across mixing depths if the overall association between the microbiome and the grouping factor is not zero. The AUMC provides a summary of the progressive permutation results, allowing for quantification of the overall signal strength, which is interestingly impacted by heterogeneity. Simulation results show that the shape of the U-Curve can quantify different levels of heterogeneity within data sets. If we have multiple grouping factors, we can rank their AUMCs by associating each grouping factor with the microbiome composition as a whole. In general, we recommend focusing on grouping factors with higher AUMC values for subsequent in-depth analysis.</p>
    <p id="Par44">Once we have decided on a grouping factor of interest, we may then seek to identify microbiome features which are robustly associated with the grouping factor. Based on the permutation results, we can rank all the microbiome features by their fragility index, where larger values of the fragility index correspond to more robust discoveries. We can identify potentially relevant microbiome features by comparing the <italic>p</italic>-values of the observed data with the confidence region of <italic>p</italic>-values for the fully mixed data. The simulation and real data application show that our proposed method can convey the overall association between microbiome compositions and outcomes of interest, rank the robustness of the discovered features, and identify robust individual hits.</p>
    <p id="Par45">Through simulations, we show that the signal strength of the observed features is controlled by several factors, including the proportion of zeros, mean difference, and variance. The correctness of the ordering of the signals is partly affected by the choice of test used to obtain <italic>p</italic>-values within each permutation setting. The Wilcoxon test is a nonparametric test, which takes into account the ranks of the abundances for each taxa. Although the ordering results are not perfect, we show through simulations that the proposed method can identify the differential features with a high accuracy rate. Our paper is mainly designed for the general exploration and visualization of microbiome data, and does not come with a formal inference method. The measures we propose, such as AOI or AUMC, are meant to be descriptive, but researchers could take the results generated from our method as a guide to help with identifying robust features. At this time, our method does not control the false discovery rate or calculate adjusted <italic>p</italic>-values. In future work, we will consider using the progressive permutation results to adjust the <italic>p</italic>-values by controlling the empirical Bayes false discovery rates.</p>
    <p id="Par46">To better understand the relationship between progressive permutation and hypothesis testing, we use the language of signal and noise to describe hypothesis testing. The null hypothesis can be identified as the case where the data contain only noise and no signal. The alternative hypothesis is the case where the data contain both important signals and noise [<xref ref-type="bibr" rid="CR26">26</xref>]. Progressive permutation progressively mixes the samples between two groups. With each increase of mixing, the proportion of signal decreases, while the proportion of noise increases. Therefore, the fully permuted data can be considered as realizations of the null hypothesis, while the observed data (without permutations) can be considered as a realization of the alternative hypothesis. Conceptually, progressive permutation connects the binary ends of hypothesis testing from the alternative hypothesis to the null hypothesis in a continuous manner. Therefore, the proposed method considers the signal identification problem as progressively singling out signals from permuted randomized versions of an original data set.</p>
    <p id="Par47">In this paper, we focus on linking microbiome composition with a binary outcome, creating a new framework to understand the significance and robustness of microbiome features. Following the same logic, we can extend the binary outcome to a continuous outcome. When constructing the progressive permutation scenarios, we permute a proportion (select <italic>k</italic> samples and calculate <inline-formula id="IEq237"><alternatives><tex-math id="M479">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{k}{n}$$\end{document}</tex-math><mml:math id="M480"><mml:mfrac><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:mfrac></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq237.gif"/></alternatives></inline-formula>) of the continuous outcome. In each scenario, we perform Kendall’s tau and Spearman’s rank correlation tests to associate microbiome compositions with the permuted continuous outcome. We then adopt similar procedures as in the binary outcome to summarize the permutation results. We have applied the progressive permutation with a continuous outcome to a sample data set (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Sect. S5).</p>
    <p id="Par48">We have developed these methods into user-friendly and efficient R Shiny tools with visualizations. In our implementation, we first perform differential testing of each feature, and then obtain the <inline-formula id="IEq238"><alternatives><tex-math id="M481">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\, \log _{10}p$$\end{document}</tex-math><mml:math id="M482"><mml:mrow><mml:mo>-</mml:mo><mml:mspace width="0.166667em"/><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2021_4061_Article_IEq238.gif"/></alternatives></inline-formula>-values from permutations of the data. By default, we use the Wilcoxon rank sum test to compute the <italic>p</italic>-values, since it is a robust nonparametric test. Our proposed method can also utilize <italic>p</italic>-values obtained from other testing methods, such as DESeq. This demonstrates the great potential of the progressive permutation method to be extended to new settings.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec7">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2021_4061_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1. Section S1</bold>: Mathematical notations. <bold>Section S2</bold>: Computational time. <bold>Section S3</bold>: Distribution of zeros. <bold>Section S4</bold>: Results of two permutation methods. <bold>Section S5</bold>: Results of continuous outcome.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>AOI</term>
        <def>
          <p id="Par4">Area of interest</p>
        </def>
      </def-item>
      <def-item>
        <term>AUMC</term>
        <def>
          <p id="Par5">Area under the mixing curve</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Christine B. Peterson and Robert R. Jenq have equal contributor</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Professor J. Jack Lee for providing us great suggestions on simulations, Norris Clift for helping us launch the Shiny App on the server <ext-link ext-link-type="uri" xlink:href="https://biostatistics.mdanderson.org/shinyapps/ProgPerm">https://biostatistics.mdanderson.org/shinyapps/ProgPerm</ext-link>.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors' contributions</title>
    <p>RJ conceived the study. RJ, CP and KD provided guidance for this project. LZ and RJ proposed the method. LZ implemented the simulation and methods. LZ analyzed the result with the help of YS, KD, CP and RJ. LZ wrote the manuscript with the help of CP and RJ. All authors have read and approved the manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>KAD is partially supported by MD Anderson Moon Shot Programs, Prostate Cancer SPORE P50CA140388, NIH/NCI CCSG Grant P30CA016672, CCTS 5UL1TR000371, and CPRIT RP160693 Grants. CBP is partially supported by NIH/NCI CCSG Grant P30CA016672 and MD Anderson Moon Shot Programs. RRJ is partially supported by NIH R01 HL124112 and CPRIT RR160089 Grants. The funders played no role in the design of the study, analysis of the data, or writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>Smits data were provided in association with the following publication: Smits et al. “Seasonal cycling in the gut microbiome of the Hadza hunter-gatherers of Tanzania”, <italic>Science</italic>. 2017;357(6353):802–806. The 16S rRNA amplicon sequence data and shotgun metagenomic data have been deposited in the Sequence Read Archive (SRA) under the project IDs PRJNA392012, PRJNA392180 (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/sra">www.ncbi.nlm.nih.gov/sra</ext-link>). DeFilippo data were provided in association with the following publication: De Filippo et al. “Impact of diet in shaping gut microbiota revealed by a comparative study in children from Europe and rural Africa”, <italic>Proceedings of the National Academy of Sciences</italic>. 2010;107(33):14691–14696. The 16S rRNA amplicon sequence data were submitted to the Sequence Read Archive (SRA) using ISA tools (ISAcreator and ISAconverter, <ext-link ext-link-type="uri" xlink:href="http://isatab.sourceforge.net/index.html">http://isatab.sourceforge.net/index.html</ext-link>). The dataset is available at <ext-link ext-link-type="uri" xlink:href="http://www.ebi.ac.uk/ena/data/view/ERP000133">http://www.ebi.ac.uk/ena/data/view/ERP000133</ext-link>. In addition, RShiny App is accessible at <ext-link ext-link-type="uri" xlink:href="https://biostatistics.mdanderson.org/shinyapps/ProgPerm">https://biostatistics.mdanderson.org/shinyapps/ProgPerm</ext-link>. R codes and example data are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/LyonsZhang/ProgPerm">https://github.com/LyonsZhang/ProgPerm</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par49">Not applicable.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par50">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par51">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Vrbanac</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>BC</given-names>
          </name>
          <name>
            <surname>Aksenov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Callewaert</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Debelius</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Best practices for analysing microbiomes</article-title>
        <source>Nat Rev Microbiol</source>
        <year>2018</year>
        <volume>16</volume>
        <issue>7</issue>
        <fpage>410</fpage>
        <pub-id pub-id-type="doi">10.1038/s41579-018-0029-9</pub-id>
        <pub-id pub-id-type="pmid">29795328</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jie</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhong</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The gut microbiome in atherosclerotic cardiovascular disease</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>845</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-00900-1</pub-id>
        <pub-id pub-id-type="pmid">29018189</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vogt</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Kerby</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Dill-McFarland</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Harding</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Merluzzi</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>SC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gut microbiome alterations in Alzheimer’s disease</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>13537</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-017-13601-y</pub-id>
        <pub-id pub-id-type="pmid">29051531</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cani</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Jordan</surname>
            <given-names>BF</given-names>
          </name>
        </person-group>
        <article-title>Gut microbiota-mediated inflammation in obesity: a link with gastrointestinal cancer</article-title>
        <source>Nat Rev Gastroenterol Hepatol</source>
        <year>2018</year>
        <volume>15</volume>
        <fpage>1</fpage>
        <pub-id pub-id-type="doi">10.1038/s41575-018-0025-6</pub-id>
        <pub-id pub-id-type="pmid">29184184</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Tao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Xiao</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shang</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Xiexin Tang improves the symptom of type 2 diabetic rats by modulation of the gut microbiota</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>3685</fpage>
        <pub-id pub-id-type="doi">10.1038/s41598-018-22094-2</pub-id>
        <pub-id pub-id-type="pmid">29487347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gopalakrishnan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Helmink</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Spencer</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>Reuben</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wargo</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>The influence of the gut microbiome on cancer, immunity, and cancer immunotherapy</article-title>
        <source>Cancer Cell</source>
        <year>2018</year>
        <volume>33</volume>
        <issue>4</issue>
        <fpage>570</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ccell.2018.03.015</pub-id>
        <pub-id pub-id-type="pmid">29634945</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ong</surname>
            <given-names>IM</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>McIlwain</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Sawin</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Schoen</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Adluru</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gut microbiome populations are associated with structure-specific changes in white matter architecture</article-title>
        <source>Transl Psychiatry</source>
        <year>2018</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>6</fpage>
        <pub-id pub-id-type="doi">10.1038/s41398-017-0022-5</pub-id>
        <pub-id pub-id-type="pmid">29317592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Riquelme</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Montiel</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zoltan</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tumor microbiome diversity and composition influence pancreatic cancer outcomes</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>178</volume>
        <issue>4</issue>
        <fpage>795</fpage>
        <lpage>806</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.07.008</pub-id>
        <pub-id pub-id-type="pmid">31398337</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paulson</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Stine</surname>
            <given-names>OC</given-names>
          </name>
          <name>
            <surname>Bravo</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Pop</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Differential abundance analysis for microbial marker-gene surveys</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <issue>12</issue>
        <fpage>1200</fpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2658</pub-id>
        <pub-id pub-id-type="pmid">24076764</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>550</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mandal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Van Treuren</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Eggesbø</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Peddada</surname>
            <given-names>SD</given-names>
          </name>
        </person-group>
        <article-title>Analysis of composition of microbiomes: a novel method for studying microbial composition</article-title>
        <source>Microbial Ecol Health Dis</source>
        <year>2015</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>27663</fpage>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fernandes</surname>
            <given-names>AD</given-names>
          </name>
          <name>
            <surname>Reid</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Macklaim</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>McMurrough</surname>
            <given-names>TA</given-names>
          </name>
          <name>
            <surname>Edgell</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Gloor</surname>
            <given-names>GB</given-names>
          </name>
        </person-group>
        <article-title>Unifying the analysis of high-throughput sequencing datasets: characterizing RNA-seq, 16S rRNA gene sequencing and selective growth experiments by compositional data analysis</article-title>
        <source>Microbiome</source>
        <year>2014</year>
        <volume>2</volume>
        <issue>1</issue>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/2049-2618-2-15</pub-id>
        <pub-id pub-id-type="pmid">24910773</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segata</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Izard</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Waldron</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Gevers</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Miropolsky</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Garrett</surname>
            <given-names>WS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Metagenomic biomarker discovery and explanation</article-title>
        <source>Genome Biol</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>6</issue>
        <fpage>R60</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2011-12-6-r60</pub-id>
        <pub-id pub-id-type="pmid">21702898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goeman</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Solari</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Multiple hypothesis testing in genomics</article-title>
        <source>Stat Med</source>
        <year>2014</year>
        <volume>33</volume>
        <issue>11</issue>
        <fpage>1946</fpage>
        <lpage>1978</lpage>
        <pub-id pub-id-type="doi">10.1002/sim.6082</pub-id>
        <pub-id pub-id-type="pmid">24399688</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Amir</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Morton</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Heller</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Arias-Castro</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Knight</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Discrete false-discovery rate improves identification of differentially abundant microbes</article-title>
        <source>MSystems</source>
        <year>2017</year>
        <volume>2</volume>
        <issue>6</issue>
        <fpage>e00092-17</fpage>
        <pub-id pub-id-type="doi">10.1128/mSystems.00092-17</pub-id>
        <pub-id pub-id-type="pmid">29181446</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Walsh</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Srinathan</surname>
            <given-names>SK</given-names>
          </name>
          <name>
            <surname>McAuley</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Mrkobrada</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Ribic</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The statistical significance of randomized controlled trial results is frequently fragile: a case for a Fragility Index</article-title>
        <source>J Clin Epidemiol</source>
        <year>2014</year>
        <volume>67</volume>
        <issue>6</issue>
        <fpage>622</fpage>
        <lpage>628</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jclinepi.2013.10.019</pub-id>
        <pub-id pub-id-type="pmid">24508144</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Feinstein</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>The unit fragility index: an additional appraisal of “statistical significance” for a contrast of two proportions</article-title>
        <source>J Clin Epidemiol</source>
        <year>1990</year>
        <volume>43</volume>
        <issue>2</issue>
        <fpage>201</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1016/0895-4356(90)90186-S</pub-id>
        <pub-id pub-id-type="pmid">2303850</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smirnova</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Huzurbazar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jafari</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>PERFect: PERmutation filtering test for microbiome data</article-title>
        <source>Biostatistics</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>615</fpage>
        <lpage>631</lpage>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxy020</pub-id>
        <pub-id pub-id-type="pmid">29917060</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Differential expression analysis for sequence count data</article-title>
        <source>Nat Proc</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>1</fpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hawinkel</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mattiello</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Bijnens</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Thas</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>A broken promise: microbiome differential abundance methods do not control the false discovery rate</article-title>
        <source>Brief Bioinform</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>1</issue>
        <fpage>210</fpage>
        <lpage>221</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bbx104</pub-id>
        <pub-id pub-id-type="pmid">28968702</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <mixed-citation publication-type="other">Owen AB. Monte Carlo theory, methods and examples; 2013. <ext-link ext-link-type="uri" xlink:href="https://statweb.stanford.edu/%7eowen/mc/">https://statweb.stanford.edu/~owen/mc/</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cox</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Cox</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <source>Multidimensional scaling</source>
        <year>2000</year>
        <publisher-loc>London</publisher-loc>
        <publisher-name>Chapman and Hall</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smits</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Leach</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sonnenburg</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Gonzalez</surname>
            <given-names>CG</given-names>
          </name>
          <name>
            <surname>Lichtman</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Reid</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Seasonal cycling in the gut microbiome of the Hadza hunter-gatherers of Tanzania</article-title>
        <source>Science</source>
        <year>2017</year>
        <volume>357</volume>
        <issue>6353</issue>
        <fpage>802</fpage>
        <lpage>806</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aan4834</pub-id>
        <pub-id pub-id-type="pmid">28839072</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>De Filippo</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Cavalieri</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Di Paola</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ramazzotti</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Poullet</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Massart</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Impact of diet in shaping gut microbiota revealed by a comparative study in children from Europe and rural Africa</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2010</year>
        <volume>107</volume>
        <issue>33</issue>
        <fpage>14691</fpage>
        <lpage>14696</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1005963107</pub-id>
        <pub-id pub-id-type="pmid">20679230</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Carlin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Doyle</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Statistics for clinicians: 4: basic concepts of statistical reasoning: hypothesis tests and the t-test</article-title>
        <source>J Paediatr Child Health</source>
        <year>2001</year>
        <volume>37</volume>
        <issue>1</issue>
        <fpage>72</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1046/j.1440-1754.2001.00634.x</pub-id>
        <pub-id pub-id-type="pmid">11168875</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
