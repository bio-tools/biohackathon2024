<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9665859</article-id>
    <article-id pub-id-type="pmid">36193999</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac662</article-id>
    <article-id pub-id-type="publisher-id">btac662</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title><italic toggle="yes">statgenMPP</italic>: an R package implementing an IBD-based mixed model approach for QTL mapping in a wide range of multi-parent populations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-5719-5775</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Wenhao</given-names>
        </name>
        <aff><institution>Biometris, Wageningen University and Research Center</institution>, Wageningen, 6700 AC, <country country="NL">The Netherlands</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Boer</surname>
          <given-names>Martin P</given-names>
        </name>
        <aff><institution>Biometris, Wageningen University and Research Center</institution>, Wageningen, 6700 AC, <country country="NL">The Netherlands</country></aff>
        <xref rid="btac662-cor1" ref-type="corresp"/>
        <!--martin.boer@wur.nl-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>van Rossum</surname>
          <given-names>Bart-Jan</given-names>
        </name>
        <aff><institution>Biometris, Wageningen University and Research Center</institution>, Wageningen, 6700 AC, <country country="NL">The Netherlands</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6030-3933</contrib-id>
        <name>
          <surname>Zheng</surname>
          <given-names>Chaozhi</given-names>
        </name>
        <aff><institution>Biometris, Wageningen University and Research Center</institution>, Wageningen, 6700 AC, <country country="NL">The Netherlands</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Joosen</surname>
          <given-names>Ronny V L</given-names>
        </name>
        <aff><institution>Rijk Zwaan Breeding B.V.</institution>, De Lier 2678 ZG, <country country="NL">The Netherlands</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>van Eeuwijk</surname>
          <given-names>Fred A</given-names>
        </name>
        <aff><institution>Biometris, Wageningen University and Research Center</institution>, Wageningen, 6700 AC, <country country="NL">The Netherlands</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac662-cor1">To whom correspondence should be addressed. Email: <email>martin.boer@wur.nl</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-10-04">
      <day>04</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>10</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>22</issue>
    <fpage>5134</fpage>
    <lpage>5136</lpage>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>28</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>10</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>18</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac662.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Multi-parent populations (MPPs) are popular for QTL mapping because they combine wide genetic diversity in parents with easy control of population structure, but a limited number of software tools for QTL mapping are specifically developed for general MPP designs.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed an R package called <italic toggle="yes">statgenMPP</italic>, adopting a unified identity-by-descent (IBD)-based mixed model approach for QTL analysis in MPPs. The package offers easy-to-use functionalities of IBD calculations, mixed model solutions and visualizations for QTL mapping in a wide range of MPP designs, including diallele, nested-association mapping populations, multi-parent advanced genetic inter-cross populations and other complicated MPPs with known crossing schemes.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The R package <italic toggle="yes">statgenMPP</italic> is open-source and freely available on CRAN at <ext-link xlink:href="https://CRAN.R-project.org/package=statgenMPP" ext-link-type="uri">https://CRAN.R-project.org/package=statgenMPP</ext-link></p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Rijk Zwaan Breeding B.V.</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Multi-parent population (MPP) designs capture wide genetic diversity and overcome the drawbacks of low minor-allele frequencies and population structures (<xref rid="btac662-B1" ref-type="bibr">Arrones <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac662-B12" ref-type="bibr">Scott <italic toggle="yes">et al.</italic>, 2020</xref>). General MPPs, e.g. diallele (<xref rid="btac662-B4" ref-type="bibr">Coles <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btac662-B7" ref-type="bibr">Giraud <italic toggle="yes">et al.</italic>, 2017</xref>), NAM (<xref rid="btac662-B19" ref-type="bibr">Yu <italic toggle="yes">et al.</italic>, 2008</xref>) and MAGIC (<xref rid="btac662-B5" ref-type="bibr">Gardner <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btac662-B8" ref-type="bibr">Huang <italic toggle="yes">et al.</italic>, 2015</xref>) are nowadays widely used in genetic studies and plant breeding programs. Statistical models that can be used for MPP designs are either family-based (linkage mapping) or population-based (linkage disequilibrium) methods (<xref rid="btac662-B6" ref-type="bibr">Giraud <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btac662-B16" ref-type="bibr">Würschum <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btac662-B18" ref-type="bibr">Xu <italic toggle="yes">et al.</italic>, 2017</xref>), but a limited number of software tools is specifically developed for MPP designs.</p>
    <p>In this Application Note, we present an easy-to-use R package, <italic toggle="yes">statgenMPP</italic>, adopting an identity-by-descent (IBD)-based mixed model approach for QTL mapping. Compared to other tools, <italic toggle="yes">statgenMPP</italic> integrates a framework of IBD calculation (<xref rid="btac662-B3" ref-type="bibr">Boer and van Rossum, 2021b</xref>; <xref rid="btac662-B20" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2014</xref>, <xref rid="btac662-B22" ref-type="bibr">2015</xref>) with linear mixed models (<xref rid="btac662-B2" ref-type="bibr">Boer and van Rossum, 2021a</xref>). The IBD-based mixed model approach estimates random QTL effects in relation to IBD probabilities of parental origins across the offspring genome (<xref rid="btac662-B9" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac662-B15" ref-type="bibr">Wei and Xu, 2016</xref>) while accounting for polygenic and family background genetic variation, which has been proven to increase the mapping power and resolution of QTLs for simulated and empirical MPPs (<xref rid="btac662-B9" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2021</xref>). Single crosses can also be analyzed with <italic toggle="yes">statgenMPP</italic>, for a full list of available population types, see <xref rid="btac662-B3" ref-type="bibr">Boer and van Rossum (2021b)</xref>.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p><xref rid="btac662-F1" ref-type="fig">Figure 1a</xref> demonstrates the workflow of IBD-based QTL mapping using <italic toggle="yes">statgenMPP</italic> that comprises two main steps: IBD calculation and QTL mapping.</p>
    <fig position="float" id="btac662-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>(<bold>a</bold>) The workflow of IBD-based QTL mapping implemented in statgenMPP. QTL mapping in the examples of (<bold>b</bold>) soybean NAM design for seed weight and (<bold>c</bold>) barley complex design for awn length. Upper panel pedigree plots of MPP designs. Middle panel QTL mapping profiles expressed at −log10(p) scale. Lower panel parental QTL effects</p>
      </caption>
      <graphic xlink:href="btac662f1" position="float"/>
    </fig>
    <sec>
      <title>2.1 IBD calculation</title>
      <p>The framework of hidden Markov models (HMM) and inheritance vectors (<xref rid="btac662-B20" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2014</xref>, <xref rid="btac662-B22" ref-type="bibr">2015</xref>; <xref rid="btac662-B3" ref-type="bibr">Boer and van Rossum, 2021b</xref>) is employed for the IBD calculation. For a wide range of MPP designs, IBD probabilities are calculated by the function <italic toggle="yes">calcIBDMPP()</italic> at a customizable grid (cM) for the specified population type. For complex MAGIC designs and designs with complicated pedigree structures, the IBD probabilities can be first calculated using RABBIT (<xref rid="btac662-B21" ref-type="bibr">Zheng, 2019</xref>) and then imported by the function <italic toggle="yes">readRABBITMPP()</italic>.</p>
    </sec>
    <sec>
      <title>2.2 QTL mapping</title>
      <p>IBD probabilities between parents and offspring, as design vectors, or genetic predictors, are fitted in a mixed model for QTL mapping using the function <italic toggle="yes">selQTLMPP()</italic>. The IBD-based mixed model approach is described by <xref rid="btac662-B9" ref-type="bibr">Li <italic toggle="yes">et al.</italic> (2021)</xref>. To test each position on a 1D grid along the genome, a single locus QTL model is fitted whose effects are modeled as random in a mixed effects model:
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:menclose notation="bottom"><mml:mi>Y</mml:mi></mml:menclose><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mo>β</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:munder accentunder="true"><mml:msub><mml:mi>a</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>_</mml:mo></mml:munder><mml:mo>+</mml:mo><mml:menclose notation="bottom"><mml:mi>g</mml:mi></mml:menclose><mml:mo>+</mml:mo><mml:munder accentunder="true"><mml:mi>ε</mml:mi><mml:mo>_</mml:mo></mml:munder></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder accentunder="true"><mml:msub><mml:mi>a</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>_</mml:mo></mml:munder><mml:mo>∼</mml:mo><mml:mi mathvariant="italic">MVN</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:munder accentunder="true"><mml:mi>g</mml:mi><mml:mo>_</mml:mo></mml:munder><mml:mo>∼</mml:mo><mml:mi mathvariant="italic">MVN</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:msubsup><mml:mo>σ</mml:mo><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:munder><mml:mo>ε</mml:mo><mml:mo>¯</mml:mo></mml:munder><mml:mo>∼</mml:mo><mml:mi mathvariant="italic">MVN</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mo>⊕</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>F</mml:mi></mml:msubsup><mml:msub><mml:mi>I</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msub><mml:msubsup><mml:mo>σ</mml:mo><mml:msub><mml:mo>ε</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula><inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>Y</mml:mi></mml:math></inline-formula> is a vector with phenotypes; <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>X</mml:mi></mml:math></inline-formula> is the design matrix indicating to which family each individual belongs; <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> is a vector of fixed family intercepts; <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the design matrix containing the expected number of parental alleles as a function of IBD probabilities; <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the vector of random parental effects with the variance–covariance (VCOV) structure <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>, in which <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo></mml:math></inline-formula>is the identity matrix for P parents and <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> is the genetic variance of the QTL effects; it is optional to include a polygenic term g whose VCOV is described by the kinship matrix K; the residual term ε has a family-specific VCOV structure <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>⊕</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>F</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ε</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> in which <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>ε</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> is the residual variance of individuals in the <italic toggle="yes">k</italic>th family <inline-formula id="IE9000"><mml:math id="IM9000" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>with family size <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
      <p>The linear mixed model is fitted and variance components are estimated based on restricted maximum likelihood. Variance components corresponding to putative QTLs (<inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula> versus <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>) are evaluated by likelihood ratio tests (LRT) that approximate a mixture of <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> distributions (<xref rid="btac662-B13" ref-type="bibr">Self and Liang, 1987</xref>). Multiple rounds of genome QTL scans can be performed until either (i) no new QTL outside of a certain window size is found with a −log10(p) value below a predefined threshold or (ii) a predefined maximum number of QTLs is reached.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Applications</title>
    <p>We demonstrate the main functionalities of <italic toggle="yes">statgenMPP</italic> using two publicly available MPP designs—a soybean NAM design and a barley complex design (datasets are provided in the <xref rid="sup1" ref-type="supplementary-material">supplementary material</xref> with R codes). Other examples with full details are available in the vignette of <italic toggle="yes">statgenMPP</italic>.</p>
    <p>All computations were performed in (64-bit) R 4.2.1 (<xref rid="btac662-B11" ref-type="bibr">R Core Team, 2022</xref>) and a 3.10 GHz Intel Core i5 processor computer with 16GB of RAM and Windows 10 operating system. We used the parallel option of <italic toggle="yes">statgenMPP</italic> using four cores, and using the default values, not including a kinship matrix.</p>
    <p>We selected six families (<xref rid="btac662-F1" ref-type="fig">Fig. 1b</xref>, upper panel) with a total population size of 732 genotypes from the soybean NAM project (<ext-link xlink:href="https://soybase.org/SoybeanNAM/index.php" ext-link-type="uri">https://soybase.org/SoybeanNAM/index.php</ext-link>) (<xref rid="btac662-B17" ref-type="bibr">Xavier <italic toggle="yes">et al.</italic>, 2018</xref>) for analysis to demonstrate the functionalities of <italic toggle="yes">statgenMPP</italic>. The consensus map containing 4289 markers (<xref rid="btac662-B14" ref-type="bibr">Song <italic toggle="yes">et al.</italic>, 2017</xref>) was used to calculate IBD probabilities on a regular 5 cM grid of evaluation points. We map QTLs for the trait of seed weight (‘mean_seedWT’) as an example. The total computation time was 1.03 min. The second example is a complex barley MPP design (<xref rid="btac662-B10" ref-type="bibr">Liller <italic toggle="yes">et al.</italic>, 2017</xref>), with a total population size of 916 genotypes, for QTL mapping for awn length (‘Awn_length’) (<xref rid="btac662-F1" ref-type="fig">Fig. 1c</xref>, upper panel). The total computation time was 1.43 min. IBD calculation for the complex design was performed by RABBIT, and then the output was imported by the <italic toggle="yes">readRABBITMPP()</italic> function in <italic toggle="yes">statgenMPP</italic>.</p>
    <p>Results of QTL mapping for soybean NAM and barley complex MPP designs are shown in <xref rid="btac662-F1" ref-type="fig">Figure 1b and c</xref>. For example in the barley complex design, all QTLs for awn length in the barley complex design can be confirmed from the previous study where the strong QTL on chromosome 7 was successfully fine mapped (<xref rid="btac662-B10" ref-type="bibr">Liller <italic toggle="yes">et al.</italic>, 2017</xref>). Further details on how to use the package for visualization can be found in the <italic toggle="yes">statgenMPP</italic> vignette.</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>An increasing range and number of MPP designs become available for QTL mapping in breeding programs and genetic studies. We introduce the R package <italic toggle="yes">statgenMPP</italic> that covers the demands for versatile QTL analysis in MPP designs. <italic toggle="yes">statgenMPP</italic> contains a unified IBD-based mixed model framework for mapping multi-allelic QTLs. We analyzed multiple MPP data sets with <italic toggle="yes">statgenMPP</italic>, whose data are available within the package, and demonstrated the theoretical and practical advantages of our approach. Extensions of <italic toggle="yes">statgenMPP</italic> will deal with epistasis, pleiotropy and QTL-by-environment analysis, to allow the user to explore the full potential of MPP designs.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac662_Supplementary_Data</label>
      <media xlink:href="btac662_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank two reviewers and the Associate Editor for their helpful comments.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by Rijk Zwaan Breeding B.V.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: The authors declare that they do not have any conflict of interest.</p>
    </sec>
  </ack>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>All data are incorporated into the article and its online supplementary material.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac662-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arrones</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>The dawn of the age of multi-parent magic populations in plant breeding: novel powerful next-generation resources for genetic analysis and selection of recombinant elite material</article-title>. <source>Biology (Basel)</source>, <volume>9</volume>, <fpage>229</fpage>.</mixed-citation>
    </ref>
    <ref id="btac662-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Boer</surname><given-names>M.P.</given-names></string-name>, <string-name><surname>van Rossum</surname><given-names>B.</given-names></string-name></person-group> (<year>2021a</year>) <italic toggle="yes">LMMsolver: Linear Mixed Model Solver</italic>. <ext-link xlink:href="https://CRAN.R-project.org/package=LMMsolver" ext-link-type="uri">https://CRAN.R-project.org/package=LMMsolver</ext-link></mixed-citation>
    </ref>
    <ref id="btac662-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Boer</surname><given-names>M.P.</given-names></string-name>, <string-name><surname>van Rossum</surname><given-names>B.</given-names></string-name></person-group> (<year>2021b</year>) <italic toggle="yes">statgenIBD: Calculation of IBD Probabilities</italic>. <ext-link xlink:href="https://CRAN.R-project.org/package=statgenIBD" ext-link-type="uri">https://CRAN.R-project.org/package=statgenIBD</ext-link></mixed-citation>
    </ref>
    <ref id="btac662-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Coles</surname><given-names>N.D.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Genetic control of photoperiod sensitivity in maize revealed by joint multiple population analysis</article-title>. <source>Genetics</source>, <volume>184</volume>, <fpage>799</fpage>–<lpage>812</lpage>.<pub-id pub-id-type="pmid">20008571</pub-id></mixed-citation>
    </ref>
    <ref id="btac662-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gardner</surname><given-names>K.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>A highly recombined, high-density, eight-founder wheat MAGIC map reveals extensive segregation distortion and genomic locations of introgression segments</article-title>. <source>Plant Biotechnol. J</source>., <volume>14</volume>, <fpage>1406</fpage>–<lpage>1417</lpage>.<pub-id pub-id-type="pmid">26801965</pub-id></mixed-citation>
    </ref>
    <ref id="btac662-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Giraud</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Linkage disequilibrium with linkage analysis of multiline crosses reveals different multiallelic QTL for hybrid performance in the flint and dent heterotic groups of maize</article-title>. <source>Genetics</source>, <volume>198</volume>, <fpage>1717</fpage>–<lpage>1734</lpage>.<pub-id pub-id-type="pmid">25271305</pub-id></mixed-citation>
    </ref>
    <ref id="btac662-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Giraud</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Reciprocal genetics: identifying QTL for general and specific combining abilities in hybrids between multiparental populations from two maize (<italic toggle="yes">Zea mays</italic> L.) heterotic groups</article-title>. <source>Genetics</source>, <volume>207</volume>, <fpage>1167</fpage>–<lpage>1180</lpage>.<pub-id pub-id-type="pmid">28971957</pub-id></mixed-citation>
    </ref>
    <ref id="btac662-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>B.E.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>MAGIC populations in crops: current status and future prospects</article-title>. <source>Theor. Appl. Genet</source>., <volume>128</volume>, <fpage>999</fpage>–<lpage>1017</lpage>.<pub-id pub-id-type="pmid">25855139</pub-id></mixed-citation>
    </ref>
    <ref id="btac662-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>W.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>An IBD-based mixed model approach for QTL mapping in multiparental populations</article-title>. <source>Theor. Appl. Genet</source>, <volume>1</volume>, <fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
    </ref>
    <ref id="btac662-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liller</surname><given-names>C.B.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Fine mapping of a major QTL for awn length in barley using a multiparent mapping population</article-title>. <source>Theor. Appl. Genet</source>., <volume>130</volume>, <fpage>269</fpage>–<lpage>281</lpage>.<pub-id pub-id-type="pmid">27734096</pub-id></mixed-citation>
    </ref>
    <ref id="btac662-B11">
      <mixed-citation publication-type="other"><collab>R Core Team</collab> (<year>2022</year>) <italic toggle="yes">R: A Language and Environment for Statistical Computing</italic>.</mixed-citation>
    </ref>
    <ref id="btac662-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scott</surname><given-names>M.F.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Multi-parent populations in crops: a toolbox integrating genomics and genetic mapping with breeding</article-title>. <source>Heredity (Edinb)</source>, <volume>125</volume>, <fpage>396</fpage>–<lpage>416</lpage>.<pub-id pub-id-type="pmid">32616877</pub-id></mixed-citation>
    </ref>
    <ref id="btac662-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Self</surname><given-names>S.G.</given-names></string-name>, <string-name><surname>Liang</surname><given-names>K.Y.</given-names></string-name></person-group> (<year>1987</year>) <article-title>Asymptotic properties of maximum likelihood estimators and likelihood ratio tests under nonstandard conditions</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>82</volume>, <fpage>605</fpage>–<lpage>610</lpage>.</mixed-citation>
    </ref>
    <ref id="btac662-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>Q.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Genetic characterization of the soybean nested association mapping population</article-title>. <source>Plant Genome</source>, <volume>10</volume>(2).</mixed-citation>
    </ref>
    <ref id="btac662-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname><given-names>J.</given-names></string-name>, <string-name><surname>Xu</surname><given-names>S.</given-names></string-name></person-group> (<year>2016</year>) <article-title>A random-model approach to QTL mapping in multiparent advanced generation intercross (MAGIC) populations</article-title>. <source>Genetics</source>, <volume>202</volume>, <fpage>471</fpage>–<lpage>486</lpage>.<pub-id pub-id-type="pmid">26715662</pub-id></mixed-citation>
    </ref>
    <ref id="btac662-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Würschum</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Comparison of biometrical models for joint linkage association mapping</article-title>. <source>Heredity (Edinb.)</source>, <volume>108</volume>, <fpage>332</fpage>–<lpage>340</lpage>.<pub-id pub-id-type="pmid">21878984</pub-id></mixed-citation>
    </ref>
    <ref id="btac662-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xavier</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Genome-wide analysis of grain yield stability and environmental interactions in a multiparental soybean population</article-title>. <source>G3 Genes Genomes, Genet</source>., <volume>8</volume>, <fpage>519</fpage>–<lpage>529</lpage>.</mixed-citation>
    </ref>
    <ref id="btac662-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Genetic mapping of quantitative trait loci in crops</article-title>. <source>Crop J</source>, <volume>5</volume>, <fpage>175</fpage>–<lpage>184</lpage>.</mixed-citation>
    </ref>
    <ref id="btac662-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2008</year>) <article-title>Genetic design and statistical power of nested association mapping in maize</article-title>. <source>Genetics</source>, <volume>178</volume>, <fpage>539</fpage>–<lpage>551</lpage>.<pub-id pub-id-type="pmid">18202393</pub-id></mixed-citation>
    </ref>
    <ref id="btac662-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>A general modeling framework for genome ancestral origins in multiparental populations</article-title>. <source>Genetics</source>, <volume>198</volume>, <fpage>87</fpage>–<lpage>101</lpage>.<pub-id pub-id-type="pmid">25236451</pub-id></mixed-citation>
    </ref>
    <ref id="btac662-B21">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>C.</given-names></string-name></person-group> (<year>2019</year>) <italic toggle="yes">RABBIT (v3.2) Manual Book</italic>. <ext-link xlink:href="https://github.com/chaozhi/RABBIT" ext-link-type="uri">https://github.com/chaozhi/RABBIT</ext-link></mixed-citation>
    </ref>
    <ref id="btac662-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>Reconstruction of genome ancestry blocks in multiparental populations</article-title>. <source>Genetics</source>, <volume>200</volume>, <fpage>1073</fpage>–<lpage>1087</lpage>.<pub-id pub-id-type="pmid">26048018</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
