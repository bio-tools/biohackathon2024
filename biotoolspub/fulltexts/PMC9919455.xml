<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9919455</article-id>
    <article-id pub-id-type="pmid">36734597</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad070</article-id>
    <article-id pub-id-type="publisher-id">btad070</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Structural Bioinformatics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A unified approach to protein domain parsing with inter-residue distance matrix</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Kun</given-names>
        </name>
        <aff><institution>School of Mathematical Sciences, Nankai University</institution>, Tianjin 300071, <country country="CN">China</country></aff>
        <xref rid="btad070-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Su</surname>
          <given-names>Hong</given-names>
        </name>
        <aff><institution>School of Mathematical Sciences, Nankai University</institution>, Tianjin 300071, <country country="CN">China</country></aff>
        <xref rid="btad070-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-0303-6693</contrib-id>
        <name>
          <surname>Peng</surname>
          <given-names>Zhenling</given-names>
        </name>
        <aff><institution>Ministry of Education Frontiers Science Center for Nonlinear Expectations, Research Center for Mathematics and Interdisciplinary Sciences, Shandong University</institution>, Qingdao 266237, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2912-7737</contrib-id>
        <name>
          <surname>Yang</surname>
          <given-names>Jianyi</given-names>
        </name>
        <aff><institution>Ministry of Education Frontiers Science Center for Nonlinear Expectations, Research Center for Mathematics and Interdisciplinary Sciences, Shandong University</institution>, Qingdao 266237, <country country="CN">China</country></aff>
        <xref rid="btad070-cor1" ref-type="corresp"/>
        <!--yangjy@sdu.edu.cn-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Cowen</surname>
          <given-names>Lenore</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="btad070-FM1">
        <p>The authors wish it to be known that, in their opinion, Kun Zhu and Hong Su should be regarded as Joint First Authors.</p>
      </fn>
      <corresp id="btad070-cor1">To whom correspondence should be addressed. E-mail: <email>yangjy@sdu.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-02-03">
      <day>03</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>03</day>
      <month>2</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>2</issue>
    <elocation-id>btad070</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>30</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>01</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>11</day>
        <month>2</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad070.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>It is fundamental to cut multi-domain proteins into individual domains, for precise domain-based structural and functional studies. In the past, sequence-based and structure-based domain parsing was carried out independently with different methodologies. The recent progress in deep learning-based protein structure prediction provides the opportunity to unify sequence-based and structure-based domain parsing.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Based on the inter-residue distance matrix, which can be either derived from the input structure or predicted by trRosettaX, we can decode the domain boundaries under a unified framework. We name the proposed method UniDoc. The principle of UniDoc is based on the well-accepted physical concept of maximizing intra-domain interaction while minimizing inter-domain interaction. Comprehensive tests on five benchmark datasets indicate that UniDoc outperforms other state-of-the-art methods in terms of both accuracy and speed, for both sequence-based and structure-based domain parsing. The major contribution of UniDoc is providing a unified framework for structure-based and sequence-based domain parsing. We hope that UniDoc would be a convenient tool for protein domain analysis.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="https://yanglab.nankai.edu.cn/UniDoc/" ext-link-type="uri">https://yanglab.nankai.edu.cn/UniDoc/</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China (NSFC)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>T2225007</award-id>
        <award-id>T2222012</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The protein domain is defined as the basic unit of proteins, which can fold and carry out biological functions independently (<xref rid="btad070-B22" ref-type="bibr">Wetlaufer, 1973</xref>). Decomposition of multi-domain proteins into domains is fundamental for precise domain-based structure prediction and functional characterizations. To decompose the protein structures in the Protein Data Bank (PDB) (<xref rid="btad070-B2" ref-type="bibr">Berman <italic toggle="yes">et al.</italic>, 2000</xref>), a few structure-based domain databases were developed, including SCOP (<xref rid="btad070-B16" ref-type="bibr">Murzin <italic toggle="yes">et al.</italic>, 1995</xref>), CATH (<xref rid="btad070-B17" ref-type="bibr">Orengo <italic toggle="yes">et al.</italic>, 1997</xref>) and ECOD (<xref rid="btad070-B4" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic>, 2014</xref>). It is non-trivial to decompose protein structures into domains, especially when the boundaries are blurred (<xref rid="btad070-B18" ref-type="bibr">Postic <italic toggle="yes">et al.</italic>, 2017</xref>). For example, manual annotations are conducted in the construction of the SCOP databases.</p>
    <p>A few automated algorithms were developed to decompose protein structures into domains. PDP (<xref rid="btad070-B1" ref-type="bibr">Alexandrov and Shindyalov, 2003</xref>) is one of the widely used programs that maximize intra-domain interactions while minimizing inter-domain interactions. DomainParser (<xref rid="btad070-B9" ref-type="bibr">Guo <italic toggle="yes">et al.</italic>, 2003</xref>) uses a graph-theoretic approach to formulate the domain decomposition problem as a network flow problem. DDOMAIN (<xref rid="btad070-B25" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic>, 2007</xref>) divides protein into domains using a normalized contact-based domain–domain interaction profile. SWORD (<xref rid="btad070-B18" ref-type="bibr">Postic <italic toggle="yes">et al.</italic>, 2017</xref>) aims at cutting protein structure into alternative domains, using a hierarchical clustering procedure to combine the protein units. However, the application of this method can be limited by its slower speed. These methods tend to overcut protein domains and the original secondary structure may be destroyed after domain decomposition. <xref rid="btad070-B7" ref-type="bibr">Eguchi and Huang (2020)</xref> trained a convolutional neural network model for performing semantic segmentation of protein structures. Although this method is designed to solve a classification problem that is distinct from domain parsing, the architecture can be adapted to perform domain parsing with comparable performance to, e.g. SWORD and PDP.</p>
    <p>As many proteins do not have experimental structures, another closely related research is the sequence-based prediction of the domain boundaries. Many methods have been developed for this purpose, including ThreaDom (<xref rid="btad070-B23" ref-type="bibr">Xue <italic toggle="yes">et al.</italic>, 2013</xref>), DOMPro (<xref rid="btad070-B5" ref-type="bibr">Cheng <italic toggle="yes">et al.</italic>, 2006</xref>), ConDo (<xref rid="btad070-B11" ref-type="bibr">Hong <italic toggle="yes">et al.</italic>, 2019</xref>), and DNN-dom (<xref rid="btad070-B19" ref-type="bibr">Shi <italic toggle="yes">et al.</italic>, 2019</xref>), CHOP (<xref rid="btad070-B14" ref-type="bibr">Liu and Rost, 2004</xref>), FIEFDOM (<xref rid="btad070-B3" ref-type="bibr">Bondugula <italic toggle="yes">et al.</italic>, 2009</xref>), FUpred (<xref rid="btad070-B24" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2020</xref>), etc. ThreaDom, CHOP and FIEFDOM are template-based approaches, which infer the domain boundaries by identifying homologous templates with known domain information. However, this type of method does not perform well when the sequence similarity is not sufficient (e.g. &lt;30%). DOMPro, ConDo and DNN-dom are machine-learning-based methods. They take the input of coevolutionary information, the predicted secondary structure, the predicted solvent accessibility and the sequence profile to train a machine-learning model to predict domain boundaries. Their predictive accuracy is in general lower than the template-based methods. FUpred is a contact-based approach, which detects domain boundaries from predicted contact map. Its accuracy of the domain parsing depends on the accuracy of the predicted contact map.</p>
    <p>With the advance in deep learning-based structure prediction methods (<xref rid="btad070-B13" ref-type="bibr">Jumper <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btad070-B20" ref-type="bibr">Su <italic toggle="yes">et al.</italic>, 2021</xref>), it becomes much more accurate and faster than before to predict protein structure from protein sequence. However, it remains hard to predict accurate structure for big proteins (e.g. &gt;3000 amino acids). In such case, we may still be able to predict relatively accurate inter-residue distances between domains, which is relatively easier to predict than protein structure. It is known that correct assignment of domains can lead to improved structure prediction for individual domains. Therefore, sequence-based domain parsing is also meaningful.</p>
    <p>The advance in protein structure prediction provides the opportunity to deal with the problems of the sequence-based and the structure-based domain decompositions under a unified framework. In this work, we introduce a new domain parsing method UniDoc, which can predict more accurate domain boundaries using the inter-residue distance matrix that can be derived from the input structure or predicted by trRosettaX (<xref rid="btad070-B20" ref-type="bibr">Su <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Benchmark datasets</title>
      <p>Five benchmark datasets (four for structure-based and one for sequence-based domain parsing) are used in this work, which are summarized in <xref rid="btad070-T1" ref-type="table">Table 1</xref>.</p>
      <table-wrap position="float" id="btad070-T1">
        <label>Table 1.</label>
        <caption>
          <p>Summary of the benchmark datasets</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Dataset</th>
              <th rowspan="1" colspan="1">#Single/Multi</th>
              <th rowspan="1" colspan="1">Definition</th>
              <th rowspan="1" colspan="1">Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">Islam90</td>
              <td rowspan="1" colspan="1">68/19</td>
              <td rowspan="1" colspan="1">M</td>
              <td rowspan="1" colspan="1">3D</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Broad-consensus</td>
              <td rowspan="1" colspan="1">273/55</td>
              <td rowspan="1" colspan="1">S+C+E+M</td>
              <td rowspan="1" colspan="1">3D</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Consensus</td>
              <td rowspan="1" colspan="1">2841/682</td>
              <td rowspan="1" colspan="1">S+C+E</td>
              <td rowspan="1" colspan="1">3D</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Weak-consensus</td>
              <td rowspan="1" colspan="1">2231/538</td>
              <td rowspan="1" colspan="1">S+C</td>
              <td rowspan="1" colspan="1">3D</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">FUpred_seq</td>
              <td rowspan="1" colspan="1">1700/849</td>
              <td rowspan="1" colspan="1">S</td>
              <td rowspan="1" colspan="1">1D</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p>S, SCOP; C, CATH; E, ECOD; M, Islam2363.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Each dataset contains single-domain (denoted by Single) and multi-domain (denoted by Multi) proteins. For the multi-domain proteins, we give a more detailed classification (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>) based on the number of domains and whether they are continuous. The first three structure-based datasets in the table are from the work of SWORD (<xref rid="btad070-B18" ref-type="bibr">Postic <italic toggle="yes">et al.</italic>, 2017</xref>). The main difference between these datasets is the domain definition from different databases (SCOP, CATH, ECOD and Islam2363). For example, the domains in the Broad-consensus data set have similar annotations in CATH, SCOP, ECOD and Islam2363 (<xref rid="btad070-B12" ref-type="bibr">Islam <italic toggle="yes">et al.</italic>, 1995</xref>), while the domains in the Consensus dataset have similar annotations in CATH, SCOP and ECOD. Since Broad-consensus has more strict domain definitions, it has fewer number of proteins than Consensus. Islam2363 (<xref rid="btad070-B12" ref-type="bibr">Islam <italic toggle="yes">et al.</italic>, 1995</xref>) is a domain dataset which contains 2363 manually annotated domain assignments. We also constructed a new structure-based non-redundant dataset (denoted by Weak-consensus) by considering consistent domain annotations in SCOP and CATH. It consists of 2769 proteins with pairwise sequence identify ≤30%. All proteins that are identical in the Consensus are removed in the Weak-Consensus, which results in a smaller amount of data. The last dataset (FUpred_seq) is from the work of FUpred (<xref rid="btad070-B24" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2020</xref>), which is used to evaluate sequence-based domain recognition.</p>
    </sec>
    <sec>
      <title>2.2 Domain interaction score</title>
      <p>The division of a protein structure into domains is based on the intuition that the interaction inside the domains (i.e. intra-domain interaction) is stronger than that between domains (inter-domain interaction). To quantitively measure the domain interactions, we define domain interaction score (DIS) based on the inter-residue interaction as follows. It can be characterized by the <italic toggle="yes">C<sub>β</sub></italic>–<italic toggle="yes">C<sub>β</sub></italic> (<italic toggle="yes">C<sub>α</sub></italic>–<italic toggle="yes">C<sub>α</sub></italic> for Glycine) distance matrix <italic toggle="yes">D</italic>. The distance is transformed into contact probability between 0 and 1 using the following transform:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mo>δ</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic toggle="yes">d<sub>ij</sub></italic> is the distance between the <italic toggle="yes">i</italic>th residue and the <italic toggle="yes">j</italic>th residue. The values for <italic toggle="yes">d<sub>0</sub></italic> and <italic toggle="yes">δ</italic> are 8.0 and 1.5 Å, respectively (<xref rid="btad070-B8" ref-type="bibr">Gelly <italic toggle="yes">et al.</italic>, 2006</xref>).</p>
      <p>The inter-domain interaction score is defined as:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>DIS</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>inter</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mo>α</mml:mo></mml:msup><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mo>α</mml:mo></mml:msup></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic toggle="yes">D</italic><sub>1</sub> and <italic toggle="yes">D</italic><sub>2</sub> are two domains with sizes <italic toggle="yes">l</italic><sub>1</sub> and <italic toggle="yes">l</italic><sub>2</sub>, respectively; <italic toggle="yes">p<sub>ij</sub></italic> is defined by <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>. The parameter <italic toggle="yes">α</italic> is 0.43 according to <xref rid="btad070-B1" ref-type="bibr">Alexandrov and Shindyalov (2003)</xref>.</p>
      <p>The intra-domain interaction score is defined as:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mtext>DIS</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>intra</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mo>β</mml:mo></mml:msup></mml:mrow></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>D</mml:mi></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>j</mml:mi><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow/></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic toggle="yes">D</italic> is a domain of <italic toggle="yes">l</italic> amino acids; the parameter <italic toggle="yes">β</italic> is 0.95 empirically. In <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>, an example is given to visualize both scores.</p>
    </sec>
    <sec>
      <title>2.3 Framework of UniDoc</title>
      <p>The overall architecture of UniDoc is shown in <xref rid="btad070-F1" ref-type="fig">Figure 1</xref>. Its idea is similar to the structure-based approach PDP. The input can be either a 3D structure or a protein sequence (<xref rid="btad070-F1" ref-type="fig">Fig. 1A</xref>). When the 3D structure is available, the inter-residue distance map is calculated and the secondary structure is defined by STRIDE (<xref rid="btad070-B10" ref-type="bibr">Heinig and Frishman, 2004</xref>). When protein sequence is provided, trRosettaX (<xref rid="btad070-B20" ref-type="bibr">Su <italic toggle="yes">et al.</italic>, 2021</xref>) and PSIPRED (<xref rid="btad070-B15" ref-type="bibr">McGuffin <italic toggle="yes">et al.</italic>, 2000</xref>) are applied to predict the distance map and the secondary structure, respectively.</p>
      <fig position="float" id="btad070-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Framework of UniDoc. (<bold>A</bold>) The input to UniDoc can be either a structure or a protein sequence. (<bold>B</bold>) Top-down algorithm to decompose a fragment into two sub-fragments using either a continuous or discontinuous split. (<bold>C</bold>) Bottom-up algorithm for merging fragments</p>
        </caption>
        <graphic xlink:href="btad070f1" position="float"/>
      </fig>
      <p>With the distance map and the secondary structure, a two-step approach is used to predict domain boundaries. The first step splits a protein into fragments (‘top-down’, <xref rid="btad070-F1" ref-type="fig">Fig. 1B</xref>) while the second step merges the fragments (‘bottom-up’, <xref rid="btad070-F1" ref-type="fig">Figure 1C</xref>) to obtain the final domain decomposition. More details are presented below.</p>
    </sec>
    <sec>
      <title>2.4 Top-down algorithm for splitting</title>
      <p>The principle of splitting a protein into domains is to minimize the interaction between domains. Two constraints are required in the procedure of split. The first one is the size of a fragment should be longer than 30. The second one is a cutting position should not be from regular secondary structures (<italic toggle="yes">α</italic>-helix and <italic toggle="yes">β</italic>-sheet). We use two approaches to decompose a protein into domains, including continuous and discontinuous splits (<xref rid="btad070-F1" ref-type="fig">Fig. 1B</xref>). The one resulting in the smallest interaction score is selected at each step. At the beginning of the algorithm, the whole protein is regarded as a single-domain protein consisting of a continuous fragment.</p>
      <p><bold>Continuous split.</bold> Given a candidate fragment (<italic toggle="yes">D</italic>), a continuous split is defined as the split that results in two continuous sub-fragments (<italic toggle="yes">D</italic><sub>1</sub> and <italic toggle="yes">D</italic><sub>2</sub>). A single cutting position is needed for such a split (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2A</xref>). The optimal cutting position can be obtained by solving the following equation:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>argmin</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>&lt;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:munder><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtext>DIS</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>inter</mml:mtext></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic toggle="yes">l</italic> is the length of <italic toggle="yes">D</italic>; <italic toggle="yes">D</italic><sub>1</sub><sup><italic toggle="yes">k'</italic></sup> and <italic toggle="yes">D</italic><sub>2</sub><sup><italic toggle="yes">k'</italic></sup> are the resulting sub-fragments at the cutting position <italic toggle="yes">k'</italic>.</p>
      <p><bold>Discontinuous split.</bold> A discontinuous split is defined as the split that results in one discontinuous fragment (<italic toggle="yes">D</italic><sub>1</sub>) and one continuous fragment (<italic toggle="yes">D</italic><sub>2</sub>). Two cutting positions are needed for such a split (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2B</xref>). The optimal cutting positions <italic toggle="yes">t</italic> and <italic toggle="yes">s</italic> can be obtained with the following equation:
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>argmin</mml:mi></mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>&lt;</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>&gt;</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mn>35</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>8</mml:mn><mml:mo>Å</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>DIS</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>inter</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic toggle="yes">D</italic><sub>1</sub><sup><italic toggle="yes">t′, s′</italic></sup> and <italic toggle="yes">D</italic><sub>2</sub><sup><italic toggle="yes">t′, s′</italic></sup> are discontinuous and continuous sub-fragments, respectively, from the cutting positions <italic toggle="yes">t′</italic> and <italic toggle="yes">s′</italic>. Note that the above equation implies that two key constraints are forced to ensure the splitting is meaningful. First, the two cutting points should not be too close to each other in the 1D sequence (&gt;35) to ensure that the resulting continuous fragment is not too small. Second, the two cutting points should not be too far away from each other in the 3D structure to ensure that the sequentially distant sites are spatially close.</p>
      <p>To partly address the issue of over-splitting (i.e. splitting more number of domains than the native definition), the interaction score between the sub-fragments after splitting is compared with the interaction score of the original fragment (DIS<sub>intra</sub>) as follows. First, we select the optimal split with the smallest interaction score (DIS<sub>inter</sub>) from the continuous and the discontinuous splits. Second, this split is accepted only when DIS<sub>inter</sub> is less than half of DIS<sub>intra</sub>; otherwise, no split is performed on this fragment to avoid over-splitting.</p>
      <p>Note that the top-down approach ensures that the interactions between the resulted sub-fragments from each step are minimized; however, it does not guarantee that the interactions among sub-fragments from multiple steps are minimized. This may be because the top-down approach only captures local interactions in each step. To solve this problem, a bottom-up algorithm is applied to merge sub-fragments that have strong interactions, as detailed below.</p>
    </sec>
    <sec>
      <title>2.5 Bottom-up algorithm for merging</title>
      <p>A bottom-up algorithm is applied iteratively to merge the fragments from the top-down splitting into domains to maximize the interactions inside each domain as follows (<xref rid="btad070-F1" ref-type="fig">Fig. 1C</xref>). Two fragments (<italic toggle="yes">D<sub>I</sub></italic> and <italic toggle="yes">D<sub>J</sub></italic>) are selected from all fragment pairs to maximize the score defined by the following formula:
<disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtext>DIS</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>inter</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>min</mml:mi><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtext>DIS</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>intra</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtext>DIS</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mtext>intra</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> are between 1 and the total number of fragments from the top-down splitting. The fragments <italic toggle="yes">D<sub>I</sub></italic> and <italic toggle="yes">D<sub>J</sub></italic> are merged, if <italic toggle="yes">S</italic>(<italic toggle="yes">I</italic>, <italic toggle="yes">J</italic>) is positive, meaning that the interaction between these fragments is stronger than within one of the individual fragments; otherwise, the merging step is done.</p>
      <p>A post-processing step is further applied to merge less compact fragments. A fragment with weak intra-domain contact (DIS<sub>intra</sub> &lt;1.0) will be merged with another fragment that has the strongest interaction with it (i.e. the one with the highest value of DIS<sub>inter</sub>).</p>
    </sec>
    <sec>
      <title>2.6 Performance evaluation</title>
      <p>The performance of classifying single and multi-domain proteins is measured mainly based on the metric Matthew’s correlation coefficient (MCC). In addition, the precision and the accuracy are also calculated.</p>
      <p>For structure-based domain parsing, the metric CDO (Correct Domain Overlap) score is used to measure the performance of a method (<xref rid="btad070-B1" ref-type="bibr">Alexandrov and Shindyalov, 2003</xref>; <xref rid="btad070-B18" ref-type="bibr">Postic <italic toggle="yes">et al.</italic>, 2017</xref>). CDO score is calculated as the ratio of targets with correct domain assignment (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). A domain assignment is considered correct if the following conditions are satisfied: (i) the predicted number of domains is consistent with the number of annotated domains; (ii) the overlap between each predicted domain and the reference is greater than a given threshold (denoted by <italic toggle="yes">t</italic>). Previously, this threshold was simply set to 85% (<xref rid="btad070-B1" ref-type="bibr">Alexandrov and Shindyalov, 2003</xref>; <xref rid="btad070-B18" ref-type="bibr">Postic <italic toggle="yes">et al.</italic>, 2017</xref>). We will discuss the impact of this threshold later.</p>
      <p>For sequence-based domain boundary prediction, besides the above metrics, NDO (Normalized Domain Overlap) score (<xref rid="btad070-B21" ref-type="bibr">Tai <italic toggle="yes">et al.</italic>, 2005</xref>) is used (<xref rid="btad070-B19" ref-type="bibr">Shi <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btad070-B23" ref-type="bibr">Xue <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btad070-B24" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2020</xref>). More details about the calculation of the above metrics are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results and discussions</title>
    <sec>
      <title>3.1 Structure-based domain parsing</title>
      <sec>
        <title>3.1.1 Classification of single- and multi-domain proteins</title>
        <p>Based on the domain parsing result, we can infer if it is a single-domain or a multi-domain target. <xref rid="btad070-F2" ref-type="fig">Figure 2A</xref> shows the MCCs for UniDoc and the other two controlled methods (SWORD* and PDP) on four structure datasets. Note that SWORD* refers to taking the default first-ranked prediction from SWORD. Except for the dataset Broad-consensus, UniDoc has a higher MCC than other methods on the other three datasets. The MCC may be easily affected by the wrong predictions for just a few multi-domain targets, given the small size of multi-domain proteins. The correctly predicted numbers of multi-domain proteins are 44, 48 and 51 for UniDoc, SWORD* and PDP, respectively. PDP (resp. SWORD*) has the highest recall at the expense of lower precision for multi-domain (resp. single-domain) targets, indicating that it tends to overcut (resp. undercut) the structures into domains (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>).</p>
        <fig position="float" id="btad070-F2">
          <label>Fig. 2.</label>
          <caption>
            <p>Performance for structure-based domain parsing. (<bold>A</bold>) The MCCs for UniDoc and the other two controlled methods (SWORD* and PDP) on four structure datasets. (<bold>B</bold>) The performance on multi-domain proteins in terms of CDO score at the domain overlap threshold of 85%. (<bold>C</bold>, <bold>D</bold>) are the CDO scores at varying overlap thresholds between 0 and 1. The dots represent the scores at the threshold of 85%</p>
          </caption>
          <graphic xlink:href="btad070f2" position="float"/>
        </fig>
      </sec>
      <sec>
        <title>3.1.2 Performance on multi-domain proteins</title>
        <p><xref rid="btad070-F2" ref-type="fig">Figure 2B–D</xref> summarizes the comparisons among UniDoc, SWORD* and PDP on multi-domain proteins (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref> for proteins with &gt;2 domains). <xref rid="btad070-F2" ref-type="fig">Figure 2B</xref> suggests that when the domain overlap threshold is set to 85%, UniDoc outperforms the two controlled methods on all datasets. We also investigate the impact of this threshold (<italic toggle="yes">t</italic>). When this threshold is changed between 0 and 1, we calculate the corresponding CDO score on each dataset for each method. A higher/lower value of <italic toggle="yes">t</italic> means a more/less stringent requirement for an assignment to be regarded as correct, which thus results in a lower/higher CDO score. The results are shown in <xref rid="btad070-F2" ref-type="fig">Figure 2C and D</xref>, for comparison with PDP and SWORD*, respectively. They suggest except for the small dataset Broad-consensus (55 targets), UniDoc has consistently higher CDO scores than both methods when the threshold becomes more stringent than 85%. This suggests that the domain assignments by UniDoc are in a higher resolution than the controlled methods. On the Broad-consensus dataset, UniDoc is competitive with PDP and SWORD*, as shown by the close distance between the diagonal line and the brown curve.</p>
      </sec>
      <sec>
        <title>3.1.3 Impact of ambiguous definition of domain boundary</title>
        <p>When the domain boundary for a protein is blurred, the domain annotations by CATH and SCOP are not always consistent. CATH tends to cut proteins into smaller domains; while SCOP uses evolutionary and structural relationships to define domains, making the SCOP domains larger. This inconsistent domain definition may affect the performance assessment. A few case studies are given to illustrate this issue.</p>
        <p>For the protein <italic toggle="yes">APO-liver alcohol dehydrogenase</italic> (PDB ID: 8ADH, chain A, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4A</xref>), both SCOP and CATH decompose it as two domains but with different domain boundaries. CATH divides the <italic toggle="yes">α</italic>-helix (residues 165–188, highlighted in a circle in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4A</xref>) into two segments; while SCOP keeps this <italic toggle="yes">α</italic>-helix as a whole. The domain predictions by PDP and SWORD* are consistent with the CATH definition, while UniDoc’s prediction is consistent with the SCOP definition. Meanwhile, the SWORD predictions are not consistent with the SCOP definition.</p>
        <p>For the protein <italic toggle="yes">X-ray crystal structures of trypsin complexes and thrombin complexes</italic> (PDB ID: 1PHH, chain A, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4B</xref>), it is difficult to distinguish the number of domains and their boundaries from the distance map. The boundary division for this example is very ambiguous. Although both CATH and SCOP divide this structure into two domains, the domain boundaries are different. Due to different assignments of the highlighted <italic toggle="yes">β</italic>-strands (residues 174–181 and residues 267–273) and the segments (residues 73–95 and 352–394), CATH assigns multiple discontinuous fragments in both domains; while SCOP keeps continuous fragments into one of the domains. The predictions by UniDoc and PDP are consistent with the SCOP definition while the SWORD* prediction is different from both CATH and SCOP definitions. None of the solutions by SWORD are similar to the definition by SCOP or CATH.</p>
        <p>The last example is the protein <italic toggle="yes">multifunctional methyltransferase</italic> (PDB ID: 1PJQ, chain A, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4C</xref>). From the distance map, we can see that there are sparse interactions among the residues 113–457. This makes the number of domains by CATH and SCOP different (5 and 3, respectively). The residues from 113 to 215 (highlighted in box) are divided into two domains by CATH and one by SCOP. The results of UniDoc and PDP are consistent with CATH; while the SWORD* prediction is consistent with SCOP. Similarly, CATH splits the residues from 216 to 457 (highlighted in box) into two domains while SCOP combines them in one domain. The predictions by all three methods are consistent with the CATH annotations. One of the solutions by SWORD is correct according to CATH; but it is not on the top in its default ranking.</p>
      </sec>
      <sec>
        <title>3.1.4 Running time analysis</title>
        <p>We compare the time complexity of structure-based domain parsing by UniDoc, SWORD and PDP on the proteins from the dataset Broad-consensus. All three methods were run locally and the running time for all proteins was recorded. <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref> shows that SWORD is much slower than UniDoc and PDP. On average, UniDoc takes 0.017 s to process one protein, which is more than two times faster than PDP (0.048 s per protein); and 312 times faster than SWORD (5.32 s per protein). The fast speed of UniDoc can be explained by the strategy employed, i.e. the cutting points that break the secondary structure are not considered. This decreases the time complexity while ensuring the precision of domain boundary prediction.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2. Sequence-based domain parsing</title>
      <p>As the inter-residue distance prediction becomes much more accurate than before, we can apply the above structure-based domain parsing algorithm to the problem of sequence-based domain boundary prediction. The only difference is the inter-residue distance is predicted by trRosettaX rather than derived from the input structure.</p>
      <p>Though many sequence-based domain boundary prediction methods are available, we only compare UniDoc with FUpred (<xref rid="btad070-B24" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2020</xref>), which is the state-of-the-art method that uses predicted inter-residue contacts. FUpred was installed and executed locally. The comparison is based on the dataset from the FUpred work, which consists of 1700 single-domain proteins and 849 multi-domain proteins. We also derive the distance/contact from the native structure as inputs to UniDoc and FUpred, with the same definition of inter-residue contact in FUpred.</p>
      <p>First, we compare the performances in classifying single-domain and multi-domain proteins by both methods. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>, with the distance/contact map predicted by trRosettaX, the MCC of UniDoc is 0.804, which is slightly higher than FUpred (0.784). This is consistent with the reported MCC in the FUpred paper, i.e. 0.799 with predicted contact map ResPRE (<xref rid="btad070-B24" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
      <p>Second, the performances on parsing 849 multi-domain proteins by UniDoc and FUpred are compared based on CDO and NDO scores (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>). <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6</xref> summarizes the results on proteins with &gt;2 domains. The CDO score suggests that UniDoc correctly recognized the domain boundaries for 49.59% (=421/849) of multi-domain proteins, which is 4.24% higher than FUpred. This translates to a total of 36 proteins that are correctly predicted by UniDoc but not by FUpred. Note that for structure-based domain parsing (<xref rid="btad070-F2" ref-type="fig">Fig. 2</xref>), the CDO score is above 60%, much higher than the data in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>. This is likely because the domain definition for the proteins in this dataset is from SCOP only. Thus, it may inevitably have some proteins with ambiguous definitions of domain boundaries. To verify this hypothesis, for the multi-domain proteins in the FUpred-seq dataset, we compared the domain annotations in CATH and SCOP. It turns out that CATH and SCOP have different domain definitions for 458 proteins out of the 849 multi-domain proteins in this dataset.</p>
      <p>Similar to the previous analysis, we compute the CDO scores at different overlap thresholds in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7A</xref>. It shows that UniDoc consistently outperforms FUpred at all thresholds. As the CDO score is binary, we further compare both methods based on the NDO score, which is widely used for measuring sequence-based domain recognition methods. <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref> shows that UniDoc achieves an NDO score of 0.812, slightly higher than FUpred (0.804). Note that FUpred’s NDO score was 0.791 with the predicted contact map by ResPRE, comparable with the data in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>.</p>
      <p>In addition, we compare the time complexity of UniDoc and FUpred on 849 multi-domain proteins in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S7B</xref>. The time for input data preparation (including distance/map and secondary structure prediction) is not considered for both methods. On average, UniDoc takes 0.30 s per protein to predict domain boundaries, which is more than 2 times faster than FUpred (0.73 s per protein).</p>
    </sec>
    <sec>
      <title>3.3 Impact of the accuracy of predicted distance</title>
      <p>Since UniDoc decomposes protein domains based on distance matrix, whether accurate distance prediction can be transferred into a correct prediction of domain boundaries. First, we compute the accuracy of the predicted distance [i.e. distance precision defined in <xref rid="btad070-B6" ref-type="bibr">Du <italic toggle="yes">et al.</italic> (2022)</xref>] for the 849 multi-domain proteins. <xref rid="btad070-F3" ref-type="fig">Figure 3A</xref> shows that the distances for most (92%) proteins were predicted with a precision higher than 0.6, making it possible to infer correct domain boundaries from sequences. However, <xref rid="btad070-F3" ref-type="fig">Figure 3B</xref> indicates that there is no clear correlation between the distance precision and the NDO score. This is probably because the distance precision measures the global accuracy while the NDO score measures the accuracy of boundary (kind of local measure) detection. Two representative examples are given in <xref rid="btad070-F3" ref-type="fig">Figure 3D and E</xref> to illustrate this.</p>
      <fig position="float" id="btad070-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Correlation between the distance precision and the accuracy of domain parsing. (<bold>A</bold>) Distribution of distance precision on the multi-domain proteins from the dataset FUpred_seq. (<bold>B</bold>) Plot of the distance precision and the NDO score. (<bold>C</bold>) The violin figure between the distance precision and the NDO score (summarized from B). The distance precision is divided into 10 bins to calculate the distribution of the NDO scores. The mean scores are indicated by the cross signs. (<bold>D, E</bold>) Two examples to explain the low correlation between distance precision and the accuracy of domain boundaries prediction. The domain information under the cartoon structures is the ground truth; while those under the distance map are the predictions</p>
        </caption>
        <graphic xlink:href="btad070f3" position="float"/>
      </fig>
      <p>According to SCOP, the protein <italic toggle="yes">crystal structure of the Arg-specific cysteine proteinase gingipain R</italic> (PDB ID: 1CVR, chain A, <xref rid="btad070-F3" ref-type="fig">Fig. 3D</xref>), has two domains (residues 1–350 and 351–432). Correct domain boundary was obtained when the native structure was used in UniDoc. The predicted distance for this protein is accurate with a distance precision of 0.87. However, the domain boundary was predicted wrongly from this distance (i.e. three domains) are incorrect with a CDO score of 0 and NDO score of 0.685. This is mostly because the inter-domain distance was predicted with poor precision though the intra-domain distance was predicted well.</p>
      <p>The opposite of this example is the <italic toggle="yes">solution structure of HNF-6</italic> (PDB ID: 1S7E, chain A, <xref rid="btad070-F3" ref-type="fig">Fig. 3E</xref>), which has two domains according to SCOP (residues 1–80 and residues 81–147). UniDoc made correct predictions with both the native and the predicted distances. Note that the predicted intra-domain distance is of low accuracy, resulting in a low global distance precision (0.383). However, the inter-domain distance was correctly predicted, making the domain boundary clear to infer.</p>
      <p>We divide the distance precision from 0 to 1 into 10 bins and calculate the distribution of NDO scores in each bin. The numbers of proteins with distance precision in the range from 0 to 0.6 are very small (<xref rid="btad070-F3" ref-type="fig">Fig. 3C</xref>), which has no statistical significance. When the distance precision is higher than 0.6, <xref rid="btad070-F3" ref-type="fig">Figure 3C</xref> shows that the median value of the NDO score does become higher with a more accurate distance prediction.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>Decomposition of multi-domain proteins into domains is of fundamental meaning for precise domain-based structure prediction and functional characterizations. The recent breakthroughs in deep learning-based protein structure prediction make it possible to unify structure-based and sequence-based domain parsing. We introduce one of such approaches, UniDoc, for unified domain parsing using either structure-derived or predicted inter-residue distance matrix. Comprehensive tests on five benchmark datasets show that UniDoc works very well, outperforming other peering methods, in terms of both accuracy and speed. Though with a high prediction accuracy, UniDoc still has a limit. Only one domain decomposition is given even if multiple alternative decompositions exist. More efforts are needed to deal with the proteins with ambiguous definition of domain boundaries. We anticipate that the release of UniDoc could contribute to the community for protein domain analysis.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btad070_Supplementary_Data</label>
      <media xlink:href="btad070_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Natural Science Foundation of China (NSFC) [T2225007, T2222012].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>All data used in this work can be downloaded at: <ext-link xlink:href="https://yanglab.nankai.edu.cn/UniDoc/benchmark/" ext-link-type="uri">https://yanglab.nankai.edu.cn/UniDoc/benchmark/</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad070-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alexandrov</surname><given-names>N.</given-names></string-name>, <string-name><surname>Shindyalov</surname><given-names>I.</given-names></string-name></person-group> (<year>2003</year>) <article-title>PDP: protein domain parser</article-title>. <source>Bioinformatics</source>, <volume>19</volume>, <fpage>429</fpage>–<lpage>430</lpage>.<pub-id pub-id-type="pmid">12584135</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berman</surname><given-names>H.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2000</year>) <article-title>The Protein Data Bank</article-title>. <source>Nucleic Acids Res</source>., <volume>28</volume>, <fpage>235</fpage>–<lpage>242</lpage>.<pub-id pub-id-type="pmid">10592235</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bondugula</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>FIEFDom: a transparent domain boundary recognition system using a fuzzy mean operator</article-title>. <source>Nucleic Acids Res</source>., <volume>37</volume>, <fpage>452</fpage>–<lpage>462</lpage>.<pub-id pub-id-type="pmid">19056827</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>ECOD: an evolutionary classification of protein domains</article-title>. <source>PLoS Comput. Biol</source>., <volume>10</volume>, <fpage>e1003926</fpage>.<pub-id pub-id-type="pmid">25474468</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname><given-names>J.L.</given-names></string-name></person-group><etal>et al</etal> (<year>2006</year>) <article-title>DOMpro: protein domain prediction using profiles, secondary structure, relative solvent accessibility, and recursive neural networks</article-title>. <source>Data Min. Knowl. Disc</source>, <volume>13</volume>, <fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btad070-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Du</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Toward the assessment of predicted inter-residue distance</article-title>. <source>Bioinformatics</source>, <volume>38</volume>, <fpage>962</fpage>–<lpage>969</lpage>.<pub-id pub-id-type="pmid">34791040</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eguchi</surname><given-names>R.R.</given-names></string-name>, <string-name><surname>Huang</surname><given-names>P.S.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Multi-scale structural analysis of proteins by deep semantic segmentation</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>1740</fpage>–<lpage>1749</lpage>.<pub-id pub-id-type="pmid">31424530</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gelly</surname><given-names>J.C.</given-names></string-name></person-group><etal>et al</etal> (<year>2006</year>) <article-title>‘Protein peeling’: an approach for splitting a 3D protein structure into compact fragments</article-title>. <source>Bioinformatics</source>, <volume>22</volume>, <fpage>129</fpage>–<lpage>133</lpage>.<pub-id pub-id-type="pmid">16301202</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>J.T.</given-names></string-name></person-group><etal>et al</etal> (<year>2003</year>) <article-title>Improving the performance of DomainParser for structural domain partition using neural network</article-title>. <source>Nucleic Acids Res</source>., <volume>31</volume>, <fpage>944</fpage>–<lpage>952</lpage>.<pub-id pub-id-type="pmid">12560490</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heinig</surname><given-names>M.</given-names></string-name>, <string-name><surname>Frishman</surname><given-names>D.</given-names></string-name></person-group> (<year>2004</year>) <article-title>STRIDE: a web server for secondary structure assignment from known atomic coordinates of proteins</article-title>. <source>Nucleic Acids Res</source>., <volume>32</volume>, <fpage>W500</fpage>–<lpage>W502</lpage>.<pub-id pub-id-type="pmid">15215436</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hong</surname><given-names>S.H.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>ConDo: protein domain boundary prediction using coevolutionary information</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>2411</fpage>–<lpage>2417</lpage>.<pub-id pub-id-type="pmid">30500873</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Islam</surname><given-names>S.A.</given-names></string-name></person-group><etal>et al</etal> (<year>1995</year>) <article-title>Identification and analysis of domains in proteins</article-title>. <source>Protein Eng</source>., <volume>8</volume>, <fpage>513</fpage>–<lpage>525</lpage>.<pub-id pub-id-type="pmid">8532675</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jumper</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source>, <volume>596</volume>, <fpage>583</fpage>–<lpage>589</lpage>.<pub-id pub-id-type="pmid">34265844</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>J.</given-names></string-name>, <string-name><surname>Rost</surname><given-names>B.</given-names></string-name></person-group> (<year>2004</year>) <article-title>CHOP proteins into structural domain-like fragments</article-title>. <source>Proteins</source>, <volume>55</volume>, <fpage>678</fpage>–<lpage>688</lpage>.<pub-id pub-id-type="pmid">15103630</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McGuffin</surname><given-names>L.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2000</year>) <article-title>The PSIPRED protein structure prediction server</article-title>. <source>Bioinformatics</source>, <volume>16</volume>, <fpage>404</fpage>–<lpage>405</lpage>.<pub-id pub-id-type="pmid">10869041</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Murzin</surname><given-names>A.G.</given-names></string-name></person-group><etal>et al</etal> (<year>1995</year>) <article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures</article-title>. <source>J. Mol. Biol</source>., <volume>247</volume>, <fpage>536</fpage>–<lpage>540</lpage>.<pub-id pub-id-type="pmid">7723011</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Orengo</surname><given-names>C.A.</given-names></string-name></person-group><etal>et al</etal> (<year>1997</year>) <article-title>CATH–a hierarchic classification of protein domain structures</article-title>. <source>Structure</source>, <volume>5</volume>, <fpage>1093</fpage>–<lpage>1108</lpage>.<pub-id pub-id-type="pmid">9309224</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Postic</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>An ambiguity principle for assigning protein structural domains</article-title>. <source>Sci. Adv</source>., <volume>3</volume>, <fpage>e1600552</fpage>.<pub-id pub-id-type="pmid">28097215</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shi</surname><given-names>Q.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>DNN-Dom: predicting protein domain boundary from sequence alone by deep neural network</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>5128</fpage>–<lpage>5136</lpage>.<pub-id pub-id-type="pmid">31197306</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Su</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Improved protein structure prediction using a new Multi-Scale network and homologous templates</article-title>. <source>Adv. Sci. (Weinh.)</source>, <volume>8</volume>, <fpage>e2102592</fpage>.<pub-id pub-id-type="pmid">34719864</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tai</surname><given-names>C.H.</given-names></string-name></person-group><etal>et al</etal> (<year>2005</year>) <article-title>Evaluation of domain prediction in CASP6</article-title>. <source>Proteins</source>, <volume>61</volume> (<issue>Suppl. 7</issue>), <fpage>183</fpage>–<lpage>192</lpage>.<pub-id pub-id-type="pmid">16187361</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wetlaufer</surname><given-names>D.B.</given-names></string-name></person-group> (<year>1973</year>) <article-title>Nucleation, rapid folding, and globular intrachain regions in proteins</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>70</volume>, <fpage>697</fpage>–<lpage>701</lpage>.<pub-id pub-id-type="pmid">4351801</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xue</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2013</year>) <article-title>ThreaDom: extracting protein domain boundary information from multiple threading alignments</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>i247</fpage>–<lpage>256</lpage>.<pub-id pub-id-type="pmid">23812990</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>W.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>FUpred: detecting protein domains through deep-learning-based contact map prediction</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>3749</fpage>–<lpage>3757</lpage>.<pub-id pub-id-type="pmid">32227201</pub-id></mixed-citation>
    </ref>
    <ref id="btad070-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2007</year>) <article-title>DDOMAIN: dividing structures into domains using a normalized domain-domain interaction profile</article-title>. <source>Protein Sci</source>., <volume>16</volume>, <fpage>947</fpage>–<lpage>955</lpage>.<pub-id pub-id-type="pmid">17456745</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
