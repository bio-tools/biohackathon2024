<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5860111</article-id>
    <article-id pub-id-type="pmid">28407035</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx155</article-id>
    <article-id pub-id-type="publisher-id">btx155</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>IcyTree: rapid browser-based visualization for phylogenetic trees and networks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Vaughan</surname>
          <given-names>Timothy G</given-names>
        </name>
        <!--<email>tgvaughan@gmail.com</email>-->
        <xref ref-type="aff" rid="btx155-aff1"/>
        <xref ref-type="corresp" rid="COR1"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx155-aff1">Department of Computer Science, University of Auckland, Auckland, New Zealand</aff>
    <author-notes>
      <corresp id="COR1">Email: <email>tgvaughan@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>8</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-04-12">
      <day>12</day>
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>15</issue>
    <fpage>2392</fpage>
    <lpage>2394</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>9</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>06</day>
        <month>2</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>3</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx155.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Summary</title>
        <p>IcyTree is an easy-to-use application which can be used to visualize a wide variety of phylogenetic trees and networks. While numerous phylogenetic tree viewers exist already, IcyTree distinguishes itself by being a purely online tool, having a responsive user interface, supporting phylogenetic networks (ancestral recombination graphs in particular), and efficiently drawing trees that include information such as ancestral locations or trait values. IcyTree also provides intuitive panning and zooming utilities that make exploring large phylogenetic trees of many thousands of taxa feasible.</p>
      </sec>
      <sec id="SA2">
        <title>Availability and Implementation</title>
        <p>IcyTree is a web application and can be accessed directly at <ext-link ext-link-type="uri" xlink:href="http://tgvaughan.github.com/icytree">http://tgvaughan.github.com/icytree</ext-link>. Currently supported web browsers include Mozilla Firefox and Google Chrome. IcyTree is written entirely in client-side JavaScript (no plugin required) and, once loaded, does not require network access to run. IcyTree is free software, and the source code is made available at <ext-link ext-link-type="uri" xlink:href="http://github.com/tgvaughan/icytree">http://github.com/tgvaughan/icytree</ext-link> under version 3 of the GNU General Public License.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Royal Society of New Zealand</named-content>
          <named-content content-type="funder-identifier">10.13039/501100001509</named-content>
        </funding-source>
        <award-id>UOA1324</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The visualization of phylogenetic trees is an extremely important aspect of computational phylogenetics. Indeed, the well-known text Inferring Phylogenies (<xref rid="btx155-B4" ref-type="bibr">Felsenstein, 2003</xref>) devotes an entire chapter to this topic. It is therefore no coincidence that the evolution of phylogenetic tree visualization software has often gone hand-in-hand with the development of sophisticated algorithms and software for phylogenetic inference. Many of the earliest available phylogenetic inference packages such as PHYLIP (<xref rid="btx155-B3" ref-type="bibr">Felsenstein, 1989</xref>), MacClade (<xref rid="btx155-B9" ref-type="bibr">Maddison and Maddison, 1989</xref>), and MrBayes (<xref rid="btx155-B10" ref-type="bibr">Ronquist <italic>et al.</italic>, 2012</xref>) include built-in support for visualizing their output. Other packages such as PhyML (<xref rid="btx155-B5" ref-type="bibr">Guindon and Gascuel, 2003</xref>) and BEAST (<xref rid="btx155-B1" ref-type="bibr">Bouckaert <italic>et al.</italic>, 2014</xref>) produce no graphical output but instead rely on specialized phylogenetic visualization tools such as FigTree (<ext-link ext-link-type="uri" xlink:href="http://tree.bio.ed.ac.uk/software/figtree">http://tree.bio.ed.ac.uk/software/figtree</ext-link>) and Dendroscope (<xref rid="btx155-B7" ref-type="bibr">Huson and Scornavacca, 2012</xref>) to interpret inference results.</p>
    <p>There now exists a range of stand-alone phylogenetic visualization tools, too many to name here. (The PHYLIP home page provides an online list of such programs which currently contains 60 entries.) Despite existing solutions to the visualization problem being so numerous, the package IcyTree distinguishes itself in a number of important respects.</p>
    <p>First, IcyTree is extremely easy to access. It is written entirely in JavaScript and runs in modern web browsers (compatibility with recent versions Google Chrome and Mozilla Firefox is assured) without needing additional plugins, meaning that it is loaded simply by navigating to its home page. This also means that it is never necessary to update IcyTree. Importantly, and unlike many of the existing JavaScript-based phylogenetics tools, IcyTree does not interact with servers in any way while running. This ensures that the program is as responsive as possible and means that users need not be concerned about the privacy implications of uploading data to an online service.</p>
    <p>Second, the use of JavaScript combined with the SVG graphical format allows IcyTree to display trees containing thousands or even tens of thousands of taxa while remaining responsive. This also means that large files containing thousands of trees can be quickly loaded.</p>
    <p>Third, IcyTree is very light-weight, focusing on drawing rooted phylogenetic time trees such as those inferred by Bayesian phylogenetic inference packages. This keeps the number of available options manageable. Along with the emphasis placed on making the program options accessible using a mouse or via an extensive repertoire of keyboard shortcuts, I feel that this makes IcyTree intuitive and easy to use, catering to new and seasoned users alike.</p>
    <p>Finally, IcyTree is capable of viewing trees stored in a number of different formats, including Newick, NEXUS (<xref rid="btx155-B8" ref-type="bibr">Maddison <italic>et al.</italic>, 1997</xref>) (as used by BEAST and MrBayes), PhyloXML (<xref rid="btx155-B6" ref-type="bibr">Han and Zmasek, 2009</xref>) and NeXML (<xref rid="btx155-B13" ref-type="bibr">Vos <italic>et al.</italic>, 2012</xref>). Phylogenetic networks specified using the Extended Newick format (<xref rid="btx155-B2" ref-type="bibr">Cardona <italic>et al.</italic>, 2008</xref>) are also supported. (The style used by IcyTree to render such networks is particularly suited to ancestral recombination graphs such as those inferred by Bacter (<xref rid="btx155-B12" ref-type="bibr">Vaughan <italic>et al.</italic>, 2017</xref>).)</p>
  </sec>
  <sec>
    <title>2 Basic use and capabilities</title>
    <p>IcyTree is opened by navigating to its URL <ext-link ext-link-type="uri" xlink:href="http://tgvaughan.github.io/icytree">http://tgvaughan.github.io/icytree</ext-link> using either Mozilla Firefox or Google Chrome. (Chrome runs IcyTree noticeably faster than Firefox, but both browsers are supported.) Tree files can then be loaded by simply dragging and dropping them onto the IcyTree window, or by selecting File → Open. (Newick strings can also be pasted directly into IcyTree by using File → Enter tree directly.)</p>
    <p>Once a tree file is displayed, it can be easily explored using the pan-and-zoom interface: the mouse scroll wheel is used to zoom in or out of features under the mouse cursor, while the displayed area can be panned by clicking and dragging the mouse. (This is a similar interface to that provided by online map services.) In the instance that tree files contain multiple trees, the displayed tree can be changed using either the navigation box that appears in the bottom-left corner of the screen or via keyboard shortcuts.</p>
    <p>Moving the mouse cursor over a tree edge displays a table containing information about that edge and the nodes that it connects. This includes the label of the child node, the age of the child and parent nodes, the length of the edge and the values of any additional annotations (<xref ref-type="fig" rid="btx155-F1">Fig. 1</xref>a).</p>
    <p>The Style menu contains a number of options which affect how the tree is displayed, such as changing what text is displayed on the tree, which annotations if any determine edge colour or opacity, whether reticulations are displayed, axis options, etc.</p>
    <p>Figures produced by IcyTree can be exported directly as scalable SVG images via the File →Export →SVG menu item. Bitmap images can also be produced using the adjacent PNG and JPEG menu items.</p>
    <fig id="btx155-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>(<bold>a</bold>) Rendering of an influenza tree annotated by edge locations (line shading). The table lists information specific to a particular edge selected using the mouse. (<bold>b</bold>) Rendering of a phylogenetic network loaded from its Extended Newick description. Dashed edges represent reticulations, while the line shading shows the values of an annotation representing the locus of a recombination event (Color version of this figure is available at <italic>Bioinformatics</italic> online.)</p>
      </caption>
      <graphic xlink:href="btx155f1"/>
    </fig>
    <p>All of IcyTree’s features are described in an extensive usage manual which is available via the Help →Online Manual menu item.</p>
  </sec>
  <sec>
    <title>3 Supported input formats</title>
    <p>IcyTree can read tree files produced by popular phylogenetics packages such as MrBayes, BEAST and PhyML. These programs produce files in Newick and NEXUS formats, with the NEXUS format supporting the BEAST extensions which allow metadata (e.g. clade posterior support, ancestral traits, etc.) to be associated with each node/edge in a tree. The support for Extended Newick is built into IcyTree at the lowest level, and allows IcyTree to not only read plain network descriptions but also NEXUS tree blocks containing annotated phylogenetic networks. These annotations are used by programs such as MASTER (<xref rid="btx155-B11" ref-type="bibr">Vaughan and Drummond, 2013</xref>) and Bacter (<xref rid="btx155-B12" ref-type="bibr">Vaughan <italic>et al.</italic>, 2017</xref>) to represent ancestral trait information (<xref ref-type="fig" rid="btx155-F1">Fig. 1b</xref>).</p>
    <p>In addition, IcyTree can be used to view trees represented using the modern PhyloXML and NeXML formats, although support for these formats is currently limited to trees only.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>The author was supported by Marsden grant UOA1324 from the Royal Society of New Zealand.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btx155-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bouckaert</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>BEAST 2: a software platform for Bayesian evolutionary analysis</article-title>. <source>PLoS Comput. Biol</source>., <volume>10</volume>, <fpage>e1003537</fpage>.<pub-id pub-id-type="pmid">24722319</pub-id></mixed-citation>
    </ref>
    <ref id="btx155-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cardona</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Extended Newick: it is time for a standard representation of phylogenetic networks</article-title>. <source>BMC Bioinf</source>., <volume>9</volume>, <fpage>532</fpage>.</mixed-citation>
    </ref>
    <ref id="btx155-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Felsenstein</surname><given-names>J.</given-names></name></person-group> (<year>1989</year>) 
<article-title>Phylip – phylogeny inference package (version 3.2)</article-title>. <source>Cladistics</source>, <volume>5</volume>, <fpage>164</fpage>–<lpage>166</lpage>.</mixed-citation>
    </ref>
    <ref id="btx155-B4">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Felsenstein</surname><given-names>J.</given-names></name></person-group> (<year>2003</year>) <source>Inferring Phylogenies</source>. 
<publisher-name>Sinauer Associates</publisher-name>, 
<publisher-loc>Massachusetts</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btx155-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guindon</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Gascuel</surname><given-names>O.</given-names></name></person-group> (<year>2003</year>) 
<article-title>A simple, fast, and accurate algorithm to estimate large phylogenies by maximum likelihood</article-title>. <source>Syst. Biol</source>., <volume>52</volume>, <fpage>696</fpage>–<lpage>704</lpage>.<pub-id pub-id-type="pmid">14530136</pub-id></mixed-citation>
    </ref>
    <ref id="btx155-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Han</surname><given-names>M.V.</given-names></name>, <name name-style="western"><surname>Zmasek</surname><given-names>C.M.</given-names></name></person-group> (<year>2009</year>) 
<article-title>phyloXML: XML for evolutionary biology and comparative genomics</article-title>. <source>BMC Bioinf</source>., <volume>10</volume>, <fpage>356</fpage>.</mixed-citation>
    </ref>
    <ref id="btx155-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huson</surname><given-names>D.H.</given-names></name>, <name name-style="western"><surname>Scornavacca</surname><given-names>C.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Dendroscope 3: an interactive tool for rooted phylogenetic trees and networks</article-title>. <source>Syst. Biol</source>., <volume>61</volume>, <fpage>1061</fpage>–<lpage>1067</lpage>.<pub-id pub-id-type="pmid">22780991</pub-id></mixed-citation>
    </ref>
    <ref id="btx155-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Maddison</surname><given-names>D.R.</given-names></name></person-group><etal>et al</etal> (<year>1997</year>) 
<article-title>NEXUS: an extensible file format for systematic information</article-title>. <source>Syst. Biol</source>., <volume>46</volume>, <fpage>590</fpage>–<lpage>621</lpage>.<pub-id pub-id-type="pmid">11975335</pub-id></mixed-citation>
    </ref>
    <ref id="btx155-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Maddison</surname><given-names>W.P.</given-names></name>, <name name-style="western"><surname>Maddison</surname><given-names>D.R.</given-names></name></person-group> (<year>1989</year>) 
<article-title>Interactive analysis of phylogeny and character evolution using the computer program macclade</article-title>. <source>Folia Primatol. (Basel)</source>, <volume>53</volume>, <fpage>190</fpage>–<lpage>202</lpage>.<pub-id pub-id-type="pmid">2606395</pub-id></mixed-citation>
    </ref>
    <ref id="btx155-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ronquist</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>MrBayes 3.2: efficient bayesian phylogenetic inference and model choice across a large model space</article-title>. <source>Syst. Biol</source>., <volume>61</volume>, <fpage>539</fpage>–<lpage>542</lpage>.<pub-id pub-id-type="pmid">22357727</pub-id></mixed-citation>
    </ref>
    <ref id="btx155-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vaughan</surname><given-names>T.G.</given-names></name>, <name name-style="western"><surname>Drummond</surname><given-names>A.J.</given-names></name></person-group> (<year>2013</year>) 
<article-title>A stochastic simulator of birth-death master equations with application to phylodynamics</article-title>. <source>Mol. Biol. Evol</source>., <volume>30</volume>, <fpage>1480</fpage>–<lpage>1493</lpage>.<pub-id pub-id-type="pmid">23505043</pub-id></mixed-citation>
    </ref>
    <ref id="btx155-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vaughan</surname><given-names>T.G.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Inferring ancestral recombination graphs from bacterial genomic data</article-title>. <source>Genetics</source>, <volume>205</volume>, <fpage>857</fpage>–<lpage>870</lpage>.<pub-id pub-id-type="pmid">28007885</pub-id></mixed-citation>
    </ref>
    <ref id="btx155-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vos</surname><given-names>R.A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>NeXML: rich, extensible, and verifiable representation of comparative data and metadata</article-title>. <source>Syst. Biol</source>., <volume>61</volume>, <fpage>675</fpage>–<lpage>689</lpage>.<pub-id pub-id-type="pmid">22357728</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
