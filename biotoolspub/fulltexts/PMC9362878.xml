<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9362878</article-id>
    <article-id pub-id-type="pmid">35967929</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbac051</article-id>
    <article-id pub-id-type="publisher-id">vbac051</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data Visualization</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Cell Layers: uncovering clustering structure in unsupervised single-cell transcriptomic analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3196-6233</contrib-id>
        <name>
          <surname>Blair</surname>
          <given-names>Andrew P</given-names>
        </name>
        <aff><institution>Biological and Medical Informatics Graduate Program, University of California</institution>, San Francisco, CA 94143, <country country="US">USA</country></aff>
        <aff><institution>Gladstone Institutes</institution>, San Francisco, CA 94158, <country country="US">USA</country></aff>
        <xref rid="vbac051-cor1" ref-type="corresp"/>
        <!--andrew.blair@ucsf.edu-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hu</surname>
          <given-names>Robert K</given-names>
        </name>
        <aff><institution>Division of Cardiology, Department of Medicine, University of California</institution>, San Diego, CA 92093, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Farah</surname>
          <given-names>Elie N</given-names>
        </name>
        <aff><institution>Division of Cardiology, Department of Medicine, University of California</institution>, San Diego, CA 92093, <country country="US">USA</country></aff>
        <aff><institution>Biomedical Sciences Graduate Program, University of California</institution>, San Diego, CA 92093, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chi</surname>
          <given-names>Neil C</given-names>
        </name>
        <aff><institution>Division of Cardiology, Department of Medicine, University of California</institution>, San Diego, CA 92093, <country country="US">USA</country></aff>
        <aff><institution>Institute for Genomic Medicine, University of California</institution>, San Diego, CA 92093, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pollard</surname>
          <given-names>Katherine S</given-names>
        </name>
        <aff><institution>Gladstone Institutes</institution>, San Francisco, CA 94158, <country country="US">USA</country></aff>
        <aff><institution>Chan-Zuckerberg Biohub</institution>, San Francisco, CA 94143, <country country="US">USA</country></aff>
        <aff><institution>Bakar Computational Health Sciences Institute, University of California</institution>, San Francisco, CA 94143, <country country="US">USA</country></aff>
        <aff><institution>Institute for Human Genetics, University of California</institution>, San Francisco, CA 94143, <country country="US">USA</country></aff>
        <aff><institution>Department of Epidemiology and Biostatistics, University of California</institution>, San Francisco, CA 94143, <country country="US">USA</country></aff>
        <aff><institution>Quantitative Biology Institute, University of California</institution>, San Francisco, CA 94143, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-3360-6936</contrib-id>
        <name>
          <surname>Przytycki</surname>
          <given-names>Pawel F</given-names>
        </name>
        <aff><institution>Gladstone Institutes</institution>, San Francisco, CA 94158, <country country="US">USA</country></aff>
        <xref rid="vbac051-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Kathiriya</surname>
          <given-names>Irfan S</given-names>
        </name>
        <aff><institution>Gladstone Institutes</institution>, San Francisco, CA 94158, <country country="US">USA</country></aff>
        <aff><institution>Department of Anesthesia and Perioperative Care, University of California</institution>, San Francisco, CA 94143, <country country="US">USA</country></aff>
        <xref rid="vbac051-cor1" ref-type="corresp"/>
        <xref rid="vbac051-FM1" ref-type="author-notes"/>
        <!--irfan.kathiriya@ucsf.edu-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bruneau</surname>
          <given-names>Benoit G</given-names>
        </name>
        <aff><institution>Gladstone Institutes</institution>, San Francisco, CA 94158, <country country="US">USA</country></aff>
        <aff><institution>Roddenberry Center for Stem Cell Biology and Medicine, Gladstone Institutes</institution>, San Francisco, CA 94158, <country country="US">USA</country></aff>
        <aff><institution>Cardiovascular Research Institute, University of California</institution>, San Francisco, CA 94143, <country country="US">USA</country></aff>
        <aff><institution>Department of Pediatrics, University of California</institution>, San Francisco, CA 94143, <country country="US">USA</country></aff>
        <xref rid="vbac051-FM1" ref-type="author-notes"/>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Rattray</surname>
          <given-names>Magnus</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <fn id="vbac051-FM1">
        <p>Pawel F Przytycki and Benoit G Bruneau wish it to be known that, in their opinion, the last three authors should be regarded as Joint Last Authors.</p>
      </fn>
      <corresp id="vbac051-cor1">To whom correspondence should be addressed. <email>andrew.blair@ucsf.edu</email> or <email>irfan.kathiriya@ucsf.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-08-04">
      <day>04</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <volume>2</volume>
    <issue>1</issue>
    <elocation-id>vbac051</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>3</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>5</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>07</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>01</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>09</day>
        <month>8</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbac051.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Unsupervised clustering of single-cell transcriptomics is a powerful method for identifying cell populations. Static visualization techniques for single-cell clustering only display results for a single resolution parameter. Analysts will often evaluate more than one resolution parameter but then only report one.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We developed Cell Layers, an interactive Sankey tool for the quantitative investigation of gene expression, co-expression, biological processes and cluster integrity across clustering resolutions. Cell Layers enhances the interpretability of single-cell clustering by linking molecular data and cluster evaluation metrics, providing novel insight into cell populations.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p><ext-link xlink:href="https://github.com/apblair/CellLayers" ext-link-type="uri">https://github.com/apblair/CellLayers</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>RB4-05901</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell RNA sequencing (scRNA-seq) technology allows for the classification of heterogeneous cell populations. Interpreting scRNA-seq profiles requires clustering to group cells with similar transcriptional signatures (<xref rid="vbac051-B6" ref-type="bibr">Hwang <italic toggle="yes">et al.</italic>, 2018</xref>). Clustering is commonly implemented with graph-based modularity optimization methods. The number of clusters and subsequent cell-type characterization typically depends on an algorithm’s optimization method and benefit function. For example, modularity is a benefit function used to optimize the measurement of inter and intra-cluster for community detection in graph-based scRNA-seq clustering. Modularity is subject to a resolution limit, described as the minimum community size detected by optimizing modularity (<xref rid="vbac051-B4" ref-type="bibr">Fortunato and Barthelemy, 2006</xref>). As a result, the resolution parameter regulates the number of clusters, with low values producing a few large clusters and higher values creating many small clusters (<xref rid="vbac051-B11" ref-type="bibr">Traag <italic toggle="yes">et al.</italic>, 2019</xref>). A primary hurdle lies in providing a quantitative representation and explanation of cell-type relationships in multi-resolution clustering.</p>
    <p>The Louvain algorithm is the basis for graph modularity optimization techniques. The method consists of a local moving and aggregation stage for finding a locally optimal solution for community detection (<xref rid="vbac051-B1" ref-type="bibr">Blondel <italic toggle="yes">et al.</italic>, 2008</xref>). The Smart Local Moving (SLM) algorithm overcomes the Louvain local optimal solution limitation by allowing merged communities to split when beneficial (<xref rid="vbac051-B12" ref-type="bibr">Waltman and van Eck, 2013</xref>). In scRNA-seq analysis, SLM normally operates on a shared nearest neighbor (SNN) graph that integrates similarity structure information (<xref rid="vbac051-B15" ref-type="bibr">Zhu <italic toggle="yes">et al.</italic>, 2020</xref>). The most recent advancement to this approach is the Leiden algorithm, which solves the Louvain limitation of disconnected communities (<xref rid="vbac051-B11" ref-type="bibr">Traag <italic toggle="yes">et al.</italic>, 2019</xref>). Future improvements to graph-based community detection that optimize modularity will benefit from data visualization techniques that evaluate the resolution parameter.</p>
    <p>Alternative tools for multi-resolution cluster analysis, such as the R library clustree (<xref rid="vbac051-B13" ref-type="bibr">Zappia and Oshlack, 2018</xref>), construct a non-interactive hierarchical tree representation of how communities split at different clustering resolutions. A single arrow and color opacity represent cell movement across clustering as a proportion ratio, which can be thresholded to remove edges. An alternative visualization is a Sankey diagram, where the width of arrows is proportional to a flow rate that indicates an increase or decrease in values. Sankey plots are helpful in the investigation of microbial communities. For example, the Google Charts tool called BioSankey (<xref rid="vbac051-B9" ref-type="bibr">Platzer <italic toggle="yes">et al.</italic>, 2018</xref>) allows users to visualize the expression of single genes or species. In single-cell analysis, Sankey plots are used to depict cell-to-cell communication interactions, as illustrated by Cell Chat (<xref rid="vbac051-B14" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2021</xref>). However, none of these tools allow analysts to interact with the diagrams directly, and they have limited functionality in terms of how gene expression is overlaid.</p>
    <p>We developed Cell Layers, an interactive data visualization tool for scRNA-seq multi-resolution cluster analysis. The output of Cell Layers is a Sankey network, and the network’s nodes are clusters. We call the edges between nodes the ‘flow’, which represents the transfer of cluster assignments of cells across a parameter grid search for clustering. Nodes can be colored by cluster evaluation metrics or biological activity. Similarly, edges can be colored by gene expression or co-expression. A ternary chart can also be used to interpret the co-expression of marker genes for each flow. The Sankey representation of multi-parameter clustering enables the rapid simultaneous evaluation of various resolutions for single-cell-type characterization.</p>
    <p>A Sankey network is an intuitive visualization for multi-resolution clustering because the representation demonstrates the total volume for the flow of cells. In addition, Cell Layers advances multi-resolution clustering for single-cell analysis by providing analysts with a web portable and Jupyter-enabled interactive application, integration with scikit-learn’s cluster evaluation performance metrics, a method for tracing stable cell communities across cluster parameters, marker gene analysis of cell communities between clusters and co-expression of marker genes.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 Clustering strategies</title>
      <p>In a typical scRNA-seq analysis, clustering methods operate on a cell-to-cell <italic toggle="yes">k</italic>-nearest neighbor (kNN) graph. In Cell Layers, the default construction of a kNN graph is based on the Euclidean distance of a user-defined PCA subspace (<xref rid="vbac051-B1" ref-type="bibr">Blondel <italic toggle="yes">et al.</italic>, 2008</xref>). For modularity and hierarchical clustering methods, cells are then iteratively grouped to optimize a modularity function thresholded by a resolution parameter. Cell communities are numerically labeled, with lower numbers signifying larger clusters. The output of a multi-resolution analysis is a cell-by-resolution-parameter matrix, where values are the cluster assignments of cells at each clustering resolution.</p>
    </sec>
    <sec>
      <title>2.2 Data input</title>
      <p>Cell Layers requires as input (i) a cell-by-resolution-parameter matrix and (ii) the corresponding cell-by-gene expression matrix. While our examples illustrate the cluster parameter as a resolution value for modularity-based clustering techniques, Cell Layers is agnostic to the user-selected clustering method that has been utilized to generate these inputs. To provide options for generating these objects, Cell Layers includes an R library (SetupCellLayers) that generates a cell-by-resolution-parameter matrix from a scRNA-seq kNN graph using the popular Seurat SLM and SNN clustering methods.</p>
    </sec>
    <sec>
      <title>2.3 Data representation</title>
      <p>In Cell Layers, each column of nodes represents a community structure C<sub><italic toggle="yes">v</italic></sub><sub>,</sub><sub><italic toggle="yes">j</italic></sub>, where <italic toggle="yes">v</italic> represents clusters {0,1,.<italic toggle="yes">n</italic>} at resolution parameter <italic toggle="yes">j</italic> ∈ ℝ. The Sankey network’s columns are ordered by a linearly increasing cluster parameter specified by a user-defined range and increment <italic toggle="yes">q</italic>. Each column’s community structure C<sub><italic toggle="yes">v</italic></sub><sub>,</sub><sub><italic toggle="yes">j</italic></sub> is represented by nodes that are scaled by the cluster sample size and arranged to minimize edge overlap. The edges or ‘flow’ between clusters is computed as the number of cells from C<sub><italic toggle="yes">v</italic></sub><sub>,</sub><sub><italic toggle="yes">j</italic></sub> assigned to C<sub><italic toggle="yes">v</italic></sub><sub>,</sub><sub><italic toggle="yes">j</italic></sub><sub>+</sub><sub><italic toggle="yes">q</italic></sub>. The data structure generated by Cell Layers is a directed acyclic graph.</p>
    </sec>
    <sec>
      <title>2.4 Single-cell features</title>
      <p>The flow may be painted by marker gene expression to facilitate cell-type characterization. Users can define several genes for their expression signature. To assess a single gene, each flow in the network is painted by the gene’s average expression for cells between C<sub><italic toggle="yes">v</italic></sub><sub>,</sub><sub><italic toggle="yes">j</italic></sub> and C<sub><italic toggle="yes">v</italic></sub><sub>,</sub><sub><italic toggle="yes">j</italic></sub><sub>+</sub><sub><italic toggle="yes">q</italic></sub> (<xref rid="vbac051-F1" ref-type="fig">Fig. 1A</xref>). Nodes may be painted by cluster metrics, gene ontology enrichment (<xref rid="vbac051-F1" ref-type="fig">Fig. 1B</xref>), or biological process activity (BPA). BPA uses the aREA method to transform gene expression levels using an ensemble of related genes to provide a robust representation of species-independent cellular states (<xref rid="vbac051-B3" ref-type="bibr">Ding <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
      <fig position="float" id="vbac051-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Application of Cell Layers on PBMCs or iPSC-derived cardiomyocyte differentiation. All nodes are labeled by their resolution parameter followed by an underscore indicating their cluster assignment. (<bold>A</bold>) PBMC multi-resolution analysis from 0.1 to 0.5. Edges are painted by CD3E, a marker gene for CD8 T, Memory CD4 T and Naive CD4 T cells. Nodes are painted by normalized Silhouette score. The lower Silhouette values indicate that samples are near the decision boundary of neighboring clusters. (<bold>B</bold>) Nodes painted by enrichR gene ontology (GO) 2018 Biological Process combined scores for GO: 0002480. The node-hover template provides users cluster performance metrics, GO term title, enrichR combined score and the top five differentially expressed genes. Edges are colored by the natural killer (NK) cell marker gene CD8A. (<bold>C</bold>) Multi-resolution analysis from 0.1 to 0.5 and marker gene co-expression of a dataset from iPSC-derived cardiomyocytes (<xref rid="vbac051-B8" ref-type="bibr">Kathiriya <italic toggle="yes">et al.</italic>, 2021</xref>). The (left) ternary chart depicts the gene expression percentiles (GEPs) for the co-expression of <italic toggle="yes">NPPA</italic>, <italic toggle="yes">MYH6</italic> and <italic toggle="yes">TECRL</italic>. Each triangle on the outside of the ternary plot is oriented such that the base indicates increasing GEP. Each scatter point in the ternary chart specifies the co-expression of the genes (<italic toggle="yes">NPPA</italic>, <italic toggle="yes">TECRL</italic> and <italic toggle="yes">MYH6</italic>) as GEPs for a corresponding flow in the (right) Sankey plot. The size of a scatter point is a log2 transformation of the number of cells in its corresponding flow, then multiplied by a scalar value of two. The scatter point is generated by mapping each gene’s GEP. The Sankey nodes are painted by normalized Silhouette score, and edges are painted by the GEP of co-expressed <italic toggle="yes">NPPA</italic>, <italic toggle="yes">TECRL</italic> and <italic toggle="yes">MYH6</italic></p>
        </caption>
        <graphic xlink:href="vbac051f1" position="float"/>
      </fig>
      <p>Drop-down menus allow users to quickly switch between cluster evaluation metrics and BPA, which provide two orthogonal quantitative approaches for cell-type characterization. The first drop-down menu allows users to select a gene, dynamically updating the diagram’s flow and expression scale bar. The second drop-down menu allows the user to update node color by cluster metrics or BPA. Additional drop-down menus allow users to set node width and modify the network layout. Users may choose any Matplotlib colormap for painting the flow and nodes.</p>
      <p>The co-expression of marker genes characterizes many cell types. To evaluate the co-expression for a user-defined geneset E, which contains <italic toggle="yes">n</italic>={3} genes over a flow with m cells, we created a gene expression percentage (GEP) for each gene E<sub><italic toggle="yes">i</italic></sub>. For a geneset E in a given flow, we calculate GEP as the ratio of the summed expression of a gene E<sub><italic toggle="yes">i</italic></sub><sub>,</sub><sub><italic toggle="yes">j</italic></sub> over the total expression of all genes E<sub><italic toggle="yes">k</italic></sub><sub>,</sub><sub><italic toggle="yes">j</italic></sub>:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi>G</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>The GEPs for a geneset are then mapped to a red, green or blue (RGB) hex code using Matplotlib. A Plotly ternary chart depicts the percentage ratios of co-expressed genes for each flow (<xref rid="vbac051-F1" ref-type="fig">Fig. 1C</xref>). Each point in the ternary plot corresponds to a flow’s sample size and expression percentage.</p>
    </sec>
    <sec>
      <title>2.5 Future directions</title>
      <p>Cell Layers was built for versatility, and its application extends beyond the single-cell features outlined here. Node-hover templates may include cluster metadata, which users may use to assess batch composition or integration. Downstream of multi-resolution analysis, Cell Layers can be used to evaluate data imputation models by assessing cluster stability metrics. Multi-resolution marker gene detection methods may be devised using statistical methods, such as the Jaccard Index. Additionally, protein activity profile methods could be integrated to resolve tissue-specific clusters (<xref rid="vbac051-B2" ref-type="bibr">Ding <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
    </sec>
    <sec>
      <title>2.6 Software availability</title>
      <p>Cell Layers is incorporated in the JupyterLab computing environment. Plotly is open-source software for data analytics and visualization of data science models. We made significant adaptations to Plotly’s interactive Sankey and Ternary API for scRNA-seq multi-resolution cluster analysis. Cell Layers will be available via pip, GitHub, Docker and Singularity.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Conclusion</title>
    <p>Clustering of scRNA-seq data is used to identify cell populations computationally. Analysts typically assess multiple cluster parameters, cluster performance metrics and marker genes before annotating clusters. Fixed dimensionality reduction methods for visualizing single-cell clustering are limited by the number of attributes that users can assess. Cell Layers enables analysts to efficiently utilize multi-resolution parameters to explore and characterize single-cell populations interactively.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank the Cytoscape and scNetViz developers Alex Pico and Scooter Morris for their input on Plotly, Dan Carlin for his input on multi-resolution analysis, members of the CIRM Heart of Cells group, Gladstone Bioinformatics core, and Bruneau lab for discussions and comments.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the California Institute of Regenerative Medicine [RB4-05901 to B.G.B.]; Additional Ventures to B.G.B. and K.S.P.; National Institutes of Health [5U01HL157989-02 to B.G.B. and K.S.P.]; Department of Anesthesia and Perioperative Care, University of California, San Francisco, to I.S.K.; and the Younger family fund to B.G.B.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: B.G.B. is a co-founder and shareholder of Tenaya Therapeutics. K.S.P. is a shareholder of Tenaya Therapeutics. None of the work presented here is related to the interests of Tenaya Therapeutics.</p>
    </sec>
  </ack>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>The data underlying this article are available in GitHub at <ext-link xlink:href="https://github.com/apblair/CellLayers" ext-link-type="uri">https://github.com/apblair/CellLayers</ext-link> and figshare at <ext-link xlink:href="https://figshare.com/account/projects/136175/articles/19834771" ext-link-type="uri">https://figshare.com/account/projects/136175/articles/19834771</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbac051-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blondel</surname><given-names>V.D.</given-names></string-name></person-group><etal>et al</etal> (<year>2008</year>) <article-title>Fast unfolding of communities in large networks</article-title>. <source>J. Stat. Mech. Theory Exp</source>., <volume>2008</volume>, <fpage>P10008</fpage>.</mixed-citation>
    </ref>
    <ref id="vbac051-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Quantitative assessment of protein activity in orphan tissues and single cells using the metaVIPER algorithm</article-title>. <source>Nat. Commun</source>., <volume>9</volume>, <fpage>1471</fpage>.<pub-id pub-id-type="pmid">29662057</pub-id></mixed-citation>
    </ref>
    <ref id="vbac051-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Biological process activity transformation of single cell gene expression for cross-species alignment</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>4899</fpage>.<pub-id pub-id-type="pmid">31653878</pub-id></mixed-citation>
    </ref>
    <ref id="vbac051-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fortunato</surname>,<given-names>S.</given-names></string-name> and <string-name><surname>Barthélemy</surname>,<given-names>M.</given-names></string-name></person-group> (<year>2007</year>) <article-title>Resolution limit in community detection</article-title>. <source>Proc. Natl. Acad. Sci.</source>, <volume>104</volume>, <fpage>36</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">17190818</pub-id></mixed-citation>
    </ref>
    <ref id="vbac051-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hwang</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Single-cell RNA sequencing technologies and bioinformatics pipelines</article-title>. <source>Exp. Mol. Med</source>., <volume>50</volume>, <fpage>1</fpage>.</mixed-citation>
    </ref>
    <ref id="vbac051-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kathiriya</surname><given-names>I.S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Modeling human TBX5 haploinsufficiency predicts regulatory networks for congenital heart disease</article-title>. <source>Dev. Cell</source>, <volume>56</volume>, <fpage>292</fpage>–<lpage>309.e9</lpage>.<pub-id pub-id-type="pmid">33321106</pub-id></mixed-citation>
    </ref>
    <ref id="vbac051-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Platzer</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>BioSankey: visualization of microbial communities over time</article-title>. <source>J. Integr. Bioinform</source>., <volume>15</volume>, <fpage>20170063</fpage>.<pub-id pub-id-type="pmid">29897884</pub-id></mixed-citation>
    </ref>
    <ref id="vbac051-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Traag</surname><given-names>V.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>. <source>Sci. Rep</source>., <volume>9</volume>, <fpage>5233</fpage>.<pub-id pub-id-type="pmid">30914743</pub-id></mixed-citation>
    </ref>
    <ref id="vbac051-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Waltman</surname><given-names>L.</given-names></string-name>, <string-name><surname>van Eck</surname><given-names>N.J.</given-names></string-name></person-group> (<year>2013</year>) <article-title>A smart local moving algorithm for large-scale modularity-based community detection</article-title>. <source>Eur. Phys. J. B</source>, <volume>86</volume>, <fpage>471</fpage>.</mixed-citation>
    </ref>
    <ref id="vbac051-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zappia</surname><given-names>L.</given-names></string-name>, <string-name><surname>Oshlack</surname><given-names>A.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Clustering trees: a visualization for evaluating clusterings at multiple resolutions</article-title>. <source>Gigascience</source>, <volume>7</volume>, 1–9.</mixed-citation>
    </ref>
    <ref id="vbac051-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>CellCall: integrating paired ligand–receptor and transcription factor activities for cell–cell communication</article-title>. <source>Nucleic Acids Res</source>., <volume>49</volume>, <fpage>8520</fpage>–<lpage>8534</lpage>.<pub-id pub-id-type="pmid">34331449</pub-id></mixed-citation>
    </ref>
    <ref id="vbac051-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Single-cell clustering based on shared nearest neighbor and graph partitioning</article-title>. <source>Interdiscip. Sci</source>., <volume>12</volume>, <fpage>117</fpage>–<lpage>130</lpage>.<pub-id pub-id-type="pmid">32086753</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
